{"version":3,"file":"static/js/main.6c2b880c.js","mappings":"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","sources":["webpack://element_masters/./src/assets/images/ sync \\.(png%7Cjpe","webpack://element_masters/./src/assets/background/ sync nonrecursive \\.(png%7Cjpe","webpack://element_masters/./src/assets/sound/ sync \\.(mp3%7Cwav%7Cogg%7Cm4a%7Caac%7Cflac%7Cwebm)$","webpack://element_masters/./src/assets/json/ sync \\.json$","webpack://element_masters/./src/assets/sound/background/ sync nonrecursive \\.(ogg%7Cmp3%7Cwav%7Cm4a)$i","webpack://element_masters/./src/store/slices/gameSlice.js","webpack://element_masters/./src/constants/gameConstants.js","webpack://element_masters/./src/store/slices/playerSlice.js","webpack://element_masters/./src/store/slices/settingsSlice.js","webpack://element_masters/./src/store/slices/uiSlice.js","webpack://element_masters/./src/store/index.js","webpack://element_masters/./src/styles/theme.js","webpack://element_masters/./src/styles/GlobalStyles.js","webpack://element_masters/./src/i18n/i18n.js","webpack://element_masters/./src/sections/section.header.navigation.chapters.js","webpack://element_masters/./src/sections/section.header.navigation.languages.js","webpack://element_masters/./src/sections/section.header.navigation.logo.js","webpack://element_masters/./src/sections/section.header.js","webpack://element_masters/./src/sections/section.footer.js","webpack://element_masters/./src/sections/section.content.js","webpack://element_masters/./src/engine/registry/index.js","webpack://element_masters/./src/App.js","webpack://element_masters/./src/config.js","webpack://element_masters/./src/sections/chapters/home.jsx","webpack://element_masters/./src/Pixi/TextureCache.js","webpack://element_masters/./src/Pixi/effects/weather/Rain.js","webpack://element_masters/./src/Pixi/effects/weather/Snow.js","webpack://element_masters/./src/Pixi/effects/weather/Clouds.js","webpack://element_masters/./src/Pixi/effects/weather/Fog.js","webpack://element_masters/./src/Pixi/effects/weather/Thunder.js","webpack://element_masters/./src/Pixi/effects/weather/LavaRain.js","webpack://element_masters/./src/Pixi/effects/weather/RadioactiveFog.js","webpack://element_masters/./src/Pixi/effects/weather/MeteorRain.js","webpack://element_masters/./src/Pixi/effects/liquids/WaterSplashFX.js","webpack://element_masters/./src/Pixi/effects/liquids/LavaEmbers.js","webpack://element_masters/./src/Pixi/effects/liquids/LavaSteamFX.js","webpack://element_masters/./src/Pixi/effects/liquids/LiquidRegionSystem.js","webpack://element_masters/./src/Pixi/ui/HealthBar.js","webpack://element_masters/./src/renderer/stage/layers/LayerOrder.js","webpack://element_masters/./src/sections/chapters/game/PixiStage/helpers.js","webpack://element_masters/./src/sections/chapters/game/PixiStage/liquidRendering.js","webpack://element_masters/./src/Pixi/layers/ParallaxBackground.js","webpack://element_masters/./src/sections/chapters/game/PixiStage/parallaxManager.js","webpack://element_masters/./src/sections/chapters/game/PixiStage/playerManager.js","webpack://element_masters/./src/sections/chapters/game/PixiStage/index.jsx","webpack://element_masters/./src/sections/chapters/game/PixiStage/projectileManager.js","webpack://element_masters/./src/sections/chapters/game/PixiStage/entityManager.js","webpack://element_masters/./src/sections/chapters/game/PixiStage/layerBuilder.js","webpack://element_masters/./src/engine/gameplay/secrets.js","webpack://element_masters/./src/engine/audio/audio.js","webpack://element_masters/./src/engine/physics/horizontal.js","webpack://element_masters/./src/engine/physics/vertical.js","webpack://element_masters/./src/engine/liquids/liquidUtils.js","webpack://element_masters/./src/engine/loop/updateFrame.js","webpack://element_masters/./src/engine/gameplay/entities.js","webpack://element_masters/./src/engine/physics/collision.js","webpack://element_masters/./src/services/errorHandler.js","webpack://element_masters/./src/utilities/useGameEngine.js","webpack://element_masters/./src/utilities/useInput.js","webpack://element_masters/./src/engine/gameplay/hazards.js","webpack://element_masters/./src/engine/gameplay/weatherEffects.js","webpack://element_masters/./src/engine/gameplay/spawnProjectile.js","webpack://element_masters/./src/engine/gameplay/collectItem.js","webpack://element_masters/./src/engine/gameplay/interactables.js","webpack://element_masters/./src/engine/gameplay/updateProjectiles.js","webpack://element_masters/./src/sections/chapters/game/GameHeader.jsx","webpack://element_masters/./src/commands/gameCommands.js","webpack://element_masters/./src/sections/chapters/game/GameTerminal.jsx","webpack://element_masters/./src/sections/chapters/game/GameSettings.jsx","webpack://element_masters/./src/utilities/BackgroundMusicPlayer.jsx","webpack://element_masters/./src/constants/builtInMaps.js","webpack://element_masters/./src/sections/chapters/game/index.jsx","webpack://element_masters/./src/utilities/saveFile.js","webpack://element_masters/./src/sections/chapters/editor/editorTools/mapOperations.js","webpack://element_masters/./src/sections/chapters/editor/viewport/ObjectLinks.jsx","webpack://element_masters/./src/utilities/AnimatedItem.jsx","webpack://element_masters/./src/sections/chapters/editor/viewport/EditorTile.jsx","webpack://element_masters/./src/sections/chapters/editor/Viewport.jsx","webpack://element_masters/./src/sections/chapters/editor/styles/EditorToolsButton.jsx","webpack://element_masters/./src/sections/chapters/editor/styles/EditorElementsButtonStyle.js","webpack://element_masters/./src/sections/chapters/editor/editorTools/NewMapModal.jsx","webpack://element_masters/./src/sections/chapters/editor/editorTools/BuiltInMapsModal.jsx","webpack://element_masters/./src/sections/chapters/editor/editorScene/DraggableWindow.jsx","webpack://element_masters/./src/sections/chapters/editor/editorScene/EditorMapResizer.jsx","webpack://element_masters/./src/sections/chapters/editor/editorScene/Minimap.jsx","webpack://element_masters/./src/sections/chapters/editor/editorScene/WorldView.jsx","webpack://element_masters/./src/sections/chapters/editor/editorScene/BackgroundPanel.jsx","webpack://element_masters/./src/sections/chapters/editor/editorScene/MusicPanel.jsx","webpack://element_masters/./src/sections/chapters/editor/editorScene/WeatherPanel.jsx","webpack://element_masters/./src/sections/chapters/editor/styles/EditorSceneButtonStyle.js","webpack://element_masters/./src/sections/chapters/editor/EditorScene.jsx","webpack://element_masters/./src/sections/chapters/editor/editorElements/OperationsPanel.jsx","webpack://element_masters/./src/sections/chapters/editor/editorElements/CollapsiblePanel.jsx","webpack://element_masters/./src/sections/chapters/editor/editorElements/PalettePanel.jsx","webpack://element_masters/./src/sections/chapters/editor/editorElements/StatisticsPanel.jsx","webpack://element_masters/./src/sections/chapters/editor/editorElements/ObjectPropsPanel.jsx","webpack://element_masters/./src/sections/chapters/editor/EditorElements.jsx","webpack://element_masters/./src/sections/chapters/editor/EditorTools.jsx","webpack://element_masters/./src/sections/chapters/editor/hooks/useEditorPlayMode.js","webpack://element_masters/./src/sections/chapters/editor/hooks/useEditorOperations.js","webpack://element_masters/./src/sections/chapters/editor/editorTools/paintingTools.js","webpack://element_masters/./src/sections/chapters/editor/hooks/useEditorPainting.js","webpack://element_masters/./src/sections/chapters/editor/Editor.jsx","webpack://element_masters/./src/sections/chapters/editor/assetLoaders.js","webpack://element_masters/./src/sections/chapters/editor/hooks/useEditorMaps.js","webpack://element_masters/./src/sections/chapters/editor/hooks/useEditorRegistry.js","webpack://element_masters/./src/sections/chapters/editor/hooks/useEditorSelection.js","webpack://element_masters/./src/sections/chapters/crystals.jsx","webpack://element_masters/./src/sections/chapters/repository.jsx","webpack://element_masters/./src/index.js"],"sourcesContent":["var map = {\n\t\"./blocks/block_pack_01/dirt_block_0002.png\": 8625,\n\t\"./blocks/block_pack_01/dirt_block_0003.png\": 2967,\n\t\"./blocks/block_pack_01/dirt_block_0004.png\": 7800,\n\t\"./blocks/block_pack_01/dirt_block_0005.png\": 2017,\n\t\"./blocks/block_pack_01/dirt_block_0006.png\": 1850,\n\t\"./blocks/block_pack_01/ice_block_0001.png\": 9745,\n\t\"./blocks/desert_pack_01/desert_pack_0001.png\": 7741,\n\t\"./blocks/desert_pack_01/desert_pack_0002.png\": 182,\n\t\"./blocks/desert_pack_01/desert_pack_0003.png\": 1727,\n\t\"./blocks/desert_pack_01/desert_pack_0004.png\": 6352,\n\t\"./blocks/desert_pack_01/desert_pack_0005.png\": 2601,\n\t\"./blocks/desert_pack_01/desert_pack_0006.png\": 6018,\n\t\"./blocks/desert_pack_01/desert_pack_0007.png\": 6523,\n\t\"./blocks/desert_pack_01/desert_pack_0008.png\": 5132,\n\t\"./blocks/desert_pack_01/desert_pack_0009.png\": 1045,\n\t\"./blocks/diorite_block.png\": 8276,\n\t\"./blocks/dirt_block_0001.png\": 9538,\n\t\"./blocks/grass_block_0001.png\": 1764,\n\t\"./blocks/sand_block_0001.png\": 2250,\n\t\"./blocks/sand_block_0002.png\": 2145,\n\t\"./blocks/water_block.png\": 1635,\n\t\"./decorations/stone_pack_01/stone_pack_01_001.png\": 1978,\n\t\"./decorations/stone_pack_01/stone_pack_01_002.png\": 4526,\n\t\"./decorations/stone_pack_01/stone_pack_01_003.png\": 7928,\n\t\"./decorations/stone_pack_01/stone_pack_01_004.png\": 9447,\n\t\"./decorations/stone_pack_01/stone_pack_01_005.png\": 1134,\n\t\"./decorations/stone_pack_01/stone_pack_01_006.png\": 8485,\n\t\"./decorations/stone_pack_01/stone_pack_01_007.png\": 3036,\n\t\"./decorations/stone_pack_01/stone_pack_01_008.png\": 7195,\n\t\"./decorations/stone_pack_01/stone_pack_01_009.png\": 9330,\n\t\"./decorations/stone_pack_01/stone_pack_01_010.png\": 2952,\n\t\"./entities/player/player_dead_01.png\": 2735,\n\t\"./entities/player/player_dead_02.png\": 2820,\n\t\"./entities/player/player_dead_03.png\": 5325,\n\t\"./entities/player/player_dead_04.png\": 3762,\n\t\"./entities/player/player_dead_05.png\": 2763,\n\t\"./entities/player/player_dead_06.png\": 7728,\n\t\"./entities/player/player_dead_07.png\": 8905,\n\t\"./entities/player/player_dead_08.png\": 3662,\n\t\"./entities/player/player_dead_09.png\": 1351,\n\t\"./entities/player/player_dead_10.png\": 1297,\n\t\"./entities/player/player_default_100.A.png\": 6847,\n\t\"./entities/player/player_default_100.B.png\": 4388,\n\t\"./entities/player/player_target_100.A.png\": 2155,\n\t\"./entities/player/player_target_100.B.png\": 8336,\n\t\"./entities/tanks/tank_0000.png\": 2386,\n\t\"./entities/tanks/tank_0001.png\": 3563,\n\t\"./entities/tanks/tank_0002.png\": 5232,\n\t\"./hazards/bushes_001.png\": 6343,\n\t\"./hazards/death_block_0001.png\": 3527,\n\t\"./interactables/arrows/arrow_down.png\": 7152,\n\t\"./interactables/arrows/arrow_left.png\": 8047,\n\t\"./interactables/arrows/arrow_right.png\": 592,\n\t\"./interactables/arrows/arrow_up.png\": 7263,\n\t\"./interactables/berry_bush_01_A.png\": 2534,\n\t\"./interactables/berry_bush_01_B.png\": 4157,\n\t\"./interactables/berry_bush_02_A.png\": 3945,\n\t\"./interactables/berry_bush_02_B.png\": 7858,\n\t\"./interactables/ends/end_0001.png\": 8597,\n\t\"./interactables/platforms/platform_0001.png\": 9427,\n\t\"./interactables/portals/portal_01/portal_A_001.png\": 8518,\n\t\"./interactables/portals/portal_01/portal_A_002.png\": 3933,\n\t\"./interactables/portals/portal_01/portal_A_003.png\": 692,\n\t\"./interactables/portals/portal_01/portal_A_004.png\": 5499,\n\t\"./interactables/portals/portal_01/portal_A_005.png\": 3954,\n\t\"./interactables/portals/portal_01/portal_A_006.png\": 8489,\n\t\"./interactables/portals/portal_01/portal_A_007.png\": 4288,\n\t\"./interactables/portals/portal_01/portal_A_008.png\": 8519,\n\t\"./interactables/portals/portal_01/portal_A_009.png\": 2734,\n\t\"./interactables/portals/portal_01/portal_A_010.png\": 3124,\n\t\"./interactables/portals/portal_01/portal_A_011.png\": 4253,\n\t\"./interactables/portals/portal_01/portal_A_012.png\": 6838,\n\t\"./interactables/portals/portal_01/portal_A_013.png\": 5583,\n\t\"./interactables/portals/portal_01/portal_A_014.png\": 9712,\n\t\"./interactables/portals/portal_01/portal_A_015.png\": 5465,\n\t\"./interactables/portals/portal_01/portal_A_016.png\": 1458,\n\t\"./interactables/stone_0001.png\": 1020,\n\t\"./interactables/wooden_box_0001.png\": 1169,\n\t\"./items/fireball_basic_A.png\": 9240,\n\t\"./items/fireball_basic_B.png\": 4851,\n\t\"./items/fireball_basic_C.png\": 9290,\n\t\"./items/fireball_basic_D.png\": 9717,\n\t\"./items/hertz_item.A.png\": 7720,\n\t\"./items/hertz_item.B.png\": 3475,\n\t\"./projectiles/fireball_basic_A.png\": 9792,\n\t\"./projectiles/fireball_basic_B.png\": 1083,\n\t\"./projectiles/fireball_basic_C.png\": 9954,\n\t\"./projectiles/fireball_basic_D.png\": 4205,\n\t\"./secrets/crack_block.png\": 2789\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 1621;","var map = {\n\t\"./City.png\": 3676,\n\t\"./Forest.png\": 6370,\n\t\"./UndergroundCave.png\": 2445,\n\t\"./seamless_01.jpg\": 2436,\n\t\"./seamless_02.jpg\": 2147,\n\t\"./seamless_03.jpg\": 2038,\n\t\"./seamless_04.jpg\": 8237,\n\t\"./seamless_05.jpg\": 3344,\n\t\"./seamless_06.jpg\": 719,\n\t\"./seamless_07.png\": 6390\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 2201;","var map = {\n\t\"./background/170515__rolandasb__forest_ambient_01_loop.ogg\": 344,\n\t\"./background/830253__nicktayloe__afternoon-woods-in-october-midwest-us-loop.ogg\": 3004,\n\t\"./sfx/zzox-fx_nite-hit-item.ogg\": 9750,\n\t\"./sfx/zzox-fx_sling-selector.ogg\": 7973\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 6431;","var map = {\n\t\"./blocks/desert_block_0001.json\": 6918,\n\t\"./blocks/desert_block_0002.json\": 8359,\n\t\"./blocks/desert_block_0003.json\": 324,\n\t\"./blocks/desert_block_0004.json\": 2149,\n\t\"./blocks/desert_block_0005.json\": 5418,\n\t\"./blocks/desert_block_0006.json\": 5531,\n\t\"./blocks/desert_block_0007.json\": 4136,\n\t\"./blocks/desert_block_0008.json\": 329,\n\t\"./blocks/desert_block_0009.json\": 9518,\n\t\"./blocks/diorite_block.json\": 3929,\n\t\"./blocks/dirt_block_0001.json\": 3462,\n\t\"./blocks/dirt_block_0002.json\": 5655,\n\t\"./blocks/dirt_block_0003.json\": 4932,\n\t\"./blocks/dirt_block_0004.json\": 5653,\n\t\"./blocks/dirt_block_0005.json\": 8970,\n\t\"./blocks/dirt_block_0006.json\": 2251,\n\t\"./blocks/grass_block_0001.json\": 7865,\n\t\"./blocks/ice_block_0001.json\": 3322,\n\t\"./blocks/lava_block.json\": 2619,\n\t\"./blocks/lava_waterfall_block.json\": 2258,\n\t\"./blocks/quicksand_block.json\": 502,\n\t\"./blocks/radioactive_water_block.json\": 886,\n\t\"./blocks/radioactive_waterfall_block.json\": 9823,\n\t\"./blocks/sand_block_0001.json\": 7323,\n\t\"./blocks/sand_block_0002.json\": 7210,\n\t\"./blocks/water_block.json\": 5688,\n\t\"./blocks/waterfall_block.json\": 5989,\n\t\"./decorations/stone_pack_01_001.json\": 5247,\n\t\"./decorations/stone_pack_01_002.json\": 5134,\n\t\"./decorations/stone_pack_01_003.json\": 9593,\n\t\"./decorations/stone_pack_01_004.json\": 9840,\n\t\"./decorations/stone_pack_01_005.json\": 2867,\n\t\"./decorations/stone_pack_01_006.json\": 7618,\n\t\"./decorations/stone_pack_01_007.json\": 9069,\n\t\"./decorations/stone_pack_01_008.json\": 9588,\n\t\"./decorations/stone_pack_01_009.json\": 3975,\n\t\"./entities/player/player.json\": 6411,\n\t\"./entities/player/player_dead.json\": 5998,\n\t\"./entities/player/player_default.json\": 2333,\n\t\"./entities/player/player_target.json\": 6513,\n\t\"./entities/tank_0000.json\": 9381,\n\t\"./entities/tank_0001.json\": 8938,\n\t\"./entities/tank_0002.json\": 9179,\n\t\"./hazards/bushes_001.json\": 3540,\n\t\"./hazards/death_block_0001.json\": 2068,\n\t\"./interactables/arrows/arrow_down.json\": 3741,\n\t\"./interactables/arrows/arrow_left.json\": 4636,\n\t\"./interactables/arrows/arrow_right.json\": 9821,\n\t\"./interactables/arrows/arrow_up.json\": 7852,\n\t\"./interactables/berry_bush_01.json\": 7043,\n\t\"./interactables/berry_bush_01_used.json\": 8669,\n\t\"./interactables/ends/end_0001.json\": 9318,\n\t\"./interactables/platforms/platform_0001.json\": 2008,\n\t\"./interactables/portal_001.json\": 3742,\n\t\"./interactables/portal_target.json\": 4198,\n\t\"./interactables/stone_0001.json\": 1521,\n\t\"./interactables/wooden_box_0001.json\": 2010,\n\t\"./items/fireball_ammo.json\": 8443,\n\t\"./items/hertz_item.json\": 1752,\n\t\"./projectiles/firebal_basic.json\": 8097,\n\t\"./secrets/crack_block.json\": 6854,\n\t\"./secrets/message_trigger.json\": 3746,\n\t\"./secrets/open_area.json\": 3106,\n\t\"./secrets/secret_area_a.json\": 1866,\n\t\"./secrets/secret_area_b.json\": 3227,\n\t\"./secrets/secret_area_c.json\": 3880,\n\t\"./secrets/wolf_secret_left.json\": 7157,\n\t\"./secrets/wolf_secret_right.json\": 9950,\n\t\"./weather/weather_clouds_off.json\": 8264,\n\t\"./weather/weather_clouds_on.json\": 9138,\n\t\"./weather/weather_clouds_value.json\": 6592,\n\t\"./weather/weather_fog_off.json\": 4870,\n\t\"./weather/weather_fog_on.json\": 9560,\n\t\"./weather/weather_fog_value.json\": 1374,\n\t\"./weather/weather_lava_rain_off.json\": 4159,\n\t\"./weather/weather_lava_rain_on.json\": 7795,\n\t\"./weather/weather_meteor_rain_off.json\": 8421,\n\t\"./weather/weather_meteor_rain_on.json\": 2097,\n\t\"./weather/weather_radioactive_fog_off.json\": 8304,\n\t\"./weather/weather_radioactive_fog_on.json\": 6298,\n\t\"./weather/weather_rain_off.json\": 8312,\n\t\"./weather/weather_rain_on.json\": 914,\n\t\"./weather/weather_rain_value.json\": 7664,\n\t\"./weather/weather_snow_off.json\": 8445,\n\t\"./weather/weather_snow_on.json\": 969,\n\t\"./weather/weather_snow_value.json\": 5409,\n\t\"./weather/weather_thunder_off.json\": 628,\n\t\"./weather/weather_thunder_on.json\": 1006,\n\t\"./weather/weather_thunder_value.json\": 6756\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 6570;","var map = {\n\t\"./170515__rolandasb__forest_ambient_01_loop.ogg\": 344,\n\t\"./830253__nicktayloe__afternoon-woods-in-october-midwest-us-loop.ogg\": 3004\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 8815;","/**\n * Game Slice\n * Manages game-level state (maps, registry, game status)\n */\n\nimport { createSlice } from '@reduxjs/toolkit';\n\nconst initialState = {\n  activeMapData: null,\n  tileMapData: [],\n  objectMapData: [],\n  secretMapData: [],\n  objectMetadata: {}, // Track metadata per object position { index: { health: 100, etc } }\n  revealedSecrets: [], // Track which secret zones have been revealed (array of indices)\n  objectTextureIndices: {}, // Track texture index per object position { index: textureIndex }\n  mapWidth: 20,\n  mapHeight: 15,\n  projectMaps: {}, // For Project v2.0 (multi-map)\n  isLoading: false,\n  error: null,\n  isPaused: false,\n  isGameOver: false,\n};\n\nconst gameSlice = createSlice({\n  name: 'game',\n  initialState,\n  reducers: {\n    setActiveMap: (state, action) => {\n      const { mapData, tileMapData, objectMapData, secretMapData, mapWidth, mapHeight } = action.payload;\n      state.activeMapData = mapData;\n      state.tileMapData = tileMapData;\n      state.objectMapData = objectMapData;\n      state.secretMapData = secretMapData || [];\n      state.objectMetadata = mapData?.meta?.objectMetadata || mapData?.objectMetadata || {}; // Load initial metadata from map\n      state.revealedSecrets = []; // Reset revealed secrets on new map\n      state.objectTextureIndices = {}; // Reset texture indices on new map\n      state.mapWidth = mapWidth;\n      state.mapHeight = mapHeight;\n      state.isGameOver = false;\n\n      // If this is a project (v2.0) with multiple maps\n      if (mapData?.maps) {\n        state.projectMaps = mapData.maps;\n      }\n    },\n    updateObjectMap: (state, action) => {\n      state.objectMapData = action.payload;\n    },\n    updateObjectMetadata: (state, action) => {\n      const { index, metadata } = action.payload;\n      state.objectMetadata[index] = {\n        ...(state.objectMetadata[index] || {}),\n        ...metadata\n      };\n    },\n    removeObjectAtIndex: (state, action) => {\n      const index = action.payload;\n      if (state.objectMapData[index] !== undefined) {\n        state.objectMapData[index] = null;\n      }\n    },\n    removeTileAtIndex: (state, action) => {\n      const index = action.payload;\n      if (state.tileMapData[index] !== undefined) {\n        state.tileMapData[index] = null;\n      }\n    },\n    moveTileInMap: (state, action) => {\n      const { fromIndex, toIndex } = action.payload;\n      if (state.tileMapData[fromIndex] !== undefined && state.tileMapData[toIndex] !== undefined) {\n        state.tileMapData[toIndex] = state.tileMapData[fromIndex];\n        state.tileMapData[fromIndex] = null;\n      }\n    },\n    moveObjectInMap: (state, action) => {\n      const { fromIndex, toIndex } = action.payload;\n      if (state.objectMapData[fromIndex] !== undefined && state.objectMapData[toIndex] !== undefined) {\n        state.objectMapData[toIndex] = state.objectMapData[fromIndex];\n        state.objectMapData[fromIndex] = null;\n        \n        // Move metadata as well\n        if (state.objectMetadata[fromIndex]) {\n          state.objectMetadata[toIndex] = state.objectMetadata[fromIndex];\n          delete state.objectMetadata[fromIndex];\n        }\n      }\n    },\n    updateObjectAtIndex: (state, action) => {\n      const { index, newId } = action.payload;\n      if (state.objectMapData[index] !== undefined) {\n        state.objectMapData[index] = newId;\n      }\n    },\n    setObjectTextureIndex: (state, action) => {\n      const { index, textureIndex } = action.payload;\n      state.objectTextureIndices[index] = textureIndex;\n    },\n    revealSecretZone: (state, action) => {\n      const indices = action.payload; // Array of tile indices to reveal\n      // Add new indices to revealed array (avoid duplicates)\n      indices.forEach(idx => {\n        if (!state.revealedSecrets.includes(idx)) {\n          state.revealedSecrets.push(idx);\n        }\n      });\n    },\n    setLoading: (state, action) => {\n      state.isLoading = action.payload;\n    },\n    setError: (state, action) => {\n      state.error = action.payload;\n    },\n    setPaused: (state, action) => {\n      state.isPaused = action.payload;\n    },\n    setGameOver: (state, action) => {\n      state.isGameOver = action.payload;\n    },\n    resetGame: (state) => {\n      return { ...initialState, activeMapData: state.activeMapData };\n    },\n  },\n});\n\nexport const {\n  setActiveMap,\n  updateObjectMap,\n  updateObjectMetadata,\n  removeObjectAtIndex,\n  removeTileAtIndex,\n  moveTileInMap,\n  moveObjectInMap,\n  updateObjectAtIndex,\n  setObjectTextureIndex,\n  revealSecretZone,\n  setLoading,\n  setError,\n  setPaused,\n  setGameOver,\n  resetGame,\n} = gameSlice.actions;\n\nexport default gameSlice.reducer;\n","/**\n * Game Constants\n * All game-wide constants centralized in one place\n */\n\n// Physics Constants\nexport const TILE_SIZE = 32;\nexport const GRAVITY = 0.6;\nexport const TERMINAL_VELOCITY = 12;\nexport const MOVE_SPEED = 4;\nexport const JUMP_FORCE = 10;\n\n// Player Stats Constants\nexport const MAX_HEALTH = 100;\nexport const MAX_OXYGEN = 100;\nexport const MAX_LAVA_RESIST = 100;\nexport const MAX_ICE_RESIST = 100;\nexport const MAX_RADIOACTIVITY = 100;\n\n// Combat Constants\nexport const SHOOT_COOLDOWN = 350; // milliseconds\nexport const HIT_FLASH_DURATION = 500; // milliseconds\n\n// Animation Constants\nexport const IDLE_ANIMATION = 'idle';\nexport const RUN_ANIMATION = 'run';\nexport const JUMP_ANIMATION = 'jump';\n\n// Liquid Constants\nexport const WATER_HORIZONTAL_DAMPING = 0.82;\nexport const LAVA_HORIZONTAL_DAMPING = 0.78;\n\n// Default Liquid Parameters\nexport const DEFAULT_OXYGEN_PARAMS = {\n  drainPerSecond: 20,\n  regenPerSecond: 35,\n  damagePerSecondWhenDepleted: 10,\n};\n\nexport const DEFAULT_LAVA_PARAMS = {\n  drainPerSecond: 25,\n  regenPerSecond: 40,\n  damagePerSecondWhenDepleted: 15,\n};\n\n// Timing Constants\nexport const HAZARD_DAMAGE_TICK_INTERVAL = 1000; // milliseconds\nexport const LIQUID_DAMAGE_TICK_INTERVAL = 1000; // milliseconds\n\n// Direction Constants\nexport const DIRECTION_RIGHT = 1;\nexport const DIRECTION_LEFT = -1;\n\n// Map Defaults\nexport const DEFAULT_MAP_WIDTH = 20;\nexport const DEFAULT_MAP_HEIGHT = 15;\n\n// Viewport Constants\nexport const VIEWPORT_DEAD_ZONE_LEFT = 0.3;\nexport const VIEWPORT_DEAD_ZONE_RIGHT = 0.7;\n\n// Sound Constants\nexport const DEFAULT_BACKGROUND_MUSIC_VOLUME = 0.6;\nexport const DEFAULT_SFX_VOLUME = 0.5;\n","/**\n * Player Slice\n * Manages player state (position, health, resources, etc.)\n */\n\nimport { createSlice } from '@reduxjs/toolkit';\nimport { MAX_HEALTH, MAX_OXYGEN, MAX_LAVA_RESIST } from '../../constants/gameConstants';\n\nconst initialState = {\n  x: 0,\n  y: 0,\n  width: 32,\n  height: 32,\n  vx: 0,\n  vy: 0,\n  isGrounded: false,\n  direction: 1,\n  animation: 'idle',\n  health: 90,\n  maxHealth: MAX_HEALTH,\n  strength: 30,\n  maxStrength: 100,\n  ammo: 0,\n  oxygen: MAX_OXYGEN,\n  maxOxygen: MAX_OXYGEN,\n  lavaResist: MAX_LAVA_RESIST,\n  maxLavaResist: MAX_LAVA_RESIST,\n  projectiles: [],\n  inWater: false,\n  headUnderWater: false,\n  atSurface: false,\n  liquidType: null,\n  hitTimerMs: 0,\n  isWinning: false,\n  winCounter: 0,\n};\n\nconst playerSlice = createSlice({\n  name: 'player',\n  initialState,\n  reducers: {\n    updateState: (state, action) => {\n      return { ...state, ...action.payload };\n    },\n    setPosition: (state, action) => {\n      const { x, y } = action.payload;\n      state.x = x;\n      state.y = y;\n    },\n    setVelocity: (state, action) => {\n      const { vx, vy } = action.payload;\n      state.vx = vx;\n      state.vy = vy;\n    },\n    setHealth: (state, action) => {\n      state.health = Math.max(0, Math.min(state.maxHealth, action.payload));\n    },\n    addHealth: (state, action) => {\n      state.health = Math.max(0, Math.min(state.maxHealth, state.health + action.payload));\n    },\n    takeDamage: (state, action) => {\n      state.health = Math.max(0, state.health - action.payload);\n      state.hitTimerMs = Math.max(state.hitTimerMs, 500);\n    },\n    setAmmo: (state, action) => {\n      state.ammo = Math.max(0, action.payload);\n    },\n    addAmmo: (state, action) => {\n      state.ammo = Math.max(0, state.ammo + action.payload);\n    },\n    setOxygen: (state, action) => {\n      state.oxygen = Math.max(0, Math.min(state.maxOxygen, action.payload));\n    },\n    setLavaResist: (state, action) => {\n      state.lavaResist = Math.max(0, Math.min(state.maxLavaResist, action.payload));\n    },\n    setStrength: (state, action) => {\n      state.strength = Math.max(0, Math.min(state.maxStrength, action.payload));\n    },\n    setProjectiles: (state, action) => {\n      state.projectiles = action.payload;\n    },\n    addProjectile: (state, action) => {\n      state.projectiles.push(action.payload);\n    },\n    removeProjectile: (state, action) => {\n      state.projectiles = state.projectiles.filter(p => p.id !== action.payload);\n    },\n    setDirection: (state, action) => {\n      state.direction = action.payload;\n    },\n    setAnimation: (state, action) => {\n      state.animation = action.payload;\n    },\n    setGrounded: (state, action) => {\n      state.isGrounded = action.payload;\n    },\n    setInWater: (state, action) => {\n      state.inWater = action.payload;\n    },\n    setLiquidType: (state, action) => {\n      state.liquidType = action.payload;\n    },\n    resetPlayer: () => initialState,\n  },\n});\n\nexport const {\n  updateState,\n  setPosition,\n  setVelocity,\n  setHealth,\n  addHealth,\n  takeDamage,\n  setAmmo,\n  addAmmo,\n  setOxygen,\n  setLavaResist,\n  setStrength,\n  setProjectiles,\n  addProjectile,\n  removeProjectile,\n  setDirection,\n  setAnimation,\n  setGrounded,\n  setInWater,\n  setLiquidType,\n  resetPlayer,\n} = playerSlice.actions;\n\nexport default playerSlice.reducer;\n","/**\n * Settings Slice\n * Manages game settings (audio, graphics, controls, etc.)\n */\n\nimport { createSlice } from '@reduxjs/toolkit';\n\nconst initialState = {\n  sound: {\n    enabled: false,\n    masterVolume: 1.0,\n    sfxVolume: 0.5,\n    musicVolume: 0.6,\n  },\n  graphics: {\n    backgroundParallaxFactor: 0.3,\n    weatherRain: 0,\n    weatherSnow: 0,\n    weatherClouds: 0,\n    weatherFog: 0,\n    weatherThunder: 0,\n  },\n  ui: {\n    healthBarEnabled: true,\n    oxygenBarEnabled: true,\n    lavaBarEnabled: true,\n    waterSplashesEnabled: true,\n    lavaEmbersEnabled: true,\n  },\n  controls: {\n    keyUp: 'w',\n    keyDown: 's',\n    keyLeft: 'a',\n    keyRight: 'd',\n    keyJump: 'Space',\n    keyShoot: 'MouseLeft',\n  },\n};\n\n// Load settings from localStorage\nconst loadSettings = () => {\n  try {\n    const saved = localStorage.getItem('game_settings');\n    if (saved) {\n      const parsed = JSON.parse(saved);\n      return { ...initialState, ...parsed };\n    }\n  } catch (error) {\n    console.error('Failed to load settings:', error);\n  }\n  return initialState;\n};\n\nconst settingsSlice = createSlice({\n  name: 'settings',\n  initialState: loadSettings(),\n  reducers: {\n    updateSettings: (state, action) => {\n      const newState = { ...state, ...action.payload };\n      // Save to localStorage\n      try {\n        localStorage.setItem('game_settings', JSON.stringify(newState));\n      } catch (error) {\n        console.error('Failed to save settings:', error);\n      }\n      return newState;\n    },\n    setSoundEnabled: (state, action) => {\n      state.sound.enabled = action.payload;\n      try {\n        localStorage.setItem('game_sound_enabled', action.payload ? '1' : '0');\n      } catch (error) {\n        console.error('Failed to save sound setting:', error);\n      }\n    },\n    setSoundVolume: (state, action) => {\n      const { type, volume } = action.payload;\n      if (type === 'master') state.sound.masterVolume = volume;\n      else if (type === 'sfx') state.sound.sfxVolume = volume;\n      else if (type === 'music') state.sound.musicVolume = volume;\n    },\n    setGraphicsSetting: (state, action) => {\n      const { key, value } = action.payload;\n      if (state.graphics[key] !== undefined) {\n        state.graphics[key] = value;\n      }\n    },\n    setUISetting: (state, action) => {\n      const { key, value } = action.payload;\n      if (state.ui[key] !== undefined) {\n        state.ui[key] = value;\n      }\n    },\n    setControlBinding: (state, action) => {\n      const { key, value } = action.payload;\n      if (state.controls[key] !== undefined) {\n        state.controls[key] = value;\n      }\n    },\n    resetSettings: () => {\n      try {\n        localStorage.removeItem('game_settings');\n      } catch (error) {\n        console.error('Failed to clear settings:', error);\n      }\n      return initialState;\n    },\n  },\n});\n\nexport const {\n  updateSettings,\n  setSoundEnabled,\n  setSoundVolume,\n  setGraphicsSetting,\n  setUISetting,\n  setControlBinding,\n  resetSettings,\n} = settingsSlice.actions;\n\nexport default settingsSlice.reducer;\n","/**\n * UI Slice\n * Manages UI state (modals, menus, notifications, etc.)\n */\n\nimport { createSlice } from '@reduxjs/toolkit';\n\nconst initialState = {\n  isMapModalOpen: true,\n  isSettingsOpen: false,\n  isTerminalOpen: false,\n  isPauseMenuOpen: false,\n  notifications: [],\n  cameraScrollX: 0,\n  shouldCenterMap: false,\n};\n\nconst uiSlice = createSlice({\n  name: 'ui',\n  initialState,\n  reducers: {\n    setMapModalOpen: (state, action) => {\n      state.isMapModalOpen = action.payload;\n    },\n    setSettingsOpen: (state, action) => {\n      state.isSettingsOpen = action.payload;\n    },\n    setTerminalOpen: (state, action) => {\n      state.isTerminalOpen = action.payload;\n      // Also set global flag for game loop\n      try {\n        window.__GAME_TERMINAL_OPEN__ = action.payload;\n      } catch {}\n    },\n    setPauseMenuOpen: (state, action) => {\n      state.isPauseMenuOpen = action.payload;\n    },\n    addNotification: (state, action) => {\n      state.notifications.push({\n        id: Date.now(),\n        timestamp: new Date().toISOString(),\n        ...action.payload,\n      });\n    },\n    removeNotification: (state, action) => {\n      state.notifications = state.notifications.filter(n => n.id !== action.payload);\n    },\n    clearNotifications: (state) => {\n      state.notifications = [];\n    },\n    setCameraScrollX: (state, action) => {\n      state.cameraScrollX = action.payload;\n    },\n    setShouldCenterMap: (state, action) => {\n      state.shouldCenterMap = action.payload;\n    },\n    resetUI: () => initialState,\n  },\n});\n\nexport const {\n  setMapModalOpen,\n  setSettingsOpen,\n  setTerminalOpen,\n  setPauseMenuOpen,\n  addNotification,\n  removeNotification,\n  clearNotifications,\n  setCameraScrollX,\n  setShouldCenterMap,\n  resetUI,\n} = uiSlice.actions;\n\nexport default uiSlice.reducer;\n","/**\n * Redux Store Configuration\n * Centralized state management for the game\n */\n\nimport { configureStore } from '@reduxjs/toolkit';\nimport gameReducer from './slices/gameSlice';\nimport playerReducer from './slices/playerSlice';\nimport settingsReducer from './slices/settingsSlice';\nimport uiReducer from './slices/uiSlice';\n\nconst store = configureStore({\n  reducer: {\n    game: gameReducer,\n    player: playerReducer,\n    settings: settingsReducer,\n    ui: uiReducer,\n  },\n  middleware: (getDefaultMiddleware) =>\n    getDefaultMiddleware({\n      serializableCheck: {\n        // Ignore these action types for serialization checks\n        ignoredActions: ['game/setActiveMap', 'player/updateState'],\n        // Ignore these field paths in all actions\n        ignoredActionPaths: ['payload.projectiles', 'payload.timestamp'],\n        // Ignore these paths in the state\n        ignoredPaths: ['game.activeMapData', 'player.projectiles'],\n      },\n    }),\n  devTools: process.env.NODE_ENV !== 'production',\n});\n\nexport default store;\n","/**\n * Theme Configuration for Styled Components\n * Centralized design tokens and theme variables\n */\n\nconst theme = {\n  colors: {\n    primary: '#4CAF50',\n    secondary: '#2196F3',\n    danger: '#f44336',\n    warning: '#ff9800',\n    success: '#8bc34a',\n    info: '#00bcd4',\n    dark: '#222',\n    darkGray: '#333',\n    mediumGray: '#555',\n    lightGray: '#777',\n    background: '#111',\n    surface: '#f9f9f9',\n    overlay: 'rgba(0, 0, 0, 0.6)',\n    text: '#333',\n    textLight: '#666',\n    textDark: '#fff',\n    border: '#ddd',\n    borderLight: '#eee',\n  },\n\n  spacing: {\n    xs: '4px',\n    sm: '8px',\n    md: '16px',\n    lg: '24px',\n    xl: '32px',\n    xxl: '48px',\n  },\n\n  borderRadius: {\n    sm: '4px',\n    md: '6px',\n    lg: '8px',\n    xl: '12px',\n    round: '50%',\n  },\n\n  shadows: {\n    sm: '0 2px 4px rgba(0,0,0,0.1)',\n    md: '0 4px 8px rgba(0,0,0,0.2)',\n    lg: '0 10px 25px rgba(0,0,0,0.5)',\n  },\n\n  fontSize: {\n    xs: '11px',\n    sm: '12px',\n    md: '14px',\n    base: '16px',\n    lg: '18px',\n    xl: '24px',\n    xxl: '32px',\n  },\n\n  fontWeight: {\n    light: 300,\n    normal: 400,\n    medium: 500,\n    semibold: 600,\n    bold: 700,\n  },\n\n  transitions: {\n    fast: '0.15s ease',\n    normal: '0.3s ease',\n    slow: '0.5s ease',\n  },\n\n  zIndex: {\n    base: 1,\n    dropdown: 100,\n    modal: 1000,\n    tooltip: 1100,\n    notification: 1200,\n  },\n\n  breakpoints: {\n    mobile: '480px',\n    tablet: '768px',\n    desktop: '1024px',\n    wide: '1280px',\n  },\n};\n\nexport default theme;\n","/**\n * Global Styles using Styled Components\n */\n\nimport { createGlobalStyle } from 'styled-components';\n\nconst GlobalStyles = createGlobalStyle`\n  * {\n    margin: 0;\n    padding: 0;\n    box-sizing: border-box;\n  }\n\n  body {\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',\n      'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',\n      sans-serif;\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    overflow: hidden;\n  }\n\n  code {\n    font-family: source-code-pro, Menlo, Monaco, Consolas, 'Courier New',\n      monospace;\n  }\n\n  button {\n    cursor: pointer;\n    font-family: inherit;\n\n    &:disabled {\n      cursor: not-allowed;\n      opacity: 0.6;\n    }\n  }\n\n  input, textarea, select {\n    font-family: inherit;\n  }\n\n  a {\n    text-decoration: none;\n    color: inherit;\n  }\n\n  ul, ol {\n    list-style: none;\n  }\n\n  img {\n    max-width: 100%;\n    height: auto;\n  }\n\n  /* Scrollbar Styles */\n  ::-webkit-scrollbar {\n    width: 10px;\n    height: 10px;\n  }\n\n  ::-webkit-scrollbar-track {\n    background: #222;\n  }\n\n  ::-webkit-scrollbar-thumb {\n    background: #555;\n    border-radius: 5px;\n\n    &:hover {\n      background: #777;\n    }\n  }\n`;\n\nexport default GlobalStyles;\n","import i18n from \"i18next\"\nimport { initReactI18next } from \"react-i18next\"\n\nimport lv_navigation_home from \"./translations/lv/navigation_home.json\"\nimport no_navigation_home from  \"./translations/no/navigation_home.json\"\nimport en_navigation_home from  \"./translations/en/navigation_home.json\"\nimport ru_navigation_home from  \"./translations/ru/navigation_home.json\"\nimport ja_navigation_home from  \"./translations/ja/navigation_home.json\"\n\nconst lv_navigation = {\n    ...lv_navigation_home\n}\n\nconst no_navigation = {\n    ...no_navigation_home\n}\n\nconst en_navigation = {\n    ...en_navigation_home\n}\n\nconst ru_navigation = {\n    ...ru_navigation_home\n}\n\nconst ja_navigation = {\n    ...ja_navigation_home\n}\n\ni18n\n    .use(initReactI18next)\n    .init({\n        lng: \"en\",\n        fallbackLng: \"en\",\n        supportedLngs: [\"lv\", \"no\", \"en\", \"ru\", \"ja\"],\n        ns: [\"navigation\"],\n        defaultNS: \"navigation\",\n        interpolation: { escapeValue: false },\n        resources: {\n            lv: {\n                navigation: lv_navigation\n            },\n            no: {\n                navigation: no_navigation\n            },\n            en: {\n                navigation: en_navigation\n            },\n            ru: {\n                navigation: ru_navigation\n            },\n            ja: {\n                navigation: ja_navigation\n            },\n        },\n    })\n\nexport default i18n","import styled from \"styled-components\"\nimport { NavLink } from \"react-router-dom\"\nimport { useTranslation } from \"react-i18next\"\n\nexport const NavLinkButton = styled(NavLink)`\n    display: flex;\n    align-items: center;\n    justify-content: center;\n\n    background-color: transparent;\n    color: lightgray;\n    border: 1px solid rgba(255, 255, 255, 0.3);\n    padding: 0 10px;\n    font-size: 13px;\n    font-weight: 600;\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n    cursor: pointer;\n    transition: all 0.3s ease;\n    white-space: nowrap;\n    border-radius: 0;\n    text-decoration: none;\n\n    &:hover {\n        background-color: #f4c542;\n        color: #2a2a2a;\n        border-color: #f4c542;\n    }\n\n    &.active {\n        background-color: rgba(255, 255, 255, 0.15);\n        border-color: rgba(255, 255, 255, 0.5);\n        color: black;\n    }\n`\n\nexport function SectionHeaderNavigationChapters() {\n    const { t } = useTranslation(\"navigation\");\n    const chapter_home = t(\"NAVIGATION_HOME\")\n    const chapter_game = t(\"NAVIGATION_NEW_GAME\")\n    const chapter_editor = t(\"NAVIGATION_EDITOR\")\n    const chapter_crystals = t(\"NAVIGATION_CRYSTALS\")\n    const chapter_repository = t(\"NAVIGATION_REPOSITORY\")\n\n    // JAUNS: Funkcija, kas nosta signlu atvrt modlo logu\n    const handleNewGameClick = () => {\n        // Nostam globlu notikumu, ko 'game.jsx' vars uztvert\n        window.dispatchEvent(new Event('open-new-game-modal'));\n    };\n\n    return (\n        <nav style={{ display: \"flex\", gap: \"0\" }}>\n            <NavLinkButton to=\"/\" className={({ isActive }) => isActive ? \"active\" : \"\"}>\n                { chapter_home }\n            </NavLinkButton>\n\n            {/* JAUNS: Pievienots onClick handleris */}\n            <NavLinkButton to=\"/game\" onClick={handleNewGameClick} className={({ isActive }) => isActive ? \"active\" : \"\"}>\n                { chapter_game }\n            </NavLinkButton>\n\n            <NavLinkButton to=\"/editor\" className={({ isActive }) => isActive ? \"active\" : \"\"}>\n                { chapter_editor }\n            </NavLinkButton>\n\n            <NavLinkButton to=\"/crystals\" className={({ isActive }) => isActive ? \"active\" : \"\"}>\n                { chapter_crystals }\n            </NavLinkButton>\n\n\n        </nav>\n    )\n}\n\n/*\n<NavLinkButton to=\"/repository\" className={({ isActive }) => isActive ? \"active\" : \"\"}>\n                { chapter_repository }\n            </NavLinkButton>\n* */","import styled from \"styled-components\"\nimport { useTranslation } from \"react-i18next\"\nimport { useState, useRef, useEffect } from \"react\"\nimport { useSelector, useDispatch } from \"react-redux\"\nimport { setSoundEnabled } from \"../store/slices/settingsSlice\"\n\nconst NavButton = styled.button`\n    display: flex;\n    align-items: center;\n    justify-content: center;\n\n    background-color: transparent;\n    color: lightgray;\n    border: 1px solid rgba(255, 255, 255, 0.3);\n    //height: 36px;              /* fiksts augstums desktop */\n    padding: 0 10px;           /* horizontlais padding */\n    font-size: 13px;\n    font-weight: 600;\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n    cursor: pointer;\n    transition: all 0.3s ease;\n    white-space: nowrap;\n    border-radius: 0;\n    height: 36px;\n\n    &:hover {\n        background-color: #f4c542;\n        color: #2a2a2a;\n        border-color: #f4c542;\n    }\n\n    &.active {\n        background-color: rgba(255, 255, 255, 0.15);\n        border-color: rgba(255, 255, 255, 0.5);\n        color: black;\n    }\n`\n\nconst DropdownContainer = styled.div`\n    position: relative;\n    display: flex;\n`\n\nconst DropdownMenu = styled.div`\n    position: absolute;\n    top: 100%;\n    right: 0;\n    background-color: #333;\n    border: 1px solid #444;\n    border-radius: 4px;\n    padding: 10px;\n    z-index: 2000;\n    box-shadow: 0 4px 12px rgba(0,0,0,0.5);\n    min-width: 150px;\n    margin-top: 5px;\n`\n\nconst MenuItem = styled.div`\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    padding: 8px;\n    color: white;\n    font-size: 12px;\n    cursor: pointer;\n    border-radius: 4px;\n\n    &:hover {\n        background-color: #444;\n    }\n`\n\nconst ToggleSwitch = styled.div`\n    width: 34px;\n    height: 18px;\n    background-color: ${props => props.$active ? '#f4c542' : '#666'};\n    border-radius: 9px;\n    position: relative;\n    transition: background-color 0.3s;\n\n    &::after {\n        content: '';\n        position: absolute;\n        top: 2px;\n        left: ${props => props.$active ? '18px' : '2px'};\n        width: 14px;\n        height: 14px;\n        background-color: white;\n        border-radius: 50%;\n        transition: left 0.3s;\n    }\n`\n\nexport default function SectionHeaderNavigationLanguages() {\n    const { i18n } = useTranslation();\n    const dispatch = useDispatch();\n    const dropdownRef = useRef(null);\n    const [isMenuOpen, setIsMenuOpen] = useState(false);\n    \n    const { sound } = useSelector(state => state.settings);\n    const soundEnabled = sound?.enabled ?? false;\n\n    const currentLang = i18n.language || 'en'\n\n    const handleLanguageChange = (newLang) => {\n        i18n.changeLanguage(newLang)\n    }\n\n    const toggleSound = () => {\n        const next = !soundEnabled;\n        dispatch(setSoundEnabled(next));\n        try { window.dispatchEvent(new CustomEvent('game-sound-toggle', { detail: { enabled: next } })); } catch {}\n        try { window.dispatchEvent(new CustomEvent('game-sound-user-gesture')); } catch {}\n    };\n\n    useEffect(() => {\n        const handleClickOutside = (event) => {\n            if (dropdownRef.current && !dropdownRef.current.contains(event.target)) {\n                setIsMenuOpen(false);\n            }\n        };\n        document.addEventListener('mousedown', handleClickOutside);\n        return () => document.removeEventListener('mousedown', handleClickOutside);\n    }, []);\n\n    return (\n        <nav style={{ display: \"flex\", gap: \"0\" }}>\n            <NavButton\n                className={currentLang === 'lv' ? 'active' : ''}\n                onClick={() => handleLanguageChange('lv')}\n            >\n                LV\n            </NavButton>\n\n            <NavButton\n                className={currentLang === 'no' ? 'active' : ''}\n                onClick={() => handleLanguageChange('no')}\n            >\n                NO\n            </NavButton>\n\n            <NavButton\n                className={currentLang === 'en' ? 'active' : ''}\n                onClick={() => handleLanguageChange('en')}\n            >\n                EN\n            </NavButton>\n\n            <NavButton\n                className={currentLang === 'ru' ? 'active' : ''}\n                onClick={() => handleLanguageChange('ru')}\n            >\n                RU\n            </NavButton>\n\n            <NavButton\n                className={currentLang === 'ja' ? 'active' : ''}\n                onClick={() => handleLanguageChange('ja')}\n            >\n                JA\n            </NavButton>\n\n            <DropdownContainer ref={dropdownRef}>\n                <NavButton onClick={() => setIsMenuOpen(!isMenuOpen)} title=\"Settings\">\n                    \n                </NavButton>\n                {isMenuOpen && (\n                    <DropdownMenu>\n                        <MenuItem onClick={toggleSound}>\n                            <span>Sound Effects</span>\n                            <ToggleSwitch $active={soundEnabled} />\n                        </MenuItem>\n                        <div style={{ height: '1px', backgroundColor: '#444', margin: '5px 0' }} />\n                        <div style={{ padding: '5px 8px', fontSize: '10px', color: '#888' }}>\n                            GAME SETTINGS\n                        </div>\n                    </DropdownMenu>\n                )}\n            </DropdownContainer>\n        </nav>\n    )\n}","import styled from \"styled-components\"\n\nconst StyledLogo = styled.p`\n    text-transform: uppercase;\n`\n\nexport function SectionHeaderNavigationLogo() {\n\n    return (\n        <StyledLogo>\n            Element Masters\n        </StyledLogo>\n    )\n}","import styled from \"styled-components\"\nimport { SectionHeaderNavigationChapters } from \"./section.header.navigation.chapters\"\nimport SectionHeaderNavigationLanguages from \"./section.header.navigation.languages\"\nimport {SectionHeaderNavigationLogo} from \"./section.header.navigation.logo\";\n\nconst StyledSectionHeaderNavigation = styled.div`\n    display: flex;\n    flex-direction: row;\n    width: 100%;\n    height: auto;\n    border: solid 1px lightgrey;\n    \n    .innerHeader {\n        display: flex;\n        flex-direction: row;\n        width: 100%;\n        height: auto;\n        margin: 5px 20px;\n        //border: solid 1px red;\n        \n        .innerHeaderLogo {\n            display: flex;\n            flex-direction: row;\n            width: 220px;\n            height: auto;\n            //border: solid 1px green;\n        }\n        \n        .innerHeaderChapters {\n            display: flex;\n            flex-direction: row;\n            justify-content: center;\n            width: 100%;\n            height: auto;\n            //border: solid 1px brown;\n        }\n        \n        .innerHeaderLanguages {\n            display: flex;\n            flex-direction: row;\n            width: auto;\n            height: auto;\n            //border: solid 1px red;\n        }\n    }\n`\n\nfunction SectionHeader() {\n\n    return (\n        <StyledSectionHeaderNavigation>\n            <div className=\"innerHeader\">\n                <div className=\"innerHeaderLogo\">\n                    <SectionHeaderNavigationLogo />\n                </div>\n\n                <div className=\"innerHeaderChapters\">\n                    <SectionHeaderNavigationChapters />\n                </div>\n\n                <div className=\"innerHeaderLanguages\">\n                    <SectionHeaderNavigationLanguages />\n                </div>\n            </div>\n        </StyledSectionHeaderNavigation>\n    )\n}\n\nexport default SectionHeader","import styled from \"styled-components\"\n\nconst StyledSectionHeaderFooter = styled.div`\n    display: flex;\n    flex-direction: row;\n    justify-content: center;\n    width: 100%;\n    height: auto;\n    border: solid 1px lightgray;\n\n    .innerFooter {\n        display: flex;\n        flex-direction: row;\n        justify-content: flex-end;\n        width: 100%;\n        height: auto;\n        margin: 5px 20px;\n        //border: solid 1px red;\n    }\n\n    p {\n        font-size: 12px;\n        color: lightgrey;\n    }\n`\n\nfunction SectionFooter() {\n\n    return (\n        <StyledSectionHeaderFooter>\n            <div className=\"innerFooter\">\n                <p>element_masters v.0.0.0</p>\n            </div>\n        </StyledSectionHeaderFooter>\n    )\n}\n\nexport default SectionFooter","import styled from \"styled-components\"\n\nconst StyledSectionContent = styled.div`\n    display: flex;\n    flex-direction: column;\n    width: 100%;\n    height: 100%;\n    border: solid 1px lightgray;\n`\n\nfunction SectionContent({ children, style }) {\n\n    return (\n        <StyledSectionContent style={style}>\n            { children }\n        </StyledSectionContent>\n    )\n}\n\nexport default SectionContent","/**\n * Game Registry Module\n * Loads all JSON files and creates a registry array.\n * Executed only once during initialization.\n */\n\nlet _registry = null;\n\n/**\n * Initialize the registry by loading all JSON, image, and sound assets.\n * This is executed only once when the module is first imported.\n * @returns {Array} The loaded registry items\n */\nconst initRegistry = () => {\n    // If registry already exists, do nothing\n    if (_registry) return _registry;\n\n    console.time(\"Registry Load Time\");\n\n    try {\n        // 1. Load JSON data\n        const jsonContext = require.context('../../assets/json', true, /\\.json$/);\n\n        // 2. Load IMAGES\n        const imageContext = require.context('../../assets/images', true, /\\.(png|jpe?g|svg)$/);\n\n        // 3. Load SOUNDS (non-fatal: if not supported or directory doesn't exist, continue without sounds)\n        let soundContext = null;\n        try {\n            soundContext = require.context('../../assets/sound', true, /\\.(mp3|wav|ogg|m4a|aac|flac|webm)$/);\n        } catch (e) {\n            // Sound context not available  not fatal\n            soundContext = null;\n        }\n\n        // Check if sound context is available\n        if (!soundContext) {\n            console.warn('Sound context unavailable. Continuing without pre-resolved sound assets.');\n        }\n\n        // Helper function for path resolution\n        const resolvePath = (rawPath) => {\n            if (!rawPath) return null;\n            try {\n                // Convert JSON path to relative Webpack path\n                // Example: \"/assets/images/blocks/dirt.png\" -> \"./blocks/dirt.png\"\n                const cleanPath = rawPath.replace('/assets/images/', './').replace('src/assets/images/', './');\n                const relativePath = cleanPath.startsWith('./') ? cleanPath : `./${cleanPath}`;\n\n                const imageModule = imageContext(relativePath);\n                return imageModule.default || imageModule;\n            } catch (e) {\n                console.warn(`Image not found: ${rawPath}`);\n                return rawPath; // If not found, return original path\n            }\n        };\n\n        let _warnedUnresolvedSound = false;\n        const resolveSound = (rawPath) => {\n            if (!rawPath) return null;\n            // Normalize path for sound context\n            const normalize = (p) => {\n                let out = p;\n                out = out.replace('/assets/sounds/', './').replace('src/assets/sounds/', './');\n                out = out.replace('/assets/sound/', './').replace('src/assets/sound/', './');\n                return out.startsWith('./') ? out : `./${out}`;\n            };\n            const rel = normalize(rawPath);\n            // Try to resolve with sound context\n            if (soundContext) {\n                try {\n                    const mod = soundContext(rel);\n                    return mod.default || mod;\n                } catch {}\n            }\n            // Unable to resolve in bundler  return original path to try loading via public URL\n            if (!_warnedUnresolvedSound) {\n                console.warn(`SFX not bundled: ${rawPath}. Will try loading via public URL. Place files under src/assets/sound, or copy to public/assets/sound.`);\n                _warnedUnresolvedSound = true;\n            }\n            return rawPath;\n        };\n\n        _registry = jsonContext.keys().map((key) => {\n            const data = jsonContext(key);\n            const item = data.default || data;\n\n            // Apstrdjam vienu bildi (vecais variants)\n            let resolvedTexture = resolvePath(item.texture);\n\n            // Apstrdjam bilu masvu (jaunais variants animcijm)\n            let resolvedTextures = [];\n            if (item.textures && Array.isArray(item.textures)) {\n                resolvedTextures = item.textures.map(path => resolvePath(path));\n            }\n\n            return {\n                ...item,\n                texture: resolvedTexture,     // Viena bilde (ja ir)\n                textures: resolvedTextures,   // Masvs (ja ir)\n                // Skaas ce (ja ir)  prvrsts uz bundlera URL\n                sfx: resolveSound(item.sfx || item.sfxResolved || null)\n            };\n        });\n\n        // --- JAUNS: Pcapstrde (Linking & Merging) ---\n        // Ms ejam cauri visiem elementiem un mekljam tos, kuriem ir 'defaultAnimation'.\n        // Ja atrodam, ms kopjam vizulos datus no animcijas uz galveno objektu.\n        \n        _registry.forEach(item => {\n            if (item.defaultAnimation) {\n                // Mekljam animcijas objektu pc ID\n                // Piezme: Tav piemr player.json ir \"player_default\", bet fail id ir \"player_default_100\". \n                // eit ms minm atrast preczu vai daju atbilstbu, lai kods strdtu abos gadjumos.\n                const animItem = _registry.find(r => r.id === item.defaultAnimation || r.id === item.defaultAnimation + \"_100\");\n                \n                if (animItem) {\n                    // Kopjam vizulos datus uz galveno 'player' objektu\n                    if (!item.texture) item.texture = animItem.texture;\n                    if (!item.textures || item.textures.length === 0) item.textures = animItem.textures;\n                    if (!item.animationSpeed) item.animationSpeed = animItem.animationSpeed;\n                    \n                    // Iezmjam animcijas objektu k 'hidden', lai to nerdtu Editor\n                    animItem.isHiddenInEditor = true;\n                }\n                \n                // Tpat paslpjam ar dead un target animcijas, ja ts eksist k atsevii itemi\n                if (item.deadAnimation) {\n                     const deadItem = _registry.find(r => r.id === item.deadAnimation);\n                     if (deadItem) deadItem.isHiddenInEditor = true;\n                }\n                if (item.targetAnimation) {\n                     const targetItem = _registry.find(r => r.id === item.targetAnimation || r.id === item.targetAnimation + \"_100\");\n                     if (targetItem) targetItem.isHiddenInEditor = true;\n                }\n            }\n        });\n\n        console.log(` Game Registry initialized. Loaded ${_registry.length} items.`);\n\n    } catch (error) {\n        console.error(\" Failed to load Game Registry:\", error);\n        _registry = [];\n    }\n\n    console.timeEnd(\"Registry Load Time\");\n    return _registry;\n};\n\n// Automtiski inicializjam, kad is fails tiek importts pirmo reizi\ninitRegistry();\n\n// Eksportjam funkciju, lai piektu datiem (getter)\nexport const getRegistry = () => {\n    return _registry;\n};\n\n// Eksportjam palgfunkciju, lai mekltu pc ID\nexport const findItemById = (id) => {\n    return _registry ? _registry.find(item => item.id === id) : null;\n};\n\nexport default _registry;\n","import React, { useEffect } from 'react';\nimport { Outlet, Link } from \"react-router-dom\"\nimport SectionHeader from \"./sections/section.header\";\nimport SectionFooter from \"./sections/section.footer\";\nimport SectionContent from \"./sections/section.content\";\n\n// Import the registry getter from the centralized engine registry\n// The import itself ensures that the registry code executes and data loads into memory.\nimport { getRegistry } from './engine/registry';\n\nfunction App() {\n\n  useEffect(() => {\n    // Verify that registry data is loaded into memory\n    const items = getRegistry();\n    console.log(\"App start - Current Registry in Memory:\", items);\n  }, []);\n\n  return (\n        <div style={{\n            display: 'flex',\n            flexDirection: 'column',\n            justifyContent: 'flex-start',\n            alignItems: 'center',\n            width: '100vw',\n            height: '100vh',\n            overflow: 'hidden'\n        }}>\n            <div style={{ width: '100%', flexShrink: 0 }}>\n                <SectionHeader />\n            </div>\n            <SectionContent style={{ flexGrow: 1, width: '100%', overflow: 'auto' }}>\n                <Outlet />\n            </SectionContent>\n\n        </div>\n      )\n    }\n\nexport default App\n/*\n <div style={{ width: '100%', flexShrink: 0 }}>\n                <SectionFooter />\n            </div>\n* */","const PUBLIC_URL = (typeof process !== 'undefined' && process.env?.PUBLIC_URL) || '';\n\nconst config = {\n    apiUrl: (typeof process !== 'undefined' && process.env?.REACT_APP_API_URL) || 'http://localhost:8000',\n\n    logo: {\n        URL_LOGO_01: `${PUBLIC_URL}/assets/logo/Logo1.png`,\n        URL_LOGO_02: `${PUBLIC_URL}/assets/logo/Logo2.png`,\n        URL_LOGO_03: `${PUBLIC_URL}/assets/logo/Logo3.png`,\n        URL_LOGO_04: `${PUBLIC_URL}/assets/logo/Logo4.png`,\n        URL_LOGO_05: `${PUBLIC_URL}/assets/logo/Logo5.png`,\n    },\n\n};\n\nexport default config","import React from 'react'\nimport styled from 'styled-components'\nimport config from '../../config'\n\nconst HomeContainer = styled.div`\n    display: flex;\n    flex-direction: column;\n    width: 100%;\n    height: 100%;\n    //background-color: darkred;\n    \n    .logoRow{\n        display: flex;\n        flex-direction: row;\n        justify-content: space-between;\n        width: 100%;\n        height: auto;\n        margin: 10px;\n        //border: solid 1px red;\n        \n        & img {\n            width: 350px;\n        }\n    }\n`\n\nexport default function Home() {\n    const LOGO_01 = config.logo.URL_LOGO_01\n    const LOGO_02 = config.logo.URL_LOGO_02\n    const LOGO_03 = config.logo.URL_LOGO_03\n    const LOGO_04 = config.logo.URL_LOGO_04\n    const LOGO_05 = config.logo.URL_LOGO_05\n    console.log(LOGO_01, LOGO_02, LOGO_03, LOGO_04, LOGO_05)\n\n    return (\n        <HomeContainer>\n           <div className={\"logoRow\"}>\n               <img src={LOGO_01} alt=\"logo\" />\n               <img src={LOGO_02} alt=\"logo\" />\n               <img src={LOGO_03} alt=\"logo\" />\n               <img src={LOGO_04} alt=\"logo\" />\n\n           </div>\n        </HomeContainer>\n    )\n}\n","// Lightweight texture cache around PIXI.Texture.from\n// Usage:\n//   const cache = new TextureCache();\n//   const tex = cache.get(url);\n//   cache.dispose(); // optional\n\nimport { Texture } from 'pixi.js';\n\nexport class TextureCache {\n  constructor() {\n    this._map = new Map();\n  }\n\n  get(url) {\n    if (!url) return null;\n    const m = this._map;\n    if (m.has(url)) return m.get(url);\n    const tex = Texture.from(url);\n    m.set(url, tex);\n    return tex;\n  }\n\n  has(url) {\n    return this._map.has(url);\n  }\n\n  dispose(url) {\n    // Do not destroy textures created by Texture.from (managed by Pixi's cache);\n    // only release our Map reference.\n    if (url && this._map.has(url)) this._map.delete(url);\n  }\n\n  clear() {\n    this._map.clear();\n  }\n}\n","import { Graphics } from 'pixi.js';\n\n// Simple rain system with variable speeds and single-bounce behavior on solid tiles.\nexport default class WeatherRain {\n  constructor(container, api, getIntensity) {\n    this.container = container;\n    this.api = api;\n    this.getIntensity = getIntensity || (() => 0);\n    this.width = api.mapWidth * api.tileSize;\n    this.height = api.mapHeight * api.tileSize;\n    this.particles = [];\n    this.intensity = 0;\n    const area = this.width * this.height;\n    // Reasonable particle cap depending on viewport area to keep FPS stable\n    this.maxParticles = 400; // Base for 1280x720\n  }\n\n  resize(width, height) {\n    const area = width * height;\n    this.maxParticles = Math.max(160, Math.floor(area / 2300));\n  }\n\n  setIntensity(v) {\n    this.intensity = Math.max(0, Math.min(100, Number(v) || 0));\n  }\n\n  spawnOne() {\n    const g = new Graphics();\n    g.clear();\n    // Draw a thin slanted line to mimic a raindrop motion blur\n    g.rect(0, 0, 1.3, 9);\n    g.fill({ color: 0x4aa3ff, alpha: 0.92 });\n\n    // Get viewport info if available\n    const viewport = this.api.getViewport ? this.api.getViewport() : null;\n    \n    let x, y;\n    if (viewport) {\n      // Spawn within viewport plus a small margin for slanted fall\n      x = viewport.x - 100 + Math.random() * (viewport.width + 200);\n      y = viewport.y - 10 - Math.random() * 30;\n    } else {\n      x = Math.random() * this.width;\n      y = -10 - Math.random() * 30;\n    }\n\n    const speed = 520 + Math.random() * 520; // px/s, different speeds for depth\n    const vx = (Math.random() * 60 - 30); // slight wind\n    const vy = speed;\n    g.x = x;\n    g.y = y;\n    g.rotation = 0.15; // slight tilt\n    this.container.addChild(g);\n    this.particles.push({ g, x, y, vx, vy, bounces: 0, alive: true });\n  }\n\n  update(dtMs) {\n    // Get viewport info if available\n    const viewport = this.api.getViewport ? this.api.getViewport() : null;\n\n    // Smooth intensity transition\n    const targetIntensity = Math.max(0, Math.min(100, this.getIntensity()));\n    if (Math.abs(targetIntensity - this.intensity) > 0.1) {\n      // Exponential smoothing (approx 2s to reach 95% of target)\n      const lerpFactor = 1 - Math.exp(-0.0015 * dtMs);\n      this.intensity += (targetIntensity - this.intensity) * lerpFactor;\n    } else if (this.intensity !== targetIntensity) {\n      this.intensity = targetIntensity;\n    }\n\n    // Constant-density controller: keep active particles near target count\n    const norm = Math.max(0, Math.min(1, this.intensity / 100));\n    const scaled = Math.pow(norm, 1.15);\n    let target = Math.floor(this.maxParticles * scaled);\n    if (scaled > 0 && target < 8) target = 8; // small baseline so low intensity still visible\n\n    const deficit = target - this.particles.length;\n    if (deficit > 0) {\n      // Smooth ramp, spawn only a fraction per frame to avoid bursts\n      const maxPerFrame = 48;\n      const smooth = Math.max(1, Math.ceil(target * 0.02));\n      const toSpawn = Math.min(deficit, smooth, maxPerFrame);\n      for (let i = 0; i < toSpawn; i++) this.spawnOne();\n    }\n    // Gentle over-target culling to keep density steady\n    if (this.particles.length > target) {\n      const surplus = this.particles.length - target;\n      const toCull = Math.min(surplus, Math.max(1, Math.ceil(this.particles.length * 0.02)));\n      for (let i = 0; i < toCull; i++) {\n        const p = this.particles.pop();\n        if (!p) break;\n        try { p.g.parent && p.g.parent.removeChild(p.g); } catch {}\n        try { p.g.destroy(); } catch {}\n      }\n    }\n\n    const gAcc = 1800; // gravity px/s^2\n    const dt = dtMs / 1000;\n    const toRemove = [];\n\n    for (let i = 0; i < this.particles.length; i++) {\n      const p = this.particles[i];\n      if (!p.alive) { toRemove.push(i); continue; }\n\n      p.vy += gAcc * dt;\n      let nx = p.x + p.vx * dt;\n      let ny = p.y + p.vy * dt;\n\n      // Liquid surface interaction: water/lava\n      try {\n        if (typeof this.api.getLiquidSurfaceY === 'function') {\n          // Prefer closest surface above current ny\n          const syWater = this.api.getLiquidSurfaceY('water', nx);\n          if (Number.isFinite(syWater) && ny >= syWater) {\n            // Hit water surface  spawn small splash and despawn\n            const speed = Math.max(0, Math.min(1500, p.vy));\n            const strength = Math.min(2, 0.4 + speed / 900);\n            if (typeof this.api.onWaterImpact === 'function') this.api.onWaterImpact({ x: nx, strength });\n            p.alive = false; toRemove.push(i);\n            continue;\n          }\n          const syLava = this.api.getLiquidSurfaceY('lava', nx);\n          if (Number.isFinite(syLava) && ny >= syLava) {\n            // Hit lava  steam puff and despawn\n            const speed = Math.max(0, Math.min(1500, p.vy));\n            const strength = Math.min(2, 0.35 + speed / 1200);\n            if (typeof this.api.onLavaImpact === 'function') this.api.onLavaImpact({ x: nx, y: syLava, strength });\n            p.alive = false; toRemove.push(i);\n            continue;\n          }\n        }\n      } catch {}\n\n      // Collision check (treat as point)\n      if (this.api.isSolidAt(nx, ny)) {\n        // Backtrack slightly to stand above surface\n        let guard = 0;\n        while (this.api.isSolidAt(nx, ny) && guard < 6) { ny -= 1; guard++; }\n        // Bounce once, then fade out quickly on next impact\n        if (p.bounces === 0 && Math.abs(p.vy) > 150) {\n          p.vy = -p.vy * 0.3; // dampened bounce\n          p.vx *= 0.8;\n          p.bounces++;\n        } else {\n          // Small splash effect: shrink line and fade\n          p.alive = false;\n          toRemove.push(i);\n        }\n      }\n\n      p.x = nx;\n      p.y = ny;\n      p.g.x = p.x;\n      p.g.y = p.y;\n\n      // Off-screen cleanup\n      const vY = viewport ? viewport.y : 0;\n      const vH = viewport ? viewport.height : this.height;\n      if (p.y > vY + vH + 100 || p.y > this.height + 40 || p.x < -40 || p.x > this.width + 40) {\n        p.alive = false;\n        toRemove.push(i);\n      }\n    }\n\n    // remove in reverse\n    for (let j = toRemove.length - 1; j >= 0; j--) {\n      const idx = toRemove[j];\n      const p = this.particles[idx];\n      if (p && p.g && p.g.parent) p.g.parent.removeChild(p.g);\n      if (p && p.g && p.g.destroy) try { p.g.destroy(); } catch {}\n      this.particles.splice(idx, 1);\n    }\n  }\n\n  destroy() {\n    this.particles.forEach(p => {\n      try { p.g.parent && p.g.parent.removeChild(p.g); } catch {}\n      try { p.g.destroy(); } catch {}\n    });\n    this.particles = [];\n  }\n}\n","import { Graphics } from 'pixi.js';\n\n// Snow system: slow fluttering flakes with varied speeds; stop on blocks without bouncing.\nexport default class WeatherSnow {\n  constructor(container, api, getIntensity) {\n    this.container = container;\n    this.api = api;\n    this.getIntensity = getIntensity || (() => 0);\n    this.width = api.mapWidth * api.tileSize;\n    this.height = api.mapHeight * api.tileSize;\n    this.flakes = [];\n    this.intensity = 0;\n    const area = this.width * this.height;\n    // Snow lasts longer; keep a tighter cap than rain for performance\n    this.maxFlakes = 300; // Base for 1280x720\n  }\n\n  resize(width, height) {\n    const area = width * height;\n    this.maxFlakes = Math.max(120, Math.floor(area / 3000));\n  }\n\n  setIntensity(v) {\n    this.intensity = Math.max(0, Math.min(100, Number(v) || 0));\n  }\n\n  spawnOne() {\n    const g = new Graphics();\n    g.clear();\n    // Slightly larger/more visible flakes on average\n    const r = 1.2 + Math.random() * 2.0; // radius\n    g.circle(0, 0, r);\n    g.fill({ color: 0xffffff, alpha: 0.97 });\n\n    // Get viewport info if available\n    const viewport = this.api.getViewport ? this.api.getViewport() : null;\n\n    let x, y;\n    if (viewport) {\n      // Spawn within viewport plus margin\n      x = viewport.x - 100 + Math.random() * (viewport.width + 200);\n      y = viewport.y - 10 - Math.random() * 30;\n    } else {\n      x = Math.random() * this.width;\n      y = -10 - Math.random() * 30;\n    }\n\n    const speed = 40 + Math.random() * 80; // slower than rain, but a bit more range\n    const drift = (Math.random() * 50 - 25); // horizontal drift\n    g.x = x;\n    g.y = y;\n    this.container.addChild(g);\n    this.flakes.push({ g, x, y, vx: drift, vy: speed, alive: true, settled: false, life: 1.0, phase: 'fall', restMs: 0 });\n  }\n\n  update(dtMs) {\n    // Get viewport info if available\n    const viewport = this.api.getViewport ? this.api.getViewport() : null;\n\n    // Smooth intensity transition\n    const targetIntensity = Math.max(0, Math.min(100, this.getIntensity()));\n    if (Math.abs(targetIntensity - this.intensity) > 0.1) {\n      // Exponential smoothing (approx 2s to reach 95% of target)\n      const lerpFactor = 1 - Math.exp(-0.0015 * dtMs);\n      this.intensity += (targetIntensity - this.intensity) * lerpFactor;\n    } else if (this.intensity !== targetIntensity) {\n      this.intensity = targetIntensity;\n    }\n\n    // Constant-density controller to avoid wavey bursts\n    const norm = Math.max(0, Math.min(1, this.intensity / 100));\n    const scaled = Math.pow(norm, 1.15);\n    let target = Math.floor(this.maxFlakes * scaled);\n    if (scaled > 0 && target < 10) target = 10;\n\n    const deficit = target - this.flakes.length;\n    if (deficit > 0) {\n      const maxPerFrame = 24; // slower than rain\n      const smooth = Math.max(1, Math.ceil(target * 0.015));\n      const toSpawn = Math.min(deficit, smooth, maxPerFrame);\n      for (let i = 0; i < toSpawn; i++) this.spawnOne();\n    }\n    // Gentle over-target culling to keep density steady when slider decreases\n    if (this.flakes.length > target) {\n      const surplus = this.flakes.length - target;\n      const toCull = Math.min(surplus, Math.max(1, Math.ceil(this.flakes.length * 0.015)));\n      for (let i = 0; i < toCull; i++) {\n        const f = this.flakes.pop();\n        if (!f) break;\n        try { f.g.parent && f.g.parent.removeChild(f.g); } catch {}\n        try { f.g.destroy(); } catch {}\n      }\n    }\n\n    const gAcc = 200; // gentle gravity\n    const dt = dtMs / 1000;\n    const toRemove = [];\n\n    for (let i = 0; i < this.flakes.length; i++) {\n      const f = this.flakes[i];\n      if (!f.alive) { toRemove.push(i); continue; }\n\n      if (f.phase === 'fall') {\n        f.vy = Math.min(140, f.vy + gAcc * dt);\n        // small oscillation for flutter\n        f.vx += Math.sin((f.y + i) * 0.02) * 7 * dt;\n        let nx = f.x + f.vx * dt;\n        let ny = f.y + f.vy * dt;\n\n        // Liquid interaction first\n        try {\n          if (typeof this.api.getLiquidSurfaceY === 'function') {\n            const sYwater = this.api.getLiquidSurfaceY('water', nx);\n            if (Number.isFinite(sYwater) && ny >= sYwater) {\n              // Land on water surface and rest for a bit\n              ny = sYwater - 0.5;\n              f.x = nx; f.y = ny; f.vx = 0; f.vy = 0;\n              f.phase = 'rest';\n              f.restMs = 800 + Math.random() * 400; // 0.8..1.2s\n              // Do not continue to solid collision checks this frame\n              // Update display and proceed to next flake\n              f.g.x = f.x; f.g.y = f.y;\n              continue;\n            }\n            const sYlava = this.api.getLiquidSurfaceY('lava', nx);\n            if (Number.isFinite(sYlava) && ny >= sYlava) {\n              // Steam puff and despawn\n              if (typeof this.api.onLavaImpact === 'function') this.api.onLavaImpact({ x: nx, y: sYlava, strength: 0.5 });\n              f.alive = false; toRemove.push(i); continue;\n            }\n          }\n        } catch {}\n\n        // Solid collision\n        if (this.api.isSolidAt(nx, ny)) {\n          // backtrack up to stand above the surface\n          let guard = 0;\n          while (this.api.isSolidAt(nx, ny) && guard < 10) { ny -= 1; guard++; }\n          f.settled = true;\n          f.vx = 0;\n          f.vy = 0;\n          f.phase = 'rest';\n          f.restMs = 800 + Math.random() * 400;\n        }\n\n        f.x = nx;\n        f.y = ny;\n      } else if (f.phase === 'rest') {\n        // Flake rests on surface for a short time (water or ground), then starts sinking/falling slowly\n        f.restMs -= dtMs;\n        if (f.restMs <= 0) {\n          f.phase = 'sinking';\n          // resume gentle fall with reduced alpha\n          f.vx = (Math.random() * 20 - 10);\n          f.vy = 20 + Math.random() * 20;\n        }\n      } else if (f.phase === 'sinking') {\n        // Continue downward slowly; fade out progressively\n        f.vy = Math.min(60, f.vy + gAcc * 0.3 * dt);\n        f.x += f.vx * dt;\n        f.y += f.vy * dt;\n        f.life -= 0.22 * dt;\n        if (f.life <= 0) { f.alive = false; toRemove.push(i); }\n      }\n\n      f.g.x = f.x;\n      f.g.y = f.y;\n      if (f.phase === 'rest' || f.phase === 'sinking' || f.settled) f.g.alpha = Math.max(0, Math.min(1, f.life));\n\n      if (f.y > this.height + 40 || f.x < -40 || f.x > this.width + 40 || (viewport && f.y > viewport.y + viewport.height + 100)) {\n        f.alive = false;\n        toRemove.push(i);\n      }\n    }\n\n    for (let j = toRemove.length - 1; j >= 0; j--) {\n      const idx = toRemove[j];\n      const f = this.flakes[idx];\n      if (f && f.g && f.g.parent) f.g.parent.removeChild(f.g);\n      if (f && f.g && f.g.destroy) try { f.g.destroy(); } catch {}\n      this.flakes.splice(idx, 1);\n    }\n  }\n\n  destroy() {\n    this.flakes.forEach(f => {\n      try { f.g.parent && f.g.parent.removeChild(f.g); } catch {}\n      try { f.g.destroy(); } catch {}\n    });\n    this.flakes = [];\n  }\n}\n","import { Graphics, BlurFilter } from 'pixi.js';\n\n// Clouds overlay: organic cloud blobs drifting in the top 30% of the screen.\nexport default class WeatherClouds {\n  constructor(container, api, getIntensity) {\n    this.container = container;\n    this.api = api;\n    this.getIntensity = getIntensity || (() => 0);\n    this.width = api.mapWidth * api.tileSize;\n    this.height = api.mapHeight * api.tileSize;\n    this.bandHeight = Math.max(1, Math.floor(this.height * 0.3)); // top 30%\n    this.patches = [];\n    this.intensity = 0;\n    this.windDirection = 1; // 1: from left to right, -1: from right to left\n\n    // Soft blur for nicer cloud appearance\n    try {\n      this.container.filters = [new BlurFilter({ strength: 2.0, quality: 2 })];\n    } catch {}\n\n    this.rebuild();\n  }\n\n  setIntensity(v) {\n    this.intensity = Math.max(0, Math.min(100, Number(v) || 0));\n  }\n\n  spawnOne(isInitial = false) {\n    const g = new Graphics();\n    const w = 140 + Math.random() * 300; // cloud size\n    const h = 80 + Math.random() * 160;\n    \n    // Get viewport info if available\n    const viewport = this.api.getViewport ? this.api.getViewport() : null;\n    const vX = viewport ? viewport.x : 0;\n    const vY = viewport ? viewport.y : 0;\n    const vW = viewport ? viewport.width : this.width;\n\n    let x;\n    if (isInitial) {\n      // Initial scatter across the whole viewport (or map if no viewport)\n      const range = Math.max(vW, this.width) + 800;\n      const startX = viewport ? vX - 400 : -400;\n      x = startX + Math.random() * range;\n    } else if (viewport) {\n      // Dynamic spawn: place in or near viewport so the user sees results quickly\n      // We scatter them in a wider area around viewport [x-400, x+width+400]\n      x = viewport.x - 400 + Math.random() * (viewport.width + 800);\n    } else {\n      // Fallback to edges\n      x = (Math.random() < 0.5 ? -180 : this.width + 180);\n    }\n    \n    const y = vY - 40 + Math.random() * (this.bandHeight - 20); // only in band\n    const alpha = 0.08 + (this.intensity / 100) * (0.12 + Math.random() * 0.08);\n    const speed = 8 + Math.random() * 22; // horizontal drift speed\n    const vy = (Math.random() - 0.5) * 4; // subtle vertical drift\n\n    // Draw an organic cloud using overlapping circles (soft edges)\n    const rx = w * 0.5;\n    const ry = h * 0.5;\n    const circles = 8 + Math.floor(Math.random() * 6); // 8..13 lobes\n    const baseR = Math.min(rx, ry) * 0.55;\n    for (let k = 0; k < circles; k++) {\n      const t = (k / circles) * Math.PI * 2 + Math.random() * 0.6;\n      const dist = 0.2 + Math.random() * 0.35;\n      const cx = Math.cos(t) * rx * dist;\n      const cy = Math.sin(t) * ry * dist;\n      const r = baseR * (0.7 + Math.random() * 0.7);\n      g.circle(cx, cy, r);\n    }\n    // central mass\n    g.circle(0, 0, baseR * (0.9 + Math.random() * 0.5));\n    g.fill({ color: 0xffffff, alpha: 1.0 });\n    g.alpha = 0; // Start invisible for fade-in\n    g.x = x;\n    g.y = y;\n    this.container.addChild(g);\n    this.patches.push({ \n      g, w, h, \n      vx: speed * this.windDirection, \n      vy, \n      targetAlpha: alpha, \n      currentAlpha: 0,\n      phase: Math.random() * Math.PI * 2,\n      dying: false\n    });\n  }\n\n  resize(width, height) {\n    const w = Math.max(1, Math.floor(width));\n    const h = Math.max(1, Math.floor(height));\n    // We don't change this.width/height here as they are map bounds,\n    // but we can update bandHeight if the screen height changed significantly.\n    this.bandHeight = Math.max(1, Math.floor(h * 0.3)); \n  }\n\n  rebuild() {\n    // Clear existing\n    for (const p of this.patches) {\n      try { p.g.parent && p.g.parent.removeChild(p.g); } catch {}\n      try { p.g.destroy(); } catch {}\n    }\n    this.patches = [];\n\n    const viewport = this.api.getViewport ? this.api.getViewport() : null;\n    const vW = viewport ? viewport.width : 1280;\n    const targetCount = Math.round((this.intensity / 100) * 18 * (vW / 1280));\n    \n    for (let i = 0; i < targetCount; i++) {\n      this.spawnOne(true);\n      // For initial ones, set alpha immediately\n      if (this.patches.length > 0) {\n        const p = this.patches[this.patches.length - 1];\n        p.currentAlpha = p.targetAlpha;\n        p.g.alpha = p.currentAlpha;\n      }\n    }\n  }\n\n  update(dtMs) {\n    // Live intensity update with smoothing\n    const targetIntensity = Math.max(0, Math.min(100, this.getIntensity()));\n    if (Math.abs(targetIntensity - this.intensity) > 0.1) {\n      const lerpFactor = 1 - Math.exp(-0.0015 * dtMs);\n      this.intensity += (targetIntensity - this.intensity) * lerpFactor;\n    } else if (this.intensity !== targetIntensity) {\n      this.intensity = targetIntensity;\n    }\n\n    const dt = dtMs / 1000;\n    const W = this.width;\n    const viewport = this.api.getViewport ? this.api.getViewport() : null;\n    const vX = viewport ? viewport.x : 0;\n    const vY = viewport ? viewport.y : 0;\n    const vW = viewport ? viewport.width : 1280;\n    const vH = viewport ? viewport.height : 720;\n\n    const bandTop = vY - 100;\n    const bandBottom = vY + this.bandHeight;\n\n    // Adjust cloud count gradually\n    // We scale target count based on viewport width (default 18 for 1280px)\n    const targetCount = Math.round((this.intensity / 100) * 18 * (vW / 1280));\n    \n    const activePatches = this.patches.filter(p => {\n      if (p.dying) return false;\n      if (!viewport) return true;\n      // Only count patches that are within a reasonable distance of the viewport\n      return p.g.x > vX - 1000 && p.g.x < vX + vW + 1000;\n    });\n    \n    if (activePatches.length < targetCount) {\n      // Spawn one cloud per ~300ms if needed, to avoid sudden pops\n      this._spawnTimer = (this._spawnTimer || 0) + dtMs;\n      if (this._spawnTimer > 300 || activePatches.length === 0) {\n        this.spawnOne(activePatches.length === 0);\n        this._spawnTimer = 0;\n      }\n    } else if (activePatches.length > targetCount) {\n      // Mark one for death\n      const toKill = activePatches[0];\n      if (toKill) toKill.dying = true;\n    }\n\n    const toRemove = [];\n    for (let i = 0; i < this.patches.length; i++) {\n      const p = this.patches[i];\n      // drift\n      p.g.x += p.vx * dt;\n      p.g.y += p.vy * dt;\n\n      // Alpha handling\n      p.phase += dt * 0.35;\n      const osc = (Math.sin(p.phase) + 1) * 0.5; // 0..1\n      \n      // Cleanup if too far from viewport (e.g. teleport)\n      if (viewport && !p.dying && (p.g.x < vX - 2500 || p.g.x > vX + vW + 2500)) {\n        p.dying = true;\n      }\n\n      if (p.dying) {\n        p.currentAlpha -= dt * 0.1; // Fade out slowly\n        if (p.currentAlpha <= 0) {\n          toRemove.push(i);\n          continue;\n        }\n      } else if (p.currentAlpha < p.targetAlpha) {\n        p.currentAlpha += dt * 0.05; // Fade in slowly\n        if (p.currentAlpha > p.targetAlpha) p.currentAlpha = p.targetAlpha;\n      }\n\n      p.g.alpha = Math.max(0, Math.min(0.55, p.currentAlpha * (0.75 + 0.5 * osc)));\n\n      // wrap horizontally\n      const margin = 800; // Increased margin to ensure they don't pop out visibly\n      if (viewport) {\n          const leftBound = vX - margin;\n          const rightBound = vX + vW + margin;\n          if (p.g.x < leftBound) p.g.x = rightBound;\n          if (p.g.x > rightBound) p.g.x = leftBound;\n      } else {\n          if (p.g.x < -margin) p.g.x = W + margin;\n          if (p.g.x > W + margin) p.g.x = -margin;\n      }\n      // constrain within top band vertically (wrap within band only)\n      if (p.g.y < bandTop) p.g.y = bandBottom;\n      if (p.g.y > bandBottom) p.g.y = bandTop;\n    }\n\n    // Remove dead patches\n    for (let j = toRemove.length - 1; j >= 0; j--) {\n      const idx = toRemove[j];\n      const p = this.patches[idx];\n      try { p.g.parent && p.g.parent.removeChild(p.g); } catch {}\n      try { p.g.destroy(); } catch {}\n      this.patches.splice(idx, 1);\n    }\n  }\n\n  destroy() {\n    try { this.container.filters = []; } catch {}\n    for (const p of this.patches) {\n      try { p.g.parent && p.g.parent.removeChild(p.g); } catch {}\n      try { p.g.destroy(); } catch {}\n    }\n    this.patches = [];\n  }\n}\n","import { Graphics, Texture, TilingSprite } from 'pixi.js';\n\n// Full-screen fog overlay: a semi-transparent rectangle covering entire viewport.\n// Intensity 0..100 maps to alpha 0..0.65.\nexport default class WeatherFog {\n  constructor(container, api, getIntensity) {\n    this.container = container;\n    this.api = api;\n    this.getIntensity = getIntensity || (() => 0);\n    this.width = api.mapWidth * api.tileSize;\n    this.height = api.mapHeight * api.tileSize;\n    this.intensity = 0;\n    this.time = 0; // ms accumulator for subtle breathing\n\n    // Base tint rectangle drawn once; alpha controlled via displayObject alpha (no redraws per frame)\n    this.g = new Graphics();\n    this.container.addChild(this.g);\n\n    // Build procedural noise texture once (small size, repeats as tiling sprites)\n    this.noiseTex = WeatherFog._createNoiseTexture(128, 128);\n    this.layer1 = new TilingSprite(this.noiseTex, this.width, this.height);\n    this.layer2 = new TilingSprite(this.noiseTex, this.width, this.height);\n    // Different scales for parallax effect\n    this.layer1.tileScale.set(1.0, 1.0);\n    this.layer2.tileScale.set(0.6, 0.8);\n    // Start with zero alpha; will be set based on intensity\n    this.layer1.alpha = 0;\n    this.layer2.alpha = 0;\n    this.container.addChild(this.layer1);\n    this.container.addChild(this.layer2);\n\n    // Precompute parameters\n    this._recalcParams();\n    this._draw();\n  }\n\n  _alphaFromIntensity(v) {\n    const t = Math.max(0, Math.min(100, Number(v) || 0)) / 100; // 0..1\n    return Math.max(0, Math.min(0.65, t * 0.65));\n  }\n\n  setIntensity(v) {\n    const nv = Math.max(0, Math.min(100, Number(v) || 0));\n    if (nv === this.intensity) return;\n    this.intensity = nv;\n    this._recalcParams();\n    this._applyAlphas(0); // update layer alphas based on new intensity\n    this._draw();\n  }\n\n  resize(width, height) {\n    const w = Math.max(1, Math.floor(width));\n    const h = Math.max(1, Math.floor(height));\n    if (w === this.width && h === this.height) return;\n    this.width = w;\n    this.height = h;\n    // Resize tiling sprites and redraw base rect\n    if (this.layer1) { this.layer1.width = w; this.layer1.height = h; }\n    if (this.layer2) { this.layer2.width = w; this.layer2.height = h; }\n    this._draw();\n  }\n\n  _draw() {\n    const w = this.width;\n    const h = this.height;\n    const g = this.g;\n    g.clear();\n    const baseAlpha = this._alphaFromIntensity(this.intensity);\n    if (baseAlpha <= 0) {\n      g.alpha = 0;\n      return;\n    }\n    // Draw once with alpha 1, then control real alpha via g.alpha each frame\n    // We draw a large rectangle to cover the viewport\n    g.rect(0, 0, w, h);\n    g.fill({ color: 0x9fb7c9, alpha: 1 });\n    g.alpha = baseAlpha;\n  }\n\n  update(dtMs) {\n    // Smooth intensity transition\n    const targetIntensity = Math.max(0, Math.min(100, this.getIntensity()));\n    if (Math.abs(targetIntensity - this.intensity) > 0.1) {\n      const lerpFactor = 1 - Math.exp(-0.0015 * dtMs);\n      this.setIntensity(this.intensity + (targetIntensity - this.intensity) * lerpFactor);\n    } else if (this.intensity !== targetIntensity) {\n      this.setIntensity(targetIntensity);\n    }\n\n    const viewport = this.api.getViewport ? this.api.getViewport() : null;\n    if (viewport) {\n      // Follow camera\n      if (this.g) this.g.x = viewport.x;\n      if (this.layer1) this.layer1.x = viewport.x;\n      if (this.layer2) this.layer2.x = viewport.x;\n      \n      // We also need to follow Y if the map is tall\n      if (this.g) this.g.y = viewport.y;\n      if (this.layer1) this.layer1.y = viewport.y;\n      if (this.layer2) this.layer2.y = viewport.y;\n    }\n\n    // Advance time for breathing/pulse\n    const dt = Math.max(0, Number(dtMs) || 16.67);\n    this.time += dt;\n    // Very subtle breathing: sine between ~0.96 .. 1.04\n    const pulse = 1 + 0.04 * Math.sin(this.time * 0.0012);\n    this._applyAlphas(pulse);\n\n    // Scroll noise layers slowly\n    if (this.layer1) {\n      this.layer1.tilePosition.x += this.speed1.x * dt;\n      this.layer1.tilePosition.y += this.speed1.y * dt;\n    }\n    if (this.layer2) {\n      this.layer2.tilePosition.x += this.speed2.x * dt;\n      this.layer2.tilePosition.y += this.speed2.y * dt;\n    }\n  }\n\n  destroy() {\n    if (this.g) {\n      try { this.g.parent && this.g.parent.removeChild(this.g); } catch {}\n      try { this.g.destroy(); } catch {}\n    }\n    this.g = null;\n    try {\n      if (this.layer1) { this.layer1.parent && this.layer1.parent.removeChild(this.layer1); this.layer1.destroy(true); }\n    } catch {}\n    try {\n      if (this.layer2) { this.layer2.parent && this.layer2.parent.removeChild(this.layer2); this.layer2.destroy(true); }\n    } catch {}\n    this.layer1 = null;\n    this.layer2 = null;\n    try { this.noiseTex?.destroy(true); } catch {}\n    this.noiseTex = null;\n  }\n\n  _applyAlphas(pulseFactor = 1) {\n    const base = this._alphaFromIntensity(this.intensity);\n    // Noise contribution grows with intensity but remains subtle\n    const t = Math.max(0, Math.min(1, this.intensity / 100));\n    const noiseAlpha = base * (0.25 + 0.35 * t); // up to ~0.4 of base\n    if (this.g) this.g.alpha = base * pulseFactor;\n    if (this.layer1) this.layer1.alpha = noiseAlpha * 0.8;\n    if (this.layer2) this.layer2.alpha = noiseAlpha;\n  }\n\n  _recalcParams() {\n    // Map intensity to drift speeds (pixels per ms)\n    const t = Math.max(0, Math.min(1, this.intensity / 100));\n    const lerp = (a, b, u) => a + (b - a) * u;\n    // Two layers drifting in different directions\n    this.speed1 = { x: lerp(0.005, 0.025, t), y: lerp(0.0, 0.012, t) };\n    this.speed2 = { x: lerp(-0.006, -0.018, t), y: lerp(0.004, 0.02, t) };\n  }\n\n  // Static helper: generate small grayscale noise texture\n  static _createNoiseTexture(w = 128, h = 128) {\n    const canvas = document.createElement('canvas');\n    canvas.width = w; canvas.height = h;\n    const ctx = canvas.getContext('2d');\n    const img = ctx.createImageData(w, h);\n    // Use a gentle noise range to avoid harsh contrast\n    for (let i = 0; i < img.data.length; i += 4) {\n      const v = 200 + Math.floor(Math.random() * 55); // 200..254\n      img.data[i] = v;\n      img.data[i + 1] = v;\n      img.data[i + 2] = v;\n      img.data[i + 3] = 255;\n    }\n    ctx.putImageData(img, 0, 0);\n    return Texture.from(canvas);\n  }\n}\n","import { Graphics, BlurFilter } from 'pixi.js';\n\n// Thunder/Lightning weather effect\n// API:\n//   new WeatherThunder(container, api, getIntensity)\n//   setIntensity(v), resize(w,h), update(dtMs), destroy()\n// Notes:\n// - Renders inside weather layer (below fog). Blocks/tiles remain above fog.\n// - Picks random strike targets above solid tiles using api.isSolidAt(x,y).\nexport default class WeatherThunder {\n  constructor(container, api, getIntensity) {\n    this.container = container;\n    this.api = api || {};\n    this.getIntensity = getIntensity || (() => 0);\n    this.width = (api?.mapWidth || 0) * (api?.tileSize || 32);\n    this.height = (api?.mapHeight || 0) * (api?.tileSize || 32);\n\n    this.intensity = 0;\n    this.time = 0;\n    this.nextStrikeMs = Infinity; // scheduled delay to next strike\n    this.flashAlpha = 0; // global white flash\n    this.flashDecay = 0.0;\n    this.boltAlive = false;\n    this.boltTime = 0; // ms since bolt spawned\n    this.boltDuration = 0; // ms total\n\n    // Graphics\n    this.flashG = new Graphics();\n    this.boltG = new Graphics();\n    // Add slight glow to bolt\n    try {\n      this.boltG.filters = [new BlurFilter(2, 1)];\n    } catch {}\n    this.container.addChild(this.flashG);\n    this.container.addChild(this.boltG);\n\n    // Build once\n    this._scheduleNextStrike(true);\n  }\n\n  setIntensity(v) {\n    const nv = Math.max(0, Math.min(100, Number(v) || 0));\n    if (nv === this.intensity) return;\n    this.intensity = nv;\n    if (nv <= 0) {\n      // disable visuals\n      this.flashAlpha = 0;\n      this.boltAlive = false;\n      this._redrawFlash();\n      this._clearBolt();\n      this.nextStrikeMs = Infinity;\n    } else if (!Number.isFinite(this.nextStrikeMs) || this.nextStrikeMs === Infinity) {\n      this._scheduleNextStrike(true);\n    }\n  }\n\n  resize(w, h) {\n    const W = Math.max(1, Math.floor(w));\n    const H = Math.max(1, Math.floor(h));\n    if (W === this.width && H === this.height) return;\n    this.width = W;\n    this.height = H;\n    // redraw flash when active\n    if (this.flashAlpha > 0) this._redrawFlash();\n  }\n\n  update(dtMs) {\n    // Smooth intensity transition\n    const targetIntensity = Math.max(0, Math.min(100, this.getIntensity()));\n    if (Math.abs(targetIntensity - this.intensity) > 0.1) {\n      const lerpFactor = 1 - Math.exp(-0.0015 * dtMs);\n      this.setIntensity(this.intensity + (targetIntensity - this.intensity) * lerpFactor);\n    } else if (this.intensity !== targetIntensity) {\n      this.setIntensity(targetIntensity);\n    }\n\n    const dt = Math.max(0, Number(dtMs) || 16.67);\n    if (this.intensity <= 0) return;\n\n    // Update scheduling\n    this.nextStrikeMs -= dt;\n    if (this.nextStrikeMs <= 0) {\n      // Perform strike: trigger screen flash and draw bolt\n      this._triggerFlash();\n      this._createBolt();\n      this._scheduleNextStrike(false); // schedule next time after immediate strike window\n    }\n\n    // Flash decay\n    if (this.flashAlpha > 0) {\n      // exponential-like decay via linear factor raised with dt\n      const decayPerMs = this.flashDecay || 0.004; // higher = quicker fade\n      this.flashAlpha = Math.max(0, this.flashAlpha - decayPerMs * dt);\n      this._redrawFlash();\n    }\n\n    // Bolt lifetime\n    if (this.boltAlive) {\n      this.boltTime += dt;\n      const t = this.boltTime / Math.max(1, this.boltDuration);\n      // Fade color/alpha over time\n      const remain = Math.max(0, 1 - t);\n      this.boltG.alpha = 0.25 + 0.75 * remain;\n      if (this.boltTime >= this.boltDuration) {\n        this._clearBolt();\n      }\n    }\n  }\n\n  destroy() {\n    try { this.flashG.parent && this.flashG.parent.removeChild(this.flashG); } catch {}\n    try { this.flashG.destroy(true); } catch {}\n    try { this.boltG.parent && this.boltG.parent.removeChild(this.boltG); } catch {}\n    try { this.boltG.destroy(true); } catch {}\n    this.flashG = null;\n    this.boltG = null;\n    this.container = null;\n  }\n\n  // Internal helpers\n  _scheduleNextStrike(initial) {\n    // Map intensity 1..100 to delay: from ~9000..6000 ms down to ~2500..1000 ms\n    if (this.intensity <= 0) { this.nextStrikeMs = Infinity; return; }\n    const t = Math.max(0, Math.min(1, this.intensity / 100));\n    const minDelay = this._lerp(1000, 2500, 1 - t); // at high intensity, between 12.5s\n    const maxDelay = this._lerp(2500, 9000, 1 - t); // at low intensity, up to ~9s\n    const delay = this._rand(minDelay, maxDelay);\n    this.nextStrikeMs = initial ? this._rand(400, 1400) : delay; // first strike quicker on enable\n  }\n\n  _triggerFlash() {\n    // Brightness based on intensity, with slight randomness\n    const t = Math.max(0, Math.min(1, this.intensity / 100));\n    const base = this._lerp(0.25, 0.9, t);\n    this.flashAlpha = Math.min(1, base * this._rand(0.8, 1));\n    // fade time scales with intensity (brighter fades a bit slower)\n    this.flashDecay = this._lerp(0.008, 0.004, t);\n    this._redrawFlash();\n  }\n\n  _redrawFlash() {\n    const g = this.flashG;\n    g.clear();\n    if (this.flashAlpha <= 0) return;\n    \n    const viewport = this.api.getViewport ? this.api.getViewport() : null;\n    if (viewport) {\n      g.x = viewport.x;\n      g.y = viewport.y;\n      g.rect(0, 0, viewport.width, viewport.height);\n    } else {\n      g.rect(0, 0, this.width, this.height);\n    }\n    g.fill({ color: 0xffffff, alpha: this.flashAlpha });\n  }\n\n  _createBolt() {\n    // Determine target using solid scan from top\n    const W = this.width, H = this.height;\n    \n    // Get viewport info if available\n    const viewport = this.api.getViewport ? this.api.getViewport() : null;\n    \n    let x, topY;\n    if (viewport) {\n      // Strike within viewport\n      x = Math.floor(viewport.x + this._rand(8, viewport.width - 8));\n      topY = viewport.y - Math.floor(this._rand(10, 40));\n    } else {\n      x = Math.floor(this._rand(8, W - 8));\n      topY = -Math.floor(this._rand(10, 40)); // start slightly above top\n    }\n\n    const targetY = this._findGroundY(x, H);\n    const endY = Number.isFinite(targetY) ? Math.max(0, targetY - this._rand(8, 16)) : Math.floor(H * 0.6);\n\n    // Build polyline with jittered segments from top to end\n    const segments = Math.max(8, Math.floor((endY - topY) / this._rand(10, 16)));\n    const jitterX = this._lerp(6, 18, Math.max(0, Math.min(1, this.intensity / 100)));\n    const points = [];\n    let cx = x;\n    let cy = topY;\n    points.push({ x: cx, y: cy });\n    for (let i = 1; i <= segments; i++) {\n      const ny = topY + Math.floor(((endY - topY) * i) / segments);\n      const nx = x + this._rand(-jitterX, jitterX);\n      cx = nx; cy = ny;\n      points.push({ x: cx, y: cy });\n    }\n\n    // Draw main bolt\n    const g = this.boltG;\n    g.clear();\n    const thickness = this._lerp(2, 5, Math.max(0, Math.min(1, this.intensity / 100)));\n    const color = 0xCCEEFF;\n    g.moveTo(points[0].x, points[0].y);\n    for (let i = 1; i < points.length; i++) g.lineTo(points[i].x, points[i].y);\n    g.stroke({ width: thickness, color, alpha: 1, alignment: 0.5, cap: 'round', join: 'round' });\n\n    // Branches: some short forks from random mid points\n    const branchCount = Math.floor(this._lerp(1, 3, Math.max(0, Math.min(1, this.intensity / 100))));\n    for (let b = 0; b < branchCount; b++) {\n      const idx = Math.floor(this._rand(2, points.length - 2));\n      const p = points[idx];\n      const len = this._rand(30, 80);\n      const ang = this._rand(-Math.PI * 0.5, Math.PI * 0.5);\n      const bx = p.x + Math.cos(ang) * len;\n      const by = p.y + Math.sin(ang) * len;\n      g.moveTo(p.x, p.y);\n      g.lineTo(bx, by);\n      g.stroke({ width: Math.max(1, thickness * 0.55), color, alpha: 0.9, alignment: 0.5 });\n    }\n\n    this.boltAlive = true;\n    this.boltTime = 0;\n    this.boltDuration = this._rand(120, 260); // very brief\n    this.boltG.alpha = 1;\n  }\n\n  _clearBolt() {\n    if (!this.boltG) return;\n    this.boltAlive = false;\n    this.boltTime = 0;\n    this.boltDuration = 0;\n    try { this.boltG.clear(); } catch {}\n  }\n\n  _findGroundY(worldX, maxH) {\n    // Scan from top to bottom to find first solid tile boundary\n    const isSolid = this.api?.isSolidAt;\n    if (typeof isSolid !== 'function') return null;\n    for (let y = 0; y < maxH; y += 4) {\n      if (isSolid(worldX, y)) {\n        return y;\n      }\n    }\n    return null;\n  }\n\n  _rand(a, b) {\n    if (b === undefined) { b = a; a = 0; }\n    return a + Math.random() * (b - a);\n  }\n\n  _lerp(a, b, t) { return a + (b - a) * t; }\n}\n","import { Graphics } from 'pixi.js';\n\n// Lava rain system: similar to rain but red/orange and potentially deals damage (handled by engine)\nexport default class WeatherLavaRain {\n  constructor(container, api, getIntensity) {\n    this.container = container;\n    this.api = api;\n    this.getIntensity = getIntensity || (() => 0);\n    this.width = api.mapWidth * api.tileSize;\n    this.height = api.mapHeight * api.tileSize;\n    this.particles = [];\n    this.intensity = 0;\n    this.maxParticles = 300; \n  }\n\n  resize(width, height) {\n    const area = width * height;\n    this.maxParticles = Math.max(120, Math.floor(area / 3000));\n  }\n\n  spawnOne() {\n    const g = new Graphics();\n    g.clear();\n    // Lava drops are slightly thicker and more glowing\n    g.rect(0, 0, 2, 10);\n    // Glowing yellow/orange color\n    const color = Math.random() > 0.3 ? 0xffaa00 : 0xffcc00;\n    g.fill({ color, alpha: 0.95 });\n\n    const viewport = this.api.getViewport ? this.api.getViewport() : null;\n    \n    let x, y;\n    if (viewport) {\n      x = viewport.x - 100 + Math.random() * (viewport.width + 200);\n      y = viewport.y - 10 - Math.random() * 30;\n    } else {\n      x = Math.random() * this.width;\n      y = -10 - Math.random() * 30;\n    }\n\n    const speed = 400 + Math.random() * 400; // slightly slower/heavier than water rain\n    const vx = (Math.random() * 40 - 20); \n    const vy = speed;\n    g.x = x;\n    g.y = y;\n    g.rotation = 0.1; \n    this.container.addChild(g);\n    this.particles.push({ g, x, y, vx, vy, alive: true });\n  }\n\n  update(dtMs) {\n    const targetIntensity = Math.max(0, Math.min(100, this.getIntensity()));\n    if (Math.abs(targetIntensity - this.intensity) > 0.1) {\n      const lerpFactor = 1 - Math.exp(-0.0015 * dtMs);\n      this.intensity += (targetIntensity - this.intensity) * lerpFactor;\n    } else {\n      this.intensity = targetIntensity;\n    }\n\n    const norm = Math.max(0, Math.min(1, this.intensity / 100));\n    let target = Math.floor(this.maxParticles * norm);\n    if (norm > 0 && target < 5) target = 5;\n\n    const deficit = target - this.particles.length;\n    if (deficit > 0) {\n      const toSpawn = Math.min(deficit, Math.max(1, Math.ceil(target * 0.02)), 30);\n      for (let i = 0; i < toSpawn; i++) this.spawnOne();\n    }\n    \n    if (this.particles.length > target) {\n      const surplus = this.particles.length - target;\n      const toCull = Math.min(surplus, Math.max(1, Math.ceil(this.particles.length * 0.02)));\n      for (let i = 0; i < toCull; i++) {\n        const p = this.particles.pop();\n        if (p) {\n          try { p.g.parent && p.g.parent.removeChild(p.g); p.g.destroy(); } catch {}\n        }\n      }\n    }\n\n    const dt = dtMs / 1000;\n    const gAcc = 1200; \n    const toRemove = [];\n\n    for (let i = 0; i < this.particles.length; i++) {\n      const p = this.particles[i];\n      p.vy += gAcc * dt;\n      p.x += p.vx * dt;\n      p.y += p.vy * dt;\n\n      p.g.x = p.x;\n      p.g.y = p.y;\n\n      // Interaction with surfaces\n      if (this.api.isSolidAt(p.x, p.y)) {\n         // Lava drops just vanish on hit with a tiny \"ember\" effect (optional)\n         if (typeof this.api.onLavaImpact === 'function' && Math.random() > 0.5) {\n            this.api.onLavaImpact({ x: p.x, y: p.y, strength: 0.2 });\n         }\n         p.alive = false;\n         toRemove.push(i);\n         continue;\n      }\n\n      const viewport = this.api.getViewport ? this.api.getViewport() : null;\n      const vY = viewport ? viewport.y : 0;\n      const vH = viewport ? viewport.height : this.height;\n      if (p.y > vY + vH + 50 || p.y > this.height + 40 || p.x < -40 || p.x > this.width + 40) {\n        p.alive = false;\n        toRemove.push(i);\n      }\n    }\n\n    for (let j = toRemove.length - 1; j >= 0; j--) {\n      const idx = toRemove[j];\n      const p = this.particles[idx];\n      if (p && p.g) {\n        try { p.g.parent && p.g.parent.removeChild(p.g); p.g.destroy(); } catch {}\n      }\n      this.particles.splice(idx, 1);\n    }\n  }\n\n  destroy() {\n    this.particles.forEach(p => {\n      try { p.g.parent && p.g.parent.removeChild(p.g); p.g.destroy(); } catch {}\n    });\n    this.particles = [];\n  }\n}\n","import { Graphics, Texture, TilingSprite } from 'pixi.js';\n\n// Radioactive fog overlay: similar to fog but toxic green\nexport default class WeatherRadioactiveFog {\n  constructor(container, api, getIntensity) {\n    this.container = container;\n    this.api = api;\n    this.getIntensity = getIntensity || (() => 0);\n    this.width = api.mapWidth * api.tileSize;\n    this.height = api.mapHeight * api.tileSize;\n    this.intensity = 0;\n    this.time = 0;\n\n    this.g = new Graphics();\n    this.container.addChild(this.g);\n\n    this.noiseTex = WeatherRadioactiveFog._createNoiseTexture(128, 128);\n    this.layer1 = new TilingSprite({ texture: this.noiseTex, width: this.width, height: this.height });\n    this.layer2 = new TilingSprite({ texture: this.noiseTex, width: this.width, height: this.height });\n    \n    this.layer1.tileScale.set(1.2, 1.2);\n    this.layer2.tileScale.set(0.7, 0.9);\n    this.layer1.alpha = 0;\n    this.layer2.alpha = 0;\n    this.container.addChild(this.layer1);\n    this.container.addChild(this.layer2);\n\n    this._recalcParams();\n    this._draw();\n  }\n\n  _alphaFromIntensity(v) {\n    const t = Math.max(0, Math.min(100, Number(v) || 0)) / 100;\n    return Math.max(0, Math.min(0.75, t * 0.75));\n  }\n\n  setIntensity(v) {\n    const nv = Math.max(0, Math.min(100, Number(v) || 0));\n    if (nv === this.intensity) return;\n    this.intensity = nv;\n    this._recalcParams();\n    this._applyAlphas(0);\n    this._draw();\n  }\n\n  resize(width, height) {\n    const w = Math.max(1, Math.floor(width));\n    const h = Math.max(1, Math.floor(height));\n    if (w === this.width && h === this.height) return;\n    this.width = w;\n    this.height = h;\n    if (this.layer1) { this.layer1.width = w; this.layer1.height = h; }\n    if (this.layer2) { this.layer2.width = w; this.layer2.height = h; }\n    this._draw();\n  }\n\n  _draw() {\n    const w = this.width;\n    const h = this.height;\n    const g = this.g;\n    g.clear();\n    const baseAlpha = this._alphaFromIntensity(this.intensity);\n    if (baseAlpha <= 0) {\n      g.alpha = 0;\n      return;\n    }\n    g.rect(0, 0, w, h);\n    // Toxic green tint\n    g.fill({ color: 0x1a5c1a, alpha: 1 });\n    g.alpha = baseAlpha;\n  }\n\n  update(dtMs) {\n    const targetIntensity = Math.max(0, Math.min(100, this.getIntensity()));\n    if (Math.abs(targetIntensity - this.intensity) > 0.1) {\n      const lerpFactor = 1 - Math.exp(-0.0015 * dtMs);\n      this.setIntensity(this.intensity + (targetIntensity - this.intensity) * lerpFactor);\n    } else {\n      this.setIntensity(targetIntensity);\n    }\n\n    const viewport = this.api.getViewport ? this.api.getViewport() : null;\n    if (viewport) {\n      if (this.g) { this.g.x = viewport.x; this.g.y = viewport.y; }\n      if (this.layer1) { this.layer1.x = viewport.x; this.layer1.y = viewport.y; }\n      if (this.layer2) { this.layer2.x = viewport.x; this.layer2.y = viewport.y; }\n    }\n\n    const dt = Math.max(0, Number(dtMs) || 16.67);\n    this.time += dt;\n    const pulse = 1 + 0.06 * Math.sin(this.time * 0.001);\n    this._applyAlphas(pulse);\n\n    if (this.layer1) {\n      this.layer1.tilePosition.x += this.speed1.x * dt;\n      this.layer1.tilePosition.y += this.speed1.y * dt;\n    }\n    if (this.layer2) {\n      this.layer2.tilePosition.x += this.speed2.x * dt;\n      this.layer2.tilePosition.y += this.speed2.y * dt;\n    }\n  }\n\n  destroy() {\n    if (this.g) {\n      try { this.g.parent && this.g.parent.removeChild(this.g); this.g.destroy(); } catch {}\n    }\n    this.g = null;\n    if (this.layer1) { try { this.layer1.parent && this.layer1.parent.removeChild(this.layer1); this.layer1.destroy(true); } catch {} }\n    if (this.layer2) { try { this.layer2.parent && this.layer2.parent.removeChild(this.layer2); this.layer2.destroy(true); } catch {} }\n    this.layer1 = null; this.layer2 = null;\n    try { this.noiseTex?.destroy(true); } catch {}\n    this.noiseTex = null;\n  }\n\n  _applyAlphas(pulseFactor = 1) {\n    const base = this._alphaFromIntensity(this.intensity);\n    const t = Math.max(0, Math.min(1, this.intensity / 100));\n    const noiseAlpha = base * (0.3 + 0.4 * t);\n    if (this.g) this.g.alpha = base * pulseFactor;\n    if (this.layer1) this.layer1.alpha = noiseAlpha * 0.7;\n    if (this.layer2) this.layer2.alpha = noiseAlpha;\n  }\n\n  _recalcParams() {\n    const t = Math.max(0, Math.min(1, this.intensity / 100));\n    const lerp = (a, b, u) => a + (b - a) * u;\n    this.speed1 = { x: lerp(0.004, 0.02, t), y: lerp(0.0, 0.01, t) };\n    this.speed2 = { x: lerp(-0.005, -0.015, t), y: lerp(0.003, 0.015, t) };\n  }\n\n  static _createNoiseTexture(w = 128, h = 128) {\n    const canvas = document.createElement('canvas');\n    canvas.width = w; canvas.height = h;\n    const ctx = canvas.getContext('2d');\n    const img = ctx.createImageData(w, h);\n    for (let i = 0; i < img.data.length; i += 4) {\n      const v = 180 + Math.floor(Math.random() * 75); \n      img.data[i] = v * 0.4;\n      img.data[i + 1] = v;\n      img.data[i + 2] = v * 0.4;\n      img.data[i + 3] = 255;\n    }\n    ctx.putImageData(img, 0, 0);\n    return Texture.from(canvas);\n  }\n}\n","import { Graphics } from 'pixi.js';\n\n// Meteor rain system: large falling fireballs that can deal damage via API callback\nexport default class WeatherMeteorRain {\n  constructor(container, api, getIntensity) {\n    this.container = container;\n    this.api = api;\n    this.getIntensity = getIntensity || (() => 0);\n    this.width = api.mapWidth * api.tileSize;\n    this.height = api.mapHeight * api.tileSize;\n    this.particles = [];\n    this.intensity = 0;\n    this.maxParticles = 15; // Meteors are rare and large\n  }\n\n  resize(width, height) {\n    this.width = width;\n    this.height = height;\n  }\n\n  spawnOne() {\n    const size = 4 + Math.random() * 8; // Meteor radius\n    const isLarge = size > 9;\n    \n    const g = new Graphics();\n    g.clear();\n    \n    // Core\n    g.circle(0, 0, size);\n    g.fill({ color: 0x555555, alpha: 1 });\n    \n    // Glow/Fire\n    g.circle(0, 0, size * 1.5);\n    g.fill({ color: 0xff4500, alpha: 0.4 });\n    \n    // Tail\n    g.moveTo(-size, 0);\n    g.lineTo(0, -size * 4);\n    g.lineTo(size, 0);\n    g.fill({ color: 0xff8c00, alpha: 0.6 });\n\n    const viewport = this.api.getViewport ? this.api.getViewport() : null;\n    \n    let x, y;\n    if (viewport) {\n      x = viewport.x - 200 + Math.random() * (viewport.width + 400);\n      y = viewport.y - 100 - Math.random() * 200;\n    } else {\n      x = Math.random() * this.width;\n      y = -100 - Math.random() * 200;\n    }\n\n    const vx = 100 + Math.random() * 100; // slanted fall\n    const vy = 400 + Math.random() * 300;\n    \n    g.x = x;\n    g.y = y;\n    // Rotate towards fall direction\n    g.rotation = Math.atan2(vy, vx) - Math.PI/2;\n    \n    this.container.addChild(g);\n    this.particles.push({ g, x, y, vx, vy, size, isLarge, alive: true });\n  }\n\n  update(dtMs) {\n    const targetIntensity = Math.max(0, Math.min(100, this.getIntensity()));\n    if (Math.abs(targetIntensity - this.intensity) > 0.1) {\n      const lerpFactor = 1 - Math.exp(-0.0005 * dtMs);\n      this.intensity += (targetIntensity - this.intensity) * lerpFactor;\n    } else {\n      this.intensity = targetIntensity;\n    }\n\n    const norm = this.intensity / 100;\n    const target = Math.floor(this.maxParticles * norm);\n\n    if (this.particles.length < target && Math.random() < 0.02 * norm) {\n      this.spawnOne();\n    }\n\n    const dt = dtMs / 1000;\n    const toRemove = [];\n\n    for (let i = 0; i < this.particles.length; i++) {\n      const p = this.particles[i];\n      p.x += p.vx * dt;\n      p.y += p.vy * dt;\n      p.g.x = p.x;\n      p.g.y = p.y;\n\n      // Check collision with solid world\n      if (this.api.isSolidAt(p.x, p.y)) {\n        // Explosion effect\n        if (typeof this.api.onLavaImpact === 'function') {\n           this.api.onLavaImpact({ x: p.x, y: p.y, strength: p.isLarge ? 1.5 : 0.8 });\n        }\n        \n        // Notify engine about meteor hit for damage\n        if (typeof this.api.onMeteorHit === 'function') {\n           this.api.onMeteorHit({ x: p.x, y: p.y, size: p.size, isLarge: p.isLarge });\n        }\n\n        p.alive = false;\n        toRemove.push(i);\n        continue;\n      }\n\n      const viewport = this.api.getViewport ? this.api.getViewport() : null;\n      if (viewport && (p.y > viewport.y + viewport.height + 100 || p.x > viewport.x + viewport.width + 100)) {\n        p.alive = false;\n        toRemove.push(i);\n      } else if (!viewport && (p.y > this.height + 100 || p.x > this.width + 100)) {\n        p.alive = false;\n        toRemove.push(i);\n      }\n    }\n\n    for (let j = toRemove.length - 1; j >= 0; j--) {\n      const idx = toRemove[j];\n      const p = this.particles[idx];\n      if (p && p.g) {\n        try { p.g.parent && p.g.parent.removeChild(p.g); p.g.destroy(); } catch {}\n      }\n      this.particles.splice(idx, 1);\n    }\n  }\n\n  destroy() {\n    this.particles.forEach(p => {\n      try { p.g.parent && p.g.parent.removeChild(p.g); p.g.destroy(); } catch {}\n    });\n    this.particles = [];\n  }\n}\n","import { Container, Graphics } from 'pixi.js';\n\n// WaterSplashFX: lightweight pooled splash particles (droplets + ring ripples)\n// API:\n//   const fx = new WaterSplashFX(container)\n//   fx.trigger({ x, y, strength, upward }) // upward=true for exit splash\n//   fx.update(dtMs)\n//   fx.resize(w,h) // noop (kept for symmetry)\n//   fx.destroy()\nexport default class WaterSplashFX {\n  constructor(container) {\n    this.container = container;\n    this.node = new Container();\n    this.container.addChild(this.node);\n    this.droplets = []; // {g,x,y,vx,vy,life,max}\n    this.rings = [];    // {g,x,y,r,vr,life,max}\n    this.maxDroplets = 48;\n    this.maxRings = 6;\n  }\n\n  destroy() {\n    try { this.node.parent && this.node.parent.removeChild(this.node); } catch {}\n    try { this.node.destroy({ children: true }); } catch {}\n    this.node = null;\n    this.droplets = [];\n    this.rings = [];\n  }\n\n  resize() {}\n\n  trigger({ x = 0, y = 0, strength = 1, upward = false } = {}) {\n    const s = Math.max(0.2, Math.min(3, Number(strength) || 1));\n    // Ring ripple on surface (entry/exit)\n    if (this.rings.length < this.maxRings) {\n      const g = new Graphics();\n      g.x = 0; g.y = 0; g.alpha = 0.8;\n      this.node.addChild(g);\n      this.rings.push({ g, x, y, r: 2 + 4 * s, vr: 0.08 + 0.12 * s, life: 0, max: 450 + 250 * s });\n    }\n    // Droplets burst\n    const count = Math.floor(8 + 18 * s);\n    for (let i = 0; i < count && this.droplets.length < this.maxDroplets; i++) {\n      const ang = upward ? (-Math.PI * 0.15 + Math.random() * Math.PI * 0.3) : (Math.PI * 0.6 + (Math.random() - 0.5) * Math.PI * 0.6);\n      const spd = (0.12 + Math.random() * 0.25) * (upward ? 1.2 : 1) * (0.6 + 0.8 * s);\n      const g = new Graphics();\n      g.x = 0; g.y = 0; g.alpha = 1;\n      this.node.addChild(g);\n      this.droplets.push({ g, x, y, vx: Math.cos(ang) * spd, vy: Math.sin(ang) * spd, life: 0, max: 500 + Math.random() * 400 });\n    }\n  }\n\n  update(dtMs) {\n    const dt = Math.max(0, Number(dtMs) || 16.67);\n    // Droplets update\n    for (let i = this.droplets.length - 1; i >= 0; i--) {\n      const d = this.droplets[i];\n      d.life += dt;\n      d.vy += 0.0018 * dt; // gravity\n      d.x += d.vx * dt;\n      d.y += d.vy * dt;\n      const t = Math.min(1, d.life / d.max);\n      const alpha = 1 - t;\n      const size = 1 + 1.5 * (1 - t);\n      const g = d.g; g.clear();\n      g.circle(d.x, d.y, size);\n      g.fill({ color: 0xc9ecff, alpha: Math.max(0, alpha) });\n      if (d.life >= d.max) {\n        try { g.parent && g.parent.removeChild(g); } catch {}\n        try { g.destroy(); } catch {}\n        this.droplets.splice(i, 1);\n      }\n    }\n    // Rings update\n    for (let i = this.rings.length - 1; i >= 0; i--) {\n      const r = this.rings[i];\n      r.life += dt;\n      r.r += r.vr * dt;\n      const t = Math.min(1, r.life / r.max);\n      const alpha = 0.6 * (1 - t);\n      const g = r.g; g.clear();\n      g.circle(r.x, r.y, r.r);\n      g.stroke({ width: 1.5, color: 0xc9ecff, alpha: Math.max(0, alpha) });\n      if (r.life >= r.max) {\n        try { g.parent && g.parent.removeChild(g); } catch {}\n        try { g.destroy(); } catch {}\n        this.rings.splice(i, 1);\n      }\n    }\n  }\n}\n","import { Container, Graphics } from 'pixi.js';\n\n// LavaEmbers: ambient embers with tiny smoke trails spawning from lava surface tiles\n// API:\n//   const fx = new LavaEmbers(container, api, getIntensity)\n//   fx.setIntensity(v)\n//   fx.rebuildSurfaces({ mapWidth, mapHeight, tileSize, tileMapData, registryItems })\n//   fx.update(dtMs)\n//   fx.resize(w,h)\n//   fx.destroy()\nexport default class LavaEmbers {\n  constructor(container, api, getIntensity) {\n    this.container = container;\n    this.api = api || {};\n    this.getIntensity = getIntensity || (() => 0);\n    this.node = new Container();\n    this.container.addChild(this.node);\n    this.intensity = 0;\n    this.time = 0;\n    this.spawnAcc = 0;\n    this.embers = []; // {g,x,y,vx,vy,life,max,trail}\n    this.maxEmbers = 60;\n    this.surfaces = []; // {x,y,w}\n  }\n\n  destroy() {\n    try { this.node.parent && this.node.parent.removeChild(this.node); } catch {}\n    try { this.node.destroy({ children: true }); } catch {}\n    this.embers = [];\n    this.surfaces = [];\n  }\n\n  setIntensity(v) {\n    const nv = Math.max(0, Math.min(100, Number(v) || 0));\n    this.intensity = nv;\n  }\n\n  resize() {}\n\n  rebuildSurfaces({ mapWidth, mapHeight, tileSize, tileMapData, registryItems }) {\n    const getDef = (id) => Array.isArray(registryItems) ? registryItems.find(r => r.id === id) : null;\n    const isLava = (def) => !!(def && def.flags && def.flags.lava);\n    const W = mapWidth, H = mapHeight, TS = tileSize;\n    const spans = [];\n    for (let gy = 0; gy < H; gy++) {\n      let runStart = -1;\n      for (let gx = 0; gx < W; gx++) {\n        const idx = gy * W + gx;\n        const id = tileMapData[idx];\n        if (!id) { if (runStart !== -1) { runStart = -1; } continue; }\n        const def = getDef(id);\n        const aboveIdx = (gy - 1) * W + gx;\n        const aboveLava = gy > 0 && isLava(getDef(tileMapData[aboveIdx]));\n        const hereLava = isLava(def);\n        const isSurface = hereLava && !aboveLava;\n        if (isSurface) {\n          if (runStart === -1) runStart = gx;\n        } else {\n          if (runStart !== -1) {\n            const w = (gx - runStart) * TS;\n            if (w > 0) spans.push({ x: runStart * TS, y: gy * TS, w });\n            runStart = -1;\n          }\n        }\n      }\n      if (runStart !== -1) {\n        const w = (W - runStart) * TS;\n        if (w > 0) spans.push({ x: runStart * TS, y: gy * TS, w });\n      }\n    }\n    this.surfaces = spans;\n  }\n\n  _spawnOne() {\n    if (!this.surfaces.length) return;\n    if (this.embers.length >= this.maxEmbers) return;\n    const s = this.surfaces[Math.floor(Math.random() * this.surfaces.length)];\n    const x = s.x + Math.random() * s.w;\n    const y = s.y - 2; // just above surface\n    const g = new Graphics();\n    this.node.addChild(g);\n    const vx = (Math.random() - 0.5) * 0.02; // small horizontal drift\n    const vy = -0.05 - Math.random() * 0.06; // initial upward\n    const life = 0; const max = 1200 + Math.random() * 1200; // 1.2..2.4s\n    this.embers.push({ g, x, y, vx, vy, life, max, trail: [] });\n  }\n\n  update(dtMs) {\n    const dt = Math.max(0, Number(dtMs) || 16.67);\n    // live intensity\n    const cur = Math.max(0, Math.min(100, this.getIntensity()))\n    this.setIntensity(cur);\n    if (this.intensity <= 0) return;\n\n    // Spawn rate depends on intensity and surface count\n    const baseRate = 0.0015 + 0.0035 * (this.intensity / 100); // embers per ms\n    const mult = Math.max(0.5, Math.min(3, this.surfaces.length / 6));\n    this.spawnAcc += dt * baseRate * mult;\n    while (this.spawnAcc >= 1) {\n      this._spawnOne();\n      this.spawnAcc -= 1;\n    }\n\n    // Update embers\n    for (let i = this.embers.length - 1; i >= 0; i--) {\n      const e = this.embers[i];\n      e.life += dt;\n      // motion: rise then fall slightly\n      e.vy += 0.00006 * dt; // gravity slowly pulls down\n      e.x += e.vx * dt;\n      e.y += e.vy * dt;\n      // record simple smoke trail points\n      if (e.trail.length < 14) e.trail.push({ x: e.x, y: e.y });\n      else { e.trail.shift(); e.trail.push({ x: e.x, y: e.y }); }\n\n      const t = Math.min(1, e.life / e.max);\n      const emberAlpha = 1 - t;\n      const emberSize = 1 + 1.5 * (1 - t);\n      const g = e.g; g.clear();\n      // smoke trail (fainter)\n      for (let k = 1; k < e.trail.length; k++) {\n        const p0 = e.trail[k - 1]; const p1 = e.trail[k];\n        g.moveTo(p0.x, p0.y);\n        g.lineTo(p1.x, p1.y);\n      }\n      g.stroke({ width: 1, color: 0x555555, alpha: 0.25 * emberAlpha });\n\n      // glowing ember\n      g.circle(e.x, e.y, emberSize);\n      g.fill({ color: 0xffa229, alpha: 0.9 * emberAlpha });\n\n      if (e.life >= e.max) {\n        try { g.parent && g.parent.removeChild(g); } catch {}\n        try { g.destroy(); } catch {}\n        this.embers.splice(i, 1);\n      }\n    }\n  }\n}\n","import { Container, Graphics } from 'pixi.js';\n\n// LavaSteamFX: tiny steam puffs when rain/snow hits lava surface\n// API:\n//   const steam = new LavaSteamFX(parentContainer)\n//   steam.trigger({ x, y, strength })\n//   steam.update(dtMs)\n//   steam.destroy()\nexport default class LavaSteamFX {\n  constructor(container) {\n    this.container = container;\n    this.node = new Container();\n    this.container.addChild(this.node);\n    this.puffs = []; // {g,x,y,vx,vy,life,max,r}\n    this.maxPuffs = 80;\n  }\n\n  destroy() {\n    try { this.node.parent && this.node.parent.removeChild(this.node); } catch {}\n    try { this.node.destroy({ children: true }); } catch {}\n    this.node = null;\n    this.puffs = [];\n  }\n\n  resize() {}\n\n  trigger({ x = 0, y = 0, strength = 0.7 } = {}) {\n    const s = Math.max(0.2, Math.min(2.5, Number(strength) || 0.7));\n    const count = Math.max(2, Math.floor(3 + 4 * s));\n    for (let i = 0; i < count && this.puffs.length < this.maxPuffs; i++) {\n      const g = new Graphics();\n      this.node.addChild(g);\n      const vx = (Math.random() - 0.5) * (0.03 + 0.03 * s);\n      const vy = -(0.08 + Math.random() * 0.08) * (0.8 + 0.4 * s);\n      const r = 1.5 + Math.random() * (2.5 * s);\n      const max = 450 + Math.random() * 350;\n      this.puffs.push({ g, x, y: y - 2, vx, vy, life: 0, max, r });\n    }\n  }\n\n  update(dtMs) {\n    const dt = Math.max(0, Number(dtMs) || 16.67);\n    for (let i = this.puffs.length - 1; i >= 0; i--) {\n      const p = this.puffs[i];\n      p.life += dt;\n      p.x += p.vx * dt;\n      p.y += p.vy * dt;\n      // slight expansion and fade\n      const t = Math.min(1, p.life / p.max);\n      const alpha = 0.75 * (1 - t);\n      const radius = p.r * (1 + 0.8 * t);\n      const g = p.g; g.clear();\n      // soft grey-white steam\n      g.circle(p.x, p.y, radius);\n      g.fill({ color: 0xdfdad2, alpha: Math.max(0, alpha) });\n      if (p.life >= p.max) {\n        try { g.parent && g.parent.removeChild(g); } catch {}\n        try { g.destroy(); } catch {}\n        this.puffs.splice(i, 1);\n      }\n    }\n  }\n}\n","import { Container, Graphics, Texture, TilingSprite, Sprite } from 'pixi.js';\n\n// LiquidRegionSystem: groups contiguous liquid tiles (water/lava) into regions\n// and renders each region as a masked, animated tiling surface (weather-like style)\n// while constrained to the exact sector (region) shape.\n//\n// API:\n//   const sys = new LiquidRegionSystem(parentContainer, { mapWidth, mapHeight, tileSize });\n//   sys.build({ mapWidth, mapHeight, tileSize, tileMapData, registryItems });\n//   sys.update(dtMs);\n//   sys.resize(mapWidth, mapHeight, tileSize);\n//   sys.destroy();\n\nexport default class LiquidRegionSystem {\n  constructor(container, opts = {}) {\n    this.container = container;\n    this.bgContainer = opts.bgContainer || null;\n    this.mapWidth = opts.mapWidth || 0;\n    this.mapHeight = opts.mapHeight || 0;\n    this.tileSize = opts.tileSize || 32;\n    this._regions = []; // { type, node, mask, sprite, noise1, noise2, capG, topEdges, waves:[] }\n    this._waterTex = null;\n    this._lavaTex = null;\n    this._quicksandTex = null;\n    this._waterfallTex = null;\n    this._lavaWaterfallTex = null;\n    this._radioactiveWaterTex = null;\n    this._radioactiveWaterfallTex = null;\n    this._time = 0;\n    this._noiseTex = null;\n    this._lavaDetailTex = null;\n    this._waterDetailTex = null;\n    this._quicksandDetailTex = null;\n    this._playerState = null; // Will be set from PixiStage\n  }\n\n  setPlayerState(playerState) {\n    this._playerState = playerState;\n  }\n\n  _checkPlayerInRegion(region) {\n    if (!this._playerState || !region || !region.node) return false;\n    const p = this._playerState;\n    const px = p.x || 0;\n    const py = p.y || 0;\n    const pw = p.width || 32;\n    const ph = p.height || 32;\n\n    // Use multiple sample points for better precision\n    // 1. Center\n    const points = [\n      { x: px + pw * 0.5, y: py + ph * 0.5 },\n      { x: px + pw * 0.5, y: py + ph * 0.1 }, // Top\n      { x: px + pw * 0.5, y: py + ph * 0.9 }, // Bottom\n    ];\n\n    for (const pt of points) {\n      const gx = Math.floor(pt.x / this.tileSize);\n      const gy = Math.floor(pt.y / this.tileSize);\n      const idx = gy * this.mapWidth + gx;\n      if (region.tileIndicesSet && region.tileIndicesSet.has(idx)) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  // Query approximate surface Y (pixel) for a given X within liquid regions of type ('water'|'lava')\n  getSurfaceY(type, x) {\n    if (!Array.isArray(this._regions) || this._regions.length === 0) return null;\n    const X = Math.max(0, Math.floor(Number(x) || 0));\n    for (const r of this._regions) {\n      if (r.type !== type) continue;\n      if (!Array.isArray(r.topEdges)) continue;\n      for (let i = 0; i < r.topEdges.length; i++) {\n        const e = r.topEdges[i];\n        if (X >= e.x && X <= e.x + e.w) {\n          return e.y; // region tile top in pixels\n        }\n      }\n    }\n    return null;\n  }\n\n  destroy() {\n    try {\n      for (const r of this._regions) {\n        try { if (r.node && r.node.parent) r.node.parent.removeChild(r.node); } catch {}\n        try { if (r.bgNode && r.bgNode.parent) r.bgNode.parent.removeChild(r.bgNode); } catch {}\n        try { r.node?.destroy({ children: true }); } catch {}\n        try { r.bgNode?.destroy({ children: true }); } catch {}\n      }\n    } catch {}\n    this._regions = [];\n    try { this._waterTex?.destroy(true); } catch {}\n    try { this._lavaTex?.destroy(true); } catch {}\n    try { this._quicksandTex?.destroy(true); } catch {}\n    try { this._waterfallTex?.destroy(true); } catch {}\n    try { this._lavaWaterfallTex?.destroy(true); } catch {}\n    try { this._radioactiveWaterTex?.destroy(true); } catch {}\n    try { this._radioactiveWaterfallTex?.destroy(true); } catch {}\n    try { this._noiseTex?.destroy(true); } catch {}\n    try { this._lavaDetailTex?.destroy(true); } catch {}\n    try { this._waterDetailTex?.destroy(true); } catch {}\n    try { this._quicksandDetailTex?.destroy(true); } catch {}\n    this._waterTex = null;\n    this._lavaTex = null;\n    this._quicksandTex = null;\n    this._waterfallTex = null;\n    this._lavaWaterfallTex = null;\n    this._radioactiveWaterTex = null;\n    this._radioactiveWaterfallTex = null;\n    this._noiseTex = null;\n    this._lavaDetailTex = null;\n    this._waterDetailTex = null;\n    this._quicksandDetailTex = null;\n    if (this._gradTextures) {\n      for (const k in this._gradTextures) {\n        try { this._gradTextures[k].destroy(true); } catch {}\n      }\n      this._gradTextures = null;\n    }\n  }\n\n  clear() {\n    for (const r of this._regions) {\n      try { r.node?.parent && r.node.parent.removeChild(r.node); } catch {}\n      try { r.bgNode?.parent && r.bgNode.parent.removeChild(r.bgNode); } catch {}\n      try { r.node?.destroy({ children: true }); } catch {}\n      try { r.bgNode?.destroy({ children: true }); } catch {}\n    }\n    this._regions = [];\n  }\n\n  resize(mapWidth, mapHeight, tileSize) {\n    const mw = Math.max(1, mapWidth | 0);\n    const mh = Math.max(1, mapHeight | 0);\n    const ts = Math.max(1, tileSize | 0);\n    const changed = mw !== this.mapWidth || mh !== this.mapHeight || ts !== this.tileSize;\n    this.mapWidth = mw; this.mapHeight = mh; this.tileSize = ts;\n    if (changed) {\n      // rebuild textures at new tile size; regions will be rebuilt by caller\n      try { this._waterTex?.destroy(true); } catch {}\n      try { this._lavaTex?.destroy(true); } catch {}\n      try { this._quicksandTex?.destroy(true); } catch {}\n      try { this._waterfallTex?.destroy(true); } catch {}\n      try { this._lavaWaterfallTex?.destroy(true); } catch {}\n      try { this._radioactiveWaterTex?.destroy(true); } catch {}\n      try { this._radioactiveWaterfallTex?.destroy(true); } catch {}\n      try { this._lavaDetailTex?.destroy(true); } catch {}\n      try { this._waterDetailTex?.destroy(true); } catch {}\n      try { this._quicksandDetailTex?.destroy(true); } catch {}\n      this._waterTex = null; this._lavaTex = null; this._quicksandTex = null; this._waterfallTex = null;\n      this._lavaWaterfallTex = null;\n      this._radioactiveWaterTex = null; this._radioactiveWaterfallTex = null;\n      this._lavaDetailTex = null; this._waterDetailTex = null; this._quicksandDetailTex = null;\n    }\n  }\n\n  update(dtMs) {\n    const dt = Math.max(0, Number(dtMs) || 16.67);\n    this._time += dt;\n    // Gentle drift speeds (px/ms) per liquid type\n    const waterDrift = { x: 0, y: 0 }; // Static (bubbles added via texture/noise)\n    const lavaDrift = { x: 0, y: 0 }; // Static (floating pieces added via noise/texture)\n    const quicksandDrift = { x: 0, y: 0 }; // Static (pixels fade via noise)\n    const waterfallDrift = { x: 0, y: 0.15 }; // Fast vertical drift\n    const lavaWaterfallDrift = { x: 0, y: 0.12 }; // Lava falls a bit slower/thicker\n    const radioactiveWaterDrift = { x: 0, y: 0 }; // Static\n    const radioactiveWaterfallDrift = { x: 0, y: 0.12 }; // Match lava waterfall speed or similar\n    for (const r of this._regions) {\n      const sprite = r.sprite;\n      if (!sprite) continue;\n      const drift = r.type === 'lava' ? lavaDrift : (r.type === 'quicksand' ? quicksandDrift : (r.type === 'waterfall' ? waterfallDrift : (r.type === 'lava_waterfall' ? lavaWaterfallDrift : (r.type === 'radioactive_waterfall' ? radioactiveWaterfallDrift : (r.type === 'radioactive_water' ? radioactiveWaterDrift : waterDrift)))));\n      sprite.tilePosition.x += drift.x * dt;\n      sprite.tilePosition.y += drift.y * dt;\n      // Alpha: normally opaque, but becomes transparent when player is inside!\n      // (We'll detect player position and adjust alpha accordingly with smooth transitions)\n      let targetAlpha = 0.95;\n      if (r.type === 'water') {\n        const playerInRegion = this._checkPlayerInRegion(r);\n        targetAlpha = playerInRegion ? 0.50 : 0.95;\n      } else if (r.type === 'quicksand') {\n        const playerInRegion = this._checkPlayerInRegion(r);\n        targetAlpha = playerInRegion ? 0.70 : 1.0;\n      } else if (r.type === 'waterfall' || r.type === 'lava_waterfall' || r.type === 'radioactive_waterfall') {\n        const playerInRegion = this._checkPlayerInRegion(r);\n        targetAlpha = playerInRegion ? 0.40 : 0.65;\n      } else if (r.type === 'radioactive_water') {\n        const playerInRegion = this._checkPlayerInRegion(r);\n        targetAlpha = playerInRegion ? 0.55 : 0.90;\n      } else {\n        // Lava\n        const playerInRegion = this._checkPlayerInRegion(r);\n        targetAlpha = playerInRegion ? 0.60 : 0.98;\n      }\n\n      // Smooth transition (lerp)\n      if (r.currentAlpha === undefined) r.currentAlpha = sprite.alpha;\n      const lerpFactor = 0.005; // Adjust for speed of transition\n      const alphaDiff = targetAlpha - r.currentAlpha;\n      r.currentAlpha += alphaDiff * Math.min(1, dt * lerpFactor);\n      sprite.alpha = r.currentAlpha;\n\n      // Splash animation for waterfalls\n      if ((r.type === 'waterfall' || r.type === 'lava_waterfall' || r.type === 'radioactive_waterfall') && r.splashG && Array.isArray(r.bottomEdges)) {\n        const g = r.splashG;\n        g.clear();\n        const thickness = Math.max(2, Math.floor(this.tileSize * 0.25));\n        const F = 1000;\n        const cycle = (this._time % F) / F;\n        \n        for (const e of r.bottomEdges) {\n          // Animated foam/splash at the bottom\n          const splashHeight = thickness * (0.8 + Math.sin(this._time * 0.01 + e.x) * 0.2);\n          g.rect(e.x, e.y + this.tileSize - splashHeight, e.w, splashHeight);\n          \n          // Bubbles\n          for (let k = 0; k < 5; k++) {\n             const bx = e.x + ((e.x * 13 + k * 37 + this._time * 0.05) % e.w);\n             const by = e.y + this.tileSize - (Math.random() * thickness * 2);\n             g.circle(bx, by, 1 + Math.random() * 2);\n          }\n        }\n        const splashColor = r.type === 'lava_waterfall' ? 0xffcc00 : (r.type === 'radioactive_waterfall' ? 0xadff2f : 0xffffff);\n        g.fill({ color: splashColor, alpha: 0.5 + Math.sin(this._time * 0.02) * 0.2 });\n      }\n\n      // Animate noise/detail overlays\n      if (r.noise1) {\n        if (r.type === 'water') {\n          r.noise1.tilePosition.y -= 0.015 * dt; // Bubbles go UP\n          r.noise1.tilePosition.x += Math.sin(this._time * 0.001) * 0.005 * dt; \n        } else if (r.type === 'lava') {\n          r.noise1.tilePosition.x += 0.004 * dt; \n          r.noise1.tilePosition.y += 0.002 * dt;\n        } else if (r.type === 'quicksand') {\n          // Fade effect for pixels\n          r.noise1.alpha = 0.4 + Math.sin(this._time * 0.001) * 0.2;\n          r.noise1.tilePosition.x += 0.001 * dt;\n        } else if (r.type.includes('waterfall')) {\n          r.noise1.tilePosition.y += drift.y * 0.8 * dt;\n          r.noise1.tilePosition.x += Math.sin(this._time * 0.002) * 0.02 * dt;\n        } else {\n          r.noise1.tilePosition.x += 0.008 * dt;\n          r.noise1.tilePosition.y += 0.004 * dt;\n        }\n      }\n      if (r.noise2) {\n        if (r.type === 'quicksand') {\n          r.noise2.alpha = 0.2 + Math.cos(this._time * 0.0015) * 0.1;\n        } else if (r.type.includes('waterfall')) {\n          r.noise2.tilePosition.y += drift.y * 1.2 * dt;\n        } else {\n          r.noise2.tilePosition.x -= 0.005 * dt;\n          r.noise2.tilePosition.y += 0.003 * dt;\n        }\n      }\n\n      // Update interactive surface waves (small ripples from impacts)\n      if (!Array.isArray(r.waves)) r.waves = [];\n      if (r.waves.length) {\n        for (let i = r.waves.length - 1; i >= 0; i--) {\n          const w = r.waves[i];\n          w.t += dt; // ms\n          // Lifetimes: water longer than lava\n          const life = r.type === 'water' ? w.lifeMsWater : w.lifeMsLava;\n          if (w.t >= life) { r.waves.splice(i, 1); continue; }\n          // expand radius over time (px)\n          w.radius = w.startRadius + w.speed * (w.t / 1000);\n          // exponential decay of amplitude\n          const decay = Math.exp(-w.t / (r.type === 'water' ? 1400 : 900));\n          w.ampNow = w.amp * decay;\n        }\n      }\n\n      // Animate water surface cap (rim light) with slight sine undulation\n      if (r.type === 'water' && r.capG && Array.isArray(r.topEdges) && r.topEdges.length) {\n        const g = r.capG;\n        const amp = Math.max(1, Math.floor(this.tileSize * 0.06));\n        const thickness = Math.max(1, Math.floor(this.tileSize * 0.08));\n        g.clear();\n        for (let i = 0; i < r.topEdges.length; i++) {\n          const e = r.topEdges[i];\n          // slight vertical offset wave\n          let dy = Math.sin((this._time * 0.002) + e.x * 0.15) * (amp * 0.5);\n          // Add contributions from interactive waves (Gaussian falloff)\n          if (r.waves && r.waves.length) {\n            // use span center for sampling; keeps draw perf O(spans + waves)\n            const centerX = e.x + e.w * 0.5;\n            for (let k = 0; k < r.waves.length; k++) {\n              const w = r.waves[k];\n              const dx = centerX - w.cx;\n              const dist = Math.abs(dx);\n              if (dist > w.radius + e.w * 0.6) continue; // early reject\n              const sigma = Math.max(8, w.radius * 0.6);\n              const gauss = Math.exp(-(dx * dx) / (2 * sigma * sigma));\n              dy += w.ampNow * gauss;\n            }\n            // clamp to avoid excessive displacement\n            const maxDisp = Math.max(2, this.tileSize * 0.22);\n            if (dy > maxDisp) dy = maxDisp;\n            if (dy < -maxDisp) dy = -maxDisp;\n          }\n          g.rect(e.x, e.y - thickness + dy, e.w, thickness);\n        }\n        g.fill({ color: 0xc9ecff, alpha: 0.35 });\n      }\n    }\n  }\n\n  build({ mapWidth, mapHeight, tileSize, tileMapData, registryItems }) {\n    if (!Array.isArray(tileMapData) || !Array.isArray(registryItems)) return;\n    this.resize(mapWidth, mapHeight, tileSize);\n    this.clear();\n\n    const W = this.mapWidth;\n    const H = this.mapHeight;\n    const TS = this.tileSize;\n    const count = W * H;\n\n    const getDef = (id) => registryItems.find((r) => r.id === id);\n    const typeAt = (i) => {\n      const id = tileMapData[i];\n      if (!id) return null;\n      const def = getDef(id);\n      if (!def || !def.flags || !def.flags.liquid) return null;\n      if (def.flags.lava_waterfall) return 'lava_waterfall';\n      if (def.flags.radioactive_waterfall) return 'radioactive_waterfall';\n      if (def.flags.waterfall) return 'waterfall';\n      if (def.flags.radioactive_water) return 'radioactive_water';\n      if (def.flags.quicksand) return 'quicksand';\n      if (def.flags.lava) return 'lava';\n      if (def.flags.water) return 'water';\n      return 'liquid';\n    };\n\n    const visited = new Uint8Array(count);\n    const dirs = [1, -1, W, -W]; // 4-connectivity\n\n    for (let i = 0; i < count; i++) {\n      if (visited[i]) continue;\n      const t = typeAt(i);\n      if (!t) { visited[i] = 1; continue; }\n\n      // Flood fill this region for same liquid type\n      const regionTiles = [];\n      const queue = [i];\n      visited[i] = 1;\n      while (queue.length) {\n        const idx = queue.pop();\n        regionTiles.push(idx);\n        for (let d = 0; d < 4; d++) {\n          const n = idx + dirs[d];\n          if (n < 0 || n >= count) continue;\n          if (visited[n]) continue;\n          // prevent wrapping on left/right when using +/-1\n          if (d < 2) {\n            const row = Math.floor(idx / W);\n            const nrow = Math.floor(n / W);\n            if (row !== nrow) continue;\n          }\n          const nt = typeAt(n);\n          if (nt === t) { visited[n] = 1; queue.push(n); }\n          else { visited[n] = visited[n] || 0; }\n        }\n      }\n\n      if (regionTiles.length === 0) continue;\n      this._addRegion(t, regionTiles, W, H, TS);\n    }\n  }\n\n      _addRegion(type, tileIndices, mapWidth, mapHeight, tileSize) {\n        const node = new Container();\n        const mask = new Graphics();\n        const worldW = mapWidth * tileSize;\n        const worldH = mapHeight * tileSize;\n\n        const tileIndicesSet = new Set(tileIndices);\n\n        mask.clear();\n        const bleed = 1; // Palielints bleed, lai nosegtu spraugas\n        for (let k = 0; k < tileIndices.length; k++) {\n          const idx = tileIndices[k];\n          const gx = (idx % mapWidth);\n          const gy = Math.floor(idx / mapWidth);\n          mask.rect(\n            gx * tileSize - bleed,\n            gy * tileSize - bleed,\n            tileSize + bleed * 2,\n            tileSize + bleed * 2\n          );\n        }\n        mask.fill({ color: 0xffffff, alpha: 1 });\n\n        const tex = type === 'lava' ? (this._lavaTex || (this._lavaTex = this._createLavaTexture(tileSize)))\n                                     : (type === 'quicksand' ? (this._quicksandTex || (this._quicksandTex = this._createQuicksandTexture(tileSize)))\n                                     : (type === 'waterfall' ? (this._waterfallTex || (this._waterfallTex = this._createWaterfallTexture(tileSize)))\n                                     : (type === 'lava_waterfall' ? (this._lavaWaterfallTex || (this._lavaWaterfallTex = this._createLavaWaterfallTexture(tileSize)))\n                                     : (type === 'radioactive_waterfall' ? (this._radioactiveWaterfallTex || (this._radioactiveWaterfallTex = this._createRadioactiveWaterfallTexture(tileSize)))\n                                     : (type === 'radioactive_water' ? (this._radioactiveWaterTex || (this._radioactiveWaterTex = this._createRadioactiveWaterTexture(tileSize)))\n                                     : (this._waterTex || (this._waterTex = this._createWaterTexture(tileSize))))))));\n        \n        // v8 addressMode iestatana\n        if (tex.source && tex.source.style) {\n          tex.source.style.addressMode = 'repeat';\n        }\n\n        const tiling = new TilingSprite({\n          texture: tex,\n          width: worldW,\n          height: worldH\n        });\n        \n        tiling.tileScale.set(1, 1);\n        tiling.alpha = type === 'lava' ? 0.98 : ((type === 'waterfall' || type === 'lava_waterfall' || type === 'radioactive_waterfall') ? 0.6 : 0.92);\n        node.addChild(tiling);\n\n        // Noise/Detail sli\n        let detailTex1, detailTex2;\n        if (type.includes('lava')) {\n          detailTex1 = this._lavaDetailTex || (this._lavaDetailTex = this._createLavaDetailTexture());\n          detailTex2 = this._noiseTex || (this._noiseTex = this._createNoiseTexture());\n        } else if (type === 'quicksand') {\n          detailTex1 = this._quicksandDetailTex || (this._quicksandDetailTex = this._createQuicksandDetailTexture());\n          detailTex2 = this._noiseTex || (this._noiseTex = this._createNoiseTexture());\n        } else if (type.includes('radioactive')) {\n          detailTex1 = this._noiseTex || (this._noiseTex = this._createNoiseTexture());\n          detailTex2 = this._noiseTex;\n        } else {\n          // water, waterfall\n          detailTex1 = this._waterDetailTex || (this._waterDetailTex = this._createWaterDetailTexture());\n          detailTex2 = this._noiseTex || (this._noiseTex = this._createNoiseTexture());\n        }\n\n        if (detailTex1.source && detailTex1.source.style) detailTex1.source.style.addressMode = 'repeat';\n        if (detailTex2.source && detailTex2.source.style) detailTex2.source.style.addressMode = 'repeat';\n\n        const noise1 = new TilingSprite({ texture: detailTex1, width: worldW, height: worldH });\n        const noise2 = new TilingSprite({ texture: detailTex2, width: worldW, height: worldH });\n        \n        if (type === 'water' || type === 'radioactive_water') {\n          noise1.alpha = 0.25; noise2.alpha = 0.15;\n        } else if (type === 'waterfall' || type === 'lava_waterfall' || type === 'radioactive_waterfall') {\n          noise1.alpha = 0.2; noise2.alpha = 0.15;\n        } else if (type === 'lava') {\n          noise1.alpha = 0.4; noise2.alpha = 0.2;\n        } else if (type === 'quicksand') {\n          noise1.alpha = 0.6; noise2.alpha = 0.3;\n        } else {\n          noise1.alpha = 0.12; noise2.alpha = 0.15;\n        }\n        node.addChild(noise1, noise2);\n\n        // LABOJUMS: Maska tiek pievienota k brns, lai t sekotu ldzi node koordintm\n        node.addChild(mask);\n        node.mask = mask;\n\n        // Background slnis (zIndex 28) - lai aizsegtu fonu caur deni\n        let bgNode = null;\n        if (this.bgContainer) {\n          bgNode = new Container();\n          const bgMask = new Graphics();\n          bgMask.clear();\n          for (let k = 0; k < tileIndices.length; k++) {\n            const idx = tileIndices[k];\n            const gx = (idx % mapWidth);\n            const gy = Math.floor(idx / mapWidth);\n            bgMask.rect(gx * tileSize - bleed, gy * tileSize - bleed, tileSize + bleed * 2, tileSize + bleed * 2);\n          }\n          bgMask.fill({ color: 0xffffff, alpha: 1 });\n          bgNode.addChild(bgMask);\n          bgNode.mask = bgMask;\n\n          const bgG = new Graphics();\n          let minY = Infinity, maxY = -Infinity;\n          for (let k = 0; k < tileIndices.length; k++) {\n            const gy = Math.floor(tileIndices[k] / mapWidth) * tileSize;\n            if (gy < minY) minY = gy;\n            if (gy + tileSize > maxY) maxY = gy + tileSize;\n          }\n\n          if (!this._gradTextures) this._gradTextures = {};\n          if (!this._gradTextures[type]) {\n            let color, bottomColor;\n            if (type.includes('lava')) {\n              color = '#ffaa00'; bottomColor = '#884400';\n            } else if (type.includes('radioactive')) {\n              color = '#004400'; bottomColor = '#001100';\n            } else if (type === 'quicksand') {\n              color = '#5d4037'; bottomColor = '#2d1d19';\n            } else { \n              color = '#3a7fb8'; bottomColor = '#0b1d2e';\n            }\n            this._gradTextures[type] = this._createGradientTexture(color, bottomColor);\n          }\n\n          const bgSprite = new Sprite(this._gradTextures[type]);\n          bgSprite.width = worldW;\n          bgSprite.height = worldH;\n          bgSprite.y = 0;\n          \n          bgNode.addChild(bgSprite);\n          this.bgContainer.addChild(bgNode);\n        }\n\n        const baseAlpha = type === 'lava' ? 0.98 : ((type === 'waterfall' || type === 'lava_waterfall' || type === 'radioactive_waterfall') ? 0.6 : 0.92);\n\n        if (type === 'water' || type === 'radioactive_water') {\n          const capG = new Graphics();\n          node.addChild(capG);\n          const topEdges = this._computeTopEdgeSpans(tileIndices, mapWidth, tileSize);\n          // Saglabjam atsauces uz r reistr\n          this._regions.push({ type, node, bgNode, mask, sprite: tiling, noise1, noise2, capG, topEdges, waves: [], tileIndicesSet, currentAlpha: baseAlpha });\n        } else if (type === 'waterfall' || type === 'lava_waterfall' || type === 'radioactive_waterfall') {\n          const splashG = new Graphics();\n          node.addChild(splashG);\n          const bottomEdges = this._computeBottomEdgeSpans(tileIndices, mapWidth, tileSize);\n          this._regions.push({ type, node, bgNode, mask, sprite: tiling, noise1, noise2, splashG, bottomEdges, tileIndicesSet, currentAlpha: baseAlpha });\n        } else {\n          this._regions.push({ type, node, bgNode, mask, sprite: tiling, noise1, noise2, waves: [], tileIndicesSet, currentAlpha: baseAlpha });\n        }\n\n        this.container.addChild(node);\n      }\n\n      _createGradientTexture(topColor, bottomColor) {\n        const canvas = document.createElement('canvas');\n        const size = 64; \n        canvas.width = 2; canvas.height = size;\n        const ctx = canvas.getContext('2d');\n        const g = ctx.createLinearGradient(0, 0, 0, size);\n        g.addColorStop(0, topColor);\n        g.addColorStop(1, bottomColor);\n        ctx.fillStyle = g;\n        ctx.fillRect(0, 0, 2, size);\n        return Texture.from(canvas);\n      }\n\n  _createWaterTexture(tileSize) {\n    const canvas = document.createElement('canvas');\n    const size = 64; \n    canvas.width = size; canvas.height = size;\n    const ctx = canvas.getContext('2d');\n\n    // Solid color instead of gradient to remove horizontal bars\n    ctx.fillStyle = '#3a7fb8';\n    ctx.fillRect(0, 0, size, size);\n\n    return Texture.from(canvas);\n  }\n\n  _createLavaTexture(tileSize) {\n    const canvas = document.createElement('canvas');\n    const size = 64; \n    canvas.width = size; canvas.height = size;\n    const ctx = canvas.getContext('2d');\n\n    // Solid color instead of gradient\n    ctx.fillStyle = '#ffcc00';\n    ctx.fillRect(0, 0, size, size);\n\n    return Texture.from(canvas);\n  }\n\n  _createLavaWaterfallTexture(tileSize) {\n    const canvas = document.createElement('canvas');\n    const size = 64; \n    canvas.width = size; canvas.height = size;\n    const ctx = canvas.getContext('2d');\n\n    // No horizontal gradient to remove bars\n    ctx.fillStyle = '#ffcc00';\n    ctx.fillRect(0, 0, size, size);\n\n    // Lava pieces/streaks (vertical) - these go down\n    ctx.fillStyle = '#ffed8a';\n    for (let k = 0; k < 10; k++) {\n      ctx.globalAlpha = 0.2 + Math.random() * 0.3;\n      const x = Math.random() * size;\n      const y = Math.random() * size;\n      const h = 10 + Math.random() * 15;\n      const w = 3 + Math.random() * 4; // Wider \"chunks\"\n      ctx.fillRect(x, y, w, h);\n      if (y + h > size) ctx.fillRect(x, y - size, w, h);\n    }\n\n    return Texture.from(canvas);\n  }\n\n  _createQuicksandTexture(tileSize) {\n    const canvas = document.createElement('canvas');\n    const size = 64; \n    canvas.width = size; canvas.height = size;\n    const ctx = canvas.getContext('2d');\n\n    // Solid sand color\n    ctx.fillStyle = '#a6915b';\n    ctx.fillRect(0, 0, size, size);\n\n    // grainy texture (static here, will animate pixels via noise)\n    ctx.globalAlpha = 0.3;\n    ctx.fillStyle = '#5c5031';\n    for (let k = 0; k < 25; k++) {\n      ctx.fillRect(Math.random() * size, Math.random() * size, 1, 1);\n    }\n\n    return Texture.from(canvas);\n  }\n\n  _createWaterfallTexture(tileSize) {\n    const canvas = document.createElement('canvas');\n    const size = 64; \n    canvas.width = size; canvas.height = size;\n    const ctx = canvas.getContext('2d');\n\n    // Background color\n    ctx.fillStyle = '#3a7fb8';\n    ctx.fillRect(0, 0, size, size);\n\n    // Vertical streaks\n    ctx.fillStyle = '#ffffff';\n    for (let k = 0; k < 15; k++) {\n      ctx.globalAlpha = 0.1 + Math.random() * 0.4;\n      const x = Math.random() * size;\n      const y = Math.random() * size;\n      const h = 10 + Math.random() * 25;\n      const w = 1 + Math.random() * 2;\n      ctx.fillRect(x, y, w, h);\n      if (y + h > size) ctx.fillRect(x, y - size, w, h);\n    }\n\n    return Texture.from(canvas);\n  }\n\n  _createRadioactiveWaterTexture(tileSize) {\n    const canvas = document.createElement('canvas');\n    const size = 64; \n    canvas.width = size; canvas.height = size;\n    const ctx = canvas.getContext('2d');\n\n    // Solid toxic green\n    ctx.fillStyle = '#1a5c1a';\n    ctx.fillRect(0, 0, size, size);\n\n    // Some mini bubbles (static here, noise provides movement)\n    ctx.fillStyle = '#adff2f';\n    for (let k = 0; k < 12; k++) {\n      ctx.globalAlpha = 0.3 + Math.random() * 0.4;\n      ctx.beginPath();\n      ctx.arc(Math.random() * size, Math.random() * size, 1 + Math.random() * 1.5, 0, Math.PI * 2);\n      ctx.fill();\n    }\n\n    return Texture.from(canvas);\n  }\n\n  _createRadioactiveWaterfallTexture(tileSize) {\n    const canvas = document.createElement('canvas');\n    const size = 64; \n    canvas.width = size; canvas.height = size;\n    const ctx = canvas.getContext('2d');\n\n    ctx.fillStyle = '#1a5c1a';\n    ctx.fillRect(0, 0, size, size);\n\n    // Vertical streaks\n    ctx.fillStyle = '#adff2f';\n    for (let k = 0; k < 12; k++) {\n      ctx.globalAlpha = 0.15 + Math.random() * 0.3;\n      const x = Math.random() * size;\n      const y = Math.random() * size;\n      const h = 8 + Math.random() * 15;\n      const w = 1 + Math.random() * 2;\n      ctx.fillRect(x, y, w, h);\n      if (y + h > size) ctx.fillRect(x, y - size, w, h);\n    }\n    \n    // Pievienojam burbuus (prasba: \"var pieveinot burbuus kuri iet uzleju k radioactive water\")\n    ctx.fillStyle = '#ffffff';\n    for (let k = 0; k < 6; k++) {\n      ctx.globalAlpha = 0.2 + Math.random() * 0.3;\n      ctx.beginPath();\n      ctx.arc(Math.random() * size, Math.random() * size, 1 + Math.random(), 0, Math.PI * 2);\n      ctx.fill();\n    }\n\n    return Texture.from(canvas);\n  }\n\n  _createLavaDetailTexture(w = 128, h = 128) {\n    const canvas = document.createElement('canvas');\n    canvas.width = w; canvas.height = h;\n    const ctx = canvas.getContext('2d');\n    ctx.fillStyle = '#ff8800'; \n    for (let i = 0; i < 10; i++) {\n      ctx.globalAlpha = 0.3 + Math.random() * 0.4;\n      const sw = 12 + Math.random() * 24;\n      const sh = 10 + Math.random() * 20;\n      ctx.fillRect(Math.random() * w, Math.random() * h, sw, sh);\n    }\n    return Texture.from(canvas);\n  }\n\n  _createWaterDetailTexture(w = 128, h = 128) {\n    const canvas = document.createElement('canvas');\n    canvas.width = w; canvas.height = h;\n    const ctx = canvas.getContext('2d');\n    ctx.fillStyle = '#ffffff';\n    for (let i = 0; i < 12; i++) {\n      ctx.globalAlpha = 0.2 + Math.random() * 0.4;\n      ctx.beginPath();\n      ctx.arc(Math.random() * w, Math.random() * h, 1 + Math.random() * 2, 0, Math.PI * 2);\n      ctx.fill();\n    }\n    return Texture.from(canvas);\n  }\n\n  _createQuicksandDetailTexture(w = 128, h = 128) {\n    const canvas = document.createElement('canvas');\n    canvas.width = w; canvas.height = h;\n    const ctx = canvas.getContext('2d');\n    ctx.fillStyle = '#5c5031';\n    for (let i = 0; i < 100; i++) {\n      ctx.globalAlpha = 0.1 + Math.random() * 0.5;\n      ctx.fillRect(Math.random() * w, Math.random() * h, 1, 1);\n    }\n    return Texture.from(canvas);\n  }\n\n  _createNoiseTexture(w = 256, h = 256) {\n    const canvas = document.createElement('canvas');\n    canvas.width = w; canvas.height = h;\n    const ctx = canvas.getContext('2d');\n    \n    ctx.fillStyle = '#ffffff';\n    for(let i=0; i<500; i++) {\n      ctx.globalAlpha = Math.random() * 0.05;\n      ctx.fillRect(Math.random()*w, Math.random()*h, 2, 2);\n    }\n\n    return Texture.from(canvas);\n  }\n\n  // Given tile indices of a region, compute horizontal spans representing its top boundary per row.\n  _computeTopEdgeSpans(tileIndices, mapWidth, tileSize) {\n    // Build a set for O(1) membership\n    const set = new Set(tileIndices);\n    const spans = [];\n    // For each tile that has no neighbor directly above, create a span; merge contiguous tiles in that row\n    const tilesByRow = new Map();\n    for (const idx of tileIndices) {\n      const gy = Math.floor(idx / mapWidth);\n      const gx = idx % mapWidth;\n      const above = idx - mapWidth;\n      if (!set.has(above)) {\n        // This tile contributes to the top edge\n        const rowList = tilesByRow.get(gy) || [];\n        rowList.push(gx);\n        tilesByRow.set(gy, rowList);\n      }\n    }\n    // Merge contiguous gx into spans\n    for (const [gy, cols] of tilesByRow.entries()) {\n      cols.sort((a, b) => a - b);\n      let start = null; let prev = null;\n      for (const gx of cols) {\n        if (start === null) { start = gx; prev = gx; continue; }\n        if (gx === prev + 1) { prev = gx; continue; }\n        // flush previous span\n        spans.push({ x: start * tileSize, y: gy * tileSize, w: (prev - start + 1) * tileSize });\n        start = gx; prev = gx;\n      }\n      if (start !== null) {\n        spans.push({ x: start * tileSize, y: gy * tileSize, w: (prev - start + 1) * tileSize });\n      }\n    }\n    return spans;\n  }\n\n  // Given tile indices of a region, compute horizontal spans representing its bottom boundary per row.\n  _computeBottomEdgeSpans(tileIndices, mapWidth, tileSize) {\n    const set = new Set(tileIndices);\n    const spans = [];\n    const tilesByRow = new Map();\n    for (const idx of tileIndices) {\n      const gy = Math.floor(idx / mapWidth);\n      const gx = idx % mapWidth;\n      const below = idx + mapWidth;\n      if (!set.has(below)) {\n        const rowList = tilesByRow.get(gy) || [];\n        rowList.push(gx);\n        tilesByRow.set(gy, rowList);\n      }\n    }\n    for (const [gy, cols] of tilesByRow.entries()) {\n      cols.sort((a, b) => a - b);\n      let start = null; let prev = null;\n      for (const gx of cols) {\n        if (start === null) { start = gx; prev = gx; continue; }\n        if (gx === prev + 1) { prev = gx; continue; }\n        spans.push({ x: start * tileSize, y: gy * tileSize, w: (prev - start + 1) * tileSize });\n        start = gx; prev = gx;\n      }\n      if (start !== null) {\n        spans.push({ x: start * tileSize, y: gy * tileSize, w: (prev - start + 1) * tileSize });\n      }\n    }\n    return spans;\n  }\n\n  // Public: add a ripple/wave on a liquid surface of given type at world x\n  // type: 'water'|'lava'\n  // x: world pixel X\n  // strength: 0.2..3 roughly; maps to amplitude and speed\n  addWave(type, x, strength = 1) {\n    const t = (type === 'lava') ? 'lava' : 'water';\n    const X = Math.max(0, Math.min(this.mapWidth * this.tileSize, Number(x) || 0));\n    // Find region and a top edge span containing x\n    for (const r of this._regions) {\n      if (r.type !== t) continue;\n      const spans = r.topEdges;\n      if (!Array.isArray(spans) || spans.length === 0) continue;\n      for (let i = 0; i < spans.length; i++) {\n        const e = spans[i];\n        if (X >= e.x && X <= e.x + e.w) {\n          if (!Array.isArray(r.waves)) r.waves = [];\n          // Cap total waves to keep perf stable\n          if (r.waves.length > 24) r.waves.shift();\n          const ts = this.tileSize;\n          const s = Math.max(0.15, Math.min(3, Number(strength) || 1));\n          const baseAmp = (t === 'water') ? ts * 0.18 : ts * 0.10; // pixels\n          const amp = baseAmp * (0.4 + 0.6 * Math.min(1.0, s));\n          const speed = (t === 'water') ? (40 + 60 * s) : (30 + 40 * s); // px/s growth\n          const startRadius = Math.max(4, ts * 0.2);\n          // lifetimes in ms\n          const lifeMsWater = 1600 + 900 * s;\n          const lifeMsLava = 900 + 600 * s;\n          r.waves.push({ cx: X, t: 0, amp, ampNow: amp, speed, radius: startRadius, startRadius, lifeMsWater, lifeMsLava });\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n}\n","// Lightweight reusable health bar for PixiJS\n// Usage:\n//   import { HealthBar } from './HealthBar';\n//   const hb = new HealthBar({ width: 32, height: 4, offsetY: -6 });\n//   container.addChild(hb);\n//   hb.update(currentHealth, maxHealth);\n\nimport { Container, Graphics } from 'pixi.js';\n\nexport class HealthBar extends Container {\n  constructor(options = {}) {\n    super();\n    const {\n      width = 32,\n      height = 4,\n      offsetX = 0,\n      offsetY = -6,\n      thresholds = { warn: 0.55, danger: 0.35 },\n      colors = { ok: 0x2ecc71, warn: 0xf1c40f, danger: 0xe74c3c },\n      // Use a neutral gray track instead of near-black; keep border options for backward compat (unused)\n      trackColor = 0x666666,\n      borderColor = 0x000000,\n      borderAlpha = 0.8,\n    } = options;\n\n    this._w = Math.max(4, Math.floor(width));\n    this._h = Math.max(2, Math.floor(height));\n    this._pct = -1; // force first draw\n    this._color = 0xffffff;\n    this._thresholds = thresholds;\n    this._colors = colors;\n    this._trackColor = trackColor;\n    this._borderColor = borderColor;\n    this._borderAlpha = borderAlpha;\n\n    this.x = offsetX || 0;\n    this.y = offsetY || 0;\n\n    this._track = new Graphics();\n    this._fill = new Graphics();\n    this.addChild(this._track);\n    this.addChild(this._fill);\n\n    this._redrawAll();\n  }\n\n  resize(width, height) {\n    const w = Math.max(4, Math.floor(width || this._w));\n    const h = Math.max(2, Math.floor(height || this._h));\n    if (w === this._w && h === this._h) return;\n    this._w = w; this._h = h;\n    this._redrawAll();\n  }\n\n  update(current, max) {\n    const m = Math.max(0, Number(max) || 0);\n    if (m <= 0 || !Number.isFinite(current)) {\n      this.visible = false;\n      return;\n    }\n    const c = Math.max(0, Math.min(m, Number(current)));\n    const pct = m > 0 ? c / m : 0;\n    this.visible = true;\n\n    const color = pct < this._thresholds.danger\n      ? this._colors.danger\n      : (pct < this._thresholds.warn ? this._colors.warn : this._colors.ok);\n\n    // Only redraw fill if percent or color changed noticeably\n    if (Math.abs(pct - this._pct) > 0.001 || color !== this._color) {\n      this._pct = pct;\n      this._color = color;\n      this._redrawFill();\n    }\n  }\n\n  _redrawAll() {\n    // Track (no border)\n    const w = this._w, h = this._h;\n    this._track.clear();\n    this._track.roundRect(0, 0, w, h, Math.min(3, h * 0.5));\n    this._track.fill({ color: this._trackColor, alpha: 0.85 });\n    // Redraw fill with current state\n    this._redrawFill();\n  }\n\n  _redrawFill() {\n    const w = this._w, h = this._h;\n    const innerW = Math.max(0, Math.floor(w * Math.max(0, Math.min(1, this._pct))));\n    const radius = Math.min(2, Math.floor(h / 2));\n    this._fill.clear();\n    if (innerW <= 0) return;\n    this._fill.roundRect(0, 0, innerW, h, radius);\n    this._fill.fill({ color: this._color, alpha: 1 });\n  }\n}\n\nexport default HealthBar;\n","// Centralized z-order constants for Pixi stage layers\n// Higher numbers render above lower numbers when sortableChildren = true\nexport const LAYERS = Object.freeze({\n  parallax: 10,\n  tiles: 20,\n  tilesAnim: 25,\n  liquidBackground: 28,\n  objBehind: 30,\n  secretsBelow: 35,\n  player: 40,\n  projectiles: 50,\n  objFront: 60,\n  secretsAbove: 65,\n  weather: 70,\n  fog: 80,\n  liquids: 90,\n  liquidFx: 100,\n  overlay: 110,\n});\n\nexport default LAYERS;\n","import { Texture } from 'pixi.js';\n\n// Small helper cache for textures\nconst textureCacheMap = new Map();\n\nexport const getTexture = (url) => {\n  if (!url) {\n    console.warn('[getTexture] No URL provided');\n    return null;\n  }\n  if (textureCacheMap.has(url)) {\n    return textureCacheMap.get(url);\n  }\n  try {\n    const tex = Texture.from(url);\n    if (!tex) {\n      console.warn('[getTexture] Failed to create texture from URL:', url);\n      return null;\n    }\n    textureCacheMap.set(url, tex);\n    return tex;\n  } catch (e) {\n    console.error('[getTexture] Error creating texture:', url, e);\n    return null;\n  }\n};\n\nexport const clearTextureCache = () => {\n  textureCacheMap.forEach((t) => t.destroy && t.destroy(true));\n  textureCacheMap.clear();\n};\n\n// Background images resolver (from src/assets/background)\n// Meta stores `/assets/background/<name>`\nexport const createBackgroundResolver = () => {\n  let bgContext;\n  try {\n    // webpack require.context (CRA)\n    // relative to this file: '../../../../assets/background'\n    bgContext = require.context('../../../../assets/background', false, /\\.(png|jpe?g|svg|webp)$/i);\n  } catch (e) {\n    bgContext = null;\n  }\n\n  return (metaPath) => {\n    if (!bgContext) {\n      console.warn('[BackgroundResolver] No bgContext available');\n      return null;\n    }\n    if (!metaPath) {\n      const keys = bgContext.keys();\n      if (keys && keys.length) {\n        const mod = bgContext(keys[0]);\n        return mod.default || mod;\n      }\n      return null;\n    }\n    const name = metaPath.split('/').pop();\n    const rel = `./${name}`;\n    try {\n      const mod = bgContext(rel);\n      return mod.default || mod;\n    } catch (e) {\n      // fallback to first available\n      const keys = bgContext.keys();\n      if (keys && keys.length) {\n        const mod = bgContext(keys[0]);\n        return mod.default || mod;\n      }\n      return null;\n    }\n  };\n};\n\n// Convert ms-per-frame (JSON) to Pixi AnimatedSprite speed factor (1 = 60fps)\nexport const msToSpeed = (ms) => {\n  const m = Number(ms);\n  const msPerFrame = Number.isFinite(m) && m > 0 ? m : 500;\n  const fps = 1000 / msPerFrame;\n  return fps / 60; // Pixi speed factor\n};\n\n// Helper to get registry item by id\nexport const getRegItem = (registryItems, id) => registryItems.find((r) => r.id === id);\n\n// Solid collision helper for world tiles (used by weather systems)\nexport const createSolidChecker = (mapWidth, mapHeight, tileSize, tileMapData, registryItems) => {\n  return (wx, wy) => {\n    // Allow particles (snow/rain) to spawn above the top edge and fall into the world.\n    // Negative Y should NOT be treated as solid, otherwise flakes will \"settle\" off-screen.\n    if (wy < 0) return false;\n    // Keep left-of-world as solid to avoid pushing from outside horizontally.\n    if (wx < 0) return true;\n    const gx = Math.floor(wx / tileSize);\n    const gy = Math.floor(wy / tileSize);\n    if (gx < 0 || gy < 0 || gx >= mapWidth || gy >= mapHeight) return false; // below world is not solid\n    const idx = gy * mapWidth + gx;\n    const id = tileMapData[idx];\n    if (!id) return false;\n    const def = getRegItem(registryItems, id);\n    if (!def) return false;\n    const c = def.collision;\n    if (!c) return false;\n    if (c === true) return true;\n    if (typeof c === 'object') {\n      return !!(c.top || c.bottom || c.left || c.right);\n    }\n    return false;\n  };\n};\n","import { Texture } from 'pixi.js';\n\n// Generate procedural water frames (cached per tile size)\nexport const createWaterFrames = (tileSize) => {\n  const frames = [];\n  const F = 8; // frame count\n  for (let i = 0; i < F; i++) {\n    const canvas = document.createElement('canvas');\n    canvas.width = tileSize;\n    canvas.height = tileSize;\n    const ctx = canvas.getContext('2d');\n\n    // background gradient\n    const g = ctx.createLinearGradient(0, 0, 0, tileSize);\n    g.addColorStop(0, '#3a7fb8');\n    g.addColorStop(0.5, '#5ba3d9');\n    g.addColorStop(1, '#3a7fb8');\n    ctx.fillStyle = g;\n    ctx.fillRect(0, 0, tileSize, tileSize);\n\n    // animated ripples via sine stripes\n    ctx.globalAlpha = 0.25;\n    ctx.fillStyle = '#8fc0ff';\n    const t = i / F;\n    const bands = 3;\n    for (let b = 0; b < bands; b++) {\n      const y = Math.floor((tileSize / bands) * b + (tileSize / bands) * 0.5 + Math.sin((t + b * 0.33) * Math.PI * 2) * (tileSize * 0.08));\n      ctx.fillRect(0, y, tileSize, Math.max(1, Math.floor(tileSize * 0.06)));\n    }\n\n    // soft top highlight\n    ctx.globalAlpha = 0.18;\n    ctx.fillStyle = '#c9ecff';\n    ctx.fillRect(0, 0, tileSize, Math.max(1, Math.floor(tileSize * 0.12)));\n\n    const tex = Texture.from(canvas);\n    frames.push(tex);\n  }\n  return frames;\n};\n\n// Generate procedural lava frames (cached per tile size)\nexport const createLavaFrames = (tileSize) => {\n  const frames = [];\n  const F = 8;\n  for (let i = 0; i < F; i++) {\n    const canvas = document.createElement('canvas');\n    canvas.width = tileSize;\n    canvas.height = tileSize;\n    const ctx = canvas.getContext('2d');\n\n    // base gradient (yellow to golden)\n    const g = ctx.createLinearGradient(0, 0, 0, tileSize);\n    g.addColorStop(0, '#ffaa00');\n    g.addColorStop(1, '#ffcc00');\n    ctx.fillStyle = g;\n    ctx.fillRect(0, 0, tileSize, tileSize);\n\n    // glowing veins\n    const t = i / F;\n    ctx.globalAlpha = 0.3;\n    for (let b = 0; b < 3; b++) {\n      const y = Math.floor((tileSize / 3) * b + (tileSize / 3) * 0.5 + Math.sin((t * 2 + b * 0.6) * Math.PI * 2) * (tileSize * 0.1));\n      const h = Math.max(1, Math.floor(tileSize * 0.07));\n      const grad = ctx.createLinearGradient(0, y, 0, y + h);\n      grad.addColorStop(0, '#ffff00');\n      grad.addColorStop(1, '#ffaa00');\n      ctx.fillStyle = grad;\n      ctx.fillRect(0, y, tileSize, h);\n    }\n\n    // bubbles/dots\n    ctx.globalAlpha = 0.25;\n    ctx.fillStyle = '#ffffff';\n    const count = Math.max(2, Math.floor(tileSize * 0.12));\n    for (let k = 0; k < count; k++) {\n      const rx = Math.floor((k * 37 + i * 13) % tileSize);\n      const ry = Math.floor((k * 53 + i * 29) % tileSize);\n      ctx.fillRect(rx, ry, 1, 1);\n    }\n\n    const tex = Texture.from(canvas);\n    frames.push(tex);\n  }\n  return frames;\n};\n\n// Helpers to check if a definition is water or lava\nexport const isWaterDef = (def) => !!(def && def.flags && def.flags.water);\nexport const isLavaDef = (def) => !!(def && def.flags && def.flags.lava);\nexport const isQuicksandDef = (def) => !!(def && def.flags && def.flags.quicksand);\nexport const isWaterfallDef = (def) => !!(def && def.flags && def.flags.waterfall);\nexport const isLavaWaterfallDef = (def) => !!(def && def.flags && def.flags.lava_waterfall);\nexport const isRadioactiveWaterDef = (def) => !!(def && def.flags && def.flags.radioactive_water);\nexport const isRadioactiveWaterfallDef = (def) => !!(def && def.flags && def.flags.radioactive_waterfall);\n\n// Generate procedural quicksand frames (cached per tile size)\nexport const createQuicksandFrames = (tileSize) => {\n  const frames = [];\n  const F = 12; // slightly more frames for smoother slow movement\n  for (let i = 0; i < F; i++) {\n    const canvas = document.createElement('canvas');\n    canvas.width = tileSize;\n    canvas.height = tileSize;\n    const ctx = canvas.getContext('2d');\n\n    // base sand color (brownish yellow)\n    const g = ctx.createLinearGradient(0, 0, 0, tileSize);\n    g.addColorStop(0, '#a6915b');\n    g.addColorStop(1, '#7d6d42');\n    ctx.fillStyle = g;\n    ctx.fillRect(0, 0, tileSize, tileSize);\n\n    // grainy texture / swirling patterns\n    const t = i / F;\n    ctx.globalAlpha = 0.2;\n    ctx.fillStyle = '#5c5031';\n    for (let k = 0; k < 4; k++) {\n       const y = Math.floor((tileSize / 4) * k + (t * tileSize)) % tileSize;\n       ctx.fillRect(0, y, tileSize, 1);\n    }\n    \n    // random grains\n    ctx.globalAlpha = 0.15;\n    ctx.fillStyle = '#d1ba7d';\n    const count = Math.max(5, Math.floor(tileSize * 0.25));\n    for (let k = 0; k < count; k++) {\n      const rx = Math.floor((k * 43 + i * 7) % tileSize);\n      const ry = Math.floor((k * 61 + i * 11) % tileSize);\n      ctx.fillRect(rx, ry, 1, 1);\n    }\n\n    const tex = Texture.from(canvas);\n    frames.push(tex);\n  }\n  return frames;\n};\n\n// Generate procedural waterfall frames\nexport const createWaterfallFrames = (tileSize) => {\n  const frames = [];\n  const F = 10;\n  for (let i = 0; i < F; i++) {\n    const canvas = document.createElement('canvas');\n    canvas.width = tileSize;\n    canvas.height = tileSize;\n    const ctx = canvas.getContext('2d');\n\n    // base transparent blue (izmantojam dens krsas)\n    const g = ctx.createLinearGradient(0, 0, 0, tileSize);\n    g.addColorStop(0, 'rgba(42, 93, 143, 0.5)');\n    g.addColorStop(0.5, 'rgba(91, 163, 217, 0.5)');\n    g.addColorStop(1, 'rgba(42, 93, 143, 0.5)');\n    ctx.fillStyle = g;\n    ctx.fillRect(0, 0, tileSize, tileSize);\n\n    // sas vertiklas svtrias\n    const t = i / F;\n    ctx.fillStyle = 'rgba(255, 255, 255, 0.4)';\n    const count = 6;\n    for (let k = 0; k < count; k++) {\n      const x = Math.floor((tileSize / count) * k + (tileSize / (count*2)) + Math.sin(t * Math.PI * 2 + k) * 2);\n      const h = Math.floor(tileSize * 0.3);\n      const y = Math.floor((t * tileSize + k * (tileSize / count)) % tileSize);\n      ctx.fillRect(x, y, 2, h);\n      if (y + h > tileSize) {\n        ctx.fillRect(x, y - tileSize, 2, h);\n      }\n    }\n\n    const tex = Texture.from(canvas);\n    frames.push(tex);\n  }\n  return frames;\n};\n\n// Generate procedural lava waterfall frames\nexport const createLavaWaterfallFrames = (tileSize) => {\n  const frames = [];\n  const F = 10;\n  for (let i = 0; i < F; i++) {\n    const canvas = document.createElement('canvas');\n    canvas.width = tileSize;\n    canvas.height = tileSize;\n    const ctx = canvas.getContext('2d');\n\n    // base transparent lava colors\n    const g = ctx.createLinearGradient(0, 0, 0, tileSize);\n    g.addColorStop(0, 'rgba(255, 170, 0, 0.6)');\n    g.addColorStop(0.5, 'rgba(255, 204, 0, 0.6)');\n    g.addColorStop(1, 'rgba(255, 170, 0, 0.6)');\n    ctx.fillStyle = g;\n    ctx.fillRect(0, 0, tileSize, tileSize);\n\n    // animated lava streaks\n    const t = i / F;\n    ctx.fillStyle = 'rgba(255, 255, 0, 0.5)';\n    const count = 5;\n    for (let k = 0; k < count; k++) {\n      const x = Math.floor((tileSize / count) * k + (tileSize / (count*2)) + Math.sin(t * Math.PI * 2 + k) * 2);\n      const h = Math.floor(tileSize * 0.4);\n      const y = Math.floor((t * tileSize + k * (tileSize / count)) % tileSize);\n      ctx.fillRect(x, y, 2, h);\n      if (y + h > tileSize) {\n        ctx.fillRect(x, y - tileSize, 2, h);\n      }\n    }\n\n    const tex = Texture.from(canvas);\n    frames.push(tex);\n  }\n  return frames;\n};\n\n// Generate procedural radioactive water frames\nexport const createRadioactiveWaterFrames = (tileSize) => {\n  const frames = [];\n  const F = 12;\n  for (let i = 0; i < F; i++) {\n    const canvas = document.createElement('canvas');\n    canvas.width = tileSize;\n    canvas.height = tileSize;\n    const ctx = canvas.getContext('2d');\n\n    // background gradient (toxic green)\n    const g = ctx.createLinearGradient(0, 0, 0, tileSize);\n    g.addColorStop(0, '#1a5c1a');\n    g.addColorStop(1, '#0d2e0d');\n    ctx.fillStyle = g;\n    ctx.fillRect(0, 0, tileSize, tileSize);\n\n    const t = i / F;\n    \n    // Bubbles\n    ctx.globalAlpha = 0.6;\n    ctx.fillStyle = '#32cd32';\n    const bubbleCount = 4;\n    for (let k = 0; k < bubbleCount; k++) {\n      const bx = Math.floor((k * 137 + i * 2) % tileSize);\n      const by = Math.floor((tileSize + k * 43 - (t * tileSize + k * 10)) % tileSize);\n      const size = 1 + (Math.sin(t * Math.PI + k) * 0.5 + 0.5) * 2;\n      ctx.beginPath();\n      ctx.arc(bx, by, size, 0, Math.PI * 2);\n      ctx.fill();\n    }\n\n    // Glow streaks\n    ctx.globalAlpha = 0.2;\n    ctx.fillStyle = '#adff2f';\n    for (let b = 0; b < 2; b++) {\n      const y = Math.floor((tileSize / 2) * b + Math.sin((t + b * 0.5) * Math.PI * 2) * (tileSize * 0.1));\n      ctx.fillRect(0, y, tileSize, 1);\n    }\n\n    const tex = Texture.from(canvas);\n    frames.push(tex);\n  }\n  return frames;\n};\n\n// Generate procedural radioactive waterfall frames\nexport const createRadioactiveWaterfallFrames = (tileSize) => {\n  const frames = [];\n  const F = 16; // more frames for slower motion\n  for (let i = 0; i < F; i++) {\n    const canvas = document.createElement('canvas');\n    canvas.width = tileSize;\n    canvas.height = tileSize;\n    const ctx = canvas.getContext('2d');\n\n    const g = ctx.createLinearGradient(0, 0, 0, tileSize);\n    g.addColorStop(0, 'rgba(26, 92, 26, 0.6)');\n    g.addColorStop(0.5, 'rgba(50, 205, 50, 0.6)');\n    g.addColorStop(1, 'rgba(26, 92, 26, 0.6)');\n    ctx.fillStyle = g;\n    ctx.fillRect(0, 0, tileSize, tileSize);\n\n    const t = i / F;\n    ctx.fillStyle = 'rgba(173, 255, 47, 0.5)';\n    const count = 4; // fewer streaks\n    for (let k = 0; k < count; k++) {\n      const x = Math.floor((tileSize / count) * k + (tileSize / (count*2)) + Math.sin(t * Math.PI * 2 + k) * 2);\n      const h = Math.floor(tileSize * 0.2);\n      const y = Math.floor((t * tileSize + k * (tileSize / count)) % tileSize);\n      ctx.fillRect(x, y, 2, h);\n      if (y + h > tileSize) {\n        ctx.fillRect(x, y - tileSize, 2, h);\n      }\n    }\n\n    const tex = Texture.from(canvas);\n    frames.push(tex);\n  }\n  return frames;\n};\n","import { TilingSprite, Sprite, Texture, WRAP_MODES, BlurFilter, Assets } from 'pixi.js';\n\n// Parallax background helper. Manages background layers (solid color and image).\nexport class ParallaxBackground {\n  constructor(container, textureCache) {\n    this.container = container;\n    this.cache = textureCache;\n    this.bgSprite = null; // Solid color layer\n    this.imgSprite = null; // Image layer\n    this._worldW = 0;\n    this._worldH = 0;\n    this._lastCameraX = 0;\n    this._currentUrl = null;\n  }\n\n  build({ worldWidth, worldHeight, url, color, factor = 0.3, minWidth = 0, minHeight = 0 }) {\n    if (!this.container) return;\n    this.clear();\n\n    const w = Math.max(worldWidth, minWidth);\n    const h = Math.max(worldHeight, minHeight);\n\n    this._worldW = worldWidth;\n    this._worldH = worldHeight;\n    this._currentUrl = url;\n\n    // 1. Render solid color background FIRST (always present as base)\n    const hex = (typeof color === 'string' && color.startsWith('#'))\n      ? parseInt(color.slice(1), 16)\n      : (Number(color) || 0x87CEEB);\n    \n    const solid = new Sprite(Texture.WHITE);\n    solid.tint = hex;\n    solid.width = w;\n    solid.height = h;\n    solid.alpha = 1.0;\n    try {\n      solid.filters = [new BlurFilter({ strength: 0.8, quality: 2 })];\n    } catch {}\n    this.container.addChild(solid);\n    this.bgSprite = solid;\n\n    // 2. If URL is provided, attempt to load and render image on top\n    if (url) {\n      const setupImage = (tex) => {\n        if (!this.container || this._currentUrl !== url) return;\n        \n        // Remove old image if any\n        if (this.imgSprite) {\n          try { this.container.removeChild(this.imgSprite); } catch {}\n          try { this.imgSprite.destroy(); } catch {}\n          this.imgSprite = null;\n        }\n\n        if (!tex) {\n          console.warn('[ParallaxBackground] setupImage called with no texture');\n          return;\n        }\n\n        // Fix wrap mode for tiling\n        if (tex.baseTexture) tex.baseTexture.wrapMode = WRAP_MODES.REPEAT;\n        if (tex.source) tex.source.addressMode = 'repeat';\n\n        const sprite = new TilingSprite({ texture: tex, width: w, height: h });\n        const texH = (tex.height || (tex.source ? tex.source.height : 0) || 1);\n        const scaleY = h / texH;\n        sprite.tileScale.set(1, scaleY);\n        sprite.alpha = 1.0;\n        try {\n          sprite.filters = [new BlurFilter({ strength: 1.2, quality: 2 })];\n        } catch {}\n        \n        this.container.addChild(sprite);\n        this.imgSprite = sprite;\n        this.setScroll(this._lastCameraX || 0, factor);\n      };\n\n      // Try to get from Assets cache or Texture cache\n      let tex = null;\n      try {\n        tex = Assets.get(url);\n      } catch (e) {\n        tex = this.cache?.get(url) || Texture.from(url);\n      }\n\n      const isValid = tex && (\n        tex.valid || \n        (tex.baseTexture && tex.baseTexture.valid) || \n        (tex.source && tex.source.width > 0)\n      );\n\n      if (isValid) {\n        console.log('[ParallaxBackground] Texture already ready');\n        setupImage(tex);\n      } else {\n        console.log('[ParallaxBackground] Texture not ready, loading via Assets.load...');\n        Assets.load(url).then((loadedTex) => {\n          console.log('[ParallaxBackground] Texture loaded via Assets.load');\n          setupImage(loadedTex);\n        }).catch(err => {\n          console.error('[ParallaxBackground] Failed to load background image:', url, err);\n        });\n      }\n    }\n  }\n\n  setScroll(cameraX, factor = 0.3) {\n    this._lastCameraX = cameraX;\n    if (this.imgSprite && 'tilePosition' in this.imgSprite) {\n      this.imgSprite.tilePosition.x = -cameraX * factor;\n      this.imgSprite.tilePosition.y = 0;\n    }\n  }\n\n  resize(worldWidth, worldHeight, minWidth = 0, minHeight = 0) {\n    const w = Math.max(worldWidth, minWidth);\n    const h = Math.max(worldHeight, minHeight);\n\n    this._worldW = worldWidth;\n    this._worldH = worldHeight;\n    if (this.bgSprite) {\n      this.bgSprite.width = w;\n      this.bgSprite.height = h;\n    }\n    if (this.imgSprite) {\n      this.imgSprite.width = w;\n      this.imgSprite.height = h;\n      const tex = this.imgSprite.texture;\n      const texH = (tex?.height || (tex?.source ? tex.source.height : 0) || 1);\n      if (this.imgSprite.tileScale && texH > 0) {\n        const scaleY = h / texH;\n        this.imgSprite.tileScale.set(1, scaleY);\n      }\n    }\n  }\n\n  clear() {\n    if (this.bgSprite) {\n      try { this.container.removeChild(this.bgSprite); } catch {}\n      try { this.bgSprite.destroy(); } catch {}\n      this.bgSprite = null;\n    }\n    if (this.imgSprite) {\n      try { this.container.removeChild(this.imgSprite); } catch {}\n      try { this.imgSprite.destroy(); } catch {}\n      this.imgSprite = null;\n    }\n  }\n\n  destroy() {\n    this.clear();\n    this.container = null;\n    this.cache = null;\n  }\n}\n","import { ParallaxBackground } from '../../../../Pixi/layers/ParallaxBackground';\n\n// Build or rebuild parallax background via helper\nexport const createParallaxManager = (parallaxLayer, textureCacheRef) => {\n  let parallaxHelper = null;\n  let parallaxSprite = null;\n\n  const build = (options) => {\n    const { worldWidth, worldHeight, url, color, factor, resolveBackgroundUrl, minWidth = 0, minHeight = 0 } = options;\n\n    if (!parallaxHelper) {\n      parallaxHelper = new ParallaxBackground(parallaxLayer, textureCacheRef);\n    }\n\n    // Resolve URL and validate it exists\n    let resolvedUrl = null;\n    if (url) {\n      resolvedUrl = resolveBackgroundUrl ? resolveBackgroundUrl(url) : url;\n    }\n\n    // If no valid URL, pass null so ParallaxBackground uses solid color fallback\n    parallaxHelper.build({\n      worldWidth,\n      worldHeight,\n      url: resolvedUrl,\n      color: color || '#87CEEB',\n      factor: factor || 0.3,\n      minWidth,\n      minHeight\n    });\n\n    parallaxSprite = parallaxHelper.imgSprite || parallaxHelper.bgSprite;\n  };\n\n  const setScroll = (cameraX, factor) => {\n    if (parallaxHelper) {\n      parallaxHelper.setScroll(cameraX, factor);\n    }\n  };\n\n  const resize = (worldWidth, worldHeight, minWidth = 0, minHeight = 0) => {\n    if (parallaxHelper) {\n      parallaxHelper.resize(worldWidth, worldHeight, minWidth, minHeight);\n    }\n  };\n\n  const destroy = () => {\n    if (parallaxHelper) {\n      try {\n        parallaxHelper.destroy();\n      } catch (e) {\n        // ignore\n      }\n      parallaxHelper = null;\n      parallaxSprite = null;\n    }\n  };\n\n  return {\n    build,\n    setScroll,\n    resize,\n    destroy,\n    get sprite() {\n      return parallaxHelper?.imgSprite || parallaxHelper?.bgSprite;\n    },\n    get helper() {\n      return parallaxHelper;\n    }\n  };\n};\n","import { Sprite, AnimatedSprite, Texture, Container, Text } from 'pixi.js';\nimport { getTexture, msToSpeed } from './helpers';\nimport HealthBar from '../../../../Pixi/ui/HealthBar';\n\n// Build sprite from definition (static or animated)\nexport const buildSpriteFromDef = (def) => {\n  if (!def) return null;\n\n  let spr = null;\n  if (Array.isArray(def.textures) && def.textures.length > 1) {\n    const frames = def.textures.map((u) => getTexture(u)).filter(Boolean);\n    if (frames.length > 0) {\n      spr = new AnimatedSprite(frames);\n      spr.animationSpeed = msToSpeed(def.animationSpeed);\n      spr.play();\n    }\n  }\n\n  // Ja nav tekstru masva vai tas ir tuks, minm parasto tekstru\n  if (!spr && def.texture) {\n    const tex = getTexture(def.texture);\n    if (tex) {\n      spr = new Sprite(tex);\n    }\n  }\n\n  // Ja joprojm nav spr (piemram, nav tekstras), prbaudm editorIcon\n  if (!spr && def.editorIcon) {\n    spr = new Text({\n        text: def.editorIcon,\n        style: {\n            fontSize: 24,\n            fill: 0xffffff,\n            fontWeight: 'bold',\n            dropShadow: true,\n            dropShadowColor: 0x000000,\n            dropShadowBlur: 4,\n            dropShadowDistance: 2\n        }\n    });\n    // Centrjam tekstu tile ietvaros\n    spr.anchor.set(0.5, 0.5);\n    // T k ms lietojam anchor 0.5, mums bs jpielgo pozcija vlk vai eit\n    // Bet buildSpriteFromDef parasti atgrie objektu, kura anchor ir (0,0) pc noklusjuma\n    // lai tas atbilstu tileSize pozicionanai.\n    // Tpc iestatsim anchor uz 0, bet nedaudz nobdsim?\n    // Labk lietot anchor 0.5 un layerBuilder- pieskaitt tileSize/2.\n  }\n\n  if (!spr) {\n    spr = new Sprite(Texture.WHITE);\n  }\n\n  if (spr instanceof Sprite) {\n    spr.anchor.set(0, 0);\n  } else if (spr instanceof Text) {\n    // Tekstam ms gribam, lai tas btu centr, tpc atstjam 0.5\n  }\n  \n  return spr;\n};\n\n// Create player container with default and hit sprites\nexport const createPlayerContainer = (playerVisuals, registryItems, playerState, tileSize) => {\n  const playerContainer = new Container();\n\n  // Default visuals from prop\n  const defaultDef = playerVisuals || null;\n\n  // Target visuals: try specific IDs\n  const targetDef = Array.isArray(registryItems)\n    ? (registryItems.find(r => r.id === 'player_target_100') || registryItems.find(r => r.id === 'player_target'))\n    : null;\n\n  const defSprite = buildSpriteFromDef(defaultDef) || new Sprite(Texture.WHITE);\n  const hitSprite = buildSpriteFromDef(targetDef) || null;\n\n  playerContainer.addChild(defSprite);\n  if (hitSprite) playerContainer.addChild(hitSprite);\n\n  // Health bar above player\n  let healthBar = null;\n  try {\n    healthBar = new HealthBar({\n      width: (playerState?.width) || tileSize,\n      height: 4,\n      offsetX: 0,\n      offsetY: -5\n    });\n    playerContainer.addChild(healthBar);\n  } catch (e) {\n    console.warn('Failed to create health bar:', e);\n  }\n\n  // Initial visibility\n  defSprite.visible = true;\n  if (hitSprite) hitSprite.visible = false;\n\n  return {\n    container: playerContainer,\n    sprites: { def: defSprite, hit: hitSprite },\n    healthBar\n  };\n};\n\n// Update player sprite position, direction, and visibility\nexport const updatePlayerSprite = (refs, playerState, tileSize, healthBarEnabled) => {\n  const { container, sprites, healthBar } = refs;\n  if (!playerState || !container) return;\n\n  const { def, hit } = sprites || {};\n\n  // Resize child sprites to match player state\n  if (def) {\n    if (playerState.width) def.width = playerState.width;\n    if (playerState.height) def.height = playerState.height;\n  }\n  if (hit) {\n    if (playerState.width) hit.width = playerState.width;\n    if (playerState.height) hit.height = playerState.height;\n  }\n\n  // Update health bar size and value\n  if (healthBar) {\n    const enabled = healthBarEnabled !== false;\n    const inWater = !!playerState.inWater;\n    const inLava = playerState.liquidType === 'lava';\n    if (!enabled) {\n      healthBar.visible = false;\n    } else {\n      // When in water or lava, hide the player-attached HB and use overlay version instead\n      healthBar.visible = !(inWater || inLava);\n      const effectiveWidth = playerState.width || (def?.width) || tileSize;\n      healthBar.resize(effectiveWidth, 4);\n      healthBar.y = -Math.max(4, Math.floor((playerState.height || def?.height || tileSize) * 0.12));\n      healthBar.update(playerState.health, (Number(playerState.maxHealth) || 100));\n    }\n  }\n\n  // Choose which sprite is visible based on hit timer\n  const isHit = Number(playerState.hitTimerMs) > 0 && !!hit;\n  if (def) def.visible = !isHit;\n  if (hit) hit.visible = isHit;\n\n  // Direction flip is applied to the container\n  const dir = playerState.direction || 1;\n  const mag = Math.abs(container.scale.x || 1);\n  container.scale.x = dir >= 0 ? mag : -mag;\n\n  // Position container; when flipped, offset by width\n  const effectiveWidth = playerState.width || (def?.width) || tileSize;\n  container.x = dir >= 0 ? (playerState.x || 0) : ((playerState.x || 0) + effectiveWidth);\n  container.y = playerState.y || 0;\n};\n","import React, { useEffect, useRef, useMemo, useCallback, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { Application, Container, Graphics, Assets } from 'pixi.js';\nimport { TextureCache } from '../../../../Pixi/TextureCache';\nimport { Rain as WeatherRain, Snow as WeatherSnow, Clouds as WeatherClouds, Fog as WeatherFog, Thunder as WeatherThunder, LavaRain as WeatherLavaRain, RadioactiveFog as WeatherRadioactiveFog, MeteorRain as WeatherMeteorRain } from '../../../../Pixi/effects/weather';\nimport { WaterSplashFX, LavaEmbers, LavaSteamFX, LiquidRegionSystem } from '../../../../Pixi/effects/liquids';\nimport HealthBar from '../../../../Pixi/ui/HealthBar';\nimport LAYERS from '../../../../renderer/stage/layers/LayerOrder';\nimport { clearTextureCache, createBackgroundResolver, createSolidChecker } from './helpers';\nimport { createWaterFrames, createLavaFrames } from './liquidRendering';\nimport { createParallaxManager } from './parallaxManager';\nimport { createPlayerContainer, updatePlayerSprite } from './playerManager';\nimport { syncProjectiles, cleanupProjectiles } from './projectileManager';\nimport { syncEntities, cleanupEntities } from './entityManager';\nimport { rebuildLayers } from './layerBuilder';\n\n// Suppress noisy Pixi Assets warnings for inlined data URLs (we load textures directly)\nAssets.setPreferences?.({\n  skipCacheIdWarning: true,\n  preferCreateImageBitmap: false, // Prevents WebGL warning: texImage: Alpha-premult and y-flip are deprecated\n});\n\nconst EMPTY_ARRAY = [];\nconst EMPTY_OBJECT = {};\n\nconst PixiStage = ({\n  mapWidth,\n  mapHeight,\n  tileSize = 32,\n  tileMapData = EMPTY_ARRAY,\n  objectMapData = EMPTY_ARRAY,\n  secretMapData = EMPTY_ARRAY,\n  revealedSecrets = EMPTY_ARRAY,\n  registryItems = EMPTY_ARRAY,\n  playerState,\n  playerVisuals,\n  backgroundImage,\n  backgroundColor,\n  backgroundParallaxFactor = 0.3,\n  cameraScrollX = 0,\n  weatherRain = 0,\n  weatherSnow = 0,\n  weatherClouds = 0,\n  weatherLavaRain = 0,\n  weatherRadioactiveFog = 0,\n  weatherMeteorRain = 0,\n  projectiles = EMPTY_ARRAY,\n  healthBarEnabled = true,\n  objectMetadata = EMPTY_OBJECT,\n  weatherFog = 0,\n  weatherThunder = 0,\n  oxygenBarEnabled = true,\n  lavaBarEnabled = true,\n  waterSplashesEnabled = true,\n  lavaEmbersEnabled = true,\n  isEditor = false,\n  isEditorPlayMode = false,\n  showGrid = false,\n  renderLayers = null, // null means all layers, otherwise an array of layer names to show\n  pointerEvents = 'auto',\n  onWeatherEffectHit = null,\n}) => {\n  const [isPixiReady, setIsPixiReady] = useState(false);\n\n  const mountRef = useRef(null);\n  const appRef = useRef(null);\n  const parallaxRef = useRef(null);\n  const parallaxManagerRef = useRef(null);\n  const cameraScrollRef = useRef(0);\n  const parallaxFactorRef = useRef(Number(backgroundParallaxFactor) || 0.3);\n  const cameraPosRef = useRef({ x: 0, y: 0 });\n  const bgRef = useRef(null);\n  const bgAnimRef = useRef(null);\n  const bgImageRef = useRef(backgroundImage);\n  const bgColorRef = useRef(backgroundColor);\n  const objBehindRef = useRef(null);\n  const objFrontRef = useRef(null);\n  const secretLayerRef = useRef(null);\n  const playerRef = useRef(null);\n  const playerLayerRef = useRef(null);\n  const playerSpriteRefs = useRef({ def: null, hit: null });\n  const playerHealthBarRef = useRef(null);\n  const playerStateRef = useRef(null);\n  const weatherLayerRef = useRef(null);\n  const liquidLayerRef = useRef(null);\n  const liquidBgLayerRef = useRef(null);\n  const liquidSystemRef = useRef(null);\n  const fogLayerRef = useRef(null);\n  const weatherSystemsRef = useRef({ rain: null, snow: null, clouds: null, thunder: null, fog: null, lavaRain: null, radioactiveFog: null, meteorRain: null });\n  const weatherPropsRef = useRef({ rain: 0, snow: 0, clouds: 0, fog: 0, thunder: 0, lavaRain: 0, radioactiveFog: 0, meteorRain: 0 });\n  const projectilesLayerRef = useRef(null);\n  const projectileSpritesRef = useRef(new Map());\n  const entitiesLayerRef = useRef(null);\n  const entitySpritesRef = useRef(new Map());\n  const projectilesPropRef = useRef(EMPTY_ARRAY);\n  const pixiTextureCacheRef = useRef(null);\n  const hbEnabledRef = useRef(healthBarEnabled !== false);\n  const oxyEnabledRef = useRef(oxygenBarEnabled !== false);\n  const lavaEnabledRef = useRef(lavaBarEnabled !== false);\n  const overlayLayerRef = useRef(null);\n  const underwaterRef = useRef({ g: null, time: 0, targetAlpha: 0, currentAlpha: 0 });\n  const waterFramesRef = useRef(null);\n  const lavaFramesRef = useRef(null);\n  const overlayHBRef = useRef(null);\n  const oxygenBarRef = useRef(null);\n  const lavaBarRef = useRef(null);\n  const waterFxRef = useRef(null);\n  const lavaEmbersRef = useRef(null);\n  const lavaSteamRef = useRef(null);\n  const splashesEnabledRef = useRef(waterSplashesEnabled !== false);\n  const embersEnabledRef = useRef(lavaEmbersEnabled !== false);\n  const waterStateRef = useRef({ inWater: false, headUnder: false, vy: 0 });\n  const gridRef = useRef(null);\n  const showGridRef = useRef(showGrid);\n\n  // Keep latest state in refs for ticker\n  useEffect(() => { playerStateRef.current = playerState; }, [playerState]);\n  useEffect(() => { showGridRef.current = showGrid; }, [showGrid]);\n  useEffect(() => { projectilesPropRef.current = Array.isArray(projectiles) ? projectiles : []; }, [projectiles]);\n  useEffect(() => { hbEnabledRef.current = healthBarEnabled !== false; }, [healthBarEnabled]);\n  useEffect(() => { oxyEnabledRef.current = oxygenBarEnabled !== false; }, [oxygenBarEnabled]);\n  useEffect(() => { lavaEnabledRef.current = lavaBarEnabled !== false; }, [lavaBarEnabled]);\n  useEffect(() => { splashesEnabledRef.current = waterSplashesEnabled !== false; }, [waterSplashesEnabled]);\n  useEffect(() => { embersEnabledRef.current = lavaEmbersEnabled !== false; }, [lavaEmbersEnabled]);\n  useEffect(() => { cameraScrollRef.current = Number(cameraScrollX) || 0; }, [cameraScrollX]);\n  useEffect(() => { parallaxFactorRef.current = Number(backgroundParallaxFactor) || 0.3; }, [backgroundParallaxFactor]);\n  useEffect(() => { bgImageRef.current = backgroundImage; }, [backgroundImage]);\n  useEffect(() => { bgColorRef.current = backgroundColor; }, [backgroundColor]);\n\n  // Sync weather props to ref for systems to read live\n  useEffect(() => {\n    weatherPropsRef.current = {\n      rain: Number(weatherRain) || 0,\n      snow: Number(weatherSnow) || 0,\n      clouds: Number(weatherClouds) || 0,\n      fog: Number(weatherFog) || 0,\n      thunder: Number(weatherThunder) || 0,\n      lavaRain: Number(weatherLavaRain) || 0,\n      radioactiveFog: Number(weatherRadioactiveFog) || 0,\n      meteorRain: Number(weatherMeteorRain) || 0,\n    };\n  }, [weatherRain, weatherSnow, weatherClouds, weatherFog, weatherThunder, weatherLavaRain, weatherRadioactiveFog, weatherMeteorRain]);\n\n  // Background resolver and solid checker (memoized per map)\n  const resolveBackgroundUrl = useMemo(() => createBackgroundResolver(), []);\n  const isSolidAt = useMemo(() => createSolidChecker(mapWidth, mapHeight, tileSize, tileMapData, registryItems), [mapWidth, mapHeight, tileSize, tileMapData, registryItems]);\n\n  // Rebuild parallax helper\n  const rebuildParallax = useCallback(() => {\n    const layer = parallaxRef.current;\n    if (!layer) return;\n    if (!pixiTextureCacheRef.current) pixiTextureCacheRef.current = new TextureCache();\n    if (!parallaxManagerRef.current) {\n      parallaxManagerRef.current = createParallaxManager(layer, pixiTextureCacheRef.current);\n    }\n    \n    const bgUrl = bgImageRef.current;\n    const bgColor = bgColorRef.current;\n    const factor = parallaxFactorRef.current || 0.3;\n\n    parallaxManagerRef.current.build({\n      worldWidth: mapWidth * tileSize,\n      worldHeight: mapHeight * tileSize,\n      url: bgUrl,\n      color: bgColor,\n      factor,\n      resolveBackgroundUrl,\n      minWidth: appRef.current?.screen?.width || 0,\n      minHeight: appRef.current?.screen?.height || 0\n    });\n  }, [mapWidth, mapHeight, tileSize, resolveBackgroundUrl]);\n\n  // Initialize Application\n  useEffect(() => {\n    let destroyed = false;\n\n    const init = async () => {\n      if (appRef.current) return;\n\n      const app = new Application();\n      try {\n        await app.init({\n          resizeTo: mountRef.current,\n          backgroundAlpha: 0,\n          antialias: false,\n          autoDensity: true,\n        });\n\n        if (destroyed) {\n          app.destroy(true, { children: true, texture: true });\n          return;\n        }\n\n        if (!app.renderer) return;\n\n        appRef.current = app;\n        app.stage.sortableChildren = true;\n\n        // Create layers\n      const bg = new Container();\n      const bgAnim = new Container();\n      const objBehind = new Container();\n      const objFront = new Container();\n      const secretBelowLayer = new Container();\n      const secretAboveLayer = new Container();\n      const playerLayer = new Container();\n      const entitiesLayer = new Container();\n      const weatherLayer = new Container();\n      const liquidBgLayer = new Container();\n      const liquidLayer = new Container();\n      const liquidFxLayer = new Container();\n      const fogLayer = new Container();\n      const projLayer = new Container();\n      const overlayLayer = new Container();\n\n      // Assign zIndex\n      const parallaxLayer = new Container();\n      parallaxLayer.zIndex = LAYERS.parallax;\n      bg.zIndex = LAYERS.tiles;\n      bgAnim.zIndex = LAYERS.tilesAnim;\n      objBehind.zIndex = LAYERS.objBehind;\n      objFront.zIndex = LAYERS.objFront;\n      secretBelowLayer.zIndex = LAYERS.secretsBelow;\n      secretAboveLayer.zIndex = LAYERS.secretsAbove;\n      playerLayer.zIndex = LAYERS.player;\n      entitiesLayer.zIndex = LAYERS.player;\n      weatherLayer.zIndex = LAYERS.weather;\n      fogLayer.zIndex = LAYERS.fog;\n      liquidBgLayer.zIndex = LAYERS.liquidBackground;\n      liquidLayer.zIndex = LAYERS.liquids;\n      liquidFxLayer.zIndex = LAYERS.liquidFx;\n      projLayer.zIndex = LAYERS.projectiles;\n      overlayLayer.zIndex = LAYERS.overlay;\n\n      bgRef.current = bg;\n      bgAnimRef.current = bgAnim;\n      objBehindRef.current = objBehind;\n      objFrontRef.current = objFront;\n      secretLayerRef.current = { below: secretBelowLayer, above: secretAboveLayer };\n      weatherLayerRef.current = weatherLayer;\n      playerLayerRef.current = playerLayer;\n      liquidBgLayerRef.current = liquidBgLayer;\n      liquidLayerRef.current = liquidLayer;\n      fogLayerRef.current = fogLayer;\n      projectilesLayerRef.current = projLayer;\n      entitiesLayerRef.current = entitiesLayer;\n      overlayLayerRef.current = overlayLayer;\n    \n      const gridGraphics = new Graphics();\n      gridRef.current = gridGraphics;\n      overlayLayer.addChild(gridGraphics);\n      parallaxRef.current = parallaxLayer;\n\n      // Add all layers to stage\n      const allLayersMap = {\n        background: [bg, bgAnim],\n        parallax: [parallaxLayer],\n        tiles: [bg, bgAnim], // Aliased for convenience\n        objects: [objBehind, objFront, secretBelowLayer, secretAboveLayer, entitiesLayer, projLayer],\n        player: [playerLayer],\n        weather: [weatherLayer, fogLayer],\n        liquids: [liquidBgLayer, liquidLayer, liquidFxLayer],\n        overlay: [overlayLayer]\n      };\n\n      if (renderLayers) {\n        renderLayers.forEach(layerName => {\n          const layers = allLayersMap[layerName];\n          if (layers) layers.forEach(l => {\n            if (!app.stage.children.includes(l)) app.stage.addChild(l);\n          });\n        });\n      } else {\n        app.stage.addChild(bg, bgAnim, parallaxLayer, liquidBgLayer, objBehind, secretBelowLayer, playerLayer, entitiesLayer, projLayer, objFront, secretAboveLayer, weatherLayer, fogLayer, liquidLayer, liquidFxLayer, overlayLayer);\n      }\n\n      // Preload textures to avoid Assets cache warnings and ensure textures are ready\n      try {\n        const urlSet = new Set();\n        const addUrl = (u) => { if (typeof u === 'string' && u.length) urlSet.add(u); };\n        registryItems.forEach((def) => {\n          addUrl(def?.texture);\n          if (Array.isArray(def?.textures)) def.textures.forEach(addUrl);\n        });\n        if (playerVisuals) {\n          addUrl(playerVisuals.texture);\n          if (Array.isArray(playerVisuals.textures)) playerVisuals.textures.forEach(addUrl);\n        }\n        const bgUrl = resolveBackgroundUrl(bgImageRef.current);\n        if (bgUrl) addUrl(bgUrl);\n        const urls = Array.from(urlSet);\n        if (urls.length) {\n          console.log('[PixiStage] Preloading', urls.length, 'textures...');\n          await Assets.load(urls);\n          console.log('[PixiStage] Textures preloaded successfully');\n        }\n      } catch (e) {\n        console.warn('Pixi Assets preload encountered an issue (continuing):', e);\n      }\n\n      // Create player\n      const playerComponents = createPlayerContainer(playerVisuals, registryItems, playerState, tileSize);\n      playerLayer.addChild(playerComponents.container);\n      playerRef.current = playerComponents.container;\n      playerSpriteRefs.current = playerComponents.sprites;\n      playerHealthBarRef.current = playerComponents.healthBar;\n\n      // Mount canvas - DROA PIEVIENOANA\n      if (mountRef.current && app.renderer && app.canvas) {\n        mountRef.current.innerHTML = '';\n        mountRef.current.appendChild(app.canvas);\n      }\n\n      // Build underwater overlay\n      const g = new Graphics();\n      overlayLayer.addChild(g);\n      underwaterRef.current.g = g;\n      const W = mapWidth * tileSize;\n      const H = mapHeight * tileSize;\n      g.clear();\n      g.rect(0, 0, W, H);\n      g.fill({ color: 0x1d4875, alpha: 1 });\n      g.alpha = 0;\n      g.visible = false;\n\n      // Build overlay bars\n      const hbOverlay = new HealthBar({ width: (playerState?.width) || tileSize, height: 4, offsetX: 0, offsetY: 0 });\n      hbOverlay.visible = false;\n      overlayLayer.addChild(hbOverlay);\n      overlayHBRef.current = hbOverlay;\n\n      const oxyColors = { ok: 0x2ecdf1, warn: 0x3498db, danger: 0x1f6fb2 };\n      const oxyBar = new HealthBar({ width: (playerState?.width) || tileSize, height: 4, offsetX: 0, offsetY: 0, colors: oxyColors });\n      oxyBar.visible = false;\n      overlayLayer.addChild(oxyBar);\n      oxygenBarRef.current = oxyBar;\n\n      const lavaColors = { ok: 0xffcc00, warn: 0xffaa00, danger: 0xff8800 };\n      const lvBar = new HealthBar({ width: (playerState?.width) || tileSize, height: 4, offsetX: 0, offsetY: 0, colors: lavaColors });\n      lvBar.visible = false;\n      overlayLayer.addChild(lvBar);\n      lavaBarRef.current = lvBar;\n\n      // WebGL context loss/restore handlers\n      if (app.canvas && app.renderer) {\n        app.canvas.addEventListener('webglcontextlost', (e) => {\n          e.preventDefault();\n          console.warn('WebGL context lost');\n        });\n        app.canvas.addEventListener('webglcontextrestored', () => {\n          console.info('WebGL context restored');\n          // No need to manually rebuild here as the main useEffect will catch app state or we can just trigger a state change if needed.\n          // But Pixi v8 often recovers automatically. To be safe, we can force a rebuild by just waiting for next tick.\n        });\n      }\n\n      // Initialize liquid system\n      try {\n        if (liquidSystemRef.current) liquidSystemRef.current.destroy();\n        if (liquidLayerRef.current) {\n          liquidSystemRef.current = new LiquidRegionSystem(liquidLayerRef.current, { \n            mapWidth, \n            mapHeight, \n            tileSize,\n            bgContainer: liquidBgLayerRef.current\n          });\n        }\n      } catch (e) { console.warn('LiquidRegionSystem init failed:', e); }\n\n      // FX systems\n      try { waterFxRef.current = new WaterSplashFX(liquidFxLayer); } catch {}\n      try { lavaSteamRef.current = new LavaSteamFX(liquidFxLayer); } catch {}\n      try {\n        lavaEmbersRef.current = new LavaEmbers(liquidLayerRef.current, { mapWidth, mapHeight, tileSize }, () => (embersEnabledRef.current ? 100 : 0));\n      } catch {}\n\n      rebuildParallax();\n\n      // Finalize initialization by setting appRef\n      // This will trigger the second useEffect to build layers and player\n      appRef.current = app;\n      setIsPixiReady(true);\n      app.ticker.add(() => {\n        if (gridRef.current) {\n          gridRef.current.clear();\n          if (showGridRef.current) {\n            for (let x = 0; x <= mapWidth; x++) {\n              gridRef.current.moveTo(x * tileSize, 0);\n              gridRef.current.lineTo(x * tileSize, mapHeight * tileSize);\n            }\n            for (let y = 0; y <= mapHeight; y++) {\n              gridRef.current.moveTo(0, y * tileSize);\n              gridRef.current.lineTo(mapWidth * tileSize, y * tileSize);\n            }\n            gridRef.current.stroke({ width: 0.5, color: 0xffffff, alpha: 0.2 });\n          }\n        }\n\n        const s = playerStateRef.current;\n        if (s && playerRef.current) {\n          updatePlayerSprite(\n            { container: playerRef.current, sprites: playerSpriteRefs.current, healthBar: playerHealthBarRef.current },\n            s,\n            tileSize,\n            hbEnabledRef.current\n          );\n        }\n\n        // Camera Follow\n        const sw = app.screen.width;\n        const sh = app.screen.height;\n        const worldW = mapWidth * tileSize;\n        const worldH = mapHeight * tileSize;\n\n        if (s) {\n          const targetX = (s.x || 0) + (s.width || tileSize) / 2;\n          const targetY = (s.y || 0) + (s.height || tileSize) / 2;\n\n          let camX = targetX - sw / 2;\n          let camY = targetY - sh / 2;\n\n          // Constraints with centering for small maps\n          if (worldW < sw) {\n            camX = (worldW - sw) / 2;\n          } else {\n            camX = Math.max(0, Math.min(camX, worldW - sw));\n          }\n\n          if (worldH < sh) {\n            camY = (worldH - sh) / 2;\n          } else {\n            camY = Math.max(0, Math.min(camY, worldH - sh));\n          }\n\n          cameraPosRef.current = { x: camX, y: camY };\n          app.stage.pivot.set(camX, camY);\n\n          if (parallaxRef.current) {\n            parallaxRef.current.position.set(camX, camY);\n          }\n\n          const f = parallaxFactorRef.current;\n          if (parallaxManagerRef.current) {\n            parallaxManagerRef.current.resize(worldW, worldH, sw, sh);\n            parallaxManagerRef.current.setScroll(camX, f);\n          }\n        }\n\n        // Weather\n        const dt = app.ticker?.deltaMS || 16.67;\n        const systems = weatherSystemsRef.current;\n        const swNow = app.screen.width;\n        const shNow = app.screen.height;\n\n        if (systems.rain) {\n          if (systems.rain.resize) systems.rain.resize(swNow, shNow);\n          systems.rain.update(dt);\n        }\n        if (systems.lavaRain) {\n          if (systems.lavaRain.resize) systems.lavaRain.resize(swNow, shNow);\n          systems.lavaRain.update(dt);\n        }\n        if (systems.snow) {\n          if (systems.snow.resize) systems.snow.resize(swNow, shNow);\n          systems.snow.update(dt);\n        }\n        if (systems.meteorRain) {\n          if (systems.meteorRain.resize) systems.meteorRain.resize(swNow, shNow);\n          systems.meteorRain.update(dt);\n        }\n        if (systems.clouds) {\n          if (systems.clouds.resize) systems.clouds.resize(swNow, shNow);\n          systems.clouds.update(dt);\n        }\n        if (systems.fog) {\n          if (systems.fog.resize) systems.fog.resize(swNow, shNow);\n          systems.fog.update(dt);\n        }\n        if (systems.radioactiveFog) {\n          if (systems.radioactiveFog.resize) systems.radioactiveFog.resize(swNow, shNow);\n          systems.radioactiveFog.update(dt);\n        }\n        if (systems.thunder) {\n          if (systems.thunder.resize) systems.thunder.resize(swNow, shNow);\n          systems.thunder.update(dt);\n        }\n\n        // Liquids\n        try {\n          if (liquidSystemRef.current && s) {\n            liquidSystemRef.current.setPlayerState(s);\n          }\n          liquidSystemRef.current?.update(dt);\n        } catch {}\n\n        // FX\n        try { lavaEmbersRef.current?.update(dt); } catch {}\n        try { waterFxRef.current?.update(dt); } catch {}\n        try { lavaSteamRef.current?.update(dt); } catch {}\n\n        // Underwater/lava overlay with smooth fade-in/out\n        try {\n          const u = underwaterRef.current;\n          const sNow = playerStateRef.current || {};\n\n          // Safety check: ensure graphics object exists and is attached\n          if (u && (!u.g || u.g.destroyed)) {\n            const overlayL = overlayLayerRef.current;\n            if (overlayL) {\n              const g = new Graphics();\n              overlayL.addChild(g);\n              u.g = g;\n              u.currentAlpha = 0;\n              u.targetAlpha = 0;\n              u.time = 0;\n            }\n          }\n\n          if (u && u.g) {\n            // Check if player's head is in water/lava for full overlay\n            // If only body is in liquid, use a much subtler effect or none\n            const liquidType = sNow.liquidType;\n            const headUnder = !!(sNow && sNow.headUnderWater);\n            const inLiquid = !!(sNow && sNow.inWater);\n            \n            const showOverlay = headUnder && (liquidType === 'water' || liquidType === 'lava' || liquidType === 'quicksand' || liquidType === 'radioactive_water');\n\n            // Determine overlay color based on liquid type\n            let overlayColor = 0x1d4875; // water (blue)\n            let maxTargetAlpha = 0.15;\n\n            if (liquidType && liquidType.includes('lava')) {\n              overlayColor = 0xa68c00; // lava (golden-yellow)\n              maxTargetAlpha = 0.25;\n            } else if (liquidType === 'quicksand') {\n              overlayColor = 0xa6915b; // quicksand (sand brown)\n              maxTargetAlpha = 0.20;\n            } else if (liquidType === 'radioactive_water') {\n              overlayColor = 0x1a5c1a; // toxic green\n              maxTargetAlpha = 0.18;\n            }\n\n            if (showOverlay) {\n              u.time += dt;\n              // Target alpha with pulse effect\n              const pulseBase = (maxTargetAlpha * 0.8) + (maxTargetAlpha * 0.2) * Math.sin(u.time * 0.0025);\n              u.targetAlpha = pulseBase;\n\n              // Smooth fade-in: gradually approach target alpha\n              const fadeSpeed = 0.01; // Faster fade-in for immediate visibility\n              const alphaDiff = u.targetAlpha - u.currentAlpha;\n              u.currentAlpha += alphaDiff * Math.min(1, dt * fadeSpeed);\n\n              // Update color if liquid type changed (only when needed to avoid constant redraw)\n              if (!u.g.visible || u.lastLiquidType !== liquidType) {\n                u.g.clear();\n                u.g.rect(0, 0, mapWidth * tileSize, mapHeight * tileSize);\n                u.g.fill({ color: overlayColor, alpha: 1 });\n                u.lastLiquidType = liquidType;\n              }\n\n              u.g.visible = true;\n              u.g.alpha = u.currentAlpha;\n            } else {\n              // Smooth fade-out\n              u.targetAlpha = 0;\n              const fadeOutSpeed = 0.008; // Faster fade-out\n              const alphaDiff = u.targetAlpha - u.currentAlpha;\n              u.currentAlpha += alphaDiff * Math.min(1, dt * fadeOutSpeed);\n              u.g.alpha = u.currentAlpha;\n\n              if (u.currentAlpha < 0.01) {\n                u.currentAlpha = 0;\n                u.g.alpha = 0;\n                u.g.visible = false;\n                u.time = 0; // Reset time for next submersion\n              }\n            }\n          }\n\n          // Water splash detection\n          try {\n            const prev = waterStateRef.current || { inWater: false, headUnder: false, vy: 0 };\n            const nowInWater = !!sNow.inWater;\n            const nowLiquid = sNow.liquidType;\n            const centerX = (sNow.x || 0) + (sNow.width || tileSize) * 0.5;\n\n            if (splashesEnabledRef.current && nowLiquid === 'water' && nowInWater && !prev.inWater) {\n              const sy = liquidSystemRef.current?.getSurfaceY?.('water', centerX);\n              const vy = Number(sNow.vy) || 0;\n              const strength = Math.min(3, Math.max(0.2, Math.abs(vy) * 0.12));\n              waterFxRef.current?.trigger({ x: centerX, y: (Number.isFinite(sy) ? sy : (sNow.y || 0)), strength, upward: false });\n              try { liquidSystemRef.current?.addWave?.('water', centerX, Math.min(2.5, 0.6 + Math.abs(vy) * 0.08)); } catch {}\n            }\n            if (splashesEnabledRef.current && prev.inWater && !nowInWater) {\n              const sy = liquidSystemRef.current?.getSurfaceY?.('water', centerX);\n              const vy = Number(sNow.vy) || 0;\n              const strength = Math.min(3, Math.max(0.2, Math.abs(vy) * 0.08));\n              waterFxRef.current?.trigger({ x: centerX, y: (Number.isFinite(sy) ? sy : (sNow.y || 0)), strength, upward: true });\n              try { liquidSystemRef.current?.addWave?.('water', centerX, Math.min(2.0, 0.4 + Math.abs(vy) * 0.05)); } catch {}\n            }\n            waterStateRef.current = { inWater: nowInWater, headUnder: !!sNow.headUnderWater, vy: Number(sNow.vy) || 0 };\n          } catch {}\n        } catch {}\n\n        // Overlay bars\n        try {\n          const s2 = playerStateRef.current || {};\n          const effW = (s2.width || tileSize);\n          const effH = (s2.height || tileSize);\n          const baseYOffset = Math.max(4, Math.floor(effH * 0.12));\n          const baseX = (s2.x || 0);\n          const baseY = (s2.y || 0) - baseYOffset;\n\n          const hbO = overlayHBRef.current;\n          if (hbO) {\n            const enabled = hbEnabledRef.current !== false;\n            const show = enabled && (!!s2.inWater || s2.liquidType === 'lava');\n            hbO.visible = !!show;\n            if (show) {\n              hbO.x = baseX;\n              hbO.y = baseY;\n              hbO.resize(effW, 4);\n              hbO.update(s2.health, (Number(s2.maxHealth) || 100));\n            }\n          }\n\n          let nextBarY = baseY;\n          if (hbO && hbO.visible) nextBarY += 6;\n\n          const oxyBar = oxygenBarRef.current;\n          if (oxyBar) {\n            const enabled = oxyEnabledRef.current !== false;\n            const maxOxy = Math.max(1, Number(s2.maxOxygen) || 100);\n            const curOxy = Math.max(0, Number(s2.oxygen));\n            const show = enabled && ((s2.liquidType === 'water' || s2.inWater) || (curOxy < maxOxy));\n            oxyBar.visible = !!show;\n            if (show) {\n              oxyBar.x = baseX;\n              oxyBar.y = nextBarY;\n              oxyBar.resize(effW, 4);\n              oxyBar.update((Number.isFinite(curOxy) ? curOxy : maxOxy), maxOxy);\n              nextBarY += 6;\n            }\n          }\n\n          const lvBar = lavaBarRef.current;\n          if (lvBar) {\n            const enabled = lavaEnabledRef.current !== false;\n            const maxLv = Math.max(1, Number(s2.maxLavaResist) || 100);\n            const curLv = Math.max(0, Number(s2.lavaResist));\n            const show = enabled && (s2.liquidType === 'lava' || (curLv < maxLv));\n            lvBar.visible = !!show;\n            if (show) {\n              lvBar.x = baseX;\n              lvBar.y = nextBarY;\n              lvBar.resize(effW, 4);\n              lvBar.update((Number.isFinite(curLv) ? curLv : maxLv), maxLv);\n            }\n          }\n        } catch {}\n\n        // Projectiles\n        syncProjectiles(projectilesLayerRef.current, projectileSpritesRef.current, projectilesPropRef.current, registryItems, tileSize);\n\n        // Entities\n        const sNow = playerStateRef.current || {};\n        syncEntities(entitiesLayerRef.current, entitySpritesRef.current, sNow.entities, registryItems, tileSize);\n      });\n    } catch (error) {\n      console.error('PixiStage init failed:', error);\n    }\n  };\n\n  init();\n\n  return () => {\n    destroyed = true;\n    if (appRef.current) {\n      const appToDestroy = appRef.current;\n      appRef.current = null;\n      appToDestroy.destroy(true, { children: true, texture: true });\n    }\n    try { liquidSystemRef.current?.destroy(); } catch {}\n    try { waterFxRef.current?.destroy(); } catch {}\n    try { lavaEmbersRef.current?.destroy(); } catch {}\n    try { lavaSteamRef.current?.destroy(); } catch {}\n    try { parallaxManagerRef.current?.destroy(); } catch {}\n    parallaxManagerRef.current = null;\n    try { pixiTextureCacheRef.current?.clear?.(); } catch {}\n    try {\n      weatherSystemsRef.current.rain?.destroy();\n      weatherSystemsRef.current.snow?.destroy();\n      weatherSystemsRef.current.fog?.destroy();\n    } catch {}\n    cleanupProjectiles(projectileSpritesRef.current);\n    cleanupEntities(entitySpritesRef.current);\n    clearTextureCache();\n  };\n  }, []);\n\n  // Rebuild layers when map data changes\n  useEffect(() => {\n    const app = appRef.current;\n    if (!app) return;\n\n    let active = true;\n\n    const runRebuild = async () => {\n        // Collect all textures to preload\n        const urlSet = new Set();\n        const addUrl = (u) => { if (typeof u === 'string' && u.length) urlSet.add(u); };\n        registryItems.forEach((def) => {\n            addUrl(def?.texture);\n            if (Array.isArray(def?.textures)) def.textures.forEach(addUrl);\n        });\n        if (playerVisuals) {\n            addUrl(playerVisuals.texture);\n            if (Array.isArray(playerVisuals.textures)) playerVisuals.textures.forEach(addUrl);\n        }\n\n        const urls = Array.from(urlSet);\n        if (urls.length) {\n            await Assets.load(urls);\n        }\n\n        if (!active || !appRef.current) return;\n\n        if (bgRef.current && objBehindRef.current && objFrontRef.current) {\n            rebuildLayers(\n                { bgRef: bgRef.current, objBehindRef: objBehindRef.current, objFrontRef: objFrontRef.current, secretLayerRef: secretLayerRef.current },\n                { mapWidth, mapHeight, tileSize, tileMapData, objectMapData, secretMapData, revealedSecrets, registryItems, objectMetadata, isEditor, isEditorPlayMode }\n            );\n\n            // Rebuild player visuals if visuals changed or player not created yet\n            const pLayer = playerLayerRef.current;\n            if (pLayer) {\n                if (playerRef.current) {\n                    pLayer.removeChild(playerRef.current);\n                    try { playerRef.current.destroy({ children: true }); } catch {}\n                }\n                \n                const playerComponents = createPlayerContainer(playerVisuals, registryItems, playerStateRef.current, tileSize);\n                pLayer.addChild(playerComponents.container);\n                playerRef.current = playerComponents.container;\n                playerSpriteRefs.current = playerComponents.sprites;\n                playerHealthBarRef.current = playerComponents.healthBar;\n            }\n\n            // Rebuild liquid regions only if tileMapData changed (not just revealedSecrets)\n            // This prevents liquid \"jumping\" when revealing secrets\n            const tileDataString = JSON.stringify(tileMapData);\n            const prevTileDataString = liquidSystemRef.current?._lastTileData;\n            if (tileDataString !== prevTileDataString) {\n                try {\n                    if (liquidSystemRef.current) liquidSystemRef.current.destroy();\n                    if (liquidLayerRef.current) {\n                        liquidSystemRef.current = new LiquidRegionSystem(liquidLayerRef.current, { \n                            mapWidth, \n                            mapHeight, \n                            tileSize,\n                            bgContainer: liquidBgLayerRef.current\n                        });\n                        liquidSystemRef.current.build({ mapWidth, mapHeight, tileSize, tileMapData, registryItems });\n                        liquidSystemRef.current._lastTileData = tileDataString; // Track what we built\n                    }\n                } catch (e) { console.warn('LiquidRegionSystem rebuild failed:', e); }\n                try { lavaEmbersRef.current?.rebuildSurfaces({ mapWidth, mapHeight, tileSize, tileMapData, registryItems }); } catch {}\n            }\n\n            // Upload to GPU to avoid lazy initialization warnings\n            if (app.renderer && app.renderer.prepare) {\n                try {\n                    await app.renderer.prepare.upload(app.stage);\n                } catch (e) {\n                    // Prepare might fail in some edge cases or context loss\n                }\n            }\n        }\n    };\n\n    runRebuild();\n\n    return () => { active = false; };\n  }, [tileMapData, objectMapData, registryItems, mapWidth, mapHeight, tileSize, secretMapData, revealedSecrets, objectMetadata, playerVisuals, isPixiReady]);\n\n  // Weather systems lifecycle\n  useEffect(() => {\n    const app = appRef.current;\n    const weatherLayer = weatherLayerRef.current;\n    const fogLayer = fogLayerRef.current;\n    if (!app || !weatherLayer || !fogLayer || !isPixiReady) return;\n\n    const api = {\n      isSolidAt,\n      mapWidth,\n      mapHeight,\n      tileSize,\n      getLiquidSurfaceY: (type, x) => {\n        try { return liquidSystemRef.current?.getSurfaceY?.(type, x); } catch { return null; }\n      },\n      onWaterImpact: ({ x, strength = 0.8 }) => {\n        try {\n          const sy = liquidSystemRef.current?.getSurfaceY?.('water', x);\n          if (Number.isFinite(sy)) waterFxRef.current?.trigger({ x, y: sy, strength: Math.max(0.2, Math.min(2, strength)), upward: false });\n          try { liquidSystemRef.current?.addWave?.('water', x, Math.max(0.2, Math.min(2.2, strength))); } catch {}\n        } catch {}\n      },\n      onLavaImpact: ({ x, y, strength = 0.6 }) => {\n        try {\n          const sy = liquidSystemRef.current?.getSurfaceY?.('lava', x);\n          const yy = Number.isFinite(y) ? y : (Number.isFinite(sy) ? sy : null);\n          if (yy != null) lavaSteamRef.current?.trigger({ x, y: yy, strength });\n        } catch {}\n      },\n      onMeteorHit: (data) => {\n        if (typeof onWeatherEffectHit === 'function') {\n          onWeatherEffectHit('meteor', data);\n        }\n      },\n      getViewport: () => ({\n        x: cameraPosRef.current.x,\n        y: cameraPosRef.current.y,\n        width: app.screen?.width || 800,\n        height: app.screen?.height || 600\n      })\n    };\n\n    const getRainIntensity = () => Math.max(0, Math.min(100, Number(weatherPropsRef.current.rain) || 0));\n    const getSnowIntensity = () => Math.max(0, Math.min(100, Number(weatherPropsRef.current.snow) || 0));\n    const getCloudsIntensity = () => Math.max(0, Math.min(100, Number(weatherPropsRef.current.clouds) || 0));\n    const getThunderIntensity = () => Math.max(0, Math.min(100, Number(weatherPropsRef.current.thunder) || 0));\n    const getFogIntensity = () => Math.max(0, Math.min(100, Number(weatherPropsRef.current.fog) || 0));\n    const getLavaRainIntensity = () => Math.max(0, Math.min(100, Number(weatherPropsRef.current.lavaRain) || 0));\n    const getRadioactiveFogIntensity = () => Math.max(0, Math.min(100, Number(weatherPropsRef.current.radioactiveFog) || 0));\n    const getMeteorRainIntensity = () => Math.max(0, Math.min(100, Number(weatherPropsRef.current.meteorRain) || 0));\n\n    // Initialize systems if they don't exist\n    if (!weatherSystemsRef.current.rain) {\n      weatherSystemsRef.current.rain = new WeatherRain(weatherLayer, api, getRainIntensity);\n    }\n    if (!weatherSystemsRef.current.lavaRain) {\n      weatherSystemsRef.current.lavaRain = new WeatherLavaRain(weatherLayer, api, getLavaRainIntensity);\n    }\n    if (!weatherSystemsRef.current.snow) {\n      weatherSystemsRef.current.snow = new WeatherSnow(weatherLayer, api, getSnowIntensity);\n    }\n    if (!weatherSystemsRef.current.meteorRain) {\n      weatherSystemsRef.current.meteorRain = new WeatherMeteorRain(weatherLayer, api, getMeteorRainIntensity);\n    }\n    if (!weatherSystemsRef.current.clouds) {\n      weatherSystemsRef.current.clouds = new WeatherClouds(fogLayer, api, getCloudsIntensity);\n    }\n    if (!weatherSystemsRef.current.fog) {\n      weatherSystemsRef.current.fog = new WeatherFog(fogLayer, api, getFogIntensity);\n    }\n    if (!weatherSystemsRef.current.radioactiveFog) {\n      weatherSystemsRef.current.radioactiveFog = new WeatherRadioactiveFog(fogLayer, api, getRadioactiveFogIntensity);\n    }\n    if (!weatherSystemsRef.current.thunder) {\n      weatherSystemsRef.current.thunder = new WeatherThunder(fogLayer, api, getThunderIntensity);\n    }\n\n    // Return cleanup to destroy all when stage unmounts or map changes\n    return () => {\n      try { weatherSystemsRef.current.rain?.destroy(); } catch {}\n      try { weatherSystemsRef.current.lavaRain?.destroy(); } catch {}\n      try { weatherSystemsRef.current.snow?.destroy(); } catch {}\n      try { weatherSystemsRef.current.meteorRain?.destroy(); } catch {}\n      try { weatherSystemsRef.current.clouds?.destroy(); } catch {}\n      try { weatherSystemsRef.current.fog?.destroy(); } catch {}\n      try { weatherSystemsRef.current.radioactiveFog?.destroy(); } catch {}\n      try { weatherSystemsRef.current.thunder?.destroy(); } catch {}\n      weatherSystemsRef.current = { rain: null, lavaRain: null, snow: null, meteorRain: null, clouds: null, thunder: null, fog: null, radioactiveFog: null };\n    };\n  }, [mapWidth, mapHeight, tileSize, isSolidAt, isPixiReady]);\n\n  // Rebuild parallax when props change\n  useEffect(() => {\n    rebuildParallax();\n  }, [backgroundImage, backgroundColor, rebuildParallax]);\n\n  return <div ref={mountRef} style={{ width: '100%', height: '100%', pointerEvents }} />;\n};\n\nPixiStage.propTypes = {\n  mapWidth: PropTypes.number.isRequired,\n  mapHeight: PropTypes.number.isRequired,\n  tileSize: PropTypes.number,\n  tileMapData: PropTypes.array,\n  objectMapData: PropTypes.array,\n  secretMapData: PropTypes.array,\n  revealedSecrets: PropTypes.array,\n  registryItems: PropTypes.array,\n  playerState: PropTypes.object,\n  playerVisuals: PropTypes.object,\n  backgroundImage: PropTypes.string,\n  backgroundColor: PropTypes.string,\n  backgroundParallaxFactor: PropTypes.number,\n  cameraScrollX: PropTypes.number,\n  weatherRain: PropTypes.number,\n  weatherSnow: PropTypes.number,\n  weatherClouds: PropTypes.number,\n  projectiles: PropTypes.array,\n  healthBarEnabled: PropTypes.bool,\n  objectMetadata: PropTypes.object,\n  weatherFog: PropTypes.number,\n  weatherThunder: PropTypes.number,\n  weatherLavaRain: PropTypes.number,\n  weatherRadioactiveFog: PropTypes.number,\n  weatherMeteorRain: PropTypes.number,\n  oxygenBarEnabled: PropTypes.bool,\n  lavaBarEnabled: PropTypes.bool,\n  waterSplashesEnabled: PropTypes.bool,\n  lavaEmbersEnabled: PropTypes.bool,\n  renderLayers: PropTypes.arrayOf(PropTypes.string),\n  pointerEvents: PropTypes.string,\n  onWeatherEffectHit: PropTypes.func,\n};\n\nexport default PixiStage;\n","import { Sprite, AnimatedSprite, Texture } from 'pixi.js';\nimport { getTexture, msToSpeed, getRegItem } from './helpers';\n\n// Sync and update projectiles: create missing sprites, remove stale ones, update positions\nexport const syncProjectiles = (projectilesLayer, projectileSpritesMap, projectilesList, registryItems, tileSize) => {\n  if (!projectilesLayer) return;\n\n  const map = projectileSpritesMap;\n  const list = projectilesList || [];\n  const seen = new Set();\n\n  // Create or update sprites for current projectiles\n  for (let i = 0; i < list.length; i++) {\n    const p = list[i];\n    const key = p.id;\n    seen.add(key);\n\n    let spr = map.get(key);\n    if (!spr) {\n      // Create new sprite\n      const def = getRegItem(registryItems, p.defId);\n      if (def && Array.isArray(def.textures) && def.textures.length > 1) {\n        const frames = def.textures.map((u) => getTexture(u)).filter(Boolean);\n        if (frames.length > 0) {\n          spr = new AnimatedSprite(frames);\n          spr.animationSpeed = msToSpeed(def.animationSpeed);\n          spr.play();\n        }\n      }\n      if (!spr) {\n        const tex = getTexture(getRegItem(registryItems, p.defId)?.texture) || Texture.WHITE;\n        spr = new Sprite(tex);\n      }\n      spr.anchor.set(0.5, 0.5);\n      spr.width = Math.max(2, p.w || tileSize * 0.25);\n      spr.height = Math.max(2, p.h || tileSize * 0.25);\n      projectilesLayer.addChild(spr);\n      map.set(key, spr);\n    }\n\n    // Update position and direction\n    spr.x = p.x + (p.dir >= 0 ? 0 : 0);\n    spr.y = p.y;\n    const mag = Math.abs(spr.scale.x || 1);\n    spr.scale.x = p.dir >= 0 ? mag : -mag;\n  }\n\n  // Remove sprites that no longer exist\n  for (const [key, spr] of map.entries()) {\n    if (!seen.has(key)) {\n      try {\n        spr.parent && spr.parent.removeChild(spr);\n      } catch (e) {\n        // ignore\n      }\n      try {\n        spr.destroy && spr.destroy();\n      } catch (e) {\n        // ignore\n      }\n      map.delete(key);\n    }\n  }\n};\n\n// Cleanup all projectile sprites\nexport const cleanupProjectiles = (projectileSpritesMap) => {\n  try {\n    for (const spr of projectileSpritesMap.values()) {\n      try {\n        spr.parent && spr.parent.removeChild(spr);\n      } catch (e) {\n        // ignore\n      }\n      try {\n        spr.destroy && spr.destroy();\n      } catch (e) {\n        // ignore\n      }\n    }\n    projectileSpritesMap.clear();\n  } catch (e) {\n    // ignore\n  }\n};\n","import { Sprite, Texture, Rectangle } from 'pixi.js';\nimport { getTexture } from './helpers';\n\n/**\n * Sinhroniz un atjaunina kustgo enttiju (piem. tanku) spraitus.\n * @param {Container} entitiesLayer PixiJS konteiners enttijm\n * @param {Map} entitySpritesMap Map, kur glabjas esoie spraiti (pc ID)\n * @param {Array} entitiesList Enttiju saraksts no dzinja\n * @param {Array} registryItems Reistra elementi\n * @param {number} tileSize Flzes izmrs pikseos\n */\nexport const syncEntities = (entitiesLayer, entitySpritesMap, entitiesList, registryItems, tileSize) => {\n  if (!entitiesLayer) return;\n\n  const seen = new Set();\n  const list = entitiesList || [];\n\n  for (const ent of list) {\n    const key = ent.id;\n    seen.add(key);\n\n    let spr = entitySpritesMap.get(key);\n    const def = ent.def || {};\n\n    if (!spr) {\n      // Izveidojam jaunu spraitu ar baltu tekstru k aizvietotju, kamr ldjas st\n      spr = new Sprite(Texture.WHITE);\n      spr.anchor.set(0, 0);\n      entitiesLayer.addChild(spr);\n      entitySpritesMap.set(key, spr);\n      spr._lastFrameIndex = -1;\n    }\n\n    // Atjaunojam tekstru no spritesheet, ja nepiecieams\n    const baseTexture = getTexture(def.texture);\n    const source = baseTexture?.source;\n    const isTextureReady = source && source.width > 1;\n\n    if (def.spriteSheet && def.spriteSheet.enabled && isTextureReady) {\n      const columns = def.spriteSheet.columns || 1;\n      const frameIndex = ent.currentSpriteIndex !== undefined ? ent.currentSpriteIndex : 0;\n      \n      if (spr._lastFrameIndex !== frameIndex) {\n        const texWidth = source.width;\n        const texHeight = source.height;\n        const totalSprites = def.spriteSheet.totalSprites || 1;\n\n        // Ja kolonnu skaits JSON ir nepareizs vai trkst, minm to aprint\n        let effectiveColumns = columns;\n        if (!effectiveColumns || effectiveColumns <= 0) {\n            effectiveColumns = Math.floor(texWidth / (def.spriteSheet.frameWidth || 32)) || 1;\n        }\n\n        const frameWidth = texWidth / effectiveColumns;\n        const frameHeight = texHeight / Math.ceil(totalSprites / effectiveColumns);\n        \n        const col = frameIndex % effectiveColumns;\n        const row = Math.floor(frameIndex / effectiveColumns);\n        \n        const rect = new Rectangle(col * frameWidth, row * frameHeight, frameWidth, frameHeight);\n        \n        try {\n            spr.texture = new Texture({\n              source: source,\n              frame: rect\n            });\n            spr._lastFrameIndex = frameIndex;\n        } catch (e) {\n            console.warn(`Failed to create texture for entity ${key} frame ${frameIndex}`, e);\n            spr.texture = baseTexture;\n        }\n      }\n    } else if (isTextureReady) {\n      if (spr.texture !== baseTexture) {\n        spr.texture = baseTexture;\n        spr._lastFrameIndex = -1;\n      }\n    } else if (def.editorIcon) {\n        // Ja nav tekstras, bet ir ikona (piemram, bultia, kaut gan ts te nevajadztu bt k enttijai)\n        if (spr.texture !== Texture.WHITE) spr.texture = Texture.WHITE;\n    }\n\n    // Pozcija un izmrs\n    const targetWidth = ent.width || tileSize;\n    const targetHeight = ent.height || tileSize;\n    \n    spr.width = targetWidth;\n    spr.height = targetHeight;\n    \n    // Nodroinm, ka scale nav 0 vai NaN (ja tekstra bija dvaina skum)\n    if (!spr.scale.x || isNaN(spr.scale.x)) spr.scale.x = 1;\n    if (!spr.scale.y || isNaN(spr.scale.y)) spr.scale.y = 1;\n\n    // Virziens (flipping)\n    const direction = ent.direction !== undefined ? ent.direction : 1;\n    \n    // Ja ir definta rotcija (piem. akmeiem), izmantojam centru k enkuru\n    if (ent.rotation !== undefined) {\n        spr.anchor.set(0.5, 0.5);\n        spr.x = ent.x + targetWidth / 2;\n        spr.y = ent.y + targetHeight / 2;\n        spr.rotation = ent.rotation;\n        \n        // Flipping ar centru enkuru\n        const absScaleX = Math.abs(spr.scale.x);\n        spr.scale.x = direction >= 0 ? absScaleX : -absScaleX;\n    } else {\n        // Standarta enkurs (augjais kreisais stris)\n        spr.anchor.set(0, 0);\n        spr.rotation = 0;\n        \n        const absScaleX = Math.abs(spr.scale.x);\n        spr.scale.x = direction >= 0 ? absScaleX : -absScaleX;\n        \n        // Pozicionana emot vr flipping pie enkura (0,0)\n        spr.x = ent.x + (direction < 0 ? targetWidth : 0);\n        spr.y = ent.y;\n    }\n  }\n\n  // Noemam spraitus enttijm, kas vairs neeksist\n  for (const [key, spr] of entitySpritesMap.entries()) {\n    if (!seen.has(key)) {\n      if (spr.parent) spr.parent.removeChild(spr);\n      spr.destroy({ children: true, texture: false }); // Tekstras koplietoanas d ts neizncinm\n      entitySpritesMap.delete(key);\n    }\n  }\n};\n\n/**\n * Attra visus enttiju spraitus.\n */\nexport const cleanupEntities = (entitySpritesMap) => {\n  for (const spr of entitySpritesMap.values()) {\n    if (spr.parent) spr.parent.removeChild(spr);\n    spr.destroy({ children: true, texture: false });\n  }\n  entitySpritesMap.clear();\n};\n","import { Sprite, AnimatedSprite, Texture, Rectangle, Container, Graphics } from 'pixi.js';\nimport { getTexture, msToSpeed, getRegItem } from './helpers';\nimport { buildSpriteFromDef } from './playerManager';\nimport { isWaterDef, isLavaDef, isQuicksandDef, isWaterfallDef, isLavaWaterfallDef, isRadioactiveWaterDef, isRadioactiveWaterfallDef, createWaterFrames, createLavaFrames, createQuicksandFrames } from './liquidRendering';\nimport HealthBar from '../../../../Pixi/ui/HealthBar';\n\n// Build layers: tiles, objects, and secret overlays\nexport const rebuildLayers = (refs, options) => {\n  const {\n    mapWidth,\n    mapHeight,\n    tileSize,\n    tileMapData,\n    objectMapData,\n    secretMapData,\n    revealedSecrets,\n    registryItems,\n    objectMetadata,\n    isEditor,\n    isEditorPlayMode\n  } = options;\n\n  const { bgRef, objBehindRef, objFrontRef, secretLayerRef } = refs;\n\n  if (!bgRef || !objBehindRef || !objFrontRef) return;\n\n  // Clear previous and destroy old children to prevent memory leaks/ticker buildup\n  const safeDestroy = (container) => {\n    if (!container) return;\n    const children = container.removeChildren();\n    children.forEach(child => {\n      try {\n        // Destroy child but KEEP textures in cache\n        child.destroy({ children: true, texture: false });\n      } catch (e) {}\n    });\n  };\n\n  safeDestroy(bgRef);\n  safeDestroy(objBehindRef);\n  safeDestroy(objFrontRef);\n  safeDestroy(secretLayerRef?.below);\n  safeDestroy(secretLayerRef?.above);\n\n  // Track which tiles need secret overlay\n  // We need overlay for: 1) unrevealed above/secret zones, 2) all open/below zones\n  const secretOverlayTilesBelow = new Map(); // tile index -> filterColor\n  const secretOverlayTilesAbove = new Map(); // tile index -> filterColor\n\n  // Helper: resolve registry item by id\n  const getDef = (id) => getRegItem(registryItems, id);\n\n  // Background tiles (skip liquids; they are handled by LiquidRegionSystem)\n  let secretLayerCount = 0;\n  let normalLayerCount = 0;\n\n  for (let i = 0; i < mapWidth * mapHeight; i++) {\n    const id = tileMapData[i];\n    if (!id) continue;\n    const def = getDef(id);\n    if (!def) continue;\n\n    // Check if this tile is in a secret zone\n    const secretId = secretMapData?.[i];\n    const secretDef = secretId ? getDef(secretId) : null;\n    const secretSubtype = secretDef?.subtype;\n    const isInOpenArea = secretSubtype === 'open' || secretSubtype === 'below';\n    const isInSecretArea = secretSubtype === 'secret' || secretSubtype === 'above';\n    const isSecretRevealed = revealedSecrets && revealedSecrets.includes(i);\n\n    // Track which tiles need overlay rendering\n    // above/secret: overlay AFTER reveal (to darken objects after revealing secret)\n    // open/below: no overlay needed (tiles already darkened)\n    if (isInSecretArea && isSecretRevealed) {\n      const filterColor = secretDef?.filterColorInGame || secretDef?.filterColor || 'rgba(0, 0, 0, 0.6)';\n      const renderAbove = secretDef?.renderAbovePlayer;\n      if (renderAbove) {\n        secretOverlayTilesAbove.set(i, filterColor);\n      } else {\n        secretOverlayTilesBelow.set(i, filterColor);\n      }\n    }\n\n    // Determine if this tile should be rendered with filter on secret layer\n    let renderOnSecretLayer = false;\n    if (isInOpenArea) {\n      // open.area: always render on secret layer with filter\n      renderOnSecretLayer = true;\n      secretLayerCount++;\n    } else if (isInSecretArea && isSecretRevealed) {\n      // secret.area: only render on secret layer with filter AFTER revealed\n      renderOnSecretLayer = true;\n      secretLayerCount++;\n    } else {\n      normalLayerCount++;\n    }\n\n    let sprite;\n    let frames = null;\n    if (isWaterDef(def) || isLavaDef(def) || isWaterfallDef(def) || isLavaWaterfallDef(def) || isRadioactiveWaterDef(def) || isRadioactiveWaterfallDef(def) || def.type === 'entity' || def.subtype === 'platform') {\n      // liquids are handled by LiquidRegionSystem; skip per-tile sprite\n      // entities and platforms are handled by separate managers\n      continue;\n    } else {\n      if (Array.isArray(def.textures) && def.textures.length > 1) {\n        frames = def.textures.map((u) => getTexture(u)).filter(Boolean);\n      }\n      if (frames && frames.length > 0) {\n        sprite = new AnimatedSprite(frames);\n        sprite.animationSpeed = msToSpeed(def.animationSpeed);\n        sprite.play();\n      } else {\n        const tex = getTexture(def.texture) || null;\n        if (!tex) continue;\n        sprite = new Sprite(tex);\n      }\n    }\n\n    const x = (i % mapWidth) * tileSize;\n    const y = Math.floor(i / mapWidth) * tileSize;\n    sprite.x = x;\n    sprite.y = y;\n    sprite.width = tileSize;\n    sprite.height = tileSize;\n\n    // Apply filter if rendering on secret layer\n    if (renderOnSecretLayer) {\n      // Add a full-opaque copy of the tile as a backing to prevent background parallax from shining through\n      // As requested: \"if dirt.block, then dirt.block behind last layer\"\n      let backingSprite;\n      if (frames && frames.length > 0) {\n        backingSprite = new AnimatedSprite(frames);\n        backingSprite.animationSpeed = sprite.animationSpeed;\n        backingSprite.play();\n      } else if (sprite.texture) {\n        backingSprite = new Sprite(sprite.texture);\n      }\n\n      if (backingSprite) {\n        backingSprite.x = x;\n        backingSprite.y = y;\n        backingSprite.width = tileSize;\n        backingSprite.height = tileSize;\n        // Add to bgRef which is below secretLayerRef.below\n        bgRef.addChild(backingSprite);\n      }\n\n      // Add dark backing to block background image and darken the backing sprite\n      // Both open.area (always) and secret.area (when revealed) need backing\n      const backing = new Graphics();\n      backing.rect(x, y, tileSize, tileSize);\n      backing.fill({ color: 0x000000, alpha: 0.7 }); // Solid dark filter to block background completely\n      bgRef.addChild(backing);\n\n      sprite.alpha = 0.4; // darken the foreground tile\n      // Add to secret layer (below player always for tiles)\n      if (secretLayerRef?.below) {\n        secretLayerRef.below.addChild(sprite);\n      } else {\n        bgRef.addChild(sprite);\n      }\n    } else {\n      // Normal rendering on tiles layer\n      bgRef.addChild(sprite);\n    }\n  }\n\n  // Objects (non-player)\n  for (let i = 0; i < mapWidth * mapHeight; i++) {\n    const id = objectMapData[i];\n    if (!id || id.includes('player')) continue;\n    const def = getDef(id);\n    if (!def || def.type === 'entity' || def.subtype === 'platform' || def.subtype === 'pushable' || def.isPushable) continue;\n\n    const meta = (objectMetadata && objectMetadata[i]) || {};\n    const maxH = def.maxHealth || 100;\n    const health = meta.health !== undefined ? meta.health : maxH;\n\n    let visualElement;\n    if (def.spriteSheet && def.spriteSheet.enabled) {\n      const totalSprites = def.spriteSheet.totalSprites || 1;\n      const columns = def.spriteSheet.columns || totalSprites;\n      \n      const healthPercent = Math.max(0, Math.min(100, (health / maxH) * 100));\n      let frameIndex = Math.floor((1 - healthPercent / 100) * (totalSprites - 1));\n      frameIndex = Math.max(0, Math.min(totalSprites - 1, frameIndex));\n\n      const baseTexture = getTexture(def.texture);\n      const source = baseTexture?.source;\n      if (source && source.width > 1) {\n        const texWidth = source.width;\n        const texHeight = source.height;\n\n        const frameWidth = texWidth / columns;\n        const frameHeight = texHeight / Math.ceil(totalSprites / columns);\n        \n        const col = frameIndex % columns;\n        const row = Math.floor(frameIndex / columns);\n        \n        const rect = new Rectangle(col * frameWidth, row * frameHeight, frameWidth, frameHeight);\n        \n        const frameTexture = new Texture({\n            source: source,\n            frame: rect\n        });\n        visualElement = new Sprite(frameTexture);\n      } else {\n        visualElement = buildSpriteFromDef(def);\n      }\n    } else {\n      visualElement = buildSpriteFromDef(def);\n    }\n\n    if (!visualElement) continue;\n\n    const x = (i % mapWidth) * tileSize;\n    const y = Math.floor(i / mapWidth) * tileSize;\n    \n    // Ja tas ir teksts (piemram, bultia redaktor), centrjam to tile ietvaros\n    if (visualElement.anchor && visualElement.anchor.x === 0.5) {\n      visualElement.x = tileSize / 2;\n      visualElement.y = tileSize / 2;\n    } else {\n      visualElement.x = 0;\n      visualElement.y = 0;\n    }\n    \n    visualElement.width = tileSize;\n    visualElement.height = tileSize;\n\n    // Create a container if we need a health bar or just to keep it clean\n    const container = new Container();\n    container.x = x;\n    container.y = y;\n    \n    // Slpjam objektus, kuriem ir isHiddenInGame: true (piemram, bultias spl)\n    // Bet ja ms esam redaktor vai redaktora play mod, ms gribam ts redzt (laikapstku un ziojumu trigerus).\n    const isWeatherTrigger = def.type === 'weather_trigger';\n    const isMessageTrigger = def.type === 'message_trigger';\n    const isWolfSecret = def.type === 'wolf_secret';\n    const shouldShowAnyway = (isWeatherTrigger || isMessageTrigger || isWolfSecret) && (isEditor || isEditorPlayMode);\n    \n    if (def.isHiddenInGame && !isEditor && !shouldShowAnyway) {\n        container.visible = false;\n    }\n\n    // Check if object is in unrevealed secret zone - if so, hide it\n    const secretId = secretMapData?.[i];\n    const secretDef = secretId ? getDef(secretId) : null;\n    const secretSubtype = secretDef?.subtype;\n    const isInSecretArea = secretSubtype === 'secret' || secretSubtype === 'above';\n    const isSecretRevealed = revealedSecrets && revealedSecrets.includes(i);\n\n    if (isInSecretArea && !isSecretRevealed && !isEditor) {\n      // Object is in unrevealed secret zone - make it invisible\n      container.visible = false;\n    }\n\n    container.addChild(visualElement);\n\n    // Add health bar for destructible objects if damaged\n    if (def.isDestructible && health < maxH && health > 0) {\n      try {\n        const hb = new HealthBar({\n          width: tileSize,\n          height: 4,\n          offsetX: 0,\n          offsetY: -5\n        });\n        hb.update(health, maxH);\n        container.addChild(hb);\n      } catch (e) {}\n    }\n\n    const renderAbove = !!def.renderAbovePlayer;\n    if (renderAbove) {\n      objFrontRef.addChild(container);\n    } else {\n      objBehindRef.addChild(container);\n    }\n  }\n\n  // Create dark overlays for unrevealed secret zones\n  // Below player overlay (for secrets with renderAbovePlayer: false)\n  if (secretOverlayTilesBelow.size > 0 && secretLayerRef?.below) {\n    const overlay = new Graphics();\n    secretOverlayTilesBelow.forEach((filterColor, idx) => {\n      const x = (idx % mapWidth) * tileSize;\n      const y = Math.floor(idx / mapWidth) * tileSize;\n\n      const match = filterColor.match(/rgba?\\((\\d+),\\s*(\\d+),\\s*(\\d+)(?:,\\s*([\\d.]+))?\\)/);\n      if (match) {\n        const r = parseInt(match[1]);\n        const g = parseInt(match[2]);\n        const b = parseInt(match[3]);\n        const a = match[4] ? parseFloat(match[4]) : 1;\n\n        overlay.rect(x, y, tileSize, tileSize);\n        overlay.fill({ color: (r << 16) | (g << 8) | b, alpha: a });\n      }\n    });\n    secretLayerRef.below.addChild(overlay);\n  }\n\n  // Above player overlay (for secrets with renderAbovePlayer: true)\n  if (secretOverlayTilesAbove.size > 0 && secretLayerRef?.above) {\n    const overlay = new Graphics();\n    secretOverlayTilesAbove.forEach((filterColor, idx) => {\n      const x = (idx % mapWidth) * tileSize;\n      const y = Math.floor(idx / mapWidth) * tileSize;\n\n      const match = filterColor.match(/rgba?\\((\\d+),\\s*(\\d+),\\s*(\\d+)(?:,\\s*([\\d.]+))?\\)/);\n      if (match) {\n        const r = parseInt(match[1]);\n        const g = parseInt(match[2]);\n        const b = parseInt(match[3]);\n        const a = match[4] ? parseFloat(match[4]) : 1;\n\n        overlay.rect(x, y, tileSize, tileSize);\n        overlay.fill({ color: (r << 16) | (g << 8) | b, alpha: a });\n      }\n    });\n    secretLayerRef.above.addChild(overlay);\n  }\n};\n","/**\n * Secrets Detection and Reveal Logic\n * Handles AboveSecret zone detection and revealing when player enters\n */\n\n/**\n * Flood fill to find all connected secret tiles of the same type\n * @param {number} startIndex - Starting tile index\n * @param {Array} secretMapData - Secret layer data\n * @param {number} mapWidth - Map width in tiles\n * @param {number} mapHeight - Map height in tiles\n * @param {Array} registryItems - Registry items to lookup secret definitions\n * @returns {Array} - Array of connected tile indices\n */\nexport function floodFillSecretZone(startIndex, secretMapData, mapWidth, mapHeight, registryItems) {\n  const startSecretId = secretMapData[startIndex];\n  if (!startSecretId) return [];\n\n  const startDef = registryItems.find(r => r.id === startSecretId);\n  if (!startDef || startDef.type !== 'secret') return [];\n\n  const visited = new Set();\n  const result = [];\n  const queue = [startIndex];\n\n  while (queue.length > 0) {\n    const idx = queue.shift();\n    if (visited.has(idx)) continue;\n    if (idx < 0 || idx >= secretMapData.length) continue;\n\n    visited.add(idx);\n\n    const secretId = secretMapData[idx];\n    if (!secretId || secretId !== startSecretId) continue;\n\n    result.push(idx);\n\n    // Check 4 neighbors (up, down, left, right)\n    const x = idx % mapWidth;\n    const y = Math.floor(idx / mapWidth);\n\n    // Up\n    if (y > 0) queue.push((y - 1) * mapWidth + x);\n    // Down\n    if (y < mapHeight - 1) queue.push((y + 1) * mapWidth + x);\n    // Left\n    if (x > 0) queue.push(y * mapWidth + (x - 1));\n    // Right\n    if (x < mapWidth - 1) queue.push(y * mapWidth + (x + 1));\n  }\n\n  return result;\n}\n\n/**\n * Check if player is touching any AboveSecret tiles\n * @param {Object} params - Detection parameters\n * @returns {Array|null} - Array of tile indices to reveal, or null if no detection\n */\nexport function checkSecretDetection({\n  currentX,\n  currentY,\n  width,\n  height,\n  secretMapData,\n  revealedSecrets,\n  mapWidth,\n  mapHeight,\n  registryItems,\n  TILE_SIZE\n}) {\n  if (!secretMapData || secretMapData.length === 0) return null;\n\n  // Player AABB in world pixels\n  const playerLeft = currentX;\n  const playerRight = currentX + width;\n  const playerTop = currentY;\n  const playerBottom = currentY + height;\n\n  // Overlapped tile rectangle\n  const minGX = Math.floor(playerLeft / TILE_SIZE);\n  const maxGX = Math.floor((playerRight - 1) / TILE_SIZE);\n  const minGY = Math.floor(playerTop / TILE_SIZE);\n  const maxGY = Math.floor((playerBottom - 1) / TILE_SIZE);\n\n  // Check all overlapping tiles for AboveSecret\n  for (let gy = minGY; gy <= maxGY; gy++) {\n    for (let gx = minGX; gx <= maxGX; gx++) {\n      if (gx < 0 || gx >= mapWidth || gy < 0 || gy >= mapHeight) continue;\n\n      const idx = gy * mapWidth + gx;\n      const secretId = secretMapData[idx];\n      if (!secretId) continue;\n\n      // Already revealed?\n      if (revealedSecrets && revealedSecrets.includes(idx)) continue;\n\n      const def = registryItems.find(r => r.id === secretId);\n      if (!def || def.type !== 'secret') continue;\n\n      // Only secret.area (subtype: 'secret' or old name 'above') can be revealed\n      const isSecretArea = def.subtype === 'secret' || def.subtype === 'above';\n      if (!isSecretArea || !def.revealOnEnter) continue;\n\n      // Found an unrevealed secret.area that player is touching!\n      // Flood fill to find all connected tiles\n      const connectedIndices = floodFillSecretZone(idx, secretMapData, mapWidth, mapHeight, registryItems);\n\n      // Filter out already revealed indices to prevent infinite loop\n      const newIndices = connectedIndices.filter(i => !revealedSecrets || !revealedSecrets.includes(i));\n\n      console.log('[SECRETS] Revealing zone:', {\n        triggerIndex: idx,\n        triggerSecretId: secretId,\n        triggerSubtype: def.subtype,\n        totalConnected: connectedIndices.length,\n        newToReveal: newIndices.length,\n        firstFiveNew: newIndices.slice(0, 5),\n        connectedSecretIds: newIndices.slice(0, 5).map(i => secretMapData[i])\n      });\n\n      // Only return if there are NEW indices to reveal\n      return newIndices.length > 0 ? newIndices : null;\n    }\n  }\n\n  return null;\n}\n\nexport default { checkSecretDetection, floodFillSecretZone };\n","// Audio utilities extracted from useGameEngine.js\n\n// Usage: playSfx({ soundEnabledRef, audioCtxRef, audioCtxUnlockedRef }, url, volume)\nexport function playSfx(ctx, url, volume) {\n  const { soundEnabledRef, audioCtxRef } = ctx || {};\n  try {\n    if (!soundEnabledRef?.current) return;\n    const vol = Math.max(0, Math.min(1, volume ?? 1));\n    // 1) Try HTMLAudio first\n    if (url && typeof url === 'string' && url.length > 0) {\n      try {\n        const audio = new Audio(url);\n        audio.volume = vol;\n        audio.addEventListener?.('error', () => {\n          try { audio.pause(); } catch {}\n          beepFallback(ctx, vol);\n        }, { once: true });\n        const p = audio.play?.();\n        if (p && typeof p.catch === 'function') p.catch(() => beepFallback(ctx, vol));\n        return;\n      } catch {\n        // fallback below\n      }\n    }\n    // 2) Fallback beep via WebAudio\n    beepFallback(ctx, vol);\n  } catch {}\n}\n\nexport function beepFallback(ctx, vol) {\n  try {\n    const AC = window.AudioContext || window.webkitAudioContext;\n    if (!AC) return;\n    if (!ctx?.audioCtxRef) return;\n    if (!ctx.audioCtxRef.current) ctx.audioCtxRef.current = new AC();\n    const audioCtx = ctx.audioCtxRef.current;\n    if (!audioCtx) return;\n    if (audioCtx.state === 'suspended') audioCtx.resume?.();\n    const now = audioCtx.currentTime;\n    const osc = audioCtx.createOscillator();\n    const gain = audioCtx.createGain();\n    // short square click ~520Hz for ~90ms\n    osc.type = 'square';\n    osc.frequency.setValueAtTime(520, now);\n    gain.gain.setValueAtTime(0.0001, now);\n    gain.gain.exponentialRampToValueAtTime(Math.max(0.05, (vol ?? 0.2) * 0.2), now + 0.01);\n    gain.gain.exponentialRampToValueAtTime(0.0001, now + 0.08);\n    osc.connect(gain);\n    gain.connect(audioCtx.destination);\n    osc.start(now);\n    osc.stop(now + 0.09);\n  } catch {}\n}\n","// Horizontal movement extracted from useGameEngine.js\n\n// Calculates horizontal velocity/direction and resolves horizontal collision with snap.\n// Args:\n// - keys: input state (expects boolean a/d)\n// - state: { x, width, direction }\n// - MOVE_SPEED, TILE_SIZE, mapWidth, mapHeight\n// - checkCollision: function(newX, newY, mapWidth, mapHeight)  boolean\n// Returns: { x, vx, direction }\nexport function moveHorizontal({\n  keys,\n  state,\n  MOVE_SPEED,\n  TILE_SIZE,\n  mapWidth,\n  mapHeight,\n  checkCollision,\n  friction = 0.8,\n  acceleration = 0.2\n}) {\n  let { x, vx, width, direction, y, height } = state;\n  \n  const targetVx = keys?.a ? -MOVE_SPEED : (keys?.d ? MOVE_SPEED : 0);\n  \n  if (targetVx !== 0) {\n    // Accelerate\n    vx += targetVx * acceleration;\n    if (Math.abs(vx) > MOVE_SPEED) vx = Math.sign(vx) * MOVE_SPEED;\n    direction = Math.sign(targetVx);\n  } else {\n    // Apply friction\n    vx *= friction;\n    if (Math.abs(vx) < 0.1) vx = 0;\n  }\n\n  const proposedX = x + vx;\n  const py = y ?? 0;\n  if (checkCollision(proposedX, py, mapWidth, mapHeight, width, height)) {\n    // Precza apstans pie ra (tiles vai enttijas) bez rupja snapping pie TILE_SIZE\n    const step = 0.5;\n    const sign = Math.sign(vx);\n    let safeX = x;\n    \n    for (let d = step; d < Math.abs(vx); d += step) {\n      const nextX = x + d * sign;\n      if (!checkCollision(nextX, py, mapWidth, mapHeight, width, height)) {\n        safeX = nextX;\n      } else {\n        break;\n      }\n    }\n    x = safeX;\n    vx = 0;\n  } else {\n    x = proposedX;\n  }\n\n  return { x, vx, direction };\n}\n\nexport default null;\n","// Vertical physics (gravity, jump, vertical collisions)\n// Migrated from GameEngine/applyVerticalPhysics.js to make core the source of truth.\n\n// Args:\n// - keys, x, y, vy, isGrounded, animation\n// - GRAVITY, TERMINAL_VELOCITY, JUMP_FORCE, TILE_SIZE\n// - width, height, mapWidth, mapHeight\n// - checkCollision(newX, newY, mapWidth, mapHeight)\n// - isLiquidAt(wx, wy): optional helper to detect liquid type at a world pixel\n// - vx: horizontal velocity (for deciding run/idle when landing)\n// - prevInWater: whether player was in water on previous frame\n// Returns: { y, vy, isGrounded, animation, inWater, headUnderWater, atSurface }\nexport function applyVerticalPhysics({\n  keys,\n  x,\n  y,\n  vy,\n  isGrounded,\n  animation,\n  GRAVITY,\n  TERMINAL_VELOCITY,\n  JUMP_FORCE,\n  TILE_SIZE,\n  width,\n  height,\n  mapWidth,\n  mapHeight,\n  checkCollision,\n  vx,\n  isLiquidAt,\n  prevInWater\n}) {\n  // Liquid defaults\n  let liqBuoyancy = 0.5; // reduces effective gravity by 50%\n  let liqDragY = 0.88;  // vertical damping per frame when in liquid\n  let liqTerminal = Math.max(2, Math.floor(TERMINAL_VELOCITY * 0.4));\n  let swimImpulseMult = 0.55;\n\n  // Water detection using centerline points\n  let inWater = false;\n  let headUnderWater = false;\n  let atSurface = false;\n  let activeLiquidType = null;\n\n  if (typeof isLiquidAt === 'function') {\n    const cx = x + (width || TILE_SIZE) * 0.5;\n    const headY = y + Math.min(4, (height || TILE_SIZE) * 0.125);\n    const feetY = y + (height || TILE_SIZE) - 2;\n    const chestY = y + (height || TILE_SIZE) * 0.45;\n    \n    const feetLiq = isLiquidAt(cx, feetY);\n    const chestLiq = isLiquidAt(cx, chestY);\n    const headLiq = isLiquidAt(cx, headY);\n    \n    activeLiquidType = feetLiq || chestLiq;\n    inWater = !!activeLiquidType;\n    headUnderWater = !!headLiq;\n    atSurface = inWater && !headUnderWater;\n\n    // Apply per-liquid physics overrides\n    if (activeLiquidType === 'quicksand') {\n      liqBuoyancy = -0.15; // Negative buoyancy makes player sink!\n      liqDragY = 0.85;     // Higher drag\n      liqTerminal = 1.2;   // Very slow terminal velocity for sinking\n      swimImpulseMult = 0.35; // Harder to jump/swim\n    } else if (activeLiquidType === 'lava') {\n      liqBuoyancy = 0.3;\n      liqDragY = 0.82;\n    } else if (activeLiquidType === 'waterfall') {\n      liqBuoyancy = -0.5; // Acts like extra gravity\n      liqDragY = 0.95;     // Very low resistance\n      liqTerminal = TERMINAL_VELOCITY * 1.5; // Allow falling faster than usual terminal velocity\n    } else if (activeLiquidType === 'lava_waterfall') {\n      liqBuoyancy = -0.4; // Slightly more viscous than water\n      liqDragY = 0.92;\n      liqTerminal = TERMINAL_VELOCITY * 1.3;\n    } else if (activeLiquidType === 'radioactive_waterfall') {\n      liqBuoyancy = -0.2; // Slower fall than normal waterfall\n      liqDragY = 0.94;\n      liqTerminal = TERMINAL_VELOCITY * 0.7; // Slower speed\n    } else if (activeLiquidType === 'radioactive_water') {\n      liqBuoyancy = 0.45; // Slightly less buoyant than water\n      liqDragY = 0.86;\n    }\n  }\n\n  // Jump\n  if (keys?.space || keys?.w) {\n    if (inWater) {\n      // Swim stroke (allow even when not grounded)\n      const swimImpulse = Math.max(2, Math.floor(JUMP_FORCE * swimImpulseMult));\n      vy = Math.min(vy, 0); // prevent extra downward boost\n      vy -= swimImpulse * 0.5; // smaller continuous impulse\n      animation = 'jump';\n    } else if (isGrounded) {\n      vy = -JUMP_FORCE;\n      isGrounded = false;\n      animation = 'jump';\n    }\n  }\n\n  // Gravity (reduced in liquid) + vertical drag\n  if (inWater) {\n    // Entrance damping to remove harsh fall shock\n    if (!prevInWater) {\n      vy *= 0.4;\n    }\n    vy += GRAVITY * (1 - liqBuoyancy);\n    vy *= liqDragY;\n    if (vy > liqTerminal) vy = liqTerminal;\n  } else {\n    vy += GRAVITY;\n    if (vy > TERMINAL_VELOCITY) vy = TERMINAL_VELOCITY;\n  }\n\n  // Check vertical collision at proposed Y\n  if (checkCollision(x, y + vy, mapWidth, mapHeight, width, height)) {\n    if (vy > 0) {\n      // Landing on ground\n      isGrounded = true;\n      y = Math.floor((y + vy + height) / TILE_SIZE) * TILE_SIZE - height;\n      if (Math.abs(vx || 0) > 0) {\n        animation = 'run';\n      } else {\n        animation = 'idle';\n      }\n    } else if (vy < 0) {\n      // Hitting ceiling\n      y = Math.ceil((y + vy) / TILE_SIZE) * TILE_SIZE;\n    }\n    vy = 0;\n  } else {\n    // Free fall\n    isGrounded = false;\n    y += vy;\n    if (vy > 0) {\n      animation = 'fall';\n    }\n  }\n\n  return { y, vy, isGrounded, animation, inWater, headUnderWater, atSurface };\n}\n\nexport default null;\n","// Generic liquid helpers (water, lava, etc.)\n// Liquids are defined as blocks with flags.liquid === true and optional flags.water/flags.lava\n// Optional physics params live under def.liquid: { buoyancy, drag:{x,y}, surface, swimmable, damagePerSecond }\n\n/**\n * Sample registry tile definition at world pixel and return liquid info if present.\n * @param {number} wx world x in pixels\n * @param {number} wy world y in pixels\n * @param {number} mapWidthTiles\n * @param {number} mapHeightTiles\n * @param {number} TILE_SIZE\n * @param {Array<string|null>} tileData tile ids array (background layer)\n * @param {Array<object>} registryItems game registry array\n * @returns {null|{def:object, type:'water'|'lava'|'liquid', params:object}}\n */\nexport function getLiquidAtPixel(wx, wy, mapWidthTiles, mapHeightTiles, TILE_SIZE, tileData, registryItems) {\n  if (wy < 0) return null;\n  const gx = Math.floor(wx / TILE_SIZE);\n  const gy = Math.floor(wy / TILE_SIZE);\n  if (gx < 0 || gy < 0 || gx >= mapWidthTiles || gy >= mapHeightTiles) return null;\n  const idx = gy * mapWidthTiles + gx;\n  const id = tileData[idx];\n  if (!id) return null;\n  const def = Array.isArray(registryItems) ? registryItems.find(r => r.id === id) : null;\n  if (!def || !def.flags || !def.flags.liquid) return null;\n  const type = def.flags.lava_waterfall ? 'lava_waterfall' :\n               (def.flags.radioactive_waterfall ? 'radioactive_waterfall' :\n               (def.flags.waterfall ? 'waterfall' :\n               (def.flags.radioactive_water ? 'radioactive_water' :\n               (def.flags.quicksand ? 'quicksand' :\n               (def.flags.lava ? 'lava' :\n               (def.flags.water ? 'water' : 'liquid'))))));\n  const params = {\n    buoyancy: Number(def?.liquid?.buoyancy),\n    dragX: Number(def?.liquid?.drag?.x),\n    dragY: Number(def?.liquid?.drag?.y),\n    surface: !!def?.liquid?.surface,\n    swimmable: def?.flags?.swimmable === true || def?.liquid?.swimmable === true,\n    dps: Number(def?.liquid?.damagePerSecond),\n    // Optional resource models\n    oxygen: {\n      drainPerSecond: Number(def?.liquid?.oxygen?.drainPerSecond),\n      regenPerSecond: Number(def?.liquid?.oxygen?.regenPerSecond),\n      damagePerSecondWhenDepleted: Number(def?.liquid?.oxygen?.damagePerSecondWhenDepleted)\n    },\n    resistance: {\n      drainPerSecond: Number(def?.liquid?.resistance?.drainPerSecond),\n      regenPerSecond: Number(def?.liquid?.resistance?.regenPerSecond),\n      damagePerSecondWhenDepleted: Number(def?.liquid?.resistance?.damagePerSecondWhenDepleted)\n    }\n  };\n  return { def, type, params };\n}\n\n/**\n * Convenience: returns whether any liquid exists at world pixel.\n */\nexport function isLiquidAtPixel(wx, wy, mapWidthTiles, mapHeightTiles, TILE_SIZE, tileData, registryItems) {\n  return !!getLiquidAtPixel(wx, wy, mapWidthTiles, mapHeightTiles, TILE_SIZE, tileData, registryItems);\n}\n\n/**\n * Compute liquid occupancy for a player AABB and derive head/feet status.\n * @returns { inLiquid:boolean, headUnder:boolean, atSurface:boolean, type:string|null, params:object }\n */\nexport function sampleLiquidForAABB({ x, y, width, height, TILE_SIZE, mapWidth, mapHeight, tileData, registryItems }) {\n  const cx = x + width * 0.5;\n  const headY = y + Math.min(4, height * 0.125);\n  const chestY = y + height * 0.45;\n  const feetY = y + height - 2;\n\n  const feet = getLiquidAtPixel(cx, feetY, mapWidth, mapHeight, TILE_SIZE, tileData, registryItems);\n  const chest = getLiquidAtPixel(cx, chestY, mapWidth, mapHeight, TILE_SIZE, tileData, registryItems);\n  const head = getLiquidAtPixel(cx, headY, mapWidth, mapHeight, TILE_SIZE, tileData, registryItems);\n\n  const candidate = feet || chest || head;\n  if (!candidate) {\n    return { inLiquid: false, headUnder: false, atSurface: false, type: null, params: null };\n  }\n  const type = candidate.type;\n  // Merge params with sane defaults if missing\n  const p = {\n    buoyancy: Number.isFinite(candidate.params.buoyancy) ? candidate.params.buoyancy : 0.5,\n    dragX: Number.isFinite(candidate.params.dragX) ? candidate.params.dragX : 0.55,\n    dragY: Number.isFinite(candidate.params.dragY) ? candidate.params.dragY : 0.65,\n    surface: !!candidate.params.surface,\n    swimmable: !!candidate.params.swimmable,\n    dps: Number.isFinite(candidate.params.dps) ? Math.max(0, candidate.params.dps) : 0,\n    oxygen: {\n      drainPerSecond: Number.isFinite(candidate.params?.oxygen?.drainPerSecond) ? Math.max(0, candidate.params.oxygen.drainPerSecond) : 20,\n      regenPerSecond: Number.isFinite(candidate.params?.oxygen?.regenPerSecond) ? Math.max(0, candidate.params.oxygen.regenPerSecond) : 35,\n      damagePerSecondWhenDepleted: Number.isFinite(candidate.params?.oxygen?.damagePerSecondWhenDepleted) ? Math.max(0, candidate.params.oxygen.damagePerSecondWhenDepleted) : 10\n    },\n    resistance: {\n      drainPerSecond: Number.isFinite(candidate.params?.resistance?.drainPerSecond) ? Math.max(0, candidate.params.resistance.drainPerSecond) : 25,\n      regenPerSecond: Number.isFinite(candidate.params?.resistance?.regenPerSecond) ? Math.max(0, candidate.params.resistance.regenPerSecond) : 40,\n      damagePerSecondWhenDepleted: Number.isFinite(candidate.params?.resistance?.damagePerSecondWhenDepleted) ? Math.max(0, candidate.params.resistance.damagePerSecondWhenDepleted) : 15\n    }\n  };\n  const inLiquid = !!(feet || chest);\n  const headUnder = !!head;\n  const atSurface = inLiquid && !headUnder;\n  return { inLiquid, headUnder, atSurface, type, params: p };\n}\n\n/**\n * Manage per-second liquid damage. Mutates gameState.current.health and hitTimer.\n * @param {{accRef: {current:number}, gameState: any, JUMP_FORCE?:number}} env\n * @param {number} deltaMs\n * @param {{ dps:number }} params\n */\nexport function tickLiquidDamage(env, deltaMs, params) {\n  const dps = Math.max(0, Number(params?.dps) || 0);\n  if (dps <= 0) { env.accRef.current = 0; return; }\n  env.accRef.current += Math.max(0, Number(deltaMs) || 0);\n  const TICK = 1000;\n  while (env.accRef.current >= TICK) {\n    env.accRef.current -= TICK;\n    const cur = Number(env.gameState.current.health) || 0;\n    env.gameState.current.health = Math.max(0, cur - dps);\n    const HIT_FLASH_MS = 500;\n    const prev = Number(env.gameState.current.hitTimerMs) || 0;\n    env.gameState.current.hitTimerMs = Math.max(prev, HIT_FLASH_MS);\n  }\n}\n\nexport default {\n  getLiquidAtPixel,\n  isLiquidAtPixel,\n  sampleLiquidForAABB,\n  tickLiquidDamage\n};\n","// One-frame update orchestrator (migrated from GameEngine/updateFrame.js)\nimport { moveHorizontal } from '../physics/horizontal';\nimport { applyVerticalPhysics } from '../physics/vertical';\nimport { tickLiquidDamage } from '../liquids/liquidUtils';\nimport { updateEntities } from '../gameplay/entities';\n\n// updateFrame(ctx, timestamp)  { continue: boolean }\n// ctx expects:\n// - mapData, objectData\n// - input\n// - refs: { gameState, isInitialized, lastTimeRef, projectilesRef, shootCooldownRef, liquidDamageAccumulatorRef, oxygenDepleteAccRef, lavaDepleteAccRef }\n// - constants: { TILE_SIZE, GRAVITY, TERMINAL_VELOCITY, MOVE_SPEED, JUMP_FORCE }\n// - helpers: { checkCollision, isLiquidAt, getLiquidSample }\n// - actions: {\n//     collectItem(x, y, mapWidth, objectData),\n//     checkHazardDamage(x, y, mapWidth, objectData, deltaMs),\n//     spawnProjectile(originX, originY, direction),\n//     updateProjectiles(deltaMs, mapWidth, mapHeight),\n//     setPlayer(nextState),\n//     onGameOver()\n//   }\nexport function updateFrame(ctx, timestamp) {\n  const {\n    mapData,\n    objectData,\n    input,\n    refs,\n    constants,\n    helpers,\n    actions\n  } = ctx;\n\n  const { gameState, isInitialized, lastTimeRef, projectilesRef, entitiesRef, shootCooldownRef, liquidDamageAccumulatorRef, oxygenDepleteAccRef, lavaDepleteAccRef, weatherDamageAccRef } = refs;\n  const { TILE_SIZE, GRAVITY, TERMINAL_VELOCITY, MOVE_SPEED, JUMP_FORCE } = constants;\n  const { checkCollision, isLiquidAt, getLiquidSample } = helpers;\n  const { collectItem, checkInteractables, checkHazardDamage, checkSecrets, spawnProjectile, playSfx, updateProjectiles, setPlayer, onGameOver } = actions;\n\n  // Keep RAF alive even if init not finished yet\n  if (!isInitialized.current || !mapData) {\n    return { continue: true };\n  }\n\n  // Delta time ms\n  if (!lastTimeRef.current) {\n    lastTimeRef.current = timestamp;\n  }\n  const deltaMs = timestamp - lastTimeRef.current;\n  lastTimeRef.current = timestamp;\n\n  // Pause while terminal is open\n  try {\n    if (window.__GAME_TERMINAL_OPEN__) {\n      return { continue: true };\n    }\n  } catch {}\n\n  const mapWidth = mapData.meta?.width || mapData.width || 20;\n  const mapHeight = mapData.meta?.height || mapData.height || 15;\n  const keys = input.current;\n\n  let {\n    x,\n    y,\n    vx,\n    vy,\n    width,\n    height,\n    isGrounded,\n    direction,\n    animation,\n    ammo,\n    iceResist,\n    maxIceResist\n  } = gameState.current;\n\n  const dt = Math.max(0, deltaMs || 0);\n\n  // 0.5) Resources update (before physics to affect them)\n  // Ice resistance depletion: drains while on slippery surface; regenerates otherwise\n  const backgroundLayer = ctx.mapData.layers.find(l => l.name === 'background')?.data || [];\n  const surface = helpers.getSurfaceProperties ? helpers.getSurfaceProperties(x, y, width, height, mapWidth, mapHeight, TILE_SIZE, backgroundLayer, ctx.registryItems) : { friction: 0.8, acceleration: 0.2 };\n  \n  const isSlippery = surface.friction >= 0.9;\n  let currentIceRes = Number(iceResist);\n  const maxIce = Math.max(1, Number(maxIceResist || 100));\n  if (!Number.isFinite(currentIceRes)) currentIceRes = maxIce;\n\n  if (isSlippery) {\n    currentIceRes -= (20 * dt) / 1000;\n  } else {\n    currentIceRes += (35 * dt) / 1000;\n  }\n  currentIceRes = Math.max(0, Math.min(maxIce, currentIceRes));\n  gameState.current.iceResist = currentIceRes;\n\n  let effectiveFriction = surface.friction;\n  if (isSlippery && currentIceRes > 0) {\n      const ratio = currentIceRes / maxIce;\n      const targetFriction = 0.8;\n      effectiveFriction = surface.friction - (surface.friction - targetFriction) * ratio;\n  }\n\n  // 1) Horizontal movement\n  const checkCollisionExtended = (nx, ny, mw, mh, w, h) => {\n    return checkCollision(nx, ny, mw, mh, w, h);\n  };\n\n  const mh = moveHorizontal({\n    keys,\n    state: { x, y, vx, width, direction, height },\n    MOVE_SPEED,\n    TILE_SIZE,\n    mapWidth,\n    mapHeight,\n    checkCollision: checkCollisionExtended,\n    friction: effectiveFriction,\n    acceleration: isSlippery ? (currentIceRes > 0 ? 0.15 : surface.acceleration) : surface.acceleration\n  });\n  x = mh.x; vx = mh.vx; direction = mh.direction;\n\n  // 1.1) Pushable objects logic (Stone pushing)\n  let isPushing = false;\n  let pushTarget = null;\n  \n  const currentStrength = gameState.current.strength || 30;\n  const isAlreadyAtMax = currentStrength >= 99;\n  const lastPushTime = gameState.current.lastPushTime || 0;\n  const gracePeriod = 300; // ms, kur strength nesamazins pat ja kontakts pazd uz brdi\n\n  if (entitiesRef.current) {\n    // Ja jau stumjam ar pilnu jaudu, esam pielaidgki pret attlumu (histerze), \n    // lai kompenstu nelielas fizikas dzinja nobdes.\n    const pushDist = isAlreadyAtMax ? 15 : 5;\n    const overlapDist = isAlreadyAtMax ? 12 : 5;\n\n    for (const ent of entitiesRef.current) {\n      if (ent.subtype === 'pushable' || ent.def?.isPushable) {\n        // Prbaudm vai spltjs ir blakus akmenim\n        const isNextToLeft = (x + width + pushDist > ent.x) && (x + width <= ent.x + overlapDist) && (y + height > ent.y + 2) && (y < ent.y + ent.height - 2);\n        const isNextToRight = (x - pushDist < ent.x + ent.width) && (x >= ent.x + ent.width - overlapDist) && (y + height > ent.y + 2) && (y < ent.y + ent.height - 2);\n\n        if ((isNextToLeft && keys.d) || (isNextToRight && keys.a)) {\n          isPushing = true;\n          pushTarget = ent;\n          break;\n        }\n      }\n    }\n  }\n\n  if (isPushing) {\n    gameState.current.strength = Math.min(100, currentStrength + (65 * dt) / 1000); // Aug par ~65% sekund\n    if (gameState.current.strength >= 100 && pushTarget) {\n      // Pastumjam akmeni\n      const pushForce = 2.0;\n      pushTarget.vx = (x < pushTarget.x ? 1 : -1) * pushForce;\n      gameState.current.lastPushTime = timestamp; \n      \n      // Atskaojam skau\n      if (pushTarget.def?.sounds?.push && (!pushTarget.lastPushSoundTime || timestamp - pushTarget.lastPushSoundTime > 450)) {\n        playSfx(pushTarget.def.sounds.push, 0.3);\n        pushTarget.lastPushSoundTime = timestamp;\n      }\n    }\n  } else {\n    // Prbaudm grace periodu pirms skam samazint spku\n    const timeSincePush = timestamp - lastPushTime;\n    if (timeSincePush > gracePeriod) {\n      if (currentStrength > 30) {\n        gameState.current.strength = Math.max(30, currentStrength - (35 * dt) / 1000);\n      } else {\n        gameState.current.strength = 30;\n      }\n    }\n  }\n\n  // 2) Vertical physics\n  const vp = applyVerticalPhysics({\n    keys,\n    x,\n    y,\n    vy,\n    isGrounded,\n    animation,\n    GRAVITY,\n    TERMINAL_VELOCITY,\n    JUMP_FORCE,\n    TILE_SIZE,\n    width,\n    height,\n    mapWidth,\n    mapHeight,\n    checkCollision: checkCollisionExtended,\n    vx,\n    isLiquidAt: (wx, wy) => {\n      try { return typeof isLiquidAt === 'function' ? isLiquidAt(wx, wy) : null; } catch { return null; }\n    },\n    prevInWater: !!gameState.current.inWater\n  });\n  y = vp.y; vy = vp.vy; isGrounded = vp.isGrounded; animation = vp.animation;\n  const inWater = !!vp.inWater;\n  const headUnderWater = !!vp.headUnderWater;\n  const atSurface = !!vp.atSurface;\n\n  // 2.5) Generic liquid sampling (water, lava, etc.)\n  let liquidType = null;\n  let liquidParams = null;\n  if (typeof getLiquidSample === 'function') {\n    try {\n      const sample = getLiquidSample({ x, y, width, height, TILE_SIZE, mapWidth, mapHeight });\n      if (sample && sample.inLiquid) {\n        liquidType = sample.type || null;\n        liquidParams = sample.params || null;\n      }\n      // Reset DPS accumulator if we just left liquids\n      if (!sample || !sample.inLiquid) {\n        if (liquidDamageAccumulatorRef) liquidDamageAccumulatorRef.current = 0;\n      }\n    } catch {}\n  }\n\n  // Extra horizontal damping when in liquids\n  if (inWater || liquidType) {\n    if (liquidType === 'lava') {\n      vx *= 0.78;\n    } else if (liquidType === 'quicksand') {\n      vx *= 0.72; // Quicksand is very thick\n    } else {\n      vx *= 0.82;\n    }\n  }\n\n  // 2.6) Apply liquid damage-per-second if defined (e.g., lava)\n  // Will be gated later for lava by resistance depletion; water dps usually 0.\n\n  // 2.7) Resource bars logic (oxygen & lava resistance indicators)\n  try {\n    // Initialize defaults if missing\n    const maxOxy = Math.max(1, Number(gameState.current.maxOxygen || 100));\n    const maxLava = Math.max(1, Number(gameState.current.maxLavaResist || 100));\n    let oxy = Number(gameState.current.oxygen);\n    let lavaRes = Number(gameState.current.lavaResist);\n    if (!Number.isFinite(oxy)) oxy = maxOxy;\n    if (!Number.isFinite(lavaRes)) lavaRes = maxLava;\n    // Resolve per-liquid parameters (with safe defaults)\n    const oxyParams = liquidParams?.oxygen || { drainPerSecond: 20, regenPerSecond: 35, damagePerSecondWhenDepleted: 10 };\n    const lavaParams = liquidParams?.resistance || { drainPerSecond: 25, regenPerSecond: 40, damagePerSecondWhenDepleted: 15 };\n\n    // Oxygen: drains only while head is under water; otherwise regenerates to 100 even after leaving water\n    if (headUnderWater && (liquidType === 'water' || liquidType === 'quicksand' || liquidType === 'radioactive_water')) {\n      oxy -= (Math.max(0, Number(oxyParams.drainPerSecond) || 0) * dt) / 1000;\n    } else {\n      oxy += (Math.max(0, Number(oxyParams.regenPerSecond) || 0) * dt) / 1000;\n    }\n    // Clamp and write back\n    oxy = Math.max(0, Math.min(maxOxy, oxy));\n    gameState.current.oxygen = oxy;\n    gameState.current.maxOxygen = maxOxy;\n\n    // Lava resist depletion while in lava; regenerates outside\n    if (liquidType === 'lava') {\n      lavaRes -= (Math.max(0, Number(lavaParams.drainPerSecond) || 0) * dt) / 1000;\n    } else {\n      lavaRes += (Math.max(0, Number(lavaParams.regenPerSecond) || 0) * dt) / 1000;\n    }\n    lavaRes = Math.max(0, Math.min(maxLava, lavaRes));\n    gameState.current.lavaResist = lavaRes;\n    gameState.current.maxLavaResist = maxLava;\n\n    // Radioactivity: fills up in radioactive liquid; slowly returns to 20% outside\n    const maxRadio = Math.max(1, Number(gameState.current.maxRadioactivity || 100));\n    let radio = Number(gameState.current.radioactivity);\n    if (!Number.isFinite(radio)) radio = maxRadio * 0.2;\n\n    if (liquidType === 'radioactive_water' || liquidType === 'radioactive_waterfall') {\n      radio += (15 * dt) / 1000; \n    } else {\n      if (radio > maxRadio * 0.2) {\n        radio -= (5 * dt) / 1000;\n      } else if (radio < maxRadio * 0.2) {\n        radio += (2 * dt) / 1000;\n      }\n    }\n    radio = Math.max(0, Math.min(maxRadio, radio));\n    gameState.current.radioactivity = radio;\n    gameState.current.maxRadioactivity = maxRadio;\n\n    // Apply depletion health damage when at zero and still in corresponding liquid\n    const tickDepleteDps = (accRef, dpsValue) => {\n      const v = Math.max(0, Number(dpsValue) || 0);\n      if (v <= 0) { accRef.current = 0; return; }\n      accRef.current += dt;\n      const T = 1000;\n      while (accRef.current >= T) {\n        accRef.current -= T;\n        gameState.current.health = Math.max(0, (Number(gameState.current.health) || 0) - v);\n        // Hit flash\n        const HIT_FLASH_MS = 500;\n        const prev = Number(gameState.current.hitTimerMs) || 0;\n        gameState.current.hitTimerMs = Math.max(prev, HIT_FLASH_MS);\n      }\n    };\n\n    // Oxygen depleted and still underwater  damage\n    if ((headUnderWater && (liquidType === 'water' || liquidType === 'quicksand' || liquidType === 'radioactive_water')) && oxy <= 0) {\n      tickDepleteDps(oxygenDepleteAccRef, oxyParams.damagePerSecondWhenDepleted);\n    } else if (oxygenDepleteAccRef) {\n      oxygenDepleteAccRef.current = 0;\n    }\n\n    // Lava resist depleted and still in lava  health damage model is gated by base DPS below\n    if (liquidType === 'lava' && lavaRes <= 0) {\n      if (lavaDepleteAccRef) lavaDepleteAccRef.current = 0;\n    } else if (lavaDepleteAccRef) {\n      lavaDepleteAccRef.current = 0;\n    }\n\n    // Weather damage (Lava Rain, Radioactive Fog)\n    const weather = mapData.weather || {};\n    const lavaRainInt = Number(weather.lavaRain || 0);\n    const radioFogInt = Number(weather.radioactiveFog || 0);\n\n    if (lavaRainInt > 0 || radioFogInt > 0) {\n      weatherDamageAccRef.current += dt;\n      if (weatherDamageAccRef.current >= 1000) {\n        weatherDamageAccRef.current -= 1000;\n        let totalWeatherDps = 0;\n        if (lavaRainInt > 0) totalWeatherDps += (lavaRainInt / 100) * 10; // Max 10 DPS\n        if (radioFogInt > 0) totalWeatherDps += (radioFogInt / 100) * 5;  // Max 5 DPS\n        \n        if (totalWeatherDps > 0) {\n          gameState.current.health = Math.max(0, (Number(gameState.current.health) || 0) - totalWeatherDps);\n          const HIT_FLASH_MS = 500;\n          gameState.current.hitTimerMs = Math.max(Number(gameState.current.hitTimerMs) || 0, HIT_FLASH_MS);\n        }\n      }\n    } else {\n      weatherDamageAccRef.current = 0;\n    }\n  } catch {}\n\n  // 2.8) Base liquid DPS (e.g., lava)  only after resource logic so we can gate by resistance\n  if (liquidType && liquidParams && Number(liquidParams.dps) > 0) {\n    try {\n      if (liquidType === 'lava') {\n        const curRes = Math.max(0, Number(gameState.current.lavaResist));\n        if (curRes <= 0) {\n          tickLiquidDamage({ accRef: liquidDamageAccumulatorRef, gameState }, deltaMs, liquidParams);\n        } else {\n          if (liquidDamageAccumulatorRef) liquidDamageAccumulatorRef.current = 0;\n        }\n      } else {\n        // Other liquids (if any in future) apply their DPS normally\n        tickLiquidDamage({ accRef: liquidDamageAccumulatorRef, gameState }, deltaMs, liquidParams);\n      }\n    } catch {}\n  } else {\n    if (liquidDamageAccumulatorRef) liquidDamageAccumulatorRef.current = 0;\n  }\n\n  // 3) Item collection and triggers\n  // Sync moved state to Ref so triggers can see it and modify it (Teleport, Knockback, etc.)\n  gameState.current.x = x;\n  gameState.current.y = y;\n  gameState.current.vx = vx;\n  gameState.current.vy = vy;\n  gameState.current.isGrounded = isGrounded;\n  gameState.current.animation = animation;\n\n  collectItem(x, y, mapWidth, objectData);\n\n  // 3.5) Interactables check (berry bushes etc.)\n  try { checkInteractables(x, y, mapWidth, objectData); } catch {}\n\n  // 4) Hazard damage check (bushes etc.)\n  try { checkHazardDamage(x, y, mapWidth, objectData, deltaMs); } catch {}\n\n  // Sync back from Ref in case triggers changed something\n  x = gameState.current.x;\n  y = gameState.current.y;\n  vx = gameState.current.vx;\n  vy = gameState.current.vy;\n\n  // 4.5) Secrets detection and reveal\n  try { if (checkSecrets) checkSecrets(x, y, width, height, mapWidth, mapHeight); } catch {}\n\n  // 5) Shooting & projectiles\n  // Cooldown update\n  if (shootCooldownRef.current > 0) shootCooldownRef.current = Math.max(0, shootCooldownRef.current - deltaMs);\n  // Get fresh ammo value after item collection\n  const currentAmmo = Math.max(0, Number(gameState.current.ammo) || 0);\n  if (keys?.mouseLeft && shootCooldownRef.current <= 0 && currentAmmo > 0) {\n    const originX = x + (direction >= 0 ? width + 4 : -4);\n    const originY = y + height / 2;\n    spawnProjectile(originX, originY, direction >= 0 ? 1 : -1, 'player');\n    shootCooldownRef.current = 350; // ms cooldown\n    gameState.current.ammo = Math.max(0, currentAmmo - 1);\n  }\n  // Update existing projectiles\n  try { updateProjectiles(deltaMs, mapWidth, mapHeight); } catch {}\n\n  // 5.5) Update entities (tanks etc.)\n  try {\n    updateEntities({\n      entitiesRef,\n      gameState,\n      mapData,\n      objectData,\n      mapWidth,\n      mapHeight,\n      TILE_SIZE,\n      checkCollision,\n      isLiquidAt,\n      getLiquidSample,\n      spawnProjectile,\n      playSfx,\n      constants,\n      registryItems: ctx.registryItems\n    }, Math.min(dt, 100)); // Ierobeojam deltaMs uz 100ms, lai izvairtos no milzgiem lcieniem\n    \n    // Sinhronizjam loklos maingos pc enttiju (platformu) ietekmes\n    x = gameState.current.x;\n    y = gameState.current.y;\n    vx = gameState.current.vx;\n    vy = gameState.current.vy;\n    isGrounded = gameState.current.isGrounded;\n    animation = gameState.current.animation;\n    \n    // Kontaktbojjumi no enttijm\n    const player = gameState.current;\n    if (entitiesRef.current && entitiesRef.current.length > 0) {\n      for (const ent of entitiesRef.current) {\n        if (ent.health <= 0 || ent.isExploding) continue;\n        \n        // AABB prbaude\n        const hit = (\n          player.x < ent.x + ent.width &&\n          player.x + player.width > ent.x &&\n          player.y < ent.y + ent.height &&\n          player.y + player.height > ent.y\n        );\n        \n        if (hit && Number(player.hitTimerMs) <= 0) {\n          // Pievienojam nelielu atgrdienu (knockback)\n          const knockbackDir = player.x + player.width / 2 < ent.x + ent.width / 2 ? -1 : 1;\n          gameState.current.vx = knockbackDir * 5;\n          gameState.current.vy = -3;\n          \n          // Iestatm bezsmertbas periodu un vizulo flash\n          gameState.current.hitTimerMs = 500;\n          \n          // Samazinm spltja veselbu\n          gameState.current.health = Math.max(0, (Number(gameState.current.health) || 0) - 10);\n          \n          if (actions.onStateUpdate) {\n            actions.onStateUpdate('playerDamage', { damage: 10 });\n          }\n        }\n      }\n    }\n  } catch (e) {\n    console.error(\"Entity update failed:\", e);\n  }\n\n  // 6) Clamp player to world bounds horizontally; allow falling below map to trigger game over\n  const maxX = mapWidth * TILE_SIZE - width;\n  x = Math.max(0, Math.min(maxX, x));\n\n  // 7) Win and Death check\n  if (gameState.current.isWinning) {\n    gameState.current.winCounter = (gameState.current.winCounter || 0) + (gameState.current.winCountSpeed || 10) * (deltaMs / 100);\n    if (gameState.current.winCounter >= 100) {\n      gameState.current.winCounter = 100;\n      // Trigger level win event if needed\n      if (actions.onStateUpdate) actions.onStateUpdate('levelWin');\n    }\n  }\n\n  if ((Number(gameState.current.health) || 0) <= 0) {\n    try { onGameOver && onGameOver(); } catch {}\n  }\n\n  // 8) Decrement hit flash timer\n  try {\n    if (Number(gameState.current.hitTimerMs) > 0) {\n      gameState.current.hitTimerMs = Math.max(0, Number(gameState.current.hitTimerMs) - deltaMs);\n    }\n  } catch {}\n\n  // 9) Commit new state for renderer\n  gameState.current = {\n    ...gameState.current,\n    x,\n    y,\n    vx,\n    vy,\n    width,\n    height,\n    isGrounded,\n    direction,\n    animation,\n    inWater,\n    headUnderWater,\n    atSurface,\n    liquidType: liquidType || null,\n    onIce: isSlippery\n  };\n  setPlayer({ ...gameState.current, projectiles: projectilesRef.current || [], entities: entitiesRef.current || [] });\n\n  return { continue: true };\n}\n\nexport default null;\n","import { moveHorizontal } from '../physics/horizontal';\nimport { applyVerticalPhysics } from '../physics/vertical';\n\n/**\n * Atjaunina visas aktvs enttijas (piemram, tankus).\n * @param {Object} ctx Konteksts ar nepiecieamajiem datiem un funkcijm\n * @param {number} deltaMs Laiks kop pdj kadra\n */\nexport function updateEntities(ctx, deltaMs) {\n  const {\n    entitiesRef,\n    gameState,\n    mapWidth,\n    mapHeight,\n    TILE_SIZE,\n    checkCollision,\n    isLiquidAt,\n    getLiquidSample,\n    spawnProjectile,\n    playSfx,\n    constants,\n    objectData,\n    mapData,\n    registryItems\n  } = ctx;\n\n  if (!entitiesRef.current || entitiesRef.current.length === 0) return;\n\n  const { GRAVITY, TERMINAL_VELOCITY } = constants;\n  const playerX = gameState.current.x;\n  const playerY = gameState.current.y;\n\n  // Ms modificjam enttijas pa tieo ref\n  entitiesRef.current = entitiesRef.current.map(entity => {\n    // 1. Ja enttija ir mirusi, apstrdjam sprdzienu vai noemanu\n    if (entity.health <= 0) {\n      if (!entity.isExploding) {\n        entity.isExploding = true;\n        entity.animation = 'explode';\n        entity.animFrame = 0;\n        entity.animTimer = 0;\n        entity.vx = 0; // Apstjamies sprdziena laik\n        entity.vy = 0;\n        entity.isGrounded = true; // Sprgst uz zemes\n      }\n      \n      const def = entity.def;\n      const explodeAnim = def.spriteSheet?.animations?.explode || [];\n      const totalFrames = explodeAnim.length;\n      const frameDuration = 100; // ms uz kadru\n      \n      entity.animTimer += deltaMs;\n      if (entity.animTimer >= frameDuration) {\n        entity.animTimer = 0;\n        entity.animFrame++;\n        if (entity.animFrame >= totalFrames) {\n          entity.shouldRemove = true;\n        }\n      }\n      return entity;\n    }\n\n    const def = entity.def;\n    \n    // 1.2. Liquid damage (e.g. lava, radioactive water)\n    const liquidSample = getLiquidSample ? getLiquidSample({\n      x: entity.x,\n      y: entity.y,\n      width: entity.width,\n      height: entity.height,\n      TILE_SIZE,\n      mapWidth,\n      mapHeight\n    }) : { inLiquid: false };\n\n    if (liquidSample.inLiquid && liquidSample.params && liquidSample.params.dps > 0) {\n      entity.liquidDamageAcc = (entity.liquidDamageAcc || 0) + deltaMs;\n      while (entity.liquidDamageAcc >= 1000) {\n        entity.liquidDamageAcc -= 1000;\n        entity.health = Math.max(0, entity.health - liquidSample.params.dps);\n      }\n    } else {\n      entity.liquidDamageAcc = 0;\n    }\n\n    // 1.3. Weather damage (Lava Rain, Radioactive Fog)\n    const weather = mapData.weather || {};\n    const lavaRainInt = Number(weather.lavaRain || 0);\n    const radioFogInt = Number(weather.radioactiveFog || 0);\n\n    if (lavaRainInt > 0 || radioFogInt > 0) {\n      entity.weatherDamageAcc = (entity.weatherDamageAcc || 0) + deltaMs;\n      if (entity.weatherDamageAcc >= 1000) {\n        entity.weatherDamageAcc -= 1000;\n        let totalWeatherDps = 0;\n        if (lavaRainInt > 0) totalWeatherDps += (lavaRainInt / 100) * 10;\n        if (radioFogInt > 0) totalWeatherDps += (radioFogInt / 100) * 5;\n        \n        if (totalWeatherDps > 0) {\n          entity.health = Math.max(0, entity.health - totalWeatherDps);\n        }\n      }\n    } else {\n      entity.weatherDamageAcc = 0;\n    }\n\n    // 1.5. Pushable objektu (Akmeu) fizika\n    if (entity.subtype === 'pushable' || def?.isPushable) {\n      const inLiquid = liquidSample.inLiquid;\n      const liquidType = liquidSample.type;\n\n      // Skaas, ja iekrt idrum\n      if (inLiquid && !entity.prevInLiquid) {\n        if (liquidType === 'water' && def.sounds?.water_splash) {\n          playSfx(def.sounds.water_splash, 0.4);\n        } else if (liquidType === 'lava' && def.sounds?.lava_splash) {\n          playSfx(def.sounds.lava_splash, 0.4);\n        }\n      }\n      entity.prevInLiquid = inLiquid;\n\n        // Horizontl kustba ar berzi\n        const mh = moveHorizontal({\n          keys: {}, \n          state: { x: entity.x, y: entity.y, vx: entity.vx || 0, width: entity.width, height: entity.height, direction: entity.direction },\n          MOVE_SPEED: 6.0, // Palielints max trums akmeiem (Supaplex stil)\n          TILE_SIZE,\n          mapWidth,\n          mapHeight,\n          checkCollision: (nx, ny, mw, mh, w, h) => {\n            // Prbaudm statisko pasauli un citas enttijas\n            if (checkCollision(nx, ny, mw, mh, w, h, entity.id)) return true;\n            \n            // Prbaudm kolziju ar spltju\n            const p = gameState.current;\n            const ew = w || entity.width;\n            const eh = h || entity.height;\n            return (nx < p.x + p.width && nx + ew > p.x && ny < p.y + p.height && ny + eh > p.y);\n          },\n          friction: inLiquid ? 0.7 : 0.85,\n          acceleration: 0.2\n        });\n        entity.x = mh.x;\n        entity.vx = mh.vx;\n        entity.direction = mh.direction;\n\n      // Vertikl fizika\n      if (inLiquid && liquidType === 'lava') {\n        // Lna slkana lav\n        const sinkingSpeed = def.sinkingSpeed || 0.2;\n        entity.vy = sinkingSpeed;\n        entity.y += entity.vy;\n        entity.isGrounded = false;\n        \n        // Prbaudm vai neesam izgjui cauri zemei lav\n        if (checkCollision(entity.x, entity.y, mapWidth, mapHeight, entity.width, entity.height, entity.id)) {\n           // Atstumjam atpaka, ja atduras pret dibenu\n           entity.y -= entity.vy;\n           entity.vy = 0;\n           entity.isGrounded = true;\n        }\n      } else {\n        // Fall distance tracking: if falling, accumulate distance\n        if (entity.isGrounded) {\n          entity.fallDistance = 0;\n        } else if ((entity.vy || 0) > 0) {\n          entity.fallDistance = (entity.fallDistance || 0) + (entity.vy || 0);\n        }\n\n        // Standarta gravitcija (den lnka)\n        const vp = applyVerticalPhysics({\n          keys: {}, \n          x: entity.x,\n          y: entity.y,\n          vy: entity.vy || 0,\n          isGrounded: entity.isGrounded,\n          animation: 'idle',\n          GRAVITY: inLiquid ? GRAVITY * 0.3 : GRAVITY,\n          TERMINAL_VELOCITY,\n          JUMP_FORCE: 0,\n          TILE_SIZE,\n          width: entity.width,\n          height: entity.height,\n          mapWidth,\n          mapHeight,\n          checkCollision: (nx, ny, mw, mh, w, h) => {\n            // 1. Prbaudm statisko pasauli un citas enttijas\n            if (checkCollision(nx, ny, mw, mh, w, h, entity.id)) {\n              // Ja ms kaut kam uzkrtam un esam kritui pietiekami ilgi\n              if ((entity.fallDistance || 0) >= TILE_SIZE * 0.8) {\n                // Atrodam kuru enttiju ms aizskrm (lai nogalintu ienaidniekus)\n                if (entitiesRef.current) {\n                  for (const other of entitiesRef.current) {\n                    if (other.id === entity.id || other.health <= 0 || other.subtype === 'platform' || other.subtype === 'pushable') continue;\n                    \n                    const hitOther = (\n                      nx < other.x + other.width &&\n                      nx + (w || entity.width) > other.x &&\n                      ny < other.y + other.height &&\n                      ny + (h || entity.height) > other.y\n                    );\n                    \n                    if (hitOther) {\n                      other.health = 0; // Nogalinm ienaidnieku\n                      // Vartu atskaot skau, ja tda definta\n                      if (def.sounds?.kill_enemy) {\n                        playSfx(def.sounds.kill_enemy, 0.5);\n                      }\n                    }\n                  }\n                }\n              }\n              return true;\n            }\n            \n            // 2. Prbaudm kolziju ar spltju\n            const p = gameState.current;\n            const ew = w || entity.width;\n            const eh = h || entity.height;\n            const hitPlayer = (nx < p.x + p.width && nx + ew > p.x && ny < p.y + p.height && ny + eh > p.y);\n            \n            if (hitPlayer) {\n              // Ja akmens uzkrt spltjam pc brva kritiena (vismaz 1 tuks bloks)\n              if ((entity.fallDistance || 0) >= TILE_SIZE * 0.8) {\n                gameState.current.health = 0; // Fatal impact\n              }\n              return true;\n            }\n            \n            return false;\n          },\n          isLiquidAt,\n          vx: entity.vx\n        });\n        entity.y = vp.y;\n        entity.vy = vp.vy;\n        entity.isGrounded = vp.isGrounded;\n\n        // --- ROLLING LOGIC (Supaplex style) ---\n        // Akmei ripo lej no citiem apaiem objektiem vai pakpieniem, ja ir brva vieta sn un pa diagonli\n        if (entity.isGrounded && Math.abs(entity.vx) < 0.1 && def.isRound) {\n          const checkEmpty = (tx, ty) => !checkCollision(tx, ty, mapWidth, mapHeight, entity.width, entity.height, entity.id);\n          \n          // Minm ripot pa KREISI\n          const leftX = entity.x - TILE_SIZE;\n          // canRollLeft: vai flze pa kreisi ir brva UN vai flze pa kreisi uz leju ir brva (tukums/pakpiens)\n          const canRollLeft = checkEmpty(leftX, entity.y) && checkEmpty(leftX, entity.y + TILE_SIZE);\n          \n          if (canRollLeft) {\n            // Ripojam pa kreisi. Palielints trums (6.0), lai \"veas\" trk\n            entity.vx = -6.0; \n          } else {\n            // Minm ripot pa LABI\n            const rightX = entity.x + TILE_SIZE;\n            const canRollRight = checkEmpty(rightX, entity.y) && checkEmpty(rightX, entity.y + TILE_SIZE);\n            if (canRollRight) {\n              entity.vx = 6.0;\n            }\n          }\n        }\n\n        // Atjaunojam rotciju, ja akmens veas (horizontal movement while grounded)\n        if (entity.isGrounded && Math.abs(entity.vx) > 0.1 && def.isRound) {\n          // Rotcija proporcionla trumam (0.07 rad/px * vx)\n          entity.rotation = (entity.rotation || 0) + (entity.vx * (deltaMs / 16.67) * 0.07);\n        } else if (!entity.isGrounded && def.isRound) {\n          // Ar krtot var nedaudz rott, ja ir bijis horizontls trums\n          entity.rotation = (entity.rotation || 0) + (entity.vx * (deltaMs / 16.67) * 0.03);\n        }\n      }\n\n      // Animcija akmenim parasti ir statiska\n      entity.animation = 'idle';\n      entity.currentSpriteIndex = def.spriteSheet?.animations?.idle?.[0] || 0;\n\n      return entity;\n    }\n\n    // Platformu loika\n    if (entity.subtype === 'platform') {\n      const speed = def.speed || 1.5;\n      const mapW = mapWidth;\n      const mapH = mapHeight;\n      \n      // Mekljam bultias vairkos punktos (centr un mals), lai nepalaistu garm\n      const points = [\n        { x: entity.x + entity.width / 2, y: entity.y + entity.height / 2 }, // Centrs\n        { x: entity.x + 5, y: entity.y + entity.height / 2 },                // Kreis mala\n        { x: entity.x + entity.width - 5, y: entity.y + entity.height / 2 }  // Lab mala\n      ];\n      \n      let arrowId = null;\n      let foundArrowDef = null;\n\n      for (const p of points) {\n        const tx = Math.floor(p.x / TILE_SIZE);\n        const ty = Math.floor(p.y / TILE_SIZE);\n        \n        if (tx < 0 || tx >= mapW || ty < 0 || ty >= mapH) continue;\n        const idx = ty * mapW + tx;\n\n        // 1. Specilais arrows slnis\n        const arrowsLayer = ctx.mapData?.layers?.find(l => l.name === 'arrows' || l.name === 'Arrows')?.data;\n        let id = arrowsLayer ? arrowsLayer[idx] : null;\n        \n        // 2. Objektu slnis\n        if (!id && ctx.objectData) {\n          id = ctx.objectData[idx];\n        }\n\n        if (id) {\n          const aDef = ctx.registryItems.find(r => r.id === id);\n          if (aDef && aDef.subtype === 'arrow') {\n            arrowId = id;\n            foundArrowDef = aDef;\n            break; \n          }\n        }\n      }\n      \n      if (foundArrowDef) {\n        // Mainm kustbas virzienu atbilstoi bultiai\n        if (foundArrowDef.direction === 'up') { entity.vx = 0; entity.vy = -speed; }\n        else if (foundArrowDef.direction === 'down') { entity.vx = 0; entity.vy = speed; }\n        else if (foundArrowDef.direction === 'left') { entity.vx = -speed; entity.vy = 0; }\n        else if (foundArrowDef.direction === 'right') { entity.vx = speed; entity.vy = 0; }\n      }\n\n      // Ja platforma vl nekustas, iedodam tai skuma impulsu\n      if (entity.vx === 0 && entity.vy === 0) {\n        entity.vx = speed;\n      }\n\n      // Kustba\n      let nextX = entity.x + entity.vx * (deltaMs / 16.6);\n      let nextY = entity.y + entity.vy * (deltaMs / 16.6);\n      \n      // Robeu prbaude (neaujam aizbraukt aiz kartes)\n      const worldW = mapWidth * TILE_SIZE;\n      const worldH = mapHeight * TILE_SIZE;\n      \n      if (nextX < 0) { \n        nextX = 0; \n        entity.vx = Math.abs(entity.vx); // Move Right\n      } else if (nextX + entity.width > worldW) { \n        nextX = worldW - entity.width; \n        entity.vx = -Math.abs(entity.vx); // Move Left\n      }\n      \n      if (nextY < 0) { \n        nextY = 0; \n        entity.vy = Math.abs(entity.vy); // Move Down\n      } else if (nextY + entity.height > worldH) { \n        nextY = worldH - entity.height; \n        entity.vy = -Math.abs(entity.vy); // Move Up\n      }\n      \n      entity.x = nextX;\n      entity.y = nextY;\n\n      // Spltja \"prveana\"\n      const player = gameState.current;\n      const onPlatform = (\n        player.x + player.width > entity.x &&\n        player.x < entity.x + entity.width &&\n        Math.abs((player.y + player.height) - entity.y) < 5 &&\n        player.vy >= 0\n      );\n\n      if (onPlatform) {\n        player.x += entity.vx * (deltaMs / 16.6);\n        player.y = entity.y - player.height;\n        player.vy = 0;\n        player.isGrounded = true;\n        \n        // Atjauninam animciju, lai nebtu \"fall\" uz platformas\n        if (Math.abs(player.vx) > 0.1) {\n          player.animation = 'run';\n        } else {\n          player.animation = 'idle';\n        }\n      }\n\n      return entity;\n    }\n\n    const ai = def.ai || {};\n    const reactionDist = (ai.reactionDistance || 10) * TILE_SIZE;\n    const shootDist = (ai.shootDistance || 8) * TILE_SIZE;\n    const speed = def.speed || 1.2;\n\n    const dx = playerX - entity.x;\n    const dy = playerY - entity.y;\n    const dist = Math.sqrt(dx * dx + dy * dy);\n\n    let keys = { a: false, d: false, w: false };\n\n    // 2. AI Uzvedba\n    if (dist < reactionDist) {\n      // Sekojam spltjam\n      if (dx > TILE_SIZE * 0.5) {\n          keys.d = true;\n          entity.direction = 1;\n      } else if (dx < -TILE_SIZE * 0.5) {\n          keys.a = true;\n          entity.direction = -1;\n      }\n\n      // Lkana, ja AI to atbalsta un priek ir rslis\n      if (ai.canJump && entity.isGrounded) {\n          const nextX = entity.x + entity.direction * 10;\n          if (checkCollision(nextX, entity.y, mapWidth, mapHeight, entity.width, entity.height)) {\n              keys.w = true;\n          }\n      }\n\n      // auana\n      if (dist < shootDist) {\n        if (entity.shootCooldown <= 0) {\n           const facingPlayer = (dx > 0 && entity.direction > 0) || (dx < 0 && entity.direction < 0);\n           // Tanks auj, ja skats uz spltju vai ja tas ir pietiekami tuvu\n           if (facingPlayer || dist < TILE_SIZE * 2) {\n             entity.isShooting = true;\n             entity.shootCooldown = ai.shootCooldown || 2000;\n             \n             // Izsaucam via izveidi\n             if (typeof spawnProjectile === 'function') {\n                // Novietojam viu rpus tanka korpusa (atkarb no virziena)\n                const spawnX = entity.x + (entity.width / 2) + (entity.direction * (entity.width / 2 + 10));\n                const spawnY = entity.y + (entity.height * 0.4); // Nedaudz augstk par centru (stobrs)\n                \n                spawnProjectile(\n                  spawnX, \n                  spawnY, \n                  entity.direction,\n                  entity.id\n                );\n             }\n           }\n        }\n      }\n    } else if (ai.patrol) {\n      // Patruanas rems\n      if (entity.direction > 0) keys.d = true;\n      else keys.a = true;\n\n    // Sienas un ru prbaude, lai grieztos atpaka\n    const nextX = entity.x + entity.direction * 10;\n    let hitSomething = checkCollision(nextX, entity.y, mapWidth, mapHeight, entity.width, entity.height);\n\n    // Tanku specifisk kolzija (ar spltju un citiem tankiem)\n    if (!hitSomething && entity.subtype === 'tank') {\n      // 1. Prbaude ar spltju\n      const p = gameState.current;\n      if (nextX < p.x + p.width && nextX + entity.width > p.x && entity.y < p.y + p.height && entity.y + entity.height > p.y) {\n        hitSomething = true;\n      }\n\n      // 2. Prbaude ar citiem tankiem\n      if (!hitSomething) {\n        for (const other of entitiesRef.current) {\n          if (other === entity || other.health <= 0 || other.isExploding) continue;\n          if (other.subtype !== 'tank') continue;\n\n          if (nextX < other.x + other.width && nextX + entity.width > other.x && entity.y < other.y + other.height && entity.y + entity.height > other.y) {\n            hitSomething = true;\n            // Liekam ar otram tankam maint virzienu, ja tie brauc viens otram virs\n            if ((entity.direction > 0 && other.direction < 0) || (entity.direction < 0 && other.direction > 0)) {\n               other.direction *= -1;\n            }\n            break;\n          }\n        }\n      }\n    }\n\n    if (hitSomething) {\n      entity.direction *= -1;\n    }\n    \n    // Platformas malas prbaude\n      if (ai.stayOnPlatform && entity.isGrounded) {\n          const groundX = entity.x + (entity.direction > 0 ? entity.width : 0) + entity.direction * 5;\n          const groundY = entity.y + entity.height + 5;\n          if (!checkCollision(groundX, groundY, mapWidth, mapHeight, 2, 2)) {\n              entity.direction *= -1;\n          }\n      }\n    }\n\n    // Cooldown atjaunoana\n    if (entity.shootCooldown > 0) {\n      entity.shootCooldown -= deltaMs;\n      // Pc 300ms prtraucam auanas animciju\n      if (entity.shootCooldown < (ai.shootCooldown || 2000) - 300) {\n        entity.isShooting = false;\n      }\n    }\n\n    // 3. Fizika un kustba\n    const frameSpeed = speed * (deltaMs / 16.67);\n    \n    const checkEntityCollision = (nx, ny) => {\n        // Statisk pasaule\n        if (checkCollision(nx, ny, mapWidth, mapHeight, entity.width, entity.height)) return true;\n        \n        // Tankiem blojam ceu, ja priek ir spltjs vai cits tanks\n        if (entity.subtype === 'tank') {\n            const p = gameState.current;\n            if (nx < p.x + p.width && nx + entity.width > p.x && ny < p.y + p.height && ny + entity.height > p.y) return true;\n            \n            for (const other of entitiesRef.current) {\n                if (other === entity || other.health <= 0 || other.isExploding) continue;\n                if (other.subtype !== 'tank') continue;\n                if (nx < other.x + other.width && nx + entity.width > other.x && ny < other.y + other.height && ny + entity.height > other.y) return true;\n            }\n        }\n        return false;\n    };\n\n    const mh = moveHorizontal({\n      keys,\n      state: { \n        x: entity.x, \n        y: entity.y, \n        vx: entity.vx || 0,\n        width: entity.width, \n        direction: entity.direction \n      },\n      MOVE_SPEED: frameSpeed,\n      TILE_SIZE,\n      mapWidth,\n      mapHeight,\n      checkCollision: checkEntityCollision\n    });\n    entity.x = mh.x;\n    entity.vx = mh.vx;\n    entity.direction = mh.direction;\n\n    const vp = applyVerticalPhysics({\n      keys,\n      x: entity.x,\n      y: entity.y,\n      vy: entity.vy,\n      isGrounded: entity.isGrounded,\n      animation: entity.animation,\n      GRAVITY,\n      TERMINAL_VELOCITY,\n      JUMP_FORCE: ai.canJump ? 8 : 0,\n      TILE_SIZE,\n      width: entity.width,\n      height: entity.height,\n      mapWidth,\n      mapHeight,\n      checkCollision: checkEntityCollision,\n      isLiquidAt: ctx.isLiquidAt,\n      vx: entity.vx\n    });\n    entity.y = vp.y;\n    entity.vy = vp.vy;\n    entity.isGrounded = vp.isGrounded;\n\n    // 4. Animcijas stvoka noteikana\n    if (entity.isShooting) {\n      entity.animation = 'shoot';\n    } else if (entity.health <= (def.maxHealth || 100) * 0.5) {\n      entity.animation = 'move_damaged';\n    } else if (entity.vx === 0 && entity.isGrounded) {\n      entity.animation = 'idle';\n    } else {\n      entity.animation = 'move';\n    }\n\n    // Atjaunojam animcijas rmi, ja tas nav sprdziens\n    if (!entity.isExploding) {\n        const anims = def.spriteSheet?.animations || {};\n        let currentAnim = anims[entity.animation];\n        \n        // Rezerves varianti, ja specifisk animcija nav atrasta\n        if (!currentAnim || !Array.isArray(currentAnim) || currentAnim.length === 0) {\n            currentAnim = anims['move'] || anims['idle'] || [0];\n        }\n        \n        entity.animTimer = (entity.animTimer || 0) + deltaMs;\n        const frameDur = 100; // ms\n        if (entity.animTimer >= frameDur) {\n            entity.animTimer = 0;\n            entity.animFrame = (entity.animFrame || 0) + 1;\n            if (entity.animFrame >= currentAnim.length) {\n                entity.animFrame = 0;\n            }\n        }\n        entity.currentSpriteIndex = currentAnim[entity.animFrame % currentAnim.length];\n    } else {\n        const explodeAnim = def.spriteSheet?.animations?.explode || [39];\n        // Sprdziena animcija tiek vadta augstk (death sekcij)\n        entity.currentSpriteIndex = explodeAnim[Math.min(entity.animFrame, explodeAnim.length - 1)];\n    }\n\n    return entity;\n  }).filter(e => !e.shouldRemove);\n}\n","// Collision helpers (migrated from GameEngine/collision.js)\n\n// Check whether a world pixel (wx, wy) is solid (collides with a tile or an object)\n// Params:\n// - wx, wy: world pixel coordinates\n// - mapWidthTiles, mapHeightTiles: map size in tiles\n// - TILE_SIZE: tile size in pixels\n// - tileData: tile layer array (ids)\n// - registryItems: registry to resolve definitions\n// - secretData: secret layer array (ids)\n// - objectData: object layer array (ids)\n// - objectMetadata: metadata for objects (e.g. health)\n// - entities: array of active entities (optional)\n// - ignoreEntityId: ID of the entity to ignore in check (optional)\nexport function isSolidAtPixel(wx, wy, mapWidthTiles, mapHeightTiles, TILE_SIZE, tileData, registryItems, secretData, objectData, objectMetadata, entities, ignoreEntityId) {\n  // Allow movement above the map\n  if (wy < 0) return false;\n  const gx = Math.floor(wx / TILE_SIZE);\n  const gy = Math.floor(wy / TILE_SIZE);\n  // Out of world is not solid\n  if (gx < 0 || gy < 0 || gx >= mapWidthTiles || gy >= mapHeightTiles) return false;\n  const index = gy * mapWidthTiles + gx;\n\n  // 0. Check entities first (dynamic obstacles)\n  if (entities) {\n    for (const ent of entities) {\n      if (ent.id === ignoreEntityId) continue;\n      if (ent.health <= 0 || ent.isExploding) continue;\n      // Platforms are stand-on-able but not usually \"solid\" for other entities' horizontal physics\n      if (ent.subtype === 'platform') continue;\n\n      if (wx >= ent.x && wx < ent.x + ent.width && wy >= ent.y && wy < ent.y + ent.height) {\n        return true;\n      }\n    }\n  }\n\n  // Check if this tile has a secret - secrets make tiles passable\n  if (secretData && secretData[index]) {\n    return false;\n  }\n\n  // 1. Check objects layer first (like the wooden box)\n  if (objectData && objectData[index]) {\n    const objId = objectData[index];\n    const objDef = registryItems.find(r => r.id === objId);\n    \n    // Ignorjam enttijas kolziju prbauds (tm ir sava fizika un ts nevajadztu uztvert k blokus)\n    // Prbaudm pc vairkm pazmm, lai btu droi\n    const isEntity = objDef && (\n      objDef.type === 'entity' || \n      objDef.subtype === 'tank' || \n      objDef.subtype === 'platform' ||\n      objDef.subtype === 'pushable' ||\n      objDef.isPushable ||\n      (objDef.name && objDef.name.toLowerCase().includes('entities.'))\n    );\n\n    if (objDef && objDef.collision && !isEntity) {\n      // Special logic for destructible objects like the wooden box\n      if (objDef.isDestructible && objectMetadata && objectMetadata[index]) {\n        const health = objectMetadata[index].health !== undefined ? objectMetadata[index].health : objDef.maxHealth;\n        const threshold = objDef.passableHealthThreshold || 0;\n        if (health <= threshold) {\n          return false; // Box is broken, can pass through\n        }\n      }\n      return true;\n    }\n  }\n\n  // 2. Check tiles layer\n  const tileId = tileData[index];\n  if (!tileId) return false;\n  const tileDef = registryItems.find(r => r.id === tileId);\n  if (!tileDef || !tileDef.collision) return false;\n  if (tileDef.collision === true) return true;\n  if (typeof tileDef.collision === 'object') {\n    return !!(\n      tileDef.collision.top ||\n      tileDef.collision.bottom ||\n      tileDef.collision.left ||\n      tileDef.collision.right\n    );\n  }\n  return false;\n}\n\n// AABB collision check for player rectangle at (newX, newY)\nexport function checkCollision(newX, newY, mapWidthTiles, mapHeightTiles, TILE_SIZE, tileData, registryItems, width, height, secretData, objectData, objectMetadata, entities, ignoreEntityId) {\n  const points = [\n    { x: newX, y: newY }, // Top Left\n    { x: newX + width - 0.01, y: newY }, // Top Right\n    { x: newX, y: newY + height - 0.01 }, // Bottom Left\n    { x: newX + width - 0.01, y: newY + height - 0.01 } // Bottom Right\n  ];\n\n  for (let p of points) {\n    const gx = Math.floor(p.x / TILE_SIZE);\n    const gy = Math.floor(p.y / TILE_SIZE);\n    \n    // Boundary checks: block left, right, and top edges of the world.\n    // Allow falling off the bottom (gy >= mapHeightTiles).\n    if (gx < 0 || gx >= mapWidthTiles || gy < 0) return true;\n\n    if (isSolidAtPixel(p.x, p.y, mapWidthTiles, mapHeightTiles, TILE_SIZE, tileData, registryItems, secretData, objectData, objectMetadata, entities, ignoreEntityId)) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * Gets physical properties of the surface below the player (friction, acceleration)\n */\nexport function getSurfaceProperties(x, y, width, height, mapWidthTiles, mapHeightTiles, TILE_SIZE, tileData, registryItems) {\n  const cx = x + width / 2;\n  const feetY = y + height + 1; // 1 pixel below feet\n  const gx = Math.floor(cx / TILE_SIZE);\n  const gy = Math.floor(feetY / TILE_SIZE);\n  \n  if (gx < 0 || gy < 0 || gx >= mapWidthTiles || gy >= mapHeightTiles) {\n    return { friction: 0.8, acceleration: 0.2 };\n  }\n  \n  const index = gy * mapWidthTiles + gx;\n  const tileId = tileData[index];\n  if (!tileId) return { friction: 0.8, acceleration: 0.2 };\n  \n  const tileDef = registryItems.find(r => r.id === tileId);\n  if (!tileDef) return { friction: 0.8, acceleration: 0.2 };\n  \n  // If block has slipperiness, use it. Default friction is 0.8.\n  const slipperiness = tileDef.slipperiness !== undefined ? tileDef.slipperiness : 0.8;\n  \n  return {\n    friction: slipperiness,\n    // When slippery, acceleration is lower (harder to start/change direction)\n    acceleration: tileDef.slipperiness !== undefined ? (1 - slipperiness) * 2 + 0.05 : 0.2\n  };\n}\n\nexport default {\n  isSolidAtPixel,\n  checkCollision,\n  getSurfaceProperties\n};\n","/**\n * Centralized Error Handler\n * Provides unified error handling and logging across the application\n */\n\nclass ErrorHandler {\n  constructor() {\n    this.errorListeners = [];\n    this.logLevel = process.env.NODE_ENV === 'production' ? 'error' : 'debug';\n  }\n\n  /**\n   * Log levels: debug, info, warn, error\n   */\n  setLogLevel(level) {\n    this.logLevel = level;\n  }\n\n  /**\n   * Add error listener callback\n   * @param {Function} callback - Callback function to receive errors\n   */\n  addListener(callback) {\n    this.errorListeners.push(callback);\n  }\n\n  /**\n   * Remove error listener callback\n   * @param {Function} callback - Callback to remove\n   */\n  removeListener(callback) {\n    this.errorListeners = this.errorListeners.filter(cb => cb !== callback);\n  }\n\n  /**\n   * Notify all listeners of an error\n   * @param {Error} error - The error object\n   * @param {Object} context - Additional context information\n   */\n  notifyListeners(error, context = {}) {\n    this.errorListeners.forEach(callback => {\n      try {\n        callback(error, context);\n      } catch (err) {\n        console.error('Error in error listener:', err);\n      }\n    });\n  }\n\n  /**\n   * Handle and log an error\n   * @param {Error|string} error - The error to handle\n   * @param {Object} context - Additional context information\n   * @param {string} level - Log level (debug, info, warn, error)\n   */\n  handle(error, context = {}, level = 'error') {\n    const errorObj = error instanceof Error ? error : new Error(String(error));\n    const timestamp = new Date().toISOString();\n\n    const logData = {\n      timestamp,\n      level,\n      message: errorObj.message,\n      stack: errorObj.stack,\n      context,\n    };\n\n    // Console logging based on level\n    if (this.shouldLog(level)) {\n      const logMethod = console[level] || console.error;\n      logMethod(`[${timestamp}] [${level.toUpperCase()}]`, errorObj.message, context);\n\n      if (errorObj.stack && level === 'error') {\n        console.error(errorObj.stack);\n      }\n    }\n\n    // Notify listeners\n    if (level === 'error' || level === 'warn') {\n      this.notifyListeners(errorObj, context);\n    }\n\n    // In development, you could send to external logging service\n    if (process.env.NODE_ENV === 'production') {\n      this.sendToLoggingService(logData);\n    }\n\n    return errorObj;\n  }\n\n  /**\n   * Determine if a log level should be printed based on current log level setting\n   * @param {string} level - The log level to check\n   * @returns {boolean}\n   */\n  shouldLog(level) {\n    const levels = { debug: 0, info: 1, warn: 2, error: 3 };\n    const currentLevel = levels[this.logLevel] || 0;\n    const messageLevel = levels[level] || 0;\n    return messageLevel >= currentLevel;\n  }\n\n  /**\n   * Send error data to external logging service (stub for now)\n   * @param {Object} logData - The log data to send\n   */\n  sendToLoggingService(logData) {\n    // TODO: Implement integration with external logging service\n    // (e.g., Sentry, LogRocket, etc.)\n  }\n\n  /**\n   * Convenience methods for different log levels\n   */\n  debug(message, context = {}) {\n    return this.handle(message, context, 'debug');\n  }\n\n  info(message, context = {}) {\n    return this.handle(message, context, 'info');\n  }\n\n  warn(message, context = {}) {\n    return this.handle(message, context, 'warn');\n  }\n\n  error(message, context = {}) {\n    return this.handle(message, context, 'error');\n  }\n\n  /**\n   * Wrap an async function with error handling\n   * @param {Function} fn - The async function to wrap\n   * @param {Object} context - Additional context for errors\n   * @returns {Function} Wrapped function\n   */\n  wrapAsync(fn, context = {}) {\n    return async (...args) => {\n      try {\n        return await fn(...args);\n      } catch (error) {\n        this.handle(error, { ...context, args }, 'error');\n        throw error;\n      }\n    };\n  }\n\n  /**\n   * Wrap a sync function with error handling\n   * @param {Function} fn - The function to wrap\n   * @param {Object} context - Additional context for errors\n   * @returns {Function} Wrapped function\n   */\n  wrapSync(fn, context = {}) {\n    return (...args) => {\n      try {\n        return fn(...args);\n      } catch (error) {\n        this.handle(error, { ...context, args }, 'error');\n        throw error;\n      }\n    };\n  }\n}\n\n// Export singleton instance\nconst errorHandler = new ErrorHandler();\n\nexport default errorHandler;\nexport { ErrorHandler };\n","import { useState, useEffect, useRef } from 'react';\nimport { useInput } from './useInput';\nimport { findItemById } from '../engine/registry';\nimport { checkHazardDamage, spawnProjectile as spawnProjectileExternal, collectItem, checkInteractables, updateProjectiles, handleWeatherEffectHit } from '../engine/gameplay';\nimport { checkSecretDetection } from '../engine/gameplay/secrets';\nimport { playSfx } from '../engine/audio';\nimport { updateFrame } from '../engine/loop/updateFrame';\nimport { getLiquidAtPixel, isLiquidAtPixel as isLiquidAtPixelUtil, sampleLiquidForAABB } from '../engine/liquids/liquidUtils';\nimport { isSolidAtPixel as isSolidAtPixelExternal, checkCollision as checkCollisionExternal, getSurfaceProperties } from '../engine/physics';\nimport {\n    TILE_SIZE,\n    GRAVITY,\n    TERMINAL_VELOCITY,\n    MOVE_SPEED,\n    JUMP_FORCE,\n    MAX_HEALTH,\n    MAX_OXYGEN,\n    MAX_LAVA_RESIST,\n    MAX_ICE_RESIST,\n    MAX_RADIOACTIVITY\n} from '../constants/gameConstants';\nimport errorHandler from '../services/errorHandler';\n\n// Helper: accept boolean or string values like \"true\"/\"false\"\nconst parseBool = (v, def = false) => {\n    if (typeof v === 'boolean') return v;\n    if (typeof v === 'string') return v.trim().toLowerCase() === 'true';\n    return def;\n};\n\n// Modified arguments: added objectData, secretData, revealedSecrets, onRevealSecret, objectMetadata\nexport const useGameEngine = (mapData, tileData, objectData, secretData, revealedSecrets, registryItems, onGameOver, onStateUpdate, onRevealSecret, objectMetadata) => {\n    const input = useInput();\n\n    // Player state\n    const [player, setPlayer] = useState({\n        x: 0, // In pixels\n        y: 0, // In pixels\n        width: 32, // Default, will be overwritten from registry\n        height: 32,\n        vx: 0,\n        vy: 0,\n        isGrounded: false,\n        direction: 1, // 1 right, -1 left\n        animation: 'idle', // idle, run, jump\n        health: 90, // Initial health (for testing, to allow picking up hearts)\n        maxHealth: MAX_HEALTH,\n        ammo: 0, // Fireball ammunition\n        // New resources for display\n        oxygen: MAX_OXYGEN,\n        maxOxygen: MAX_OXYGEN,\n        lavaResist: MAX_LAVA_RESIST,\n        maxLavaResist: MAX_LAVA_RESIST,\n        iceResist: MAX_ICE_RESIST,\n        maxIceResist: MAX_ICE_RESIST,\n        radioactivity: MAX_RADIOACTIVITY * 0.2, // 20% default\n        maxRadioactivity: MAX_RADIOACTIVITY,\n        strength: 30,\n        maxStrength: 100,\n        lastPushTime: 0,\n        isWinning: false,\n        winCounter: 0,\n        projectiles: [] // Active projectiles for rendering\n  });\n\n    // Ref objects for game logic\n    const gameState = useRef({ ...player });               // Player state for loop (avoids closure issues)\n    const requestRef = useRef();                           // requestAnimationFrame id\n    const isInitialized = useRef(false);                   // Whether game is initialized\n    const lastTimeRef = useRef(0);                         // Time between frames (t)\n    const hazardDamageAccumulatorRef = useRef(0);          // Accumulated time for hazard damage over time\n    const lastHazardIndexRef = useRef(null);               // Last hazard tile index cache (to associate damage with specific hazard)\n    const triggeredHazardsRef = useRef(new Set());         // Hazards with damageOnce: true that have already triggered\n    const projectilesRef = useRef([]);                     // Active projectiles\n    const shootCooldownRef = useRef(0);                    // Remaining cooldown time (ms)\n    const projectileIdRef = useRef(1);                     // Auto-incrementing ID\n    const soundEnabledRef = useRef(false);                 // Global sound toggle\n    const audioCtxRef = useRef(null);                      // WebAudio context (fallback)\n    const audioCtxUnlockedRef = useRef(false);             // Whether AudioContext is unlocked with user gesture\n    const liquidDamageAccumulatorRef = useRef(0);          // Accumulated time for liquid DPS ticking (e.g., lava)\n    const oxygenDepleteAccRef = useRef(0);                 // O2 depletion DPS accumulator\n    const lavaDepleteAccRef = useRef(0);                   // Lava resist depletion DPS accumulator\n    const weatherDamageAccRef = useRef(0);                // Weather damage DPS accumulator\n    const entitiesRef = useRef([]);                        // Active moving entities (tanks, etc.)\n\n    // Refs for props to avoid stale closures in the game loop\n    const onStateUpdateRef = useRef(onStateUpdate);\n    const onRevealSecretRef = useRef(onRevealSecret);\n    const onGameOverRef = useRef(onGameOver);\n    const objectMetadataRef = useRef(objectMetadata);\n    const revealedSecretsRef = useRef(revealedSecrets);\n\n    useEffect(() => { onStateUpdateRef.current = onStateUpdate; }, [onStateUpdate]);\n    useEffect(() => { onRevealSecretRef.current = onRevealSecret; }, [onRevealSecret]);\n    useEffect(() => { onGameOverRef.current = onGameOver; }, [onGameOver]);\n    useEffect(() => { objectMetadataRef.current = objectMetadata; }, [objectMetadata]);\n    useEffect(() => { revealedSecretsRef.current = revealedSecrets; }, [revealedSecrets]);\n\n    // Sync global sound toggle from localStorage and events\n    useEffect(() => {\n        try {\n            const v = localStorage.getItem('game_sound_enabled');\n            soundEnabledRef.current = (v === null ? false : v !== '0');\n        } catch { soundEnabledRef.current = false; }\n        const onToggle = (e) => {\n            try {\n                const enabled = !!(e?.detail?.enabled);\n                soundEnabledRef.current = enabled;\n            } catch {}\n        };\n        window.addEventListener('game-sound-toggle', onToggle);\n        // AudioContext unlocking with user gesture (click on HUD button, etc.)\n        const onUserGesture = () => {\n            try {\n                if (!audioCtxRef.current) {\n                    const AC = window.AudioContext || window.webkitAudioContext;\n                    if (AC) audioCtxRef.current = new AC();\n                }\n                if (audioCtxRef.current && audioCtxRef.current.state === 'suspended') {\n                    audioCtxRef.current.resume?.();\n                }\n                if (audioCtxRef.current && audioCtxRef.current.state === 'running') {\n                    audioCtxUnlockedRef.current = true;\n                }\n            } catch {}\n        };\n        window.addEventListener('game-sound-user-gesture', onUserGesture);\n\n        return () => {\n            window.removeEventListener('game-sound-toggle', onToggle);\n            window.removeEventListener('game-sound-user-gesture', onUserGesture);\n        };\n    }, []);\n\n    // Helper function: play SFX (delegated to GameEngine/audio)\n    const playShotSfx = (url, volume) => {\n        return playSfx({ soundEnabledRef, audioCtxRef, audioCtxUnlockedRef }, url, volume);\n    };\n\n    // Adapter: correctly calls GameEngine/checkHazardDamage with options object\n    const checkHazardDamageWrapper = (currentX, currentY, mapWidth, objectLayerData, deltaMs) => {\n        try {\n            return checkHazardDamage({\n                currentX,\n                currentY,\n                mapWidth,\n                objectLayerData,\n                deltaMs,\n                registryItems,\n                TILE_SIZE,\n                MOVE_SPEED,\n                JUMP_FORCE,\n                hazardDamageAccumulatorRef,\n                lastHazardIndexRef,\n                triggeredHazardsRef,\n                gameState\n            });\n        } catch (error) {\n            errorHandler.error(error, {\n                component: 'useGameEngine',\n                function: 'checkHazardDamageWrapper',\n                playerPosition: { x: currentX, y: currentY },\n                mapWidth\n            });\n            return { damage: 0, damageType: null };\n        }\n    };\n\n    // Track revealed secrets locally to prevent duplicate reveals before state updates\n    const localRevealedRef = useRef(new Set());\n\n    // Weather effects impact handling (meteors, etc.)\n    const handleWeatherEffectHitWrapper = (type, data) => {\n        handleWeatherEffectHit(type, data, { gameState, entitiesRef });\n    };\n\n    // Listen for weather effect hits from the UI/Renderer\n    useEffect(() => {\n        const onHit = (e) => {\n            if (e && e.detail) {\n                handleWeatherEffectHitWrapper(e.detail.type, e.detail.data);\n            }\n        };\n        window.addEventListener('weather-effect-hit', onHit);\n        return () => window.removeEventListener('weather-effect-hit', onHit);\n    }, []);\n\n    // Secrets detection wrapper\n    const checkSecretsWrapper = (currentX, currentY, width, height, mapWidth, mapHeight) => {\n        try {\n            if (!secretData || !onRevealSecretRef.current) return;\n\n            // Merge prop revealedSecrets with local tracking\n            const mergedRevealed = [\n                ...(revealedSecretsRef.current || []),\n                ...Array.from(localRevealedRef.current)\n            ];\n\n            const indicesToReveal = checkSecretDetection({\n                currentX,\n                currentY,\n                width,\n                height,\n                secretMapData: secretData,\n                revealedSecrets: mergedRevealed,\n                mapWidth,\n                mapHeight,\n                registryItems,\n                TILE_SIZE\n            });\n\n            if (indicesToReveal && indicesToReveal.length > 0) {\n                // Add to local tracking immediately (before state updates)\n                indicesToReveal.forEach(idx => localRevealedRef.current.add(idx));\n                onRevealSecretRef.current(indicesToReveal);\n            }\n        } catch (error) {\n            errorHandler.error(error, {\n                component: 'useGameEngine',\n                function: 'checkSecretsWrapper',\n                playerPosition: { x: currentX, y: currentY }\n            });\n        }\n    };\n\n    const lastMapIdRef = useRef(null);\n\n    // Initialize player at starting position\n    useEffect(() => {\n        if (!mapData) {\n            isInitialized.current = false;\n            lastMapIdRef.current = null;\n            return;\n        }\n\n        // Unique identifier for the map session\n        // We include projectName and timestamps to distinguish between different projects \n        // that might use the same activeMapId (like \"main\")\n        const meta = mapData.meta || {};\n        const projectName = meta.projectName || '';\n        const mapId = meta.activeMapId || mapData.name || 'default';\n        const timestamp = meta.date_map_last_updated || meta.date_map_created_at || '';\n        \n        const currentMapId = `${projectName}|${mapId}|${timestamp}`;\n        const isNewMapLoad = currentMapId !== lastMapIdRef.current;\n\n        // Ja sple jau ir inicializta UN t ir t pati karte, nemainm spltja pozciju\n        // Tas novr \"reset\" uz skumu, kad spltjs pace itemu vai mains laikapstki\n        if (isInitialized.current && !isNewMapLoad) return;\n\n        lastMapIdRef.current = currentMapId;\n\n        // Reset state for new initialization\n        lastTimeRef.current = 0;\n        hazardDamageAccumulatorRef.current = 0;\n        lastHazardIndexRef.current = null;\n        triggeredHazardsRef.current = new Set();\n        projectilesRef.current = [];\n        entitiesRef.current = [];\n        shootCooldownRef.current = 0;\n        projectileIdRef.current = 1;\n\n        if (mapData && mapData.layers) {\n            const mapW = mapData.meta?.width || mapData.width || 20;\n            const mapH = mapData.meta?.height || mapData.height || 15;\n            \n            // Search for entities in objectData\n            const initialEntities = [];\n            if (objectData && Array.isArray(objectData)) {\n                objectData.forEach((id, idx) => {\n                    if (id && !id.includes('player')) {\n                        const def = findItemById(id) || registryItems.find(r => r.id === id);\n                        const isEntity = def && (\n                            def.type === 'entity' || \n                            def.subtype === 'tank' || \n                            def.subtype === 'platform' ||\n                            def.isPushable ||\n                            (def.name && def.name.toLowerCase().includes('entities.'))\n                        );\n\n                        if (isEntity) {\n                            initialEntities.push({\n                                id: `entity_${idx}_${Date.now()}_${idx}`,\n                                defId: id,\n                                def: def,\n                                x: (idx % mapW) * TILE_SIZE,\n                                y: Math.floor(idx / mapW) * TILE_SIZE,\n                                width: (Number(def.width) || 1) * TILE_SIZE,\n                                height: (Number(def.height) || 1) * TILE_SIZE,\n                                vx: 0,\n                                vy: 0,\n                                health: def.maxHealth || 100,\n                                direction: def.subtype === 'platform' ? 1 : (def.isPushable ? 1 : -1),\n                                animation: (def.subtype === 'platform' || def.isPushable) ? 'idle' : 'move',\n                                animFrame: 0,\n                                animTimer: 0,\n                                isGrounded: false,\n                                shootCooldown: 0,\n                                currentSpriteIndex: 0,\n                                subtype: def.subtype || (def.isPushable ? 'pushable' : null),\n                                rotation: def.isRound ? 0 : undefined\n                            });\n                        }\n                    }\n                });\n            }\n            entitiesRef.current = initialEntities;\n\n            const objLayer = mapData.layers.find(l => l.name === 'entities');\n            if (objLayer) {\n                // 1. Priority: spawnTriggerId hint (from inter-map teleport)\n                const spawnTriggerId = mapData.meta?.spawnTriggerId;\n                let startIndex = -1;\n\n                if (spawnTriggerId !== undefined && spawnTriggerId !== null) {\n                    startIndex = objLayer.data.findIndex((id, idx) => {\n                        if (!id || (!id.includes('target') && id !== 'portal_target')) return false;\n                        const meta = objectMetadataRef.current?.[idx] || mapData.meta?.objectMetadata?.[idx];\n                        return meta && meta.triggerId === spawnTriggerId;\n                    });\n                }\n\n                // 2. Fallback: Search for player (anything containing 'player')\n                if (startIndex === -1) {\n                    startIndex = objLayer.data.findIndex(id => id && id.includes('player'));\n                }\n\n                if (startIndex !== -1) {\n                    let startX = (startIndex % mapW) * TILE_SIZE;\n                    let startY = Math.floor(startIndex / mapW) * TILE_SIZE;\n\n                    // Get data from registry\n                    const playerId = objLayer.data[startIndex];\n                    const registryPlayer = findItemById(playerId) || findItemById(\"player\"); // Fallback to generic player\n                    const maxHealth = Math.max(1, Number(registryPlayer?.maxHealth) || MAX_HEALTH);\n\n                    // Completely overwrite gameState with default values + new position\n                    gameState.current = {\n                        x: startX,\n                        y: startY,\n                        width: (registryPlayer?.width || 1) * TILE_SIZE * 0.8,\n                        height: (registryPlayer?.height || 1) * TILE_SIZE,\n                        vx: 0,\n                        vy: 0,\n                        isGrounded: false,\n                        direction: 1,\n                        animation: 'idle',\n                        health: Math.min(90, maxHealth), // Reset to 90 (not MAX) to allow testing items\n                        maxHealth,\n                        ammo: 0,\n                        // resources\n                        oxygen: MAX_OXYGEN,\n                        maxOxygen: MAX_OXYGEN,\n                        lavaResist: MAX_LAVA_RESIST,\n                        maxLavaResist: MAX_LAVA_RESIST,\n                        radioactivity: MAX_RADIOACTIVITY * 0.2,\n                        maxRadioactivity: MAX_RADIOACTIVITY,\n                        strength: Number(registryPlayer?.strength) || 30,\n                        maxStrength: Number(registryPlayer?.maxStrength) || 100,\n                        lastPushTime: 0,\n                        isWinning: false,\n                        winCounter: 0\n                    };\n\n                    // If start position sinks into block, move up to safe location\n                    let guard = 0;\n                    while (checkCollision(gameState.current.x, gameState.current.y, mapW, mapH) && guard < mapH) {\n                        gameState.current.y = Math.max(0, gameState.current.y - TILE_SIZE);\n                        guard++;\n                    }\n                    // Ensure we're not outside world boundaries horizontally\n                    const maxXAtStart = mapW * TILE_SIZE - gameState.current.width;\n                    gameState.current.x = Math.max(0, Math.min(gameState.current.x, maxXAtStart));\n\n                    setPlayer({ ...gameState.current, projectiles: [], entities: entitiesRef.current });\n                    isInitialized.current = true;\n                } else {\n                    // If player not found in map, place at 0,0 or some safe location\n                    gameState.current = {\n                        ...gameState.current,\n                        x: 0,\n                        y: 0,\n                        vx: 0,\n                        vy: 0,\n                        oxygen: MAX_OXYGEN,\n                        maxOxygen: MAX_OXYGEN,\n                        lavaResist: MAX_LAVA_RESIST,\n                        maxLavaResist: MAX_LAVA_RESIST,\n                        radioactivity: MAX_RADIOACTIVITY * 0.2,\n                        maxRadioactivity: MAX_RADIOACTIVITY,\n                        strength: 30,\n                        maxStrength: 100,\n                        lastPushTime: 0\n                    };\n                    setPlayer({ ...gameState.current, projectiles: [], entities: entitiesRef.current });\n                    isInitialized.current = true; // allow loop to work even without start position\n                }\n            } else {\n                // No entities layer  still start game at 0,0\n                gameState.current = {\n                    ...gameState.current,\n                    x: 0,\n                    y: 0,\n                    vx: 0,\n                    vy: 0,\n                    oxygen: MAX_OXYGEN,\n                    maxOxygen: MAX_OXYGEN,\n                    lavaResist: MAX_LAVA_RESIST,\n                    maxLavaResist: MAX_LAVA_RESIST,\n                    radioactivity: MAX_RADIOACTIVITY * 0.2,\n                    maxRadioactivity: MAX_RADIOACTIVITY,\n                    strength: 30,\n                    maxStrength: 100,\n                    lastPushTime: 0\n                };\n                setPlayer({ ...gameState.current, projectiles: [], entities: entitiesRef.current });\n                isInitialized.current = true;\n            }\n        }\n    }, [mapData]); // objectData removed - item collection shouldn't trigger re-initialization\n\n    // Helper function for collisions (AABB Collision) with blocks (tile layer)  delegates to GameEngine/collision\n    const checkCollision = (newX, newY, mapWidth, mapHeightParam, widthOverride, heightOverride, ignoreId) => {\n        return checkCollisionExternal(\n            newX,\n            newY,\n            mapWidth,\n            mapHeightParam,\n            TILE_SIZE,\n            tileData,\n            registryItems,\n            widthOverride !== undefined ? widthOverride : gameState.current.width,\n            heightOverride !== undefined ? heightOverride : gameState.current.height,\n            secretData,\n            objectData,\n            objectMetadataRef.current || mapData?.meta?.objectMetadata,\n            entitiesRef.current,\n            ignoreId\n        );\n    };\n\n    // Simple point solidity check for projectiles  delegates to GameEngine/collision\n    const isSolidAtPixel = (wx, wy, mapWidthTiles, mapHeightTiles, TILE_SIZE_OVERRIDE, tileDataOverride, registryItemsOverride, secretDataOverride, objectDataOverride, objectMetadataOverride, ignoreId) => {\n        return isSolidAtPixelExternal(\n            wx,\n            wy,\n            mapWidthTiles,\n            mapHeightTiles,\n            TILE_SIZE_OVERRIDE || TILE_SIZE,\n            tileDataOverride || tileData,\n            registryItemsOverride || registryItems,\n            secretDataOverride || secretData,\n            objectDataOverride || objectData,\n            objectMetadataOverride || objectMetadataRef.current || mapData?.meta?.objectMetadata,\n            entitiesRef.current,\n            ignoreId\n        );\n    };\n\n    // New: liquid type check at a world pixel\n    const getLiquidTypeAtPixel = (wx, wy, mapWidthTiles, mapHeightTiles) => {\n        const liq = getLiquidAtPixel(wx, wy, mapWidthTiles, mapHeightTiles, TILE_SIZE, tileData, registryItems);\n        return liq ? liq.type : null;\n    };\n\n    // Liquid sampling helper for update loop (AABB based)\n    const sampleLiquid = (aabb, mapWidthTiles, mapHeightTiles) => {\n        return sampleLiquidForAABB({\n            x: aabb.x,\n            y: aabb.y,\n            width: aabb.width,\n            height: aabb.height,\n            TILE_SIZE,\n            mapWidth: mapWidthTiles,\n            mapHeight: mapHeightTiles,\n            tileData,\n            registryItems\n        });\n    };\n\n    // Item collection  moved to GameEngine/collectItem\n\n    // Helper function: create new projectile  moved to separate module\n    const spawnProjectile = (originX, originY, direction, ownerId = 'player') => {\n        return spawnProjectileExternal({\n            findItemById,\n            TILE_SIZE,\n            parseBool,\n            projectilesRef,\n            projectileIdRef,\n            playShotSfx\n        }, originX, originY, direction, ownerId);\n    };\n\n    // Game Loop (delegated to GameEngine/updateFrame)\n    const update = (timestamp) => {\n        const ctx = {\n            mapData,\n            objectData,\n            input,\n            refs: { gameState, isInitialized, lastTimeRef, projectilesRef, entitiesRef, shootCooldownRef, liquidDamageAccumulatorRef, oxygenDepleteAccRef, lavaDepleteAccRef, weatherDamageAccRef },\n            constants: { TILE_SIZE, GRAVITY, TERMINAL_VELOCITY, MOVE_SPEED, JUMP_FORCE },\n            registryItems,\n            helpers: {\n                checkCollision,\n                getSurfaceProperties: (x, y, w, h, mw, mh, ts, td, ri) => getSurfaceProperties(x, y, w, h, mw, mh, ts, td, ri),\n                isLiquidAt: (wx, wy) => getLiquidTypeAtPixel(wx, wy, (mapData?.meta?.width || mapData?.width || 20), (mapData?.meta?.height || mapData?.height || 15)),\n                getLiquidSample: ({ x, y, width, height, TILE_SIZE: TS, mapWidth, mapHeight }) =>\n                    sampleLiquid({ x, y, width, height }, (mapData?.meta?.width || mapData?.width || 20), (mapData?.meta?.height || mapData?.height || 15))\n            },\n            actions: {\n                collectItem: (x, y, mapWidth, objectLayer) =>\n                    collectItem({ registryItems, TILE_SIZE, MAX_HEALTH, playShotSfx, onStateUpdate: onStateUpdateRef.current, gameState }, x, y, mapWidth, objectLayer),\n                checkInteractables: (x, y, mapWidth, objectLayer) =>\n                    checkInteractables({ registryItems, TILE_SIZE, MAX_HEALTH, playShotSfx, onStateUpdate: onStateUpdateRef.current, gameState, mapData, input }, x, y, mapWidth, objectLayer),\n                checkHazardDamage: (x, y, mapWidth, objectLayer, deltaMs) =>\n                    checkHazardDamageWrapper(x, y, mapWidth, objectLayer, deltaMs),\n                checkSecrets: (x, y, width, height, mapWidth, mapHeight) =>\n                    checkSecretsWrapper(x, y, width, height, mapWidth, mapHeight),\n                spawnProjectile: (originX, originY, direction, ownerId) =>\n                    spawnProjectile(originX, originY, direction, ownerId),\n                playSfx: (url, volume) => playShotSfx(url, volume),\n                updateProjectiles: (deltaMs, mapWidth, mapHeight) =>\n                    updateProjectiles({ \n                        projectilesRef, \n                        entitiesRef,\n                        playerState: gameState.current,\n                        TILE_SIZE, \n                        isSolidAtPixel, \n                        findItemById, \n                        objectData, \n                        objectMetadata: objectMetadataRef.current || mapData?.meta?.objectMetadata, \n                        onStateUpdate: onStateUpdateRef.current\n                    }, deltaMs, mapWidth, mapHeight),\n                setPlayer: (next) => setPlayer(next),\n                onGameOver: onGameOverRef.current\n            }\n        };\n        const res = updateFrame(ctx, timestamp);\n        if (res?.continue !== false) {\n            requestRef.current = requestAnimationFrame(update);\n        }\n    };\n\n    // Loop initialization / restart\n    useEffect(() => {\n        if (!mapData) return;\n        requestRef.current = requestAnimationFrame(update);\n        return () => {\n            if (requestRef.current) cancelAnimationFrame(requestRef.current);\n        };\n    }, [mapData, objectData]); // Restart loop if map or objects change\n\n    return player;\n};\n","import { useEffect, useRef } from 'react';\n\nexport const useInput = () => {\n    const keys = useRef({\n        w: false,\n        a: false,\n        s: false,\n        d: false,\n        space: false,\n        mouseLeft: false,\n        e: false\n    });\n\n    useEffect(() => {\n        const isTerminalOpen = () => {\n            try { return !!window.__GAME_TERMINAL_OPEN__; } catch { return false; }\n        };\n\n        const clearKeys = () => {\n            keys.current.w = false;\n            keys.current.a = false;\n            keys.current.s = false;\n            keys.current.d = false;\n            keys.current.space = false;\n            keys.current.mouseLeft = false;\n            keys.current.e = false;\n        };\n\n        const handleKeyDown = (e) => {\n            // Do not toggle when typing into inputs/textareas/contenteditable\n            const tag = (e.target && e.target.tagName) ? e.target.tagName.toUpperCase() : '';\n            const typing = tag === 'INPUT' || tag === 'TEXTAREA' || (e.target && e.target.isContentEditable);\n\n            // Toggle in-game terminal with 'T'\n            if (!typing && e.code === 'KeyT' && !e.repeat) {\n                try { window.dispatchEvent(new CustomEvent('game-toggle-terminal')); } catch {}\n                clearKeys();\n                // prevent game movement while toggling\n                if (typeof e.preventDefault === 'function') e.preventDefault();\n                return;\n            }\n\n            // Prevent browser scrolling / focus hijack for game controls only when NOT typing and terminal is closed\n            if (!typing && !isTerminalOpen()) {\n                switch (e.code) {\n                    case 'KeyW':\n                    case 'ArrowUp':\n                    case 'KeyA':\n                    case 'ArrowLeft':\n                    case 'KeyS':\n                    case 'ArrowDown':\n                    case 'KeyD':\n                    case 'ArrowRight':\n                    case 'Space':\n                        if (typeof e.preventDefault === 'function') e.preventDefault();\n                        break;\n                    default:\n                        break;\n                }\n            }\n\n            // If terminal is open, ignore gameplay inputs so player doesn't move while typing\n            if (isTerminalOpen()) return;\n\n            switch (e.code) {\n                case 'KeyW':\n                case 'ArrowUp':\n                    keys.current.w = true; break;\n                case 'KeyA':\n                case 'ArrowLeft':\n                    keys.current.a = true; break;\n                case 'KeyS':\n                case 'ArrowDown':\n                    keys.current.s = true; break;\n                case 'KeyD':\n                case 'ArrowRight':\n                    keys.current.d = true; break;\n                case 'KeyE':\n                    keys.current.e = true; break;\n                case 'Space': keys.current.space = true; break;\n                default: break;\n            }\n        };\n\n        const handleMouseDown = (e) => {\n            // Left button only\n            if (e.button !== 0) return;\n            if (isTerminalOpen()) return;\n            keys.current.mouseLeft = true;\n        };\n\n        const handleMouseUp = (e) => {\n            if (e.button !== 0) return;\n            if (isTerminalOpen()) return;\n            keys.current.mouseLeft = false;\n        };\n\n        const handleKeyUp = (e) => {\n            // Allow closing terminal with Escape (terminal component also handles it)\n            if (e.code === 'Escape') return;\n\n            if (isTerminalOpen()) {\n                // When terminal is open, we do not change gameplay key states here\n                return;\n            }\n\n            switch (e.code) {\n                case 'KeyW':\n                case 'ArrowUp':\n                    keys.current.w = false; break;\n                case 'KeyA':\n                case 'ArrowLeft':\n                    keys.current.a = false; break;\n                case 'KeyS':\n                case 'ArrowDown':\n                    keys.current.s = false; break;\n                case 'KeyD':\n                case 'ArrowRight':\n                    keys.current.d = false; break;\n                case 'KeyE':\n                    keys.current.e = false; break;\n                case 'Space': keys.current.space = false; break;\n                default: break;\n            }\n        };\n\n        const onToggleTerminal = () => clearKeys();\n\n        // non-passive to allow preventDefault on Space/Arrow keys\n        window.addEventListener('keydown', handleKeyDown, { passive: false });\n        window.addEventListener('keyup', handleKeyUp, { passive: false });\n        window.addEventListener('game-toggle-terminal', onToggleTerminal);\n        window.addEventListener('mousedown', handleMouseDown, { passive: true });\n        window.addEventListener('mouseup', handleMouseUp, { passive: true });\n\n        return () => {\n            window.removeEventListener('keydown', handleKeyDown, { passive: false });\n            window.removeEventListener('keyup', handleKeyUp, { passive: false });\n            window.removeEventListener('game-toggle-terminal', onToggleTerminal);\n            window.removeEventListener('mousedown', handleMouseDown, { passive: true });\n            window.removeEventListener('mouseup', handleMouseUp, { passive: true });\n        };\n    }, []);\n\n    return keys;\n};","// Hazard damage calculation (migrated from GameEngine/checkHazardDamage.js)\n\nexport function checkHazardDamage({\n  currentX,\n  currentY,\n  mapWidth,\n  objectLayerData,\n  deltaMs,\n  registryItems,\n  TILE_SIZE,\n  MOVE_SPEED,\n  JUMP_FORCE,\n  hazardDamageAccumulatorRef,\n  lastHazardIndexRef,\n  triggeredHazardsRef,\n  gameState\n}) {\n  if (!objectLayerData) {\n    hazardDamageAccumulatorRef.current = 0;\n    lastHazardIndexRef.current = null;\n    return;\n  }\n\n  const width = gameState.current.width;\n  const height = gameState.current.height;\n\n  // Player AABB in world pixels\n  const playerLeft = currentX;\n  const playerRight = currentX + width;\n  const playerTop = currentY;\n  const playerBottom = currentY + height;\n\n  // Overlapped tile rectangle (inclusive)\n  const minGX = Math.floor(playerLeft / TILE_SIZE);\n  const maxGX = Math.floor(playerRight / TILE_SIZE);\n  const minGY = Math.floor(playerTop / TILE_SIZE);\n  const maxGY = Math.floor(playerBottom / TILE_SIZE);\n\n  // Collect candidate hazards that match direction rules\n  const candidates = [];\n\n  const pushCandidate = (idx, def, touch) => {\n    const dirs = def.damageDirections || { top: true, bottom: true, left: true, right: true };\n    const ok = (touch.top && dirs.top) || (touch.bottom && dirs.bottom) || (touch.left && dirs.left) || (touch.right && dirs.right);\n    if (!ok) return;\n    candidates.push({ index: idx, def, touch });\n  };\n\n  for (let gy = minGY; gy <= maxGY; gy++) {\n    for (let gx = minGX; gx <= maxGX; gx++) {\n      const idx = gy * mapWidth + gx;\n      if (idx < 0 || idx >= objectLayerData.length) continue;\n      const objId = objectLayerData[idx];\n      if (!objId) continue;\n      const def = registryItems.find(r => r.id === objId);\n      if (!def || def.type !== 'hazard') continue;\n\n      const tileLeft = gx * TILE_SIZE;\n      const tileRight = tileLeft + TILE_SIZE;\n      const tileTop = gy * TILE_SIZE;\n      const tileBottom = tileTop + TILE_SIZE;\n\n      const overlapsHorizontally = playerRight >= tileLeft && playerLeft <= tileRight;\n      const overlapsVertically = playerBottom >= tileTop && playerTop <= tileBottom;\n      if (!overlapsHorizontally || !overlapsVertically) continue;\n\n      // Allow per-hazard touch margin; default 4px\n      let m = Number(def.touchMargin);\n      if (!Number.isFinite(m)) m = 4;\n      m = Math.max(1, Math.min(8, m));\n\n      let touchingTop = playerBottom >= tileTop && playerBottom <= tileTop + m;\n      let touchingBottom = playerTop <= tileBottom && playerTop >= tileBottom - m;\n      let touchingLeft = playerRight >= tileRight - m && playerRight <= tileRight;\n      let touchingRight = playerLeft <= tileLeft + m && playerLeft >= tileLeft;\n\n      // Fallback: infer side by smallest penetration when inside tile\n      if (!touchingTop && !touchingBottom && !touchingLeft && !touchingRight) {\n        const distTop = Math.abs(playerBottom - tileTop);\n        const distBottom = Math.abs(tileBottom - playerTop);\n        const distLeft = Math.abs(playerRight - tileLeft);\n        const distRight = Math.abs(tileRight - playerLeft);\n        const min = Math.min(distTop, distBottom, distLeft, distRight);\n        touchingTop = (min === distTop);\n        touchingBottom = (!touchingTop && min === distBottom);\n        touchingLeft = (!touchingTop && !touchingBottom && min === distLeft);\n        touchingRight = (!touchingTop && !touchingBottom && !touchingLeft);\n      }\n\n      pushCandidate(idx, def, { top: touchingTop, bottom: touchingBottom, left: touchingLeft, right: touchingRight });\n    }\n  }\n\n  if (candidates.length === 0) {\n    hazardDamageAccumulatorRef.current = 0;\n    lastHazardIndexRef.current = null;\n    return;\n  }\n\n  // Choose deterministic candidate: prefer top > bottom > left > right\n  const sideScore = (t) => (t.top ? 4 : 0) + (t.bottom ? 3 : 0) + (t.left ? 2 : 0) + (t.right ? 1 : 0);\n  candidates.sort((a, b) => sideScore(b.touch) - sideScore(a.touch));\n  const chosen = candidates[0];\n  const index = chosen.index;\n  const objDef = chosen.def;\n  const touch = chosen.touch;\n\n  // Update active hazard index\n  const prevIndex = lastHazardIndexRef.current;\n  lastHazardIndexRef.current = index;\n\n  const damageOnce = !!objDef.damageOnce;\n  const baseDamage = objDef.damage ?? 0;\n  const dps = objDef.damagePerSecond ?? baseDamage;\n\n  if (damageOnce) {\n    if (!triggeredHazardsRef.current.has(index)) {\n      triggeredHazardsRef.current.add(index);\n      gameState.current.health = Math.max(0, gameState.current.health - baseDamage);\n      // Hit flash to trigger temporary target animation\n      const HIT_FLASH_MS = 500;\n      const prev = Number(gameState.current.hitTimerMs) || 0;\n      gameState.current.hitTimerMs = Math.max(prev, HIT_FLASH_MS);\n      if (touch.top) {\n        gameState.current.vy = -JUMP_FORCE * 0.4;\n      } else if (touch.left) {\n        gameState.current.vx = -MOVE_SPEED * 1.5;\n      } else if (touch.right) {\n        gameState.current.vx = MOVE_SPEED * 1.5;\n      }\n      return;\n    }\n  } else {\n    // Continuous DPS: reset accumulator if we switched tiles\n    const firstTouch = prevIndex !== index;\n    if (firstTouch) {\n      // Immediate damage on first contact, then start ticking\n      hazardDamageAccumulatorRef.current = 0;\n      const immediate = Number.isFinite(baseDamage) && baseDamage > 0 ? baseDamage : dps;\n      if (immediate > 0) {\n        gameState.current.health = Math.max(0, gameState.current.health - immediate);\n        // Hit flash on immediate hit\n        const HIT_FLASH_MS = 500;\n        const prev = Number(gameState.current.hitTimerMs) || 0;\n        gameState.current.hitTimerMs = Math.max(prev, HIT_FLASH_MS);\n      }\n      // Skip DPS accumulation this same frame to avoid double damage on long frames\n      return;\n    }\n\n    hazardDamageAccumulatorRef.current += deltaMs;\n    const TICK_MS = 1000;\n    while (hazardDamageAccumulatorRef.current >= TICK_MS) {\n      hazardDamageAccumulatorRef.current -= TICK_MS;\n      gameState.current.health = Math.max(0, gameState.current.health - dps);\n      // Refresh hit timer on each damage tick\n      const HIT_FLASH_MS = 500;\n      const prev = Number(gameState.current.hitTimerMs) || 0;\n      gameState.current.hitTimerMs = Math.max(prev, HIT_FLASH_MS);\n    }\n  }\n}\n\nexport default null;\n","/**\n * Handles weather effect impacts like meteor strikes, lightning, etc.\n * This logic is decoupled from useGameEngine to allow for easier expansion.\n */\nexport const handleWeatherEffectHit = (type, data, context) => {\n    if (!type || !data || !context) return;\n    const { gameState, entitiesRef } = context;\n\n    if (type === 'meteor') {\n        const { x, y, size, isLarge } = data;\n        const damage = isLarge ? 40 : 20;\n        const radius = size * 1.5;\n\n        // 1. Check player impact\n        if (gameState && gameState.current) {\n            const p = gameState.current;\n            const dx = (p.x + p.width / 2) - x;\n            const dy = (p.y + p.height / 2) - y;\n            const dist = Math.sqrt(dx * dx + dy * dy);\n\n            if (dist < radius + p.width / 2) {\n                gameState.current.health = Math.max(0, (Number(gameState.current.health) || 0) - damage);\n                gameState.current.hitTimerMs = 500;\n                // Add knockback\n                if (dist > 0) {\n                    gameState.current.vx += (dx / dist) * 10;\n                    gameState.current.vy -= 5;\n                } else {\n                    gameState.current.vy -= 10; // direct hit\n                }\n            }\n        }\n\n        // 2. Check entities impact\n        if (entitiesRef && entitiesRef.current) {\n            entitiesRef.current.forEach(ent => {\n                const edx = (ent.x + ent.width / 2) - x;\n                const edy = (ent.y + ent.height / 2) - y;\n                const edist = Math.sqrt(edx * edx + edy * edy);\n\n                if (edist < radius + ent.width / 2) {\n                    ent.health = Math.max(0, (ent.health || 0) - damage);\n                    // Platforms don't take knockback, but others might\n                    if (ent.subtype !== 'platform') {\n                        if (edist > 0) {\n                            ent.vx += (edx / edist) * 8;\n                            ent.vy -= 3;\n                        } else {\n                            ent.vy -= 6;\n                        }\n                    }\n                }\n            });\n        }\n    }\n\n    // Future weather types can be added here\n    // e.g., if (type === 'lightning') { ... }\n};\n","// Projectile spawning extracted from useGameEngine.js\n\nexport function spawnProjectile(ctx, originX, originY, direction, ownerId = 'player') {\n  const { findItemById, TILE_SIZE, parseBool, projectilesRef, projectileIdRef, playShotSfx } = ctx;\n\n  const pDef = findItemById('fireball_basic');\n  const id = projectileIdRef.current++;\n  const w = Math.max(2, ((pDef?.width || 0.25) * TILE_SIZE));\n  const h = Math.max(2, ((pDef?.height || 0.25) * TILE_SIZE));\n  const speedPxPerSec = (pDef?.speed ? pDef.speed * 60 : 14 * 60);\n  const vx = (direction >= 0 ? 1 : -1) * speedPxPerSec;\n  const vy = 0;\n  const life = Math.max(200, pDef?.lifespan || 600);\n  const ricochetFlag = (typeof pDef?.ricochetOnTiles !== 'undefined')\n    ? !!pDef.ricochetOnTiles\n    : parseBool(pDef?.collisionWithPenetration, true);\n\n  const proj = {\n    id,\n    ownerId, // Tagad ms zinm, kur izva\n    x: originX,\n    y: originY,\n    vx,\n    vy,\n    w,\n    h,\n    life,\n    defId: pDef?.id || 'fireball_basic',\n    dir: direction >= 0 ? 1 : -1,\n    cwt: !!(pDef && pDef.collisionWithTiles),\n    hbs: Math.max(0.1, Math.min(1.0, (pDef?.hitboxScale ?? 1))),\n    ric: ricochetFlag,\n    dmg: pDef?.damage || 10\n  };\n  projectilesRef.current.push(proj);\n\n  try {\n    const vol = Math.max(0, Math.min(1, pDef?.sfxVolume ?? 1));\n    playShotSfx(pDef?.sfx, vol);\n  } catch {}\n}\n","// Item collection extracted from useGameEngine.js\n\n// Collects item under player's center if pickup-able.\n// Args (ctx): { registryItems, TILE_SIZE, MAX_HEALTH, playShotSfx, onStateUpdate, gameState }\n// Params: currentX, currentY, mapWidth, objectLayerData\nexport function collectItem(ctx, currentX, currentY, mapWidth, objectLayerData) {\n  const { registryItems, TILE_SIZE, MAX_HEALTH, playShotSfx, onStateUpdate, gameState } = ctx;\n  if (!objectLayerData) return;\n\n  const centerX = currentX + gameState.current.width / 2;\n  const centerY = currentY + gameState.current.height / 2;\n\n  const gridX = Math.floor(centerX / TILE_SIZE);\n  const gridY = Math.floor(centerY / TILE_SIZE);\n  const index = gridY * mapWidth + gridX;\n  if (index < 0 || index >= objectLayerData.length) return;\n\n  const itemId = objectLayerData[index];\n  if (!itemId) return;\n\n  const itemDef = registryItems.find(r => r.id === itemId);\n  if (!itemDef || !itemDef.pickup || itemId.includes('player')) return;\n\n  // Skip interactables - they are handled by checkInteractables()\n  if (itemDef.name && itemDef.name.startsWith('interactable.')) return;\n\n  // Health pickup\n  if (itemDef.effect && itemDef.effect.health) {\n    const healthBonus = parseInt(itemDef.effect.health, 10);\n    if (gameState.current.health >= MAX_HEALTH) return;\n    const newHealth = Math.min(gameState.current.health + healthBonus, MAX_HEALTH);\n    gameState.current.health = newHealth;\n    try {\n      const vol = Math.max(0, Math.min(1, itemDef?.sfxVolume ?? 1));\n      playShotSfx(itemDef?.sfx, vol);\n    } catch {}\n    if (onStateUpdate) onStateUpdate('collectItem', index);\n    return;\n  }\n\n  // Fireball ammo pickup\n  if (itemDef.effect && itemDef.effect.fireball) {\n    const ammoBonus = parseInt(itemDef.effect.fireball, 10) || 0;\n    gameState.current.ammo = Math.max(0, (gameState.current.ammo || 0) + ammoBonus);\n    try {\n      const vol = Math.max(0, Math.min(1, itemDef?.sfxVolume ?? 1));\n      playShotSfx(itemDef?.sfx, vol);\n    } catch {}\n    if (onStateUpdate) onStateUpdate('collectItem', index);\n    return;\n  }\n}\n","// Interactables logic - objects that can be used once and change state\n// Unlike items (which disappear), interactables stay but change texture\n\nexport function checkInteractables(ctx, currentX, currentY, mapWidth, objectLayerData) {\n  const { registryItems, TILE_SIZE, MAX_HEALTH, playShotSfx, onStateUpdate, gameState, mapData } = ctx;\n  if (!objectLayerData) return;\n\n  const keys = ctx.input?.current || {};\n\n  const centerX = currentX + gameState.current.width / 2;\n  const centerY = currentY + gameState.current.height / 2;\n\n  const gridX = Math.floor(centerX / TILE_SIZE);\n  const gridY = Math.floor(centerY / TILE_SIZE);\n  let index = gridY * mapWidth + gridX;\n\n  // If \"E\" is pressed, also check one tile in front of the player\n  // This allows interacting with solid objects (like pushable walls) that the player can't overlap with\n  if (keys.e) {\n      const dir = gameState.current.direction || 1; // 1 for right, -1 for left\n      const frontX = centerX + dir * (TILE_SIZE * 0.8);\n      const frontGridX = Math.floor(frontX / TILE_SIZE);\n      const frontIndex = gridY * mapWidth + frontGridX;\n      \n      if (frontIndex >= 0 && frontIndex < objectLayerData.length) {\n          const frontObjId = objectLayerData[frontIndex];\n          if (frontObjId) {\n              const frontDef = registryItems.find(r => r.id === frontObjId);\n              // Priority given to wolf_secret if found in front\n              if (frontDef && frontDef.type === 'wolf_secret') {\n                  index = frontIndex;\n              }\n          }\n      }\n  }\n\n  // 1. Check direct tile first (priority)\n  let foundIndex = -1;\n  const directObjId = objectLayerData[index];\n  if (directObjId) {\n    foundIndex = index;\n  } else {\n    // 2. Check if we are inside any property region\n    const metadata = mapData?.meta?.objectMetadata;\n    if (metadata) {\n      for (const [idxStr, meta] of Object.entries(metadata)) {\n        const idx = parseInt(idxStr);\n        const w = meta.width || 1;\n        const h = meta.height || 1;\n        if (w > 1 || h > 1) {\n          const ox = idx % mapWidth;\n          const oy = Math.floor(idx / mapWidth);\n          if (gridX >= ox && gridX < ox + w && gridY >= oy && gridY < oy + h) {\n            // Check if there's actually an object at this base index\n            if (objectLayerData[idx]) {\n              foundIndex = idx;\n              break; \n            }\n          }\n        }\n      }\n    }\n  }\n\n  if (foundIndex === -1) return;\n  const actualIndex = foundIndex;\n\n  const metadata = mapData?.meta?.objectMetadata;\n  const currentMeta = metadata?.[actualIndex];\n\n  const objId = objectLayerData[actualIndex];\n  if (!objId) return;\n\n  const objDef = registryItems.find(r => r.id === objId);\n  if (!objDef) return;\n\n  // Check for Weather Trigger logic (triggers when walking over it)\n  if (objDef.type === 'weather_trigger') {\n      const weatherType = objDef.weatherType; // rain, snow, clouds, fog, thunder\n      const action = objDef.weatherAction; // on, off, set\n      let value = 0;\n      \n      if (action === 'set' || action === 'on') {\n          value = currentMeta?.intensity !== undefined ? currentMeta.intensity : (action === 'on' ? 1 : 50);\n      } else if (action === 'off') {\n          value = 0; // In runtime settings, 0 means off\n      }\n      \n      if (!gameState.current.lastWeatherTrigger) {\n          gameState.current.lastWeatherTrigger = {};\n      }\n      \n      const lastVal = gameState.current.lastWeatherTrigger[actualIndex];\n      if (lastVal !== value) {\n          if (onStateUpdate) {\n              onStateUpdate('updateWeather', {\n                  type: weatherType,\n                  value: value\n              });\n          }\n          gameState.current.lastWeatherTrigger[actualIndex] = value;\n          \n          if (objDef.sfx) {\n              try {\n                  playShotSfx(objDef.sfx, objDef.sfxVolume || 0.5);\n              } catch {}\n          }\n      }\n      return;\n  }\n\n  // Check for Message Trigger logic\n  if (objDef.type === 'message_trigger') {\n      const message = currentMeta?.message;\n      if (!message) return;\n\n      if (!gameState.current.lastMessageTrigger) {\n          gameState.current.lastMessageTrigger = {};\n      }\n\n      const lastMsg = gameState.current.lastMessageTrigger[actualIndex];\n      if (lastMsg !== message) {\n          if (onStateUpdate) {\n              onStateUpdate('showMessage', {\n                  text: message,\n                  duration: 8000 // 8 sekundes\n              });\n          }\n          gameState.current.lastMessageTrigger[actualIndex] = message;\n          \n          if (objDef.sfx) {\n              try {\n                  playShotSfx(objDef.sfx, objDef.sfxVolume || 0.5);\n              } catch {}\n          }\n      }\n      return;\n  }\n\n  // Check for Wolfenstein Secret logic (push wall on \"E\")\n  if (objDef.type === 'wolf_secret') {\n      if (!keys.e) return;\n\n      if (!gameState.current.lastETime) gameState.current.lastETime = 0;\n      const now = Date.now();\n      if (now - gameState.current.lastETime < 1000) return; // 1s debounce\n      \n      gameState.current.lastETime = now;\n\n      if (onStateUpdate) {\n          const dx = objDef.moveX || 0;\n          const dy = objDef.moveY || 0;\n          onStateUpdate('shiftTile', { index, dx, dy });\n        \n          if (objDef.sfx) {\n              try { playShotSfx(objDef.sfx, objDef.sfxVolume || 0.5); } catch {}\n          }\n      }\n      return;\n  }\n\n  if (!objDef.name || !objDef.name.startsWith('interactable.')) return;\n\n  // Check for Teleport logic\n  if (objId.includes('portal') && currentMeta && currentMeta.triggerId !== undefined && currentMeta.triggerId !== null) {\n      // 1. Check for cross-map teleport\n      const targetMapId = currentMeta.targetMapId;\n      const maps = mapData?.maps || mapData?.projectMaps; // Try to find project maps\n\n      if (targetMapId && maps && maps[targetMapId]) {\n          // TELEPORT!\n          if (onStateUpdate) {\n              onStateUpdate('switchMap', {\n                  targetMapId: targetMapId,\n                  triggerId: currentMeta.triggerId\n              });\n              \n              // Play sound\n              try {\n                  const vol = Math.max(0, Math.min(1, objDef?.sfxVolume ?? 1));\n                  playShotSfx(objDef?.sfx || \"/assets/sound/sfx/teleport.ogg\", vol);\n              } catch {}\n              return;\n          }\n      }\n\n      // 2. Internal teleport (find destination on same map)\n      for (let i = 0; i < objectLayerData.length; i++) {\n          if (i === index) continue;\n          const destId = objectLayerData[i];\n          if (destId && (destId.includes('target') || destId === 'portal_target')) {\n              const destMeta = metadata?.[i];\n              if (destMeta && destMeta.triggerId === currentMeta.triggerId) {\n                  // TELEPORT!\n                  const tx = (i % mapWidth) * TILE_SIZE;\n                  const ty = Math.floor(i / mapWidth) * TILE_SIZE;\n                  \n                  // Move player to target\n                  gameState.current.x = tx;\n                  gameState.current.y = ty;\n                  \n                  // Play sound\n                  try {\n                      const vol = Math.max(0, Math.min(1, objDef?.sfxVolume ?? 1));\n                      playShotSfx(objDef?.sfx || \"/assets/sound/sfx/teleport.ogg\", vol);\n                  } catch {}\n\n                  // For teleport we don't necessarily mark as used if we want multi-use\n                  // but if the user wants it to disappear/change state, we can.\n                  // For now, let's just teleport.\n                  return;\n              }\n          }\n      }\n  }\n\n  // Check for End Level logic\n  if (objDef.subtype === 'end' && !gameState.current.isWinning) {\n    gameState.current.isWinning = true;\n    gameState.current.winCounter = 0;\n    gameState.current.winCountSpeed = objDef.winCountSpeed || 10;\n    return;\n  }\n\n  // Check if already used (track used interactables in gameState)\n  if (!gameState.current.usedInteractables) {\n    gameState.current.usedInteractables = new Set();\n  }\n\n  if (gameState.current.usedInteractables.has(index)) return; // Already used\n\n  // Check if has effect\n  if (!objDef.effect) return;\n\n  // Health effect\n  if (objDef.effect.health) {\n    const healthBonus = parseInt(objDef.effect.health, 10);\n    if (gameState.current.health >= MAX_HEALTH) return; // Don't use if already full health\n\n    const newHealth = Math.min(gameState.current.health + healthBonus, MAX_HEALTH);\n    gameState.current.health = newHealth;\n\n    // Play sound\n    try {\n      const vol = Math.max(0, Math.min(1, objDef?.sfxVolume ?? 1));\n      playShotSfx(objDef?.sfx, vol);\n    } catch {}\n\n    // Mark as used\n    gameState.current.usedInteractables.add(index);\n\n    // Notify state update with 'interactable' event - this will switch to next texture\n    if (onStateUpdate) onStateUpdate('interactable', index);\n    return;\n  }\n\n  // Future: Add other interactable effects (ammo, etc.)\n  if (objDef.effect.fireball) {\n    const ammoBonus = parseInt(objDef.effect.fireball, 10) || 0;\n    gameState.current.ammo = Math.max(0, (gameState.current.ammo || 0) + ammoBonus);\n\n    try {\n      const vol = Math.max(0, Math.min(1, objDef?.sfxVolume ?? 1));\n      playShotSfx(objDef?.sfx, vol);\n    } catch {}\n\n    gameState.current.usedInteractables.add(index);\n    if (onStateUpdate) onStateUpdate('interactable', index);\n    return;\n  }\n}\n","// Projectile update and ricochet simulation extracted from useGameEngine.js\n\n// ctx: { projectilesRef, entitiesRef, playerState, TILE_SIZE, isSolidAtPixel, findItemById, objectData, objectMetadata, onStateUpdate }\n// updateProjectiles(ctx, deltaMs, mapWidth, mapHeight)\nexport function updateProjectiles(ctx, deltaMs, mapWidth, mapHeight) {\n  const { projectilesRef, entitiesRef, playerState, TILE_SIZE, isSolidAtPixel, findItemById, objectData, objectMetadata, onStateUpdate } = ctx;\n  const dtProj = deltaMs / 1000;\n  const worldW = mapWidth * TILE_SIZE;\n  const worldH = mapHeight * TILE_SIZE;\n\n  const isSolidRect = (cx, cy, hw, hh) => {\n    const pts = [\n      { x: cx - hw, y: cy - hh },\n      { x: cx + hw, y: cy - hh },\n      { x: cx - hw, y: cy + hh },\n      { x: cx + hw, y: cy + hh },\n    ];\n    for (let k = 0; k < pts.length; k++) {\n      const pt = pts[k];\n      // Updated isSolidAtPixel call with all necessary layers\n      if (isSolidAtPixel(pt.x, pt.y, mapWidth, mapHeight, TILE_SIZE, null, null, null, objectData, objectMetadata)) return true;\n    }\n    return false;\n  };\n\n  const checkObjectHit = (cx, cy, hw, hh) => {\n    if (!objectData) return null;\n    const pts = [\n        { x: cx - hw, y: cy - hh },\n        { x: cx + hw, y: cy - hh },\n        { x: cx - hw, y: cy + hh },\n        { x: cx + hw, y: cy + hh },\n        { x: cx, y: cy }\n    ];\n    for (const pt of pts) {\n        const gx = Math.floor(pt.x / TILE_SIZE);\n        const gy = Math.floor(pt.y / TILE_SIZE);\n        if (gx < 0 || gy < 0 || gx >= mapWidth || gy >= mapHeight) continue;\n        const index = gy * mapWidth + gx;\n        const objId = objectData[index];\n        if (objId) {\n            const def = findItemById(objId);\n            if (def && def.isDestructible) {\n                // Check if already passable\n                const currentMeta = objectMetadata?.[index] || {};\n                const health = currentMeta.health !== undefined ? currentMeta.health : def.maxHealth;\n                if (health > (def.passableHealthThreshold || 0)) {\n                    return index;\n                }\n            }\n        }\n    }\n    return null;\n  };\n\n  const checkEntityHit = (cx, cy, hw, hh, p) => {\n    if (!entitiesRef?.current) return null;\n    for (const ent of entitiesRef.current) {\n        if (ent.health <= 0 || ent.isExploding) continue;\n        if (ent.id === p.ownerId) continue; // Ignorjam izvju\n\n        const ex = ent.x;\n        const ey = ent.y;\n        const ew = ent.width;\n        const eh = ent.height;\n        if (cx + hw > ex && cx - hw < ex + ew &&\n            cy + hh > ey && cy - hh < ey + eh) {\n            return ent;\n        }\n    }\n    return null;\n  };\n\n  const checkPlayerHit = (cx, cy, hw, hh, p) => {\n    if (!playerState || p.ownerId === 'player') return false; // Ignorjam, ja izva spltjs\n    \n    const ex = playerState.x;\n    const ey = playerState.y;\n    const ew = playerState.width || TILE_SIZE;\n    const eh = playerState.height || TILE_SIZE;\n    if (cx + hw > ex && cx - hw < ex + ew &&\n        cy + hh > ey && cy - hh < ey + eh) {\n        return true;\n    }\n    return false;\n  };\n\n  if (!projectilesRef.current.length) return;\n\n  for (let i = projectilesRef.current.length - 1; i >= 0; i--) {\n    const p = projectilesRef.current[i];\n\n    if (p.bounces == null) p.bounces = 0;\n    const maxBounces = Number.isFinite(p.maxBounces)\n      ? p.maxBounces\n      : (findItemById(p.defId)?.maxBounces ?? 3);\n    const bounceDamp = Number.isFinite(p.bounceDamping)\n      ? p.bounceDamping\n      : (findItemById(p.defId)?.bounceDamping ?? 0.6);\n    const ricRand = Number.isFinite(p.ricochetRandom)\n      ? p.ricochetRandom\n      : (findItemById(p.defId)?.ricochetRandom ?? 0.15);\n\n    const maxDelta = Math.max(Math.abs(p.vx * dtProj), Math.abs(p.vy * dtProj));\n    let steps = Math.ceil(maxDelta / 4);\n    if (!Number.isFinite(steps) || steps < 1) steps = 1;\n    steps = Math.min(steps, 20);\n    const stepTime = dtProj / steps;\n\n    let cx = p.x;\n    let cy = p.y;\n    const hw = (p.w * (p.hbs || 1)) * 0.5;\n    const hh = (p.h * (p.hbs || 1)) * 0.5;\n\n    let removed = false;\n\n    for (let s = 0; s < steps; s++) {\n      // 1) X axis\n      let nextX = cx + p.vx * stepTime;\n      \n      const hitPlayerX = checkPlayerHit(nextX, cy, hw, hh, p);\n      if (hitPlayerX) {\n        if (playerState) {\n          playerState.health = Math.max(0, (Number(playerState.health) || 0) - (p.dmg || 10));\n        }\n        if (onStateUpdate) onStateUpdate('playerDamage', { damage: p.dmg || 10 });\n        removed = true;\n        break;\n      }\n\n      const hitEntX = checkEntityHit(nextX, cy, hw, hh, p);\n      if (hitEntX) {\n        hitEntX.health -= p.dmg || 10;\n        removed = true;\n        break;\n      }\n\n      const hitIdxX = checkObjectHit(nextX, cy, hw, hh);\n      if (hitIdxX !== null) {\n        if (onStateUpdate) onStateUpdate('objectDamage', { index: hitIdxX, damage: p.dmg || 10 });\n        removed = true;\n        break;\n      }\n\n      if (p.cwt && isSolidRect(nextX, cy, hw, hh)) {\n        if (p.ric) {\n          p.vx = -p.vx * bounceDamp;\n          const sp = Math.max(40, Math.hypot(p.vx, p.vy));\n          const jitter = (Math.random() * 2 - 1) * sp * ricRand;\n          p.vy += jitter * 0.15;\n          p.bounces += 1;\n          p.life = Math.max(0, p.life - 80);\n        } else {\n          removed = true;\n          break;\n        }\n      } else {\n        cx = nextX;\n      }\n\n      // 2) Y axis\n      let nextY = cy + p.vy * stepTime;\n      \n      const hitPlayerY = checkPlayerHit(cx, nextY, hw, hh, p);\n      if (hitPlayerY) {\n        if (playerState) {\n          playerState.health = Math.max(0, (Number(playerState.health) || 0) - (p.dmg || 10));\n        }\n        if (onStateUpdate) onStateUpdate('playerDamage', { damage: p.dmg || 10 });\n        removed = true;\n        break;\n      }\n\n      const hitEntY = checkEntityHit(cx, nextY, hw, hh, p);\n      if (hitEntY) {\n        hitEntY.health -= p.dmg || 10;\n        removed = true;\n        break;\n      }\n\n      const hitIdxY = checkObjectHit(cx, nextY, hw, hh);\n      if (hitIdxY !== null) {\n        if (onStateUpdate) onStateUpdate('objectDamage', { index: hitIdxY, damage: p.dmg || 10 });\n        removed = true;\n        break;\n      }\n\n      if (p.cwt && isSolidRect(cx, nextY, hw, hh)) {\n        if (p.ric) {\n          p.vy = -p.vy * bounceDamp;\n          const sp = Math.max(40, Math.hypot(p.vx, p.vy));\n          const jitter = (Math.random() * 2 - 1) * sp * ricRand;\n          p.vx += jitter * 0.15;\n          p.bounces += 1;\n          p.life = Math.max(0, p.life - 80);\n        } else {\n          removed = true;\n          break;\n        }\n      } else {\n        cy = nextY;\n      }\n\n      // 3) Corner stuck safeguard\n      if (p.cwt && isSolidRect(cx, cy, hw, hh)) {\n        if (p.ric) {\n          p.vx = -p.vx * bounceDamp;\n          p.vy = -p.vy * bounceDamp;\n          p.bounces += 1;\n          cx -= Math.sign(p.vx || 1) * 0.5;\n          cy -= Math.sign(p.vy || 1) * 0.5;\n        } else {\n          removed = true;\n          break;\n        }\n      }\n    }\n\n    p.x = cx;\n    p.y = cy;\n\n    p.life -= deltaMs;\n    if (\n      p.life <= 0 ||\n      p.x < -32 ||\n      p.y < -32 ||\n      p.x > worldW + 32 ||\n      p.y > worldH + 32 ||\n      removed ||\n      (p.bounces || 0) > (maxBounces || 0)\n    ) {\n      projectilesRef.current.splice(i, 1);\n      continue;\n    }\n  }\n}\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport styled from 'styled-components';\n\nconst HeaderContainer = styled.div`\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: auto;\n    background-color: rgba(0, 0, 0, 0.3);\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 0 20px;\n    box-sizing: border-box;\n    z-index: 1000;\n    pointer-events: none;\n`;\n\nconst AmmoDisplay = styled.div`\n    font-size: 28px;\n    font-weight: bold;\n    color: rgba(255, 200, 50, 0.95);\n    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);\n    font-family: monospace;\n    pointer-events: none;\n`;\n\nconst RightSection = styled.div`\n    display: flex;\n    flex-direction: column;\n    align-items: flex-end;\n    //gap: 8px;\n`;\n\nconst BarsContainer = styled.div`\n    display: flex;\n    flex-direction: column;\n    //gap: 1px;\n    width: 250px;\n    padding-top: 5px;\n    padding-bottom: 5px;\n   // border: solid 1px red;\n`;\n\nconst BarRow = styled.div`\n    display: flex;\n    align-items: center;\n    gap: 6px;\n    width: 100%;\n`;\n\nconst BarWrapper = styled.div`\n    flex: 1;\n    height: 6px;\n    background-color: rgba(0, 0, 0, 0.5);\n    border: 1px solid rgba(255, 255, 255, 0.4);\n    position: relative;\n    box-shadow: inset 0 0 0 1px rgba(0,0,0,0.1);\n`;\n\nconst BarFill = styled.div.attrs(props => ({\n    style: {\n        width: `${props.$percent}%`,\n        backgroundColor: props.$color,\n    },\n}))`\n    height: 100%;\n    transition: width 0.3s ease;\n`;\n\nconst BarLabel = styled.div`\n    width: 60px;\n    font-size: 8px;\n    color: white;\n    font-weight: bold;\n    text-shadow: 1px 1px 2px black;\n    pointer-events: none;\n    white-space: nowrap;\n    text-transform: uppercase;\n    text-align: right;\n`;\n\nconst GameHeader = ({ \n    health, \n    maxHealth = 100, \n    ammo = 0, \n    oxygen = 100, \n    maxOxygen = 100, \n    lavaResist = 100, \n    maxLavaResist = 100,\n    iceResist = 100,\n    maxIceResist = 100,\n    strength = 30,\n    maxStrength = 100,\n    radioactivity = 20,\n    maxRadioactivity = 100,\n    inWater = false,\n    liquidType = null,\n    onIce = false\n}) => {\n    const hpPercent = Math.max(0, Math.min(100, (health / maxHealth) * 100));\n    const oxyPercent = Math.max(0, Math.min(100, (oxygen / maxOxygen) * 100));\n    const lavaPercent = Math.max(0, Math.min(100, (lavaResist / maxLavaResist) * 100));\n    const icePercent = Math.max(0, Math.min(100, (iceResist / maxIceResist) * 100));\n    const strengthPercent = Math.max(0, Math.min(100, (strength / maxStrength) * 100));\n    const radioPercent = Math.max(0, Math.min(100, (radioactivity / maxRadioactivity) * 100));\n\n    return (\n        <HeaderContainer>\n            <AmmoDisplay>\n                 {ammo || 0}\n            </AmmoDisplay>\n\n            <RightSection>\n                <BarsContainer>\n                    {/* HP Bar */}\n                    <BarRow>\n                        <BarLabel>HP</BarLabel>\n                        <BarWrapper>\n                            <BarFill $percent={hpPercent} $color=\"#ff3232\" />\n                        </BarWrapper>\n                    </BarRow>\n\n                    {/* Oxygen Bar */}\n                    <BarRow>\n                        <BarLabel>OZ</BarLabel>\n                        <BarWrapper>\n                            <BarFill $percent={oxyPercent} $color=\"#2ecdf1\" />\n                        </BarWrapper>\n                    </BarRow>\n\n                    {/* Lava Bar */}\n                    <BarRow>\n                        <BarLabel>LAVA</BarLabel>\n                        <BarWrapper>\n                            <BarFill $percent={lavaPercent} $color=\"#ffcc00\" />\n                        </BarWrapper>\n                    </BarRow>\n\n                    {/* Ice Bar */}\n                    <BarRow>\n                        <BarLabel>ICE</BarLabel>\n                        <BarWrapper>\n                            <BarFill $percent={icePercent} $color=\"#a5f3fc\" />\n                        </BarWrapper>\n                    </BarRow>\n\n                    {/* Strength Bar */}\n                    <BarRow>\n                        <BarLabel>STRNGTH</BarLabel>\n                        <BarWrapper>\n                            <BarFill $percent={strengthPercent} $color=\"#eab308\" />\n                        </BarWrapper>\n                    </BarRow>\n\n                    {/* Radioactivity Bar */}\n                    <BarRow>\n                        <BarLabel>RADIO</BarLabel>\n                        <BarWrapper>\n                            <BarFill $percent={radioPercent} $color=\"#32cd32\" />\n                        </BarWrapper>\n                    </BarRow>\n                </BarsContainer>\n            </RightSection>\n        </HeaderContainer>\n    );\n};\n\nGameHeader.propTypes = {\n    health: PropTypes.number.isRequired,\n    maxHealth: PropTypes.number,\n    ammo: PropTypes.number,\n    oxygen: PropTypes.number,\n    maxOxygen: PropTypes.number,\n    lavaResist: PropTypes.number,\n    maxLavaResist: PropTypes.number,\n    iceResist: PropTypes.number,\n    maxIceResist: PropTypes.number,\n    strength: PropTypes.number,\n    maxStrength: PropTypes.number,\n    radioactivity: PropTypes.number,\n    maxRadioactivity: PropTypes.number,\n    inWater: PropTypes.bool,\n    liquidType: PropTypes.string,\n    onIce: PropTypes.bool\n};\n\nexport default GameHeader;","// Simple command registry for in-game terminal\n// Each command: { name, description, handler(input, ctx) => string | void }\n\nconst commands = [];\n\nconst register = (cmd) => {\n  if (!cmd || !cmd.name) return;\n  commands.push(cmd);\n};\n\nexport const listCommands = () => commands.map(c => ({ name: c.name, description: c.description }));\n\nexport const executeCommand = (input, context = {}) => {\n  const raw = String(input || '').trim();\n  if (!raw) return '';\n  const [name, ...args] = raw.split(/\\s+/);\n  const cmd = commands.find(c => c.name.toLowerCase() === name.toLowerCase());\n  if (!cmd) {\n    return `Unknown command: ${name}. Type 'help' to list commands.`;\n  }\n  try {\n    const res = cmd.handler({ args, raw, context });\n    return typeof res === 'string' ? res : '';\n  } catch (e) {\n    return `Error executing '${name}': ${e?.message || e}`;\n  }\n};\n\n// Built-in: help\nregister({\n  name: 'help',\n  description: 'Show available commands',\n  handler() {\n    const list = listCommands()\n      .map(c => `- ${c.name}${c.description ? `: ${c.description}` : ''}`)\n      .join('\\n');\n    return list || 'No commands available.';\n  }\n});\n\n// Built-in: clear\nregister({\n  name: 'clear',\n  description: 'Clear terminal output',\n  handler() {\n    // Signal to UI to clear output; UI can interpret special token\n    try { window.dispatchEvent(new CustomEvent('game-terminal-clear')); } catch {}\n    return '';\n  }\n});\n\n// First requested command: settings\nregister({\n  name: 'settings',\n  description: \"Open the draggable game settings window\",\n  handler() {\n    try { \n      window.dispatchEvent(new CustomEvent('game-open-settings'));\n      // Also close terminal automatically when opening settings\n      window.dispatchEvent(new CustomEvent('game-close-terminal'));\n    } catch {}\n    return 'Opening settings...';\n  }\n});\n\nexport default {\n  register,\n  listCommands,\n  executeCommand,\n};\n","import React, { useEffect, useRef, useState } from 'react';\nimport { executeCommand } from '../../../commands/gameCommands';\n\nconst panelStyleBase = {\n  position: 'fixed',\n  left: 0,\n  right: 0,\n  bottom: 0,\n  height: '220px',\n  backgroundColor: 'rgba(10, 10, 10, 0.95)',\n  color: '#d6d6d6',\n  fontFamily: 'ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, \"Liberation Mono\", \"Courier New\", monospace',\n  fontSize: '12px',\n  borderTop: '1px solid #333',\n  boxShadow: '0 -6px 16px rgba(0,0,0,0.5)',\n  display: 'flex',\n  flexDirection: 'column',\n  zIndex: 3000,\n  transition: 'transform 160ms ease',\n};\n\nexport default function GameTerminal() {\n  const [open, setOpen] = useState(false);\n  const [lines, setLines] = useState([\"Type 'help' to list commands. Press ESC to close.\"]);\n  const [input, setInput] = useState('');\n  const scrollRef = useRef(null);\n  const inputRef = useRef(null);\n  const suppressUntilRef = useRef(0);\n  const suppressActiveRef = useRef(false);\n\n  // Toggle handler from global events\n  useEffect(() => {\n    const onToggle = () => setOpen(prev => !prev);\n    const onClear = () => setLines([]);\n    const onClose = () => setOpen(false);\n    window.addEventListener('game-toggle-terminal', onToggle);\n    window.addEventListener('game-terminal-clear', onClear);\n    window.addEventListener('game-close-terminal', onClose);\n    return () => {\n      window.removeEventListener('game-toggle-terminal', onToggle);\n      window.removeEventListener('game-terminal-clear', onClear);\n      window.removeEventListener('game-close-terminal', onClose);\n    };\n  }, []);\n\n  // Track open state globally so input hook can disable movement\n  useEffect(() => {\n    try { window.__GAME_TERMINAL_OPEN__ = open; } catch {}\n    if (open) {\n      // Clear any previous text and suppress initial keystrokes that were held during gameplay\n      setInput('');\n      try { suppressUntilRef.current = (typeof performance !== 'undefined' ? performance.now() : Date.now()) + 220; } catch { suppressUntilRef.current = Date.now() + 220; }\n      setTimeout(() => inputRef.current && inputRef.current.focus(), 0);\n    }\n  }, [open]);\n\n  // Close with ESC when focused\n  useEffect(() => {\n    const onKey = (e) => {\n      if (!open) return;\n      if (e.key === 'Escape') {\n        setOpen(false);\n      }\n    };\n    window.addEventListener('keydown', onKey);\n    return () => window.removeEventListener('keydown', onKey);\n  }, [open]);\n\n  // Auto-scroll to bottom when lines change\n  useEffect(() => {\n    if (!scrollRef.current) return;\n    scrollRef.current.scrollTop = scrollRef.current.scrollHeight;\n  }, [lines, open]);\n\n  const onSubmit = (e) => {\n    e.preventDefault();\n    const value = input.trim();\n    if (!value) return;\n    setLines(prev => [...prev, `> ${value}`]);\n    const res = executeCommand(value, {});\n    if (res) setLines(prev => [...prev, res]);\n    setInput('');\n  };\n\n  const style = {\n    ...panelStyleBase,\n    transform: open ? 'translateY(0)' : 'translateY(100%)',\n  };\n\n  return (\n    <div style={style} aria-hidden={!open}>\n      <div style={{ padding: '6px 8px', borderBottom: '1px solid #333', color: '#9cdcfe' }}>\n        In-Game Terminal  press T to toggle\n      </div>\n      <div ref={scrollRef} style={{ flex: 1, overflowY: 'auto', padding: '8px 10px', whiteSpace: 'pre-wrap', lineHeight: 1.4 }}>\n        {lines.map((l, i) => (\n          <div key={i} style={{ color: l.startsWith('>') ? '#dcdcaa' : '#d6d6d6' }}>{l}</div>\n        ))}\n      </div>\n      <form onSubmit={onSubmit} style={{ display: 'flex', gap: '6px', padding: '8px', borderTop: '1px solid #333' }}>\n        <span style={{ color: '#6a9955' }}>$</span>\n        <input\n          ref={inputRef}\n          value={input}\n          onKeyDown={(e) => {\n            const now = (typeof performance !== 'undefined' ? performance.now() : Date.now());\n            if (now < (suppressUntilRef.current || 0) && e.key !== 'Escape') {\n              if (typeof e.preventDefault === 'function') e.preventDefault();\n              if (typeof e.stopPropagation === 'function') e.stopPropagation();\n              return;\n            }\n          }}\n          onChange={(e) => setInput(e.target.value)}\n          placeholder=\"Enter command...\"\n          style={{ flex: 1, background: '#111', color: '#fff', border: '1px solid #333', padding: '6px 8px', borderRadius: '3px', outline: 'none' }}\n        />\n        <button type=\"submit\" style={{ background: '#0e639c', color: '#fff', border: '1px solid #0b5c8a', padding: '6px 10px', borderRadius: '3px', cursor: 'pointer' }}>\n          Run\n        </button>\n      </form>\n    </div>\n  );\n}\n","import React, { useEffect, useRef, useState } from 'react';\n\n// Simple draggable, minimizable settings window.\n// Opens when the custom event 'game-open-settings' is dispatched (from terminal command `settings`).\n// Renders above the game canvas but below the in-game terminal.\nexport default function GameSettings() {\n  // Runtime-linked settings (live updates)\n  const [activeTab, setActiveTab] = useState(() => {\n    try {\n      return localStorage.getItem('game_settings_tab') || 'Audio';\n    } catch {}\n    return 'Audio';\n  });\n  const [parallax, setParallax] = useState(() => {\n    try {\n      const g = window.__GAME_RUNTIME_SETTINGS__;\n      if (g && typeof g.backgroundParallaxFactor === 'number') return g.backgroundParallaxFactor;\n    } catch {}\n    return 0.3;\n  });\n  const [rain, setRain] = useState(() => {\n    try {\n      const ls = localStorage.getItem('game_weather_rain');\n      if (ls !== null) return Math.max(0, Math.min(100, parseInt(ls, 10) || 0));\n      const g = window.__GAME_RUNTIME_SETTINGS__;\n      if (g && typeof g.weatherRain === 'number') return Math.max(0, Math.min(100, g.weatherRain));\n    } catch {}\n    return 0;\n  });\n  const [snow, setSnow] = useState(() => {\n    try {\n      const ls = localStorage.getItem('game_weather_snow');\n      if (ls !== null) return Math.max(0, Math.min(100, parseInt(ls, 10) || 0));\n      const g = window.__GAME_RUNTIME_SETTINGS__;\n      if (g && typeof g.weatherSnow === 'number') return Math.max(0, Math.min(100, g.weatherSnow));\n    } catch {}\n    return 0;\n  });\n  const [clouds, setClouds] = useState(() => {\n    try {\n      // New key first\n      const lsNew = localStorage.getItem('game_weather_clouds');\n      if (lsNew !== null) return Math.max(0, Math.min(100, parseInt(lsNew, 10) || 0));\n      // Backward compatibility: read old fog key if exists\n      const lsOld = localStorage.getItem('game_weather_fog');\n      if (lsOld !== null) return Math.max(0, Math.min(100, parseInt(lsOld, 10) || 0));\n      const g = window.__GAME_RUNTIME_SETTINGS__;\n      // Prefer clouds but also accept legacy fog\n      if (g && typeof g.weatherClouds === 'number') return Math.max(0, Math.min(100, g.weatherClouds));\n      if (g && typeof g.weatherFog === 'number') return Math.max(0, Math.min(100, g.weatherFog));\n    } catch {}\n    return 0;\n  });\n  // New: Thunder (Lightning) intensity 0..100\n  const [thunder, setThunder] = useState(() => {\n    try {\n      const ls = localStorage.getItem('game_weather_thunder');\n      if (ls !== null) return Math.max(0, Math.min(100, parseInt(ls, 10) || 0));\n      const g = window.__GAME_RUNTIME_SETTINGS__;\n      if (g && typeof g.weatherThunder === 'number') return Math.max(0, Math.min(100, g.weatherThunder));\n    } catch {}\n    return 0;\n  });\n  // New: dedicated Fog density (0..100)\n  const [fog, setFog] = useState(() => {\n    try {\n      const ls = localStorage.getItem('game_weather_fog');\n      if (ls !== null) return Math.max(0, Math.min(100, parseInt(ls, 10) || 0));\n      const g = window.__GAME_RUNTIME_SETTINGS__;\n      if (g && typeof g.weatherFog === 'number') return Math.max(0, Math.min(100, g.weatherFog));\n    } catch {}\n    return 0;\n  });\n  // New: Lava Rain (0..100)\n  const [lavaRain, setLavaRain] = useState(() => {\n    try {\n      const ls = localStorage.getItem('game_weather_lavarain');\n      if (ls !== null) return Math.max(0, Math.min(100, parseInt(ls, 10) || 0));\n      const g = window.__GAME_RUNTIME_SETTINGS__;\n      if (g && typeof g.weatherLavaRain === 'number') return Math.max(0, Math.min(100, g.weatherLavaRain));\n    } catch {}\n    return 0;\n  });\n  // New: Radioactive Fog (0..100)\n  const [radioactiveFog, setRadioactiveFog] = useState(() => {\n    try {\n      const ls = localStorage.getItem('game_weather_radioactivefog');\n      if (ls !== null) return Math.max(0, Math.min(100, parseInt(ls, 10) || 0));\n      const g = window.__GAME_RUNTIME_SETTINGS__;\n      if (g && typeof g.weatherRadioactiveFog === 'number') return Math.max(0, Math.min(100, g.weatherRadioactiveFog));\n    } catch {}\n    return 0;\n  });\n  // New: Meteor Rain (0..100)\n  const [meteorRain, setMeteorRain] = useState(() => {\n    try {\n      const ls = localStorage.getItem('game_weather_meteorrain');\n      if (ls !== null) return Math.max(0, Math.min(100, parseInt(ls, 10) || 0));\n      const g = window.__GAME_RUNTIME_SETTINGS__;\n      if (g && typeof g.weatherMeteorRain === 'number') return Math.max(0, Math.min(100, g.weatherMeteorRain));\n    } catch {}\n    return 0;\n  });\n  // UI: Health bar visibility\n  const [healthBarEnabled, setHealthBarEnabled] = useState(() => {\n    try {\n      const ls = localStorage.getItem('game_ui_healthbar');\n      if (ls !== null) return ls !== '0';\n      const g = window.__GAME_RUNTIME_SETTINGS__;\n      if (g && typeof g.healthBarEnabled === 'boolean') return g.healthBarEnabled;\n    } catch {}\n    return true;\n  });\n  // UI: Oxygen/Lava bars visibility\n  const [oxygenBarEnabled, setOxygenBarEnabled] = useState(() => {\n    try {\n      const ls = localStorage.getItem('game_ui_oxygenbar');\n      if (ls !== null) return ls !== '0';\n      const g = window.__GAME_RUNTIME_SETTINGS__;\n      if (g && typeof g.oxygenBarEnabled === 'boolean') return g.oxygenBarEnabled;\n    } catch {}\n    return true;\n  });\n  const [lavaBarEnabled, setLavaBarEnabled] = useState(() => {\n    try {\n      const ls = localStorage.getItem('game_ui_lavabar');\n      if (ls !== null) return ls !== '0';\n      const g = window.__GAME_RUNTIME_SETTINGS__;\n      if (g && typeof g.lavaBarEnabled === 'boolean') return g.lavaBarEnabled;\n    } catch {}\n    return true;\n  });\n  // FX toggles\n  const [waterSplashesEnabled, setWaterSplashesEnabled] = useState(() => {\n    try {\n      const ls = localStorage.getItem('game_fx_water_splashes');\n      if (ls !== null) return ls !== '0';\n      const g = window.__GAME_RUNTIME_SETTINGS__;\n      if (g && typeof g.waterSplashesEnabled === 'boolean') return g.waterSplashesEnabled;\n    } catch {}\n    return true;\n  });\n  const [lavaEmbersEnabled, setLavaEmbersEnabled] = useState(() => {\n    try {\n      const ls = localStorage.getItem('game_fx_lava_embers');\n      if (ls !== null) return ls !== '0';\n      const g = window.__GAME_RUNTIME_SETTINGS__;\n      if (g && typeof g.lavaEmbersEnabled === 'boolean') return g.lavaEmbersEnabled;\n    } catch {}\n    return true;\n  });\n  const [open, setOpen] = useState(false);\n  const [minimized, setMinimized] = useState(false);\n  const [pos, setPos] = useState(() => {\n    // Restore last position from localStorage if available\n    try {\n      const raw = localStorage.getItem('game_settings_pos');\n      if (raw) return JSON.parse(raw);\n    } catch {}\n    return { left: 12, top: 64 };\n  });\n\n  const [size, setSize] = useState(() => {\n    try {\n      const raw = localStorage.getItem('game_settings_size');\n      if (raw) return JSON.parse(raw);\n    } catch {}\n    return { width: 300, height: 220 };\n  });\n\n  const draggingRef = useRef({ active: false, offsetX: 0, offsetY: 0 });\n\n  // Helper: clamp position so the window stays within viewport (with small margin)\n  const clampPos = (p, sz, isMin) => {\n    const margin = 12;\n    const vw = (typeof window !== 'undefined' ? window.innerWidth : 0) || 0;\n    const vh = (typeof window !== 'undefined' ? window.innerHeight : 0) || 0;\n    const maxL = Math.max(0, vw - (sz?.width || 300) - margin);\n    const maxT = Math.max(0, vh - (isMin ? 36 : (sz?.height || 220)) - margin);\n    let left = Number(p?.left);\n    let top = Number(p?.top);\n    if (!Number.isFinite(left)) left = margin;\n    if (!Number.isFinite(top)) top = margin;\n    left = Math.max(0, Math.min(maxL, left));\n    top = Math.max(0, Math.min(maxT, top));\n    return { left, top };\n  };\n\n  // Restore minimized state\n  useEffect(() => {\n    try {\n      const raw = localStorage.getItem('game_settings_min');\n      if (raw) setMinimized(raw === '1');\n    } catch {}\n  }, []);\n\n  // Listen for runtime settings updates from game engine or other sources\n  useEffect(() => {\n    const onSettingsUpdate = (e) => {\n      const patch = (e && e.detail) || {};\n      if (patch.weatherRain !== undefined) setRain(patch.weatherRain);\n      if (patch.weatherSnow !== undefined) setSnow(patch.weatherSnow);\n      if (patch.weatherClouds !== undefined) setClouds(patch.weatherClouds);\n      if (patch.weatherFog !== undefined) setFog(patch.weatherFog);\n      if (patch.weatherThunder !== undefined) setThunder(patch.weatherThunder);\n      if (patch.weatherLavaRain !== undefined) setLavaRain(patch.weatherLavaRain);\n      if (patch.weatherRadioactiveFog !== undefined) setRadioactiveFog(patch.weatherRadioactiveFog);\n      if (patch.weatherMeteorRain !== undefined) setMeteorRain(patch.weatherMeteorRain);\n      if (patch.backgroundParallaxFactor !== undefined) setParallax(patch.backgroundParallaxFactor);\n      if (patch.healthBarEnabled !== undefined) setHealthBarEnabled(!!patch.healthBarEnabled);\n      if (patch.oxygenBarEnabled !== undefined) setOxygenBarEnabled(!!patch.oxygenBarEnabled);\n      if (patch.lavaBarEnabled !== undefined) setLavaBarEnabled(!!patch.lavaBarEnabled);\n      if (patch.waterSplashesEnabled !== undefined) setWaterSplashesEnabled(!!patch.waterSplashesEnabled);\n      if (patch.lavaEmbersEnabled !== undefined) setLavaEmbersEnabled(!!patch.lavaEmbersEnabled);\n    };\n    window.addEventListener('game-settings-update', onSettingsUpdate);\n    return () => window.removeEventListener('game-settings-update', onSettingsUpdate);\n  }, []);\n\n  // Open handler from global event\n  useEffect(() => {\n    const onOpen = () => {\n      // Ensure the window will be visible even if saved pos was off-screen\n      setPos((p) => clampPos(p, size, false));\n      setOpen(true);\n      setMinimized(false);\n      // Sync current values from global when opening\n      try {\n        const g = window.__GAME_RUNTIME_SETTINGS__ || {};\n        if (typeof g.backgroundParallaxFactor === 'number') {\n          setParallax(g.backgroundParallaxFactor);\n        }\n        if (typeof g.weatherRain === 'number') setRain(Math.max(0, Math.min(100, g.weatherRain)));\n        if (typeof g.weatherSnow === 'number') setSnow(Math.max(0, Math.min(100, g.weatherSnow)));\n        if (typeof g.weatherClouds === 'number') setClouds(Math.max(0, Math.min(100, g.weatherClouds)));\n        if (typeof g.weatherFog === 'number') setFog(Math.max(0, Math.min(100, g.weatherFog)));\n        if (typeof g.weatherThunder === 'number') setThunder(Math.max(0, Math.min(100, g.weatherThunder)));\n        if (typeof g.weatherLavaRain === 'number') setLavaRain(Math.max(0, Math.min(100, g.weatherLavaRain)));\n        if (typeof g.weatherRadioactiveFog === 'number') setRadioactiveFog(Math.max(0, Math.min(100, g.weatherRadioactiveFog)));\n        if (typeof g.weatherMeteorRain === 'number') setMeteorRain(Math.max(0, Math.min(100, g.weatherMeteorRain)));\n        if (typeof g.healthBarEnabled === 'boolean') setHealthBarEnabled(!!g.healthBarEnabled);\n        if (typeof g.oxygenBarEnabled === 'boolean') setOxygenBarEnabled(!!g.oxygenBarEnabled);\n        if (typeof g.lavaBarEnabled === 'boolean') setLavaBarEnabled(!!g.lavaBarEnabled);\n        if (typeof g.waterSplashesEnabled === 'boolean') setWaterSplashesEnabled(!!g.waterSplashesEnabled);\n        if (typeof g.lavaEmbersEnabled === 'boolean') setLavaEmbersEnabled(!!g.lavaEmbersEnabled);\n      } catch {}\n      // Auto-close the in-game terminal when settings opens\n      try { window.dispatchEvent(new CustomEvent('game-close-terminal')); } catch {}\n    };\n    window.addEventListener('game-open-settings', onOpen);\n    return () => window.removeEventListener('game-open-settings', onOpen);\n  }, []);\n\n  // Persist position and size/minimized\n  useEffect(() => {\n    try { localStorage.setItem('game_settings_pos', JSON.stringify(pos)); } catch {}\n  }, [pos]);\n  useEffect(() => {\n    try { localStorage.setItem('game_settings_size', JSON.stringify(size)); } catch {}\n  }, [size]);\n  useEffect(() => {\n    try { localStorage.setItem('game_settings_min', minimized ? '1' : '0'); } catch {}\n  }, [minimized]);\n  useEffect(() => {\n    try { localStorage.setItem('game_settings_tab', String(activeTab)); } catch {}\n  }, [activeTab]);\n\n  // Drag logic\n  useEffect(() => {\n    const onMove = (e) => {\n      if (!draggingRef.current.active) return;\n      e.preventDefault();\n      const nx = e.clientX - draggingRef.current.offsetX;\n      const ny = e.clientY - draggingRef.current.offsetY;\n      const maxL = Math.max(0, (window.innerWidth || 0) - size.width - 6);\n      const maxT = Math.max(0, (window.innerHeight || 0) - (minimized ? 36 : size.height) - 6);\n      setPos({\n        left: Math.max(0, Math.min(maxL, nx)),\n        top: Math.max(0, Math.min(maxT, ny)),\n      });\n    };\n    const onUp = () => { draggingRef.current.active = false; };\n    window.addEventListener('mousemove', onMove);\n    window.addEventListener('mouseup', onUp);\n    return () => {\n      window.removeEventListener('mousemove', onMove);\n      window.removeEventListener('mouseup', onUp);\n    };\n  }, [size.width, size.height, minimized]);\n\n  // Re-clamp into viewport when window resizes while settings are open\n  useEffect(() => {\n    if (!open) return;\n    const onResize = () => setPos((p) => clampPos(p, size, minimized));\n    window.addEventListener('resize', onResize);\n    // Run once immediately to correct if needed\n    onResize();\n    return () => window.removeEventListener('resize', onResize);\n  }, [open, size.width, size.height, minimized]);\n\n  const onHeaderMouseDown = (e) => {\n    draggingRef.current.active = true;\n    draggingRef.current.offsetX = e.clientX - pos.left;\n    draggingRef.current.offsetY = e.clientY - pos.top;\n  };\n\n  const onClose = () => setOpen(false);\n  const onMinToggle = () => setMinimized((m) => !m);\n\n  const emitUpdate = (patch) => {\n    try {\n      window.dispatchEvent(new CustomEvent('game-settings-update', { detail: patch }));\n      // Mirror into a global bag for components that want to read without listeners\n      window.__GAME_RUNTIME_SETTINGS__ = {\n        ...(window.__GAME_RUNTIME_SETTINGS__ || {}),\n        ...patch,\n      };\n    } catch {}\n  };\n\n  const onResizeMouseDown = (e) => {\n    // Simple bottom-right resize drag\n    e.preventDefault();\n    const startX = e.clientX;\n    const startY = e.clientY;\n    const startW = size.width;\n    const startH = size.height;\n\n    const move = (ev) => {\n      const dw = ev.clientX - startX;\n      const dh = ev.clientY - startY;\n      const nw = Math.max(220, startW + dw);\n      const nh = Math.max(140, startH + dh);\n      setSize({ width: nw, height: nh });\n    };\n    const up = () => {\n      window.removeEventListener('mousemove', move);\n      window.removeEventListener('mouseup', up);\n    };\n    window.addEventListener('mousemove', move);\n    window.addEventListener('mouseup', up);\n  };\n\n  if (!open) return null;\n\n  const panelStyle = {\n    position: 'fixed',\n    left: pos.left,\n    top: pos.top,\n    width: size.width,\n    height: minimized ? 36 : size.height,\n    background: 'rgba(20,20,20,0.96)',\n    color: '#eaeaea',\n    border: '1px solid #2a2a2a',\n    borderRadius: 6,\n    boxShadow: '0 8px 24px rgba(0,0,0,0.6)',\n    zIndex: 2600, // below terminal (3000), above canvas/HUD\n    display: 'flex',\n    flexDirection: 'column',\n    userSelect: draggingRef.current.active ? 'none' : 'auto',\n    overflow: 'hidden',\n  };\n\n  const headerStyle = {\n    cursor: 'move',\n    background: 'linear-gradient(180deg, #2a2a2a, #1c1c1c)',\n    padding: '6px 8px',\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    borderBottom: '1px solid #333',\n    fontSize: 12,\n  };\n\n  const contentStyle = {\n    flex: 1,\n    display: minimized ? 'none' : 'block',\n    padding: 10,\n    overflow: 'auto',\n    background: 'rgba(10,10,10,0.4)'\n  };\n\n  const buttonStyle = {\n    background: '#0e639c',\n    color: '#fff',\n    border: '1px solid #0b5c8a',\n    padding: '4px 8px',\n    borderRadius: 4,\n    fontSize: 11,\n    cursor: 'pointer',\n    marginLeft: 6,\n  };\n\n  const tabsBarStyle = {\n    display: minimized ? 'none' : 'flex',\n    alignItems: 'center',\n    gap: 6,\n    padding: '6px 8px',\n    borderBottom: '1px solid #2a2a2a',\n    background: 'rgba(0,0,0,0.25)',\n    whiteSpace: 'nowrap',\n    overflowX: 'auto'\n  };\n  const tabBtnStyle = (tab) => ({\n    background: activeTab === tab ? '#1e1e1e' : 'transparent',\n    color: activeTab === tab ? '#9cdcfe' : '#ddd',\n    border: activeTab === tab ? '1px solid #3a3a3a' : '1px solid transparent',\n    padding: '4px 10px',\n    borderRadius: 4,\n    fontSize: 12,\n    cursor: 'pointer',\n  });\n\n  const renderAudio = () => (\n    <section style={{ marginBottom: 10 }}>\n      <div style={{ fontSize: 12, marginBottom: 6, color: '#d6d6d6' }}>Audio</div>\n      <div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>\n        <label style={{ fontSize: 12, width: 120 }}>Master Volume</label>\n        <input type=\"range\" min=\"0\" max=\"1\" step=\"0.01\" defaultValue={0.7} />\n      </div>\n    </section>\n  );\n\n  const renderGraphics = () => (\n    <>\n      <section style={{ marginBottom: 10 }}>\n        <div style={{ fontSize: 12, marginBottom: 6, color: '#d6d6d6' }}>Graphics</div>\n        <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginBottom: 6 }}>\n          <label style={{ fontSize: 12, width: 120 }}>Parallax Factor</label>\n          <input\n            type=\"range\"\n            min=\"0\"\n            max=\"1\"\n            step=\"0.05\"\n            value={Number.isFinite(parallax) ? parallax : 0.3}\n            onChange={(e) => {\n              const v = parseFloat(e.target.value);\n              setParallax(v);\n              emitUpdate({ backgroundParallaxFactor: v });\n            }}\n          />\n          <span style={{ fontSize: 12, width: 40, textAlign: 'right' }}>{(Number.isFinite(parallax) ? parallax : 0.3).toFixed(2)}</span>\n        </div>\n        <div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>\n          <label style={{ fontSize: 12, width: 120 }}>VSync</label>\n          <input type=\"checkbox\" defaultChecked />\n        </div>\n      </section>\n      {/* Keep existing Gameplay controls inside Graphics tab for now */}\n      <section>\n        <div style={{ fontSize: 12, marginBottom: 6, color: '#d6d6d6' }}>Gameplay</div>\n        <div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>\n          <label style={{ fontSize: 12, width: 120 }}>Invert Jump (W)</label>\n          <input type=\"checkbox\" />\n        </div>\n        <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginTop: 6 }}>\n          <label style={{ fontSize: 12, width: 120 }}>Show Health Bar</label>\n          <input\n            type=\"checkbox\"\n            checked={!!healthBarEnabled}\n            onChange={(e) => {\n              const v = !!e.target.checked;\n              setHealthBarEnabled(v);\n              try { localStorage.setItem('game_ui_healthbar', v ? '1' : '0'); } catch {}\n              emitUpdate({ healthBarEnabled: v });\n            }}\n          />\n        </div>\n        <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginTop: 6 }}>\n          <label style={{ fontSize: 12, width: 120 }}>Show Oxygen Bar</label>\n          <input\n            type=\"checkbox\"\n            checked={!!oxygenBarEnabled}\n            onChange={(e) => {\n              const v = !!e.target.checked;\n              setOxygenBarEnabled(v);\n              try { localStorage.setItem('game_ui_oxygenbar', v ? '1' : '0'); } catch {}\n              emitUpdate({ oxygenBarEnabled: v });\n            }}\n          />\n        </div>\n        <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginTop: 6 }}>\n          <label style={{ fontSize: 12, width: 120 }}>Show Lava Bar</label>\n          <input\n            type=\"checkbox\"\n            checked={!!lavaBarEnabled}\n            onChange={(e) => {\n              const v = !!e.target.checked;\n              setLavaBarEnabled(v);\n              try { localStorage.setItem('game_ui_lavabar', v ? '1' : '0'); } catch {}\n              emitUpdate({ lavaBarEnabled: v });\n            }}\n          />\n        </div>\n        <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginTop: 6 }}>\n          <label style={{ fontSize: 12, width: 120 }}>Water Splashes</label>\n          <input\n            type=\"checkbox\"\n            checked={!!waterSplashesEnabled}\n            onChange={(e) => {\n              const v = !!e.target.checked;\n              setWaterSplashesEnabled(v);\n              try { localStorage.setItem('game_fx_water_splashes', v ? '1' : '0'); } catch {}\n              emitUpdate({ waterSplashesEnabled: v });\n            }}\n          />\n        </div>\n        <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginTop: 6 }}>\n          <label style={{ fontSize: 12, width: 120 }}>Lava Embers</label>\n          <input\n            type=\"checkbox\"\n            checked={!!lavaEmbersEnabled}\n            onChange={(e) => {\n              const v = !!e.target.checked;\n              setLavaEmbersEnabled(v);\n              try { localStorage.setItem('game_fx_lava_embers', v ? '1' : '0'); } catch {}\n              emitUpdate({ lavaEmbersEnabled: v });\n            }}\n          />\n        </div>\n      </section>\n    </>\n  );\n\n  const renderWeather = () => (\n    <section style={{ marginBottom: 10 }}>\n      <div style={{ fontSize: 12, marginBottom: 6, color: '#d6d6d6' }}>Weather</div>\n      <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginBottom: 6 }}>\n        <label style={{ fontSize: 12, width: 120 }}>Lietus (Rain)</label>\n        <input\n          type=\"range\"\n          min=\"0\"\n          max=\"100\"\n          step=\"1\"\n          value={Number.isFinite(rain) ? rain : 0}\n          onChange={(e) => {\n            const v = Math.max(0, Math.min(100, parseInt(e.target.value, 10) || 0));\n            setRain(v);\n            try { localStorage.setItem('game_weather_rain', String(v)); } catch {}\n            emitUpdate({ weatherRain: v });\n          }}\n        />\n        <span style={{ fontSize: 12, width: 34, textAlign: 'right' }}>{Number.isFinite(rain) ? rain : 0}</span>\n      </div>\n      <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginBottom: 6 }}>\n        <label style={{ fontSize: 12, width: 120 }}>Sniegs (Snow)</label>\n        <input\n          type=\"range\"\n          min=\"0\"\n          max=\"100\"\n          step=\"1\"\n          value={Number.isFinite(snow) ? snow : 0}\n          onChange={(e) => {\n            const v = Math.max(0, Math.min(100, parseInt(e.target.value, 10) || 0));\n            setSnow(v);\n            try { localStorage.setItem('game_weather_snow', String(v)); } catch {}\n            emitUpdate({ weatherSnow: v });\n          }}\n        />\n        <span style={{ fontSize: 12, width: 34, textAlign: 'right' }}>{Number.isFinite(snow) ? snow : 0}</span>\n      </div>\n      <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginBottom: 6 }}>\n        <label style={{ fontSize: 12, width: 120 }}>Migla (Fog)</label>\n        <input\n          type=\"range\"\n          min=\"0\"\n          max=\"100\"\n          step=\"1\"\n          value={Number.isFinite(fog) ? fog : 0}\n          onChange={(e) => {\n            const v = Math.max(0, Math.min(100, parseInt(e.target.value, 10) || 0));\n            setFog(v);\n            try { localStorage.setItem('game_weather_fog', String(v)); } catch {}\n            emitUpdate({ weatherFog: v });\n          }}\n        />\n        <span style={{ fontSize: 12, width: 34, textAlign: 'right' }}>{Number.isFinite(fog) ? fog : 0}</span>\n      </div>\n      <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginBottom: 6 }}>\n        <label style={{ fontSize: 12, width: 120 }}>Zibens (Thunder)</label>\n        <input\n          type=\"range\"\n          min=\"0\"\n          max=\"100\"\n          step=\"1\"\n          value={Number.isFinite(thunder) ? thunder : 0}\n          onChange={(e) => {\n            const v = Math.max(0, Math.min(100, parseInt(e.target.value, 10) || 0));\n            setThunder(v);\n            try { localStorage.setItem('game_weather_thunder', String(v)); } catch {}\n            emitUpdate({ weatherThunder: v });\n          }}\n        />\n        <span style={{ fontSize: 12, width: 34, textAlign: 'right' }}>{Number.isFinite(thunder) ? thunder : 0}</span>\n      </div>\n      <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginBottom: 6 }}>\n        <label style={{ fontSize: 12, width: 120 }}>Mkoi (Clouds)</label>\n        <input\n          type=\"range\"\n          min=\"0\"\n          max=\"100\"\n          step=\"1\"\n          value={Number.isFinite(clouds) ? clouds : 0}\n          onChange={(e) => {\n            const v = Math.max(0, Math.min(100, parseInt(e.target.value, 10) || 0));\n            setClouds(v);\n            try { localStorage.setItem('game_weather_clouds', String(v)); } catch {}\n            emitUpdate({ weatherClouds: v });\n          }}\n        />\n        <span style={{ fontSize: 12, width: 34, textAlign: 'right' }}>{Number.isFinite(clouds) ? clouds : 0}</span>\n      </div>\n      <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginBottom: 6 }}>\n        <label style={{ fontSize: 12, width: 120 }}>Lavas lietus</label>\n        <input\n          type=\"range\"\n          min=\"0\"\n          max=\"100\"\n          step=\"1\"\n          value={Number.isFinite(lavaRain) ? lavaRain : 0}\n          onChange={(e) => {\n            const v = Math.max(0, Math.min(100, parseInt(e.target.value, 10) || 0));\n            setLavaRain(v);\n            try { localStorage.setItem('game_weather_lavarain', String(v)); } catch {}\n            emitUpdate({ weatherLavaRain: v });\n          }}\n        />\n        <span style={{ fontSize: 12, width: 34, textAlign: 'right' }}>{Number.isFinite(lavaRain) ? lavaRain : 0}</span>\n      </div>\n      <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginBottom: 6 }}>\n        <label style={{ fontSize: 12, width: 120 }}>Radioakt. migla</label>\n        <input\n          type=\"range\"\n          min=\"0\"\n          max=\"100\"\n          step=\"1\"\n          value={Number.isFinite(radioactiveFog) ? radioactiveFog : 0}\n          onChange={(e) => {\n            const v = Math.max(0, Math.min(100, parseInt(e.target.value, 10) || 0));\n            setRadioactiveFog(v);\n            try { localStorage.setItem('game_weather_radioactivefog', String(v)); } catch {}\n            emitUpdate({ weatherRadioactiveFog: v });\n          }}\n        />\n        <span style={{ fontSize: 12, width: 34, textAlign: 'right' }}>{Number.isFinite(radioactiveFog) ? radioactiveFog : 0}</span>\n      </div>\n      <div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>\n        <label style={{ fontSize: 12, width: 120 }}>Meteortu lietus</label>\n        <input\n          type=\"range\"\n          min=\"0\"\n          max=\"100\"\n          step=\"1\"\n          value={Number.isFinite(meteorRain) ? meteorRain : 0}\n          onChange={(e) => {\n            const v = Math.max(0, Math.min(100, parseInt(e.target.value, 10) || 0));\n            setMeteorRain(v);\n            try { localStorage.setItem('game_weather_meteorrain', String(v)); } catch {}\n            emitUpdate({ weatherMeteorRain: v });\n          }}\n        />\n        <span style={{ fontSize: 12, width: 34, textAlign: 'right' }}>{Number.isFinite(meteorRain) ? meteorRain : 0}</span>\n      </div>\n    </section>\n  );\n\n  return (\n    <div style={panelStyle}>\n      <div style={headerStyle} onMouseDown={onHeaderMouseDown}>\n        <div style={{ fontWeight: 600, color: '#9cdcfe' }}>Game Settings</div>\n        <div style={{ display: 'flex', alignItems: 'center' }}>\n          <button onClick={onMinToggle} title={minimized ? 'Expand' : 'Minimize'} style={buttonStyle}>\n            {minimized ? '' : ''}\n          </button>\n          <button onClick={onClose} title=\"Close\" style={{ ...buttonStyle, background: '#a33', borderColor: '#822' }}></button>\n        </div>\n      </div>\n\n      {/* Tabs bar: one-line menu */}\n      <div style={tabsBarStyle}>\n        {['Audio','Graphics','Weather'].map((t) => (\n          <button key={t} style={tabBtnStyle(t)} onClick={() => setActiveTab(t)}>{t}</button>\n        ))}\n      </div>\n\n      <div style={contentStyle}>\n        {activeTab === 'Audio' && renderAudio()}\n        {activeTab === 'Graphics' && renderGraphics()}\n        {activeTab === 'Weather' && renderWeather()}\n      </div>\n\n      {/* Resize handle */}\n      {!minimized && (\n        <div\n          onMouseDown={onResizeMouseDown}\n          title=\"Resize\"\n          style={{ position: 'absolute', right: 0, bottom: 0, width: 16, height: 16, cursor: 'nwse-resize',\n                   background: 'linear-gradient(135deg, transparent 0, transparent 50%, #666 50%, #666 100%)' }}\n        />\n      )}\n    </div>\n  );\n}\n","import React, { useEffect, useRef } from 'react';\n\n// Lightweight background music player that resolves a meta path like\n// \"/sound/background/track.ogg\" to a build URL via require.context and\n// plays/pauses a looping HTMLAudioElement.\n// Props:\n// - metaPath: string | null  stored in map meta (e.g., \"/sound/background/foo.ogg\")\n// - enabled: boolean  global sound toggle\n// - volume: number (0..1)\nexport default function BackgroundMusicPlayer({ metaPath, enabled = false, volume = 0.6 }) {\n  const audioRef = useRef(null);\n  const currentSrcRef = useRef(null);\n\n  // Resolve ogg assets from src/assets/sound/background\n  let musicContext = null;\n  try {\n    // utilities -> ../assets/sound/background\n    musicContext = require.context('../assets/sound/background', false, /\\.(ogg|mp3|wav|m4a)$/i);\n  } catch (e) {\n    musicContext = null;\n  }\n\n  const resolveUrl = (path) => {\n    if (!path) return null;\n    const name = path.split('/').pop();\n    if (!name) return null;\n    if (musicContext) {\n      try {\n        const mod = musicContext(`./${name}`);\n        return mod.default || mod;\n      } catch (e) {\n        console.warn(`Background music not found: ${name}`);\n      }\n    }\n    return null;\n  };\n\n  const cleanup = () => {\n    try {\n      if (audioRef.current) {\n        audioRef.current.pause();\n        audioRef.current.src = '';\n        audioRef.current = null;\n        currentSrcRef.current = null;\n      }\n    } catch {}\n  };\n\n  // Build/rebuild audio element when metaPath changes\n  useEffect(() => {\n    const url = resolveUrl(metaPath);\n\n    // If unchanged, just update enabled/volume in next effect\n    if (url && currentSrcRef.current === url && audioRef.current) {\n      return () => {};\n    }\n\n    // Rebuild\n    cleanup();\n    if (!url) return () => {};\n\n    const audio = new Audio(url);\n    audio.loop = true;\n    audio.volume = Math.max(0, Math.min(1, Number(volume) || 0));\n    audioRef.current = audio;\n    currentSrcRef.current = url;\n\n    // Try to pre-play if enabled (may be blocked by autoplay policy)\n    if (enabled) {\n      audio.play().catch(() => {\n        // Will try again on explicit user gesture via custom event\n      });\n    }\n\n    return () => cleanup();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [metaPath]);\n\n  // React to enabled/volume changes\n  useEffect(() => {\n    const audio = audioRef.current;\n    if (!audio) return;\n    audio.volume = Math.max(0, Math.min(1, Number(volume) || 0));\n    if (enabled) {\n      // Attempt to play; may require user gesture\n      audio.play().catch(() => {\n        // try again on gesture event\n      });\n    } else {\n      try { audio.pause(); } catch {}\n    }\n  }, [enabled, volume]);\n\n  // Listen for a gesture-driven event to force playback immediately in handler\n  useEffect(() => {\n    const onGesture = () => {\n      const audio = audioRef.current;\n      if (audio && enabled) {\n        audio.play().catch(() => {});\n      }\n    };\n    const onToggle = (e) => {\n      const val = !!(e && e.detail && e.detail.enabled);\n      const audio = audioRef.current;\n      if (!audio) return;\n      if (val) {\n        audio.play().catch(() => {});\n      } else {\n        try { audio.pause(); } catch {}\n      }\n    };\n    window.addEventListener('game-sound-user-gesture', onGesture);\n    window.addEventListener('game-sound-toggle', onToggle);\n    return () => {\n      window.removeEventListener('game-sound-user-gesture', onGesture);\n      window.removeEventListener('game-sound-toggle', onToggle);\n    };\n  }, [enabled]);\n\n  return null;\n}\n","import map1 from '../assets/maps/Template.json';\nimport map2 from '../assets/maps/Forest.json';\nimport map3 from '../assets/maps/T.json';\n\n\nexport const BUILT_IN_MAPS = [map1, map2, map3];\n","import React, { useState, useEffect, useMemo, useRef, useCallback } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { getRegistry, findItemById } from '../../../engine/registry';\nimport PixiStage from './PixiStage';\nimport { useGameEngine } from '../../../utilities/useGameEngine';\nimport GameHeader from './GameHeader';\nimport GameTerminal from './GameTerminal';\nimport GameSettings from './GameSettings';\nimport BackgroundMusicPlayer from '../../../utilities/BackgroundMusicPlayer';\nimport { setActiveMap, removeObjectAtIndex, removeTileAtIndex, moveTileInMap, moveObjectInMap, updateObjectAtIndex, updateObjectMetadata, setObjectTextureIndex, revealSecretZone, resetGame, setGameOver } from '../../../store/slices/gameSlice';\nimport { setMapModalOpen, setCameraScrollX, setShouldCenterMap } from '../../../store/slices/uiSlice';\nimport { setSoundEnabled } from '../../../store/slices/settingsSlice';\nimport errorHandler from '../../../services/errorHandler';\nimport styled from 'styled-components';\n\nimport { BUILT_IN_MAPS } from '../../../constants/builtInMaps';\n\n// Styled Components\nconst GameContainer = styled.div`\n    position: relative;\n    height: 100%;\n    overflow: hidden;\n    background-color: #333;\n`;\n\nconst ModalOverlay = styled.div`\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background-color: rgba(0, 0, 0, 0.6);\n    z-index: 3000;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    backdrop-filter: blur(2px);\n`;\n\nconst ModalContent = styled.div`\n    background-color: #fff;\n    padding: 20px;\n    border-radius: 8px;\n    width: 900px;\n    max-width: 95%;\n    max-height: 85%;\n    overflow-y: auto;\n    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);\n    display: flex;\n    flex-direction: column;\n    gap: 15px;\n`;\n\nconst ModalTitle = styled.h2`\n    margin: 0;\n    border-bottom: 2px solid #eee;\n    padding-bottom: 10px;\n`;\n\nconst MapList = styled.div`\n    display: grid;\n    grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));\n    gap: 15px;\n    padding: 5px;\n`;\n\nconst MapCard = styled.div`\n    border: 1px solid #ddd;\n    border-radius: 8px;\n    padding: 15px;\n    cursor: pointer;\n    background-color: #f9f9f9;\n    display: flex;\n    flex-direction: column;\n    gap: 10px;\n    transition: all 0.2s ease;\n\n    &:hover {\n        background-color: #f0f7ff;\n        border-color: #2196f3;\n        transform: translateY(-3px);\n        box-shadow: 0 5px 15px rgba(0,0,0,0.1);\n    }\n`;\n\nconst MapTitle = styled.div`\n    font-weight: bold;\n    font-size: 16px;\n    color: #333;\n`;\n\nconst MapAuthor = styled.div`\n    font-size: 12px;\n    color: #666;\n`;\n\nconst MapDescription = styled.div`\n    font-size: 11px;\n    color: #777;\n    font-style: italic;\n    line-height: 1.4;\n    display: -webkit-box;\n    -webkit-line-clamp: 3;\n    -webkit-box-orient: vertical;\n    overflow: hidden;\n    min-height: 45px;\n`;\n\nconst MapInfo = styled.div`\n    margin-top: auto;\n    padding-top: 8px;\n    border-top: 1px solid #eee;\n    font-size: 11px;\n    color: #555;\n    display: flex;\n    justify-content: space-between;\n`;\n\nconst WinCounterOverlay = styled.div`\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    font-size: 120px;\n    font-weight: bold;\n    color: #fff;\n    text-shadow: 0 0 20px rgba(0,0,0,0.8), 0 0 40px rgba(255,255,255,0.5);\n    z-index: 2000;\n    pointer-events: none;\n    font-family: 'Courier New', Courier, monospace;\n`;\n\nconst GameOverOverlay = styled.div`\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background-color: rgba(0, 0, 0, 0.8);\n    z-index: 2500;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    color: white;\n    backdrop-filter: blur(4px);\n    animation: fadeIn 0.5s ease-out;\n\n    @keyframes fadeIn {\n        from { opacity: 0; }\n        to { opacity: 1; }\n    }\n`;\n\nconst GameOverTitle = styled.h1`\n    font-size: 72px;\n    margin: 0 0 30px 0;\n    text-transform: uppercase;\n    letter-spacing: 5px;\n    color: #ff4444;\n    text-shadow: 0 0 20px rgba(255, 0, 0, 0.5), 0 5px 15px rgba(0,0,0,0.8);\n    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n    font-weight: 900;\n`;\n\nconst ReplayButton = styled.button`\n    padding: 18px 50px;\n    font-size: 28px;\n    background: linear-gradient(180deg, #4CAF50, #2E7D32);\n    color: white;\n    border: 2px solid #fff;\n    border-radius: 50px;\n    cursor: pointer;\n    font-weight: bold;\n    box-shadow: 0 5px 15px rgba(0,0,0,0.3);\n    transition: all 0.2s ease;\n    outline: none;\n\n    &:hover {\n        background: linear-gradient(180deg, #66BB6A, #388E3C);\n        transform: scale(1.05) translateY(-2px);\n        box-shadow: 0 8px 20px rgba(0,0,0,0.4);\n    }\n\n    &:active {\n        transform: scale(0.98) translateY(0);\n    }\n`;\n\nconst ModalDivider = styled.div`\n    border-top: 2px solid #eee;\n    padding-top: 15px;\n    margin-top: 10px;\n`;\n\nconst FileUploadLabel = styled.label`\n    padding: 8px 16px;\n    background-color: #2196F3;\n    color: white;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n    font-weight: bold;\n    text-align: center;\n    display: inline-block;\n    width: 100%;\n    box-sizing: border-box;\n\n    &:hover {\n        background-color: #1976D2;\n    }\n`;\n\nconst HiddenFileInput = styled.input`\n    display: none;\n`;\n\nconst Viewport = styled.div`\n    height: 100%;\n    overflow: hidden;\n    filter: ${props => props.$blurred ? 'blur(5px)' : 'none'};\n    pointer-events: ${props => props.$blurred ? 'none' : 'auto'};\n    transition: filter 0.3s ease;\n`;\n\nconst GameCanvas = styled.div`\n    position: relative;\n    width: 100%;\n    height: 100%;\n    background-color: #111;\n`;\n\nconst PlaceholderMessage = styled.div`\n    color: #777;\n    font-size: 24px;\n`;\n\nconst MessageOverlay = styled.div`\n    position: absolute;\n    top: 40%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    width: 80%;\n    text-align: center;\n    pointer-events: none;\n    z-index: 1500;\n    \n    h2 {\n        font-size: 48px;\n        color: white;\n        text-shadow: 0 0 10px rgba(0,0,0,0.8), 0 0 20px rgba(0,0,0,0.5);\n        margin: 0;\n        padding: 20px;\n        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n        font-weight: 800;\n        letter-spacing: 2px;\n        opacity: ${props => props.$isVisible ? 1 : 0};\n        transition: opacity 2s ease-in-out;\n    }\n`;\n\nexport default function Game() {\n    const dispatch = useDispatch();\n    const viewportRef = useRef(null);\n    const player = useSelector(state => state.player); // Ensure this isn't undefined\n\n    // Redux state\n    const { activeMapData, tileMapData, objectMapData, secretMapData, objectMetadata, revealedSecrets, objectTextureIndices, mapWidth, mapHeight, isGameOver } = useSelector(state => state.game);\n    const { isMapModalOpen, cameraScrollX, shouldCenterMap } = useSelector(state => state.ui);\n    const { sound } = useSelector(state => state.settings);\n    const soundEnabled = sound.enabled;\n\n    // Runtime settings that can be changed from GameSettings on the fly\n    const [runtimeSettings, setRuntimeSettings] = useState({});\n\n    // In-game messages\n    const [gameMessage, setGameMessage] = useState({ text: '', isVisible: false });\n    const messageTimerRef = useRef(null);\n\n    // Registry\n    const registryItems = getRegistry() || [];\n\n    const handleGameOver = () => {\n        dispatch(setGameOver(true));\n    };\n\n    const handleReplay = () => {\n        if (activeMapData) {\n            console.log(\"Replaying map...\");\n            const mapToLoad = {\n                ...activeMapData,\n                meta: {\n                    ...activeMapData.meta,\n                    date_map_last_updated: new Date().toISOString()\n                }\n            };\n            loadMapData(mapToLoad);\n            dispatch(setGameOver(false));\n        }\n    };\n\n    const handleStateUpdate = useCallback((action, payload) => {\n        if (action === 'collectItem') {\n            const indexToRemove = payload;\n            dispatch(removeObjectAtIndex(indexToRemove));\n        } else if (action === 'interactable') {\n            const index = payload;\n            // Switch interactable to \"used\" variant by changing ID\n            // e.g., berry_bush_01 -> berry_bush_01_used\n            const currentId = objectMapData[index];\n            if (currentId) {\n                dispatch(updateObjectAtIndex({ index, newId: currentId + '_used' }));\n            }\n        } else if (action === 'switchMap') {\n            const { targetMapId, triggerId } = payload;\n            const projectMaps = activeMapData?.maps || activeMapData?.projectMaps || {};\n            const targetMap = projectMaps[targetMapId];\n            \n            if (targetMap) {\n                console.log(`Switching to map: ${targetMapId}, looking for trigger: ${triggerId}`);\n                \n                // Ms varam vienkri nodot visu projektu un pielikt spawnTriggerId\n                const projectToLoad = {\n                    ...activeMapData,\n                    meta: {\n                        ...activeMapData.meta,\n                        activeMapId: targetMapId,\n                        spawnTriggerId: triggerId\n                    }\n                };\n                \n                loadMapData(projectToLoad);\n            }\n        } else if (action === 'objectDamage') {\n            const { index, damage } = payload;\n            const objId = objectMapData[index];\n            if (objId) {\n                const def = registryItems.find(r => r.id === objId);\n                if (def && def.isDestructible) {\n                    const currentMeta = objectMetadata[index] || {};\n                    const maxH = def.maxHealth || 100;\n                    const newHealth = Math.max(0, (currentMeta.health !== undefined ? currentMeta.health : maxH) - damage);\n                    dispatch(updateObjectMetadata({ index, metadata: { health: newHealth } }));\n\n                    if (def.type === 'crack_block' && newHealth <= (def.passableHealthThreshold || 0)) {\n                        dispatch(removeTileAtIndex(index));\n                    }\n                }\n            }\n        } else if (action === 'shiftTile' && payload) {\n            const { index, dx, dy } = payload;\n            \n            // Wolfenstein-style slow move: 1 block at a time\n            let currentIdx = index;\n            let remainingDx = dx;\n            let remainingDy = dy;\n            \n            const moveStep = () => {\n                if (remainingDx === 0 && remainingDy === 0) {\n                    // movement finished\n                    dispatch(removeObjectAtIndex(currentIdx));\n                    return;\n                }\n                \n                const stepX = remainingDx > 0 ? 1 : (remainingDx < 0 ? -1 : 0);\n                const stepY = remainingDy > 0 ? 1 : (remainingDy < 0 ? -1 : 0);\n                \n                const tx = (currentIdx % mapWidth) + stepX;\n                const ty = Math.floor(currentIdx / mapWidth) + stepY;\n                \n                if (tx >= 0 && tx < mapWidth && ty >= 0 && ty < mapHeight) {\n                    const targetIndex = ty * mapWidth + tx;\n                    \n                    // Chain reaction: if the destination tile of the current move batch has another wolf_secret\n                    const isLastStepOfBatch = (Math.abs(remainingDx) === 1 && remainingDy === 0) || (Math.abs(remainingDy) === 1 && remainingDx === 0);\n                    if (isLastStepOfBatch) {\n                        const targetObjId = objectMapData[targetIndex];\n                        const targetDef = registryItems.find(r => r.id === targetObjId);\n                        if (targetDef && targetDef.type === 'wolf_secret') {\n                            // Extend movement in the same direction by amount specified in target or 3 blocks\n                            const extraX = Math.abs(targetDef.moveX || 3);\n                            const extraY = Math.abs(targetDef.moveY || 3);\n                            if (remainingDx !== 0) remainingDx += (remainingDx > 0 ? extraX : -extraX);\n                            if (remainingDy !== 0) remainingDy += (remainingDy > 0 ? extraY : -extraY);\n                        }\n                    }\n\n                    dispatch(moveTileInMap({ fromIndex: currentIdx, toIndex: targetIndex }));\n                    dispatch(moveObjectInMap({ fromIndex: currentIdx, toIndex: targetIndex }));\n                    \n                    currentIdx = targetIndex;\n                    remainingDx -= stepX;\n                    remainingDy -= stepY;\n                    \n                    if (remainingDx !== 0 || remainingDy !== 0) {\n                        setTimeout(moveStep, 250); // 250ms delay between blocks for visibility\n                    } else {\n                        // Movement finished after last step\n                        dispatch(removeObjectAtIndex(currentIdx));\n                    }\n                } else {\n                    // Hit world bounds, finish and remove trigger\n                    dispatch(removeObjectAtIndex(currentIdx));\n                }\n            };\n            \n            moveStep();\n        } else if (action === 'playerDamage' && payload !== undefined) {\n            // eit ms nevaram viegli atjaunint Redux katr kadr,\n            // bet varam atskaot trpjuma skau\n            console.log(\"Player hit by entity!\");\n        } else if (action === 'levelWin') {\n            console.log(\"Level Win! Returning to map selection.\");\n            setTimeout(() => {\n                alert(\"Level Complete!\");\n                dispatch(setMapModalOpen(true));\n            }, 500);\n        } else if (action === 'updateWeather' && payload) {\n            const { type, value } = payload;\n            const settingKey = 'weather' + type.charAt(0).toUpperCase() + type.slice(1); // e.g., weatherRain\n            setRuntimeSettings(prev => ({ ...prev, [settingKey]: value }));\n            \n            // Dispatch event so UI components like GameSettings can update their state\n            window.dispatchEvent(new CustomEvent('game-settings-update', { \n                detail: { [settingKey]: value } \n            }));\n        } else if (action === 'weatherEffectHit' && payload) {\n            const { type, data } = payload;\n            // o darbbu ms izmantosim, lai nodotu informciju dzinjam caur ref vai eventu\n            // Bet labk ir tiei izsaukt dzinja funkciju, ja tda ir.\n            // T k useGameEngine ir hook, ms nevaram viegli izsaukt t iekjo funkciju.\n            // Tomr ms varam izmantot window eventu vai ref.\n            window.dispatchEvent(new CustomEvent('weather-effect-hit', { detail: { type, data } }));\n        } else if (action === 'showMessage' && payload) {\n            const { text, duration } = payload;\n            \n            if (messageTimerRef.current) {\n                clearTimeout(messageTimerRef.current);\n            }\n            \n            setGameMessage({ text, isVisible: true });\n            \n            messageTimerRef.current = setTimeout(() => {\n                setGameMessage(prev => ({ ...prev, isVisible: false }));\n                messageTimerRef.current = null;\n            }, duration || 8000);\n        }\n    }, [dispatch, objectMapData, objectMetadata, registryItems]);\n\n    // We no longer need 'engineMapData' with layers, as we pass objectMapData separately.\n    // So we pass the original 'activeMapData' as first argument (for initialization to work correctly and not reset),\n    // and 'objectMapData' as third argument for item checking.\n\n    // Callback for revealing secret zones\n    const handleRevealSecret = (indices) => {\n        dispatch(revealSecretZone(indices));\n    };\n\n    // --- START ENGINE ---\n    // Engine returns player coordinates and state\n    // objectMapData contains dynamic data (removed items)\n    const playerState = useGameEngine(\n        activeMapData,\n        tileMapData,\n        objectMapData,\n        secretMapData,\n        revealedSecrets,\n        registryItems,\n        handleGameOver,\n        handleStateUpdate,\n        handleRevealSecret,\n        objectMetadata\n    );\n\n    // Iegstam spltja vizulo izskatu (Texture)\n    const playerVisuals = useMemo(() => {\n        // eit vartu bt loika, kas maina tekstru atkarb no playerState.direction vai playerState.vx\n        // Pagaidm paemam noklusto\n        return findItemById(\"player_default_100\") || findItemById(\"player\");\n    }, []);\n    // --- END ENGINE ---\n\n    // Listen for runtime settings updates from GameSettings (live apply)\n    useEffect(() => {\n        const onSettingsUpdate = (e) => {\n            const patch = (e && e.detail) || {};\n            setRuntimeSettings(prev => ({ ...prev, ...patch }));\n        };\n        window.addEventListener('game-settings-update', onSettingsUpdate);\n        return () => window.removeEventListener('game-settings-update', onSettingsUpdate);\n    }, []);\n\n    // Listen for navigation buttons\n    useEffect(() => {\n        const handleOpenModalEvent = () => {\n            dispatch(setMapModalOpen(true));\n            dispatch(setGameOver(false)); // Reset game over when opening new game modal\n        };\n        window.addEventListener('open-new-game-modal', handleOpenModalEvent);\n        return () => window.removeEventListener('open-new-game-modal', handleOpenModalEvent);\n    }, [dispatch]);\n\n    // Mirror current effective runtime settings for other components to read (like GameSettings)\n    useEffect(() => {\n        try {\n            const clouds = (runtimeSettings.weatherClouds ?? 0);\n            const fog = (runtimeSettings.weatherFog ?? 0);\n            const thunder = (runtimeSettings.weatherThunder ?? 0);\n            window.__GAME_RUNTIME_SETTINGS__ = {\n                ...(window.__GAME_RUNTIME_SETTINGS__ || {}),\n                backgroundParallaxFactor: (runtimeSettings.backgroundParallaxFactor ?? activeMapData?.meta?.backgroundParallaxFactor ?? 0.3),\n                weatherRain: (runtimeSettings.weatherRain ?? 0),\n                weatherSnow: (runtimeSettings.weatherSnow ?? 0),\n                weatherLavaRain: (runtimeSettings.weatherLavaRain ?? 0),\n                weatherRadioactiveFog: (runtimeSettings.weatherRadioactiveFog ?? 0),\n                weatherMeteorRain: (runtimeSettings.weatherMeteorRain ?? 0),\n                weatherClouds: clouds,\n                weatherFog: fog,\n                weatherThunder: thunder,\n                healthBarEnabled: (runtimeSettings.healthBarEnabled ?? true),\n                oxygenBarEnabled: (runtimeSettings.oxygenBarEnabled ?? true),\n                lavaBarEnabled: (runtimeSettings.lavaBarEnabled ?? true),\n                waterSplashesEnabled: (runtimeSettings.waterSplashesEnabled ?? true),\n                lavaEmbersEnabled: (runtimeSettings.lavaEmbersEnabled ?? true),\n                // legacy mirror for compatibility (e.g., older UI)\n                weatherFogLegacy: fog,\n            };\n        } catch {}\n    }, [runtimeSettings, activeMapData]);\n\n    const loadMapData = (mapData) => {\n        try {\n            if (!mapData) {\n                errorHandler.warn('loadMapData called with empty mapData', { component: 'Game' });\n                return;\n            }\n\n            let effectiveMapData = mapData;\n            \n            // Atbalsts Version 2.0 (Multi-map project)\n            if (mapData.meta?.version === \"2.0\" && mapData.maps) {\n                const activeId = mapData.meta.activeMapId || Object.keys(mapData.maps)[0];\n                const activeMap = mapData.maps[activeId];\n                \n                if (activeMap) {\n                    // Konvertjam uz formtu, ko saprot dzinjs un setActiveMap\n                    effectiveMapData = {\n                        ...mapData, // Saglabjam visu projektu\n                        meta: {\n                            ...mapData.meta,\n                            width: activeMap.width,\n                            height: activeMap.height,\n                            name: activeMap.name,\n                            backgroundImage: activeMap.backgroundImage,\n                            backgroundColor: activeMap.backgroundColor,\n                            backgroundMusic: activeMap.backgroundMusic,\n                            backgroundParallaxFactor: activeMap.backgroundParallaxFactor,\n                            weather: activeMap.weather,\n                            objectMetadata: activeMap.objectMetadata || {},\n                            playerPosition: activeMap.playerPosition\n                        },\n                        layers: activeMap.layers || [\n                            { name: 'background', data: activeMap.tileMapData },\n                            { name: 'entities', data: activeMap.objectMapData },\n                            { name: 'secrets', data: activeMap.secretMapData }\n                        ]\n                    };\n                }\n            }\n\n            const w = effectiveMapData.meta?.width || effectiveMapData.width || 20;\n            const h = effectiveMapData.meta?.height || effectiveMapData.height || 15;\n\n            let tileData = [];\n            let objData = [];\n            let secretData = [];\n\n            if (effectiveMapData.layers) {\n                const bgLayer = effectiveMapData.layers.find(l => l.name === 'background' || l.type === 'tile');\n                tileData = bgLayer ? bgLayer.data : Array(w * h).fill(null);\n\n                const objLayer = effectiveMapData.layers.find(l => l.name === 'entities' || l.type === 'object');\n                objData = objLayer ? objLayer.data : Array(w * h).fill(null);\n\n                const secretLayer = effectiveMapData.layers.find(l => l.name === 'secrets' || l.type === 'secret');\n                secretData = secretLayer ? secretLayer.data : Array(w * h).fill(null);\n            } else {\n                tileData = effectiveMapData.tiles || Array(w * h).fill(null);\n                objData = Array(w * h).fill(null);\n                secretData = Array(w * h).fill(null);\n            }\n\n            // Update Redux store\n            dispatch(setActiveMap({\n                mapData: effectiveMapData,\n                tileMapData: tileData,\n                objectMapData: objData,\n                secretMapData: secretData,\n                mapWidth: w,\n                mapHeight: h\n            }));\n            dispatch(setCameraScrollX(0));\n            dispatch(setMapModalOpen(false));\n            dispatch(setGameOver(false)); // Ensure game over is reset on map load\n\n            errorHandler.info('Map loaded successfully', {\n                component: 'Game',\n                mapName: effectiveMapData.meta?.name || 'Unknown',\n                dimensions: `${w}x${h}`\n            });\n        } catch (error) {\n            errorHandler.error(error, {\n                component: 'Game',\n                function: 'loadMapData',\n                mapData\n            });\n            alert('Error loading map. Check console for details.');\n        }\n    };\n\n    const handleCustomMapUpload = (event) => {\n        try {\n            const file = event.target.files[0];\n            if (!file) return;\n\n            const fileReader = new FileReader();\n            fileReader.readAsText(file, \"UTF-8\");\n            fileReader.onload = (e) => {\n                try {\n                    const loaded = JSON.parse(e.target.result);\n                    loadMapData(loaded);\n                } catch (error) {\n                    errorHandler.error(error, {\n                        component: 'Game',\n                        function: 'handleCustomMapUpload',\n                        fileName: file.name\n                    });\n                    alert(\"Invalid map file! Check console for details.\");\n                }\n            };\n            fileReader.onerror = (error) => {\n                errorHandler.error(error, {\n                    component: 'Game',\n                    function: 'handleCustomMapUpload',\n                    fileName: file.name,\n                    phase: 'fileReader'\n                });\n                alert(\"Error reading file!\");\n            };\n        } catch (error) {\n            errorHandler.error(error, {\n                component: 'Game',\n                function: 'handleCustomMapUpload'\n            });\n        }\n    };\n\n    return (\n        <GameContainer onClick={() => {\n            window.dispatchEvent(new CustomEvent('game-sound-user-gesture'));\n        }}>\n        \n            {/* Game Header */}\n            {/* UI Overlays */}\n            {playerState?.isWinning && (\n                <WinCounterOverlay>\n                    {Math.floor(playerState.winCounter || 0)}\n                </WinCounterOverlay>\n            )}\n\n            {gameMessage.text && (\n                <MessageOverlay $isVisible={gameMessage.isVisible}>\n                    <h2>{gameMessage.text}</h2>\n                </MessageOverlay>\n            )}\n\n            <GameHeader \n                health={playerState.health} \n                maxHealth={playerState.maxHealth}\n                ammo={playerState.ammo || 0} \n                oxygen={playerState.oxygen}\n                maxOxygen={playerState.maxOxygen}\n                lavaResist={playerState.lavaResist}\n                maxLavaResist={playerState.maxLavaResist}\n                iceResist={playerState.iceResist}\n                maxIceResist={playerState.maxIceResist}\n                strength={playerState.strength}\n                maxStrength={playerState.maxStrength}\n                radioactivity={playerState.radioactivity}\n                maxRadioactivity={playerState.maxRadioactivity}\n                inWater={playerState.inWater}\n                liquidType={playerState.liquidType}\n                onIce={playerState.onIce}\n            />\n\n\n            {isGameOver && (\n                <GameOverOverlay>\n                    <GameOverTitle>Game Over</GameOverTitle>\n                    <ReplayButton onClick={handleReplay}>\n                        REPLAY \n                    </ReplayButton>\n                </GameOverOverlay>\n            )}\n\n            {isMapModalOpen && (\n                <ModalOverlay>\n                    <ModalContent>\n                        <ModalTitle>Select a Map</ModalTitle>\n                        <MapList>\n                            {BUILT_IN_MAPS.map((map, index) => {\n                                const isV2 = map.meta?.version === \"2.0\";\n                                const projectName = map.meta?.projectName || map.meta?.name || \"Unnamed Map\";\n                                const author = map.meta?.author || \"Unknown\";\n                                \n                                let sizeInfo = \"\";\n                                let subMapInfo = \"\";\n\n                                if (isV2 && map.maps) {\n                                    const mainMap = map.maps[map.meta?.activeMapId || 'main'] || Object.values(map.maps)[0];\n                                    if (mainMap) {\n                                        sizeInfo = `${mainMap.width}x${mainMap.height}`;\n                                    }\n                                    \n                                    const mapValues = Object.values(map.maps);\n                                    const overworldCount = mapValues.filter(m => m.type === 'overworld').length;\n                                    const underworldCount = mapValues.filter(m => m.type === 'underworld').length;\n                                    \n                                    subMapInfo = ` (O:${overworldCount}, U:${underworldCount})`;\n                                } else {\n                                    sizeInfo = `${map.meta?.width || map.width || 0}x${map.meta?.height || map.height || 0}`;\n                                }\n\n                                return (\n                                    <MapCard key={index} onClick={() => loadMapData(map)}>\n                                        <div>\n                                            <MapTitle>{projectName}</MapTitle>\n                                            <MapAuthor>By: {author}</MapAuthor>\n                                        </div>\n                                        {map.meta?.description && (\n                                            <MapDescription title={map.meta.description}>\n                                                {map.meta.description}\n                                            </MapDescription>\n                                        )}\n                                        <MapInfo>\n                                            <div>Size: {sizeInfo}{subMapInfo}</div>\n                                        </MapInfo>\n                                    </MapCard>\n                                );\n                            })}\n                        </MapList>\n                        <ModalDivider>\n                            <FileUploadLabel>\n                                 Load Custom Map from Computer\n                                <HiddenFileInput type=\"file\" accept=\".json\" onChange={handleCustomMapUpload} />\n                            </FileUploadLabel>\n                        </ModalDivider>\n                    </ModalContent>\n                </ModalOverlay>\n            )}\n\n            <Viewport\n                ref={viewportRef}\n                $blurred={isMapModalOpen}\n            >\n                {activeMapData ? (\n                    <GameCanvas>\n                    \n                        {/* PIXI RENDERER */}\n                        <PixiStage\n                            mapWidth={mapWidth}\n                            mapHeight={mapHeight}\n                            tileSize={32}\n                            tileMapData={tileMapData}\n                            objectMapData={objectMapData}\n                            secretMapData={secretMapData}\n                            revealedSecrets={revealedSecrets}\n                            objectTextureIndices={objectTextureIndices}\n                            registryItems={registryItems}\n                            playerState={playerState}\n                            playerVisuals={playerVisuals}\n                            projectiles={playerState.projectiles || []}\n                            objectMetadata={objectMetadata}\n                            backgroundImage={activeMapData?.meta?.backgroundImage}\n                            backgroundColor={activeMapData?.meta?.backgroundColor}\n                            backgroundParallaxFactor={(runtimeSettings.backgroundParallaxFactor ?? activeMapData?.meta?.backgroundParallaxFactor)}\n                            cameraScrollX={cameraScrollX}\n                            weatherRain={runtimeSettings.weatherRain ?? 0}\n                            weatherLavaRain={runtimeSettings.weatherLavaRain ?? 0}\n                            weatherSnow={runtimeSettings.weatherSnow ?? 0}\n                            weatherMeteorRain={runtimeSettings.weatherMeteorRain ?? 0}\n                            weatherClouds={runtimeSettings.weatherClouds ?? 0}\n                            weatherFog={runtimeSettings.weatherFog ?? 0}\n                            weatherRadioactiveFog={runtimeSettings.weatherRadioactiveFog ?? 0}\n                            weatherThunder={runtimeSettings.weatherThunder ?? 0}\n                            onWeatherEffectHit={(type, data) => handleStateUpdate('weatherEffectHit', { type, data })}\n                            healthBarEnabled={runtimeSettings.healthBarEnabled ?? true}\n                            oxygenBarEnabled={runtimeSettings.oxygenBarEnabled ?? true}\n                            lavaBarEnabled={runtimeSettings.lavaBarEnabled ?? true}\n                            waterSplashesEnabled={runtimeSettings.waterSplashesEnabled ?? true}\n                            lavaEmbersEnabled={runtimeSettings.lavaEmbersEnabled ?? true}\n                            isEditor={false}\n                        />\n\n                    </GameCanvas>\n                ) : (\n                    <PlaceholderMessage>Select a map to start playing</PlaceholderMessage>\n                )}\n            </Viewport>\n\n            {/* Background music runtime player */}\n            <BackgroundMusicPlayer metaPath={activeMapData?.meta?.backgroundMusic} enabled={soundEnabled} volume={0.6} />\n\n            {/* Overlays at root level so they sit above the canvas and slide from the footer area */}\n            <GameSettings />\n            <GameTerminal />\n        </GameContainer>\n    );\n}\n","// Progressive save utility for web: prefers File System Access API (Chromium)\n// Fallbacks to classic Blob download when not available or when permission denied.\n\n/**\n * Save a file, letting the user choose directory/filename when supported.\n * @param {string|Blob|Uint8Array} contents - Data to write\n * @param {string} suggestedName - Suggested filename, e.g., \"my_map.json\"\n * @param {string} mimeType - MIME type, e.g., \"application/json\"\n * @returns {Promise<boolean>} true if saved, false if cancelled or failed\n */\nexport async function saveFile(contents, suggestedName = 'file.txt', mimeType = 'application/octet-stream') {\n  try {\n    // Prefer native file picker if available (Chromium: Edge/Chrome/Opera/Brave)\n    const hasPicker = typeof window !== 'undefined' && typeof window.showSaveFilePicker === 'function';\n    if (hasPicker) {\n      const opts = {\n        suggestedName,\n        types: [\n          {\n            description: 'File',\n            accept: { [mimeType || 'application/octet-stream']: [`.${(suggestedName.split('.').pop() || 'dat')}`] }\n          }\n        ]\n      };\n      let handle;\n      try {\n        handle = await window.showSaveFilePicker(opts);\n      } catch (e) {\n        // User cancelled the dialog\n        if (e && (e.name === 'AbortError' || e.name === 'NotAllowedError')) return false;\n        throw e;\n      }\n\n      const writable = await handle.createWritable();\n      const blob = contents instanceof Blob ? contents : new Blob([contents], { type: mimeType });\n      await writable.write(blob);\n      await writable.close();\n      return true;\n    }\n  } catch (e) {\n    // fall through to fallback\n    try { console.warn('Native save picker failed, using download fallback:', e); } catch {}\n  }\n\n  // Fallback: trigger a download to the browser default location\n  try {\n    const blob = contents instanceof Blob ? contents : new Blob([contents], { type: mimeType });\n    const link = document.createElement('a');\n    link.href = URL.createObjectURL(blob);\n    link.download = suggestedName || 'file.dat';\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n    setTimeout(() => URL.revokeObjectURL(link.href), 0);\n    return true;\n  } catch (e) {\n    try { console.error('Download fallback failed:', e); } catch {}\n    return false;\n  }\n}\n\nexport default saveFile;\n","import saveFile from '../../../../utilities/saveFile';\nimport errorHandler from '../../../../services/errorHandler';\n\nexport const saveMap = async ({\n    maps,\n    activeMapId,\n    mapName,\n    creatorName,\n    mapDescription,\n    createdAt,\n    registryItems,\n    setCreatedAt\n}) => {\n    const currentDate = new Date().toISOString();\n    const createdDate = createdAt || currentDate;\n\n    const projectData = {\n        meta: {\n            version: \"2.0\",\n            projectName: mapName,\n            author: creatorName,\n            description: mapDescription,\n            date_created: createdDate,\n            date_last_updated: currentDate,\n            activeMapId: activeMapId\n        },\n        maps: {}\n    };\n\n    // Serialize all maps\n    Object.values(maps).forEach(map => {\n        const filledBlocks = map.tileMapData.filter(t => t !== null).length;\n        const objectsCount = map.objectMapData.filter(o => o !== null).length;\n        \n        projectData.maps[map.id] = {\n            id: map.id,\n            name: map.name,\n            description: map.description || '',\n            type: map.type,\n            width: map.mapWidth,\n            height: map.mapHeight,\n            backgroundImage: map.selectedBackgroundImage || null,\n            backgroundColor: map.selectedBackgroundColor || null,\n            backgroundParallaxFactor: map.backgroundParallaxFactor || 0.3,\n            backgroundMusic: map.selectedBackgroundMusic || null,\n            weather: map.weather || { rain: 0, snow: 0, clouds: 0, fog: 0, thunder: 0 },\n            objectMetadata: map.objectMetadata || {},\n            playerPosition: map.playerPosition || null,\n            worldX: map.worldX || 0,\n            worldY: map.worldY || 0,\n            statistics: {\n                total_tiles: map.mapWidth * map.mapHeight,\n                filled_tiles: filledBlocks,\n                total_objects: objectsCount\n            },\n            layers: [\n                { type: \"tile\", name: \"background\", data: map.tileMapData },\n                { type: \"object\", name: \"entities\", data: map.objectMapData },\n                { type: \"secret\", name: \"secrets\", data: map.secretMapData || Array(map.mapWidth * map.mapHeight).fill(null) }\n            ]\n        };\n    });\n\n    const fileName = `${mapName.replace(/\\s+/g, '_')}.json`;\n    const json = JSON.stringify(projectData, null, 2);\n\n    try {\n        const saved = await saveFile(json, fileName, 'application/json');\n        if (saved) {\n            if (!createdAt) setCreatedAt(currentDate);\n            errorHandler.info('Project saved successfully', {\n                component: 'Editor',\n                projectName: mapName,\n                fileName,\n                mapsCount: Object.keys(maps).length\n            });\n        }\n    } catch (error) {\n        errorHandler.error(error, {\n            component: 'Editor',\n            function: 'saveMap',\n            mapName,\n            fileName\n        });\n        alert('Failed to save project. Check console for details.');\n    }\n};\n\nexport const applyMapData = (loaded, {\n    setMapWidth,\n    setMapHeight,\n    setMapName,\n    setCreatorName,\n    setMapDescription,\n    setCreatedAt,\n    setSelectedBackgroundImage,\n    setSelectedBackgroundColor,\n    setBackgroundParallaxFactor,\n    setSelectedBackgroundMusic,\n    setPlayerPosition,\n    setTileMapData,\n    setObjectMapData,\n    setSecretMapData,\n    setObjectMetadata,\n    setWeatherRain,\n    setWeatherSnow,\n    setWeatherClouds,\n    setWeatherFog,\n    setWeatherThunder,\n    setWeatherLavaRain,\n    setWeatherRadioactiveFog,\n    setWeatherMeteorRain,\n    // Multi-map setters\n    setMaps,\n    setActiveMapId\n}) => {\n    try {\n        // Check for multi-map format (version 2.0)\n        if (loaded.meta && loaded.meta.version === \"2.0\" && loaded.maps) {\n            const projectMaps = {};\n            \n            Object.keys(loaded.maps).forEach(mapId => {\n                const m = loaded.maps[mapId];\n                const bgLayer = m.layers.find(l => l.type === 'tile');\n                const objLayer = m.layers.find(l => l.type === 'object');\n                const secretLayer = m.layers.find(l => l.type === 'secret');\n                \n                projectMaps[mapId] = {\n                    id: mapId,\n                    name: m.name,\n                    description: m.description || '',\n                    type: m.type || 'overworld',\n                    mapWidth: m.width,\n                    mapHeight: m.height,\n                    tileMapData: bgLayer ? bgLayer.data : Array(m.width * m.height).fill(null),\n                    objectMapData: objLayer ? objLayer.data : Array(m.width * m.height).fill(null),\n                    secretMapData: secretLayer ? secretLayer.data : Array(m.width * m.height).fill(null),\n                    objectMetadata: m.objectMetadata || {},\n                    selectedBackgroundImage: m.backgroundImage,\n                    selectedBackgroundColor: m.backgroundColor,\n                    backgroundParallaxFactor: m.backgroundParallaxFactor || 0.3,\n                    selectedBackgroundMusic: m.backgroundMusic,\n                    weather: m.weather || { rain: 0, snow: 0, clouds: 0, fog: 0, thunder: 0 },\n                    playerPosition: m.playerPosition || null,\n                    worldX: m.worldX || 0,\n                    worldY: m.worldY || 0\n                };\n            });\n            \n            setMaps(projectMaps);\n            setMapName(loaded.meta.projectName || \"Loaded Project\");\n            setCreatorName(loaded.meta.author || \"Anonymous\");\n            setMapDescription(loaded.meta.description || \"\");\n            setCreatedAt(loaded.meta.date_created || new Date().toISOString());\n            \n            const activeId = loaded.meta.activeMapId || Object.keys(projectMaps)[0];\n            setActiveMapId(activeId);\n            \n            const activeMap = projectMaps[activeId];\n            if (activeMap) {\n                setMapWidth(activeMap.mapWidth);\n                setMapHeight(activeMap.mapHeight);\n                setTileMapData(activeMap.tileMapData);\n                setObjectMapData(activeMap.objectMapData);\n                setSecretMapData(activeMap.secretMapData);\n                setObjectMetadata(activeMap.objectMetadata);\n                setSelectedBackgroundImage(activeMap.selectedBackgroundImage);\n                setSelectedBackgroundColor(activeMap.selectedBackgroundColor);\n                setBackgroundParallaxFactor(activeMap.backgroundParallaxFactor);\n                setSelectedBackgroundMusic(activeMap.selectedBackgroundMusic);\n                \n                setWeatherRain(activeMap.weather.rain);\n                setWeatherSnow(activeMap.weather.snow);\n                setWeatherClouds(activeMap.weather.clouds);\n                setWeatherFog(activeMap.weather.fog);\n                setWeatherThunder(activeMap.weather.thunder);\n                setWeatherLavaRain(activeMap.weather.lavaRain || 0);\n                setWeatherRadioactiveFog(activeMap.weather.radioactiveFog || 0);\n                setWeatherMeteorRain(activeMap.weather.meteorRain || 0);\n\n                if (activeMap.playerPosition) setPlayerPosition(activeMap.playerPosition);\n            }\n            \n            errorHandler.info('Project loaded successfully', {\n                component: 'Editor',\n                projectName: loaded.meta.projectName\n            });\n        } else if (loaded.meta) {\n            // Legacy 1.0 format\n            setMapWidth(loaded.meta.width);\n            setMapHeight(loaded.meta.height);\n\n            if (loaded.meta.name) setMapName(loaded.meta.name);\n            if (loaded.meta.author) setCreatorName(loaded.meta.author);\n            if (loaded.meta.date_map_created_at) setCreatedAt(loaded.meta.date_map_created_at);\n\n            const bgLayer = loaded.layers.find(l => l.name === 'background');\n            const objLayer = loaded.layers.find(l => l.name === 'entities');\n            const secretLayer = loaded.layers.find(l => l.name === 'secrets');\n            \n            const singleMap = {\n                id: 'main',\n                name: loaded.meta.name || \"Main Map\",\n                type: 'overworld',\n                mapWidth: loaded.meta.width,\n                mapHeight: loaded.meta.height,\n                tileMapData: bgLayer ? bgLayer.data : Array(loaded.meta.width * loaded.meta.height).fill(null),\n                objectMapData: objLayer ? objLayer.data : Array(loaded.meta.width * loaded.meta.height).fill(null),\n                secretMapData: secretLayer ? secretLayer.data : Array(loaded.meta.width * loaded.meta.height).fill(null),\n                objectMetadata: loaded.meta.objectMetadata || {},\n                selectedBackgroundImage: loaded.meta.backgroundImage,\n                selectedBackgroundColor: loaded.meta.backgroundColor,\n                backgroundParallaxFactor: loaded.meta.backgroundParallaxFactor || 0.3,\n                selectedBackgroundMusic: loaded.meta.backgroundMusic,\n                weather: loaded.meta.weather || { rain: 0, snow: 0, clouds: 0, fog: 0, thunder: 0 },\n                playerPosition: null\n            };\n\n            setMaps({ 'main': singleMap });\n            setActiveMapId('main');\n\n            if (bgLayer) setTileMapData(bgLayer.data);\n            if (objLayer) setObjectMapData(objLayer.data);\n            if (secretLayer) setSecretMapData(secretLayer.data);\n            \n            // Set other states\n            if (loaded.meta.backgroundImage) setSelectedBackgroundImage(loaded.meta.backgroundImage);\n            if (loaded.meta.backgroundColor) setSelectedBackgroundColor(loaded.meta.backgroundColor);\n            if (loaded.meta.backgroundParallaxFactor !== undefined) setBackgroundParallaxFactor(loaded.meta.backgroundParallaxFactor);\n            if (loaded.meta.backgroundMusic) setSelectedBackgroundMusic(loaded.meta.backgroundMusic);\n            if (loaded.meta.objectMetadata) setObjectMetadata(loaded.meta.objectMetadata);\n            if (loaded.meta.weather) {\n                setWeatherRain(loaded.meta.weather.rain || 0);\n                setWeatherSnow(loaded.meta.weather.snow || 0);\n                setWeatherClouds(loaded.meta.weather.clouds || 0);\n                setWeatherFog(loaded.meta.weather.fog || 0);\n                setWeatherThunder(loaded.meta.weather.thunder || 0);\n                setWeatherLavaRain(loaded.meta.weather.lavaRain || 0);\n                setWeatherRadioactiveFog(loaded.meta.weather.radioactiveFog || 0);\n                setWeatherMeteorRain(loaded.meta.weather.meteorRain || 0);\n            }\n            if (loaded.meta.playerPosition) setPlayerPosition(loaded.meta.playerPosition);\n\n            errorHandler.info('Map loaded successfully (Converted to Project)', {\n                component: 'Editor',\n                mapName: loaded.meta.name\n            });\n        } else {\n            // Oldest format\n            if (loaded.width) setMapWidth(loaded.width);\n            if (loaded.height) setMapHeight(loaded.height);\n            if (loaded.tiles) setTileMapData(loaded.tiles);\n            setObjectMapData(Array(loaded.width * loaded.height).fill(null));\n\n            errorHandler.warn('Loaded map in legacy format', {\n                component: 'Editor'\n            });\n        }\n    } catch (error) {\n        errorHandler.error(error, {\n            component: 'Editor',\n            function: 'applyMapData'\n        });\n        alert('Error applying map data. Check console for details.');\n    }\n};\n\nexport const loadMap = ({\n    event,\n    ...setters\n}) => {\n    const fileReader = new FileReader();\n    const file = event.target.files[0];\n    if (file) {\n        fileReader.readAsText(file, \"UTF-8\");\n        fileReader.onload = (e) => {\n            try {\n                const loaded = JSON.parse(e.target.result);\n                applyMapData(loaded, setters);\n            } catch (error) {\n                errorHandler.error(error, {\n                    component: 'Editor',\n                    function: 'loadMap',\n                    fileName: file.name\n                });\n                alert('Error loading map. Check console for details.');\n            }\n        };\n        fileReader.onerror = (error) => {\n            errorHandler.error(error, {\n                component: 'Editor',\n                function: 'loadMap',\n                fileName: file.name,\n                phase: 'fileReader'\n            });\n            alert('Error reading file!');\n        };\n    }\n};\n\nexport const loadBuiltInMap = ({\n    mapData,\n    ...setters\n}) => {\n    try {\n        applyMapData(mapData, setters);\n    } catch (error) {\n        errorHandler.error(error, {\n            component: 'Editor',\n            function: 'loadBuiltInMap'\n        });\n        alert('Error loading built-in map.');\n    }\n};\n\nexport const clearMap = ({ mapWidth, mapHeight, setTileMapData, setObjectMapData, setSecretMapData, setObjectMetadata }) => {\n    if (window.confirm(\"Are you sure you want to clear the map?\")) {\n        const size = mapWidth * mapHeight;\n        setTileMapData(Array(size).fill(null));\n        setObjectMapData(Array(size).fill(null));\n        setSecretMapData(Array(size).fill(null));\n        setObjectMetadata({});\n    }\n};\n\nexport const resizeMapData = ({ newWidth, newHeight, stateRef, setMapWidth, setMapHeight, setTileMapData, setObjectMapData, setSecretMapData, setObjectMetadata }) => {\n    const { mapWidth: oldW, mapHeight: oldH, tileMapData: oldTiles, objectMapData: oldObjs, secretMapData: oldSecrets, objectMetadata: oldMeta } = stateRef.current;\n    if (newWidth < 1 || newHeight < 1) return;\n    if (newWidth === oldW && newHeight === oldH) return;\n\n    const resizeArray = (oldArr) => {\n        const newArr = Array(newWidth * newHeight).fill(null);\n        if (!oldArr) return newArr;\n        for (let y = 0; y < Math.min(oldH, newHeight); y++) {\n            for (let x = 0; x < Math.min(oldW, newWidth); x++) {\n                newArr[y * newWidth + x] = oldArr[y * oldW + x];\n            }\n        }\n        return newArr;\n    };\n\n    const resizeMetadata = (oldM) => {\n        const newM = {};\n        if (!oldM) return newM;\n        for (let y = 0; y < Math.min(oldH, newHeight); y++) {\n            for (let x = 0; x < Math.min(oldW, newWidth); x++) {\n                const oldIdx = y * oldW + x;\n                const newIdx = y * newWidth + x;\n                if (oldM[oldIdx]) {\n                    newM[newIdx] = oldM[oldIdx];\n                }\n            }\n        }\n        return newM;\n    };\n\n    setMapWidth(newWidth);\n    setMapHeight(newHeight);\n    setTileMapData(resizeArray(oldTiles));\n    setObjectMapData(resizeArray(oldObjs));\n    setSecretMapData(resizeArray(oldSecrets));\n    setObjectMetadata(resizeMetadata(oldMeta));\n};\n","import React from 'react';\n\nexport const ObjectLinks = React.memo(({ mapWidth, mapHeight, objectMapData, objectMetadata }) => {\n    const links = [];\n    const portals = [];\n    const targets = [];\n\n    // Collect all portals and targets with Trigger IDs\n    objectMapData.forEach((id, index) => {\n        if (!id) return;\n        const metadata = objectMetadata?.[index];\n        if (!metadata || metadata.triggerId === undefined || metadata.triggerId === null) return;\n\n        const x = (index % mapWidth) * 32 + 16;\n        const y = Math.floor(index / mapWidth) * 32 + 16;\n\n        if (id.includes('portal') && !id.includes('target')) {\n            portals.push({ x, y, id: metadata.triggerId });\n        } else if (id.includes('target') || id === 'portal_target') {\n            targets.push({ x, y, id: metadata.triggerId });\n        }\n    });\n\n    // Draw lines between matching IDs\n    portals.forEach(p => {\n        targets.forEach(t => {\n            if (p.id === t.id) {\n                links.push(\n                    <line\n                        key={`link-${p.x}-${p.y}-${t.x}-${t.y}`}\n                        x1={p.x} y1={p.y}\n                        x2={t.x} y2={t.y}\n                        stroke=\"#fff\"\n                        strokeWidth=\"2\"\n                        strokeDasharray=\"5,5\"\n                    />\n                );\n            }\n        });\n    });\n\n    return (\n        <svg style={{\n            position: 'absolute',\n            top: 0,\n            left: 0,\n            width: mapWidth * 32,\n            height: mapHeight * 32, // Note: mapHeight must be available\n            zIndex: 10,\n            pointerEvents: 'none',\n            opacity: 0.6\n        }}>\n            {links}\n        </svg>\n    );\n});\n","import React, { useState, useEffect } from 'react';\n\nconst AnimatedItem = ({ textures, texture, speed, style, alt, className, spriteSheet }) => {\n    const [index, setIndex] = useState(0);\n\n    useEffect(() => {\n        // Ja ir vairkas tekstras, skam animciju\n        if (textures && textures.length > 1) {\n            const interval = setInterval(() => {\n                setIndex((prevIndex) => (prevIndex + 1) % textures.length);\n            }, speed || 500); // Noklusjuma trums 500ms\n\n            return () => clearInterval(interval);\n        }\n    }, [textures, speed]);\n\n    // Izvlamies ko rendert: animcijas kadru, viengo tekstru vai statisko bildi\n    let imgSrc = null;\n    if (textures && textures.length > 0) {\n        imgSrc = textures[index % textures.length];\n    } else if (texture) {\n        imgSrc = texture;\n    }\n\n    if (!imgSrc) return null;\n\n    // Ja ir spraitts, rdm tikai pirmo kadru (vai citu, ja nordts)\n    if (spriteSheet && spriteSheet.enabled) {\n        const columns = spriteSheet.columns || 1;\n        const total = spriteSheet.totalSprites || 1;\n        const rows = Math.ceil(total / columns);\n        \n        // Editor parasti rdm pirmo kadru (index 0)\n        const frameIndex = 0;\n        const col = frameIndex % columns;\n        const row = Math.floor(frameIndex / columns);\n\n        return (\n            <div className={className} style={{\n                ...style,\n                overflow: 'hidden',\n                display: 'inline-block',\n                width: style?.width || '32px',\n                height: style?.height || '32px',\n                position: 'relative'\n            }}>\n                <img\n                    src={imgSrc}\n                    alt={alt || ''}\n                    style={{\n                        position: 'absolute',\n                        width: `${columns * 100}%`,\n                        height: `${rows * 100}%`,\n                        left: `-${col * 100}%`,\n                        top: `-${row * 100}%`,\n                        maxWidth: 'none',\n                        maxHeight: 'none',\n                        display: 'block'\n                    }}\n                    draggable={false}\n                />\n            </div>\n        );\n    }\n\n    return (\n        <img\n            src={imgSrc}\n            alt={alt || ''}\n            style={style}\n            className={className}\n            draggable={false}\n        />\n    );\n};\n\nexport default AnimatedItem;","import React from 'react';\nimport AnimatedItem from '../../../../utilities/AnimatedItem';\n\nexport const EditorTile = React.memo(({\n    index,\n    x, y,\n    activeTool,\n    tileObj,\n    objObj,\n    secretObj,\n    objectMetadata,\n    isHighlighted,\n    parentRegionIndex,\n    borderStyle,\n    bgStyle,\n    handleGridMouseDown,\n    handleGridMouseEnter,\n    handleResizeStart,\n    handleMoveStart,\n    filter\n}) => {\n    const isLiquidTile = !!(tileObj && tileObj.flags && tileObj.flags.liquid);\n    const isWaterTile = !!(tileObj && tileObj.flags && tileObj.flags.water);\n    const isLavaTile = !!(tileObj && tileObj.flags && tileObj.flags.lava);\n    const isQuicksandTile = !!(tileObj && tileObj.flags && tileObj.flags.quicksand);\n    const isWaterfallTile = !!(tileObj && tileObj.flags && tileObj.flags.waterfall);\n    const isLavaWaterfallTile = !!(tileObj && tileObj.flags && tileObj.flags.lava_waterfall);\n    const isRadioactiveWaterTile = !!(tileObj && tileObj.flags && tileObj.flags.radioactive_water);\n    const isRadioactiveWaterfallTile = !!(tileObj && tileObj.flags && tileObj.flags.radioactive_waterfall);\n\n    const actualIndex = parentRegionIndex !== null ? parentRegionIndex : index;\n    const triggerId = objectMetadata?.[actualIndex]?.triggerId;\n    const intensity = objectMetadata?.[actualIndex]?.intensity;\n    const width = objectMetadata?.[actualIndex]?.width || 1;\n    const height = objectMetadata?.[actualIndex]?.height || 1;\n\n    const handleMouseDown = (e) => {\n        // If we're clicking a tile that's part of a region, we should interact with the anchor\n        const targetIndex = parentRegionIndex !== null ? parentRegionIndex : index;\n        \n        if (activeTool === 'move') {\n            const hasMovable = objectMetadata[targetIndex] || objObj || secretObj;\n            if (hasMovable) {\n                e.stopPropagation();\n                handleMoveStart(targetIndex);\n                return;\n            }\n        }\n        handleGridMouseDown(index, e);\n    };\n\n    const isResizable = React.useMemo(() => {\n        if (!objObj && !secretObj) return false;\n        // Specifically requested to disable for these types\n        if (secretObj && secretObj.type === 'secret') return false;\n        if (objObj && (objObj.type === 'crack_block' || objObj.type === 'wolf_secret')) return false;\n        return true;\n    }, [objObj, secretObj]);\n\n    const hasObjectOrSecret = objObj || secretObj || (parentRegionIndex !== null);\n\n    return (\n        <div\n            onMouseDown={handleMouseDown}\n            onMouseEnter={() => handleGridMouseEnter(index)}\n            style={{\n                width: '32px',\n                height: '32px',\n                border: borderStyle,\n                backgroundColor: bgStyle,\n                position: 'relative',\n                boxSizing: 'border-box',\n                display: 'flex',\n                alignItems: 'center',\n                justifyContent: 'center',\n                overflow: 'visible',\n                cursor: (activeTool === 'move' && hasObjectOrSecret) ? 'grab' : 'default'\n            }}>\n            \n            {isHighlighted && parentRegionIndex === null && isResizable && (\n                <>\n                    {/* Resize Handles */}\n                    {/* Right */}\n                    <div \n                        onMouseDown={(e) => { e.stopPropagation(); handleResizeStart(index, 'right'); }}\n                        style={{ position: 'absolute', right: `${-(width-1)*32 - 6}px`, top: '50%', transform: 'translateY(-50%)', width: '10px', height: '20px', backgroundColor: 'gold', border: '1px solid #000', borderRadius: '2px', zIndex: 100, cursor: 'ew-resize' }} \n                    />\n                    {/* Left */}\n                    <div \n                        onMouseDown={(e) => { e.stopPropagation(); handleResizeStart(index, 'left'); }}\n                        style={{ position: 'absolute', left: '-6px', top: '50%', transform: 'translateY(-50%)', width: '10px', height: '20px', backgroundColor: 'gold', border: '1px solid #000', borderRadius: '2px', zIndex: 100, cursor: 'ew-resize' }} \n                    />\n                    {/* Bottom */}\n                    <div \n                        onMouseDown={(e) => { e.stopPropagation(); handleResizeStart(index, 'bottom'); }}\n                        style={{ position: 'absolute', bottom: `${-(height-1)*32 - 6}px`, left: '50%', transform: 'translateX(-50%)', width: '20px', height: '10px', backgroundColor: 'gold', border: '1px solid #000', borderRadius: '2px', zIndex: 100, cursor: 'ns-resize' }} \n                    />\n                    {/* Top */}\n                    <div \n                        onMouseDown={(e) => { e.stopPropagation(); handleResizeStart(index, 'top'); }}\n                        style={{ position: 'absolute', top: '-6px', left: '50%', transform: 'translateX(-50%)', width: '20px', height: '10px', backgroundColor: 'gold', border: '1px solid #000', borderRadius: '2px', zIndex: 100, cursor: 'ns-resize' }} \n                    />\n                </>\n            )}\n\n            {/* Tile Layer */}\n            {tileObj && (\n                <div style={{ filter: filter ? filter('tile') : 'none', transition: 'filter 0.3s ease' }}>\n                    {isLiquidTile ? (\n                        <div style={{\n                            width: '32px', height: '32px',\n                            background: isLavaWaterfallTile ? 'rgba(255, 204, 0, 0.7)' : (isLavaTile ? 'rgba(255, 204, 0, 0.7)' : (isWaterTile || isWaterfallTile ? 'rgba(58, 127, 184, 0.7)' : (isQuicksandTile ? 'rgba(218, 165, 32, 0.7)' : (isRadioactiveWaterTile || isRadioactiveWaterfallTile ? 'rgba(50, 205, 50, 0.7)' : 'rgba(0, 255, 255, 0.3)')))),\n                            display: 'flex', alignItems: 'center', justifyContent: 'center', color: '#fff', fontSize: '8px'\n                        }}>\n                            {isLavaWaterfallTile ? 'L.FALL' : (isLavaTile ? 'LAVA' : (isRadioactiveWaterfallTile ? 'RADFALL' : (isRadioactiveWaterTile ? 'RAD' : (isWaterTile ? 'WATER' : (isWaterfallTile ? 'FALL' : (isQuicksandTile ? 'QUICK' : 'LIQ'))))))}\n                        </div>\n                    ) : (\n                        <AnimatedItem\n                            textures={tileObj.textures}\n                            texture={tileObj.texture}\n                            speed={tileObj.animationSpeed}\n                            spriteSheet={tileObj.spriteSheet}\n                            style={{ width: '32px', height: '32px', objectFit: 'cover' }}\n                        />\n                    )}\n                </div>\n            )}\n\n            {/* Secret Layer */}\n            {secretObj && (\n                <div style={{\n                    position: 'absolute', \n                    top: '0', left: '0',\n                    width: `${width * 32}px`,\n                    height: `${height * 32}px`,\n                    backgroundColor: secretObj.filterColorInEditor || secretObj.filterColor || 'rgba(128, 0, 128, 0.4)',\n                    display: 'flex', alignItems: 'center', justifyContent: 'center',\n                    color: '#fff', fontSize: '10px', fontWeight: 'bold', zIndex: 2,\n                    filter: filter ? filter('secret') : 'none', transition: 'filter 0.3s ease',\n                    border: '1px dashed rgba(255,255,255,0.5)',\n                    boxSizing: 'border-box',\n                    pointerEvents: 'none'\n                }}>\n                    {secretObj.editorIcon || 'SECRET'}\n                </div>\n            )}\n\n            {/* Object Layer */}\n            {objObj && (\n                <div style={{\n                    position: 'absolute', \n                    top: '2px',\n                    left: '2px',\n                    width: `${width * 32 - 4}px`,\n                    height: `${height * 32 - 4}px`,\n                    zIndex: 3,\n                    display: 'flex', alignItems: 'center', justifyContent: 'center',\n                    filter: filter ? filter('object') : 'none', transition: 'filter 0.3s ease',\n                    pointerEvents: 'none' // Let clicks pass through to the tile for resizing handles\n                }}>\n                    {objObj.editorIcon ? (\n                        <span style={{ fontSize: '20px', width: '100%', height: '100%', display: 'flex', alignItems: 'center', justifyContent: 'center', backgroundColor: 'rgba(255,255,255,0.1)', border: '1px dashed rgba(255,255,255,0.3)' }}>{objObj.editorIcon}</span>\n                    ) : (\n                        <AnimatedItem\n                            textures={objObj.textures}\n                            texture={objObj.texture}\n                            speed={objObj.animationSpeed}\n                            spriteSheet={objObj.spriteSheet}\n                            style={{ width: '100%', height: '100%', objectFit: 'contain', backgroundColor: 'rgba(255,255,255,0.1)', border: '1px dashed rgba(255,255,255,0.3)' }}\n                        />\n                    )}\n\n                    {/* Trigger ID */}\n                    {triggerId !== undefined && triggerId !== null && (\n                        <div style={{\n                            position: 'absolute', top: '-15px', left: '0',\n                            backgroundColor: 'rgba(0,0,0,0.7)', color: '#fff', padding: '1px 4px',\n                            borderRadius: '3px', fontSize: '10px', whiteSpace: 'nowrap', zIndex: 10, border: '1px solid #fff'\n                        }}>\n                            ID: {triggerId}\n                        </div>\n                    )}\n\n                    {/* Intensity */}\n                    {intensity !== undefined && intensity !== null && objObj && (objObj.type === 'weather_trigger' || objObj.hasIntensity) && (\n                        <div style={{\n                            position: 'absolute', top: '-15px', right: '0',\n                            backgroundColor: 'rgba(0,100,200,0.8)', color: '#fff', padding: '1px 4px',\n                            borderRadius: '3px', fontSize: '10px', whiteSpace: 'nowrap', zIndex: 11, border: '1px solid #fff'\n                        }}>\n                            {intensity}%\n                        </div>\n                    )}\n                </div>\n            )}\n        </div>\n    );\n});\n","import React, { useCallback } from 'react';\nimport { ObjectLinks } from './viewport/ObjectLinks';\nimport { EditorTile } from './viewport/EditorTile';\nimport PixiStage from '../game/PixiStage';\n\nexport const Viewport = ({\n    mapWidth,\n    mapHeight,\n    selectedBackgroundUrl,\n    selectedBackgroundColor,\n    selectedBackgroundImage,\n    showBackgroundImage,\n    showGrid,\n    activeLayer,\n    activeTool,\n    tileMapData,\n    objectMapData,\n    secretMapData,\n    objectMetadata,\n    registryItems,\n    hoverIndex,\n    highlightedIndex,\n    brushSize,\n    bucketPreviewIndices,\n    selection,\n    previewPosition,\n    dragStart,\n    isDragging,\n    handleGridMouseDown,\n    handleGridMouseEnter,\n    handleGridMouseUp,\n    handleGridMouseLeave,\n    handleResizeStart,\n    handleMoveStart,\n    setIsDragging,\n    selectedTile,\n    weatherRain,\n    weatherSnow,\n    weatherClouds,\n    weatherFog,\n    weatherThunder,\n    weatherLavaRain,\n    weatherRadioactiveFog,\n    weatherMeteorRain\n}) => {\n    const isEraserActive = activeTool === 'brush' && selectedTile === null;\n    const isBrushActive = activeTool === 'brush';\n    const isBucketActive = activeTool === 'bucket';\n\n    const regions = React.useMemo(() => {\n        const res = [];\n        if (!objectMetadata) return res;\n        for (const [idxStr, meta] of Object.entries(objectMetadata)) {\n            if (meta.width > 1 || meta.height > 1) {\n                const idx = parseInt(idxStr);\n                res.push({ \n                    idx, \n                    x: idx % mapWidth, \n                    y: Math.floor(idx / mapWidth), \n                    w: meta.width || 1, \n                    h: meta.height || 1 \n                });\n            }\n        }\n        return res;\n    }, [objectMetadata, mapWidth]);\n\n    const getLayerColor = (layer, alpha = 0.5) => {\n        if (layer === 'tile') return `rgba(24, 144, 255, ${alpha})`;\n        if (layer === 'object') return `rgba(245, 34, 45, ${alpha})`;\n        if (layer === 'secret') return `rgba(114, 46, 209, ${alpha})`;\n        return `rgba(255, 255, 255, ${alpha})`;\n    };\n\n    const getGridStyles = () => {\n        let color = 'rgba(255, 255, 255, 0.15)';\n        let visible = showGrid;\n\n        if (isEraserActive) {\n            color = getLayerColor(activeLayer, 0.4);\n            visible = true;\n        } else if (isBrushActive || isBucketActive) {\n            color = getLayerColor(activeLayer, 0.25);\n            visible = true; // Auto-show grid when using drawing tools\n        }\n\n        return {\n            backgroundImage: visible ? `\n                linear-gradient(to right, ${color} 1px, transparent 1px),\n                linear-gradient(to bottom, ${color} 1px, transparent 1px)\n            ` : 'none',\n            backgroundSize: '32px 32px'\n        };\n    };\n\n    const getLayerFilter = useCallback((layer) => {\n        if (!isEraserActive) return 'none';\n        return activeLayer === layer ? 'none' : 'grayscale(100%) opacity(0.2) blur(2px)';\n    }, [isEraserActive, activeLayer]);\n\n    const getOverlayColor = () => {\n        if (!isEraserActive) return 'transparent';\n        if (activeLayer === 'tile') return 'rgba(24, 144, 255, 0.25)'; // Blueish for blocks\n        if (activeLayer === 'object') return 'rgba(245, 34, 45, 0.25)'; // Reddish for objects\n        if (activeLayer === 'secret') return 'rgba(114, 46, 209, 0.25)'; // Purplish for secrets\n        return 'transparent';\n    };\n    return (\n        <div className=\"viewport\"\n            style={{\n                flex: 1, padding: '40px', backgroundColor: '#555',\n                overflow: 'auto', position: 'relative', userSelect: 'none'\n            }}\n            onMouseUp={() => handleGridMouseUp(hoverIndex)}>\n            <div style={{ position: 'relative', width: 'fit-content' }} onMouseLeave={handleGridMouseLeave}>\n                \n                <ObjectLinks \n                    mapWidth={mapWidth} \n                    mapHeight={mapHeight} \n                    objectMapData={objectMapData} \n                    objectMetadata={objectMetadata} \n                />\n\n                <div\n                    style={{\n                        position: 'absolute', top: 0, left: 0,\n                        width: mapWidth * 32, height: mapHeight * 32,\n                        backgroundImage: (selectedBackgroundUrl && showBackgroundImage && !isEraserActive) ? `url(${selectedBackgroundUrl})` : 'none',\n                        backgroundColor: (isEraserActive || !showBackgroundImage || !selectedBackgroundUrl) ? selectedBackgroundColor : 'transparent',\n                        backgroundRepeat: 'repeat-x', backgroundSize: 'auto 100%',\n                        zIndex: 0, pointerEvents: 'none'\n                    }}\n                />\n\n                <div\n                    style={{\n                        position: 'absolute', top: 0, left: 0,\n                        width: mapWidth * 32, height: mapHeight * 32,\n                        backgroundColor: getOverlayColor(),\n                        zIndex: 5, pointerEvents: 'none',\n                        transition: 'background-color 0.3s ease'\n                    }}\n                />\n\n                {/* Top Grid Overlay */}\n                <div\n                    style={{\n                        position: 'absolute', top: 0, left: 0,\n                        width: mapWidth * 32, height: mapHeight * 32,\n                        zIndex: 10, pointerEvents: 'none',\n                        ...getGridStyles()\n                    }}\n                />\n\n                {/* Weather Effects Overlay */}\n                {(weatherRain > 0 || weatherSnow > 0 || weatherClouds > 0 || weatherFog > 0 || weatherThunder > 0 || weatherLavaRain > 0 || weatherRadioactiveFog > 0 || weatherMeteorRain > 0) && (\n                    <div\n                        style={{\n                            position: 'absolute', top: 0, left: 0,\n                            width: mapWidth * 32, height: mapHeight * 32,\n                            zIndex: 15, pointerEvents: 'none',\n                        }}\n                    >\n                        <PixiStage \n                            mapWidth={mapWidth}\n                            mapHeight={mapHeight}\n                            tileSize={32}\n                            tileMapData={[]}\n                            objectMapData={[]}\n                            registryItems={registryItems}\n                            weatherRain={weatherRain}\n                            weatherSnow={weatherSnow}\n                            weatherClouds={weatherClouds}\n                            weatherFog={weatherFog}\n                            weatherThunder={weatherThunder}\n                            weatherLavaRain={weatherLavaRain}\n                            weatherRadioactiveFog={weatherRadioactiveFog}\n                            weatherMeteorRain={weatherMeteorRain}\n                            renderLayers={['weather']}\n                            pointerEvents=\"none\"\n                        />\n                    </div>\n                )}\n\n                <div className=\"grid\"\n                    style={{\n                        display: 'grid',\n                        gridTemplateColumns: `repeat(${mapWidth}, 32px)`,\n                        gridTemplateRows: `repeat(${mapHeight}, 32px)`,\n                        gap: '0px', border: '1px solid #444', backgroundColor: 'transparent',\n                        position: 'relative', cursor: activeTool === 'bucket' ? 'cell' : 'default',\n                        zIndex: 1\n                    }}>\n                    {Array(mapWidth * mapHeight).fill(0).map((_, index) => {\n                        const x = index % mapWidth;\n                        const y = Math.floor(index / mapWidth);\n\n                        let dTileId = tileMapData[index];\n                        let dObjId = objectMapData[index];\n                        let dSecId = secretMapData?.[index];\n\n                        if (selection && previewPosition) {\n                            const { w, h } = selection;\n                            const px = previewPosition.x;\n                            const py = previewPosition.y;\n                            if (x >= px && x < px + w && y >= py && y < py + h) {\n                                const idx = (y - py) * w + (x - px);\n                                dTileId = selection.tileData[idx];\n                                dObjId = selection.objectData[idx];\n                                dSecId = selection.secretData?.[idx];\n                            }\n                        }\n\n                        const tileObj = dTileId ? registryItems.find(r => r.id === dTileId) : null;\n                        const objObj = dObjId ? registryItems.find(r => r.id === dObjId) : null;\n                        const secretObj = dSecId ? registryItems.find(r => r.id === dSecId) : null;\n\n                        let borderStyle = 'none';\n                        let bgStyle = 'transparent';\n\n                        const layerColor = getLayerColor(activeLayer, 1);\n\n                        if (activeTool === 'brush' && hoverIndex !== null) {\n                            const hx = hoverIndex % mapWidth;\n                            const hy = Math.floor(hoverIndex / mapWidth);\n                            if (x >= hx && x < hx + brushSize && y >= hy && y < hy + brushSize) {\n                                borderStyle = `1px dashed ${layerColor}`;\n                                if (isEraserActive) bgStyle = 'rgba(255, 0, 0, 0.1)';\n                            }\n                        } else if (activeTool === 'bucket') {\n                            if (bucketPreviewIndices.has(index)) { borderStyle = '1px dashed orange'; bgStyle = 'rgb(168,187,220)'; }\n                            else if (hoverIndex === index) borderStyle = '2px solid orange';\n                        } else if (activeTool === 'move') {\n                            if (isDragging && dragStart && hoverIndex !== null) {\n                                const hx = hoverIndex % mapWidth;\n                                const hy = Math.floor(hoverIndex / mapWidth);\n                                const minX = Math.min(dragStart.x, hx);\n                                const minY = Math.min(dragStart.y, hy);\n                                const maxX = Math.max(dragStart.x, hx);\n                                const maxY = Math.max(dragStart.y, hy);\n                                if (x >= minX && x <= maxX && y >= minY && y <= maxY) { borderStyle = '1px dashed blue'; bgStyle = 'rgba(0, 0, 255, 0.1)'; }\n                            } else if (!isDragging && hoverIndex === index) borderStyle = '2px solid blue';\n                        }\n\n                        if (highlightedIndex === index) { borderStyle = '3px solid gold'; bgStyle = 'rgba(255, 215, 0, 0.4)'; }\n                        \n                        const selX = previewPosition ? previewPosition.x : (selection ? selection.x : 0);\n                        const selY = previewPosition ? previewPosition.y : (selection ? selection.y : 0);\n                        if (selection && x >= selX && x < selX + selection.w && y >= selY && y < selY + selection.h) {\n                            if (previewPosition && (previewPosition.x !== selection.originalX || previewPosition.y !== selection.originalY)) {\n                                borderStyle = '2px solid cyan'; bgStyle = 'rgba(0, 255, 255, 0.2)';\n                            } else {\n                                borderStyle = '1px dashed red'; bgStyle = 'rgba(255, 255, 0, 0.3)';\n                            }\n                        }\n\n                        const parentRegion = regions.find(r => x >= r.x && x < r.x + r.w && y >= r.y && y < r.y + r.h);\n\n                        return (\n                            <EditorTile \n                                key={index}\n                                index={index}\n                                x={x} y={y}\n                                activeTool={activeTool}\n                                tileObj={tileObj}\n                                objObj={objObj}\n                                secretObj={secretObj}\n                                objectMetadata={objectMetadata}\n                                isHighlighted={highlightedIndex === index || (parentRegion && highlightedIndex === parentRegion.idx)}\n                                parentRegionIndex={parentRegion ? parentRegion.idx : null}\n                                borderStyle={borderStyle}\n                                bgStyle={bgStyle}\n                                handleGridMouseDown={handleGridMouseDown}\n                                handleGridMouseEnter={handleGridMouseEnter}\n                                handleResizeStart={handleResizeStart}\n                                handleMoveStart={handleMoveStart}\n                                filter={getLayerFilter}\n                            />\n                        );\n                    })}\n                </div>\n            </div>\n        </div>\n    );\n};\n","import styled from 'styled-components';\n\nexport const EditorToolsContainer = styled.div`\n    display: contents;\n`;\n\nexport const HeaderBar = styled.div`\n    padding: 0 15px;\n    background-color: #222;\n    border-bottom: 1px solid #000;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    font-weight: bold;\n    font-size: 12px;\n    height: 60px;\n    box-sizing: border-box;\n    color: #fff;\n    z-index: 1000;\n    position: relative;\n`;\n\nexport const ToolsSection = styled.div`\n    display: flex;\n    gap: 15px;\n    align-items: center;\n`;\n\nexport const ToolsGroup = styled.div`\n    display: flex;\n    gap: 10px;\n    align-items: center;\n`;\n\nexport const ToolsInnerGroup = styled.div`\n    display: flex;\n    gap: 10px;\n`;\n\nexport const ToolsRow = styled.div`\n    display: flex;\n    gap: 10px;\n`;\n\nexport const ToolsEditorButton = styled.button`\n    min-width: 40px;\n    height: 40px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    gap: 8px;\n    cursor: pointer;\n    background-color: ${props => props.$active ? '#e3de0a' : (props.$variant === 'play' ? '#4CAF50' : (props.$variant === 'pause' ? '#FF9800' : (props.$variant === 'danger' ? '#dc3545' : (props.$variant === 'secondary' ? '#f0f0f0' : '#333'))))};\n    color: ${props => props.$variant === 'secondary' ? '#333' : '#fff'};\n    border: 1px solid ${props => props.$active ? '#1E88E5' : (props.$variant === 'play' ? '#388E3C' : (props.$variant === 'pause' ? '#F57C00' : (props.$variant === 'danger' ? '#c82333' : (props.$variant === 'secondary' ? '#ccc' : '#fff'))))};\n    border-radius: 4px;\n    font-size: ${props => props.$small ? '14px' : '20px'};\n    font-weight: ${props => props.$variant === 'play' || props.$variant === 'pause' ? 'bold' : 'normal'};\n    line-height: 1;\n    transition: all 0.2s ease;\n    box-shadow: 0 2px 4px rgba(0,0,0,0.2);\n    transform: ${props => props.$active ? 'scale(1.05)' : 'none'};\n    padding: ${props => props.$square ? '0' : '0 15px'};\n    width: ${props => props.$square ? '40px' : 'auto'};\n    outline: none;\n    user-select: none;\n    opacity: ${props => props.$disabled ? 0.4 : 1};\n    cursor: ${props => props.$disabled ? 'not-allowed' : 'pointer'};\n    position: relative;\n\n    &:hover {\n        background-color: ${props => props.$active ? '#fdfa9b' : (props.$variant === 'play' ? '#45a049' : (props.$variant === 'pause' ? '#fb8c00' : (props.$variant === 'danger' ? '#bd2130' : (props.$variant === 'secondary' ? '#e0e0e0' : '#444'))))};\n        transform: scale(1.05);\n    }\n\n    &:active {\n        transform: scale(0.95);\n        border: solid 1px #fff;\n    }\n\n    span {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n    }\n`;\n\nexport const StrikeThrough = styled.div`\n    position: absolute;\n    width: 100%;\n    height: 2px;\n    background-color: #f5222d;\n    transform: rotate(-45deg);\n    top: 50%;\n    left: 0;\n    z-index: 2;\n    pointer-events: none;\n`;\n\nexport const LayerIndicator = styled.div`\n    padding: 0 12px;\n    height: 40px;\n    border-radius: 4px;\n    display: flex;\n    align-items: center;\n    font-size: 11px;\n    font-weight: 800;\n    text-transform: uppercase;\n    margin-right: 15px;\n    margin-left: 15px;\n    white-space: nowrap;\n    border: 1px solid;\n    box-sizing: border-box;\n    background-color: ${props => props.$bgColor || '#e6f7ff'};\n    border-color: ${props => props.$borderColor || '#91d5ff'};\n    color: ${props => props.$textColor || '#1890ff'};\n`;\n\nexport const BgColorContainer = styled.div`\n    display: flex;\n    align-items: center;\n    gap: 10px;\n`;\n\nexport const BgColorInputWrapper = styled.div`\n    position: relative;\n    display: flex;\n    align-items: center;\n`;\n\nexport const BgColorInput = styled.input`\n    width: 40px;\n    height: 40px;\n    border: 1px solid #fff;\n    padding: 4px;\n    cursor: pointer;\n    background-color: #333;\n    border-radius: 4px;\n    box-sizing: border-box;\n    box-shadow: 0 2px 4px rgba(0,0,0,0.2);\n    opacity: ${props => props.disabled ? 0.4 : 1};\n    cursor: ${props => props.disabled ? 'not-allowed' : 'pointer'};\n`;\n\nexport const PlayButtonContainer = styled.div`\n    width: 40px;\n    height: 40px;\n    border: 1px solid #fff;\n    padding: 4px;\n    cursor: pointer;\n    background-color: #333;\n    border-radius: 4px;\n    box-sizing: border-box;\n    box-shadow: 0 2px 4px rgba(0,0,0,0.2);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    transition: all 0.2s ease;\n\n    &:hover {\n        transform: scale(1.05);\n        background-color: #444;\n    }\n\n    &:active {\n        transform: scale(0.95);\n    }\n`;\n\nexport const PlayButtonInner = styled.div`\n    width: 100%;\n    height: 100%;\n    border-radius: 2px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background-color: ${props => props.$variant === 'play' ? '#4CAF50' : (props.$variant === 'pause' ? '#FF9800' : '#333')};\n    color: #fff;\n    font-size: 18px;\n    box-sizing: border-box;\n`;\n\nexport const InfoContainer = styled.div`\n    display: flex;\n    flex-direction: column;\n    gap: 2px;\n    align-items: flex-start;\n    color: #bbb;\n    margin-left: auto;\n`;\n\nexport const InfoItem = styled.div`\n    display: flex;\n    align-items: center;\n    gap: 6px;\n`;\n\nexport const InfoLabel = styled.span`\n    font-size: 11px;\n    text-transform: uppercase;\n    opacity: 0.8;\n`;\n\nexport const InfoValue = styled.span`\n    color: #fff;\n    font-size: 12px;\n`;\n\nexport const EraserButtonContainer = styled.div`\n    width: 40px;\n    height: 40px;\n    border: 1px solid ${props => props.$active ? '#e3de0a' : '#fff'};\n    padding: 4px;\n    //cursor: pointer;\n    background-color: #333;\n    border-radius: 4px;\n    box-sizing: border-box;\n    box-shadow: 0 2px 4px rgba(0,0,0,0.2);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    transition: all 0.2s ease;\n    opacity: ${props => props.$disabled ? 0.4 : 1};\n    cursor: ${props => props.$disabled ? 'not-allowed' : 'pointer'};\n    position: relative;\n\n    &:hover {\n        transform: scale(1.05);\n        background-color: #444;\n    }\n\n    &:active {\n        transform: scale(0.95);\n    }\n`;\n\nexport const EraserButtonInner = styled.div`\n    width: 100%;\n    height: 100%;\n    border-radius: 2px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background-color: ${props => props.$active ? (props.$textColor || '#1890ff') : (props.$bgColor || '#f0f0f0')};\n    color: ${props => props.$active ? '#fff' : (props.$textColor || '#000')};\n    font-size: 11px;\n    font-weight: bold;\n    border: ${props => props.$active ? '1px solid #fff' : 'none'};\n    box-sizing: border-box;\n`;\n\nexport const SelectionActions = styled.div`\n    display: flex;\n    gap: 5px;\n    margin-left: 5px;\n    border-left: 1px solid #ccc;\n    padding-left: 5px;\n`;\n\nexport const ConfirmButton = styled(ToolsEditorButton)`\n    background-color: #e6f7ff;\n    color: #1890ff;\n    \n    &:hover {\n        background-color: #bae7ff;\n    }\n`;\n\nexport const CancelButton = styled(ToolsEditorButton)`\n    background-color: #fff1f0;\n    color: #f5222d;\n\n    &:hover {\n        background-color: #ffccc7;\n    }\n`;\n\nexport const GridIcon = styled.span`\n    width: 100%;\n    height: 100%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n`;\n","import styled from 'styled-components';\n\n/*\n* Container*/\nexport const SidebarContainer = styled.div`\n    width: 60px;\n    height: 100%;\n    background-color: #222;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    padding-top: 10px;\n    z-index: 1001;\n    border-right: 1px solid #000;\n    flex-shrink: 0;\n    overflow-y: auto;\n\n    &::-webkit-scrollbar {\n        width: 0px;\n        background: transparent;\n    }\n    \n    -ms-overflow-style: none;\n    scrollbar-width: none;\n`;\n\nexport const ElementEditorButton = styled.button`\n    width: 40px;\n    height: 40px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    cursor: pointer;\n    background-color: ${props => props.$active ? '#e3de0a' : '#333'};\n    color: #fff;\n    border: 1px solid ${props => props.$active ? '#1E88E5' : '#fff'};\n    border-radius: 4px;\n    margin-bottom: 10px;\n    font-size: 20px;\n    transition: all 0.2s ease;\n    box-shadow: 0 2px 4px rgba(0,0,0,0.2);\n    transform: ${props => props.$active ? 'scale(1.05)' : 'none'};\n    padding: 0;\n    outline: none;\n\n    &:hover {\n        background-color: ${props => props.$active ? '#fdfa9b' : '#444'};\n        transform: scale(1.05);\n    }\n\n    &:active {\n        transform: scale(0.95);\n        border: solid 1px #fff;\n    }\n`;\n\nexport const PanelContainer = styled.div`\n    position: absolute;\n    left: 60px;\n    top: 60px;\n    width: 320px;\n    height: calc(100% - 60px);\n    background-color: #fff;\n    border-right: 1px solid #ddd;\n    display: flex;\n    flex-direction: column;\n    z-index: 990;\n    box-shadow: 4px 0 10px rgba(0,0,0,0.2);\n    \n    /* Animation settings */\n    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s ease;\n    transform: ${props => props.$isOpen ? 'translateX(0)' : 'translateX(-110%)'};\n    opacity: ${props => props.$isOpen ? '1' : '0'};\n    pointer-events: ${props => props.$isOpen ? 'all' : 'none'};\n`;\n\nexport const PanelHeader = styled.div`\n    padding: 8px 15px;\n    background-color: #f0f0f0;\n    border-bottom: 1px solid #ddd;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    font-weight: bold;\n    font-size: 12px;\n    height: 32px;\n    box-sizing: border-box;\n    color: #333;\n\n    span {\n        text-transform: uppercase;\n        letter-spacing: 0.5px;\n    }\n`;\n\nexport const PanelBody = styled.div`\n    flex: 1;\n    overflow-y: auto;\n    padding: 15px;\n`;\n\nexport const CloseButton = styled.button`\n    border: none;\n    background: none;\n    cursor: pointer;\n    font-size: 16px;\n    padding: 0 5px;\n    color: #666;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    outline: none;\n\n    &:hover {\n        color: #333;\n    }\n`;\n\nexport const OperationButton = styled.button`\n    display: inline-flex;\n    align-items: center;\n    justify-content: center;\n    cursor: pointer;\n    border: 1px solid #333;\n    padding: 0 10px;\n    height: 40px;\n    width: 100%;\n    background-color: #f0f0f0;\n    font-size: 13px;\n    color: ${props => props.$danger ? '#d32f2f' : '#000'};\n    border-radius: 3px;\n    user-select: none;\n    box-sizing: border-box;\n    transition: all 0.2s ease;\n    gap: 8px;\n    outline: none;\n\n    &:hover {\n        background-color: #e0e0e0;\n        border-color: #000;\n    }\n\n    &:active {\n        transform: scale(0.98);\n    }\n`;\n\n// Also exporting as a label for file input usage in OperationsPanel\nexport const OperationLabel = styled.label`\n    display: inline-flex;\n    align-items: center;\n    justify-content: center;\n    cursor: pointer;\n    border: 1px solid #333;\n    padding: 0 10px;\n    height: 40px;\n    width: 100%;\n    background-color: #f0f0f0;\n    font-size: 13px;\n    color: #000;\n    border-radius: 3px;\n    user-select: none;\n    box-sizing: border-box;\n    transition: all 0.2s ease;\n    gap: 8px;\n\n    &:hover {\n        background-color: #e0e0e0;\n        border-color: #000;\n    }\n\n    &:active {\n        transform: scale(0.98);\n    }\n`;\n","import React from 'react';\nimport { ToolsEditorButton } from '../styles/EditorToolsButton';\nimport { CloseButton } from '../styles/EditorElementsButtonStyle';\n\nexport const NewMapModal = ({\n    isOpen,\n    tempMapName,\n    setTempMapName,\n    tempCreatorName,\n    setTempCreatorName,\n    tempMapDescription,\n    setTempMapDescription,\n    confirmNewMap,\n    onClose\n}) => {\n    if (!isOpen) return null;\n\n    return (\n        <div style={{\n            position: 'absolute', top: 0, left: 0, width: '100%', height: '100%',\n            backgroundColor: 'rgba(0, 0, 0, 0.5)', zIndex: 1000,\n            display: 'flex', alignItems: 'center', justifyContent: 'center'\n        }}>\n            <div style={{\n                backgroundColor: '#fff', borderRadius: '8px',\n                boxShadow: '0 8px 24px rgba(0,0,0,0.2)', width: '320px',\n                display: 'flex', flexDirection: 'column', overflow: 'hidden'\n            }}>\n                <div style={{\n                    padding: '12px 15px',\n                    borderBottom: '2px solid #eee',\n                    display: 'flex',\n                    justifyContent: 'space-between',\n                    alignItems: 'center'\n                }}>\n                    <h3 style={{ margin: 0, fontSize: '18px', fontWeight: 'bold', color: '#333' }}>Create New Map</h3>\n                    <CloseButton onClick={onClose}></CloseButton>\n                </div>\n\n                <div style={{ padding: '20px', display: 'flex', flexDirection: 'column', gap: '15px' }}>\n                    <div>\n                        <label style={{ display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px', color: '#666' }}>Map Name:</label>\n                        <input\n                            type=\"text\"\n                            value={tempMapName}\n                            onChange={(e) => setTempMapName(e.target.value)}\n                            style={{ width: '100%', padding: '8px', borderRadius: '4px', border: '1px solid #ccc', boxSizing: 'border-box' }}\n                        />\n                    </div>\n\n                    <div>\n                        <label style={{ display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px', color: '#666' }}>Creator Nickname:</label>\n                        <input\n                            type=\"text\"\n                            value={tempCreatorName}\n                            onChange={(e) => setTempCreatorName(e.target.value)}\n                            style={{ width: '100%', padding: '8px', borderRadius: '4px', border: '1px solid #ccc', boxSizing: 'border-box' }}\n                        />\n                    </div>\n\n                    <div>\n                        <label style={{ display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px', color: '#666' }}>Description:</label>\n                        <textarea\n                            value={tempMapDescription}\n                            onChange={(e) => setTempMapDescription(e.target.value)}\n                            style={{ width: '100%', padding: '8px', borderRadius: '4px', border: '1px solid #ccc', boxSizing: 'border-box', minHeight: '60px', resize: 'vertical' }}\n                        />\n                    </div>\n\n                    <div style={{ display: 'flex', justifyContent: 'flex-end', gap: '10px', marginTop: '10px' }}>\n                        <ToolsEditorButton onClick={onClose} $variant=\"secondary\" $small>\n                            Cancel\n                        </ToolsEditorButton>\n                        <ToolsEditorButton onClick={() => confirmNewMap(tempMapName, tempCreatorName, tempMapDescription)} $variant=\"play\" $small>\n                            Create\n                        </ToolsEditorButton>\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n};\n","import React from 'react';\nimport styled from 'styled-components';\nimport { BUILT_IN_MAPS } from '../../../../constants/builtInMaps';\nimport { CloseButton } from '../styles/EditorElementsButtonStyle';\n\nconst ModalOverlay = styled.div`\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background-color: rgba(0, 0, 0, 0.6);\n    z-index: 3000;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    backdrop-filter: blur(2px);\n`;\n\nconst ModalContent = styled.div`\n    background-color: #fff;\n    padding: 20px;\n    border-radius: 8px;\n    width: 900px;\n    max-width: 95%;\n    max-height: 85%;\n    overflow-y: auto;\n    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);\n    display: flex;\n    flex-direction: column;\n    gap: 15px;\n`;\n\nconst ModalHeader = styled.div`\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    border-bottom: 2px solid #eee;\n    padding-bottom: 10px;\n`;\n\nconst ModalTitle = styled.h2`\n    margin: 0;\n    font-size: 24px;\n    color: #333;\n`;\n\nconst MapList = styled.div`\n    display: grid;\n    grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));\n    gap: 15px;\n    padding: 5px;\n`;\n\nconst MapCard = styled.div`\n    border: 1px solid #ddd;\n    border-radius: 8px;\n    padding: 15px;\n    cursor: pointer;\n    background-color: #f9f9f9;\n    display: flex;\n    flex-direction: column;\n    gap: 10px;\n    transition: all 0.2s ease;\n\n    &:hover {\n        background-color: #f0f7ff;\n        border-color: #2196f3;\n        transform: translateY(-3px);\n        box-shadow: 0 5px 15px rgba(0,0,0,0.1);\n    }\n`;\n\nconst MapTitle = styled.div`\n    font-weight: bold;\n    font-size: 16px;\n    color: #333;\n`;\n\nconst MapAuthor = styled.div`\n    font-size: 12px;\n    color: #666;\n`;\n\nconst MapDescription = styled.div`\n    font-size: 11px;\n    color: #777;\n    font-style: italic;\n    line-height: 1.4;\n    display: -webkit-box;\n    -webkit-line-clamp: 3;\n    -webkit-box-orient: vertical;\n    overflow: hidden;\n    min-height: 45px;\n`;\n\nconst MapInfo = styled.div`\n    margin-top: auto;\n    padding-top: 8px;\n    border-top: 1px solid #eee;\n    font-size: 11px;\n    color: #555;\n    display: flex;\n    justify-content: space-between;\n`;\n\nexport const BuiltInMapsModal = ({ isOpen, onClose, onSelect }) => {\n    if (!isOpen) return null;\n\n    return (\n        <ModalOverlay onClick={onClose}>\n            <ModalContent onClick={e => e.stopPropagation()}>\n                <ModalHeader>\n                    <ModalTitle>Select a Built-in Map to Edit</ModalTitle>\n                    <CloseButton onClick={onClose}></CloseButton>\n                </ModalHeader>\n                \n                <MapList>\n                    {BUILT_IN_MAPS.map((map, index) => {\n                        const isV2 = map.meta?.version === \"2.0\";\n                        const projectName = map.meta?.projectName || map.meta?.name || \"Unnamed Map\";\n                        const author = map.meta?.author || \"Unknown\";\n                        const description = map.meta?.description || \"\";\n                        \n                        let sizeInfo = \"\";\n                        let subMapInfo = \"\";\n\n                        if (isV2 && map.maps) {\n                            const mainMap = map.maps[map.meta?.activeMapId || 'main'] || Object.values(map.maps)[0];\n                            if (mainMap) {\n                                sizeInfo = `${mainMap.width}x${mainMap.height}`;\n                            }\n                            \n                            const mapValues = Object.values(map.maps);\n                            const overworldCount = mapValues.filter(m => m.type === 'overworld').length;\n                            const underworldCount = mapValues.filter(m => m.type === 'underworld').length;\n                            \n                            subMapInfo = ` (O:${overworldCount}, U:${underworldCount})`;\n                        } else {\n                            sizeInfo = `${map.meta?.width || map.width || 0}x${map.meta?.height || map.height || 0}`;\n                        }\n\n                        return (\n                            <MapCard key={index} onClick={() => {\n                                onSelect(map);\n                                onClose();\n                            }}>\n                                <div>\n                                    <MapTitle>{projectName}</MapTitle>\n                                    <MapAuthor>By: {author}</MapAuthor>\n                                </div>\n                                {description && (\n                                    <MapDescription title={description}>\n                                        {description}\n                                    </MapDescription>\n                                )}\n                                <MapInfo>\n                                    <div>Size: {sizeInfo}{subMapInfo}</div>\n                                </MapInfo>\n                            </MapCard>\n                        );\n                    })}\n                </MapList>\n            </ModalContent>\n        </ModalOverlay>\n    );\n};\n","import React, { useState, useRef, useEffect } from 'react';\n\nexport const DraggableWindow = ({\n    title,\n    children,\n    defaultPosition = { x: 20, y: 20 },\n    defaultWidth = 280,\n    isOpenDefault = true,\n    onHeightChange\n}) => {\n    const [position] = useState(defaultPosition);\n    const [isDragging, setIsDragging] = useState(false);\n    const [dragOffset, setDragOffset] = useState({ x: 0, y: 0 });\n    const [currentPosition, setCurrentPosition] = useState(defaultPosition);\n    const [isMinimized, setIsMinimized] = useState(!isOpenDefault);\n    const [isClosed, setIsClosed] = useState(false);\n    const [hasBeenDragged, setHasBeenDragged] = useState(false);\n    const windowRef = useRef(null);\n\n    // Update position from parent when not dragged\n    useEffect(() => {\n        if (!hasBeenDragged) {\n            setCurrentPosition(defaultPosition);\n        }\n    }, [defaultPosition, hasBeenDragged]);\n\n    const lastHeightRef = useRef(0);\n\n    // Notify parent about height changes\n    useEffect(() => {\n        if (windowRef.current && onHeightChange) {\n            const height = windowRef.current.offsetHeight;\n            if (height !== lastHeightRef.current) {\n                lastHeightRef.current = height;\n                onHeightChange(height);\n            }\n        }\n    });\n\n    useEffect(() => {\n        if (isDragging) {\n            const handleMouseMove = (e) => {\n                setCurrentPosition({\n                    x: e.clientX - dragOffset.x,\n                    y: e.clientY - dragOffset.y\n                });\n            };\n\n            const handleMouseUp = () => {\n                setIsDragging(false);\n            };\n\n            document.addEventListener('mousemove', handleMouseMove);\n            document.addEventListener('mouseup', handleMouseUp);\n\n            return () => {\n                document.removeEventListener('mousemove', handleMouseMove);\n                document.removeEventListener('mouseup', handleMouseUp);\n            };\n        }\n    }, [isDragging, dragOffset]);\n\n    const handleMouseDown = (e) => {\n        if (windowRef.current) {\n            const rect = windowRef.current.getBoundingClientRect();\n            setDragOffset({\n                x: e.clientX - rect.left,\n                y: e.clientY - rect.top\n            });\n            setIsDragging(true);\n            setHasBeenDragged(true);\n        }\n    };\n\n    if (isClosed) return null;\n\n    return (\n        <div\n            ref={windowRef}\n            style={{\n                position: 'fixed',\n                left: currentPosition.x,\n                top: currentPosition.y,\n                width: defaultWidth,\n                backgroundColor: '#fff',\n                border: '1px solid #ddd',\n                borderRadius: '8px',\n                boxShadow: '0 4px 12px rgba(0,0,0,0.15)',\n                zIndex: 1002,\n                display: 'flex',\n                flexDirection: 'column',\n                maxHeight: '80vh',\n                overflow: 'hidden'\n            }}\n        >\n            {/* Window Header */}\n            <div\n                onMouseDown={handleMouseDown}\n                style={{\n                    padding: '12px 15px',\n                    backgroundColor: '#fff',\n                    cursor: isDragging ? 'grabbing' : 'grab',\n                    fontWeight: 'bold',\n                    fontSize: '18px',\n                    display: 'flex',\n                    justifyContent: 'space-between',\n                    alignItems: 'center',\n                    userSelect: 'none',\n                    borderBottom: '2px solid #eee',\n                    color: '#333'\n                }}\n            >\n                <span>{title}</span>\n                <div style={{ display: 'flex', gap: '8px', alignItems: 'center' }}>\n                    <button\n                        onClick={(e) => {\n                            e.stopPropagation();\n                            setIsMinimized(!isMinimized);\n                        }}\n                        style={{\n                            background: '#f0f0f0',\n                            border: '1px solid #ccc',\n                            borderRadius: '4px',\n                            width: '24px',\n                            height: '24px',\n                            cursor: 'pointer',\n                            fontSize: '14px',\n                            display: 'flex',\n                            alignItems: 'center',\n                            justifyContent: 'center',\n                            padding: 0,\n                            color: '#333'\n                        }}\n                        title={isMinimized ? \"Maximize\" : \"Minimize\"}\n                    >\n                        {isMinimized ? '' : ''}\n                    </button>\n                    <button\n                        onClick={(e) => {\n                            e.stopPropagation();\n                            setIsClosed(true);\n                        }}\n                        style={{\n                            background: '#f0f0f0',\n                            border: '1px solid #ccc',\n                            borderRadius: '4px',\n                            width: '24px',\n                            height: '24px',\n                            cursor: 'pointer',\n                            color: '#333',\n                            fontSize: '14px',\n                            display: 'flex',\n                            alignItems: 'center',\n                            justifyContent: 'center',\n                            padding: 0\n                        }}\n                        title=\"Close\"\n                    >\n                        \n                    </button>\n                </div>\n            </div>\n\n            {/* Window Content */}\n            {!isMinimized && (\n                <div\n                    style={{\n                        padding: '15px',\n                        overflowY: 'auto',\n                        flex: 1\n                    }}\n                >\n                    {children}\n                </div>\n            )}\n        </div>\n    );\n};\n","import React, { useState, useRef, useEffect } from 'react';\n\nexport const EditorMapResizer = ({\n    mapWidth,\n    mapHeight,\n    onResize\n}) => {\n    const containerRef = useRef(null);\n    const [isDragging, setIsDragging] = useState(false);\n    const [startSize, setStartSize] = useState({ width: mapWidth, height: mapHeight });\n    const [startMousePos, setStartMousePos] = useState({ x: 0, y: 0 });\n\n    // Calculate display size (each block is represented by 10px)\n    const displayWidth = mapWidth * 10;\n    const displayHeight = mapHeight * 10;\n\n    const handleCornerMouseDown = (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        setIsDragging(true);\n        setStartSize({ width: mapWidth, height: mapHeight });\n        setStartMousePos({ x: e.clientX, y: e.clientY });\n    };\n\n    useEffect(() => {\n        if (!isDragging) return;\n\n        const handleMouseMove = (e) => {\n            const dx = e.clientX - startMousePos.x;\n            const dy = e.clientY - startMousePos.y;\n\n            // Each 10px of drag = 1 block\n            const blocksX = Math.round(dx / 10);\n            const blocksY = Math.round(dy / 10);\n\n            const newWidth = Math.max(5, Math.min(100, startSize.width + blocksX));\n            const newHeight = Math.max(5, Math.min(100, startSize.height + blocksY));\n\n            if (newWidth !== mapWidth || newHeight !== mapHeight) {\n                onResize(newWidth, newHeight);\n            }\n        };\n\n        const handleMouseUp = () => {\n            setIsDragging(false);\n        };\n\n        document.addEventListener('mousemove', handleMouseMove);\n        document.addEventListener('mouseup', handleMouseUp);\n\n        return () => {\n            document.removeEventListener('mousemove', handleMouseMove);\n            document.removeEventListener('mouseup', handleMouseUp);\n        };\n    }, [isDragging, startMousePos, startSize, mapWidth, mapHeight, onResize]);\n\n    return (\n        <div style={{ display: 'flex', flexDirection: 'column', gap: '10px' }}>\n            <div style={{ fontSize: '14px', fontWeight: 'bold', textAlign: 'center' }}>\n                Map Size: <span style={{ color: '#4CAF50' }}>{mapWidth}  {mapHeight}</span> blocks\n            </div>\n\n            <div\n                ref={containerRef}\n                style={{\n                    position: 'relative',\n                    width: displayWidth + 'px',\n                    height: displayHeight + 'px',\n                    border: '2px solid #4CAF50',\n                    backgroundColor: '#e8f5e9',\n                    borderRadius: '4px',\n                    display: 'flex',\n                    alignItems: 'center',\n                    justifyContent: 'center',\n                    fontSize: '12px',\n                    color: '#2e7d32',\n                    fontWeight: 'bold',\n                    userSelect: 'none',\n                    minWidth: '50px',\n                    minHeight: '50px'\n                }}\n            >\n                {mapWidth}  {mapHeight}\n\n                {/* Resize handle - bottom right corner */}\n                <div\n                    onMouseDown={handleCornerMouseDown}\n                    style={{\n                        position: 'absolute',\n                        bottom: -5,\n                        right: -5,\n                        width: '15px',\n                        height: '15px',\n                        backgroundColor: '#4CAF50',\n                        cursor: 'nwse-resize',\n                        borderRadius: '50%',\n                        border: '2px solid #fff',\n                        boxShadow: '0 2px 4px rgba(0,0,0,0.2)',\n                        zIndex: 10\n                    }}\n                />\n            </div>\n\n            <div style={{ fontSize: '11px', color: '#666', textAlign: 'center' }}>\n                 Drag the corner to resize the map<br/>\n                (Min: 55, Max: 100100)\n            </div>\n        </div>\n    );\n};\n","import React, { useRef, useEffect } from 'react';\n\nexport const Minimap = ({\n    mapWidth,\n    mapHeight,\n    tileMapData,\n    objectMapData,\n    objectMetadata,\n    registryItems,\n    backgroundColor\n}) => {\n    const canvasRef = useRef(null);\n    const minimapWidth = 250;\n    const minimapHeight = 200;\n\n    useEffect(() => {\n        const canvas = canvasRef.current;\n        if (!canvas) return;\n\n        const ctx = canvas.getContext('2d');\n        const tileWidth = minimapWidth / mapWidth;\n        const tileHeight = minimapHeight / mapHeight;\n\n        // Clear canvas\n        ctx.fillStyle = backgroundColor || '#87CEEB';\n        ctx.fillRect(0, 0, minimapWidth, minimapHeight);\n\n        // Draw tiles\n        for (let y = 0; y < mapHeight; y++) {\n            for (let x = 0; x < mapWidth; x++) {\n                const index = y * mapWidth + x;\n                const tileId = tileMapData[index];\n                const objectId = objectMapData[index];\n\n                const px = x * tileWidth;\n                const py = y * tileHeight;\n\n                // Draw tile\n                if (tileId !== null) {\n                    const tile = registryItems.find(item => item.id === tileId);\n                    if (tile) {\n                        if (tile.flags?.liquid) {\n                            if (tile.flags.lava_waterfall) {\n                                ctx.fillStyle = '#ffcc00';\n                            } else if (tile.flags.radioactive_waterfall) {\n                                ctx.fillStyle = '#32cd32';\n                            } else if (tile.flags.waterfall) {\n                                ctx.fillStyle = '#3a7fb8';\n                            } else if (tile.flags.water) {\n                                ctx.fillStyle = '#3a7fb8';\n                            } else if (tile.flags.lava) {\n                                ctx.fillStyle = '#ffcc00';\n                            } else if (tile.flags.quicksand) {\n                                ctx.fillStyle = '#a6915b';\n                            } else if (tile.flags.radioactive_water) {\n                                ctx.fillStyle = '#32cd32';\n                            } else {\n                                ctx.fillStyle = '#888';\n                            }\n                        } else {\n                            // Solid block - darker color\n                            ctx.fillStyle = '#654321';\n                        }\n                        ctx.fillRect(px, py, Math.ceil(tileWidth), Math.ceil(tileHeight));\n                    }\n                }\n\n                // Draw object on top\n                if (objectId !== null) {\n                    const obj = registryItems.find(item => item.id === objectId);\n                    if (obj) {\n                        // Objects in bright colors\n                        if (obj.name?.startsWith('entities.')) {\n                            ctx.fillStyle = '#ff0000'; // Red for entities\n                        } else if (obj.name?.startsWith('item.')) {\n                            ctx.fillStyle = '#00ff00'; // Green for items\n                        } else if (obj.name?.startsWith('interactable.')) {\n                            ctx.fillStyle = '#ff00ff'; // Magenta for interactables\n                        } else if (obj.type === 'hazard') {\n                            ctx.fillStyle = '#ff8800'; // Orange for hazards\n                        } else {\n                            ctx.fillStyle = '#ffff00'; // Yellow for others\n                        }\n                        ctx.fillRect(px, py, Math.ceil(tileWidth), Math.ceil(tileHeight));\n                    }\n                }\n            }\n        }\n\n        // Draw grid\n        ctx.strokeStyle = 'rgba(255, 255, 255, 0.2)';\n        ctx.lineWidth = 0.5;\n        for (let x = 0; x <= mapWidth; x++) {\n            ctx.beginPath();\n            ctx.moveTo(x * tileWidth, 0);\n            ctx.lineTo(x * tileWidth, minimapHeight);\n            ctx.stroke();\n        }\n        for (let y = 0; y <= mapHeight; y++) {\n            ctx.beginPath();\n            ctx.moveTo(0, y * tileHeight);\n            ctx.lineTo(minimapWidth, y * tileHeight);\n            ctx.stroke();\n        }\n\n        // Draw connections between portals and targets\n        if (objectMetadata) {\n            const portals = [];\n            const targets = [];\n\n            for (let i = 0; i < mapWidth * mapHeight; i++) {\n                const id = objectMapData[i];\n                if (!id) continue;\n                const metadata = objectMetadata[i];\n                if (!metadata || metadata.triggerId === null || metadata.triggerId === undefined) continue;\n\n                const pos = {\n                    x: (i % mapWidth) * tileWidth + tileWidth / 2,\n                    y: Math.floor(i / mapWidth) * tileHeight + tileHeight / 2\n                };\n\n                if (id.includes('portal') && !id.includes('target')) {\n                    portals.push({ triggerId: metadata.triggerId, pos });\n                } else if (id.includes('target') || id === 'portal_target') {\n                    targets.push({ triggerId: metadata.triggerId, pos });\n                }\n            }\n\n            portals.forEach(portal => {\n                const target = targets.find(t => t.triggerId === portal.triggerId);\n                if (target) {\n                    ctx.beginPath();\n                    ctx.setLineDash([5, 3]);\n                    ctx.strokeStyle = '#fff';\n                    ctx.lineWidth = 2;\n                    ctx.moveTo(portal.pos.x, portal.pos.y);\n                    ctx.lineTo(target.pos.x, target.pos.y);\n                    ctx.stroke();\n                    ctx.setLineDash([]);\n                }\n            });\n        }\n\n    }, [mapWidth, mapHeight, tileMapData, objectMapData, objectMetadata, registryItems]);\n\n    return (\n        <canvas\n            ref={canvasRef}\n            width={minimapWidth}\n            height={minimapHeight}\n            style={{\n                width: '100%',\n                height: 'auto',\n                border: '1px solid #ccc',\n                borderRadius: '4px',\n                backgroundColor: '#87CEEB',\n                imageRendering: 'pixelated'\n            }}\n        />\n    );\n};\n","import React, { useRef, useEffect, useMemo, useCallback } from 'react';\n\nexport const WorldView = ({\n    maps,\n    activeMapId,\n    switchMap,\n    registryItems,\n    currentMapData,\n    createMap,\n    deleteMap,\n    updateMapData\n}) => {\n    const canvasRef = useRef(null);\n    const containerRef = useRef(null);\n    const mapLayoutsRef = useRef({});\n    const dragRef = useRef(null); // { id, startX, startY, mapStartX, mapStartY }\n\n    // Prepare all maps data, using live data for the active map\n    const allMaps = useMemo(() => {\n        const result = { ...maps };\n        if (currentMapData && currentMapData.id && result[currentMapData.id]) {\n            result[currentMapData.id] = {\n                ...result[currentMapData.id],\n                mapWidth: currentMapData.mapWidth,\n                mapHeight: currentMapData.mapHeight,\n                tileMapData: currentMapData.tileMapData,\n                objectMapData: currentMapData.objectMapData,\n                objectMetadata: currentMapData.objectMetadata,\n                selectedBackgroundColor: currentMapData.selectedBackgroundColor\n            };\n        }\n        return Object.values(result);\n    }, [maps, currentMapData]);\n\n    // Draw function\n    const draw = useCallback(() => {\n        const canvas = canvasRef.current;\n        if (!canvas) return;\n\n        const ctx = canvas.getContext('2d');\n        \n        // Settings\n        const baseTileSize = 4; // Each tile in world view\n        \n        // Sync mapLayoutsRef with allMaps, but preserve positions for maps being dragged\n        const layouts = mapLayoutsRef.current;\n        allMaps.forEach(map => {\n            const isDragging = dragRef.current && dragRef.current.id === map.id;\n            const w = map.mapWidth * baseTileSize;\n            const h = map.mapHeight * baseTileSize;\n\n            if (!layouts[map.id]) {\n                layouts[map.id] = { x: map.worldX || 0, y: map.worldY || 0, w, h, map };\n            } else {\n                layouts[map.id].w = w;\n                layouts[map.id].h = h;\n                layouts[map.id].map = map;\n                // Update position from props ONLY if not currently dragging this map\n                if (!isDragging) {\n                    layouts[map.id].x = map.worldX || 0;\n                    layouts[map.id].y = map.worldY || 0;\n                }\n            }\n        });\n\n        // Clear\n        ctx.fillStyle = '#222';\n        ctx.fillRect(0, 0, canvas.width, canvas.height);\n\n        // Grid (optional but helpful)\n        ctx.strokeStyle = '#333';\n        ctx.lineWidth = 1;\n        for (let x = 0; x < canvas.width; x += 50) {\n            ctx.beginPath(); ctx.moveTo(x, 0); ctx.lineTo(x, canvas.height); ctx.stroke();\n        }\n        for (let y = 0; y < canvas.height; y += 50) {\n            ctx.beginPath(); ctx.moveTo(0, y); ctx.lineTo(canvas.width, y); ctx.stroke();\n        }\n\n        // 1. Draw Maps\n        Object.values(layouts).forEach(layout => {\n            const { x, y, w, h, map } = layout;\n            const tileW = w / map.mapWidth;\n            const tileH = h / map.mapHeight;\n\n            // Background\n            ctx.fillStyle = map.selectedBackgroundColor || '#87CEEB';\n            ctx.fillRect(x, y, w, h);\n\n            // Active indicator\n            if (map.id === activeMapId) {\n                ctx.strokeStyle = '#e3de0a';\n                ctx.lineWidth = 3;\n                ctx.strokeRect(x - 4, y - 4, w + 8, h + 8);\n            } else {\n                ctx.strokeStyle = '#555';\n                ctx.lineWidth = 1;\n                ctx.strokeRect(x, y, w, h);\n            }\n\n            // Name\n            ctx.fillStyle = '#fff';\n            ctx.font = 'bold 12px Arial';\n            ctx.fillText(map.name, x, y - 10);\n            ctx.font = '10px Arial';\n            ctx.fillStyle = '#aaa';\n            ctx.fillText(map.type, x, y + h + 12);\n\n            // Delete button (X)\n            if (map.id !== 'main') {\n                ctx.fillStyle = '#ff4d4f';\n                ctx.fillRect(x + w - 15, y - 25, 15, 15);\n                ctx.fillStyle = '#fff';\n                ctx.font = 'bold 12px Arial';\n                ctx.fillText('', x + w - 11, y - 13);\n            }\n\n            // Draw Tiles & Objects (simplified)\n            for (let i = 0; i < map.mapWidth * map.mapHeight; i++) {\n                const tx = (i % map.mapWidth) * tileW + x;\n                const ty = Math.floor(i / map.mapWidth) * tileH + y;\n\n                const tileId = map.tileMapData[i];\n                const objId = map.objectMapData[i];\n\n                if (tileId) {\n                    ctx.fillStyle = '#654321';\n                    ctx.fillRect(tx, ty, Math.ceil(tileW), Math.ceil(tileH));\n                }\n                if (objId) {\n                    if (objId.includes('portal') && !objId.includes('target')) {\n                        ctx.fillStyle = '#007bff';\n                    } else if (objId.includes('target') || objId === 'portal_target') {\n                        ctx.fillStyle = '#ffc107';\n                    } else {\n                        ctx.fillStyle = '#dc3545';\n                    }\n                    ctx.fillRect(tx, ty, Math.ceil(tileW), Math.ceil(tileH));\n                }\n            }\n        });\n\n        // 2. Draw Connections\n        ctx.setLineDash([5, 5]);\n        ctx.lineWidth = 2;\n\n        Object.values(layouts).forEach(sourceLayout => {\n            const { map: sourceMap, x: sx, y: sy, w: sw, h: sh } = sourceLayout;\n            const tileW = sw / sourceMap.mapWidth;\n            const tileH = sh / sourceMap.mapHeight;\n\n            const metadata = sourceMap.objectMetadata || {};\n            \n            for (let i = 0; i < sourceMap.mapWidth * sourceMap.mapHeight; i++) {\n                const objId = sourceMap.objectMapData[i];\n                if (!objId || !objId.includes('portal') || objId.includes('target')) continue;\n\n                const meta = metadata[i];\n                if (!meta || meta.triggerId === null || meta.triggerId === undefined) continue;\n\n                const targetMapId = meta.targetMapId || sourceMap.id;\n                const targetLayout = layouts[targetMapId];\n\n                if (targetLayout) {\n                    const { map: targetMap, x: tx, y: ty, w: tw, h: th } = targetLayout;\n                    const tTileW = tw / targetMap.mapWidth;\n                    const tTileH = th / targetMap.mapHeight;\n\n                    // Find target object in target map\n                    for (let j = 0; j < targetMap.mapWidth * targetMap.mapHeight; j++) {\n                        const tObjId = targetMap.objectMapData[j];\n                        if (!tObjId || (!tObjId.includes('target') && tObjId !== 'portal_target')) continue;\n\n                        const tMeta = targetMap.objectMetadata?.[j];\n                        if (tMeta && tMeta.triggerId === meta.triggerId) {\n                            // Link found!\n                            const startX = sx + (i % sourceMap.mapWidth) * tileW + tileW / 2;\n                            const startY = sy + Math.floor(i / sourceMap.mapWidth) * tileH + tileH / 2;\n                            const endX = tx + (j % targetMap.mapWidth) * tTileW + tTileW / 2;\n                            const endY = ty + Math.floor(j / targetMap.mapWidth) * tTileH + tTileH / 2;\n\n                            // Draw line\n                            ctx.beginPath();\n                            ctx.strokeStyle = (sourceMap.id === targetMap.id) ? '#fff' : '#00ff00';\n                            ctx.moveTo(startX, startY);\n                            \n                            if (sourceMap.id !== targetMap.id) {\n                                // Calculate mid points for a nicer curve\n                                const cp1X = startX + (endX - startX) * 0.25;\n                                const cp1Y = Math.min(startY, endY) - 100;\n                                const cp2X = startX + (endX - startX) * 0.75;\n                                const cp2Y = Math.min(startY, endY) - 100;\n                                ctx.bezierCurveTo(cp1X, cp1Y, cp2X, cp2Y, endX, endY);\n                            } else {\n                                ctx.lineTo(endX, endY);\n                            }\n                            ctx.stroke();\n\n                            // Arrow head\n                            const angle = Math.atan2(endY - startY, endX - startX);\n                            ctx.save();\n                            ctx.setLineDash([]);\n                            ctx.translate(endX, endY);\n                            ctx.rotate(angle);\n                            ctx.beginPath();\n                            ctx.moveTo(0, 0);\n                            ctx.lineTo(-10, -5);\n                            ctx.lineTo(-10, 5);\n                            ctx.closePath();\n                            ctx.fillStyle = ctx.strokeStyle;\n                            ctx.fill();\n                            ctx.restore();\n                            \n                            break;\n                        }\n                    }\n                }\n            }\n        });\n    }, [allMaps, activeMapId]);\n\n    useEffect(() => {\n        draw();\n    }, [allMaps, activeMapId]);\n\n    const handleMouseDown = (e) => {\n        const rect = canvasRef.current.getBoundingClientRect();\n        const x = e.clientX - rect.left;\n        const y = e.clientY - rect.top;\n\n        const layouts = Object.values(mapLayoutsRef.current || {});\n        \n        // Check for delete button first\n        for (const layout of layouts) {\n            if (layout.map.id !== 'main') {\n                const btnX = layout.x + layout.w - 15;\n                const btnY = layout.y - 25;\n                if (x >= btnX && x <= btnX + 15 && y >= btnY && y <= btnY + 15) {\n                    if (window.confirm(`Delete map \"${layout.map.name}\"?`)) {\n                        deleteMap(layout.map.id);\n                    }\n                    return;\n                }\n            }\n        }\n\n        // Check for map drag/select\n        for (const layout of layouts) {\n            if (x >= layout.x && x <= layout.x + layout.w &&\n                y >= layout.y && y <= layout.y + layout.h) {\n                \n                if (e.detail === 2) { // Double click to switch\n                    switchMap(layout.map.id);\n                } else {\n                    dragRef.current = {\n                        id: layout.map.id,\n                        startX: x,\n                        startY: y,\n                        mapStartX: layout.x,\n                        mapStartY: layout.y\n                    };\n                }\n                return;\n            }\n        }\n    };\n\n    const handleMouseMove = (e) => {\n        if (!dragRef.current) return;\n\n        const rect = canvasRef.current.getBoundingClientRect();\n        const x = e.clientX - rect.left;\n        const y = e.clientY - rect.top;\n\n        const dx = x - dragRef.current.startX;\n        const dy = y - dragRef.current.startY;\n\n        const newX = Math.max(0, dragRef.current.mapStartX + dx);\n        const newY = Math.max(0, dragRef.current.mapStartY + dy);\n\n        // Update local layout for immediate visual feedback\n        if (mapLayoutsRef.current[dragRef.current.id]) {\n            mapLayoutsRef.current[dragRef.current.id].x = newX;\n            mapLayoutsRef.current[dragRef.current.id].y = newY;\n            draw();\n        }\n    };\n\n    const handleMouseUp = (e) => {\n        if (!dragRef.current) return;\n\n        const layout = mapLayoutsRef.current[dragRef.current.id];\n        if (layout) {\n            updateMapData(dragRef.current.id, {\n                worldX: layout.x,\n                worldY: layout.y\n            });\n        }\n        \n        dragRef.current = null;\n    };\n\n    return (\n        <div style={{ display: 'flex', flexDirection: 'column', gap: '10px', padding: '10px' }}>\n            <div style={{ display: 'flex', gap: '10px', alignItems: 'center' }}>\n                <button \n                    onClick={() => createMap('overworld')}\n                    style={{ padding: '8px 15px', cursor: 'pointer', backgroundColor: '#4CAF50', color: 'white', border: 'none', borderRadius: '4px', fontSize: '12px', fontWeight: 'bold' }}\n                >\n                    + Overworld\n                </button>\n                <button \n                    onClick={() => createMap('underworld')}\n                    style={{ padding: '8px 15px', cursor: 'pointer', backgroundColor: '#5D4037', color: 'white', border: 'none', borderRadius: '4px', fontSize: '12px', fontWeight: 'bold' }}\n                >\n                    + Underworld\n                </button>\n                <div style={{ marginLeft: 'auto', color: '#ccc', fontSize: '11px' }}>\n                    Double-click map to select. Drag to move.\n                </div>\n            </div>\n\n            <div ref={containerRef} style={{ width: '100%', height: '500px', backgroundColor: '#333', overflow: 'auto', borderRadius: '4px', position: 'relative', border: '1px solid #555' }}>\n                <canvas\n                    ref={canvasRef}\n                    width={2000}\n                    height={2000}\n                    style={{ display: 'block', cursor: dragRef.current ? 'grabbing' : 'grab' }}\n                    onMouseDown={handleMouseDown}\n                    onMouseMove={handleMouseMove}\n                    onMouseUp={handleMouseUp}\n                    onMouseLeave={handleMouseUp}\n                />\n                <div style={{ position: 'absolute', bottom: '10px', right: '10px', backgroundColor: 'rgba(0,0,0,0.7)', color: '#fff', padding: '5px 10px', borderRadius: '4px', fontSize: '11px', pointerEvents: 'none' }}>\n                    <div style={{ display: 'flex', alignItems: 'center', gap: '5px' }}><div style={{ width: 10, height: 10, backgroundColor: '#fff', border: '1px dashed #fff' }}></div> Intra-map teleport</div>\n                    <div style={{ display: 'flex', alignItems: 'center', gap: '5px' }}><div style={{ width: 10, height: 10, backgroundColor: '#00ff00', border: '1px dashed #00ff00' }}></div> Inter-map teleport</div>\n                </div>\n            </div>\n        </div>\n    );\n};\n","import React from 'react';\n\nexport const BackgroundPanel = ({ \n    backgroundOptions, \n    selectedBackgroundImage, \n    setSelectedBackgroundImage, \n    selectedBackgroundColor, \n    backgroundParallaxFactor, \n    setBackgroundParallaxFactor \n}) => {\n    return (\n        <div style={{ display: 'flex', flexDirection: 'column', gap: '20px' }}>\n            <section>\n                <span style={{ fontSize: '13px', fontWeight: 'bold', display: 'block', marginBottom: '12px' }}>Background Image</span>\n                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '10px' }}>\n                    <div onClick={() => setSelectedBackgroundImage(null)}\n                        style={{\n                            border: selectedBackgroundImage ? '1px solid #ccc' : '2px solid #2196F3',\n                            borderRadius: '6px', padding: '4px', cursor: 'pointer', background: '#fff',\n                            boxShadow: !selectedBackgroundImage ? '0 0 8px rgba(33, 150, 243, 0.3)' : 'none'\n                        }}\n                        title=\"Solid Color\">\n                        <div style={{ width: '100%', height: '60px', background: selectedBackgroundColor, display: 'block', borderRadius: '4px' }} />\n                        <div style={{ fontSize: '11px', textAlign: 'center', paddingTop: '5px', fontWeight: !selectedBackgroundImage ? 'bold' : 'normal' }}>Solid Color</div>\n                    </div>\n                    {backgroundOptions.map((bg) => (\n                        <div key={bg.name} onClick={() => setSelectedBackgroundImage(bg.metaPath)}\n                            style={{\n                                border: selectedBackgroundImage === bg.metaPath ? '2px solid #2196F3' : '1px solid #ccc',\n                                borderRadius: '6px', padding: '4px', cursor: 'pointer', background: '#fff',\n                                boxShadow: selectedBackgroundImage === bg.metaPath ? '0 0 8px rgba(33, 150, 243, 0.3)' : 'none'\n                            }}\n                            title={bg.name}>\n                            <img src={bg.src} alt={bg.name} style={{ width: '100%', height: '60px', objectFit: 'cover', display: 'block', borderRadius: '4px' }} />\n                            <div style={{ fontSize: '11px', textAlign: 'center', paddingTop: '5px', fontWeight: selectedBackgroundImage === bg.metaPath ? 'bold' : 'normal' }}>{bg.name}</div>\n                        </div>\n                    ))}\n                </div>\n            </section>\n\n            <section style={{ backgroundColor: '#f9f9f9', padding: '15px', borderRadius: '8px', border: '1px solid #ddd' }}>\n                <div style={{ marginBottom: '0px' }}>\n                    <label style={{ fontSize: '13px', fontWeight: 'bold', display: 'block', marginBottom: '8px' }}>Parallax Effect:</label>\n                    <div style={{ display: 'flex', alignItems: 'center', gap: '10px' }}>\n                        <input type=\"range\" min=\"0\" max=\"1\" step=\"0.05\" value={backgroundParallaxFactor}\n                            onChange={(e) => setBackgroundParallaxFactor(parseFloat(e.target.value))}\n                            style={{ flex: 1 }} />\n                        <span style={{ fontSize: '13px', fontWeight: 'bold', minWidth: '35px' }}>{backgroundParallaxFactor.toFixed(2)}</span>\n                    </div>\n                </div>\n            </section>\n        </div>\n    );\n};\n","import React from 'react';\nexport const MusicPanel = ({ \n    musicOptions, \n    selectedBackgroundMusic, \n    setSelectedBackgroundMusic \n}) => {\n    return (\n        <div style={{ display: 'flex', flexDirection: 'column', gap: '20px' }}>\n            <section>\n                <span style={{ fontSize: '13px', fontWeight: 'bold', display: 'block', marginBottom: '10px' }}>Background Music</span>\n                <select\n                    value={selectedBackgroundMusic || ''}\n                    onChange={(e) => setSelectedBackgroundMusic(e.target.value || null)}\n                    style={{ width: '100%', padding: '10px', borderRadius: '6px', border: '1px solid #ccc', fontSize: '13px', marginBottom: '10px' }}>\n                    <option value=\"\"> No Music </option>\n                    {musicOptions.map(m => (\n                        <option key={m.name} value={m.metaPath}>{m.name}</option>\n                    ))}\n                </select>\n                <div style={{ fontSize: '12px', color: '#666', fontStyle: 'italic' }}>\n                    Status: {selectedBackgroundMusic ? 'Music selected' : 'Silence'}\n                </div>\n            </section>\n        </div>\n    );\n};\n","import React from 'react';\n\nexport const WeatherPanel = ({\n    weatherRain,\n    setWeatherRain,\n    weatherSnow,\n    setWeatherSnow,\n    weatherClouds,\n    setWeatherClouds,\n    weatherFog,\n    setWeatherFog,\n    weatherThunder,\n    setWeatherThunder,\n    weatherLavaRain,\n    setWeatherLavaRain,\n    weatherRadioactiveFog,\n    setWeatherRadioactiveFog,\n    weatherMeteorRain,\n    setWeatherMeteorRain\n}) => {\n    const weatherItems = [\n        { label: 'Rain', value: weatherRain, setter: setWeatherRain, icon: '' },\n        { label: 'Lava Rain', value: weatherLavaRain, setter: setWeatherLavaRain, icon: '' },\n        { label: 'Snow', value: weatherSnow, setter: setWeatherSnow, icon: '' },\n        { label: 'Meteor Rain', value: weatherMeteorRain, setter: setWeatherMeteorRain, icon: '' },\n        { label: 'Clouds', value: weatherClouds, setter: setWeatherClouds, icon: '' },\n        { label: 'Fog', value: weatherFog, setter: setWeatherFog, icon: '' },\n        { label: 'Radio Fog', value: weatherRadioactiveFog, setter: setWeatherRadioactiveFog, icon: '' },\n        { label: 'Thunder', value: weatherThunder, setter: setWeatherThunder, icon: '' },\n    ];\n\n    return (\n        <div style={{ display: 'flex', flexDirection: 'column', gap: '15px', padding: '5px' }}>\n            {weatherItems.map((item) => (\n                <div key={item.label} style={{ \n                    backgroundColor: '#f9f9f9', \n                    padding: '12px', \n                    borderRadius: '8px', \n                    border: '1px solid #ddd' \n                }}>\n                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '8px' }}>\n                        <span style={{ fontSize: '13px', fontWeight: 'bold' }}>\n                            {item.icon} {item.label}\n                        </span>\n                        <span style={{ fontSize: '12px', fontWeight: 'bold', color: '#2196F3' }}>\n                            {item.value}%\n                        </span>\n                    </div>\n                    <div style={{ display: 'flex', alignItems: 'center', gap: '10px' }}>\n                        <input \n                            type=\"range\" \n                            min=\"0\" \n                            max=\"100\" \n                            step=\"1\" \n                            value={item.value}\n                            onChange={(e) => item.setter(parseInt(e.target.value))}\n                            style={{ flex: 1, cursor: 'pointer' }} \n                        />\n                    </div>\n                </div>\n            ))}\n            <div style={{ fontSize: '11px', color: '#888', fontStyle: 'italic', textAlign: 'center', marginTop: '5px' }}>\n                Weather effects will be visible in Play mode\n            </div>\n        </div>\n    );\n};\n","import styled from 'styled-components';\n\nexport const SceneEditorButton = styled.button`\n    width: 40px;\n    height: 40px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    cursor: pointer;\n    background-color: ${props => props.$active ? '#e3de0a' : '#333'};\n    color: #fff;\n    border: 1px solid ${props => props.$active ? '#1E88E5' : '#fff'};\n    border-radius: 4px;\n    margin-bottom: 10px;\n    font-size: 20px;\n    transition: all 0.2s ease;\n    box-shadow: 0 2px 4px rgba(0,0,0,0.2);\n    transform: ${props => props.$active ? 'scale(1.05)' : 'none'};\n    padding: 0;\n    outline: none;\n\n    &:hover {\n        background-color: ${props => props.$active ? '#fdfa9b' : '#444'};\n        transform: scale(1.05);\n    }\n\n    &:active {\n        transform: scale(0.95);\n        border: solid 1px #fff;\n    }\n`;\n\nexport const RightSidebarContainer = styled.div`\n    position: absolute;\n    top: 70px;\n    right: 20px;\n    display: flex;\n    flex-direction: column;\n    gap: 10px;\n    z-index: 1001;\n`;\n","import React, { useState } from 'react';\nimport { DraggableWindow } from './editorScene/DraggableWindow';\nimport { EditorMapResizer } from './editorScene/EditorMapResizer';\nimport { Minimap } from './editorScene/Minimap';\nimport { WorldView } from './editorScene/WorldView';\nimport { BackgroundPanel } from './editorScene/BackgroundPanel';\nimport { MusicPanel } from './editorScene/MusicPanel';\nimport { WeatherPanel } from './editorScene/WeatherPanel';\nimport { SceneEditorButton, RightSidebarContainer } from './styles/EditorSceneButtonStyle';\nimport BackgroundMusicPlayer from '../../../utilities/BackgroundMusicPlayer';\n\nexport const EditorScene = ({\n    handleMapResize,\n    isResizeWindowOpen,\n    setIsResizeWindowOpen,\n    mapWidth,\n    mapHeight,\n    tileMapData,\n    objectMapData,\n    objectMetadata,\n    registryItems,\n    backgroundOptions,\n    selectedBackgroundImage,\n    setSelectedBackgroundImage,\n    selectedBackgroundColor,\n    setSelectedBackgroundColor,\n    backgroundParallaxFactor,\n    setBackgroundParallaxFactor,\n    musicOptions,\n    selectedBackgroundMusic,\n    setSelectedBackgroundMusic,\n    weatherRain,\n    setWeatherRain,\n    weatherSnow,\n    setWeatherSnow,\n    weatherClouds,\n    setWeatherClouds,\n    weatherFog,\n    setWeatherFog,\n    weatherThunder,\n    setWeatherThunder,\n    weatherLavaRain,\n    setWeatherLavaRain,\n    weatherRadioactiveFog,\n    setWeatherRadioactiveFog,\n    weatherMeteorRain,\n    setWeatherMeteorRain,\n    // New props for multi-map\n    maps,\n    activeMapId,\n    switchMap,\n    createMap,\n    deleteMap,\n    updateMapData\n}) => {\n    const [isMinimapOpen, setIsMinimapOpen] = useState(false);\n    const [isWorldViewOpen, setIsWorldViewOpen] = useState(false);\n    const [isSettingsOpen, setIsSettingsOpen] = useState(false);\n    const [isBackgroundOpen, setIsBackgroundOpen] = useState(false);\n    const [isMusicOpen, setIsMusicOpen] = useState(false);\n\n    return (\n        <div style={{ display: 'contents' }}>\n            <BackgroundMusicPlayer metaPath={selectedBackgroundMusic} enabled={true} volume={0.4} />\n            {/* Right side buttons */}\n            <RightSidebarContainer>\n                <SceneEditorButton onClick={() => setIsMinimapOpen(!isMinimapOpen)} $active={isMinimapOpen} title=\"Maps & Minimap\"></SceneEditorButton>\n                <SceneEditorButton onClick={() => setIsWorldViewOpen(!isWorldViewOpen)} $active={isWorldViewOpen} title=\"Project World View\"></SceneEditorButton>\n                <SceneEditorButton onClick={() => setIsBackgroundOpen(!isBackgroundOpen)} $active={isBackgroundOpen} title=\"Background\"></SceneEditorButton>\n                <SceneEditorButton onClick={() => setIsMusicOpen(!isMusicOpen)} $active={isMusicOpen} title=\"Music\">\n                    <span style={{ color: '#fff' }}></span>\n                </SceneEditorButton>\n                <SceneEditorButton onClick={() => setIsSettingsOpen(!isSettingsOpen)} $active={isSettingsOpen} title=\"Settings\"></SceneEditorButton>\n                <SceneEditorButton onClick={() => setIsResizeWindowOpen(!isResizeWindowOpen)} $active={isResizeWindowOpen} title=\"Resize Map\"></SceneEditorButton>\n            </RightSidebarContainer>\n\n            {/* Floating Windows */}\n            {isMinimapOpen && (\n                <DraggableWindow\n                    title=\"Active Map Minimap\"\n                    defaultPosition={{ x: window.innerWidth - 340, y: 80 }}\n                    defaultWidth={300}\n                    isOpenDefault={true}\n                    onClose={() => setIsMinimapOpen(false)}\n                >\n                    <div style={{ display: 'flex', flexDirection: 'column', gap: '10px', padding: '5px' }}>\n                        <Minimap\n                            mapWidth={mapWidth}\n                            mapHeight={mapHeight}\n                            tileMapData={tileMapData}\n                            objectMapData={objectMapData}\n                            objectMetadata={objectMetadata}\n                            registryItems={registryItems}\n                            backgroundColor={selectedBackgroundColor}\n                        />\n                        <div style={{ fontSize: '12px', color: '#ccc', textAlign: 'center' }}>\n                            {maps[activeMapId]?.name || 'Current Map'}\n                        </div>\n                    </div>\n                </DraggableWindow>\n            )}\n\n            {isWorldViewOpen && (\n                <DraggableWindow\n                    title=\"Project World View\"\n                    defaultPosition={{ x: 100, y: 100 }}\n                    defaultWidth={800}\n                    isOpenDefault={true}\n                    onClose={() => setIsWorldViewOpen(false)}\n                >\n                    <WorldView \n                        maps={maps}\n                        activeMapId={activeMapId}\n                        switchMap={switchMap}\n                        registryItems={registryItems}\n                        createMap={createMap}\n                        deleteMap={deleteMap}\n                        updateMapData={updateMapData}\n                        // Current map live data\n                        currentMapData={{\n                            id: activeMapId,\n                            mapWidth,\n                            mapHeight,\n                            tileMapData,\n                            objectMapData,\n                            objectMetadata,\n                            selectedBackgroundColor\n                        }}\n                    />\n                </DraggableWindow>\n            )}\n\n            {isBackgroundOpen && (\n                <DraggableWindow\n                    title=\"Background\"\n                    defaultPosition={{ x: window.innerWidth - 340, y: 80 }}\n                    defaultWidth={320}\n                    isOpenDefault={true}\n                    onClose={() => setIsBackgroundOpen(false)}\n                >\n                    <BackgroundPanel \n                        backgroundOptions={backgroundOptions}\n                        selectedBackgroundImage={selectedBackgroundImage}\n                        setSelectedBackgroundImage={setSelectedBackgroundImage}\n                        selectedBackgroundColor={selectedBackgroundColor}\n                        backgroundParallaxFactor={backgroundParallaxFactor}\n                        setBackgroundParallaxFactor={setBackgroundParallaxFactor}\n                    />\n                </DraggableWindow>\n            )}\n\n            {isMusicOpen && (\n                <DraggableWindow\n                    title=\"Music\"\n                    defaultPosition={{ x: window.innerWidth - 340, y: 300 }}\n                    defaultWidth={320}\n                    isOpenDefault={true}\n                    onClose={() => setIsMusicOpen(false)}\n                >\n                    <MusicPanel \n                        musicOptions={musicOptions}\n                        selectedBackgroundMusic={selectedBackgroundMusic}\n                        setSelectedBackgroundMusic={setSelectedBackgroundMusic}\n                    />\n                </DraggableWindow>\n            )}\n\n            {isSettingsOpen && (\n                <DraggableWindow\n                    title=\"Settings\"\n                    defaultPosition={{ x: window.innerWidth - 340, y: 400 }}\n                    defaultWidth={300}\n                    isOpenDefault={true}\n                    onClose={() => setIsSettingsOpen(false)}\n                >\n                    <WeatherPanel \n                        weatherRain={weatherRain}\n                        setWeatherRain={setWeatherRain}\n                        weatherSnow={weatherSnow}\n                        setWeatherSnow={setWeatherSnow}\n                        weatherClouds={weatherClouds}\n                        setWeatherClouds={setWeatherClouds}\n                        weatherFog={weatherFog}\n                        setWeatherFog={setWeatherFog}\n                        weatherThunder={weatherThunder}\n                        setWeatherThunder={setWeatherThunder}\n                        weatherLavaRain={weatherLavaRain}\n                        setWeatherLavaRain={setWeatherLavaRain}\n                        weatherRadioactiveFog={weatherRadioactiveFog}\n                        setWeatherRadioactiveFog={setWeatherRadioactiveFog}\n                        weatherMeteorRain={weatherMeteorRain}\n                        setWeatherMeteorRain={setWeatherMeteorRain}\n                    />\n                </DraggableWindow>\n            )}\n\n            {isResizeWindowOpen && (\n                <DraggableWindow\n                    title=\"Resize Map\"\n                    defaultPosition={{ x: 400, y: 100 }}\n                    defaultWidth={300}\n                    isOpenDefault={true}\n                    onClose={() => setIsResizeWindowOpen(false)}\n                >\n                    <EditorMapResizer\n                        mapWidth={mapWidth}\n                        mapHeight={mapHeight}\n                        onResize={handleMapResize}\n                    />\n                </DraggableWindow>\n            )}\n        </div>\n    );\n};\n","import React from 'react';\nimport { OperationButton, OperationLabel } from '../styles/EditorElementsButtonStyle';\n\nexport const OperationsPanel = ({ \n    openNewMapModal, \n    saveMap, \n    loadMap, \n    openBuiltInModal,\n    clearMap, \n    mapName, \n    creatorName,\n    mapDescription,\n    setMapName,\n    setCreatorName,\n    setMapDescription\n}) => {\n    const inputStyle = {\n        width: '100%',\n        border: '1px solid transparent',\n        background: 'transparent',\n        padding: '4px 6px',\n        fontSize: '13px',\n        fontWeight: 'bold',\n        outline: 'none',\n        borderRadius: '4px',\n        boxSizing: 'border-box',\n        transition: 'all 0.2s ease',\n        cursor: 'pointer'\n    };\n\n    const handleFocus = (e) => {\n        e.target.style.borderColor = '#2196F3';\n        e.target.style.backgroundColor = '#fff';\n        e.target.style.cursor = 'text';\n    };\n\n    const handleBlur = (e) => {\n        e.target.style.borderColor = 'transparent';\n        e.target.style.backgroundColor = 'transparent';\n        e.target.style.cursor = 'pointer';\n    };\n\n    return (\n        <div style={{ display: 'flex', flexDirection: 'column', gap: '15px' }}>\n            <div style={{ \n                padding: '15px', \n                backgroundColor: '#f9f9f9', \n                borderRadius: '8px', \n                border: '1px solid #ddd', \n                display: 'flex', \n                flexDirection: 'column', \n                gap: '10px' \n            }}>\n                <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '8px' }}>\n                    <OperationButton onClick={openNewMapModal} title=\"New Map\">\n                        <span style={{ fontSize: '18px' }}></span>\n                        <span>New</span>\n                    </OperationButton>\n                    <OperationButton onClick={saveMap} title=\"Save Map\">\n                        <span style={{ fontSize: '18px' }}></span>\n                        <span>Save</span>\n                    </OperationButton>\n                    <OperationLabel title=\"Load Map\">\n                        <span style={{ fontSize: '18px' }}></span>\n                        <span>Load</span>\n                        <input type=\"file\" accept=\".json,.txt\" onChange={loadMap} style={{ display: 'none' }} />\n                    </OperationLabel>\n                    <OperationButton onClick={openBuiltInModal} title=\"Built-in Maps\">\n                        <span style={{ fontSize: '18px' }}></span>\n                        <span>Built-in</span>\n                    </OperationButton>\n                    <OperationButton onClick={clearMap} $danger title=\"Clear Map\">\n                        <span style={{ fontSize: '18px' }}></span>\n                        <span>Clear</span>\n                    </OperationButton>\n                </div>\n            </div>\n\n            <div style={{ padding: '12px', backgroundColor: '#f9f9f9', borderRadius: '8px', border: '1px solid #ddd', display: 'flex', flexDirection: 'column', gap: '10px' }}>\n                <div>\n                    <label style={{ fontSize: '10px', color: '#888', fontWeight: 'bold', marginLeft: '6px', marginBottom: '2px', display: 'block' }}>MAP NAME</label>\n                    <input \n                        value={mapName} \n                        onChange={(e) => setMapName(e.target.value)}\n                        style={inputStyle}\n                        onFocus={handleFocus}\n                        onBlur={handleBlur}\n                        title=\"Click to edit map name\"\n                    />\n                </div>\n                \n                <div>\n                    <label style={{ fontSize: '10px', color: '#888', fontWeight: 'bold', marginLeft: '6px', marginBottom: '2px', display: 'block' }}>AUTHOR</label>\n                    <input \n                        value={creatorName} \n                        onChange={(e) => setCreatorName(e.target.value)}\n                        style={inputStyle}\n                        onFocus={handleFocus}\n                        onBlur={handleBlur}\n                        title=\"Click to edit author\"\n                    />\n                </div>\n\n                <div>\n                    <label style={{ fontSize: '10px', color: '#888', fontWeight: 'bold', marginLeft: '6px', marginBottom: '2px', display: 'block' }}>DESCRIPTION</label>\n                    <textarea \n                        value={mapDescription} \n                        onChange={(e) => setMapDescription(e.target.value)}\n                        style={{ ...inputStyle, fontWeight: 'normal', minHeight: '60px', resize: 'vertical' }}\n                        onFocus={handleFocus}\n                        onBlur={handleBlur}\n                        title=\"Click to edit description\"\n                    />\n                </div>\n            </div>\n        </div>\n    );\n};\n","import React, { useState } from 'react';\n\nexport const CollapsiblePanel = ({ title, children, isOpenDefault = false }) => {\n    const [isOpen, setIsOpen] = useState(isOpenDefault);\n    return (\n        <div style={{ marginBottom: '5px', border: '1px solid #ddd', borderRadius: '4px', backgroundColor: '#fff' }}>\n            <div onClick={() => setIsOpen(!isOpen)} style={{ padding: '8px', cursor: 'pointer', backgroundColor: '#f0f0f0', fontWeight: 'bold', fontSize: '12px', display: 'flex', justifyContent: 'space-between', alignItems: 'center', userSelect: 'none' }}>\n                <span>{title}</span><span>{isOpen ? '' : ''}</span>\n            </div>\n            {isOpen && <div style={{ padding: '8px', maxHeight: '200px', overflowY: 'auto' }}>{children}</div>}\n        </div>\n    );\n};\n","import React from 'react';\nimport { CollapsiblePanel } from './CollapsiblePanel';\nimport AnimatedItem from '../../../../utilities/AnimatedItem';\n\nexport const PalettePanel = ({ \n    isPlayMode, \n    category,\n    blocks, \n    liquids, \n    entities, \n    decorations, \n    items, \n    interactables, \n    hazards, \n    secrets, \n    weather,\n    messages,\n    alternativeSecrets,\n    obstacles,\n    handlePaletteSelect, \n    selectedTile \n}) => {\n    const renderPaletteItem = (item, color, layer) => {\n        const hasImage = !!(item.texture || (Array.isArray(item.textures) && item.textures.length > 0));\n        const editorIcon = item.editorIcon;\n        const isLiquid = !!(item.flags && item.flags.liquid);\n        const isWater = !!(item.flags && item.flags.water);\n        const isLava = !!(item.flags && item.flags.lava);\n        const isQuicksand = !!(item.flags && item.flags.quicksand);\n        const isWaterfall = !!(item.flags && item.flags.waterfall);\n        const isLavaWaterfall = !!(item.flags && item.flags.lava_waterfall);\n        const isRadioactive = !!(item.flags && item.flags.radioactive);\n        const isRadioactiveWaterfall = !!(item.flags && item.flags.radioactive_waterfall);\n        const isSecret = item.type === 'secret';\n        const isWeatherTrigger = item.type === 'weather_trigger';\n        const isMessageTrigger = item.type === 'message_trigger';\n        \n        const swatchStyle = isLavaWaterfall\n            ? { background: 'linear-gradient(180deg,#ffcc00,#ffff00)' }\n            : (isLava ? { background: 'linear-gradient(180deg,#ffcc00,#ffff00)' }\n            : (isWater || isWaterfall ? { background: 'linear-gradient(180deg,#3a7fb8,#5ba3d9)' }\n            : (isQuicksand ? { background: 'linear-gradient(180deg,#a6915b,#7d6d42)' }\n            : (isRadioactive || isRadioactiveWaterfall ? { background: 'linear-gradient(180deg,#1a5c1a,#32cd32)' }\n            : { background: '#eee' }))));\n\n        return (\n            <div\n                key={item.id}\n                onClick={() => handlePaletteSelect(item, layer)}\n                title={item.displayName || item.name}\n                style={{\n                    border: selectedTile?.id === item.id ? `2px solid ${color}` : '1px solid #ccc',\n                    cursor: 'pointer', padding: '2px', width: '36px', height: '36px',\n                    display: 'flex', alignItems: 'center', justifyContent: 'center', backgroundColor: '#fff',\n                    position: 'relative'\n                }}\n            >\n                {isSecret ? (\n                    <div style={{\n                        width: '100%', height: '100%', borderRadius: 2,\n                        display: 'flex', alignItems: 'center', justifyContent: 'center',\n                        background: item.filterColorInEditor || item.filterColor || 'rgba(0, 0, 0, 0.5)',\n                        color: '#fff', fontSize: 8, textAlign: 'center', lineHeight: 1.1, fontWeight: 'bold'\n                    }}>\n                        {item.editorIcon || (item.subtype === 'above' ? 'ABOVE' : 'BELOW')}\n                    </div>\n                ) : (isWeatherTrigger || isMessageTrigger) ? (\n                    <div style={{\n                        width: '100%', height: '100%', borderRadius: 2,\n                        display: 'flex', alignItems: 'center', justifyContent: 'center',\n                        background: isMessageTrigger ? '#fff9c4' : '#f0f4f8', \n                        border: isMessageTrigger ? '1px solid #fbc02d' : '1px solid #d1d9e6',\n                        color: '#333', fontSize: '18px'\n                    }}>\n                        {item.editorIcon}\n                    </div>\n                ) : editorIcon ? (\n                    <div style={{ fontSize: '24px', fontWeight: 'bold', color: '#333' }}>\n                        {editorIcon}\n                    </div>\n                ) : hasImage ? (\n                    <AnimatedItem\n                        textures={item.textures}\n                        texture={item.texture}\n                        speed={item.animationSpeed}\n                        spriteSheet={item.spriteSheet}\n                        style={{ maxWidth: '100%', maxHeight: '100%', objectFit: 'contain' }}\n                        alt={item.name}\n                    />\n                ) : (\n                    <div style={{\n                        width: '100%', height: '100%', borderRadius: 2,\n                        display: 'flex', alignItems: 'center', justifyContent: 'center', color: '#fff',\n                        fontSize: 10, textAlign: 'center', lineHeight: 1.1,\n                        ...swatchStyle\n                    }}>\n                        {isLiquid ? (isLavaWaterfall ? 'L.FALL' : (isLava ? 'LAVA' : (isRadioactiveWaterfall ? 'RADFALL' : (isRadioactive ? 'RAD' : (isWater ? 'WATER' : (isWaterfall ? 'FALL' : (isQuicksand ? 'QUICK' : 'LIQ'))))))) : (item.name || '')}\n                    </div>\n                )}\n            </div>\n        );\n    };\n\n    if (isPlayMode) {\n        return (\n            <div style={{ padding: '20px', fontSize: '14px', color: '#666', textAlign: 'center', backgroundColor: '#f9f9f9', borderRadius: '8px' }}>\n                Palette disabled during Play mode\n            </div>\n        );\n    }\n\n    return (\n        <div style={{ display: 'flex', flexDirection: 'column', gap: '10px' }}>\n            {category === 'blocks' && (\n                <CollapsiblePanel title=\"Blocks (Background)\" isOpenDefault={true}>\n                    <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                        {blocks.map(b => renderPaletteItem(b, 'blue', 'tile'))}\n                    </div>\n                </CollapsiblePanel>\n            )}\n\n            {category === 'liquids' && (\n                <div style={{ display: 'flex', flexDirection: 'column', gap: '10px' }}>\n                    <CollapsiblePanel title=\"Liquids (Blocks)\" isOpenDefault={true}>\n                        <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                            {liquids.filter(li => !li.flags?.radioactive).map(li => renderPaletteItem(li, 'blue', 'tile'))}\n                        </div>\n                    </CollapsiblePanel>\n                    <CollapsiblePanel title=\"Radioactive\" isOpenDefault={true}>\n                        <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                            {liquids.filter(li => li.flags?.radioactive).map(li => renderPaletteItem(li, 'green', 'tile'))}\n                        </div>\n                    </CollapsiblePanel>\n                </div>\n            )}\n\n            {category === 'decorations' && (\n                <CollapsiblePanel title=\"Decorations\" isOpenDefault={true}>\n                    <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                        {decorations && decorations.map(d => renderPaletteItem(d, 'purple', 'object'))}\n                    </div>\n                </CollapsiblePanel>\n            )}\n\n            {category === 'entities' && (\n                <CollapsiblePanel title=\"Entities (Objects)\" isOpenDefault={true}>\n                    <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                        {entities.map(e => renderPaletteItem(e, 'red', 'object'))}\n                    </div>\n                </CollapsiblePanel>\n            )}\n\n            {category === 'items' && (\n                <CollapsiblePanel title=\"Items (Objects)\" isOpenDefault={true}>\n                    <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                        {items.map(i => renderPaletteItem(i, 'green', 'object'))}\n                    </div>\n                </CollapsiblePanel>\n            )}\n\n            {category === 'interactables' && (\n                <CollapsiblePanel title=\"Interactables\" isOpenDefault={true}>\n                    <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                        {interactables.map(i => renderPaletteItem(i, 'purple', 'object'))}\n                    </div>\n                </CollapsiblePanel>\n            )}\n\n            {category === 'hazards' && (\n                <CollapsiblePanel title=\"Hazards\" isOpenDefault={true}>\n                    <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                        {hazards.map(h => renderPaletteItem(h, 'orange', 'object'))}\n                    </div>\n                </CollapsiblePanel>\n            )}\n\n            {category === 'secrets' && (\n                <div style={{ display: 'flex', flexDirection: 'column', gap: '10px' }}>\n                    <CollapsiblePanel title=\"Open Area\" isOpenDefault={true}>\n                        <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                            {secrets && secrets.filter(s => s.subtype === 'open').map(s => renderPaletteItem(s, 'purple', 'secret'))}\n                        </div>\n                    </CollapsiblePanel>\n                    \n                    <CollapsiblePanel title=\"Secret Area\" isOpenDefault={true}>\n                        <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                            {secrets && secrets.filter(s => s.subtype !== 'open').map(s => renderPaletteItem(s, 'purple', 'secret'))}\n                        </div>\n                    </CollapsiblePanel>\n\n                    <CollapsiblePanel title=\"Weather Rain\" isOpenDefault={false}>\n                        <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                            {weather && weather.filter(w => w.weatherType === 'rain').map(w => renderPaletteItem(w, 'blue', 'object'))}\n                        </div>\n                    </CollapsiblePanel>\n\n                    <CollapsiblePanel title=\"Weather Snow\" isOpenDefault={false}>\n                        <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                            {weather && weather.filter(w => w.weatherType === 'snow').map(w => renderPaletteItem(w, 'blue', 'object'))}\n                        </div>\n                    </CollapsiblePanel>\n\n                    <CollapsiblePanel title=\"Weather Clouds\" isOpenDefault={false}>\n                        <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                            {weather && weather.filter(w => w.weatherType === 'clouds').map(w => renderPaletteItem(w, 'blue', 'object'))}\n                        </div>\n                    </CollapsiblePanel>\n\n                    <CollapsiblePanel title=\"Weather Fog\" isOpenDefault={false}>\n                        <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                            {weather && weather.filter(w => w.weatherType === 'fog').map(w => renderPaletteItem(w, 'blue', 'object'))}\n                        </div>\n                    </CollapsiblePanel>\n\n                    <CollapsiblePanel title=\"Weather Thunder\" isOpenDefault={false}>\n                        <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                            {weather && weather.filter(w => w.weatherType === 'thunder').map(w => renderPaletteItem(w, 'blue', 'object'))}\n                        </div>\n                    </CollapsiblePanel>\n\n                    <CollapsiblePanel title=\"Weather Lava Rain\" isOpenDefault={false}>\n                        <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                            {weather && weather.filter(w => w.weatherType === 'lavaRain').map(w => renderPaletteItem(w, 'red', 'object'))}\n                        </div>\n                    </CollapsiblePanel>\n\n                    <CollapsiblePanel title=\"Weather Radio Fog\" isOpenDefault={false}>\n                        <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                            {weather && weather.filter(w => w.weatherType === 'radioactiveFog').map(w => renderPaletteItem(w, 'green', 'object'))}\n                        </div>\n                    </CollapsiblePanel>\n\n                    <CollapsiblePanel title=\"Weather Meteor Rain\" isOpenDefault={false}>\n                        <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                            {weather && weather.filter(w => w.weatherType === 'meteorRain').map(w => renderPaletteItem(w, 'orange', 'object'))}\n                        </div>\n                    </CollapsiblePanel>\n\n                    <CollapsiblePanel title=\"Messages\" isOpenDefault={false}>\n                        <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                            {messages && messages.map(m => renderPaletteItem(m, 'gold', 'object'))}\n                        </div>\n                    </CollapsiblePanel>\n\n                    <CollapsiblePanel title=\"Alternative Secrets\" isOpenDefault={false}>\n                        <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                            {alternativeSecrets && alternativeSecrets.map(s => renderPaletteItem(s, 'purple', 'object'))}\n                        </div>\n                    </CollapsiblePanel>\n                </div>\n            )}\n\n            {category === 'obstacles' && (\n                <CollapsiblePanel title=\"Obstacles\" isOpenDefault={true}>\n                    <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                        {obstacles && obstacles.length > 0 ? (\n                            obstacles.map(o => renderPaletteItem(o, 'brown', 'object'))\n                        ) : (\n                            <div style={{ padding: '10px', fontSize: '12px', color: '#999', fontStyle: 'italic' }}>\n                                No obstacles available yet\n                            </div>\n                        )}\n                    </div>\n                </CollapsiblePanel>\n            )}\n        </div>\n    );\n};\n","import React from 'react';\n\nexport const StatisticsPanel = ({ \n    totalTiles, \n    mapWidth, \n    mapHeight, \n    filledBlocks, \n    objectsCount, \n    emptyBlocks \n}) => {\n    return (\n        <div style={{ display: 'flex', flexDirection: 'column', gap: '12px' }}>\n            <div style={{ padding: '15px', backgroundColor: '#e6f7ff', borderRadius: '8px', border: '1px solid #91d5ff' }}>\n                <div style={{ fontSize: '14px', marginBottom: '8px' }}>Total Map Area: <strong>{totalTiles}</strong> tiles</div>\n                <div style={{ fontSize: '13px', color: '#0050b3' }}>Dimensions: {mapWidth} x {mapHeight}</div>\n            </div>\n            <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '10px' }}>\n                <div style={{ padding: '12px', backgroundColor: '#f6ffed', borderRadius: '8px', border: '1px solid #b7eb8f', textAlign: 'center' }}>\n                    <div style={{ fontSize: '20px', fontWeight: 'bold', color: '#389e0d' }}>{filledBlocks}</div>\n                    <div style={{ fontSize: '11px', color: '#555' }}>FILLED BLOCKS</div>\n                </div>\n                <div style={{ padding: '12px', backgroundColor: '#fff7e6', borderRadius: '8px', border: '1px solid #ffd591', textAlign: 'center' }}>\n                    <div style={{ fontSize: '20px', fontWeight: 'bold', color: '#d46b08' }}>{objectsCount}</div>\n                    <div style={{ fontSize: '11px', color: '#555' }}>OBJECTS</div>\n                </div>\n            </div>\n            <div style={{ padding: '12px', backgroundColor: '#f9f9f9', borderRadius: '8px', border: '1px solid #ddd', textAlign: 'center' }}>\n                    <div style={{ fontSize: '20px', fontWeight: 'bold', color: '#666' }}>{emptyBlocks}</div>\n                    <div style={{ fontSize: '11px', color: '#555' }}>EMPTY SPACE</div>\n            </div>\n        </div>\n    );\n};\n","import React from 'react';\n\nexport const ObjectPropsPanel = ({ \n    objectMapData, \n    registryItems, \n    mapWidth, \n    objectMetadata, \n    highlightedIndex, \n    setHighlightedIndex, \n    setObjectMetadata,\n    maps\n}) => {\n    const mapList = Object.values(maps || {});\n    const listRef = React.useRef(null);\n\n    // Auto-scroll to highlighted item\n    React.useEffect(() => {\n        if (highlightedIndex !== null && listRef.current) {\n            const highlightedElement = listRef.current.querySelector(`[data-index=\"${highlightedIndex}\"]`);\n            if (highlightedElement) {\n                highlightedElement.scrollIntoView({ behavior: 'smooth', block: 'center' });\n            }\n        }\n    }, [highlightedIndex]);\n\n    return (\n        <div style={{ padding: '0' }}>\n            <p style={{ fontSize: '12px', color: '#666', lineHeight: '1.4' }}>\n                Configure triggers for Portals, Targets, Weather and Messages.\n                <br />\n                <strong>1.</strong> Place a <strong>Portal</strong>, <strong>Target</strong>, <strong>Weather</strong> or <strong>Message Trigger</strong> from the palette.\n                <br />\n                <strong>2.</strong> Configure <strong>Trigger ID</strong> for links, <strong>Intensity</strong> for weather or <strong>Message Text</strong>.\n            </p>\n            <div ref={listRef} style={{ maxHeight: 'calc(100vh - 200px)', overflowY: 'auto' }}>\n                {objectMapData.map((id, index) => {\n                    if (!id) return null;\n                    const def = registryItems.find(r => r.id === id);\n                    const isWeather = def && def.type === 'weather_trigger';\n                    const isMessage = def && def.type === 'message_trigger';\n                    const isPortalOrTarget = id.includes('portal') || id.includes('target') || id === 'portal_target';\n                    \n                    if (!def || (!isPortalOrTarget && !isWeather && !isMessage)) return null;\n\n                    const x = index % mapWidth;\n                    const y = Math.floor(index / mapWidth);\n                    const metadata = objectMetadata[index] || {};\n                    const isHighlighted = highlightedIndex === index;\n\n                    return (\n                        <div key={index} \n                            data-index={index}\n                            onMouseEnter={() => setHighlightedIndex(index)}\n                            onMouseLeave={() => setHighlightedIndex(null)}\n                            style={{\n                                padding: '10px',\n                                border: isHighlighted ? '1px solid gold' : '1px solid #eee',\n                                display: 'flex',\n                                flexDirection: 'column',\n                                gap: '5px',\n                                backgroundColor: isHighlighted ? '#fffde7' : '#f9f9f9',\n                                marginBottom: '5px',\n                                borderRadius: '4px',\n                                transition: 'all 0.2s ease'\n                            }}\n                        >\n                            <div style={{ fontWeight: 'bold', fontSize: '13px', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\n                                <span style={{ display: 'flex', alignItems: 'center', gap: '5px' }}>\n                                    {(isWeather || isMessage) ? def.editorIcon : (id.includes('portal') && !id.includes('target') ? '' : '')} {def.displayName || def.name}\n                                </span>\n                                <div style={{ display: 'flex', gap: '5px', alignItems: 'center' }}>\n                                    <span style={{ color: '#666', fontSize: '11px' }}>({x}, {y})</span>\n                                    <button \n                                        onClick={() => {\n                                            const el = document.querySelector(`.viewport`);\n                                            if (el) {\n                                                const scrollX = x * 32 - el.clientWidth / 2 + 16;\n                                                const scrollY = y * 32 - el.clientHeight / 2 + 16;\n                                                el.scrollTo({ left: scrollX, top: scrollY, behavior: 'smooth' });\n                                            }\n                                        }}\n                                        style={{ \n                                            padding: '2px 6px', fontSize: '10px', cursor: 'pointer',\n                                            backgroundColor: '#eee', border: '1px solid #ccc', borderRadius: '3px'\n                                        }}\n                                        title=\"Scroll to this object\"\n                                    >\n                                        Locate\n                                    </button>\n                                </div>\n                            </div>\n\n                            {(!isWeather && !isMessage) && (\n                                <div style={{ display: 'flex', alignItems: 'center', gap: '10px' }}>\n                                    <label style={{ fontSize: '12px', fontWeight: 'bold' }}>Trigger ID:</label>\n                                    <input\n                                        type=\"number\"\n                                        value={metadata.triggerId || ''}\n                                        onChange={(e) => {\n                                            const val = parseInt(e.target.value);\n                                            setObjectMetadata(prev => ({\n                                                ...prev,\n                                                [index]: { ...prev[index], triggerId: isNaN(val) ? null : val }\n                                            }));\n                                        }}\n                                        style={{\n                                            flex: 1,\n                                            padding: '4px 8px',\n                                            border: '1px solid #ccc',\n                                            borderRadius: '4px',\n                                            fontSize: '13px',\n                                            backgroundColor: isHighlighted ? '#fff' : '#f0f0f0'\n                                        }}\n                                        placeholder=\"Enter ID (e.g. 1)\"\n                                    />\n                                </div>\n                            )}\n\n                            {isWeather && def.hasIntensity && (\n                                <div style={{ display: 'flex', alignItems: 'center', gap: '10px' }}>\n                                    <label style={{ fontSize: '12px', fontWeight: 'bold' }}>Intensity (%):</label>\n                                    <input\n                                        type=\"number\"\n                                        min=\"0\"\n                                        max=\"100\"\n                                        value={metadata.intensity !== undefined ? metadata.intensity : 50}\n                                        onChange={(e) => {\n                                            const val = parseInt(e.target.value);\n                                            setObjectMetadata(prev => ({\n                                                ...prev,\n                                                [index]: { ...prev[index], intensity: isNaN(val) ? 0 : Math.min(100, Math.max(0, val)) }\n                                            }));\n                                        }}\n                                        style={{\n                                            flex: 1,\n                                            padding: '4px 8px',\n                                            border: '1px solid #ccc',\n                                            borderRadius: '4px',\n                                            fontSize: '13px',\n                                            backgroundColor: isHighlighted ? '#fff' : '#f0f0f0'\n                                        }}\n                                    />\n                                </div>\n                            )}\n\n                            {isMessage && (\n                                <div style={{ display: 'flex', flexDirection: 'column', gap: '5px' }}>\n                                    <label style={{ fontSize: '12px', fontWeight: 'bold' }}>Message Text:</label>\n                                    <textarea\n                                        value={metadata.message || ''}\n                                        onChange={(e) => {\n                                            const val = e.target.value;\n                                            setObjectMetadata(prev => ({\n                                                ...prev,\n                                                [index]: { ...prev[index], message: val }\n                                            }));\n                                        }}\n                                        rows={3}\n                                        style={{\n                                            width: '100%',\n                                            padding: '6px 8px',\n                                            border: '1px solid #ccc',\n                                            borderRadius: '4px',\n                                            fontSize: '13px',\n                                            backgroundColor: isHighlighted ? '#fff' : '#f0f0f0',\n                                            resize: 'vertical',\n                                            fontFamily: 'inherit'\n                                        }}\n                                        placeholder=\"Enter message to display...\"\n                                    />\n                                </div>\n                            )}\n\n                            {id.includes('portal') && !id.includes('target') && (\n                                <div style={{ display: 'flex', alignItems: 'center', gap: '10px', marginTop: '5px' }}>\n                                    <label style={{ fontSize: '12px', fontWeight: 'bold' }}>Target Map:</label>\n                                    <select\n                                        value={metadata.targetMapId || ''}\n                                        onChange={(e) => {\n                                            const val = e.target.value;\n                                            setObjectMetadata(prev => ({\n                                                ...prev,\n                                                [index]: { ...prev[index], targetMapId: val === '' ? null : val }\n                                            }));\n                                        }}\n                                        style={{\n                                            flex: 1,\n                                            padding: '4px 8px',\n                                            border: '1px solid #ccc',\n                                            borderRadius: '4px',\n                                            fontSize: '13px',\n                                            backgroundColor: isHighlighted ? '#fff' : '#f0f0f0'\n                                        }}\n                                    >\n                                        <option value=\"\">Current Map</option>\n                                        {mapList.map(m => (\n                                            <option key={m.id} value={m.id}>{m.name}</option>\n                                        ))}\n                                    </select>\n                                </div>\n                            )}\n\n                            {/* Size Configuration */}\n                            <div style={{ display: 'flex', alignItems: 'center', gap: '10px', marginTop: '5px', paddingTop: '5px', borderTop: '1px solid #eee' }}>\n                                <div style={{ display: 'flex', alignItems: 'center', gap: '5px' }}>\n                                    <label style={{ fontSize: '11px', color: '#666' }}>W:</label>\n                                    <input\n                                        type=\"number\"\n                                        min=\"1\"\n                                        max=\"50\"\n                                        value={metadata.width || 1}\n                                        onChange={(e) => {\n                                            const val = parseInt(e.target.value);\n                                            setObjectMetadata(prev => ({\n                                                ...prev,\n                                                [index]: { ...prev[index], width: isNaN(val) ? 1 : Math.max(1, val) }\n                                            }));\n                                        }}\n                                        style={{ width: '40px', padding: '2px 4px', fontSize: '12px', border: '1px solid #ccc', borderRadius: '3px' }}\n                                    />\n                                </div>\n                                <div style={{ display: 'flex', alignItems: 'center', gap: '5px' }}>\n                                    <label style={{ fontSize: '11px', color: '#666' }}>H:</label>\n                                    <input\n                                        type=\"number\"\n                                        min=\"1\"\n                                        max=\"50\"\n                                        value={metadata.height || 1}\n                                        onChange={(e) => {\n                                            const val = parseInt(e.target.value);\n                                            setObjectMetadata(prev => ({\n                                                ...prev,\n                                                [index]: { ...prev[index], height: isNaN(val) ? 1 : Math.max(1, val) }\n                                            }));\n                                        }}\n                                        style={{ width: '40px', padding: '2px 4px', fontSize: '12px', border: '1px solid #ccc', borderRadius: '3px' }}\n                                    />\n                                </div>\n                                <span style={{ fontSize: '10px', color: '#999' }}>Drag handles on map to resize</span>\n                            </div>\n                        </div>\n                    );\n                })}\n                {objectMapData.filter(id => {\n                    if (!id) return false;\n                    const def = registryItems.find(r => r.id === id);\n                    const isWeather = def && def.type === 'weather_trigger';\n                    const isMessage = def && def.type === 'message_trigger';\n                    const isPortalOrTarget = id.includes('portal') || id.includes('target') || id === 'portal_target';\n                    return isPortalOrTarget || isWeather || isMessage;\n                }).length === 0 && (\n                    <p style={{ textAlign: 'center', color: '#999', marginTop: '20px', fontSize: '14px' }}>\n                        No configurable objects found on map.\n                    </p>\n                )}\n            </div>\n        </div>\n    );\n};\n","import React from 'react';\nimport { \n    SidebarContainer,\n    ElementEditorButton,\n    PanelContainer,\n    PanelHeader,\n    PanelBody,\n    CloseButton\n} from './styles/EditorElementsButtonStyle';\n\n// Panels\nimport { OperationsPanel } from './editorElements/OperationsPanel';\nimport { PalettePanel } from './editorElements/PalettePanel';\nimport { StatisticsPanel } from './editorElements/StatisticsPanel';\nimport { ObjectPropsPanel } from './editorElements/ObjectPropsPanel';\n\nexport const EditorElements = ({\n    mapName,\n    creatorName,\n    mapDescription,\n    setMapName,\n    setCreatorName,\n    setMapDescription,\n    openNewMapModal,\n    openBuiltInModal,\n    saveMap,\n    loadMap,\n    clearMap,\n    isPlayMode,\n    handlePaletteSelect,\n    selectedTile,\n    blocks,\n    liquids,\n    entities,\n    items,\n    decorations,\n    interactables,\n    hazards,\n    secrets,\n    weather,\n    messages,\n    alternativeSecrets,\n    obstacles,\n    totalTiles,\n    filledBlocks,\n    emptyBlocks,\n    objectsCount,\n    mapWidth,\n    mapHeight,\n    objectMapData,\n    objectMetadata,\n    setObjectMetadata,\n    registryItems,\n    highlightedIndex,\n    setHighlightedIndex,\n    activePanel,\n    setActivePanel,\n    togglePanel,\n    maps\n}) => {\n    const [lastPanel, setLastPanel] = React.useState(null);\n\n    React.useEffect(() => {\n        if (activePanel) {\n            setLastPanel(activePanel);\n        }\n    }, [activePanel]);\n\n    const displayPanel = activePanel || lastPanel;\n\n    const panelTitles = {\n        map: 'Operations',\n        blocks: 'Blocks',\n        liquids: 'Liquids (Blocks)',\n        decorations: 'Decorations',\n        entities: 'Entities (Objects)',\n        items: 'Items (Objects)',\n        interactables: 'Interactables',\n        hazards: 'Hazards',\n        secrets: 'Sectors',\n        obstacles: 'Obstacles',\n        stats: 'Statistics',\n        props: 'Object Properties'\n    };\n\n    return (\n        <div style={{ display: 'flex', height: '100%', position: 'relative', zIndex: 1001 }}>\n            {/* Sidebar Left Icons */}\n            <SidebarContainer>\n                <ElementEditorButton onClick={() => togglePanel('map')} $active={activePanel === 'map'} title=\"Map Controls\"></ElementEditorButton>\n                <ElementEditorButton onClick={() => togglePanel('blocks')} $active={activePanel === 'blocks'} title=\"Blocks\"></ElementEditorButton>\n                <ElementEditorButton onClick={() => togglePanel('liquids')} $active={activePanel === 'liquids'} title=\"Liquids\"></ElementEditorButton>\n                <ElementEditorButton onClick={() => togglePanel('decorations')} $active={activePanel === 'decorations'} title=\"Decorations\"></ElementEditorButton>\n                <ElementEditorButton onClick={() => togglePanel('obstacles')} $active={activePanel === 'obstacles'} title=\"Obstacles\"></ElementEditorButton>\n                <ElementEditorButton onClick={() => togglePanel('items')} $active={activePanel === 'items'} title=\"Items\"></ElementEditorButton>\n                <ElementEditorButton onClick={() => togglePanel('entities')} $active={activePanel === 'entities'} title=\"Entities\"></ElementEditorButton>\n                <ElementEditorButton onClick={() => togglePanel('interactables')} $active={activePanel === 'interactables'} title=\"Interactables\"></ElementEditorButton>\n                <ElementEditorButton onClick={() => togglePanel('hazards')} $active={activePanel === 'hazards'} title=\"Hazards\"></ElementEditorButton>\n                <ElementEditorButton onClick={() => togglePanel('secrets')} $active={activePanel === 'secrets'} title=\"Sectors\">2</ElementEditorButton>\n                <ElementEditorButton onClick={() => togglePanel('stats')} $active={activePanel === 'stats'} title=\"Statistics\"></ElementEditorButton>\n                <ElementEditorButton onClick={() => togglePanel('props')} $active={activePanel === 'props'} title=\"Object Properties\"></ElementEditorButton>\n            </SidebarContainer>\n\n            {/* Sidebar Fixed Panel Content */}\n            <PanelContainer $isOpen={!!activePanel}>\n                {displayPanel && (\n                    <>\n                        {/* Panel Header */}\n                        <PanelHeader>\n                            <span>{panelTitles[displayPanel]}</span>\n                            <CloseButton onClick={() => setActivePanel(null)}></CloseButton>\n                        </PanelHeader>\n\n                        {/* Panel Body */}\n                        <PanelBody>\n                            {displayPanel === 'map' && (\n                                <OperationsPanel \n                                    openNewMapModal={openNewMapModal}\n                                    openBuiltInModal={openBuiltInModal}\n                                    saveMap={saveMap}\n                                    loadMap={loadMap}\n                                    clearMap={clearMap}\n                                    mapName={mapName}\n                                    creatorName={creatorName}\n                                    mapDescription={mapDescription}\n                                    setMapName={setMapName}\n                                    setCreatorName={setCreatorName}\n                                    setMapDescription={setMapDescription}\n                                />\n                            )}\n\n                            {(displayPanel === 'blocks' || \n                              displayPanel === 'liquids' || \n                              displayPanel === 'decorations' || \n                              displayPanel === 'entities' || \n                              displayPanel === 'items' || \n                              displayPanel === 'interactables' || \n                              displayPanel === 'hazards' || \n                              displayPanel === 'secrets' ||\n                              displayPanel === 'obstacles') && (\n                                <PalettePanel \n                                    isPlayMode={isPlayMode}\n                                    category={displayPanel}\n                                    blocks={blocks}\n                                    liquids={liquids}\n                                    entities={entities}\n                                    decorations={decorations}\n                                    items={items}\n                                    interactables={interactables}\n                                    hazards={hazards}\n                                    secrets={secrets}\n                                    weather={weather}\n                                    messages={messages}\n                                    alternativeSecrets={alternativeSecrets}\n                                    obstacles={obstacles}\n                                    handlePaletteSelect={handlePaletteSelect}\n                                    selectedTile={selectedTile}\n                                />\n                            )}\n\n\n                            {displayPanel === 'stats' && (\n                                <StatisticsPanel \n                                    totalTiles={totalTiles}\n                                    mapWidth={mapWidth}\n                                    mapHeight={mapHeight}\n                                    filledBlocks={filledBlocks}\n                                    objectsCount={objectsCount}\n                                    emptyBlocks={emptyBlocks}\n                                />\n                            )}\n\n                            {displayPanel === 'props' && (\n                                <ObjectPropsPanel \n                                    objectMapData={objectMapData}\n                                    registryItems={registryItems}\n                                    mapWidth={mapWidth}\n                                    objectMetadata={objectMetadata}\n                                    highlightedIndex={highlightedIndex}\n                                    setHighlightedIndex={setHighlightedIndex}\n                                    setObjectMetadata={setObjectMetadata}\n                                    maps={maps}\n                                />\n                            )}\n                        </PanelBody>\n                    </>\n                )}\n            </PanelContainer>\n        </div>\n    );\n};\n","import React from 'react';\nimport { \n    EditorToolsContainer,\n    HeaderBar,\n    ToolsSection,\n    ToolsGroup,\n    ToolsInnerGroup,\n    ToolsRow,\n    ToolsEditorButton,\n    StrikeThrough,\n    LayerIndicator,\n    BgColorContainer,\n    BgColorInputWrapper,\n    BgColorInput,\n    PlayButtonContainer,\n    PlayButtonInner,\n    InfoContainer,\n    InfoItem,\n    InfoLabel,\n    InfoValue,\n    EraserButtonContainer,\n    EraserButtonInner,\n    SelectionActions,\n    ConfirmButton,\n    CancelButton,\n    GridIcon\n} from './styles/EditorToolsButton';\n\nexport const EditorTools = ({\n    mapName, \n    creatorName, \n    activePanel, \n    togglePanel,\n    showGrid, \n    setShowGrid,\n    isPlayMode,\n    handlePlay,\n    handlePause,\n    handleReset,\n    activeTool,\n    setActiveTool,\n    brushSize,\n    setBrushSize,\n    activeLayer,\n    selection,\n    moveSelection,\n    selectionMode,\n    setSelectionMode,\n    commitSelection,\n    cancelSelection,\n    selectedTile,\n    handlePaletteSelect,\n    selectedBackgroundColor,\n    setSelectedBackgroundColor,\n    showBackgroundImage,\n    setShowBackgroundImage\n}) => {\n    const getEraserData = (layer) => {\n        const isActive = selectedTile === null && activeLayer === layer;\n        const colors = {\n            tile: { bg: '#e6f7ff', text: '#1890ff' },\n            object: { bg: '#fff1f0', text: '#f5222d' },\n            secret: { bg: '#f9f0ff', text: '#722ed1' },\n            props: { bg: '#fffbe6', text: '#faad14' }\n        };\n        const active = colors[layer] || colors.tile;\n        return {\n            isActive,\n            bgColor: active.bg,\n            textColor: active.text\n        };\n    };\n\n    const getLayerIndicatorData = () => {\n        const colors = {\n            tile: { bg: '#e6f7ff', border: '#91d5ff', text: '#1890ff' },\n            object: { bg: '#fff1f0', border: '#ffa39e', text: '#f5222d' },\n            secret: { bg: '#f9f0ff', border: '#d3adf7', text: '#722ed1' },\n            props: { bg: '#fffbe6', border: '#ffe58f', text: '#faad14' }\n        };\n        const active = colors[activeLayer] || colors.tile;\n        return {\n            $bgColor: active.bg,\n            $borderColor: active.border,\n            $textColor: active.text\n        };\n    };\n\n    return (\n        <EditorToolsContainer>\n            {/* Main Header Bar */}\n            <HeaderBar>\n                <ToolsSection>\n                    <ToolsGroup>\n\n                        {/* Brush - Bucket - Move */}\n                        <ToolsRow>\n                            {[\n                                { id: 'brush', icon: '', title: 'Brush (B)' },\n                                { id: 'bucket', icon: '', title: 'Fill Bucket (F)' },\n                                { id: 'move', icon: '', title: 'Move Selection (M)' }\n                            ].map(tool => (\n                                <ToolsEditorButton\n                                    key={tool.id}\n                                    onClick={() => !isPlayMode && setActiveTool(tool.id)}\n                                    $active={activeTool === tool.id && !isPlayMode}\n                                    $square\n                                    $disabled={isPlayMode}\n                                    title={isPlayMode ? \"Disabled in Play Mode\" : tool.title}\n                                >\n                                    {tool.icon}\n                                    {isPlayMode && <StrikeThrough />}\n                                </ToolsEditorButton>\n                            ))}\n                        </ToolsRow>\n\n                        {/* Cut - Copy - Paste */}\n                        <ToolsInnerGroup>\n                            {['cut', 'copy'].map(mode => {\n                                const isDisabled = isPlayMode || activeTool !== 'move';\n                                return (\n                                    <ToolsEditorButton\n                                        key={mode}\n                                        onClick={() => !isDisabled && setSelectionMode(mode)}\n                                        $active={selectionMode === mode && !isDisabled}\n                                        $square\n                                        $disabled={isDisabled}\n                                        title={isPlayMode ? \"Disabled in Play Mode\" : (isDisabled ? `${mode === 'cut' ? 'Cut' : 'Copy'} (Only for Move tool)` : `${mode === 'cut' ? 'Cut' : 'Copy'} Selection`)}\n                                    >\n                                        {mode === 'cut' ? '' : ''}\n                                        {isDisabled && <StrikeThrough />}\n                                    </ToolsEditorButton>\n                                );\n                            })}\n                            <ToolsEditorButton\n                                onClick={() => !isPlayMode && activeTool === 'move' && commitSelection()}\n                                $square\n                                $disabled={isPlayMode || activeTool !== 'move'}\n                                title={isPlayMode ? \"Disabled in Play Mode\" : (activeTool !== 'move' ? \"Paste (Only for Move tool)\" : \"Paste Selection\")}\n                            >\n                                \n                                {(isPlayMode || activeTool !== 'move') && <StrikeThrough />}\n                            </ToolsEditorButton>\n                            {selection && !isPlayMode && (\n                                <SelectionActions>\n                                    <ConfirmButton onClick={commitSelection} $square title=\"Confirm Selection (Enter)\"></ConfirmButton>\n                                    <CancelButton onClick={cancelSelection} $square title=\"Cancel Selection (Esc)\"></CancelButton>\n                                </SelectionActions>\n                            )}\n                        </ToolsInnerGroup>\n\n                        {/* Size */}\n                        <ToolsInnerGroup>\n                            {['I', 'II', 'III', 'IV', 'V'].map((roman, idx) => {\n                                const size = idx + 1;\n                                const isDisabled = isPlayMode || activeTool !== 'brush';\n                                return (\n                                    <ToolsEditorButton \n                                        key={size} \n                                        onClick={() => !isDisabled && setBrushSize(size)} \n                                        $active={brushSize === size && !isDisabled} \n                                        $square \n                                        $disabled={isDisabled}\n                                        title={isPlayMode ? \"Disabled in Play Mode\" : (isDisabled ? \"Brush size (Only for Brush tool)\" : `Brush Size ${size}`)}\n                                    >\n                                        {roman}\n                                        {isDisabled && <StrikeThrough />}\n                                    </ToolsEditorButton>\n                                );\n                            })}\n                        </ToolsInnerGroup>\n\n                        {/* Background Immage */}\n                        <ToolsRow>\n                            <ToolsEditorButton\n                                onClick={() => !isPlayMode && setShowBackgroundImage(!showBackgroundImage)}\n                                $active={showBackgroundImage && !isPlayMode}\n                                $square\n                                $disabled={isPlayMode}\n                                title={isPlayMode ? \"Disabled in Play Mode\" : (showBackgroundImage ? \"Hide Background Image\" : \"Show Background Image\")}\n                            >\n                                \n                                {isPlayMode && <StrikeThrough />}\n                            </ToolsEditorButton>\n\n                            {/* Grid */}\n                            <ToolsEditorButton\n                                onClick={() => setShowGrid(!showGrid)}\n                                $active={showGrid}\n                                $square\n                                title={showGrid ? \"Hide Grid Lines\" : \"Show Grid Lines\"}\n                            >\n                                <GridIcon>\n                                    {showGrid ? '' : ''}\n                                </GridIcon>\n                            </ToolsEditorButton>\n\n                            {/* Background Color Picker */}\n                            <BgColorContainer>\n                                <BgColorInputWrapper>\n                                    <BgColorInput\n                                        type=\"color\"\n                                        value={selectedBackgroundColor}\n                                        onChange={(e) => !isPlayMode && setSelectedBackgroundColor(e.target.value)}\n                                        title={isPlayMode ? \"Disabled in Play Mode\" : \"Background Color\"}\n                                        disabled={isPlayMode}\n                                    />\n                                    {isPlayMode && <StrikeThrough />}\n                                </BgColorInputWrapper>\n                            </BgColorContainer>\n                        </ToolsRow>\n\n\n\n                        {/* Active Layer Indicator */}\n                        <ToolsInnerGroup>\n                            <LayerIndicator {...getLayerIndicatorData()}>\n                                Layer: {activeLayer === 'tile' ? 'Blocks' : (activeLayer === 'object' ? 'Objects' : (activeLayer === 'secret' ? 'Sectors' : 'Properties'))}\n                            </LayerIndicator>\n                        </ToolsInnerGroup>\n\n                        {/* Layers: Block - Object - Sector - Props */}\n                        <ToolsInnerGroup>\n                            {['tile', 'object', 'secret', 'props'].map(layer => {\n                                const { isActive, bgColor, textColor } = getEraserData(layer);\n                                const isDisabled = isPlayMode;\n                                return (\n                                    <EraserButtonContainer\n                                        key={layer}\n                                        onClick={() => !isDisabled && handlePaletteSelect(null, layer)}\n                                        $active={isActive && !isDisabled}\n                                        $disabled={isDisabled}\n                                        title={isDisabled ? \"Disabled in Play Mode\" : `Erase ${layer === 'tile' ? 'Blocks' : (layer === 'object' ? 'Objects' : (layer === 'secret' ? 'Sectors' : 'Properties'))}`}\n                                    >\n                                        <EraserButtonInner $bgColor={bgColor} $textColor={textColor} $active={isActive && !isDisabled}>\n                                            {layer === 'tile' ? 'B' : (layer === 'object' ? 'O' : (layer === 'secret' ? 'S' : 'P'))}\n                                        </EraserButtonInner>\n                                        {isDisabled && <StrikeThrough />}\n                                    </EraserButtonContainer>\n                                );\n                            })}\n                        </ToolsInnerGroup>\n\n                        <ToolsInnerGroup>\n                            <ToolsRow>\n                                <PlayButtonContainer onClick={isPlayMode ? handlePause : handlePlay} title={isPlayMode ? \"Pause/Editor\" : \"Play Map\"}>\n                                    <PlayButtonInner $variant={isPlayMode ? 'pause' : 'play'}>\n                                        <span>{isPlayMode ? '' : ''}</span>\n                                    </PlayButtonInner>\n                                </PlayButtonContainer>\n\n                                <PlayButtonContainer onClick={handleReset} title=\"Reset State\">\n                                    <PlayButtonInner>\n                                        <span></span>\n                                    </PlayButtonInner>\n                                </PlayButtonContainer>\n                            </ToolsRow>\n                        </ToolsInnerGroup>\n                    </ToolsGroup>\n                </ToolsSection>\n\n\n                <ToolsSection>\n                    <InfoContainer>\n                        <InfoItem>\n                            <InfoLabel>Map:</InfoLabel>\n                            <InfoValue>{mapName}</InfoValue>\n                        </InfoItem>\n                        <InfoItem>\n                            <InfoLabel>By:</InfoLabel>\n                            <InfoValue>{creatorName}</InfoValue>\n                        </InfoItem>\n                    </InfoContainer>\n                </ToolsSection>\n            </HeaderBar>\n        </EditorToolsContainer>\n    );\n};\n","import { useState, useCallback, useMemo, useEffect, useRef } from 'react';\nimport { TILE_SIZE } from '../../../../constants/gameConstants';\nimport { useGameEngine } from '../../../../utilities/useGameEngine';\n\nconst EMPTY_ARRAY = [];\n\nexport const useEditorPlayMode = (\n    mapWidth, mapHeight, tileMapData, objectMapData, secretMapData, objectMetadata, \n    selectedBackgroundImage, selectedBackgroundColor, backgroundParallaxFactor, \n    registryItems, playerPosition, setPlayerPosition, setObjectMetadata,\n    weatherRain, weatherSnow, weatherClouds, weatherFog, weatherThunder,\n    weatherLavaRain, weatherRadioactiveFog, weatherMeteorRain,\n    maps, activeMapId, switchMap, spawnTriggerId,\n    setTileMapData\n) => {\n    const [isPlayMode, setIsPlayMode] = useState(false);\n    const [isGameOver, setIsGameOver] = useState(false);\n    const [restartCounter, setRestartCounter] = useState(0);\n    const [editorSnapshot, setEditorSnapshot] = useState(null);\n    const [revealedSecrets, setRevealedSecrets] = useState([]);\n    const [playModeObjectData, setPlayModeObjectData] = useState([]);\n    const [playModeSecretData, setPlayModeSecretData] = useState([]);\n    const [playModeWeather, setPlayModeWeather] = useState({\n        rain: 0, snow: 0, clouds: 0, fog: 0, thunder: 0,\n        lavaRain: 0, radioactiveFog: 0, meteorRain: 0\n    });\n    const [gameMessage, setGameMessage] = useState({ text: '', isVisible: false });\n    const messageTimerRef = useRef(null);\n    const lastSyncedMapIdRef = useRef(null);\n\n    // Stability for engine initialization - only changes when map changes or play mode is toggled\n    const engineInitId = useMemo(() => {\n        return isPlayMode ? `${activeMapId}_${restartCounter}_${Date.now()}` : null;\n    }, [isPlayMode, activeMapId, restartCounter]);\n\n    // Derived data to ensure useGameEngine gets fresh data even before useEffect syncs state.\n    // This prevents the engine from using old map data during initialization.\n    const currentPlayObjectData = useMemo(() => {\n        if (!isPlayMode) return EMPTY_ARRAY;\n        if (lastSyncedMapIdRef.current !== activeMapId) {\n            const playData = [...objectMapData];\n            let spawnIndex = playData.findIndex(id => id && id.includes('player'));\n            if (spawnIndex === -1 && (spawnTriggerId === null || spawnTriggerId === undefined)) {\n                const spawnX = Math.min(3, mapWidth - 1);\n                const spawnY = Math.min(3, mapHeight - 1);\n                spawnIndex = spawnY * mapWidth + spawnX;\n                playData[spawnIndex] = 'player';\n            }\n            return playData;\n        }\n        return playModeObjectData;\n    }, [isPlayMode, activeMapId, playModeObjectData, objectMapData, spawnTriggerId, mapWidth, mapHeight]);\n\n    const currentPlaySecretData = useMemo(() => {\n        if (!isPlayMode) return EMPTY_ARRAY;\n        if (lastSyncedMapIdRef.current !== activeMapId) return [...secretMapData];\n        return playModeSecretData;\n    }, [isPlayMode, activeMapId, playModeSecretData, secretMapData]);\n\n    const mapDataForGame = useMemo(() => ({\n        meta: {\n            width: mapWidth,\n            height: mapHeight,\n            tileSize: TILE_SIZE,\n            activeMapId: activeMapId,\n            spawnTriggerId: spawnTriggerId,\n            backgroundImage: selectedBackgroundImage,\n            backgroundColor: selectedBackgroundColor,\n            backgroundParallaxFactor: backgroundParallaxFactor,\n            objectMetadata: objectMetadata,\n            date_map_last_updated: engineInitId, \n            weather: {\n                rain: isPlayMode ? playModeWeather.rain : weatherRain,\n                lavaRain: isPlayMode ? playModeWeather.lavaRain : weatherLavaRain,\n                snow: isPlayMode ? playModeWeather.snow : weatherSnow,\n                meteorRain: isPlayMode ? playModeWeather.meteorRain : weatherMeteorRain,\n                clouds: isPlayMode ? playModeWeather.clouds : weatherClouds,\n                fog: isPlayMode ? playModeWeather.fog : weatherFog,\n                radioactiveFog: isPlayMode ? playModeWeather.radioactiveFog : weatherRadioactiveFog,\n                thunder: isPlayMode ? playModeWeather.thunder : weatherThunder\n            }\n        },\n        maps: maps, // Project maps for inter-map teleports\n        layers: [\n            { type: \"tile\", name: \"background\", data: tileMapData },\n            { type: \"object\", name: \"entities\", data: currentPlayObjectData }\n        ]\n    }), [\n        mapWidth, mapHeight, activeMapId, spawnTriggerId, selectedBackgroundImage, selectedBackgroundColor, \n        backgroundParallaxFactor, tileMapData, currentPlayObjectData, objectMetadata,\n        weatherRain, weatherSnow, weatherClouds, weatherFog, weatherThunder,\n        weatherLavaRain, weatherRadioactiveFog, weatherMeteorRain,\n        playModeWeather,\n        isPlayMode, maps, engineInitId\n    ]);\n\n    // Synchronize play mode state when map changes (e.g., during inter-map teleport)\n    useEffect(() => {\n        if (isPlayMode && lastSyncedMapIdRef.current !== activeMapId) {\n            const playData = [...objectMapData];\n            \n            let spawnIndex = playData.findIndex(id => id && id.includes('player'));\n            if (spawnIndex === -1 && (spawnTriggerId === null || spawnTriggerId === undefined)) {\n                const spawnX = Math.min(3, mapWidth - 1);\n                const spawnY = Math.min(3, mapHeight - 1);\n                spawnIndex = spawnY * mapWidth + spawnX;\n                playData[spawnIndex] = 'player';\n            }\n\n            setPlayModeObjectData(playData);\n            setPlayModeSecretData([...secretMapData]);\n            setRevealedSecrets([]);\n            lastSyncedMapIdRef.current = activeMapId;\n        }\n    }, [activeMapId, isPlayMode, objectMapData, secretMapData, mapWidth, mapHeight, spawnTriggerId]);\n\n    const handleGameOver = useCallback(() => {\n        setIsGameOver(true);\n    }, []);\n\n    const handleReplay = useCallback(() => {\n        setIsGameOver(false);\n        setRestartCounter(prev => prev + 1);\n        setRevealedSecrets([]);\n        if (editorSnapshot) {\n            setPlayModeObjectData([...editorSnapshot.objectMapData]);\n            setPlayModeSecretData([...editorSnapshot.secretMapData]);\n            setObjectMetadata({ ...editorSnapshot.objectMetadata });\n        }\n    }, [editorSnapshot, setObjectMetadata]);\n\n    const handleStateUpdate = useCallback((newState, payload) => {\n        if (newState && typeof newState === 'object' && newState.x !== undefined && newState.y !== undefined) {\n            setPlayerPosition({ x: newState.x, y: newState.y });\n        } else if (newState === 'collectItem' && payload !== undefined) {\n            setPlayModeObjectData(prev => {\n                const newData = [...prev];\n                newData[payload] = null;\n                return newData;\n            });\n        } else if (newState === 'switchMap' && payload !== undefined) {\n            const { targetMapId, triggerId } = payload;\n            if (switchMap && targetMapId) {\n                // We keep play mode active when switching maps via teleport\n                switchMap(targetMapId, triggerId);\n                // Note: triggerId will be picked up from the next activeMap's meta.spawnTriggerId\n                // because switchMap updates the map data in Editor.jsx which then propagates back here.\n            }\n        } else if (newState === 'objectDamage' && payload !== undefined) {\n            const { index, damage } = payload;\n            const objId = playModeObjectData[index];\n            const def = registryItems.find(r => r.id === objId);\n            if (!def) return;\n\n            setObjectMetadata(prev => {\n                const current = prev[index] || {};\n                const maxH = def.maxHealth || 100;\n                const newHealth = Math.max(0, (current.health !== undefined ? current.health : maxH) - damage);\n                \n                if (def.type === 'crack_block' && newHealth <= (def.passableHealthThreshold || 0)) {\n                    if (setTileMapData) {\n                        setTileMapData(prevTiles => {\n                            const newTiles = [...prevTiles];\n                            newTiles[index] = null;\n                            return newTiles;\n                        });\n                    }\n                }\n\n                return {\n                    ...prev,\n                    [index]: { ...current, health: newHealth }\n                };\n            });\n        } else if (newState === 'shiftTile' && payload !== undefined) {\n            const { index, dx, dy } = payload;\n            \n            // Wolfenstein-style slow move: 1 block at a time\n            let currentIdx = index;\n            let remainingDx = dx;\n            let remainingDy = dy;\n            \n            const moveStep = () => {\n                if (remainingDx === 0 && remainingDy === 0) {\n                    // Final removal of the trigger\n                    setPlayModeObjectData(prevObjs => {\n                        const newObjs = [...prevObjs];\n                        newObjs[currentIdx] = null;\n                        return newObjs;\n                    });\n                    return;\n                }\n                \n                const stepX = remainingDx > 0 ? 1 : (remainingDx < 0 ? -1 : 0);\n                const stepY = remainingDy > 0 ? 1 : (remainingDy < 0 ? -1 : 0);\n                \n                const tx = (currentIdx % mapWidth) + stepX;\n                const ty = Math.floor(currentIdx / mapWidth) + stepY;\n                \n                if (tx >= 0 && tx < mapWidth && ty >= 0 && ty < mapHeight) {\n                    const targetIndex = ty * mapWidth + tx;\n                    \n                    // Chain reaction logic\n                    const isLastStepOfBatch = (Math.abs(remainingDx) === 1 && remainingDy === 0) || (Math.abs(remainingDy) === 1 && remainingDx === 0);\n                    if (isLastStepOfBatch) {\n                        const targetObjId = playModeObjectData[targetIndex];\n                        const targetDef = registryItems.find(r => r.id === targetObjId);\n                        if (targetDef && targetDef.type === 'wolf_secret') {\n                            const extraX = Math.abs(targetDef.moveX || 3);\n                            const extraY = Math.abs(targetDef.moveY || 3);\n                            if (remainingDx !== 0) remainingDx += (remainingDx > 0 ? extraX : -extraX);\n                            if (remainingDy !== 0) remainingDy += (remainingDy > 0 ? extraY : -extraY);\n                        }\n                    }\n\n                    if (setTileMapData) {\n                        setTileMapData(prevTiles => {\n                            const newTiles = [...prevTiles];\n                            newTiles[targetIndex] = newTiles[currentIdx];\n                            newTiles[currentIdx] = null;\n                            return newTiles;\n                        });\n                    }\n                    \n                    setPlayModeObjectData(prevObjs => {\n                        const newObjs = [...prevObjs];\n                        newObjs[targetIndex] = newObjs[currentIdx];\n                        newObjs[currentIdx] = null;\n                        return newObjs;\n                    });\n                    \n                    setObjectMetadata(prevMeta => {\n                        const newMeta = { ...prevMeta };\n                        if (newMeta[currentIdx]) {\n                            newMeta[targetIndex] = newMeta[currentIdx];\n                            delete newMeta[currentIdx];\n                        }\n                        return newMeta;\n                    });\n                    \n                    currentIdx = targetIndex;\n                    remainingDx -= stepX;\n                    remainingDy -= stepY;\n                    \n                    if (remainingDx !== 0 || remainingDy !== 0) {\n                        setTimeout(moveStep, 250); // 250ms delay\n                    } else {\n                        // All steps finished, remove trigger\n                        setPlayModeObjectData(prevObjs => {\n                            const newObjs = [...prevObjs];\n                            newObjs[currentIdx] = null;\n                            return newObjs;\n                        });\n                    }\n                } else {\n                    // World bounds reached, remove trigger\n                    setPlayModeObjectData(prevObjs => {\n                        const newObjs = [...prevObjs];\n                        newObjs[currentIdx] = null;\n                        return newObjs;\n                    });\n                }\n            };\n            \n            moveStep();\n        } else if (newState === 'updateWeather' && payload) {\n            const { type, value } = payload;\n            setPlayModeWeather(prev => ({\n                ...prev,\n                [type]: value\n            }));\n            \n            // Dispatch event for any UI components that might be listening\n            const settingKey = 'weather' + type.charAt(0).toUpperCase() + type.slice(1);\n            window.dispatchEvent(new CustomEvent('game-settings-update', { \n                detail: { [settingKey]: value } \n            }));\n        } else if (newState === 'showMessage' && payload) {\n            const { text, duration } = payload;\n            \n            if (messageTimerRef.current) {\n                clearTimeout(messageTimerRef.current);\n            }\n            \n            setGameMessage({ text, isVisible: true });\n            \n            messageTimerRef.current = setTimeout(() => {\n                setGameMessage(prev => ({ ...prev, isVisible: false }));\n                messageTimerRef.current = null;\n            }, duration || 8000);\n        } else if (newState === 'weatherEffectHit' && payload) {\n            const { type, data } = payload;\n            window.dispatchEvent(new CustomEvent('weather-effect-hit', { detail: { type, data } }));\n        }\n    }, [playModeObjectData, registryItems, setPlayerPosition, setObjectMetadata, switchMap]);\n\n    const handleRevealSecret = useCallback((secretIndex) => {\n        setRevealedSecrets(prev => [...prev, secretIndex]);\n    }, []);\n\n    const gameEngineState = useGameEngine(\n        isPlayMode ? mapDataForGame : null,\n        isPlayMode ? tileMapData : EMPTY_ARRAY,\n        isPlayMode ? currentPlayObjectData : EMPTY_ARRAY,\n        isPlayMode ? currentPlaySecretData : EMPTY_ARRAY,\n        revealedSecrets,\n        registryItems,\n        handleGameOver,\n        handleStateUpdate,\n        handleRevealSecret,\n        objectMetadata\n    );\n\n    const handlePlay = () => {\n        setEditorSnapshot({\n            tileMapData: [...tileMapData],\n            objectMapData: [...objectMapData],\n            secretMapData: [...secretMapData],\n            objectMetadata: { ...objectMetadata },\n            playerPosition: { ...playerPosition }\n        });\n\n        const playData = [...objectMapData];\n        let spawnIndex = playData.findIndex(id => id && id.includes('player'));\n        if (spawnIndex === -1) {\n            const spawnX = Math.min(3, mapWidth - 1);\n            const spawnY = Math.min(3, mapHeight - 1);\n            spawnIndex = spawnY * mapWidth + spawnX;\n            playData[spawnIndex] = 'player';\n        }\n\n        setPlayModeObjectData(playData);\n        setPlayModeSecretData([...secretMapData]);\n        setPlayModeWeather({\n            rain: weatherRain,\n            snow: weatherSnow,\n            clouds: weatherClouds,\n            fog: weatherFog,\n            thunder: weatherThunder,\n            lavaRain: weatherLavaRain,\n            radioactiveFog: weatherRadioactiveFog,\n            meteorRain: weatherMeteorRain\n        });\n        setRevealedSecrets([]);\n        lastSyncedMapIdRef.current = activeMapId;\n        setIsPlayMode(true);\n        setIsGameOver(false); // Reset game over when starting play mode\n    };\n\n    const handlePause = () => {\n        setIsPlayMode(false);\n        setIsGameOver(false); // Reset game over when exiting play mode\n    };\n\n    const handleReset = () => {\n        if (editorSnapshot) {\n            if (setTileMapData) {\n                setTileMapData([...editorSnapshot.tileMapData]);\n            }\n\n            const resetData = [...editorSnapshot.objectMapData];\n            let spawnIndex = resetData.findIndex(id => id && id.includes('player'));\n            if (spawnIndex === -1) {\n                const spawnX = Math.min(3, mapWidth - 1);\n                const spawnY = Math.min(3, mapHeight - 1);\n                spawnIndex = spawnY * mapWidth + spawnX;\n                resetData[spawnIndex] = 'player';\n            }\n\n            setPlayModeObjectData(resetData);\n            setPlayModeSecretData([...editorSnapshot.secretMapData]);\n            setObjectMetadata({ ...editorSnapshot.objectMetadata });\n            setRevealedSecrets([]);\n            lastSyncedMapIdRef.current = activeMapId;\n        }\n    };\n\n    return {\n        isPlayMode,\n        setIsPlayMode,\n        isGameOver,\n        handlePlay,\n        handlePause,\n        handleReset,\n        handleReplay,\n        handleStateUpdate,\n        playModeObjectData: currentPlayObjectData,\n        playModeSecretData: currentPlaySecretData,\n        playModeWeather,\n        gameMessage,\n        revealedSecrets,\n        gameEngineState\n    };\n};\n","import { useCallback } from 'react';\nimport { saveMap, loadMap, loadBuiltInMap, clearMap } from '../editorTools/mapOperations';\n\nexport const useEditorOperations = (\n    mapWidth, mapHeight, tileMapData, objectMapData, secretMapData, objectMetadata,\n    mapName, creatorName, mapDescription, createdAt,\n    selectedBackgroundImage, selectedBackgroundColor,\n    backgroundParallaxFactor, selectedBackgroundMusic, playerPosition,\n    registryItems, setCreatedAt,\n    setMapWidth, setMapHeight, setMapName, setCreatorName, setMapDescription,\n    setSelectedBackgroundImage, setSelectedBackgroundColor,\n    setBackgroundParallaxFactor, setSelectedBackgroundMusic, setPlayerPosition,\n    setTileMapData, setObjectMapData, setSecretMapData, setObjectMetadata,\n    setIsNewMapModalOpen, setTempMapName, setTempCreatorName, setTempMapDescription,\n    weatherRain, weatherSnow, weatherClouds, weatherFog, weatherThunder,\n    weatherLavaRain, weatherRadioactiveFog, weatherMeteorRain,\n    setWeatherRain, setWeatherSnow, setWeatherClouds, setWeatherFog, setWeatherThunder,\n    setWeatherLavaRain, setWeatherRadioactiveFog, setWeatherMeteorRain,\n    // Multi-map props\n    maps, setMaps, activeMapId, setActiveMapId\n) => {\n    const handleSaveMap = useCallback(() => {\n        // Construct the updated maps object with current active map data\n        // to ensure latest changes are saved even if debounce hasn't run\n        const currentMapData = {\n            ...maps[activeMapId],\n            mapWidth, mapHeight, tileMapData, objectMapData, secretMapData, objectMetadata,\n            name: mapName,\n            description: mapDescription,\n            selectedBackgroundImage, selectedBackgroundColor,\n            backgroundParallaxFactor, selectedBackgroundMusic,\n            weather: {\n                rain: weatherRain,\n                snow: weatherSnow,\n                clouds: weatherClouds,\n                fog: weatherFog,\n                thunder: weatherThunder,\n                lavaRain: weatherLavaRain,\n                radioactiveFog: weatherRadioactiveFog,\n                meteorRain: weatherMeteorRain\n            },\n            playerPosition\n        };\n\n        const updatedMaps = {\n            ...maps,\n            [activeMapId]: currentMapData\n        };\n\n        saveMap({\n            maps: updatedMaps, \n            activeMapId,\n            mapName, creatorName, mapDescription, createdAt,\n            registryItems, setCreatedAt\n        });\n    }, [\n        maps, activeMapId, mapWidth, mapHeight, tileMapData, objectMapData, secretMapData, objectMetadata,\n        mapName, creatorName, mapDescription, createdAt, selectedBackgroundImage, selectedBackgroundColor,\n        backgroundParallaxFactor, selectedBackgroundMusic, playerPosition, registryItems, setCreatedAt,\n        weatherRain, weatherSnow, weatherClouds, weatherFog, weatherThunder,\n        weatherLavaRain, weatherRadioactiveFog, weatherMeteorRain\n    ]);\n\n    const handleLoadMap = useCallback((event) => {\n        loadMap({\n            event, setMapWidth, setMapHeight, setMapName, setCreatorName, setMapDescription,\n            setCreatedAt, setSelectedBackgroundImage, setSelectedBackgroundColor,\n            setBackgroundParallaxFactor, setSelectedBackgroundMusic, setPlayerPosition,\n            setTileMapData, setObjectMapData, setSecretMapData, setObjectMetadata,\n            setWeatherRain, setWeatherSnow, setWeatherClouds, setWeatherFog, setWeatherThunder,\n            setWeatherLavaRain, setWeatherRadioactiveFog, setWeatherMeteorRain,\n            setMaps, setActiveMapId\n        });\n    }, [\n        setMapWidth, setMapHeight, setMapName, setCreatorName, setMapDescription,\n        setCreatedAt, setSelectedBackgroundImage, setSelectedBackgroundColor,\n        setBackgroundParallaxFactor, setSelectedBackgroundMusic, setPlayerPosition,\n        setTileMapData, setObjectMapData, setSecretMapData, setObjectMetadata,\n        setWeatherRain, setWeatherSnow, setWeatherClouds, setWeatherFog, setWeatherThunder,\n        setWeatherLavaRain, setWeatherRadioactiveFog, setWeatherMeteorRain,\n        setMaps, setActiveMapId\n    ]);\n\n    const handleLoadBuiltInMap = useCallback((mapData) => {\n        loadBuiltInMap({\n            mapData, setMapWidth, setMapHeight, setMapName, setCreatorName, setMapDescription,\n            setCreatedAt, setSelectedBackgroundImage, setSelectedBackgroundColor,\n            setBackgroundParallaxFactor, setSelectedBackgroundMusic, setPlayerPosition,\n            setTileMapData, setObjectMapData, setSecretMapData, setObjectMetadata,\n            setWeatherRain, setWeatherSnow, setWeatherClouds, setWeatherFog, setWeatherThunder,\n            setWeatherLavaRain, setWeatherRadioactiveFog, setWeatherMeteorRain,\n            setMaps, setActiveMapId\n        });\n    }, [\n        setMapWidth, setMapHeight, setMapName, setCreatorName, setMapDescription,\n        setCreatedAt, setSelectedBackgroundImage, setSelectedBackgroundColor,\n        setBackgroundParallaxFactor, setSelectedBackgroundMusic, setPlayerPosition,\n        setTileMapData, setObjectMapData, setSecretMapData, setObjectMetadata,\n        setWeatherRain, setWeatherSnow, setWeatherClouds, setWeatherFog, setWeatherThunder,\n        setWeatherLavaRain, setWeatherRadioactiveFog, setWeatherMeteorRain,\n        setMaps, setActiveMapId\n    ]);\n\n    const handleClearMap = useCallback(() => {\n        clearMap({ \n            mapWidth, mapHeight, setTileMapData, setObjectMapData, setSecretMapData, setObjectMetadata \n        });\n    }, [mapWidth, mapHeight, setTileMapData, setObjectMapData, setSecretMapData, setObjectMetadata]);\n\n    const openNewMapModal = () => {\n        setTempMapName(mapName);\n        setTempCreatorName(creatorName);\n        setTempMapDescription(mapDescription);\n        setIsNewMapModalOpen(true);\n    };\n\n    const confirmNewMap = (tempMapName, tempCreatorName, tempMapDescription) => {\n        setMapName(tempMapName || \"New Map\");\n        setCreatorName(tempCreatorName || \"Anonymous\");\n        setMapDescription(tempMapDescription || \"\");\n        setCreatedAt(new Date().toISOString());\n        \n        const size = mapWidth * mapHeight;\n        setTileMapData(Array(size).fill(null));\n        setObjectMapData(Array(size).fill(null));\n        setSecretMapData(Array(size).fill(null));\n        setObjectMetadata({});\n        \n        setIsNewMapModalOpen(false);\n    };\n\n    return {\n        handleSaveMap,\n        handleLoadMap,\n        handleLoadBuiltInMap,\n        handleClearMap,\n        openNewMapModal,\n        confirmNewMap\n    };\n};\n","export const getFloodFillIndices = (startIndex, currentData, mapWidth, mapHeight) => {\n    const startId = currentData[startIndex];\n    const width = mapWidth;\n    const height = mapHeight;\n    const stack = [startIndex];\n    const visited = new Set();\n    const matchingIndices = new Set();\n\n    while (stack.length > 0) {\n        const idx = stack.pop();\n        if (visited.has(idx)) continue;\n        visited.add(idx);\n        if (idx < 0 || idx >= currentData.length) continue;\n        if (currentData[idx] !== startId) continue;\n        matchingIndices.add(idx);\n\n        const x = idx % width;\n        const y = Math.floor(idx / width);\n        if (x > 0) stack.push(idx - 1);\n        if (x < width - 1) stack.push(idx + 1);\n        if (y > 0) stack.push(idx - width);\n        if (y < height - 1) stack.push(idx + width);\n    }\n    return matchingIndices;\n};\n\nexport const floodFill = (startIndex, targetId, currentData, mapWidth, mapHeight) => {\n    const startId = currentData[startIndex];\n    if (startId === targetId) return currentData;\n\n    const indices = getFloodFillIndices(startIndex, currentData, mapWidth, mapHeight);\n    const newData = [...currentData];\n    indices.forEach(idx => newData[idx] = targetId);\n    return newData;\n};\n\nexport const paintTile = ({\n    index, brushSize, activeLayer, selectedTile,\n    mapWidth, mapHeight, tileMapData, objectMapData, secretMapData, objectMetadata,\n    setTileMapData, setObjectMapData, setSecretMapData, setObjectMetadata\n}) => {\n    const isPropsLayer = activeLayer === 'props';\n    const targetLayer = isPropsLayer ? 'object' : activeLayer;\n\n    const targetData = targetLayer === 'tile' ? tileMapData : (targetLayer === 'object' ? objectMapData : secretMapData);\n    const setTargetData = targetLayer === 'tile' ? setTileMapData : (targetLayer === 'object' ? setObjectMapData : setSecretMapData);\n    \n    const newData = [...targetData];\n    let newMetadata = objectMetadata ? { ...objectMetadata } : null;\n    let metadataChanged = false;\n\n    const x = index % mapWidth;\n    const y = Math.floor(index / mapWidth);\n\n    for (let dy = 0; dy < brushSize; dy++) {\n        for (let dx = 0; dx < brushSize; dx++) {\n            const targetX = x + dx;\n            const targetY = y + dy;\n            if (targetX < mapWidth && targetY < mapHeight) {\n                const targetIndex = targetY * mapWidth + targetX;\n                \n                if (isPropsLayer) {\n                    // In props layer, we erase metadata and the object itself\n                    newData[targetIndex] = null;\n                    if (newMetadata && newMetadata[targetIndex]) {\n                        delete newMetadata[targetIndex];\n                        metadataChanged = true;\n                    }\n                } else {\n                    newData[targetIndex] = selectedTile ? selectedTile.id : null;\n                    // If we are painting/erasing in object layer, we should also handle metadata\n                    if (targetLayer === 'object' && selectedTile === null) {\n                        if (newMetadata && newMetadata[targetIndex]) {\n                            delete newMetadata[targetIndex];\n                            metadataChanged = true;\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    setTargetData(newData);\n    if (metadataChanged && setObjectMetadata) {\n        setObjectMetadata(newMetadata);\n    }\n};\n","import { useState, useRef, useEffect, useCallback } from 'react';\nimport { getFloodFillIndices, floodFill, paintTile as paintTileUtil } from '../editorTools/paintingTools';\n\nexport const useEditorPainting = (\n    mapWidth, mapHeight, tileMapData, objectMapData, secretMapData, \n    setTileMapData, setObjectMapData, setSecretMapData,\n    activeTool, brushSize, activeLayer, selectedTile, selection, \n    setSelection, setPreviewPosition, setOriginalMapData, dragStart, setDragStart, isDragging, setIsDragging,\n    setActivePanel, setHighlightedIndex, highlightedIndex, registryItems,\n    objectMetadata, setObjectMetadata\n) => {\n    const [hoverIndex, setHoverIndex] = useState(null);\n    const [bucketPreviewIndices, setBucketPreviewIndices] = useState(new Set());\n    const [resizeState, setResizeState] = useState(null); // { index, edge, startX, startY, startW, startH }\n    const [moveState, setMoveState] = useState(null); // { index, startX, startY, objId, secretId, meta }\n    const bucketTimerRef = useRef(null);\n\n    const paintTile = useCallback((index) => {\n        paintTileUtil({\n            index,\n            activeTool,\n            brushSize,\n            activeLayer,\n            selectedTile,\n            mapWidth,\n            mapHeight,\n            tileMapData,\n            objectMapData,\n            secretMapData,\n            objectMetadata,\n            setTileMapData,\n            setObjectMapData,\n            setSecretMapData,\n            setObjectMetadata\n        });\n    }, [activeTool, brushSize, activeLayer, selectedTile, mapWidth, mapHeight, tileMapData, objectMapData, secretMapData, objectMetadata, setTileMapData, setObjectMapData, setSecretMapData, setObjectMetadata]);\n\n    const handleResizeStart = useCallback((index, edge) => {\n        const meta = objectMetadata[index] || {};\n        const x = index % mapWidth;\n        const y = Math.floor(index / mapWidth);\n        setResizeState({\n            index,\n            edge,\n            startX: x,\n            startY: y,\n            startW: meta.width || 1,\n            startH: meta.height || 1\n        });\n        setIsDragging(true);\n    }, [objectMetadata, mapWidth, setIsDragging]);\n\n    const handleMoveStart = useCallback((index) => {\n        const x = index % mapWidth;\n        const y = Math.floor(index / mapWidth);\n        setMoveState({\n            index,\n            startX: x,\n            startY: y,\n            objId: objectMapData[index],\n            secretId: secretMapData[index],\n            meta: objectMetadata[index] ? { ...objectMetadata[index] } : null\n        });\n        setIsDragging(true);\n        setHighlightedIndex(index);\n    }, [objectMapData, secretMapData, objectMetadata, mapWidth, setIsDragging, setHighlightedIndex]);\n\n    const handleGridMouseDown = useCallback((index, e) => {\n        // Quick select for configurable objects\n        const existingObjId = objectMapData[index];\n        const existingSecretId = secretMapData[index];\n        const isEraser = selectedTile === null && activeTool === 'brush';\n\n        if (!isEraser && (existingObjId || existingSecretId) && setActivePanel && setHighlightedIndex) {\n            const def = registryItems?.find(r => r.id === (existingObjId || existingSecretId));\n            const isConfigurable = (existingObjId && (existingObjId.includes('portal') || \n                                 existingObjId.includes('target') || \n                                 existingObjId === 'portal_target' || \n                                 (def && def.type === 'weather_trigger') ||\n                                 (def && def.type === 'message_trigger'))) || existingSecretId;\n            \n            if (isConfigurable) {\n                setActivePanel('props');\n                setHighlightedIndex(index);\n            }\n        }\n\n        if (activeTool === 'brush') {\n            setIsDragging(true);\n            paintTile(index);\n        } else if (activeTool === 'bucket') {\n            const isPropsLayer = activeLayer === 'props';\n            const targetLayer = isPropsLayer ? 'object' : activeLayer;\n            const targetData = targetLayer === 'tile' ? tileMapData : (targetLayer === 'object' ? objectMapData : secretMapData);\n            const targetValue = targetData[index];\n            const newValue = selectedTile ? selectedTile.id : null;\n            if (targetValue === newValue) return;\n\n            const newData = floodFill(index, newValue, targetData, mapWidth, mapHeight);\n            \n            if (targetLayer === 'tile') setTileMapData(newData);\n            else if (targetLayer === 'object') {\n                setObjectMapData(newData);\n                // Clean up metadata for all affected indices if erasing\n                if (newValue === null && objectMetadata && setObjectMetadata) {\n                    const affectedIndices = getFloodFillIndices(index, targetData, mapWidth, mapHeight);\n                    let metaChanged = false;\n                    const newMeta = { ...objectMetadata };\n                    affectedIndices.forEach(idx => {\n                        if (newMeta[idx]) {\n                            delete newMeta[idx];\n                            metaChanged = true;\n                        }\n                    });\n                    if (metaChanged) setObjectMetadata(newMeta);\n                }\n            }\n            else setSecretMapData(newData);\n        } else if (activeTool === 'move') {\n            if (selection) return;\n\n            // If we clicked on an object/secret, start moving it\n            if (existingObjId || existingSecretId) {\n                handleMoveStart(index);\n            } else {\n                const x = index % mapWidth;\n                const y = Math.floor(index / mapWidth);\n                setDragStart({ x, y });\n                setIsDragging(true);\n            }\n        }\n    }, [objectMapData, secretMapData, setActivePanel, setHighlightedIndex, registryItems, activeTool, setIsDragging, paintTile, activeLayer, tileMapData, selectedTile, mapWidth, mapHeight, setTileMapData, setObjectMapData, setSecretMapData, objectMetadata, setObjectMetadata, selection, handleMoveStart, setDragStart]);\n\n    const handleGridMouseMove = useCallback((index) => {\n        setHoverIndex(index);\n        const curX = index % mapWidth;\n        const curY = Math.floor(index / mapWidth);\n\n        if (resizeState) {\n            const dx = curX - resizeState.startX;\n            const dy = curY - resizeState.startY;\n            let newW = resizeState.startW;\n            let newH = resizeState.startH;\n            let newIndex = resizeState.index;\n\n            if (resizeState.edge === 'right') newW = Math.max(1, resizeState.startW + dx);\n            if (resizeState.edge === 'bottom') newH = Math.max(1, resizeState.startH + dy);\n            \n            if (resizeState.edge === 'left') {\n                const shift = Math.min(resizeState.startW - 1, dx);\n                newW = resizeState.startW - shift;\n                newIndex = resizeState.startY * mapWidth + (resizeState.startX + shift);\n            }\n            if (resizeState.edge === 'top') {\n                const shift = Math.min(resizeState.startH - 1, dy);\n                newH = resizeState.startH - shift;\n                newIndex = (resizeState.startY + shift) * mapWidth + resizeState.startX;\n            }\n\n            if (newW !== (objectMetadata[resizeState.index]?.width || 1) || \n                newH !== (objectMetadata[resizeState.index]?.height || 1) ||\n                newIndex !== resizeState.index) {\n                \n                const meta = { ...objectMetadata[resizeState.index] };\n                meta.width = newW;\n                meta.height = newH;\n                \n                setObjectMetadata(prev => {\n                    const next = { ...prev };\n                    delete next[resizeState.index];\n                    next[newIndex] = meta;\n                    return next;\n                });\n\n                if (newIndex !== resizeState.index) {\n                    const objId = objectMapData[resizeState.index];\n                    const secretId = secretMapData[resizeState.index];\n                    setObjectMapData(prev => {\n                        const next = [...prev];\n                        next[resizeState.index] = null;\n                        next[newIndex] = objId;\n                        return next;\n                    });\n                    setSecretMapData(prev => {\n                        const next = [...prev];\n                        next[resizeState.index] = null;\n                        next[newIndex] = secretId;\n                        return next;\n                    });\n                    setResizeState(prev => ({ ...prev, index: newIndex, startX: newIndex % mapWidth, startY: Math.floor(newIndex / mapWidth), startW: newW, startH: newH }));\n                    setHighlightedIndex(newIndex);\n                }\n            }\n        } else if (moveState) {\n            if (index === moveState.index) return;\n            \n            // Perform move\n            setObjectMapData(prev => {\n                const next = [...prev];\n                next[moveState.index] = null;\n                next[index] = moveState.objId;\n                return next;\n            });\n            setSecretMapData(prev => {\n                const next = [...prev];\n                next[moveState.index] = null;\n                next[index] = moveState.secretId;\n                return next;\n            });\n            setObjectMetadata(prev => {\n                const next = { ...prev };\n                delete next[moveState.index];\n                if (moveState.meta) next[index] = moveState.meta;\n                return next;\n            });\n            setMoveState(prev => ({ ...prev, index, startX: curX, startY: curY }));\n            setHighlightedIndex(index);\n\n        } else if (activeTool === 'brush' && isDragging) {\n            paintTile(index);\n        } else if (activeTool === 'bucket') {\n            if (bucketTimerRef.current) clearTimeout(bucketTimerRef.current);\n            bucketTimerRef.current = setTimeout(() => {\n                const targetLayer = activeLayer === 'props' ? 'object' : activeLayer;\n                const targetData = targetLayer === 'tile' ? tileMapData : (targetLayer === 'object' ? objectMapData : secretMapData);\n                const indices = getFloodFillIndices(index, targetData, mapWidth, mapHeight);\n                setBucketPreviewIndices(indices);\n            }, 10);\n        }\n    }, [setHoverIndex, activeTool, isDragging, paintTile, activeLayer, tileMapData, objectMapData, secretMapData, mapWidth, mapHeight, setBucketPreviewIndices, resizeState, moveState, objectMetadata, setObjectMetadata, setObjectMapData, setSecretMapData, setHighlightedIndex]);\n\n    const handleGridMouseUp = useCallback((index) => {\n        if (activeTool === 'move' && isDragging && !resizeState && !moveState && dragStart && index !== null) {\n            const hx = index % mapWidth;\n            const hy = Math.floor(index / mapWidth);\n            const x1 = Math.min(dragStart.x, hx);\n            const y1 = Math.min(dragStart.y, hy);\n            const x2 = Math.max(dragStart.x, hx);\n            const y2 = Math.max(dragStart.y, hy);\n            const w = x2 - x1 + 1;\n            const h = y2 - y1 + 1;\n\n            const tileData = [];\n            const objectData = [];\n            const secretData = [];\n            const selectionMetadata = {};\n\n            for (let y = y1; y <= y2; y++) {\n                for (let x = x1; x <= x2; x++) {\n                    const idx = y * mapWidth + x;\n                    tileData.push(tileMapData[idx]);\n                    objectData.push(objectMapData[idx]);\n                    secretData.push(secretMapData[idx]);\n                    if (objectMetadata[idx]) {\n                        selectionMetadata[`${x - x1},${y - y1}`] = { ...objectMetadata[idx] };\n                    }\n                }\n            }\n\n            setSelection({\n                x: x1, y: y1, w, h,\n                originalX: x1, originalY: y1,\n                tileData, objectData, secretData,\n                metadata: selectionMetadata\n            });\n            setPreviewPosition({ x: x1, y: y1 });\n            setOriginalMapData({\n                tileMap: [...tileMapData],\n                objectMap: [...objectMapData],\n                secretMap: [...secretMapData],\n                objectMetadata: { ...objectMetadata }\n            });\n            setDragStart(null);\n        }\n\n        setIsDragging(false);\n        setResizeState(null);\n        setMoveState(null);\n    }, [activeTool, isDragging, resizeState, moveState, dragStart, mapWidth, tileMapData, objectMapData, secretMapData, setSelection, setPreviewPosition, setOriginalMapData, setDragStart, setIsDragging]);\n\n    return {\n        hoverIndex,\n        setHoverIndex,\n        bucketPreviewIndices,\n        setBucketPreviewIndices,\n        handleGridMouseDown,\n        handleGridMouseMove,\n        handleGridMouseUp,\n        handleResizeStart,\n        handleMoveStart,\n        paintTile\n    };\n};\n","import React, { useState, useEffect, useRef, useMemo, useCallback } from 'react';\nimport { getRegistry } from '../../../engine/registry';\nimport { TILE_SIZE } from '../../../constants/gameConstants';\nimport { resizeMapData } from './editorTools/mapOperations';\nimport { loadBackgroundOptions, loadMusicOptions } from './assetLoaders';\nimport { Viewport } from './Viewport';\nimport { NewMapModal } from './editorTools/NewMapModal';\nimport { BuiltInMapsModal } from './editorTools/BuiltInMapsModal';\nimport { EditorScene } from './EditorScene';\nimport { EditorElements } from './EditorElements';\nimport { EditorTools } from './EditorTools';\nimport PixiStage from '../game/PixiStage';\nimport styled from 'styled-components';\n\n// Custom Hooks\nimport { useEditorRegistry } from './hooks/useEditorRegistry';\nimport { useEditorSelection } from './hooks/useEditorSelection';\nimport { useEditorPlayMode } from './hooks/useEditorPlayMode';\nimport { useEditorOperations } from './hooks/useEditorOperations';\nimport { useEditorPainting } from './hooks/useEditorPainting';\nimport { useEditorMaps } from './hooks/useEditorMaps';\n\nconst EMPTY_ARRAY = [];\nconst EMPTY_OBJECT = {};\n\nconst MessageOverlay = styled.div`\n    position: absolute;\n    top: 40%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    width: 80%;\n    text-align: center;\n    pointer-events: none;\n    z-index: 1500;\n    \n    h2 {\n        font-size: 48px;\n        color: white;\n        text-shadow: 0 0 10px rgba(0,0,0,0.8), 0 0 20px rgba(0,0,0,0.5);\n        margin: 0;\n        padding: 20px;\n        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n        font-weight: 800;\n        letter-spacing: 2px;\n        opacity: ${props => props.$isVisible ? 1 : 0};\n        transition: opacity 2s ease-in-out;\n    }\n`;\n\nconst GameOverOverlay = styled.div`\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background-color: rgba(0, 0, 0, 0.8);\n    z-index: 2500;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    color: white;\n    backdrop-filter: blur(4px);\n    animation: fadeIn 0.5s ease-out;\n\n    @keyframes fadeIn {\n        from { opacity: 0; }\n        to { opacity: 1; }\n    }\n`;\n\nconst GameOverTitle = styled.h1`\n    font-size: 72px;\n    margin: 0 0 30px 0;\n    text-transform: uppercase;\n    letter-spacing: 5px;\n    color: #ff4444;\n    text-shadow: 0 0 20px rgba(255, 0, 0, 0.5), 0 5px 15px rgba(0,0,0,0.8);\n    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n    font-weight: 900;\n`;\n\nconst ReplayButton = styled.button`\n    padding: 18px 50px;\n    font-size: 28px;\n    background: linear-gradient(180deg, #4CAF50, #2E7D32);\n    color: white;\n    border: 2px solid #fff;\n    border-radius: 50px;\n    cursor: pointer;\n    font-weight: bold;\n    box-shadow: 0 5px 15px rgba(0,0,0,0.3);\n    transition: all 0.2s ease;\n    outline: none;\n\n    &:hover {\n        background: linear-gradient(180deg, #66BB6A, #388E3C);\n        transform: scale(1.05) translateY(-2px);\n        box-shadow: 0 8px 20px rgba(0,0,0,0.4);\n    }\n\n    &:active {\n        transform: scale(0.98) translateY(0);\n    }\n`;\n\nexport const Editor = () => {\n    const registryItems = useMemo(() => getRegistry() || [], []);\n    const playerVisuals = useMemo(() => registryItems.find(item => item.id === 'player') || EMPTY_OBJECT, [registryItems]);\n\n    // Basic Map State\n    const [mapWidth, setMapWidth] = useState(20);\n    const [mapHeight, setMapHeight] = useState(15);\n    const [tileMapData, setTileMapData] = useState([]);\n    const [objectMapData, setObjectMapData] = useState([]);\n    const [secretMapData, setSecretMapData] = useState([]);\n    const [objectMetadata, setObjectMetadata] = useState({});\n    const [selectedTile, setSelectedTile] = useState(null);\n    const [showGrid, setShowGrid] = useState(true);\n    const [showBackgroundImage, setShowBackgroundImage] = useState(true);\n\n    // Tools & Modes State\n    const [isDragging, setIsDragging] = useState(false);\n    const [brushSize, setBrushSize] = useState(1);\n    const [activeTool, setActiveTool] = useState('brush');\n    const [activeLayer, setActiveLayer] = useState('tile');\n    const [dragStart, setDragStart] = useState(null);\n    const stateRef = useRef({ mapWidth, mapHeight, tileMapData, objectMapData, secretMapData, objectMetadata });\n\n    // Metadata State\n    const [mapName, setMapName] = useState(\"New Map\");\n    const [creatorName, setCreatorName] = useState(\"Anonymous\");\n    const [mapDescription, setMapDescription] = useState(\"\");\n    const [createdAt, setCreatedAt] = useState(null);\n    const [highlightedIndex, setHighlightedIndex] = useState(null);\n    const [isNewMapModalOpen, setIsNewMapModalOpen] = useState(false);\n    const [isBuiltInMapsModalOpen, setIsBuiltInMapsModalOpen] = useState(false);\n    const [isResizeWindowOpen, setIsResizeWindowOpen] = useState(false);\n    const [tempMapName, setTempMapName] = useState(\"\");\n    const [tempCreatorName, setTempCreatorName] = useState(\"\");\n    const [tempMapDescription, setTempMapDescription] = useState(\"\");\n    const [activePanel, setActivePanel] = useState(null);\n\n    // Asset Options\n    const backgroundOptions = useMemo(() => loadBackgroundOptions(), []);\n    const musicOptions = useMemo(() => loadMusicOptions(), []);\n\n    // Background State\n    const [selectedBackgroundImage, setSelectedBackgroundImage] = useState(null);\n    const [backgroundParallaxFactor, setBackgroundParallaxFactor] = useState(0.3);\n    const [selectedBackgroundColor, setSelectedBackgroundColor] = useState('#99C1F1');\n    const [selectedBackgroundMusic, setSelectedBackgroundMusic] = useState(null);\n\n    // Weather State\n    const [weatherRain, setWeatherRain] = useState(0);\n    const [weatherSnow, setWeatherSnow] = useState(0);\n    const [weatherClouds, setWeatherClouds] = useState(0);\n    const [weatherFog, setWeatherFog] = useState(0);\n    const [weatherThunder, setWeatherThunder] = useState(0);\n    const [weatherLavaRain, setWeatherLavaRain] = useState(0);\n    const [weatherRadioactiveFog, setWeatherRadioactiveFog] = useState(0);\n    const [weatherMeteorRain, setWeatherMeteorRain] = useState(0);\n\n    const [playerPosition, setPlayerPosition] = useState({ x: 100, y: 100 });\n\n    // Multi-map state\n    const { \n        maps, setMaps, activeMapId, setActiveMapId, createMap: createNewMap, updateMapData, deleteMap \n    } = useEditorMaps();\n\n    const switchMap = useCallback((newMapId, spawnTriggerId = null) => {\n        if (newMapId === activeMapId) return;\n\n        // 1. Save current map data to store\n        updateMapData(activeMapId, {\n            mapWidth, mapHeight, tileMapData, objectMapData, secretMapData, objectMetadata,\n            mapName, creatorName, mapDescription, createdAt,\n            selectedBackgroundImage, selectedBackgroundColor,\n            backgroundParallaxFactor, selectedBackgroundMusic,\n            weatherRain, weatherSnow, weatherClouds, weatherFog, weatherThunder,\n            weatherLavaRain, weatherRadioactiveFog, weatherMeteorRain,\n            playerPosition\n        });\n\n        // 2. Load new map data\n        const nextMap = maps[newMapId];\n        if (nextMap) {\n            setMapWidth(nextMap.mapWidth);\n            setMapHeight(nextMap.mapHeight);\n            setTileMapData(nextMap.tileMapData);\n            setObjectMapData(nextMap.objectMapData);\n            setSecretMapData(nextMap.secretMapData);\n            setObjectMetadata(nextMap.objectMetadata || {});\n            setMapName(nextMap.name);\n            setMapDescription(nextMap.description || \"\");\n            setCreatedAt(nextMap.createdAt || new Date().toISOString());\n            setSelectedBackgroundImage(nextMap.selectedBackgroundImage);\n            setSelectedBackgroundColor(nextMap.selectedBackgroundColor);\n            setBackgroundParallaxFactor(nextMap.backgroundParallaxFactor || 0.3);\n            setSelectedBackgroundMusic(nextMap.selectedBackgroundMusic);\n            \n            if (nextMap.weather) {\n                setWeatherRain(nextMap.weather.rain || 0);\n                setWeatherSnow(nextMap.weather.snow || 0);\n                setWeatherClouds(nextMap.weather.clouds || 0);\n                setWeatherFog(nextMap.weather.fog || 0);\n                setWeatherThunder(nextMap.weather.thunder || 0);\n                setWeatherLavaRain(nextMap.weather.lavaRain || 0);\n                setWeatherRadioactiveFog(nextMap.weather.radioactiveFog || 0);\n                setWeatherMeteorRain(nextMap.weather.meteorRain || 0);\n            }\n            \n            if (nextMap.playerPosition) {\n                setPlayerPosition(nextMap.playerPosition);\n            }\n            \n            // If we have a spawnTriggerId, we might want to store it temporarily\n            // so useEditorPlayMode can include it in mapDataForGame.meta\n            // But actually, we can just update the map data in the store with this triggerId.\n            if (spawnTriggerId !== null) {\n                updateMapData(newMapId, { ...nextMap, spawnTriggerId });\n            }\n\n            setActiveMapId(newMapId);\n        }\n    }, [\n        activeMapId, maps, updateMapData, setActiveMapId,\n        mapWidth, mapHeight, tileMapData, objectMapData, secretMapData, objectMetadata,\n        mapName, creatorName, createdAt,\n        selectedBackgroundImage, selectedBackgroundColor,\n        backgroundParallaxFactor, selectedBackgroundMusic,\n        weatherRain, weatherSnow, weatherClouds, weatherFog, weatherThunder,\n        weatherLavaRain, weatherRadioactiveFog, weatherMeteorRain,\n        playerPosition\n    ]);\n\n    const handleCreateMap = useCallback((type) => {\n        const name = prompt(`Enter ${type} map name:`, `New ${type.charAt(0).toUpperCase() + type.slice(1)}`);\n        if (name) {\n            const newId = createNewMap(type, name, mapWidth, mapHeight);\n            // Optionally switch to it immediately\n            // switchMap(newId); \n        }\n    }, [createNewMap, mapWidth, mapHeight]);\n\n    // Update store when current map data changes (for minimap preview)\n    useEffect(() => {\n        const timeout = setTimeout(() => {\n            updateMapData(activeMapId, {\n                mapWidth, mapHeight, tileMapData, objectMapData, secretMapData, objectMetadata,\n                name: mapName,\n                description: mapDescription,\n                selectedBackgroundImage, selectedBackgroundColor,\n                selectedBackgroundMusic, backgroundParallaxFactor,\n                weather: {\n                    rain: weatherRain,\n                    snow: weatherSnow,\n                    clouds: weatherClouds,\n                    fog: weatherFog,\n                    thunder: weatherThunder,\n                    lavaRain: weatherLavaRain,\n                    radioactiveFog: weatherRadioactiveFog,\n                    meteorRain: weatherMeteorRain\n                },\n                playerPosition\n            });\n        }, 1000); // Debounce store updates\n        return () => clearTimeout(timeout);\n    }, [\n        activeMapId, updateMapData, mapWidth, mapHeight, tileMapData, objectMapData, secretMapData, objectMetadata, \n        mapName, mapDescription, selectedBackgroundImage, selectedBackgroundColor, selectedBackgroundMusic, backgroundParallaxFactor,\n        weatherRain, weatherSnow, weatherClouds, weatherFog, weatherThunder, weatherLavaRain, weatherRadioactiveFog, weatherMeteorRain,\n        playerPosition\n    ]);\n\n    const selectedBgOption = backgroundOptions.find((bg) => bg.metaPath === selectedBackgroundImage) || backgroundOptions[0];\n    const selectedBackgroundUrl = selectedBgOption && selectedBackgroundImage ? selectedBgOption.src : null;\n\n    // Use Custom Hooks\n    const { \n        blocks, liquids, entities, decorations, items, interactables, hazards, secrets, weather, messages, alternativeSecrets, obstacles \n    } = useEditorRegistry(registryItems);\n\n    const { \n        selection, setSelection, selectionMode, setSelectionMode, previewPosition, setPreviewPosition,\n        originalMapData, setOriginalMapData, moveSelection, commitSelection, cancelSelection \n    } = useEditorSelection(mapWidth, mapHeight, tileMapData, objectMapData, secretMapData, objectMetadata, setTileMapData, setObjectMapData, setSecretMapData, setObjectMetadata);\n\n    const {\n        isPlayMode, handlePlay, handlePause, handleReset, handleReplay, handleStateUpdate,\n        playModeObjectData, playModeSecretData, playModeWeather, gameMessage, revealedSecrets, gameEngineState, isGameOver\n    } = useEditorPlayMode(\n        mapWidth, mapHeight, tileMapData, objectMapData, secretMapData, objectMetadata, \n        selectedBackgroundImage, selectedBackgroundColor, backgroundParallaxFactor, \n        registryItems, playerPosition, setPlayerPosition, setObjectMetadata,\n        weatherRain, weatherSnow, weatherClouds, weatherFog, weatherThunder,\n        weatherLavaRain, weatherRadioactiveFog, weatherMeteorRain,\n        maps, activeMapId, switchMap, maps[activeMapId]?.spawnTriggerId,\n        setTileMapData\n    );\n\n    const {\n        handleSaveMap, handleLoadMap, handleLoadBuiltInMap, handleClearMap, openNewMapModal, confirmNewMap\n    } = useEditorOperations(\n        mapWidth, mapHeight, tileMapData, objectMapData, secretMapData, objectMetadata,\n        mapName, creatorName, mapDescription, createdAt, selectedBackgroundImage, selectedBackgroundColor,\n        backgroundParallaxFactor, selectedBackgroundMusic, playerPosition, registryItems, setCreatedAt,\n        setMapWidth, setMapHeight, setMapName, setCreatorName, setMapDescription,\n        setSelectedBackgroundImage, setSelectedBackgroundColor,\n        setBackgroundParallaxFactor, setSelectedBackgroundMusic, setPlayerPosition,\n        setTileMapData, setObjectMapData, setSecretMapData, setObjectMetadata,\n        setIsNewMapModalOpen, setTempMapName, setTempCreatorName, setTempMapDescription,\n        weatherRain, weatherSnow, weatherClouds, weatherFog, weatherThunder,\n        weatherLavaRain, weatherRadioactiveFog, weatherMeteorRain,\n        setWeatherRain, setWeatherSnow, setWeatherClouds, setWeatherFog, setWeatherThunder,\n        setWeatherLavaRain, setWeatherRadioactiveFog, setWeatherMeteorRain,\n        maps, setMaps, activeMapId, setActiveMapId\n    );\n\n    const {\n        hoverIndex, setHoverIndex, bucketPreviewIndices, setBucketPreviewIndices,\n        handleGridMouseDown, handleGridMouseMove, handleGridMouseUp,\n        handleResizeStart, handleMoveStart, paintTile\n    } = useEditorPainting(\n        mapWidth, mapHeight, tileMapData, objectMapData, secretMapData, \n        setTileMapData, setObjectMapData, setSecretMapData,\n        activeTool, brushSize, activeLayer, selectedTile, selection, \n        setSelection, setPreviewPosition, setOriginalMapData, dragStart, setDragStart, isDragging, setIsDragging,\n        setActivePanel, setHighlightedIndex, highlightedIndex, registryItems,\n        objectMetadata, setObjectMetadata\n    );\n\n    // Side Effects\n    useEffect(() => {\n        stateRef.current = { mapWidth, mapHeight, tileMapData, objectMapData, secretMapData, objectMetadata };\n    }, [mapWidth, mapHeight, tileMapData, objectMapData, secretMapData, objectMetadata]);\n\n    useEffect(() => {\n        const size = 15 * 20;\n        setTileMapData(Array(size).fill(null));\n        setObjectMapData(Array(size).fill(null));\n        setSecretMapData(Array(size).fill(null));\n    }, []);\n\n    const togglePanel = (panel) => {\n        setActivePanel(prev => prev === panel ? null : panel);\n    };\n\n    const handleMapResize = (newWidth, newHeight) => {\n        if (newWidth === mapWidth && newHeight === mapHeight) return;\n        resizeMapData({\n            newWidth, newHeight, stateRef, setMapWidth, setMapHeight,\n            setTileMapData, setObjectMapData, setSecretMapData, setObjectMetadata\n        });\n    };\n\n    const handlePaletteSelect = useCallback((item, layer) => {\n        setSelectedTile(item);\n        setActiveLayer(layer);\n        setActiveTool('brush');\n        setSelection(null);\n    }, []);\n\n    // Grid Event Handlers\n    \n    const handleGridMouseLeave = useCallback(() => {\n        setHoverIndex(null);\n        setBucketPreviewIndices(new Set());\n    }, [setHoverIndex, setBucketPreviewIndices]);\n\n    const totalTiles = mapWidth * mapHeight;\n    const filledBlocks = tileMapData.filter(t => t !== null).length;\n    const emptyBlocks = totalTiles - filledBlocks;\n    const objectsCount = objectMapData.filter(o => o !== null).length;\n\n    return (\n        <div className=\"editor-wrapper\" style={{ position: 'relative', height: '100%', overflow: 'hidden', display: 'flex', flexDirection: 'column' }}>\n            <NewMapModal \n                isOpen={isNewMapModalOpen}\n                tempMapName={tempMapName}\n                setTempMapName={setTempMapName}\n                tempCreatorName={tempCreatorName}\n                setTempCreatorName={setTempCreatorName}\n                tempMapDescription={tempMapDescription}\n                setTempMapDescription={setTempMapDescription}\n                confirmNewMap={confirmNewMap}\n                onClose={() => setIsNewMapModalOpen(false)}\n            />\n\n            <BuiltInMapsModal \n                isOpen={isBuiltInMapsModalOpen}\n                onClose={() => setIsBuiltInMapsModalOpen(false)}\n                onSelect={handleLoadBuiltInMap}\n            />\n\n            <div className=\"editor-container\" style={{\n                display: 'flex', flex: 1, flexDirection: 'row',\n                filter: (isNewMapModalOpen || isBuiltInMapsModalOpen) ? 'blur(4px) brightness(0.7)' : 'none',\n                transition: 'filter 0.2s ease',\n                pointerEvents: (isNewMapModalOpen || isBuiltInMapsModalOpen) ? 'none' : 'auto',\n                overflow: 'hidden'\n            }}>\n                <EditorElements \n                    mapName={mapName}\n                    creatorName={creatorName}\n                    mapDescription={mapDescription}\n                    setMapName={setMapName}\n                    setCreatorName={setCreatorName}\n                    setMapDescription={setMapDescription}\n                    openNewMapModal={openNewMapModal}\n                    openBuiltInModal={() => setIsBuiltInMapsModalOpen(true)}\n                    saveMap={handleSaveMap}\n                    loadMap={handleLoadMap}\n                    clearMap={handleClearMap}\n                    isPlayMode={isPlayMode}\n                    handlePaletteSelect={handlePaletteSelect}\n                    selectedTile={selectedTile}\n                    blocks={blocks}\n                    liquids={liquids}\n                    entities={entities}\n                    items={items}\n                    decorations={decorations}\n                    interactables={interactables}\n                    hazards={hazards}\n                    secrets={secrets}\n                    weather={weather}\n                    messages={messages}\n                    alternativeSecrets={alternativeSecrets}\n                    obstacles={obstacles}\n                    totalTiles={totalTiles}\n                    filledBlocks={filledBlocks}\n                    emptyBlocks={emptyBlocks}\n                    objectsCount={objectsCount}\n                    mapWidth={mapWidth}\n                    mapHeight={mapHeight}\n                    objectMapData={objectMapData}\n                    objectMetadata={objectMetadata}\n                    setObjectMetadata={setObjectMetadata}\n                    registryItems={registryItems}\n                    highlightedIndex={highlightedIndex}\n                    setHighlightedIndex={setHighlightedIndex}\n                    activePanel={activePanel}\n                    setActivePanel={setActivePanel}\n                    togglePanel={togglePanel}\n                    maps={maps}\n                />\n\n                <div style={{ display: 'flex', flex: 1, flexDirection: 'column', overflow: 'hidden' }}>\n                    <EditorTools\n                        mapName={mapName}\n                        creatorName={creatorName}\n                        activePanel={activePanel}\n                        togglePanel={togglePanel}\n                        showGrid={showGrid}\n                        setShowGrid={setShowGrid}\n                        isPlayMode={isPlayMode}\n                        handlePlay={handlePlay}\n                        handlePause={handlePause}\n                        handleReset={handleReset}\n                        activeTool={activeTool}\n                        setActiveTool={setActiveTool}\n                        brushSize={brushSize}\n                        setBrushSize={setBrushSize}\n                        activeLayer={activeLayer}\n                        selection={selection}\n                        moveSelection={moveSelection}\n                        selectionMode={selectionMode}\n                        setSelectionMode={setSelectionMode}\n                        commitSelection={commitSelection}\n                        cancelSelection={cancelSelection}\n                        selectedTile={selectedTile}\n                        handlePaletteSelect={handlePaletteSelect}\n                        selectedBackgroundColor={selectedBackgroundColor}\n                        setSelectedBackgroundColor={setSelectedBackgroundColor}\n                        showBackgroundImage={showBackgroundImage}\n                        setShowBackgroundImage={setShowBackgroundImage}\n                    />\n                    \n                    <div style={{ display: 'flex', flex: 1, flexDirection: 'row', overflow: 'hidden' }}>\n\n                    <EditorScene \n                        handleMapResize={handleMapResize}\n                        isResizeWindowOpen={isResizeWindowOpen}\n                        setIsResizeWindowOpen={setIsResizeWindowOpen}\n                        mapWidth={mapWidth}\n                        mapHeight={mapHeight}\n                        tileMapData={tileMapData}\n                        objectMapData={objectMapData}\n                        objectMetadata={objectMetadata}\n                        registryItems={registryItems}\n                        backgroundOptions={backgroundOptions}\n                        selectedBackgroundImage={selectedBackgroundImage}\n                        setSelectedBackgroundImage={setSelectedBackgroundImage}\n                        selectedBackgroundColor={selectedBackgroundColor}\n                        setSelectedBackgroundColor={setSelectedBackgroundColor}\n                        backgroundParallaxFactor={backgroundParallaxFactor}\n                        setBackgroundParallaxFactor={setBackgroundParallaxFactor}\n                        musicOptions={musicOptions}\n                        selectedBackgroundMusic={selectedBackgroundMusic}\n                        setSelectedBackgroundMusic={setSelectedBackgroundMusic}\n                        weatherRain={weatherRain}\n                        setWeatherRain={setWeatherRain}\n                        weatherSnow={weatherSnow}\n                        setWeatherSnow={setWeatherSnow}\n                        weatherClouds={weatherClouds}\n                        setWeatherClouds={setWeatherClouds}\n                        weatherFog={weatherFog}\n                        setWeatherFog={setWeatherFog}\n                        weatherThunder={weatherThunder}\n                        setWeatherThunder={setWeatherThunder}\n                        weatherLavaRain={weatherLavaRain}\n                        setWeatherLavaRain={setWeatherLavaRain}\n                        weatherRadioactiveFog={weatherRadioactiveFog}\n                        setWeatherRadioactiveFog={setWeatherRadioactiveFog}\n                        weatherMeteorRain={weatherMeteorRain}\n                        setWeatherMeteorRain={setWeatherMeteorRain}\n                        // Multi-map props\n                        maps={maps}\n                        activeMapId={activeMapId}\n                        switchMap={switchMap}\n                        createMap={handleCreateMap}\n                        deleteMap={deleteMap}\n                        updateMapData={updateMapData}\n                    />\n\n                    {!isPlayMode ? (\n                        <Viewport\n                            mapWidth={mapWidth}\n                            mapHeight={mapHeight}\n                            selectedBackgroundUrl={selectedBackgroundUrl}\n                            selectedBackgroundColor={selectedBackgroundColor}\n                            selectedBackgroundImage={selectedBackgroundImage}\n                            showBackgroundImage={showBackgroundImage}\n                            showGrid={showGrid}\n                            activeLayer={activeLayer}\n                            activeTool={activeTool}\n                            tileMapData={tileMapData}\n                            objectMapData={objectMapData}\n                            secretMapData={secretMapData}\n                            objectMetadata={objectMetadata}\n                            registryItems={registryItems}\n                            hoverIndex={hoverIndex}\n                            highlightedIndex={highlightedIndex}\n                            brushSize={brushSize}\n                            bucketPreviewIndices={bucketPreviewIndices}\n                            selection={selection}\n                            previewPosition={previewPosition}\n                            dragStart={dragStart}\n                            isDragging={isDragging}\n                            handleGridMouseDown={handleGridMouseDown}\n                            handleGridMouseEnter={handleGridMouseMove}\n                            handleGridMouseUp={handleGridMouseUp}\n                            handleGridMouseLeave={handleGridMouseLeave}\n                            handleResizeStart={handleResizeStart}\n                            handleMoveStart={handleMoveStart}\n                            setIsDragging={setIsDragging}\n                            weatherRain={weatherRain}\n                            weatherSnow={weatherSnow}\n                            weatherClouds={weatherClouds}\n                            weatherFog={weatherFog}\n                            weatherThunder={weatherThunder}\n                            weatherLavaRain={weatherLavaRain}\n                            weatherRadioactiveFog={weatherRadioactiveFog}\n                            weatherMeteorRain={weatherMeteorRain}\n                        />\n                    ) : (\n                        <div style={{ flex: 1, position: 'relative', backgroundColor: '#000' }}>\n                            <PixiStage\n                                mapWidth={mapWidth}\n                                mapHeight={mapHeight}\n                                tileSize={TILE_SIZE}\n                                tileMapData={tileMapData}\n                                objectMapData={playModeObjectData}\n                                secretMapData={playModeSecretData}\n                                revealedSecrets={revealedSecrets || []}\n                                registryItems={registryItems}\n                                playerState={gameEngineState}\n                                playerVisuals={playerVisuals}\n                                projectiles={gameEngineState?.projectiles || []}\n                                objectMetadata={objectMetadata}\n                                backgroundImage={showBackgroundImage ? selectedBackgroundImage : null}\n                                backgroundColor={selectedBackgroundColor}\n                                backgroundParallaxFactor={backgroundParallaxFactor}\n                                weatherRain={playModeWeather.rain}\n                                weatherLavaRain={playModeWeather.lavaRain}\n                                weatherSnow={playModeWeather.snow}\n                                weatherMeteorRain={playModeWeather.meteorRain}\n                                weatherClouds={playModeWeather.clouds}\n                                weatherFog={playModeWeather.fog}\n                                weatherRadioactiveFog={playModeWeather.radioactiveFog}\n                                weatherThunder={playModeWeather.thunder}\n                                onWeatherEffectHit={(type, data) => handleStateUpdate('weatherEffectHit', { type, data })}\n                                isEditor={false}\n                                isEditorPlayMode={true}\n                                showGrid={showGrid}\n                            />\n                            {isGameOver && (\n                                <GameOverOverlay>\n                                    <GameOverTitle>Game Over</GameOverTitle>\n                                    <ReplayButton onClick={handleReplay}>\n                                        REPLAY \n                                    </ReplayButton>\n                                </GameOverOverlay>\n                            )}\n                            {gameMessage.text && (\n                                <MessageOverlay $isVisible={gameMessage.isVisible}>\n                                    <h2>{gameMessage.text}</h2>\n                                </MessageOverlay>\n                            )}\n                        </div>\n                    )}\n                </div>\n            </div>\n        </div>\n    </div>\n);\n};\n","export const loadBackgroundOptions = () => {\n    const bgContext = require.context('../../../assets/background', false, /\\.(png|jpe?g|svg|webp)$/i);\n    return bgContext.keys().map((key) => {\n        const mod = bgContext(key);\n        const url = mod.default || mod;\n        const name = key.replace('./', '');\n        return { key, name, src: url, metaPath: `/assets/background/${name}` };\n    });\n};\n\nexport const loadMusicOptions = () => {\n    const musicContext = require.context('../../../assets/sound/background', false, /\\.(ogg|mp3|wav|m4a)$/i);\n    return musicContext.keys().map((key) => {\n        const mod = musicContext(key);\n        const name = key.replace('./', '');\n        return { key, name, src: (mod.default || mod), metaPath: `/assets/sound/background/${name}` };\n    });\n};\n","import { useState, useCallback } from 'react';\n\nexport const useEditorMaps = () => {\n    const [maps, setMaps] = useState({\n        'main': {\n            id: 'main',\n            name: 'Overworld',\n            description: '',\n            type: 'overworld',\n            mapWidth: 20,\n            mapHeight: 15,\n            tileMapData: Array(20 * 15).fill(null),\n            objectMapData: Array(20 * 15).fill(null),\n            secretMapData: Array(20 * 15).fill(null),\n            objectMetadata: {},\n            selectedBackgroundImage: null,\n            selectedBackgroundColor: '#99C1F1',\n            backgroundParallaxFactor: 0.3,\n            selectedBackgroundMusic: null,\n            weather: {\n                rain: 0,\n                snow: 0,\n                clouds: 0,\n                fog: 0,\n                thunder: 0,\n                lavaRain: 0,\n                radioactiveFog: 0,\n                meteorRain: 0\n            },\n            playerPosition: { x: 100, y: 100 },\n            worldX: 50,\n            worldY: 50\n        }\n    });\n    const [activeMapId, setActiveMapId] = useState('main');\n\n    const createMap = useCallback((type, name, width = 20, height = 15) => {\n        const id = `map_${Date.now()}`;\n        \n        // Find a good spot for new map\n        const existingMaps = Object.values(maps);\n        const maxY = Math.max(...existingMaps.map(m => m.worldY || 0), 0);\n        \n        const newMap = {\n            id,\n            name: name || (type === 'overworld' ? 'New Overworld' : 'New Underworld'),\n            description: '',\n            type,\n            mapWidth: width,\n            mapHeight: height,\n            tileMapData: Array(width * height).fill(null),\n            objectMapData: Array(width * height).fill(null),\n            secretMapData: Array(width * height).fill(null),\n            objectMetadata: {},\n            selectedBackgroundImage: null,\n            selectedBackgroundColor: type === 'overworld' ? '#99C1F1' : '#1a1a1a',\n            backgroundParallaxFactor: 0.3,\n            selectedBackgroundMusic: null,\n            weather: {\n                rain: 0,\n                snow: 0,\n                clouds: 0,\n                fog: 0,\n                thunder: 0,\n                lavaRain: 0,\n                radioactiveFog: 0,\n                meteorRain: 0\n            },\n            playerPosition: null, // Only one map should have player eventually\n            worldX: 50,\n            worldY: maxY + 150\n        };\n\n        setMaps(prev => ({\n            ...prev,\n            [id]: newMap\n        }));\n        return id;\n    }, []);\n\n    const updateMapData = useCallback((id, data) => {\n        setMaps(prev => ({\n            ...prev,\n            [id]: {\n                ...prev[id],\n                ...data\n            }\n        }));\n    }, []);\n\n    const deleteMap = useCallback((id) => {\n        if (id === 'main') return; // Cannot delete main map\n        setMaps(prev => {\n            const newMaps = { ...prev };\n            delete newMaps[id];\n            return newMaps;\n        });\n        if (activeMapId === id) {\n            setActiveMapId('main');\n        }\n    }, [activeMapId]);\n\n    return {\n        maps,\n        setMaps,\n        activeMapId,\n        setActiveMapId,\n        createMap,\n        updateMapData,\n        deleteMap\n    };\n};\n","import { useMemo } from 'react';\n\nexport const useEditorRegistry = (registryItems) => {\n    const blocks = useMemo(() => \n        registryItems.filter(item => item.name && item.name.startsWith('block.') && !(item.flags && item.flags.liquid)), \n    [registryItems]);\n\n    const liquids = useMemo(() => \n        registryItems.filter(item => item.flags && item.flags.liquid), \n    [registryItems]);\n\n    const entities = useMemo(() => {\n        const baseEntities = registryItems.filter(item => {\n            if (!item.name || !item.name.toLowerCase().includes('entities.')) return false;\n            if (item.isHiddenInEditor) return false;\n            return !item.type || item.type === 'default' || item.type === 'entity' || item.subtype === 'tank';\n        });\n\n        const itemsToMove = registryItems.filter(item => \n            item.name && \n            item.name.startsWith('item.') && \n            item.id !== 'hertz_item' && \n            item.id !== 'fireball_ammo'\n        );\n\n        return [...baseEntities, ...itemsToMove];\n    }, [registryItems]);\n\n    const decorations = useMemo(() => \n        registryItems.filter(item => {\n            if (item.type === 'decoration') return true;\n            if (item.name && item.name.toLowerCase().includes('decoration.')) return true;\n            if (item.id && item.id.includes('stone_pack')) return true;\n            return false;\n        }), \n    [registryItems]);\n\n    const items = useMemo(() => \n        registryItems.filter(item => \n            item.name && \n            item.name.startsWith('item.') && \n            (item.id === 'hertz_item' || item.id === 'fireball_ammo')\n        ), \n    [registryItems]);\n\n    const interactables = useMemo(() => \n        registryItems.filter(item => item.type === 'interactable' || (item.name && item.name.startsWith('interactable.'))), \n    [registryItems]);\n\n    const hazards = useMemo(() => \n        registryItems.filter(item => item.type === 'hazard' || (item.name && item.name.startsWith('hazard.'))), \n    [registryItems]);\n\n    const secrets = useMemo(() => \n        registryItems.filter(item => item.type === 'secret'), \n    [registryItems]);\n\n    const weather = useMemo(() => \n        registryItems.filter(item => item.type === 'weather_trigger'), \n    [registryItems]);\n\n    const messages = useMemo(() => \n        registryItems.filter(item => item.type === 'message_trigger'), \n    [registryItems]);\n\n    const alternativeSecrets = useMemo(() => \n        registryItems.filter(item => item.type === 'crack_block' || item.type === 'wolf_secret'),\n    [registryItems]);\n\n    const obstacles = useMemo(() => \n        registryItems.filter(item => item.type === 'obstacle' || (item.name && item.name.startsWith('obstacle.'))), \n    [registryItems]);\n\n    return {\n        blocks,\n        liquids,\n        entities,\n        decorations,\n        items,\n        interactables,\n        hazards,\n        secrets,\n        weather,\n        messages,\n        alternativeSecrets,\n        obstacles\n    };\n};\n","import { useState, useEffect, useCallback } from 'react';\n\nexport const useEditorSelection = (mapWidth, mapHeight, tileMapData, objectMapData, secretMapData, objectMetadata, setTileMapData, setObjectMapData, setSecretMapData, setObjectMetadata) => {\n    const [selection, setSelection] = useState(null);\n    const [selectionMode, setSelectionMode] = useState('cut'); // 'cut' or 'copy'\n    const [previewPosition, setPreviewPosition] = useState(null);\n    const [originalMapData, setOriginalMapData] = useState(null);\n\n    const moveSelection = useCallback((dx, dy) => {\n        if (!selection || !previewPosition) return;\n        setPreviewPosition({ \n            x: previewPosition.x + dx, \n            y: previewPosition.y + dy \n        });\n    }, [selection, previewPosition]);\n\n    const cancelSelection = useCallback(() => {\n        setSelection(null);\n        setPreviewPosition(null);\n        setOriginalMapData(null);\n    }, []);\n\n    const commitSelection = useCallback(() => {\n        if (!selection || !previewPosition || !originalMapData) return;\n\n        const newTileMap = [...originalMapData.tileMap];\n        const newObjectMap = [...originalMapData.objectMap];\n        const newSecretMap = [...originalMapData.secretMap];\n        const newObjectMetadata = { ...originalMapData.objectMetadata };\n\n        // If cut mode, clear original position\n        if (selectionMode === 'cut') {\n            for (let py = 0; py < selection.h; py++) {\n                for (let px = 0; px < selection.w; px++) {\n                    const idx = (selection.originalY + py) * mapWidth + (selection.originalX + px);\n                    if (idx >= 0 && idx < newTileMap.length) {\n                        newTileMap[idx] = null;\n                        newObjectMap[idx] = null;\n                        newSecretMap[idx] = null;\n                        delete newObjectMetadata[idx];\n                    }\n                }\n            }\n        }\n\n        // Place selection at new position\n        for (let py = 0; py < selection.h; py++) {\n            for (let px = 0; px < selection.w; px++) {\n                const destX = previewPosition.x + px;\n                const destY = previewPosition.y + py;\n                if (destX >= 0 && destX < mapWidth && destY >= 0 && destY < mapHeight) {\n                    const destIdx = destY * mapWidth + destX;\n                    const srcDataIdx = py * selection.w + px;\n\n                    newTileMap[destIdx] = selection.tileData[srcDataIdx];\n                    newObjectMap[destIdx] = selection.objectData[srcDataIdx];\n                    newSecretMap[destIdx] = selection.secretData?.[srcDataIdx] || null;\n                    \n                    if (selection.metadata && selection.metadata[`${px},${py}`]) {\n                        newObjectMetadata[destIdx] = { ...selection.metadata[`${px},${py}`] };\n                    }\n                }\n            }\n        }\n\n        setTileMapData(newTileMap);\n        setObjectMapData(newObjectMap);\n        setSecretMapData(newSecretMap);\n        setObjectMetadata(newObjectMetadata);\n        setSelection(null);\n        setPreviewPosition(null);\n        setOriginalMapData(null);\n    }, [selection, previewPosition, originalMapData, selectionMode, mapWidth, mapHeight, setTileMapData, setObjectMapData, setSecretMapData, setObjectMetadata]);\n\n    // Keyboard handler for Enter (commit) and Escape (cancel)\n    useEffect(() => {\n        const handleKeyDown = (e) => {\n            if (selection) {\n                if (e.key === 'Enter') {\n                    e.preventDefault();\n                    commitSelection();\n                } else if (e.key === 'Escape') {\n                    e.preventDefault();\n                    cancelSelection();\n                }\n            }\n        };\n\n        window.addEventListener('keydown', handleKeyDown);\n        return () => window.removeEventListener('keydown', handleKeyDown);\n    }, [selection, previewPosition, originalMapData, selectionMode, commitSelection, cancelSelection]);\n\n    return {\n        selection,\n        setSelection,\n        selectionMode,\n        setSelectionMode,\n        previewPosition,\n        setPreviewPosition,\n        originalMapData,\n        setOriginalMapData,\n        moveSelection,\n        commitSelection,\n        cancelSelection\n    };\n};\n","\n\nexport default function Crystals() {\n\n    return (\n        <>\n            <p>Crystals</p>\n        </>\n    )\n}","import React, { useState, useEffect } from 'react';\nimport { getRegistry } from '../../engine/registry';\nimport AnimatedItem from '../../utilities/AnimatedItem';\n\nexport default function Repository() {\n    const registryItems = getRegistry();\n\n    // Container style for grid layout\n    const containerStyle = {\n        display: 'flex',\n        flexWrap: 'wrap',\n        gap: '20px',\n        padding: '20px'\n    };\n\n    // Style for each card\n    const cardStyle = {\n        border: '1px solid #ccc',\n        borderRadius: '8px',\n        padding: '10px',\n        width: '200px',\n        display: 'flex',\n        flexDirection: 'column',\n        alignItems: 'center',\n        backgroundColor: '#f9f9f9'\n    };\n\n    // Image style (64x64)\n    const imageStyle = {\n        width: '64px',\n        height: '64px',\n        objectFit: 'contain', // Prevent image stretching if proportions aren't perfect\n        imageRendering: 'pixelated', // Important for pixel graphics (2D games)\n        marginBottom: '10px',\n        border: '1px dashed #aaa'\n    };\n\n    const fieldsContainerStyle = {\n        width: '100%',\n        fontSize: '12px',\n        textAlign: 'left'\n    };\n\n    return (\n        <div style={containerStyle}>\n            {registryItems.map((item, index) => (\n                <div key={item.id || index} style={cardStyle}>\n                    \n                    {/* Choose: Animation or Static image */}\n                    {item.textures && item.textures.length > 0 ? (\n                        <AnimatedItem\n                            textures={item.textures}\n                            texture={item.texture}\n                            speed={item.animationSpeed}\n                            style={imageStyle}\n                            alt={item.name}\n                        />\n                    ) : (\n                        <img \n                            src={item.texture} \n                            alt={item.name} \n                            style={imageStyle}\n                            onError={(e) => { e.target.style.display = 'none'; }} \n                        />\n                    )}\n\n                    {/* Filter out 'texture', 'textures', and 'animationSpeed' from text list */}\n                    <div style={fieldsContainerStyle}>\n                        {Object.entries(item)\n                            .filter(([key]) => !['texture', 'textures', 'animationSpeed'].includes(key))\n                            .map(([key, value]) => (\n                                <div key={key} style={{ marginBottom: '4px', wordBreak: 'break-all' }}>\n                                    <strong>{key}:</strong> \n                                    <span style={{ marginLeft: '5px', color: '#555' }}>\n                                        {typeof value === 'object' ? JSON.stringify(value) : String(value)}\n                                    </span>\n                                </div>\n                        ))}\n                    </div>\n                </div>\n            ))}\n            \n            {registryItems.length === 0 && <p>No items found in registry.</p>}\n        </div>\n    );\n}","import React from 'react'\nimport ReactDOM from 'react-dom/client'\nimport { BrowserRouter, Routes, Route } from \"react-router-dom\"\nimport { Provider } from 'react-redux'\nimport { ThemeProvider } from 'styled-components'\nimport store from './store'\nimport theme from './styles/theme'\nimport GlobalStyles from './styles/GlobalStyles'\nimport './i18n/i18n'\nimport './index.css'\nimport App from './App'\nimport Home from \"./sections/chapters/home\"\nimport Game from \"./sections/chapters/game\"\nimport {Editor} from \"./sections/chapters/editor/Editor\"\nimport Crystals from \"./sections/chapters/crystals\"\nimport Repository from \"./sections/chapters/repository\"\n\nconst root = ReactDOM.createRoot(document.getElementById('root'))\nroot.render(\n    <Provider store={store}>\n        <ThemeProvider theme={theme}>\n            <GlobalStyles />\n            <BrowserRouter basename={process.env.PUBLIC_URL}>\n                <Routes>\n\n                <Route path=\"/\" element={<App />}>\n                    <Route index element={<Home />} />\n                    <Route path=\"game\" element={<Game />} />\n                    <Route path=\"editor\" element={<Editor />} />\n                    <Route path=\"crystals\" element={<Crystals />} />\n                    <Route path=\"repository\" element={<Repository />} />\n                </Route>\n\n                </Routes>\n            </BrowserRouter>\n        </ThemeProvider>\n    </Provider>\n)\n"],"names":["map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","resolve","module","exports","initialState","activeMapData","tileMapData","objectMapData","secretMapData","objectMetadata","revealedSecrets","objectTextureIndices","mapWidth","mapHeight","projectMaps","isLoading","error","isPaused","isGameOver","gameSlice","createSlice","name","reducers","setActiveMap","state","action","mapData","payload","meta","maps","updateObjectMap","updateObjectMetadata","index","metadata","removeObjectAtIndex","undefined","removeTileAtIndex","moveTileInMap","fromIndex","toIndex","moveObjectInMap","updateObjectAtIndex","newId","setObjectTextureIndex","textureIndex","revealSecretZone","forEach","idx","includes","push","setLoading","setError","setPaused","setGameOver","resetGame","actions","TILE_SIZE","MAX_HEALTH","MAX_OXYGEN","MAX_LAVA_RESIST","MAX_RADIOACTIVITY","x","y","width","height","vx","vy","isGrounded","direction","animation","health","maxHealth","strength","maxStrength","ammo","oxygen","maxOxygen","lavaResist","maxLavaResist","projectiles","inWater","headUnderWater","atSurface","liquidType","hitTimerMs","isWinning","winCounter","playerSlice","updateState","setPosition","setVelocity","setHealth","Math","max","min","addHealth","takeDamage","setAmmo","addAmmo","setOxygen","setLavaResist","setStrength","setProjectiles","addProjectile","removeProjectile","filter","p","setDirection","setAnimation","setGrounded","setInWater","setLiquidType","resetPlayer","sound","enabled","masterVolume","sfxVolume","musicVolume","graphics","backgroundParallaxFactor","weatherRain","weatherSnow","weatherClouds","weatherFog","weatherThunder","ui","healthBarEnabled","oxygenBarEnabled","lavaBarEnabled","waterSplashesEnabled","lavaEmbersEnabled","controls","keyUp","keyDown","keyLeft","keyRight","keyJump","keyShoot","settingsSlice","loadSettings","saved","localStorage","getItem","parsed","JSON","parse","console","updateSettings","newState","setItem","stringify","setSoundEnabled","setSoundVolume","type","volume","setGraphicsSetting","key","value","setUISetting","setControlBinding","resetSettings","removeItem","isMapModalOpen","isSettingsOpen","isTerminalOpen","isPauseMenuOpen","notifications","cameraScrollX","shouldCenterMap","uiSlice","setMapModalOpen","setSettingsOpen","setTerminalOpen","window","__GAME_TERMINAL_OPEN__","setPauseMenuOpen","addNotification","Date","now","timestamp","toISOString","removeNotification","n","clearNotifications","setCameraScrollX","setShouldCenterMap","resetUI","configureStore","reducer","game","gameReducer","player","playerReducer","settings","settingsReducer","uiReducer","middleware","getDefaultMiddleware","serializableCheck","ignoredActions","ignoredActionPaths","ignoredPaths","devTools","process","colors","primary","secondary","danger","warning","success","info","dark","darkGray","mediumGray","lightGray","background","surface","overlay","text","textLight","textDark","border","borderLight","spacing","xs","sm","md","lg","xl","xxl","borderRadius","round","shadows","fontSize","base","fontWeight","light","normal","medium","semibold","bold","transitions","fast","slow","zIndex","dropdown","modal","tooltip","notification","breakpoints","mobile","tablet","desktop","wide","createGlobalStyle","lv_navigation","no_navigation","en_navigation","ru_navigation","ja_navigation","i18n","initReactI18next","init","lng","fallbackLng","supportedLngs","ns","defaultNS","interpolation","escapeValue","resources","lv","navigation","no","en","ru","ja","NavLinkButton","styled","NavLink","withConfig","componentId","SectionHeaderNavigationChapters","t","useTranslation","chapter_home","chapter_game","chapter_editor","chapter_crystals","_jsxs","style","display","gap","children","_jsx","to","className","isActive","onClick","handleNewGameClick","dispatchEvent","Event","NavButton","button","DropdownContainer","div","DropdownMenu","MenuItem","ToggleSwitch","props","$active","SectionHeaderNavigationLanguages","dispatch","useDispatch","dropdownRef","useRef","isMenuOpen","setIsMenuOpen","useState","useSelector","soundEnabled","currentLang","language","handleLanguageChange","newLang","changeLanguage","useEffect","handleClickOutside","event","current","contains","target","document","addEventListener","removeEventListener","ref","title","toggleSound","next","CustomEvent","detail","backgroundColor","margin","padding","color","StyledLogo","SectionHeaderNavigationLogo","StyledSectionHeaderNavigation","StyledSectionContent","_registry","initRegistry","time","jsonContext","require","imageContext","soundContext","warn","resolvePath","rawPath","cleanPath","replace","relativePath","startsWith","imageModule","default","_warnedUnresolvedSound","resolveSound","rel","out","normalize","mod","data","item","resolvedTexture","texture","resolvedTextures","textures","Array","isArray","path","sfx","sfxResolved","defaultAnimation","animItem","find","r","length","animationSpeed","isHiddenInEditor","deadAnimation","deadItem","targetAnimation","targetItem","log","timeEnd","getRegistry","findItemById","items","flexDirection","justifyContent","alignItems","overflow","flexShrink","SectionHeader","SectionContent","flexGrow","Outlet","PUBLIC_URL","apiUrl","env","REACT_APP_API_URL","logo","URL_LOGO_01","URL_LOGO_02","URL_LOGO_03","URL_LOGO_04","URL_LOGO_05","HomeContainer","Home","LOGO_01","config","LOGO_02","LOGO_03","LOGO_04","LOGO_05","src","alt","TextureCache","constructor","this","_map","Map","get","url","m","has","tex","Texture","from","set","dispose","delete","clear","WeatherRain","container","api","getIntensity","tileSize","particles","intensity","maxParticles","resize","area","floor","setIntensity","v","Number","spawnOne","g","Graphics","rect","fill","alpha","viewport","getViewport","random","speed","rotation","addChild","bounces","alive","update","dtMs","targetIntensity","abs","lerpFactor","exp","norm","scaled","pow","deficit","maxPerFrame","smooth","ceil","toSpawn","i","surplus","toCull","pop","parent","removeChild","destroy","dt","toRemove","nx","ny","getLiquidSurfaceY","syWater","isFinite","onWaterImpact","syLava","onLavaImpact","isSolidAt","guard","vY","vH","j","splice","WeatherSnow","flakes","maxFlakes","circle","drift","settled","life","phase","restMs","f","sin","sYwater","sYlava","gAcc","WeatherClouds","bandHeight","patches","windDirection","filters","BlurFilter","quality","rebuild","isInitial","w","h","vX","vW","range","rx","ry","circles","baseR","k","PI","dist","cx","cos","cy","targetAlpha","currentAlpha","dying","targetCount","W","bandTop","bandBottom","activePatches","_spawnTimer","toKill","osc","leftBound","rightBound","WeatherFog","noiseTex","_createNoiseTexture","layer1","TilingSprite","layer2","tileScale","_recalcParams","_draw","_alphaFromIntensity","nv","_applyAlphas","baseAlpha","pulse","tilePosition","speed1","speed2","pulseFactor","noiseAlpha","lerp","a","b","u","canvas","createElement","ctx","getContext","img","createImageData","putImageData","WeatherThunder","nextStrikeMs","Infinity","flashAlpha","flashDecay","boltAlive","boltTime","boltDuration","flashG","boltG","_scheduleNextStrike","_redrawFlash","_clearBolt","H","_triggerFlash","_createBolt","decayPerMs","remain","initial","minDelay","_lerp","maxDelay","delay","_rand","topY","targetY","_findGroundY","endY","segments","jitterX","points","thickness","moveTo","lineTo","stroke","alignment","cap","join","branchCount","len","ang","bx","by","worldX","maxH","isSolid","WeatherLavaRain","WeatherRadioactiveFog","WeatherMeteorRain","size","isLarge","atan2","onMeteorHit","WaterSplashFX","node","Container","droplets","rings","maxDroplets","maxRings","trigger","upward","s","vr","count","spd","d","LavaEmbers","spawnAcc","embers","maxEmbers","surfaces","rebuildSurfaces","registryItems","getDef","isLava","def","flags","lava","TS","spans","gy","runStart","gx","aboveLava","_spawnOne","trail","cur","baseRate","mult","shift","emberAlpha","emberSize","p0","p1","LavaSteamFX","puffs","maxPuffs","radius","LiquidRegionSystem","opts","bgContainer","_regions","_waterTex","_lavaTex","_quicksandTex","_waterfallTex","_lavaWaterfallTex","_radioactiveWaterTex","_radioactiveWaterfallTex","_time","_noiseTex","_lavaDetailTex","_waterDetailTex","_quicksandDetailTex","_playerState","setPlayerState","playerState","_checkPlayerInRegion","region","px","py","pw","ph","pt","tileIndicesSet","getSurfaceY","X","topEdges","bgNode","_gradTextures","mw","mh","ts","changed","waterDrift","lavaDrift","quicksandDrift","waterfallDrift","lavaWaterfallDrift","radioactiveWaterDrift","radioactiveWaterfallDrift","sprite","alphaDiff","splashG","bottomEdges","F","splashHeight","splashColor","noise1","noise2","waves","lifeMsWater","lifeMsLava","startRadius","decay","ampNow","amp","capG","dy","centerX","dx","sigma","gauss","maxDisp","build","typeAt","liquid","lava_waterfall","radioactive_waterfall","waterfall","radioactive_water","quicksand","water","visited","Uint8Array","dirs","regionTiles","queue","_addRegion","tileIndices","mask","worldW","worldH","Set","bleed","_createLavaTexture","_createQuicksandTexture","_createWaterfallTexture","_createLavaWaterfallTexture","_createRadioactiveWaterfallTexture","_createRadioactiveWaterTexture","_createWaterTexture","source","addressMode","tiling","detailTex1","detailTex2","_createLavaDetailTexture","_createQuicksandDetailTexture","_createWaterDetailTexture","bgMask","minY","maxY","bottomColor","_createGradientTexture","bgSprite","Sprite","_computeTopEdgeSpans","_computeBottomEdgeSpans","topColor","createLinearGradient","addColorStop","fillStyle","fillRect","globalAlpha","beginPath","arc","sw","sh","tilesByRow","above","rowList","cols","entries","sort","start","prev","below","addWave","HealthBar","options","super","offsetX","offsetY","thresholds","ok","trackColor","borderColor","borderAlpha","_w","_h","_pct","_color","_thresholds","_colors","_trackColor","_borderColor","_borderAlpha","_track","_fill","_redrawAll","visible","c","pct","_redrawFill","roundRect","innerW","freeze","parallax","tiles","tilesAnim","liquidBackground","objBehind","secretsBelow","objFront","secretsAbove","weather","fog","liquids","liquidFx","textureCacheMap","getTexture","msToSpeed","ms","getRegItem","isWaterDef","isLavaDef","isWaterfallDef","isLavaWaterfallDef","isRadioactiveWaterDef","isRadioactiveWaterfallDef","ParallaxBackground","textureCache","cache","imgSprite","_worldW","_worldH","_lastCameraX","_currentUrl","worldWidth","worldHeight","factor","minWidth","minHeight","hex","parseInt","slice","solid","WHITE","tint","setupImage","baseTexture","wrapMode","WRAP_MODES","REPEAT","texH","scaleY","setScroll","Assets","valid","load","then","loadedTex","catch","err","cameraX","buildSpriteFromDef","spr","frames","Boolean","AnimatedSprite","play","editorIcon","Text","dropShadow","dropShadowColor","dropShadowBlur","dropShadowDistance","anchor","createPlayerContainer","playerVisuals","playerContainer","defaultDef","targetDef","defSprite","hitSprite","healthBar","sprites","hit","setPreferences","skipCacheIdWarning","preferCreateImageBitmap","EMPTY_ARRAY","EMPTY_OBJECT","PixiStage","backgroundImage","weatherLavaRain","weatherRadioactiveFog","weatherMeteorRain","isEditor","isEditorPlayMode","showGrid","renderLayers","pointerEvents","onWeatherEffectHit","isPixiReady","setIsPixiReady","mountRef","appRef","parallaxRef","parallaxManagerRef","cameraScrollRef","parallaxFactorRef","cameraPosRef","bgRef","bgAnimRef","bgImageRef","bgColorRef","objBehindRef","objFrontRef","secretLayerRef","playerRef","playerLayerRef","playerSpriteRefs","playerHealthBarRef","playerStateRef","weatherLayerRef","liquidLayerRef","liquidBgLayerRef","liquidSystemRef","fogLayerRef","weatherSystemsRef","rain","snow","clouds","thunder","lavaRain","radioactiveFog","meteorRain","weatherPropsRef","projectilesLayerRef","projectileSpritesRef","entitiesLayerRef","entitySpritesRef","projectilesPropRef","pixiTextureCacheRef","hbEnabledRef","oxyEnabledRef","lavaEnabledRef","overlayLayerRef","underwaterRef","overlayHBRef","oxygenBarRef","lavaBarRef","waterFxRef","lavaEmbersRef","lavaSteamRef","splashesEnabledRef","embersEnabledRef","waterStateRef","headUnder","gridRef","showGridRef","resolveBackgroundUrl","useMemo","createBackgroundResolver","bgContext","metaPath","split","createSolidChecker","wx","wy","collision","top","bottom","left","right","rebuildParallax","useCallback","layer","createParallaxManager","parallaxLayer","textureCacheRef","parallaxHelper","parallaxSprite","resolvedUrl","helper","bgUrl","bgColor","screen","destroyed","async","app","Application","resizeTo","backgroundAlpha","antialias","autoDensity","renderer","stage","sortableChildren","bg","bgAnim","secretBelowLayer","secretAboveLayer","playerLayer","entitiesLayer","weatherLayer","liquidBgLayer","liquidLayer","liquidFxLayer","fogLayer","projLayer","overlayLayer","LAYERS","gridGraphics","allLayersMap","objects","layerName","layers","l","urlSet","addUrl","add","urls","playerComponents","innerHTML","appendChild","hbOverlay","oxyColors","oxyBar","lavaColors","lvBar","preventDefault","ticker","updatePlayerSprite","refs","inLava","effectiveWidth","isHit","dir","mag","scale","camX","camY","pivot","position","deltaMS","systems","swNow","shNow","sNow","overlayL","showOverlay","overlayColor","maxTargetAlpha","pulseBase","fadeSpeed","lastLiquidType","fadeOutSpeed","nowInWater","nowLiquid","sy","s2","effW","effH","baseYOffset","baseX","baseY","hbO","show","nextBarY","maxOxy","curOxy","maxLv","curLv","syncProjectiles","projectilesLayer","projectileSpritesMap","projectilesList","list","seen","defId","syncEntities","entitySpritesMap","entitiesList","ent","_lastFrameIndex","isTextureReady","spriteSheet","columns","frameIndex","currentSpriteIndex","texWidth","texHeight","totalSprites","effectiveColumns","frameWidth","frameHeight","col","row","Rectangle","frame","targetWidth","targetHeight","isNaN","absScaleX","entities","appToDestroy","values","cleanupProjectiles","cleanupEntities","active","rebuildLayers","safeDestroy","removeChildren","child","secretOverlayTilesBelow","secretOverlayTilesAbove","secretId","secretDef","secretSubtype","subtype","isInOpenArea","isInSecretArea","isSecretRevealed","filterColor","filterColorInGame","renderAbove","renderAbovePlayer","renderOnSecretLayer","backingSprite","backing","isPushable","visualElement","healthPercent","frameTexture","isWeatherTrigger","isMessageTrigger","isWolfSecret","shouldShowAnyway","isHiddenInGame","isDestructible","hb","match","parseFloat","pLayer","tileDataString","prevTileDataString","_lastTileData","prepare","upload","runRebuild","yy","getRainIntensity","getSnowIntensity","getCloudsIntensity","getThunderIntensity","getFogIntensity","getLavaRainIntensity","getRadioactiveFogIntensity","getMeteorRainIntensity","propTypes","PropTypes","isRequired","floodFillSecretZone","startIndex","startSecretId","startDef","result","checkSecretDetection","currentX","currentY","playerLeft","playerRight","playerTop","playerBottom","minGX","maxGX","minGY","maxGY","revealOnEnter","connectedIndices","newIndices","triggerIndex","triggerSecretId","triggerSubtype","totalConnected","newToReveal","firstFiveNew","connectedSecretIds","beepFallback","vol","AC","AudioContext","webkitAudioContext","audioCtxRef","audioCtx","resume","currentTime","createOscillator","gain","createGain","frequency","setValueAtTime","exponentialRampToValueAtTime","connect","destination","stop","moveHorizontal","MOVE_SPEED","checkCollision","friction","acceleration","targetVx","sign","proposedX","step","safeX","nextX","applyVerticalPhysics","GRAVITY","TERMINAL_VELOCITY","JUMP_FORCE","isLiquidAt","prevInWater","liqBuoyancy","liqDragY","liqTerminal","swimImpulseMult","activeLiquidType","headY","chestY","feetLiq","chestLiq","space","swimImpulse","getLiquidAtPixel","mapWidthTiles","mapHeightTiles","tileData","params","buoyancy","dragX","drag","dragY","swimmable","dps","damagePerSecond","drainPerSecond","regenPerSecond","damagePerSecondWhenDepleted","resistance","sampleLiquidForAABB","feet","chest","head","candidate","inLiquid","tickLiquidDamage","deltaMs","accRef","gameState","HIT_FLASH_MS","updateFrame","objectData","input","constants","helpers","isInitialized","lastTimeRef","projectilesRef","entitiesRef","shootCooldownRef","liquidDamageAccumulatorRef","oxygenDepleteAccRef","lavaDepleteAccRef","weatherDamageAccRef","getLiquidSample","collectItem","checkInteractables","checkHazardDamage","checkSecrets","spawnProjectile","playSfx","updateProjectiles","setPlayer","onGameOver","continue","iceResist","maxIceResist","backgroundLayer","getSurfaceProperties","isSlippery","currentIceRes","maxIce","effectiveFriction","ratio","targetFriction","checkCollisionExtended","isPushing","pushTarget","currentStrength","isAlreadyAtMax","lastPushTime","pushDist","overlapDist","isNextToLeft","isNextToRight","pushForce","sounds","lastPushSoundTime","vp","liquidParams","sample","maxLava","oxy","lavaRes","oxyParams","lavaParams","maxRadio","maxRadioactivity","radio","radioactivity","tickDepleteDps","dpsValue","lavaRainInt","radioFogInt","totalWeatherDps","currentAmmo","mouseLeft","playerX","playerY","entity","isExploding","animFrame","animTimer","totalFrames","animations","explode","frameDuration","shouldRemove","liquidSample","liquidDamageAcc","weatherDamageAcc","prevInLiquid","water_splash","lava_splash","ew","eh","sinkingSpeed","fallDistance","other","kill_enemy","isRound","checkEmpty","tx","ty","leftX","rightX","idle","mapW","mapH","arrowId","foundArrowDef","arrowsLayer","aDef","nextY","ai","reactionDist","reactionDistance","shootDist","shootDistance","sqrt","canJump","shootCooldown","isShooting","spawnX","spawnY","patrol","hitSomething","stayOnPlatform","groundX","groundY","frameSpeed","checkEntityCollision","explodeAnim","anims","currentAnim","frameDur","updateEntities","knockbackDir","onStateUpdate","damage","maxX","winCountSpeed","onIce","isSolidAtPixel","secretData","ignoreEntityId","objId","objDef","isEntity","toLowerCase","passableHealthThreshold","tileId","tileDef","newX","newY","feetY","slipperiness","errorListeners","logLevel","setLogLevel","level","addListener","callback","removeListener","cb","notifyListeners","context","handle","errorObj","String","logData","message","stack","shouldLog","toUpperCase","sendToLoggingService","levels","debug","currentLevel","wrapAsync","fn","args","wrapSync","parseBool","trim","useGameEngine","onRevealSecret","useInput","clearKeys","handleKeyDown","tag","tagName","typing","isContentEditable","repeat","handleMouseDown","handleMouseUp","handleKeyUp","onToggleTerminal","passive","requestRef","hazardDamageAccumulatorRef","lastHazardIndexRef","triggeredHazardsRef","projectileIdRef","soundEnabledRef","audioCtxUnlockedRef","onStateUpdateRef","onRevealSecretRef","onGameOverRef","objectMetadataRef","revealedSecretsRef","onToggle","onUserGesture","playShotSfx","audio","Audio","pause","once","checkHazardDamageWrapper","objectLayerData","candidates","pushCandidate","touch","damageDirections","tileLeft","tileRight","tileTop","tileBottom","touchMargin","touchingTop","touchingBottom","touchingLeft","touchingRight","distTop","distBottom","distLeft","distRight","sideScore","chosen","prevIndex","damageOnce","baseDamage","immediate","TICK_MS","errorHandler","component","function","playerPosition","damageType","localRevealedRef","handleWeatherEffectHitWrapper","handleWeatherEffectHit","edx","edy","edist","onHit","lastMapIdRef","currentMapId","projectName","activeMapId","date_map_last_updated","date_map_created_at","isNewMapLoad","initialEntities","objLayer","spawnTriggerId","findIndex","triggerId","startX","startY","playerId","registryPlayer","maxXAtStart","mapHeightParam","widthOverride","heightOverride","ignoreId","checkCollisionExternal","TILE_SIZE_OVERRIDE","tileDataOverride","registryItemsOverride","secretDataOverride","objectDataOverride","objectMetadataOverride","isSolidAtPixelExternal","originX","originY","ownerId","pDef","lifespan","ricochetFlag","ricochetOnTiles","collisionWithPenetration","proj","cwt","collisionWithTiles","hbs","hitboxScale","ric","dmg","spawnProjectileExternal","td","ri","getLiquidTypeAtPixel","liq","sampleLiquid","aabb","objectLayer","centerY","gridX","itemId","itemDef","pickup","effect","healthBonus","newHealth","fireball","ammoBonus","gridY","frontX","frontIndex","frontObjId","frontDef","foundIndex","idxStr","ox","oy","actualIndex","currentMeta","weatherType","weatherAction","lastWeatherTrigger","lastMessageTrigger","duration","lastETime","moveX","moveY","targetMapId","destId","destMeta","usedInteractables","checkSecretsWrapper","mergedRevealed","indicesToReveal","dtProj","isSolidRect","hw","hh","pts","checkObjectHit","checkEntityHit","ex","ey","checkPlayerHit","maxBounces","bounceDamp","bounceDamping","ricRand","ricochetRandom","maxDelta","steps","stepTime","removed","hitEntX","hitIdxX","sp","hypot","jitter","hitEntY","hitIdxY","res","requestAnimationFrame","cancelAnimationFrame","HeaderContainer","AmmoDisplay","RightSection","BarsContainer","BarRow","BarWrapper","BarFill","attrs","$percent","$color","BarLabel","GameHeader","hpPercent","oxyPercent","lavaPercent","icePercent","strengthPercent","radioPercent","commands","register","cmd","listCommands","description","executeCommand","raw","handler","panelStyleBase","fontFamily","borderTop","boxShadow","transition","GameTerminal","open","setOpen","lines","setLines","setInput","scrollRef","inputRef","suppressUntilRef","onClear","onClose","performance","setTimeout","focus","onKey","scrollTop","scrollHeight","transform","borderBottom","flex","overflowY","whiteSpace","lineHeight","onSubmit","onKeyDown","stopPropagation","onChange","placeholder","outline","cursor","GameSettings","activeTab","setActiveTab","setParallax","__GAME_RUNTIME_SETTINGS__","setRain","ls","setSnow","setClouds","lsNew","lsOld","setThunder","setFog","setLavaRain","setRadioactiveFog","setMeteorRain","setHealthBarEnabled","setOxygenBarEnabled","setLavaBarEnabled","setWaterSplashesEnabled","setLavaEmbersEnabled","minimized","setMinimized","pos","setPos","setSize","draggingRef","clampPos","sz","isMin","vw","innerWidth","vh","innerHeight","maxL","maxT","onSettingsUpdate","patch","onOpen","onMove","clientX","clientY","onUp","onResize","emitUpdate","panelStyle","userSelect","contentStyle","buttonStyle","marginLeft","tabsBarStyle","overflowX","onMouseDown","onMinToggle","tab","marginBottom","defaultValue","_Fragment","textAlign","toFixed","defaultChecked","marginTop","checked","startW","startH","move","ev","dw","dh","nw","nh","up","BackgroundMusicPlayer","audioRef","currentSrcRef","musicContext","cleanup","resolveUrl","loop","onGesture","val","BUILT_IN_MAPS","GameContainer","ModalOverlay","ModalContent","ModalTitle","h2","MapList","MapCard","MapTitle","MapAuthor","MapDescription","MapInfo","WinCounterOverlay","GameOverOverlay","GameOverTitle","h1","ReplayButton","ModalDivider","FileUploadLabel","label","HiddenFileInput","Viewport","$blurred","GameCanvas","PlaceholderMessage","MessageOverlay","$isVisible","Game","viewportRef","runtimeSettings","setRuntimeSettings","gameMessage","setGameMessage","isVisible","messageTimerRef","handleStateUpdate","currentId","projectToLoad","loadMapData","currentIdx","remainingDx","remainingDy","moveStep","stepX","stepY","targetIndex","targetObjId","extraX","extraY","alert","settingKey","charAt","clearTimeout","handleGameOver","indices","handleOpenModalEvent","weatherFogLegacy","effectiveMapData","version","activeId","activeMap","backgroundMusic","objData","bgLayer","secretLayer","mapName","dimensions","handleReplay","mapToLoad","isV2","author","sizeInfo","subMapInfo","mainMap","mapValues","accept","file","files","fileReader","FileReader","readAsText","onload","loaded","fileName","onerror","contents","suggestedName","mimeType","showSaveFilePicker","types","writable","createWritable","blob","Blob","write","close","link","href","URL","createObjectURL","download","body","click","revokeObjectURL","applyMapData","setMapWidth","setMapHeight","setMapName","setCreatorName","setMapDescription","setCreatedAt","setSelectedBackgroundImage","setSelectedBackgroundColor","setBackgroundParallaxFactor","setSelectedBackgroundMusic","setPlayerPosition","setTileMapData","setObjectMapData","setSecretMapData","setObjectMetadata","setWeatherRain","setWeatherSnow","setWeatherClouds","setWeatherFog","setWeatherThunder","setWeatherLavaRain","setWeatherRadioactiveFog","setWeatherMeteorRain","setMaps","setActiveMapId","mapId","selectedBackgroundImage","selectedBackgroundColor","selectedBackgroundMusic","worldY","date_created","ObjectLinks","React","links","portals","targets","x1","y1","x2","y2","strokeWidth","strokeDasharray","opacity","AnimatedItem","setIndex","interval","setInterval","clearInterval","imgSrc","total","rows","maxWidth","maxHeight","draggable","EditorTile","activeTool","tileObj","objObj","secretObj","isHighlighted","parentRegionIndex","borderStyle","bgStyle","handleGridMouseDown","handleGridMouseEnter","handleResizeStart","handleMoveStart","isLiquidTile","isWaterTile","isLavaTile","isQuicksandTile","isWaterfallTile","isLavaWaterfallTile","isRadioactiveWaterTile","isRadioactiveWaterfallTile","isResizable","hasObjectOrSecret","onMouseEnter","boxSizing","objectFit","filterColorInEditor","hasIntensity","selectedBackgroundUrl","showBackgroundImage","activeLayer","hoverIndex","highlightedIndex","brushSize","bucketPreviewIndices","selection","previewPosition","dragStart","isDragging","handleGridMouseUp","handleGridMouseLeave","setIsDragging","selectedTile","isEraserActive","isBrushActive","isBucketActive","regions","getLayerColor","getLayerFilter","onMouseUp","onMouseLeave","backgroundRepeat","backgroundSize","getGridStyles","gridTemplateColumns","gridTemplateRows","_","dTileId","dObjId","dSecId","layerColor","hx","hy","minX","selX","selY","originalX","originalY","parentRegion","EditorToolsContainer","HeaderBar","ToolsSection","ToolsGroup","ToolsInnerGroup","ToolsRow","ToolsEditorButton","$variant","$small","$square","$disabled","StrikeThrough","LayerIndicator","$bgColor","$borderColor","$textColor","BgColorContainer","BgColorInputWrapper","BgColorInput","disabled","PlayButtonContainer","PlayButtonInner","InfoContainer","InfoItem","InfoLabel","span","InfoValue","EraserButtonContainer","EraserButtonInner","SelectionActions","ConfirmButton","CancelButton","GridIcon","SidebarContainer","ElementEditorButton","PanelContainer","$isOpen","PanelHeader","PanelBody","CloseButton","OperationButton","$danger","OperationLabel","NewMapModal","isOpen","tempMapName","setTempMapName","tempCreatorName","setTempCreatorName","tempMapDescription","setTempMapDescription","confirmNewMap","ModalHeader","BuiltInMapsModal","onSelect","DraggableWindow","defaultPosition","defaultWidth","isOpenDefault","onHeightChange","dragOffset","setDragOffset","currentPosition","setCurrentPosition","isMinimized","setIsMinimized","isClosed","setIsClosed","hasBeenDragged","setHasBeenDragged","windowRef","lastHeightRef","offsetHeight","handleMouseMove","getBoundingClientRect","EditorMapResizer","containerRef","startSize","setStartSize","startMousePos","setStartMousePos","displayWidth","displayHeight","blocksX","blocksY","newWidth","newHeight","Minimap","canvasRef","minimapWidth","minimapHeight","tileWidth","tileHeight","objectId","tile","obj","strokeStyle","lineWidth","portal","setLineDash","imageRendering","WorldView","switchMap","currentMapData","createMap","deleteMap","updateMapData","mapLayoutsRef","dragRef","allMaps","draw","layouts","layout","tileW","tileH","strokeRect","font","fillText","sourceLayout","sourceMap","sx","targetLayout","targetMap","tw","th","tTileW","tTileH","tObjId","tMeta","endX","cp1X","cp1Y","cp2X","cp2Y","bezierCurveTo","angle","save","translate","rotate","closePath","restore","btnX","btnY","confirm","mapStartX","mapStartY","onMouseMove","BackgroundPanel","backgroundOptions","paddingTop","MusicPanel","musicOptions","fontStyle","WeatherPanel","weatherItems","setter","icon","SceneEditorButton","RightSidebarContainer","EditorScene","handleMapResize","isResizeWindowOpen","setIsResizeWindowOpen","isMinimapOpen","setIsMinimapOpen","isWorldViewOpen","setIsWorldViewOpen","setIsSettingsOpen","isBackgroundOpen","setIsBackgroundOpen","isMusicOpen","setIsMusicOpen","OperationsPanel","openNewMapModal","saveMap","loadMap","openBuiltInModal","clearMap","creatorName","mapDescription","inputStyle","handleFocus","handleBlur","onFocus","onBlur","CollapsiblePanel","setIsOpen","PalettePanel","isPlayMode","category","blocks","decorations","interactables","hazards","secrets","messages","alternativeSecrets","obstacles","handlePaletteSelect","renderPaletteItem","hasImage","isLiquid","isWater","isQuicksand","isWaterfall","isLavaWaterfall","isRadioactive","radioactive","isRadioactiveWaterfall","isSecret","swatchStyle","displayName","flexWrap","li","StatisticsPanel","totalTiles","filledBlocks","objectsCount","emptyBlocks","ObjectPropsPanel","setHighlightedIndex","mapList","listRef","highlightedElement","querySelector","scrollIntoView","behavior","block","isWeather","isMessage","isPortalOrTarget","el","scrollX","clientWidth","scrollY","clientHeight","scrollTo","EditorElements","activePanel","setActivePanel","togglePanel","lastPanel","setLastPanel","displayPanel","stats","EditorTools","setShowGrid","handlePlay","handlePause","handleReset","setActiveTool","setBrushSize","moveSelection","selectionMode","setSelectionMode","commitSelection","cancelSelection","setShowBackgroundImage","tool","mode","isDisabled","roman","getLayerIndicatorData","object","secret","textColor","getEraserData","useEditorOperations","createdAt","setIsNewMapModalOpen","handleSaveMap","currentDate","projectData","date_last_updated","statistics","total_tiles","filled_tiles","total_objects","json","saveFile","mapsCount","handleLoadMap","setters","handleLoadBuiltInMap","loadBuiltInMap","handleClearMap","getFloodFillIndices","currentData","startId","matchingIndices","useEditorPainting","setSelection","setPreviewPosition","setOriginalMapData","setDragStart","setHoverIndex","setBucketPreviewIndices","resizeState","setResizeState","moveState","setMoveState","bucketTimerRef","paintTile","isPropsLayer","targetLayer","setTargetData","newData","newMetadata","metadataChanged","targetX","paintTileUtil","edge","existingObjId","existingSecretId","targetData","targetValue","newValue","floodFill","targetId","affectedIndices","metaChanged","newMeta","handleGridMouseMove","curX","curY","newW","newH","newIndex","selectionMetadata","tileMap","objectMap","secretMap","Editor","setSelectedTile","setActiveLayer","stateRef","isNewMapModalOpen","isBuiltInMapsModalOpen","setIsBuiltInMapsModalOpen","loadBackgroundOptions","loadMusicOptions","createNewMap","useEditorMaps","existingMaps","newMap","newMaps","newMapId","nextMap","handleCreateMap","prompt","timeout","selectedBgOption","useEditorRegistry","originalMapData","useEditorSelection","newTileMap","newObjectMap","newSecretMap","newObjectMetadata","destX","destY","destIdx","srcDataIdx","playModeObjectData","playModeSecretData","playModeWeather","gameEngineState","useEditorPlayMode","setIsPlayMode","setIsGameOver","restartCounter","setRestartCounter","editorSnapshot","setEditorSnapshot","setRevealedSecrets","setPlayModeObjectData","setPlayModeSecretData","setPlayModeWeather","lastSyncedMapIdRef","engineInitId","currentPlayObjectData","playData","spawnIndex","currentPlaySecretData","mapDataForGame","prevTiles","newTiles","prevObjs","newObjs","prevMeta","handleRevealSecret","secretIndex","resetData","panel","resizeMapData","oldW","oldH","oldTiles","oldObjs","oldSecrets","oldMeta","resizeArray","oldArr","newArr","oldM","newM","oldIdx","newIdx","resizeMetadata","Crystals","Repository","cardStyle","imageStyle","fieldsContainerStyle","onError","wordBreak","ReactDOM","getElementById","render","Provider","store","ThemeProvider","theme","GlobalStyles","BrowserRouter","basename","Routes","Route","element","App"],"ignoreList":[],"sourceRoot":""}