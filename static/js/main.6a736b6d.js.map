{"version":3,"file":"static/js/main.6a736b6d.js","mappings":"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","sources":["webpack://element_masters/./src/assets/sound/background/ sync nonrecursive \\.ogg$","webpack://element_masters/./src/assets/images/ sync \\.(png%7Cjpe","webpack://element_masters/./src/store/slices/gameSlice.js","webpack://element_masters/./src/constants/gameConstants.js","webpack://element_masters/./src/store/slices/playerSlice.js","webpack://element_masters/./src/store/slices/settingsSlice.js","webpack://element_masters/./src/store/slices/uiSlice.js","webpack://element_masters/./src/store/index.js","webpack://element_masters/./src/styles/theme.js","webpack://element_masters/./src/styles/GlobalStyles.js","webpack://element_masters/./src/i18n/i18n.js","webpack://element_masters/./src/sections/section.header.navigation.chapters.js","webpack://element_masters/./src/sections/section.header.navigation.languages.js","webpack://element_masters/./src/sections/section.header.navigation.logo.js","webpack://element_masters/./src/sections/section.header.js","webpack://element_masters/./src/sections/section.footer.js","webpack://element_masters/./src/sections/section.content.js","webpack://element_masters/./src/engine/registry/index.js","webpack://element_masters/./src/App.js","webpack://element_masters/./src/sections/chapters/home.jsx","webpack://element_masters/./src/Pixi/TextureCache.js","webpack://element_masters/./src/Pixi/effects/weather/Rain.js","webpack://element_masters/./src/Pixi/effects/weather/Snow.js","webpack://element_masters/./src/Pixi/effects/weather/Clouds.js","webpack://element_masters/./src/Pixi/effects/weather/Fog.js","webpack://element_masters/./src/Pixi/effects/weather/Thunder.js","webpack://element_masters/./src/Pixi/effects/liquids/WaterSplashFX.js","webpack://element_masters/./src/Pixi/effects/liquids/LavaEmbers.js","webpack://element_masters/./src/Pixi/effects/liquids/LavaSteamFX.js","webpack://element_masters/./src/Pixi/effects/liquids/LiquidRegionSystem.js","webpack://element_masters/./src/Pixi/ui/HealthBar.js","webpack://element_masters/./src/renderer/stage/layers/LayerOrder.js","webpack://element_masters/./src/sections/chapters/game/PixiStage/helpers.js","webpack://element_masters/./src/sections/chapters/game/PixiStage/liquidRendering.js","webpack://element_masters/./src/Pixi/layers/ParallaxBackground.js","webpack://element_masters/./src/sections/chapters/game/PixiStage/parallaxManager.js","webpack://element_masters/./src/sections/chapters/game/PixiStage/playerManager.js","webpack://element_masters/./src/sections/chapters/game/PixiStage/layerBuilder.js","webpack://element_masters/./src/sections/chapters/game/PixiStage/index.jsx","webpack://element_masters/./src/sections/chapters/game/PixiStage/projectileManager.js","webpack://element_masters/./src/sections/chapters/game/PixiStage/entityManager.js","webpack://element_masters/./src/engine/gameplay/secrets.js","webpack://element_masters/./src/engine/audio/audio.js","webpack://element_masters/./src/engine/physics/horizontal.js","webpack://element_masters/./src/engine/physics/vertical.js","webpack://element_masters/./src/engine/liquids/liquidUtils.js","webpack://element_masters/./src/engine/loop/updateFrame.js","webpack://element_masters/./src/engine/gameplay/entities.js","webpack://element_masters/./src/engine/physics/collision.js","webpack://element_masters/./src/services/errorHandler.js","webpack://element_masters/./src/utilities/useGameEngine.js","webpack://element_masters/./src/utilities/useInput.js","webpack://element_masters/./src/engine/gameplay/hazards.js","webpack://element_masters/./src/engine/gameplay/spawnProjectile.js","webpack://element_masters/./src/engine/gameplay/collectItem.js","webpack://element_masters/./src/engine/gameplay/interactables.js","webpack://element_masters/./src/engine/gameplay/updateProjectiles.js","webpack://element_masters/./src/sections/chapters/game/GameHeader.jsx","webpack://element_masters/./src/commands/gameCommands.js","webpack://element_masters/./src/sections/chapters/game/GameTerminal.jsx","webpack://element_masters/./src/sections/chapters/game/GameSettings.jsx","webpack://element_masters/./src/utilities/BackgroundMusicPlayer.jsx","webpack://element_masters/./src/sections/chapters/game/index.jsx","webpack://element_masters/./src/utilities/saveFile.js","webpack://element_masters/./src/sections/chapters/editor/paintingTools.js","webpack://element_masters/./src/utilities/AnimatedItem.jsx","webpack://element_masters/./src/sections/chapters/editor/Viewport.jsx","webpack://element_masters/./src/sections/chapters/editor/constants.js","webpack://element_masters/./src/sections/chapters/editor/NewMapModal.jsx","webpack://element_masters/./src/sections/chapters/editor/DraggableWindow.jsx","webpack://element_masters/./src/sections/chapters/editor/PaletteSection.jsx","webpack://element_masters/./src/sections/chapters/editor/Minimap.jsx","webpack://element_masters/./src/sections/chapters/editor/MapResizer.jsx","webpack://element_masters/./src/sections/chapters/editor/ToolbarWindows.jsx","webpack://element_masters/./src/sections/chapters/editor/index.jsx","webpack://element_masters/./src/sections/chapters/editor/assetLoaders.js","webpack://element_masters/./src/sections/chapters/editor/mapOperations.js","webpack://element_masters/./src/sections/chapters/crystals.jsx","webpack://element_masters/./src/sections/chapters/repository.jsx","webpack://element_masters/./src/index.js","webpack://element_masters/./src/assets/sound/ sync \\.(mp3%7Cwav%7Cogg%7Cm4a%7Caac%7Cflac%7Cwebm)$","webpack://element_masters/./src/assets/json/ sync \\.json$","webpack://element_masters/./src/assets/background/ sync nonrecursive \\.(png%7Cjpe"],"sourcesContent":["var map = {\n\t\"./170515__rolandasb__forest_ambient_01_loop.ogg\": 344,\n\t\"./830253__nicktayloe__afternoon-woods-in-october-midwest-us-loop.ogg\": 3004\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 1032;","var map = {\n\t\"./blocks/block_pack_01/dirt_block_0002.png\": 1006,\n\t\"./blocks/block_pack_01/dirt_block_0003.png\": 2967,\n\t\"./blocks/block_pack_01/dirt_block_0004.png\": 7800,\n\t\"./blocks/block_pack_01/dirt_block_0005.png\": 2017,\n\t\"./blocks/block_pack_01/dirt_block_0006.png\": 1850,\n\t\"./blocks/block_pack_01/ice_block_0001.png\": 9745,\n\t\"./blocks/desert_pack_01/desert_pack_0001.png\": 7741,\n\t\"./blocks/desert_pack_01/desert_pack_0002.png\": 182,\n\t\"./blocks/desert_pack_01/desert_pack_0003.png\": 1727,\n\t\"./blocks/desert_pack_01/desert_pack_0004.png\": 6352,\n\t\"./blocks/desert_pack_01/desert_pack_0005.png\": 2601,\n\t\"./blocks/desert_pack_01/desert_pack_0006.png\": 6018,\n\t\"./blocks/desert_pack_01/desert_pack_0007.png\": 6523,\n\t\"./blocks/desert_pack_01/desert_pack_0008.png\": 5132,\n\t\"./blocks/desert_pack_01/desert_pack_0009.png\": 1045,\n\t\"./blocks/diorite_block.png\": 8276,\n\t\"./blocks/dirt_block_0001.png\": 7157,\n\t\"./blocks/grass_block_0001.png\": 1764,\n\t\"./blocks/sand_block_0001.png\": 2250,\n\t\"./blocks/sand_block_0002.png\": 2145,\n\t\"./blocks/water_block.png\": 1635,\n\t\"./decorations/stone_pack_01/stone_pack_01_001.png\": 1978,\n\t\"./decorations/stone_pack_01/stone_pack_01_002.png\": 4526,\n\t\"./decorations/stone_pack_01/stone_pack_01_003.png\": 7928,\n\t\"./decorations/stone_pack_01/stone_pack_01_004.png\": 9447,\n\t\"./decorations/stone_pack_01/stone_pack_01_005.png\": 1134,\n\t\"./decorations/stone_pack_01/stone_pack_01_006.png\": 8485,\n\t\"./decorations/stone_pack_01/stone_pack_01_007.png\": 3036,\n\t\"./decorations/stone_pack_01/stone_pack_01_008.png\": 7195,\n\t\"./decorations/stone_pack_01/stone_pack_01_009.png\": 9330,\n\t\"./decorations/stone_pack_01/stone_pack_01_010.png\": 2952,\n\t\"./entities/player/player_dead_01.png\": 2735,\n\t\"./entities/player/player_dead_02.png\": 2820,\n\t\"./entities/player/player_dead_03.png\": 5325,\n\t\"./entities/player/player_dead_04.png\": 3762,\n\t\"./entities/player/player_dead_05.png\": 2763,\n\t\"./entities/player/player_dead_06.png\": 7728,\n\t\"./entities/player/player_dead_07.png\": 8905,\n\t\"./entities/player/player_dead_08.png\": 3662,\n\t\"./entities/player/player_dead_09.png\": 1351,\n\t\"./entities/player/player_dead_10.png\": 1297,\n\t\"./entities/player/player_default_100.A.png\": 6847,\n\t\"./entities/player/player_default_100.B.png\": 4388,\n\t\"./entities/player/player_target_100.A.png\": 2155,\n\t\"./entities/player/player_target_100.B.png\": 8336,\n\t\"./entities/tanks/tank_0000.png\": 2386,\n\t\"./entities/tanks/tank_0001.png\": 3563,\n\t\"./entities/tanks/tank_0002.png\": 5232,\n\t\"./hazards/bushes_001.png\": 6343,\n\t\"./hazards/death_block_0001.png\": 3527,\n\t\"./interactables/arrows/arrow_down.png\": 7152,\n\t\"./interactables/arrows/arrow_left.png\": 8047,\n\t\"./interactables/arrows/arrow_right.png\": 592,\n\t\"./interactables/arrows/arrow_up.png\": 7263,\n\t\"./interactables/berry_bush_01_A.png\": 2534,\n\t\"./interactables/berry_bush_01_B.png\": 4157,\n\t\"./interactables/berry_bush_02_A.png\": 3945,\n\t\"./interactables/berry_bush_02_B.png\": 7858,\n\t\"./interactables/ends/end_0001.png\": 8597,\n\t\"./interactables/platforms/platform_0001.png\": 9427,\n\t\"./interactables/portals/portal_01/portal_A_001.png\": 8518,\n\t\"./interactables/portals/portal_01/portal_A_002.png\": 3933,\n\t\"./interactables/portals/portal_01/portal_A_003.png\": 692,\n\t\"./interactables/portals/portal_01/portal_A_004.png\": 5499,\n\t\"./interactables/portals/portal_01/portal_A_005.png\": 3954,\n\t\"./interactables/portals/portal_01/portal_A_006.png\": 8489,\n\t\"./interactables/portals/portal_01/portal_A_007.png\": 4288,\n\t\"./interactables/portals/portal_01/portal_A_008.png\": 8519,\n\t\"./interactables/portals/portal_01/portal_A_009.png\": 2734,\n\t\"./interactables/portals/portal_01/portal_A_010.png\": 3124,\n\t\"./interactables/portals/portal_01/portal_A_011.png\": 4253,\n\t\"./interactables/portals/portal_01/portal_A_012.png\": 6838,\n\t\"./interactables/portals/portal_01/portal_A_013.png\": 5583,\n\t\"./interactables/portals/portal_01/portal_A_014.png\": 9712,\n\t\"./interactables/portals/portal_01/portal_A_015.png\": 5465,\n\t\"./interactables/portals/portal_01/portal_A_016.png\": 1458,\n\t\"./interactables/wooden_box_0001.png\": 1169,\n\t\"./items/fireball_basic_A.png\": 9240,\n\t\"./items/fireball_basic_B.png\": 4851,\n\t\"./items/fireball_basic_C.png\": 9290,\n\t\"./items/fireball_basic_D.png\": 9717,\n\t\"./items/hertz_item.A.png\": 7720,\n\t\"./items/hertz_item.B.png\": 3475,\n\t\"./projectiles/fireball_basic_A.png\": 9792,\n\t\"./projectiles/fireball_basic_B.png\": 1083,\n\t\"./projectiles/fireball_basic_C.png\": 9954,\n\t\"./projectiles/fireball_basic_D.png\": 4205\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 1621;","/**\n * Game Slice\n * Manages game-level state (maps, registry, game status)\n */\n\nimport { createSlice } from '@reduxjs/toolkit';\n\nconst initialState = {\n  activeMapData: null,\n  tileMapData: [],\n  objectMapData: [],\n  secretMapData: [],\n  objectMetadata: {}, // Track metadata per object position { index: { health: 100, etc } }\n  revealedSecrets: [], // Track which secret zones have been revealed (array of indices)\n  objectTextureIndices: {}, // Track texture index per object position { index: textureIndex }\n  mapWidth: 20,\n  mapHeight: 15,\n  isLoading: false,\n  error: null,\n  isPaused: false,\n  isGameOver: false,\n};\n\nconst gameSlice = createSlice({\n  name: 'game',\n  initialState,\n  reducers: {\n    setActiveMap: (state, action) => {\n      const { mapData, tileMapData, objectMapData, secretMapData, mapWidth, mapHeight } = action.payload;\n      state.activeMapData = mapData;\n      state.tileMapData = tileMapData;\n      state.objectMapData = objectMapData;\n      state.secretMapData = secretMapData || [];\n      state.objectMetadata = mapData?.meta?.objectMetadata || {}; // Load initial metadata from map\n      state.revealedSecrets = []; // Reset revealed secrets on new map\n      state.objectTextureIndices = {}; // Reset texture indices on new map\n      state.mapWidth = mapWidth;\n      state.mapHeight = mapHeight;\n      state.isGameOver = false;\n    },\n    updateObjectMap: (state, action) => {\n      state.objectMapData = action.payload;\n    },\n    updateObjectMetadata: (state, action) => {\n      const { index, metadata } = action.payload;\n      state.objectMetadata[index] = {\n        ...(state.objectMetadata[index] || {}),\n        ...metadata\n      };\n    },\n    removeObjectAtIndex: (state, action) => {\n      const index = action.payload;\n      if (state.objectMapData[index] !== undefined) {\n        state.objectMapData[index] = null;\n      }\n    },\n    updateObjectAtIndex: (state, action) => {\n      const { index, newId } = action.payload;\n      if (state.objectMapData[index] !== undefined) {\n        state.objectMapData[index] = newId;\n      }\n    },\n    setObjectTextureIndex: (state, action) => {\n      const { index, textureIndex } = action.payload;\n      state.objectTextureIndices[index] = textureIndex;\n    },\n    revealSecretZone: (state, action) => {\n      const indices = action.payload; // Array of tile indices to reveal\n      // Add new indices to revealed array (avoid duplicates)\n      indices.forEach(idx => {\n        if (!state.revealedSecrets.includes(idx)) {\n          state.revealedSecrets.push(idx);\n        }\n      });\n    },\n    setLoading: (state, action) => {\n      state.isLoading = action.payload;\n    },\n    setError: (state, action) => {\n      state.error = action.payload;\n    },\n    setPaused: (state, action) => {\n      state.isPaused = action.payload;\n    },\n    setGameOver: (state, action) => {\n      state.isGameOver = action.payload;\n    },\n    resetGame: (state) => {\n      return { ...initialState, activeMapData: state.activeMapData };\n    },\n  },\n});\n\nexport const {\n  setActiveMap,\n  updateObjectMap,\n  updateObjectMetadata,\n  removeObjectAtIndex,\n  updateObjectAtIndex,\n  setObjectTextureIndex,\n  revealSecretZone,\n  setLoading,\n  setError,\n  setPaused,\n  setGameOver,\n  resetGame,\n} = gameSlice.actions;\n\nexport default gameSlice.reducer;\n","/**\n * Game Constants\n * All game-wide constants centralized in one place\n */\n\n// Physics Constants\nexport const TILE_SIZE = 32;\nexport const GRAVITY = 0.6;\nexport const TERMINAL_VELOCITY = 12;\nexport const MOVE_SPEED = 4;\nexport const JUMP_FORCE = 10;\n\n// Player Stats Constants\nexport const MAX_HEALTH = 100;\nexport const MAX_OXYGEN = 100;\nexport const MAX_LAVA_RESIST = 100;\nexport const MAX_ICE_RESIST = 100;\n\n// Combat Constants\nexport const SHOOT_COOLDOWN = 350; // milliseconds\nexport const HIT_FLASH_DURATION = 500; // milliseconds\n\n// Animation Constants\nexport const IDLE_ANIMATION = 'idle';\nexport const RUN_ANIMATION = 'run';\nexport const JUMP_ANIMATION = 'jump';\n\n// Liquid Constants\nexport const WATER_HORIZONTAL_DAMPING = 0.82;\nexport const LAVA_HORIZONTAL_DAMPING = 0.78;\n\n// Default Liquid Parameters\nexport const DEFAULT_OXYGEN_PARAMS = {\n  drainPerSecond: 20,\n  regenPerSecond: 35,\n  damagePerSecondWhenDepleted: 10,\n};\n\nexport const DEFAULT_LAVA_PARAMS = {\n  drainPerSecond: 25,\n  regenPerSecond: 40,\n  damagePerSecondWhenDepleted: 15,\n};\n\n// Timing Constants\nexport const HAZARD_DAMAGE_TICK_INTERVAL = 1000; // milliseconds\nexport const LIQUID_DAMAGE_TICK_INTERVAL = 1000; // milliseconds\n\n// Direction Constants\nexport const DIRECTION_RIGHT = 1;\nexport const DIRECTION_LEFT = -1;\n\n// Map Defaults\nexport const DEFAULT_MAP_WIDTH = 20;\nexport const DEFAULT_MAP_HEIGHT = 15;\n\n// Viewport Constants\nexport const VIEWPORT_DEAD_ZONE_LEFT = 0.3;\nexport const VIEWPORT_DEAD_ZONE_RIGHT = 0.7;\n\n// Sound Constants\nexport const DEFAULT_BACKGROUND_MUSIC_VOLUME = 0.6;\nexport const DEFAULT_SFX_VOLUME = 0.5;\n","/**\n * Player Slice\n * Manages player state (position, health, resources, etc.)\n */\n\nimport { createSlice } from '@reduxjs/toolkit';\nimport { MAX_HEALTH, MAX_OXYGEN, MAX_LAVA_RESIST } from '../../constants/gameConstants';\n\nconst initialState = {\n  x: 0,\n  y: 0,\n  width: 32,\n  height: 32,\n  vx: 0,\n  vy: 0,\n  isGrounded: false,\n  direction: 1,\n  animation: 'idle',\n  health: 90,\n  maxHealth: MAX_HEALTH,\n  ammo: 0,\n  oxygen: MAX_OXYGEN,\n  maxOxygen: MAX_OXYGEN,\n  lavaResist: MAX_LAVA_RESIST,\n  maxLavaResist: MAX_LAVA_RESIST,\n  projectiles: [],\n  inWater: false,\n  headUnderWater: false,\n  atSurface: false,\n  liquidType: null,\n  hitTimerMs: 0,\n  isWinning: false,\n  winCounter: 0,\n};\n\nconst playerSlice = createSlice({\n  name: 'player',\n  initialState,\n  reducers: {\n    updateState: (state, action) => {\n      return { ...state, ...action.payload };\n    },\n    setPosition: (state, action) => {\n      const { x, y } = action.payload;\n      state.x = x;\n      state.y = y;\n    },\n    setVelocity: (state, action) => {\n      const { vx, vy } = action.payload;\n      state.vx = vx;\n      state.vy = vy;\n    },\n    setHealth: (state, action) => {\n      state.health = Math.max(0, Math.min(state.maxHealth, action.payload));\n    },\n    addHealth: (state, action) => {\n      state.health = Math.max(0, Math.min(state.maxHealth, state.health + action.payload));\n    },\n    takeDamage: (state, action) => {\n      state.health = Math.max(0, state.health - action.payload);\n      state.hitTimerMs = Math.max(state.hitTimerMs, 500);\n    },\n    setAmmo: (state, action) => {\n      state.ammo = Math.max(0, action.payload);\n    },\n    addAmmo: (state, action) => {\n      state.ammo = Math.max(0, state.ammo + action.payload);\n    },\n    setOxygen: (state, action) => {\n      state.oxygen = Math.max(0, Math.min(state.maxOxygen, action.payload));\n    },\n    setLavaResist: (state, action) => {\n      state.lavaResist = Math.max(0, Math.min(state.maxLavaResist, action.payload));\n    },\n    setProjectiles: (state, action) => {\n      state.projectiles = action.payload;\n    },\n    addProjectile: (state, action) => {\n      state.projectiles.push(action.payload);\n    },\n    removeProjectile: (state, action) => {\n      state.projectiles = state.projectiles.filter(p => p.id !== action.payload);\n    },\n    setDirection: (state, action) => {\n      state.direction = action.payload;\n    },\n    setAnimation: (state, action) => {\n      state.animation = action.payload;\n    },\n    setGrounded: (state, action) => {\n      state.isGrounded = action.payload;\n    },\n    setInWater: (state, action) => {\n      state.inWater = action.payload;\n    },\n    setLiquidType: (state, action) => {\n      state.liquidType = action.payload;\n    },\n    resetPlayer: () => initialState,\n  },\n});\n\nexport const {\n  updateState,\n  setPosition,\n  setVelocity,\n  setHealth,\n  addHealth,\n  takeDamage,\n  setAmmo,\n  addAmmo,\n  setOxygen,\n  setLavaResist,\n  setProjectiles,\n  addProjectile,\n  removeProjectile,\n  setDirection,\n  setAnimation,\n  setGrounded,\n  setInWater,\n  setLiquidType,\n  resetPlayer,\n} = playerSlice.actions;\n\nexport default playerSlice.reducer;\n","/**\n * Settings Slice\n * Manages game settings (audio, graphics, controls, etc.)\n */\n\nimport { createSlice } from '@reduxjs/toolkit';\n\nconst initialState = {\n  sound: {\n    enabled: false,\n    masterVolume: 1.0,\n    sfxVolume: 0.5,\n    musicVolume: 0.6,\n  },\n  graphics: {\n    backgroundParallaxFactor: 0.3,\n    weatherRain: 0,\n    weatherSnow: 0,\n    weatherClouds: 0,\n    weatherFog: 0,\n    weatherThunder: 0,\n  },\n  ui: {\n    healthBarEnabled: true,\n    oxygenBarEnabled: true,\n    lavaBarEnabled: true,\n    waterSplashesEnabled: true,\n    lavaEmbersEnabled: true,\n  },\n  controls: {\n    keyUp: 'w',\n    keyDown: 's',\n    keyLeft: 'a',\n    keyRight: 'd',\n    keyJump: 'Space',\n    keyShoot: 'MouseLeft',\n  },\n};\n\n// Load settings from localStorage\nconst loadSettings = () => {\n  try {\n    const saved = localStorage.getItem('game_settings');\n    if (saved) {\n      const parsed = JSON.parse(saved);\n      return { ...initialState, ...parsed };\n    }\n  } catch (error) {\n    console.error('Failed to load settings:', error);\n  }\n  return initialState;\n};\n\nconst settingsSlice = createSlice({\n  name: 'settings',\n  initialState: loadSettings(),\n  reducers: {\n    updateSettings: (state, action) => {\n      const newState = { ...state, ...action.payload };\n      // Save to localStorage\n      try {\n        localStorage.setItem('game_settings', JSON.stringify(newState));\n      } catch (error) {\n        console.error('Failed to save settings:', error);\n      }\n      return newState;\n    },\n    setSoundEnabled: (state, action) => {\n      state.sound.enabled = action.payload;\n      try {\n        localStorage.setItem('game_sound_enabled', action.payload ? '1' : '0');\n      } catch (error) {\n        console.error('Failed to save sound setting:', error);\n      }\n    },\n    setSoundVolume: (state, action) => {\n      const { type, volume } = action.payload;\n      if (type === 'master') state.sound.masterVolume = volume;\n      else if (type === 'sfx') state.sound.sfxVolume = volume;\n      else if (type === 'music') state.sound.musicVolume = volume;\n    },\n    setGraphicsSetting: (state, action) => {\n      const { key, value } = action.payload;\n      if (state.graphics[key] !== undefined) {\n        state.graphics[key] = value;\n      }\n    },\n    setUISetting: (state, action) => {\n      const { key, value } = action.payload;\n      if (state.ui[key] !== undefined) {\n        state.ui[key] = value;\n      }\n    },\n    setControlBinding: (state, action) => {\n      const { key, value } = action.payload;\n      if (state.controls[key] !== undefined) {\n        state.controls[key] = value;\n      }\n    },\n    resetSettings: () => {\n      try {\n        localStorage.removeItem('game_settings');\n      } catch (error) {\n        console.error('Failed to clear settings:', error);\n      }\n      return initialState;\n    },\n  },\n});\n\nexport const {\n  updateSettings,\n  setSoundEnabled,\n  setSoundVolume,\n  setGraphicsSetting,\n  setUISetting,\n  setControlBinding,\n  resetSettings,\n} = settingsSlice.actions;\n\nexport default settingsSlice.reducer;\n","/**\n * UI Slice\n * Manages UI state (modals, menus, notifications, etc.)\n */\n\nimport { createSlice } from '@reduxjs/toolkit';\n\nconst initialState = {\n  isMapModalOpen: true,\n  isSettingsOpen: false,\n  isTerminalOpen: false,\n  isPauseMenuOpen: false,\n  notifications: [],\n  cameraScrollX: 0,\n  shouldCenterMap: false,\n};\n\nconst uiSlice = createSlice({\n  name: 'ui',\n  initialState,\n  reducers: {\n    setMapModalOpen: (state, action) => {\n      state.isMapModalOpen = action.payload;\n    },\n    setSettingsOpen: (state, action) => {\n      state.isSettingsOpen = action.payload;\n    },\n    setTerminalOpen: (state, action) => {\n      state.isTerminalOpen = action.payload;\n      // Also set global flag for game loop\n      try {\n        window.__GAME_TERMINAL_OPEN__ = action.payload;\n      } catch {}\n    },\n    setPauseMenuOpen: (state, action) => {\n      state.isPauseMenuOpen = action.payload;\n    },\n    addNotification: (state, action) => {\n      state.notifications.push({\n        id: Date.now(),\n        timestamp: new Date().toISOString(),\n        ...action.payload,\n      });\n    },\n    removeNotification: (state, action) => {\n      state.notifications = state.notifications.filter(n => n.id !== action.payload);\n    },\n    clearNotifications: (state) => {\n      state.notifications = [];\n    },\n    setCameraScrollX: (state, action) => {\n      state.cameraScrollX = action.payload;\n    },\n    setShouldCenterMap: (state, action) => {\n      state.shouldCenterMap = action.payload;\n    },\n    resetUI: () => initialState,\n  },\n});\n\nexport const {\n  setMapModalOpen,\n  setSettingsOpen,\n  setTerminalOpen,\n  setPauseMenuOpen,\n  addNotification,\n  removeNotification,\n  clearNotifications,\n  setCameraScrollX,\n  setShouldCenterMap,\n  resetUI,\n} = uiSlice.actions;\n\nexport default uiSlice.reducer;\n","/**\n * Redux Store Configuration\n * Centralized state management for the game\n */\n\nimport { configureStore } from '@reduxjs/toolkit';\nimport gameReducer from './slices/gameSlice';\nimport playerReducer from './slices/playerSlice';\nimport settingsReducer from './slices/settingsSlice';\nimport uiReducer from './slices/uiSlice';\n\nconst store = configureStore({\n  reducer: {\n    game: gameReducer,\n    player: playerReducer,\n    settings: settingsReducer,\n    ui: uiReducer,\n  },\n  middleware: (getDefaultMiddleware) =>\n    getDefaultMiddleware({\n      serializableCheck: {\n        // Ignore these action types for serialization checks\n        ignoredActions: ['game/setActiveMap', 'player/updateState'],\n        // Ignore these field paths in all actions\n        ignoredActionPaths: ['payload.projectiles', 'payload.timestamp'],\n        // Ignore these paths in the state\n        ignoredPaths: ['game.activeMapData', 'player.projectiles'],\n      },\n    }),\n  devTools: process.env.NODE_ENV !== 'production',\n});\n\nexport default store;\n","/**\n * Theme Configuration for Styled Components\n * Centralized design tokens and theme variables\n */\n\nconst theme = {\n  colors: {\n    primary: '#4CAF50',\n    secondary: '#2196F3',\n    danger: '#f44336',\n    warning: '#ff9800',\n    success: '#8bc34a',\n    info: '#00bcd4',\n    dark: '#222',\n    darkGray: '#333',\n    mediumGray: '#555',\n    lightGray: '#777',\n    background: '#111',\n    surface: '#f9f9f9',\n    overlay: 'rgba(0, 0, 0, 0.6)',\n    text: '#333',\n    textLight: '#666',\n    textDark: '#fff',\n    border: '#ddd',\n    borderLight: '#eee',\n  },\n\n  spacing: {\n    xs: '4px',\n    sm: '8px',\n    md: '16px',\n    lg: '24px',\n    xl: '32px',\n    xxl: '48px',\n  },\n\n  borderRadius: {\n    sm: '4px',\n    md: '6px',\n    lg: '8px',\n    xl: '12px',\n    round: '50%',\n  },\n\n  shadows: {\n    sm: '0 2px 4px rgba(0,0,0,0.1)',\n    md: '0 4px 8px rgba(0,0,0,0.2)',\n    lg: '0 10px 25px rgba(0,0,0,0.5)',\n  },\n\n  fontSize: {\n    xs: '11px',\n    sm: '12px',\n    md: '14px',\n    base: '16px',\n    lg: '18px',\n    xl: '24px',\n    xxl: '32px',\n  },\n\n  fontWeight: {\n    light: 300,\n    normal: 400,\n    medium: 500,\n    semibold: 600,\n    bold: 700,\n  },\n\n  transitions: {\n    fast: '0.15s ease',\n    normal: '0.3s ease',\n    slow: '0.5s ease',\n  },\n\n  zIndex: {\n    base: 1,\n    dropdown: 100,\n    modal: 1000,\n    tooltip: 1100,\n    notification: 1200,\n  },\n\n  breakpoints: {\n    mobile: '480px',\n    tablet: '768px',\n    desktop: '1024px',\n    wide: '1280px',\n  },\n};\n\nexport default theme;\n","/**\n * Global Styles using Styled Components\n */\n\nimport { createGlobalStyle } from 'styled-components';\n\nconst GlobalStyles = createGlobalStyle`\n  * {\n    margin: 0;\n    padding: 0;\n    box-sizing: border-box;\n  }\n\n  body {\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',\n      'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',\n      sans-serif;\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    overflow: hidden;\n  }\n\n  code {\n    font-family: source-code-pro, Menlo, Monaco, Consolas, 'Courier New',\n      monospace;\n  }\n\n  button {\n    cursor: pointer;\n    font-family: inherit;\n\n    &:disabled {\n      cursor: not-allowed;\n      opacity: 0.6;\n    }\n  }\n\n  input, textarea, select {\n    font-family: inherit;\n  }\n\n  a {\n    text-decoration: none;\n    color: inherit;\n  }\n\n  ul, ol {\n    list-style: none;\n  }\n\n  img {\n    max-width: 100%;\n    height: auto;\n  }\n\n  /* Scrollbar Styles */\n  ::-webkit-scrollbar {\n    width: 10px;\n    height: 10px;\n  }\n\n  ::-webkit-scrollbar-track {\n    background: #222;\n  }\n\n  ::-webkit-scrollbar-thumb {\n    background: #555;\n    border-radius: 5px;\n\n    &:hover {\n      background: #777;\n    }\n  }\n`;\n\nexport default GlobalStyles;\n","import i18n from \"i18next\"\nimport { initReactI18next } from \"react-i18next\"\n\nimport lv_navigation_home from \"./translations/lv/navigation_home.json\"\nimport no_navigation_home from  \"./translations/no/navigation_home.json\"\nimport en_navigation_home from  \"./translations/en/navigation_home.json\"\nimport ru_navigation_home from  \"./translations/ru/navigation_home.json\"\nimport ja_navigation_home from  \"./translations/ja/navigation_home.json\"\n\nconst lv_navigation = {\n    ...lv_navigation_home\n}\n\nconst no_navigation = {\n    ...no_navigation_home\n}\n\nconst en_navigation = {\n    ...en_navigation_home\n}\n\nconst ru_navigation = {\n    ...ru_navigation_home\n}\n\nconst ja_navigation = {\n    ...ja_navigation_home\n}\n\ni18n\n    .use(initReactI18next)\n    .init({\n        lng: \"en\",\n        fallbackLng: \"en\",\n        supportedLngs: [\"lv\", \"no\", \"en\", \"ru\", \"ja\"],\n        ns: [\"navigation\"],\n        defaultNS: \"navigation\",\n        interpolation: { escapeValue: false },\n        resources: {\n            lv: {\n                navigation: lv_navigation\n            },\n            no: {\n                navigation: no_navigation\n            },\n            en: {\n                navigation: en_navigation\n            },\n            ru: {\n                navigation: ru_navigation\n            },\n            ja: {\n                navigation: ja_navigation\n            },\n        },\n    })\n\nexport default i18n","import styled from \"styled-components\"\nimport { NavLink } from \"react-router-dom\"\nimport { useTranslation } from \"react-i18next\"\n\nexport const NavLinkButton = styled(NavLink)`\n    display: flex;\n    align-items: center;\n    justify-content: center;\n\n    background-color: transparent;\n    color: lightgray;\n    border: 1px solid rgba(255, 255, 255, 0.3);\n    padding: 0 10px;\n    font-size: 13px;\n    font-weight: 600;\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n    cursor: pointer;\n    transition: all 0.3s ease;\n    white-space: nowrap;\n    border-radius: 0;\n    text-decoration: none;\n\n    &:hover {\n        background-color: #f4c542;\n        color: #2a2a2a;\n        border-color: #f4c542;\n    }\n\n    &.active {\n        background-color: rgba(255, 255, 255, 0.15);\n        border-color: rgba(255, 255, 255, 0.5);\n        color: black;\n    }\n`\n\nexport function SectionHeaderNavigationChapters() {\n    const { t } = useTranslation(\"navigation\");\n    const chapter_home = t(\"NAVIGATION_HOME\")\n    const chapter_game = t(\"NAVIGATION_NEW_GAME\")\n    const chapter_editor = t(\"NAVIGATION_EDITOR\")\n    const chapter_crystals = t(\"NAVIGATION_CRYSTALS\")\n    const chapter_repository = t(\"NAVIGATION_REPOSITORY\")\n\n    // JAUNS: Funkcija, kas nosta signlu atvrt modlo logu\n    const handleNewGameClick = () => {\n        // Nostam globlu notikumu, ko 'game.jsx' vars uztvert\n        window.dispatchEvent(new Event('open-new-game-modal'));\n    };\n\n    return (\n        <nav style={{ display: \"flex\", gap: \"0\" }}>\n            <NavLinkButton to=\"/\" className={({ isActive }) => isActive ? \"active\" : \"\"}>\n                { chapter_home }\n            </NavLinkButton>\n\n            {/* JAUNS: Pievienots onClick handleris */}\n            <NavLinkButton to=\"/game\" onClick={handleNewGameClick} className={({ isActive }) => isActive ? \"active\" : \"\"}>\n                { chapter_game }\n            </NavLinkButton>\n\n            <NavLinkButton to=\"/editor\" className={({ isActive }) => isActive ? \"active\" : \"\"}>\n                { chapter_editor }\n            </NavLinkButton>\n\n            <NavLinkButton to=\"/crystals\" className={({ isActive }) => isActive ? \"active\" : \"\"}>\n                { chapter_crystals }\n            </NavLinkButton>\n\n            <NavLinkButton to=\"/repository\" className={({ isActive }) => isActive ? \"active\" : \"\"}>\n                { chapter_repository }\n            </NavLinkButton>\n        </nav>\n    )\n}\n","import styled from \"styled-components\"\nimport { useTranslation } from \"react-i18next\"\nimport { useState, useRef, useEffect } from \"react\"\nimport { useSelector, useDispatch } from \"react-redux\"\nimport { setSoundEnabled } from \"../store/slices/settingsSlice\"\n\nconst NavButton = styled.button`\n    display: flex;\n    align-items: center;\n    justify-content: center;\n\n    background-color: transparent;\n    color: lightgray;\n    border: 1px solid rgba(255, 255, 255, 0.3);\n    //height: 36px;              /* fiksts augstums desktop */\n    padding: 0 10px;           /* horizontlais padding */\n    font-size: 13px;\n    font-weight: 600;\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n    cursor: pointer;\n    transition: all 0.3s ease;\n    white-space: nowrap;\n    border-radius: 0;\n    height: 36px;\n\n    &:hover {\n        background-color: #f4c542;\n        color: #2a2a2a;\n        border-color: #f4c542;\n    }\n\n    &.active {\n        background-color: rgba(255, 255, 255, 0.15);\n        border-color: rgba(255, 255, 255, 0.5);\n        color: black;\n    }\n`\n\nconst DropdownContainer = styled.div`\n    position: relative;\n    display: flex;\n`\n\nconst DropdownMenu = styled.div`\n    position: absolute;\n    top: 100%;\n    right: 0;\n    background-color: #333;\n    border: 1px solid #444;\n    border-radius: 4px;\n    padding: 10px;\n    z-index: 2000;\n    box-shadow: 0 4px 12px rgba(0,0,0,0.5);\n    min-width: 150px;\n    margin-top: 5px;\n`\n\nconst MenuItem = styled.div`\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    padding: 8px;\n    color: white;\n    font-size: 12px;\n    cursor: pointer;\n    border-radius: 4px;\n\n    &:hover {\n        background-color: #444;\n    }\n`\n\nconst ToggleSwitch = styled.div`\n    width: 34px;\n    height: 18px;\n    background-color: ${props => props.$active ? '#f4c542' : '#666'};\n    border-radius: 9px;\n    position: relative;\n    transition: background-color 0.3s;\n\n    &::after {\n        content: '';\n        position: absolute;\n        top: 2px;\n        left: ${props => props.$active ? '18px' : '2px'};\n        width: 14px;\n        height: 14px;\n        background-color: white;\n        border-radius: 50%;\n        transition: left 0.3s;\n    }\n`\n\nexport default function SectionHeaderNavigationLanguages() {\n    const { i18n } = useTranslation();\n    const dispatch = useDispatch();\n    const dropdownRef = useRef(null);\n    const [isMenuOpen, setIsMenuOpen] = useState(false);\n    \n    const { sound } = useSelector(state => state.settings);\n    const soundEnabled = sound?.enabled ?? false;\n\n    const currentLang = i18n.language || 'en'\n\n    const handleLanguageChange = (newLang) => {\n        i18n.changeLanguage(newLang)\n    }\n\n    const toggleSound = () => {\n        const next = !soundEnabled;\n        dispatch(setSoundEnabled(next));\n        try { window.dispatchEvent(new CustomEvent('game-sound-toggle', { detail: { enabled: next } })); } catch {}\n        try { window.dispatchEvent(new CustomEvent('game-sound-user-gesture')); } catch {}\n    };\n\n    useEffect(() => {\n        const handleClickOutside = (event) => {\n            if (dropdownRef.current && !dropdownRef.current.contains(event.target)) {\n                setIsMenuOpen(false);\n            }\n        };\n        document.addEventListener('mousedown', handleClickOutside);\n        return () => document.removeEventListener('mousedown', handleClickOutside);\n    }, []);\n\n    return (\n        <nav style={{ display: \"flex\", gap: \"0\" }}>\n            <NavButton\n                className={currentLang === 'lv' ? 'active' : ''}\n                onClick={() => handleLanguageChange('lv')}\n            >\n                LV\n            </NavButton>\n\n            <NavButton\n                className={currentLang === 'no' ? 'active' : ''}\n                onClick={() => handleLanguageChange('no')}\n            >\n                NO\n            </NavButton>\n\n            <NavButton\n                className={currentLang === 'en' ? 'active' : ''}\n                onClick={() => handleLanguageChange('en')}\n            >\n                EN\n            </NavButton>\n\n            <NavButton\n                className={currentLang === 'ru' ? 'active' : ''}\n                onClick={() => handleLanguageChange('ru')}\n            >\n                RU\n            </NavButton>\n\n            <NavButton\n                className={currentLang === 'ja' ? 'active' : ''}\n                onClick={() => handleLanguageChange('ja')}\n            >\n                JA\n            </NavButton>\n\n            <DropdownContainer ref={dropdownRef}>\n                <NavButton onClick={() => setIsMenuOpen(!isMenuOpen)} title=\"Settings\">\n                    \n                </NavButton>\n                {isMenuOpen && (\n                    <DropdownMenu>\n                        <MenuItem onClick={toggleSound}>\n                            <span>Sound Effects</span>\n                            <ToggleSwitch $active={soundEnabled} />\n                        </MenuItem>\n                        <div style={{ height: '1px', backgroundColor: '#444', margin: '5px 0' }} />\n                        <div style={{ padding: '5px 8px', fontSize: '10px', color: '#888' }}>\n                            GAME SETTINGS\n                        </div>\n                    </DropdownMenu>\n                )}\n            </DropdownContainer>\n        </nav>\n    )\n}","import styled from \"styled-components\"\n\nconst StyledLogo = styled.p`\n    text-transform: uppercase;\n`\n\nexport function SectionHeaderNavigationLogo() {\n\n    return (\n        <StyledLogo>\n            Element Masters\n        </StyledLogo>\n    )\n}","import styled from \"styled-components\"\nimport { SectionHeaderNavigationChapters } from \"./section.header.navigation.chapters\"\nimport SectionHeaderNavigationLanguages from \"./section.header.navigation.languages\"\nimport {SectionHeaderNavigationLogo} from \"./section.header.navigation.logo\";\n\nconst StyledSectionHeaderNavigation = styled.div`\n    display: flex;\n    flex-direction: row;\n    width: 100%;\n    height: auto;\n    border: solid 1px lightgrey;\n    \n    .innerHeader {\n        display: flex;\n        flex-direction: row;\n        width: 100%;\n        height: auto;\n        margin: 5px 20px;\n        //border: solid 1px red;\n        \n        .innerHeaderLogo {\n            display: flex;\n            flex-direction: row;\n            width: 220px;\n            height: auto;\n            //border: solid 1px green;\n        }\n        \n        .innerHeaderChapters {\n            display: flex;\n            flex-direction: row;\n            justify-content: center;\n            width: 100%;\n            height: auto;\n            //border: solid 1px brown;\n        }\n        \n        .innerHeaderLanguages {\n            display: flex;\n            flex-direction: row;\n            width: auto;\n            height: auto;\n            //border: solid 1px red;\n        }\n    }\n`\n\nfunction SectionHeader() {\n\n    return (\n        <StyledSectionHeaderNavigation>\n            <div className=\"innerHeader\">\n                <div className=\"innerHeaderLogo\">\n                    <SectionHeaderNavigationLogo />\n                </div>\n\n                <div className=\"innerHeaderChapters\">\n                    <SectionHeaderNavigationChapters />\n                </div>\n\n                <div className=\"innerHeaderLanguages\">\n                    <SectionHeaderNavigationLanguages />\n                </div>\n            </div>\n        </StyledSectionHeaderNavigation>\n    )\n}\n\nexport default SectionHeader","import styled from \"styled-components\"\n\nconst StyledSectionHeaderFooter = styled.div`\n    display: flex;\n    flex-direction: row;\n    justify-content: center;\n    width: 100%;\n    height: auto;\n    border: solid 1px lightgray;\n\n    .innerFooter {\n        display: flex;\n        flex-direction: row;\n        justify-content: flex-end;\n        width: 100%;\n        height: auto;\n        margin: 5px 20px;\n        //border: solid 1px red;\n    }\n\n    p {\n        font-size: 12px;\n        color: lightgrey;\n    }\n`\n\nfunction SectionFooter() {\n\n    return (\n        <StyledSectionHeaderFooter>\n            <div className=\"innerFooter\">\n                <p>element_masters v.0.0.0</p>\n            </div>\n        </StyledSectionHeaderFooter>\n    )\n}\n\nexport default SectionFooter","import styled from \"styled-components\"\n\nconst StyledSectionContent = styled.div`\n    display: flex;\n    flex-direction: column;\n    width: 100%;\n    height: 100%;\n    border: solid 1px lightgray;\n`\n\nfunction SectionContent({ children, style }) {\n\n    return (\n        <StyledSectionContent style={style}>\n            { children }\n        </StyledSectionContent>\n    )\n}\n\nexport default SectionContent","/**\n * Game Registry Module\n * Loads all JSON files and creates a registry array.\n * Executed only once during initialization.\n */\n\nlet _registry = null;\n\n/**\n * Initialize the registry by loading all JSON, image, and sound assets.\n * This is executed only once when the module is first imported.\n * @returns {Array} The loaded registry items\n */\nconst initRegistry = () => {\n    // If registry already exists, do nothing\n    if (_registry) return _registry;\n\n    console.time(\"Registry Load Time\");\n\n    try {\n        // 1. Load JSON data\n        const jsonContext = require.context('../../assets/json', true, /\\.json$/);\n\n        // 2. Load IMAGES\n        const imageContext = require.context('../../assets/images', true, /\\.(png|jpe?g|svg)$/);\n\n        // 3. Load SOUNDS (non-fatal: if not supported or directory doesn't exist, continue without sounds)\n        let soundContext = null;\n        try {\n            soundContext = require.context('../../assets/sound', true, /\\.(mp3|wav|ogg|m4a|aac|flac|webm)$/);\n        } catch (e) {\n            // Sound context not available  not fatal\n            soundContext = null;\n        }\n\n        // Check if sound context is available\n        if (!soundContext) {\n            console.warn('Sound context unavailable. Continuing without pre-resolved sound assets.');\n        }\n\n        // Helper function for path resolution\n        const resolvePath = (rawPath) => {\n            if (!rawPath) return null;\n            try {\n                // Convert JSON path to relative Webpack path\n                // Example: \"/assets/images/blocks/dirt.png\" -> \"./blocks/dirt.png\"\n                const cleanPath = rawPath.replace('/assets/images/', './').replace('src/assets/images/', './');\n                const relativePath = cleanPath.startsWith('./') ? cleanPath : `./${cleanPath}`;\n\n                const imageModule = imageContext(relativePath);\n                return imageModule.default || imageModule;\n            } catch (e) {\n                console.warn(`Image not found: ${rawPath}`);\n                return rawPath; // If not found, return original path\n            }\n        };\n\n        let _warnedUnresolvedSound = false;\n        const resolveSound = (rawPath) => {\n            if (!rawPath) return null;\n            // Normalize path for sound context\n            const normalize = (p) => {\n                let out = p;\n                out = out.replace('/assets/sounds/', './').replace('src/assets/sounds/', './');\n                out = out.replace('/assets/sound/', './').replace('src/assets/sound/', './');\n                return out.startsWith('./') ? out : `./${out}`;\n            };\n            const rel = normalize(rawPath);\n            // Try to resolve with sound context\n            if (soundContext) {\n                try {\n                    const mod = soundContext(rel);\n                    return mod.default || mod;\n                } catch {}\n            }\n            // Unable to resolve in bundler  return original path to try loading via public URL\n            if (!_warnedUnresolvedSound) {\n                console.warn(`SFX not bundled: ${rawPath}. Will try loading via public URL. Place files under src/assets/sound, or copy to public/assets/sound.`);\n                _warnedUnresolvedSound = true;\n            }\n            return rawPath;\n        };\n\n        _registry = jsonContext.keys().map((key) => {\n            const data = jsonContext(key);\n            const item = data.default || data;\n\n            // Apstrdjam vienu bildi (vecais variants)\n            let resolvedTexture = resolvePath(item.texture);\n\n            // Apstrdjam bilu masvu (jaunais variants animcijm)\n            let resolvedTextures = [];\n            if (item.textures && Array.isArray(item.textures)) {\n                resolvedTextures = item.textures.map(path => resolvePath(path));\n            }\n\n            return {\n                ...item,\n                texture: resolvedTexture,     // Viena bilde (ja ir)\n                textures: resolvedTextures,   // Masvs (ja ir)\n                // Skaas ce (ja ir)  prvrsts uz bundlera URL\n                sfx: resolveSound(item.sfx || item.sfxResolved || null)\n            };\n        });\n\n        // --- JAUNS: Pcapstrde (Linking & Merging) ---\n        // Ms ejam cauri visiem elementiem un mekljam tos, kuriem ir 'defaultAnimation'.\n        // Ja atrodam, ms kopjam vizulos datus no animcijas uz galveno objektu.\n        \n        _registry.forEach(item => {\n            if (item.defaultAnimation) {\n                // Mekljam animcijas objektu pc ID\n                // Piezme: Tav piemr player.json ir \"player_default\", bet fail id ir \"player_default_100\". \n                // eit ms minm atrast preczu vai daju atbilstbu, lai kods strdtu abos gadjumos.\n                const animItem = _registry.find(r => r.id === item.defaultAnimation || r.id === item.defaultAnimation + \"_100\");\n                \n                if (animItem) {\n                    // Kopjam vizulos datus uz galveno 'player' objektu\n                    if (!item.texture) item.texture = animItem.texture;\n                    if (!item.textures || item.textures.length === 0) item.textures = animItem.textures;\n                    if (!item.animationSpeed) item.animationSpeed = animItem.animationSpeed;\n                    \n                    // Iezmjam animcijas objektu k 'hidden', lai to nerdtu Editor\n                    animItem.isHiddenInEditor = true;\n                }\n                \n                // Tpat paslpjam ar dead un target animcijas, ja ts eksist k atsevii itemi\n                if (item.deadAnimation) {\n                     const deadItem = _registry.find(r => r.id === item.deadAnimation);\n                     if (deadItem) deadItem.isHiddenInEditor = true;\n                }\n                if (item.targetAnimation) {\n                     const targetItem = _registry.find(r => r.id === item.targetAnimation || r.id === item.targetAnimation + \"_100\");\n                     if (targetItem) targetItem.isHiddenInEditor = true;\n                }\n            }\n        });\n\n        console.log(` Game Registry initialized. Loaded ${_registry.length} items.`);\n\n    } catch (error) {\n        console.error(\" Failed to load Game Registry:\", error);\n        _registry = [];\n    }\n\n    console.timeEnd(\"Registry Load Time\");\n    return _registry;\n};\n\n// Automtiski inicializjam, kad is fails tiek importts pirmo reizi\ninitRegistry();\n\n// Eksportjam funkciju, lai piektu datiem (getter)\nexport const getRegistry = () => {\n    return _registry;\n};\n\n// Eksportjam palgfunkciju, lai mekltu pc ID\nexport const findItemById = (id) => {\n    return _registry ? _registry.find(item => item.id === id) : null;\n};\n\nexport default _registry;\n","import React, { useEffect } from 'react';\nimport { Outlet, Link } from \"react-router-dom\"\nimport SectionHeader from \"./sections/section.header\";\nimport SectionFooter from \"./sections/section.footer\";\nimport SectionContent from \"./sections/section.content\";\n\n// Import the registry getter from the centralized engine registry\n// The import itself ensures that the registry code executes and data loads into memory.\nimport { getRegistry } from './engine/registry';\n\nfunction App() {\n\n  useEffect(() => {\n    // Verify that registry data is loaded into memory\n    const items = getRegistry();\n    console.log(\"App start - Current Registry in Memory:\", items);\n  }, []);\n\n  return (\n        <div style={{\n            display: 'flex',\n            flexDirection: 'column',\n            justifyContent: 'flex-start',\n            alignItems: 'center',\n            width: '100vw',\n            height: '100vh',\n            overflow: 'hidden'\n        }}>\n            <div style={{ width: '100%', flexShrink: 0 }}>\n                <SectionHeader />\n            </div>\n            <SectionContent style={{ flexGrow: 1, width: '100%', overflow: 'auto' }}>\n                <Outlet />\n            </SectionContent>\n            <div style={{ width: '100%', flexShrink: 0 }}>\n                <SectionFooter />\n            </div>\n        </div>\n      )\n    }\n\nexport default App","\n\nexport default function Home() {\n\n    return (\n        <>\n            <p>Home</p>\n        </>\n    )\n}","// Lightweight texture cache around PIXI.Texture.from\n// Usage:\n//   const cache = new TextureCache();\n//   const tex = cache.get(url);\n//   cache.dispose(); // optional\n\nimport { Texture } from 'pixi.js';\n\nexport class TextureCache {\n  constructor() {\n    this._map = new Map();\n  }\n\n  get(url) {\n    if (!url) return null;\n    const m = this._map;\n    if (m.has(url)) return m.get(url);\n    const tex = Texture.from(url);\n    m.set(url, tex);\n    return tex;\n  }\n\n  has(url) {\n    return this._map.has(url);\n  }\n\n  dispose(url) {\n    // Do not destroy textures created by Texture.from (managed by Pixi's cache);\n    // only release our Map reference.\n    if (url && this._map.has(url)) this._map.delete(url);\n  }\n\n  clear() {\n    this._map.clear();\n  }\n}\n","import { Graphics } from 'pixi.js';\n\n// Simple rain system with variable speeds and single-bounce behavior on solid tiles.\nexport default class WeatherRain {\n  constructor(container, api, getIntensity) {\n    this.container = container;\n    this.api = api;\n    this.getIntensity = getIntensity || (() => 0);\n    this.width = api.mapWidth * api.tileSize;\n    this.height = api.mapHeight * api.tileSize;\n    this.particles = [];\n    this.intensity = 0;\n    const area = this.width * this.height;\n    // Reasonable particle cap depending on map area to keep FPS stable\n    this.maxParticles = Math.max(160, Math.floor(area / 2600));\n  }\n\n  setIntensity(v) {\n    this.intensity = Math.max(0, Math.min(100, Number(v) || 0));\n  }\n\n  spawnOne() {\n    const g = new Graphics();\n    g.clear();\n    // Draw a thin slanted line to mimic a raindrop motion blur\n    g.rect(0, 0, 1.3, 9);\n    g.fill({ color: 0x4aa3ff, alpha: 0.92 });\n    const x = Math.random() * this.width;\n    const y = -10 - Math.random() * 30;\n    const speed = 520 + Math.random() * 520; // px/s, different speeds for depth\n    const vx = (Math.random() * 60 - 30); // slight wind\n    const vy = speed;\n    g.x = x;\n    g.y = y;\n    g.rotation = 0.15; // slight tilt\n    this.container.addChild(g);\n    this.particles.push({ g, x, y, vx, vy, bounces: 0, alive: true });\n  }\n\n  update(dtMs) {\n    // adjust intensity dynamically\n    this.setIntensity(this.getIntensity());\n\n    // Constant-density controller: keep active particles near target count\n    const norm = Math.max(0, Math.min(1, this.intensity / 100));\n    const scaled = Math.pow(norm, 1.15);\n    let target = Math.floor(this.maxParticles * scaled);\n    if (scaled > 0 && target < 8) target = 8; // small baseline so low intensity still visible\n\n    const deficit = target - this.particles.length;\n    if (deficit > 0) {\n      // Smooth ramp, spawn only a fraction per frame to avoid bursts\n      const maxPerFrame = 48;\n      const smooth = Math.max(1, Math.ceil(target * 0.02));\n      const toSpawn = Math.min(deficit, smooth, maxPerFrame);\n      for (let i = 0; i < toSpawn; i++) this.spawnOne();\n    }\n    // Gentle over-target culling to keep density steady\n    if (this.particles.length > target) {\n      const surplus = this.particles.length - target;\n      const toCull = Math.min(surplus, Math.max(1, Math.ceil(this.particles.length * 0.02)));\n      for (let i = 0; i < toCull; i++) {\n        const p = this.particles.pop();\n        if (!p) break;\n        try { p.g.parent && p.g.parent.removeChild(p.g); } catch {}\n        try { p.g.destroy(); } catch {}\n      }\n    }\n\n    const gAcc = 1800; // gravity px/s^2\n    const dt = dtMs / 1000;\n    const toRemove = [];\n\n    for (let i = 0; i < this.particles.length; i++) {\n      const p = this.particles[i];\n      if (!p.alive) { toRemove.push(i); continue; }\n\n      p.vy += gAcc * dt;\n      let nx = p.x + p.vx * dt;\n      let ny = p.y + p.vy * dt;\n\n      // Liquid surface interaction: water/lava\n      try {\n        if (typeof this.api.getLiquidSurfaceY === 'function') {\n          // Prefer closest surface above current ny\n          const syWater = this.api.getLiquidSurfaceY('water', nx);\n          if (Number.isFinite(syWater) && ny >= syWater) {\n            // Hit water surface  spawn small splash and despawn\n            const speed = Math.max(0, Math.min(1500, p.vy));\n            const strength = Math.min(2, 0.4 + speed / 900);\n            if (typeof this.api.onWaterImpact === 'function') this.api.onWaterImpact({ x: nx, strength });\n            p.alive = false; toRemove.push(i);\n            continue;\n          }\n          const syLava = this.api.getLiquidSurfaceY('lava', nx);\n          if (Number.isFinite(syLava) && ny >= syLava) {\n            // Hit lava  steam puff and despawn\n            const speed = Math.max(0, Math.min(1500, p.vy));\n            const strength = Math.min(2, 0.35 + speed / 1200);\n            if (typeof this.api.onLavaImpact === 'function') this.api.onLavaImpact({ x: nx, y: syLava, strength });\n            p.alive = false; toRemove.push(i);\n            continue;\n          }\n        }\n      } catch {}\n\n      // Collision check (treat as point)\n      if (this.api.isSolidAt(nx, ny)) {\n        // Backtrack slightly to stand above surface\n        let guard = 0;\n        while (this.api.isSolidAt(nx, ny) && guard < 6) { ny -= 1; guard++; }\n        // Bounce once, then fade out quickly on next impact\n        if (p.bounces === 0 && Math.abs(p.vy) > 150) {\n          p.vy = -p.vy * 0.3; // dampened bounce\n          p.vx *= 0.8;\n          p.bounces++;\n        } else {\n          // Small splash effect: shrink line and fade\n          p.alive = false;\n          toRemove.push(i);\n        }\n      }\n\n      p.x = nx;\n      p.y = ny;\n      p.g.x = p.x;\n      p.g.y = p.y;\n\n      // Off-screen cleanup\n      if (p.y > this.height + 40 || p.x < -40 || p.x > this.width + 40) {\n        p.alive = false;\n        toRemove.push(i);\n      }\n    }\n\n    // remove in reverse\n    for (let j = toRemove.length - 1; j >= 0; j--) {\n      const idx = toRemove[j];\n      const p = this.particles[idx];\n      if (p && p.g && p.g.parent) p.g.parent.removeChild(p.g);\n      if (p && p.g && p.g.destroy) try { p.g.destroy(); } catch {}\n      this.particles.splice(idx, 1);\n    }\n  }\n\n  destroy() {\n    this.particles.forEach(p => {\n      try { p.g.parent && p.g.parent.removeChild(p.g); } catch {}\n      try { p.g.destroy(); } catch {}\n    });\n    this.particles = [];\n  }\n}\n","import { Graphics } from 'pixi.js';\n\n// Snow system: slow fluttering flakes with varied speeds; stop on blocks without bouncing.\nexport default class WeatherSnow {\n  constructor(container, api, getIntensity) {\n    this.container = container;\n    this.api = api;\n    this.getIntensity = getIntensity || (() => 0);\n    this.width = api.mapWidth * api.tileSize;\n    this.height = api.mapHeight * api.tileSize;\n    this.flakes = [];\n    this.intensity = 0;\n    const area = this.width * this.height;\n    // Snow lasts longer; keep a tighter cap than rain for performance\n    this.maxFlakes = Math.max(120, Math.floor(area / 3800));\n  }\n\n  setIntensity(v) {\n    this.intensity = Math.max(0, Math.min(100, Number(v) || 0));\n  }\n\n  spawnOne() {\n    const g = new Graphics();\n    g.clear();\n    // Slightly larger/more visible flakes on average\n    const r = 1.2 + Math.random() * 2.0; // radius\n    g.circle(0, 0, r);\n    g.fill({ color: 0xffffff, alpha: 0.97 });\n    const x = Math.random() * this.width;\n    const y = -10 - Math.random() * 30;\n    const speed = 40 + Math.random() * 80; // slower than rain, but a bit more range\n    const drift = (Math.random() * 50 - 25); // horizontal drift\n    g.x = x;\n    g.y = y;\n    this.container.addChild(g);\n    this.flakes.push({ g, x, y, vx: drift, vy: speed, alive: true, settled: false, life: 1.0, phase: 'fall', restMs: 0 });\n  }\n\n  update(dtMs) {\n    // adjust intensity dynamically\n    this.setIntensity(this.getIntensity());\n\n    // Constant-density controller to avoid wavey bursts\n    const norm = Math.max(0, Math.min(1, this.intensity / 100));\n    const scaled = Math.pow(norm, 1.15);\n    let target = Math.floor(this.maxFlakes * scaled);\n    if (scaled > 0 && target < 10) target = 10;\n\n    const deficit = target - this.flakes.length;\n    if (deficit > 0) {\n      const maxPerFrame = 24; // slower than rain\n      const smooth = Math.max(1, Math.ceil(target * 0.015));\n      const toSpawn = Math.min(deficit, smooth, maxPerFrame);\n      for (let i = 0; i < toSpawn; i++) this.spawnOne();\n    }\n    // Gentle over-target culling to keep density steady when slider decreases\n    if (this.flakes.length > target) {\n      const surplus = this.flakes.length - target;\n      const toCull = Math.min(surplus, Math.max(1, Math.ceil(this.flakes.length * 0.015)));\n      for (let i = 0; i < toCull; i++) {\n        const f = this.flakes.pop();\n        if (!f) break;\n        try { f.g.parent && f.g.parent.removeChild(f.g); } catch {}\n        try { f.g.destroy(); } catch {}\n      }\n    }\n\n    const gAcc = 200; // gentle gravity\n    const dt = dtMs / 1000;\n    const toRemove = [];\n\n    for (let i = 0; i < this.flakes.length; i++) {\n      const f = this.flakes[i];\n      if (!f.alive) { toRemove.push(i); continue; }\n\n      if (f.phase === 'fall') {\n        f.vy = Math.min(140, f.vy + gAcc * dt);\n        // small oscillation for flutter\n        f.vx += Math.sin((f.y + i) * 0.02) * 7 * dt;\n        let nx = f.x + f.vx * dt;\n        let ny = f.y + f.vy * dt;\n\n        // Liquid interaction first\n        try {\n          if (typeof this.api.getLiquidSurfaceY === 'function') {\n            const sYwater = this.api.getLiquidSurfaceY('water', nx);\n            if (Number.isFinite(sYwater) && ny >= sYwater) {\n              // Land on water surface and rest for a bit\n              ny = sYwater - 0.5;\n              f.x = nx; f.y = ny; f.vx = 0; f.vy = 0;\n              f.phase = 'rest';\n              f.restMs = 800 + Math.random() * 400; // 0.8..1.2s\n              // Do not continue to solid collision checks this frame\n              // Update display and proceed to next flake\n              f.g.x = f.x; f.g.y = f.y;\n              continue;\n            }\n            const sYlava = this.api.getLiquidSurfaceY('lava', nx);\n            if (Number.isFinite(sYlava) && ny >= sYlava) {\n              // Steam puff and despawn\n              if (typeof this.api.onLavaImpact === 'function') this.api.onLavaImpact({ x: nx, y: sYlava, strength: 0.5 });\n              f.alive = false; toRemove.push(i); continue;\n            }\n          }\n        } catch {}\n\n        // Solid collision\n        if (this.api.isSolidAt(nx, ny)) {\n          // backtrack up to stand above the surface\n          let guard = 0;\n          while (this.api.isSolidAt(nx, ny) && guard < 10) { ny -= 1; guard++; }\n          f.settled = true;\n          f.vx = 0;\n          f.vy = 0;\n          f.phase = 'rest';\n          f.restMs = 800 + Math.random() * 400;\n        }\n\n        f.x = nx;\n        f.y = ny;\n      } else if (f.phase === 'rest') {\n        // Flake rests on surface for a short time (water or ground), then starts sinking/falling slowly\n        f.restMs -= dtMs;\n        if (f.restMs <= 0) {\n          f.phase = 'sinking';\n          // resume gentle fall with reduced alpha\n          f.vx = (Math.random() * 20 - 10);\n          f.vy = 20 + Math.random() * 20;\n        }\n      } else if (f.phase === 'sinking') {\n        // Continue downward slowly; fade out progressively\n        f.vy = Math.min(60, f.vy + gAcc * 0.3 * dt);\n        f.x += f.vx * dt;\n        f.y += f.vy * dt;\n        f.life -= 0.22 * dt;\n        if (f.life <= 0) { f.alive = false; toRemove.push(i); }\n      }\n\n      f.g.x = f.x;\n      f.g.y = f.y;\n      if (f.phase === 'rest' || f.phase === 'sinking' || f.settled) f.g.alpha = Math.max(0, Math.min(1, f.life));\n\n      if (f.y > this.height + 40 || f.x < -40 || f.x > this.width + 40) {\n        f.alive = false;\n        toRemove.push(i);\n      }\n    }\n\n    for (let j = toRemove.length - 1; j >= 0; j--) {\n      const idx = toRemove[j];\n      const f = this.flakes[idx];\n      if (f && f.g && f.g.parent) f.g.parent.removeChild(f.g);\n      if (f && f.g && f.g.destroy) try { f.g.destroy(); } catch {}\n      this.flakes.splice(idx, 1);\n    }\n  }\n\n  destroy() {\n    this.flakes.forEach(f => {\n      try { f.g.parent && f.g.parent.removeChild(f.g); } catch {}\n      try { f.g.destroy(); } catch {}\n    });\n    this.flakes = [];\n  }\n}\n","import { Graphics, BlurFilter } from 'pixi.js';\n\n// Clouds overlay: organic cloud blobs drifting in the top 30% of the screen.\nexport default class WeatherClouds {\n  constructor(container, api, getIntensity) {\n    this.container = container;\n    this.api = api;\n    this.getIntensity = getIntensity || (() => 0);\n    this.width = api.mapWidth * api.tileSize;\n    this.height = api.mapHeight * api.tileSize;\n    this.bandHeight = Math.max(1, Math.floor(this.height * 0.3)); // top 30%\n    this.patches = [];\n    this.intensity = 0;\n\n    // Soft blur for nicer cloud appearance\n    try {\n      this.container.filters = [new BlurFilter({ strength: 2.0, quality: 2 })];\n    } catch {}\n\n    this.rebuild();\n  }\n\n  setIntensity(v) {\n    const nv = Math.max(0, Math.min(100, Number(v) || 0));\n    if (nv === this.intensity) return;\n    this.intensity = nv;\n    this.rebuild();\n  }\n\n  rebuild() {\n    // Clear existing\n    for (const p of this.patches) {\n      try { p.g.parent && p.g.parent.removeChild(p.g); } catch {}\n      try { p.g.destroy(); } catch {}\n    }\n    this.patches = [];\n\n    const count = Math.round((this.intensity / 100) * 18); // a bit fewer than fog by default\n    for (let i = 0; i < count; i++) {\n      const g = new Graphics();\n      const w = 140 + Math.random() * 300; // cloud size\n      const h = 80 + Math.random() * 160;\n      const x = Math.random() * (this.width + 200) - 100;\n      const y = -40 + Math.random() * (this.bandHeight - 20); // only in band\n      const alpha = 0.08 + (this.intensity / 100) * (0.12 + Math.random() * 0.08);\n      const speed = 8 + Math.random() * 22; // horizontal drift speed\n      const vy = (Math.random() - 0.5) * 4; // subtle vertical drift\n\n      // Draw an organic cloud using overlapping circles (soft edges)\n      const rx = w * 0.5;\n      const ry = h * 0.5;\n      const circles = 8 + Math.floor(Math.random() * 6); // 8..13 lobes\n      const baseR = Math.min(rx, ry) * 0.55;\n      for (let k = 0; k < circles; k++) {\n        const t = (k / circles) * Math.PI * 2 + Math.random() * 0.6;\n        const dist = 0.2 + Math.random() * 0.35;\n        const cx = Math.cos(t) * rx * dist;\n        const cy = Math.sin(t) * ry * dist;\n        const r = baseR * (0.7 + Math.random() * 0.7);\n        g.circle(cx, cy, r);\n      }\n      // central mass\n      g.circle(0, 0, baseR * (0.9 + Math.random() * 0.5));\n      g.fill({ color: 0xffffff, alpha: 1.0 });\n      g.alpha = alpha;\n      g.x = x;\n      g.y = y;\n      this.container.addChild(g);\n      this.patches.push({ g, w, h, vx: speed * (Math.random() < 0.5 ? -1 : 1), vy, alpha, phase: Math.random() * Math.PI * 2 });\n    }\n  }\n\n  update(dtMs) {\n    // live intensity update\n    const cur = Math.max(0, Math.min(100, this.getIntensity()));\n    if (cur !== this.intensity) this.setIntensity(cur);\n\n    const dt = dtMs / 1000;\n    const W = this.width;\n    const bandTop = -100; // allow spawn/wrap margin above\n    const bandBottom = this.bandHeight - 20; // keep away from lower area\n    for (const p of this.patches) {\n      // drift\n      p.g.x += p.vx * dt;\n      p.g.y += p.vy * dt;\n\n      // very gentle alpha oscillation\n      p.phase += dt * 0.35;\n      const osc = (Math.sin(p.phase) + 1) * 0.5; // 0..1\n      p.g.alpha = Math.max(0.04, Math.min(0.55, p.alpha * (0.75 + 0.5 * osc)));\n\n      // wrap horizontally\n      if (p.g.x < -180) p.g.x = W + 180;\n      if (p.g.x > W + 180) p.g.x = -180;\n      // constrain within top band vertically (wrap within band only)\n      if (p.g.y < bandTop) p.g.y = bandBottom;\n      if (p.g.y > bandBottom) p.g.y = bandTop;\n    }\n  }\n\n  destroy() {\n    try { this.container.filters = []; } catch {}\n    for (const p of this.patches) {\n      try { p.g.parent && p.g.parent.removeChild(p.g); } catch {}\n      try { p.g.destroy(); } catch {}\n    }\n    this.patches = [];\n  }\n}\n","import { Graphics, Texture, TilingSprite } from 'pixi.js';\n\n// Full-screen fog overlay: a semi-transparent rectangle covering entire viewport.\n// Intensity 0..100 maps to alpha 0..0.65.\nexport default class WeatherFog {\n  constructor(container, api, getIntensity) {\n    this.container = container;\n    this.api = api;\n    this.getIntensity = getIntensity || (() => 0);\n    this.width = api.mapWidth * api.tileSize;\n    this.height = api.mapHeight * api.tileSize;\n    this.intensity = 0;\n    this.time = 0; // ms accumulator for subtle breathing\n\n    // Base tint rectangle drawn once; alpha controlled via displayObject alpha (no redraws per frame)\n    this.g = new Graphics();\n    this.container.addChild(this.g);\n\n    // Build procedural noise texture once (small size, repeats as tiling sprites)\n    this.noiseTex = WeatherFog._createNoiseTexture(128, 128);\n    this.layer1 = new TilingSprite(this.noiseTex, this.width, this.height);\n    this.layer2 = new TilingSprite(this.noiseTex, this.width, this.height);\n    // Different scales for parallax effect\n    this.layer1.tileScale.set(1.0, 1.0);\n    this.layer2.tileScale.set(0.6, 0.8);\n    // Start with zero alpha; will be set based on intensity\n    this.layer1.alpha = 0;\n    this.layer2.alpha = 0;\n    this.container.addChild(this.layer1);\n    this.container.addChild(this.layer2);\n\n    // Precompute parameters\n    this._recalcParams();\n    this._draw();\n  }\n\n  _alphaFromIntensity(v) {\n    const t = Math.max(0, Math.min(100, Number(v) || 0)) / 100; // 0..1\n    return Math.max(0, Math.min(0.65, t * 0.65));\n  }\n\n  setIntensity(v) {\n    const nv = Math.max(0, Math.min(100, Number(v) || 0));\n    if (nv === this.intensity) return;\n    this.intensity = nv;\n    this._recalcParams();\n    this._applyAlphas(0); // update layer alphas based on new intensity\n    this._draw();\n  }\n\n  resize(width, height) {\n    const w = Math.max(1, Math.floor(width));\n    const h = Math.max(1, Math.floor(height));\n    if (w === this.width && h === this.height) return;\n    this.width = w;\n    this.height = h;\n    // Resize tiling sprites and redraw base rect\n    if (this.layer1) { this.layer1.width = w; this.layer1.height = h; }\n    if (this.layer2) { this.layer2.width = w; this.layer2.height = h; }\n    this._draw();\n  }\n\n  _draw() {\n    const w = this.width;\n    const h = this.height;\n    const g = this.g;\n    g.clear();\n    const baseAlpha = this._alphaFromIntensity(this.intensity);\n    if (baseAlpha <= 0) {\n      g.alpha = 0;\n      return;\n    }\n    // Draw once with alpha 1, then control real alpha via g.alpha each frame\n    g.rect(0, 0, w, h);\n    g.fill({ color: 0x9fb7c9, alpha: 1 });\n    g.alpha = baseAlpha;\n  }\n\n  update(dtMs) {\n    // Live intensity update from settings\n    const cur = Math.max(0, Math.min(100, this.getIntensity()));\n    if (cur !== this.intensity) this.setIntensity(cur);\n\n    // Advance time for breathing/pulse\n    const dt = Math.max(0, Number(dtMs) || 16.67);\n    this.time += dt;\n    // Very subtle breathing: sine between ~0.96 .. 1.04\n    const pulse = 1 + 0.04 * Math.sin(this.time * 0.0012);\n    this._applyAlphas(pulse);\n\n    // Scroll noise layers slowly\n    if (this.layer1) {\n      this.layer1.tilePosition.x += this.speed1.x * dt;\n      this.layer1.tilePosition.y += this.speed1.y * dt;\n    }\n    if (this.layer2) {\n      this.layer2.tilePosition.x += this.speed2.x * dt;\n      this.layer2.tilePosition.y += this.speed2.y * dt;\n    }\n  }\n\n  destroy() {\n    if (this.g) {\n      try { this.g.parent && this.g.parent.removeChild(this.g); } catch {}\n      try { this.g.destroy(); } catch {}\n    }\n    this.g = null;\n    try {\n      if (this.layer1) { this.layer1.parent && this.layer1.parent.removeChild(this.layer1); this.layer1.destroy(true); }\n    } catch {}\n    try {\n      if (this.layer2) { this.layer2.parent && this.layer2.parent.removeChild(this.layer2); this.layer2.destroy(true); }\n    } catch {}\n    this.layer1 = null;\n    this.layer2 = null;\n    try { this.noiseTex?.destroy(true); } catch {}\n    this.noiseTex = null;\n  }\n\n  _applyAlphas(pulseFactor = 1) {\n    const base = this._alphaFromIntensity(this.intensity);\n    // Noise contribution grows with intensity but remains subtle\n    const t = Math.max(0, Math.min(1, this.intensity / 100));\n    const noiseAlpha = base * (0.25 + 0.35 * t); // up to ~0.4 of base\n    if (this.g) this.g.alpha = base * pulseFactor;\n    if (this.layer1) this.layer1.alpha = noiseAlpha * 0.8;\n    if (this.layer2) this.layer2.alpha = noiseAlpha;\n  }\n\n  _recalcParams() {\n    // Map intensity to drift speeds (pixels per ms)\n    const t = Math.max(0, Math.min(1, this.intensity / 100));\n    const lerp = (a, b, u) => a + (b - a) * u;\n    // Two layers drifting in different directions\n    this.speed1 = { x: lerp(0.005, 0.025, t), y: lerp(0.0, 0.012, t) };\n    this.speed2 = { x: lerp(-0.006, -0.018, t), y: lerp(0.004, 0.02, t) };\n  }\n\n  // Static helper: generate small grayscale noise texture\n  static _createNoiseTexture(w = 128, h = 128) {\n    const canvas = document.createElement('canvas');\n    canvas.width = w; canvas.height = h;\n    const ctx = canvas.getContext('2d');\n    const img = ctx.createImageData(w, h);\n    // Use a gentle noise range to avoid harsh contrast\n    for (let i = 0; i < img.data.length; i += 4) {\n      const v = 200 + Math.floor(Math.random() * 55); // 200..254\n      img.data[i] = v;\n      img.data[i + 1] = v;\n      img.data[i + 2] = v;\n      img.data[i + 3] = 255;\n    }\n    ctx.putImageData(img, 0, 0);\n    return Texture.from(canvas);\n  }\n}\n","import { Graphics, BlurFilter } from 'pixi.js';\n\n// Thunder/Lightning weather effect\n// API:\n//   new WeatherThunder(container, api, getIntensity)\n//   setIntensity(v), resize(w,h), update(dtMs), destroy()\n// Notes:\n// - Renders inside weather layer (below fog). Blocks/tiles remain above fog.\n// - Picks random strike targets above solid tiles using api.isSolidAt(x,y).\nexport default class WeatherThunder {\n  constructor(container, api, getIntensity) {\n    this.container = container;\n    this.api = api || {};\n    this.getIntensity = getIntensity || (() => 0);\n    this.width = (api?.mapWidth || 0) * (api?.tileSize || 32);\n    this.height = (api?.mapHeight || 0) * (api?.tileSize || 32);\n\n    this.intensity = 0;\n    this.time = 0;\n    this.nextStrikeMs = Infinity; // scheduled delay to next strike\n    this.flashAlpha = 0; // global white flash\n    this.flashDecay = 0.0;\n    this.boltAlive = false;\n    this.boltTime = 0; // ms since bolt spawned\n    this.boltDuration = 0; // ms total\n\n    // Graphics\n    this.flashG = new Graphics();\n    this.boltG = new Graphics();\n    // Add slight glow to bolt\n    try {\n      this.boltG.filters = [new BlurFilter(2, 1)];\n    } catch {}\n    this.container.addChild(this.flashG);\n    this.container.addChild(this.boltG);\n\n    // Build once\n    this._scheduleNextStrike(true);\n  }\n\n  setIntensity(v) {\n    const nv = Math.max(0, Math.min(100, Number(v) || 0));\n    if (nv === this.intensity) return;\n    this.intensity = nv;\n    if (nv <= 0) {\n      // disable visuals\n      this.flashAlpha = 0;\n      this.boltAlive = false;\n      this._redrawFlash();\n      this._clearBolt();\n      this.nextStrikeMs = Infinity;\n    } else if (!Number.isFinite(this.nextStrikeMs) || this.nextStrikeMs === Infinity) {\n      this._scheduleNextStrike(true);\n    }\n  }\n\n  resize(w, h) {\n    const W = Math.max(1, Math.floor(w));\n    const H = Math.max(1, Math.floor(h));\n    if (W === this.width && H === this.height) return;\n    this.width = W;\n    this.height = H;\n    // redraw flash when active\n    if (this.flashAlpha > 0) this._redrawFlash();\n  }\n\n  update(dtMs) {\n    // live intensity updates\n    const curInt = Math.max(0, Math.min(100, this.getIntensity()));\n    if (curInt !== this.intensity) this.setIntensity(curInt);\n\n    const dt = Math.max(0, Number(dtMs) || 16.67);\n    if (this.intensity <= 0) return;\n\n    // Update scheduling\n    this.nextStrikeMs -= dt;\n    if (this.nextStrikeMs <= 0) {\n      // Perform strike: trigger screen flash and draw bolt\n      this._triggerFlash();\n      this._createBolt();\n      this._scheduleNextStrike(false); // schedule next time after immediate strike window\n    }\n\n    // Flash decay\n    if (this.flashAlpha > 0) {\n      // exponential-like decay via linear factor raised with dt\n      const decayPerMs = this.flashDecay || 0.004; // higher = quicker fade\n      this.flashAlpha = Math.max(0, this.flashAlpha - decayPerMs * dt);\n      this._redrawFlash();\n    }\n\n    // Bolt lifetime\n    if (this.boltAlive) {\n      this.boltTime += dt;\n      const t = this.boltTime / Math.max(1, this.boltDuration);\n      // Fade color/alpha over time\n      const remain = Math.max(0, 1 - t);\n      this.boltG.alpha = 0.25 + 0.75 * remain;\n      if (this.boltTime >= this.boltDuration) {\n        this._clearBolt();\n      }\n    }\n  }\n\n  destroy() {\n    try { this.flashG.parent && this.flashG.parent.removeChild(this.flashG); } catch {}\n    try { this.flashG.destroy(true); } catch {}\n    try { this.boltG.parent && this.boltG.parent.removeChild(this.boltG); } catch {}\n    try { this.boltG.destroy(true); } catch {}\n    this.flashG = null;\n    this.boltG = null;\n    this.container = null;\n  }\n\n  // Internal helpers\n  _scheduleNextStrike(initial) {\n    // Map intensity 1..100 to delay: from ~9000..6000 ms down to ~2500..1000 ms\n    if (this.intensity <= 0) { this.nextStrikeMs = Infinity; return; }\n    const t = Math.max(0, Math.min(1, this.intensity / 100));\n    const minDelay = this._lerp(1000, 2500, 1 - t); // at high intensity, between 12.5s\n    const maxDelay = this._lerp(2500, 9000, 1 - t); // at low intensity, up to ~9s\n    const delay = this._rand(minDelay, maxDelay);\n    this.nextStrikeMs = initial ? this._rand(400, 1400) : delay; // first strike quicker on enable\n  }\n\n  _triggerFlash() {\n    // Brightness based on intensity, with slight randomness\n    const t = Math.max(0, Math.min(1, this.intensity / 100));\n    const base = this._lerp(0.25, 0.9, t);\n    this.flashAlpha = Math.min(1, base * this._rand(0.8, 1));\n    // fade time scales with intensity (brighter fades a bit slower)\n    this.flashDecay = this._lerp(0.008, 0.004, t);\n    this._redrawFlash();\n  }\n\n  _redrawFlash() {\n    const g = this.flashG;\n    g.clear();\n    if (this.flashAlpha <= 0) return;\n    g.rect(0, 0, this.width, this.height);\n    g.fill({ color: 0xffffff, alpha: this.flashAlpha });\n  }\n\n  _createBolt() {\n    // Determine target using solid scan from top\n    const W = this.width, H = this.height;\n    const x = Math.floor(this._rand(8, W - 8));\n    const topY = -Math.floor(this._rand(10, 40)); // start slightly above top\n    const targetY = this._findGroundY(x, H);\n    const endY = Number.isFinite(targetY) ? Math.max(0, targetY - this._rand(8, 16)) : Math.floor(H * 0.6);\n\n    // Build polyline with jittered segments from top to end\n    const segments = Math.max(8, Math.floor((endY - topY) / this._rand(10, 16)));\n    const jitterX = this._lerp(6, 18, Math.max(0, Math.min(1, this.intensity / 100)));\n    const points = [];\n    let cx = x;\n    let cy = topY;\n    points.push({ x: cx, y: cy });\n    for (let i = 1; i <= segments; i++) {\n      const ny = topY + Math.floor(((endY - topY) * i) / segments);\n      const nx = x + this._rand(-jitterX, jitterX);\n      cx = nx; cy = ny;\n      points.push({ x: cx, y: cy });\n    }\n\n    // Draw main bolt\n    const g = this.boltG;\n    g.clear();\n    const thickness = this._lerp(2, 5, Math.max(0, Math.min(1, this.intensity / 100)));\n    const color = 0xCCEEFF;\n    g.moveTo(points[0].x, points[0].y);\n    for (let i = 1; i < points.length; i++) g.lineTo(points[i].x, points[i].y);\n    g.stroke({ width: thickness, color, alpha: 1, alignment: 0.5, cap: 'round', join: 'round' });\n\n    // Branches: some short forks from random mid points\n    const branchCount = Math.floor(this._lerp(1, 3, Math.max(0, Math.min(1, this.intensity / 100))));\n    for (let b = 0; b < branchCount; b++) {\n      const idx = Math.floor(this._rand(2, points.length - 2));\n      const p = points[idx];\n      const len = this._rand(30, 80);\n      const ang = this._rand(-Math.PI * 0.5, Math.PI * 0.5);\n      const bx = p.x + Math.cos(ang) * len;\n      const by = p.y + Math.sin(ang) * len;\n      g.moveTo(p.x, p.y);\n      g.lineTo(bx, by);\n      g.stroke({ width: Math.max(1, thickness * 0.55), color, alpha: 0.9, alignment: 0.5 });\n    }\n\n    this.boltAlive = true;\n    this.boltTime = 0;\n    this.boltDuration = this._rand(120, 260); // very brief\n    this.boltG.alpha = 1;\n  }\n\n  _clearBolt() {\n    if (!this.boltG) return;\n    this.boltAlive = false;\n    this.boltTime = 0;\n    this.boltDuration = 0;\n    try { this.boltG.clear(); } catch {}\n  }\n\n  _findGroundY(worldX, maxH) {\n    // Scan from top to bottom to find first solid tile boundary\n    const isSolid = this.api?.isSolidAt;\n    if (typeof isSolid !== 'function') return null;\n    for (let y = 0; y < maxH; y += 4) {\n      if (isSolid(worldX, y)) {\n        return y;\n      }\n    }\n    return null;\n  }\n\n  _rand(a, b) {\n    if (b === undefined) { b = a; a = 0; }\n    return a + Math.random() * (b - a);\n  }\n\n  _lerp(a, b, t) { return a + (b - a) * t; }\n}\n","import { Container, Graphics } from 'pixi.js';\n\n// WaterSplashFX: lightweight pooled splash particles (droplets + ring ripples)\n// API:\n//   const fx = new WaterSplashFX(container)\n//   fx.trigger({ x, y, strength, upward }) // upward=true for exit splash\n//   fx.update(dtMs)\n//   fx.resize(w,h) // noop (kept for symmetry)\n//   fx.destroy()\nexport default class WaterSplashFX {\n  constructor(container) {\n    this.container = container;\n    this.node = new Container();\n    this.container.addChild(this.node);\n    this.droplets = []; // {g,x,y,vx,vy,life,max}\n    this.rings = [];    // {g,x,y,r,vr,life,max}\n    this.maxDroplets = 48;\n    this.maxRings = 6;\n  }\n\n  destroy() {\n    try { this.node.parent && this.node.parent.removeChild(this.node); } catch {}\n    try { this.node.destroy({ children: true }); } catch {}\n    this.node = null;\n    this.droplets = [];\n    this.rings = [];\n  }\n\n  resize() {}\n\n  trigger({ x = 0, y = 0, strength = 1, upward = false } = {}) {\n    const s = Math.max(0.2, Math.min(3, Number(strength) || 1));\n    // Ring ripple on surface (entry/exit)\n    if (this.rings.length < this.maxRings) {\n      const g = new Graphics();\n      g.x = 0; g.y = 0; g.alpha = 0.8;\n      this.node.addChild(g);\n      this.rings.push({ g, x, y, r: 2 + 4 * s, vr: 0.08 + 0.12 * s, life: 0, max: 450 + 250 * s });\n    }\n    // Droplets burst\n    const count = Math.floor(8 + 18 * s);\n    for (let i = 0; i < count && this.droplets.length < this.maxDroplets; i++) {\n      const ang = upward ? (-Math.PI * 0.15 + Math.random() * Math.PI * 0.3) : (Math.PI * 0.6 + (Math.random() - 0.5) * Math.PI * 0.6);\n      const spd = (0.12 + Math.random() * 0.25) * (upward ? 1.2 : 1) * (0.6 + 0.8 * s);\n      const g = new Graphics();\n      g.x = 0; g.y = 0; g.alpha = 1;\n      this.node.addChild(g);\n      this.droplets.push({ g, x, y, vx: Math.cos(ang) * spd, vy: Math.sin(ang) * spd, life: 0, max: 500 + Math.random() * 400 });\n    }\n  }\n\n  update(dtMs) {\n    const dt = Math.max(0, Number(dtMs) || 16.67);\n    // Droplets update\n    for (let i = this.droplets.length - 1; i >= 0; i--) {\n      const d = this.droplets[i];\n      d.life += dt;\n      d.vy += 0.0018 * dt; // gravity\n      d.x += d.vx * dt;\n      d.y += d.vy * dt;\n      const t = Math.min(1, d.life / d.max);\n      const alpha = 1 - t;\n      const size = 1 + 1.5 * (1 - t);\n      const g = d.g; g.clear();\n      g.circle(d.x, d.y, size);\n      g.fill({ color: 0xc9ecff, alpha: Math.max(0, alpha) });\n      if (d.life >= d.max) {\n        try { g.parent && g.parent.removeChild(g); } catch {}\n        try { g.destroy(); } catch {}\n        this.droplets.splice(i, 1);\n      }\n    }\n    // Rings update\n    for (let i = this.rings.length - 1; i >= 0; i--) {\n      const r = this.rings[i];\n      r.life += dt;\n      r.r += r.vr * dt;\n      const t = Math.min(1, r.life / r.max);\n      const alpha = 0.6 * (1 - t);\n      const g = r.g; g.clear();\n      g.circle(r.x, r.y, r.r);\n      g.stroke({ width: 1.5, color: 0xc9ecff, alpha: Math.max(0, alpha) });\n      if (r.life >= r.max) {\n        try { g.parent && g.parent.removeChild(g); } catch {}\n        try { g.destroy(); } catch {}\n        this.rings.splice(i, 1);\n      }\n    }\n  }\n}\n","import { Container, Graphics } from 'pixi.js';\n\n// LavaEmbers: ambient embers with tiny smoke trails spawning from lava surface tiles\n// API:\n//   const fx = new LavaEmbers(container, api, getIntensity)\n//   fx.setIntensity(v)\n//   fx.rebuildSurfaces({ mapWidth, mapHeight, tileSize, tileMapData, registryItems })\n//   fx.update(dtMs)\n//   fx.resize(w,h)\n//   fx.destroy()\nexport default class LavaEmbers {\n  constructor(container, api, getIntensity) {\n    this.container = container;\n    this.api = api || {};\n    this.getIntensity = getIntensity || (() => 0);\n    this.node = new Container();\n    this.container.addChild(this.node);\n    this.intensity = 0;\n    this.time = 0;\n    this.spawnAcc = 0;\n    this.embers = []; // {g,x,y,vx,vy,life,max,trail}\n    this.maxEmbers = 60;\n    this.surfaces = []; // {x,y,w}\n  }\n\n  destroy() {\n    try { this.node.parent && this.node.parent.removeChild(this.node); } catch {}\n    try { this.node.destroy({ children: true }); } catch {}\n    this.embers = [];\n    this.surfaces = [];\n  }\n\n  setIntensity(v) {\n    const nv = Math.max(0, Math.min(100, Number(v) || 0));\n    this.intensity = nv;\n  }\n\n  resize() {}\n\n  rebuildSurfaces({ mapWidth, mapHeight, tileSize, tileMapData, registryItems }) {\n    const getDef = (id) => Array.isArray(registryItems) ? registryItems.find(r => r.id === id) : null;\n    const isLava = (def) => !!(def && def.flags && def.flags.lava);\n    const W = mapWidth, H = mapHeight, TS = tileSize;\n    const spans = [];\n    for (let gy = 0; gy < H; gy++) {\n      let runStart = -1;\n      for (let gx = 0; gx < W; gx++) {\n        const idx = gy * W + gx;\n        const id = tileMapData[idx];\n        if (!id) { if (runStart !== -1) { runStart = -1; } continue; }\n        const def = getDef(id);\n        const aboveIdx = (gy - 1) * W + gx;\n        const aboveLava = gy > 0 && isLava(getDef(tileMapData[aboveIdx]));\n        const hereLava = isLava(def);\n        const isSurface = hereLava && !aboveLava;\n        if (isSurface) {\n          if (runStart === -1) runStart = gx;\n        } else {\n          if (runStart !== -1) {\n            const w = (gx - runStart) * TS;\n            if (w > 0) spans.push({ x: runStart * TS, y: gy * TS, w });\n            runStart = -1;\n          }\n        }\n      }\n      if (runStart !== -1) {\n        const w = (W - runStart) * TS;\n        if (w > 0) spans.push({ x: runStart * TS, y: gy * TS, w });\n      }\n    }\n    this.surfaces = spans;\n  }\n\n  _spawnOne() {\n    if (!this.surfaces.length) return;\n    if (this.embers.length >= this.maxEmbers) return;\n    const s = this.surfaces[Math.floor(Math.random() * this.surfaces.length)];\n    const x = s.x + Math.random() * s.w;\n    const y = s.y - 2; // just above surface\n    const g = new Graphics();\n    this.node.addChild(g);\n    const vx = (Math.random() - 0.5) * 0.02; // small horizontal drift\n    const vy = -0.05 - Math.random() * 0.06; // initial upward\n    const life = 0; const max = 1200 + Math.random() * 1200; // 1.2..2.4s\n    this.embers.push({ g, x, y, vx, vy, life, max, trail: [] });\n  }\n\n  update(dtMs) {\n    const dt = Math.max(0, Number(dtMs) || 16.67);\n    // live intensity\n    const cur = Math.max(0, Math.min(100, this.getIntensity()))\n    this.setIntensity(cur);\n    if (this.intensity <= 0) return;\n\n    // Spawn rate depends on intensity and surface count\n    const baseRate = 0.0015 + 0.0035 * (this.intensity / 100); // embers per ms\n    const mult = Math.max(0.5, Math.min(3, this.surfaces.length / 6));\n    this.spawnAcc += dt * baseRate * mult;\n    while (this.spawnAcc >= 1) {\n      this._spawnOne();\n      this.spawnAcc -= 1;\n    }\n\n    // Update embers\n    for (let i = this.embers.length - 1; i >= 0; i--) {\n      const e = this.embers[i];\n      e.life += dt;\n      // motion: rise then fall slightly\n      e.vy += 0.00006 * dt; // gravity slowly pulls down\n      e.x += e.vx * dt;\n      e.y += e.vy * dt;\n      // record simple smoke trail points\n      if (e.trail.length < 14) e.trail.push({ x: e.x, y: e.y });\n      else { e.trail.shift(); e.trail.push({ x: e.x, y: e.y }); }\n\n      const t = Math.min(1, e.life / e.max);\n      const emberAlpha = 1 - t;\n      const emberSize = 1 + 1.5 * (1 - t);\n      const g = e.g; g.clear();\n      // smoke trail (fainter)\n      for (let k = 1; k < e.trail.length; k++) {\n        const p0 = e.trail[k - 1]; const p1 = e.trail[k];\n        g.moveTo(p0.x, p0.y);\n        g.lineTo(p1.x, p1.y);\n      }\n      g.stroke({ width: 1, color: 0x555555, alpha: 0.25 * emberAlpha });\n\n      // glowing ember\n      g.circle(e.x, e.y, emberSize);\n      g.fill({ color: 0xffa229, alpha: 0.9 * emberAlpha });\n\n      if (e.life >= e.max) {\n        try { g.parent && g.parent.removeChild(g); } catch {}\n        try { g.destroy(); } catch {}\n        this.embers.splice(i, 1);\n      }\n    }\n  }\n}\n","import { Container, Graphics } from 'pixi.js';\n\n// LavaSteamFX: tiny steam puffs when rain/snow hits lava surface\n// API:\n//   const steam = new LavaSteamFX(parentContainer)\n//   steam.trigger({ x, y, strength })\n//   steam.update(dtMs)\n//   steam.destroy()\nexport default class LavaSteamFX {\n  constructor(container) {\n    this.container = container;\n    this.node = new Container();\n    this.container.addChild(this.node);\n    this.puffs = []; // {g,x,y,vx,vy,life,max,r}\n    this.maxPuffs = 80;\n  }\n\n  destroy() {\n    try { this.node.parent && this.node.parent.removeChild(this.node); } catch {}\n    try { this.node.destroy({ children: true }); } catch {}\n    this.node = null;\n    this.puffs = [];\n  }\n\n  resize() {}\n\n  trigger({ x = 0, y = 0, strength = 0.7 } = {}) {\n    const s = Math.max(0.2, Math.min(2.5, Number(strength) || 0.7));\n    const count = Math.max(2, Math.floor(3 + 4 * s));\n    for (let i = 0; i < count && this.puffs.length < this.maxPuffs; i++) {\n      const g = new Graphics();\n      this.node.addChild(g);\n      const vx = (Math.random() - 0.5) * (0.03 + 0.03 * s);\n      const vy = -(0.08 + Math.random() * 0.08) * (0.8 + 0.4 * s);\n      const r = 1.5 + Math.random() * (2.5 * s);\n      const max = 450 + Math.random() * 350;\n      this.puffs.push({ g, x, y: y - 2, vx, vy, life: 0, max, r });\n    }\n  }\n\n  update(dtMs) {\n    const dt = Math.max(0, Number(dtMs) || 16.67);\n    for (let i = this.puffs.length - 1; i >= 0; i--) {\n      const p = this.puffs[i];\n      p.life += dt;\n      p.x += p.vx * dt;\n      p.y += p.vy * dt;\n      // slight expansion and fade\n      const t = Math.min(1, p.life / p.max);\n      const alpha = 0.75 * (1 - t);\n      const radius = p.r * (1 + 0.8 * t);\n      const g = p.g; g.clear();\n      // soft grey-white steam\n      g.circle(p.x, p.y, radius);\n      g.fill({ color: 0xdfdad2, alpha: Math.max(0, alpha) });\n      if (p.life >= p.max) {\n        try { g.parent && g.parent.removeChild(g); } catch {}\n        try { g.destroy(); } catch {}\n        this.puffs.splice(i, 1);\n      }\n    }\n  }\n}\n","import { Container, Graphics, Texture, TilingSprite } from 'pixi.js';\n\n// LiquidRegionSystem: groups contiguous liquid tiles (water/lava) into regions\n// and renders each region as a masked, animated tiling surface (weather-like style)\n// while constrained to the exact sector (region) shape.\n//\n// API:\n//   const sys = new LiquidRegionSystem(parentContainer, { mapWidth, mapHeight, tileSize });\n//   sys.build({ mapWidth, mapHeight, tileSize, tileMapData, registryItems });\n//   sys.update(dtMs);\n//   sys.resize(mapWidth, mapHeight, tileSize);\n//   sys.destroy();\n\nexport default class LiquidRegionSystem {\n  constructor(container, opts = {}) {\n    this.container = container;\n    this.mapWidth = opts.mapWidth || 0;\n    this.mapHeight = opts.mapHeight || 0;\n    this.tileSize = opts.tileSize || 32;\n    this._regions = []; // { type, node, mask, sprite, noise1, noise2, capG, topEdges, waves:[] }\n    this._waterTex = null;\n    this._lavaTex = null;\n    this._time = 0;\n    this._noiseTex = null;\n    this._playerState = null; // Will be set from PixiStage\n  }\n\n  setPlayerState(playerState) {\n    this._playerState = playerState;\n  }\n\n  _checkPlayerInRegion(region) {\n    if (!this._playerState || !region || !region.node) return false;\n    const p = this._playerState;\n    const px = p.x || 0;\n    const py = p.y || 0;\n    const pw = p.width || 32;\n    const ph = p.height || 32;\n    // Simple AABB check against region bounds\n    const b = region.node.getBounds();\n    return (px + pw > b.x && px < b.x + b.width && py + ph > b.y && py < b.y + b.height);\n  }\n\n  // Query approximate surface Y (pixel) for a given X within liquid regions of type ('water'|'lava')\n  getSurfaceY(type, x) {\n    if (!Array.isArray(this._regions) || this._regions.length === 0) return null;\n    const X = Math.max(0, Math.floor(Number(x) || 0));\n    for (const r of this._regions) {\n      if (r.type !== type) continue;\n      if (!Array.isArray(r.topEdges)) continue;\n      for (let i = 0; i < r.topEdges.length; i++) {\n        const e = r.topEdges[i];\n        if (X >= e.x && X <= e.x + e.w) {\n          return e.y; // region tile top in pixels\n        }\n      }\n    }\n    return null;\n  }\n\n  destroy() {\n    try {\n      for (const r of this._regions) {\n        try { if (r.node && r.node.parent) r.node.parent.removeChild(r.node); } catch {}\n        try { r.node?.destroy({ children: true }); } catch {}\n      }\n    } catch {}\n    this._regions = [];\n    try { this._waterTex?.destroy(true); } catch {}\n    try { this._lavaTex?.destroy(true); } catch {}\n    try { this._noiseTex?.destroy(true); } catch {}\n    this._waterTex = null;\n    this._lavaTex = null;\n    this._noiseTex = null;\n  }\n\n  clear() {\n    for (const r of this._regions) {\n      try { r.node?.parent && r.node.parent.removeChild(r.node); } catch {}\n      try { r.node?.destroy({ children: true }); } catch {}\n    }\n    this._regions = [];\n  }\n\n  resize(mapWidth, mapHeight, tileSize) {\n    const mw = Math.max(1, mapWidth | 0);\n    const mh = Math.max(1, mapHeight | 0);\n    const ts = Math.max(1, tileSize | 0);\n    const changed = mw !== this.mapWidth || mh !== this.mapHeight || ts !== this.tileSize;\n    this.mapWidth = mw; this.mapHeight = mh; this.tileSize = ts;\n    if (changed) {\n      // rebuild textures at new tile size; regions will be rebuilt by caller\n      try { this._waterTex?.destroy(true); } catch {}\n      try { this._lavaTex?.destroy(true); } catch {}\n      this._waterTex = null; this._lavaTex = null;\n    }\n  }\n\n  update(dtMs) {\n    const dt = Math.max(0, Number(dtMs) || 16.67);\n    this._time += dt;\n    // Gentle drift speeds (px/ms) per liquid type\n    const waterDrift = { x: 0.010, y: 0.004 };\n    const lavaDrift = { x: -0.012, y: 0.006 };\n    for (const r of this._regions) {\n      const sprite = r.sprite;\n      if (!sprite) continue;\n      const drift = r.type === 'lava' ? lavaDrift : waterDrift;\n      sprite.tilePosition.x += drift.x * dt;\n      sprite.tilePosition.y += drift.y * dt;\n      // Alpha: normally opaque, but becomes transparent when player is inside!\n      // (We'll detect player position and adjust alpha accordingly)\n      if (r.type === 'water') {\n        // Check if player is in this water region (simplified check)\n        const playerInRegion = this._checkPlayerInRegion(r);\n        if (playerInRegion) {\n          sprite.alpha = 0.50; // Transparent when player is inside - can see player/items!\n        } else {\n          sprite.alpha = 0.95; // Opaque when player is outside\n        }\n      } else {\n        // Lava\n        const playerInRegion = this._checkPlayerInRegion(r);\n        if (playerInRegion) {\n          sprite.alpha = 0.60; // Transparent when player is inside\n        } else {\n          sprite.alpha = 0.95; // Opaque when player is outside\n        }\n      }\n\n      // Animate noise overlays to break repetition\n      if (r.noise1) {\n        r.noise1.tilePosition.x += drift.x * 1.6 * dt;\n        r.noise1.tilePosition.y += drift.y * 1.2 * dt;\n      }\n      if (r.noise2) {\n        r.noise2.tilePosition.x += -drift.x * 1.1 * dt;\n        r.noise2.tilePosition.y += drift.y * 0.9 * dt;\n      }\n\n      // Update interactive surface waves (small ripples from impacts)\n      if (!Array.isArray(r.waves)) r.waves = [];\n      if (r.waves.length) {\n        for (let i = r.waves.length - 1; i >= 0; i--) {\n          const w = r.waves[i];\n          w.t += dt; // ms\n          // Lifetimes: water longer than lava\n          const life = r.type === 'water' ? w.lifeMsWater : w.lifeMsLava;\n          if (w.t >= life) { r.waves.splice(i, 1); continue; }\n          // expand radius over time (px)\n          w.radius = w.startRadius + w.speed * (w.t / 1000);\n          // exponential decay of amplitude\n          const decay = Math.exp(-w.t / (r.type === 'water' ? 1400 : 900));\n          w.ampNow = w.amp * decay;\n        }\n      }\n\n      // Animate water surface cap (rim light) with slight sine undulation\n      if (r.type === 'water' && r.capG && Array.isArray(r.topEdges) && r.topEdges.length) {\n        const g = r.capG;\n        const amp = Math.max(1, Math.floor(this.tileSize * 0.06));\n        const thickness = Math.max(1, Math.floor(this.tileSize * 0.08));\n        g.clear();\n        for (let i = 0; i < r.topEdges.length; i++) {\n          const e = r.topEdges[i];\n          // slight vertical offset wave\n          let dy = Math.sin((this._time * 0.002) + e.x * 0.15) * (amp * 0.5);\n          // Add contributions from interactive waves (Gaussian falloff)\n          if (r.waves && r.waves.length) {\n            // use span center for sampling; keeps draw perf O(spans + waves)\n            const centerX = e.x + e.w * 0.5;\n            for (let k = 0; k < r.waves.length; k++) {\n              const w = r.waves[k];\n              const dx = centerX - w.cx;\n              const dist = Math.abs(dx);\n              if (dist > w.radius + e.w * 0.6) continue; // early reject\n              const sigma = Math.max(8, w.radius * 0.6);\n              const gauss = Math.exp(-(dx * dx) / (2 * sigma * sigma));\n              dy += w.ampNow * gauss;\n            }\n            // clamp to avoid excessive displacement\n            const maxDisp = Math.max(2, this.tileSize * 0.22);\n            if (dy > maxDisp) dy = maxDisp;\n            if (dy < -maxDisp) dy = -maxDisp;\n          }\n          g.rect(e.x, e.y - thickness + dy, e.w, thickness);\n        }\n        g.fill({ color: 0xc9ecff, alpha: 0.35 });\n      }\n    }\n  }\n\n  build({ mapWidth, mapHeight, tileSize, tileMapData, registryItems }) {\n    if (!Array.isArray(tileMapData) || !Array.isArray(registryItems)) return;\n    this.resize(mapWidth, mapHeight, tileSize);\n    this.clear();\n\n    const W = this.mapWidth;\n    const H = this.mapHeight;\n    const TS = this.tileSize;\n    const count = W * H;\n\n    const getDef = (id) => registryItems.find((r) => r.id === id);\n    const typeAt = (i) => {\n      const id = tileMapData[i];\n      if (!id) return null;\n      const def = getDef(id);\n      if (!def || !def.flags || !def.flags.liquid) return null;\n      if (def.flags.water) return 'water';\n      if (def.flags.lava) return 'lava';\n      return 'liquid';\n    };\n\n    const visited = new Uint8Array(count);\n    const dirs = [1, -1, W, -W]; // 4-connectivity\n\n    for (let i = 0; i < count; i++) {\n      if (visited[i]) continue;\n      const t = typeAt(i);\n      if (!t) { visited[i] = 1; continue; }\n\n      // Flood fill this region for same liquid type\n      const regionTiles = [];\n      const queue = [i];\n      visited[i] = 1;\n      while (queue.length) {\n        const idx = queue.pop();\n        regionTiles.push(idx);\n        for (let d = 0; d < 4; d++) {\n          const n = idx + dirs[d];\n          if (n < 0 || n >= count) continue;\n          if (visited[n]) continue;\n          // prevent wrapping on left/right when using +/-1\n          if (d < 2) {\n            const row = Math.floor(idx / W);\n            const nrow = Math.floor(n / W);\n            if (row !== nrow) continue;\n          }\n          const nt = typeAt(n);\n          if (nt === t) { visited[n] = 1; queue.push(n); }\n          else { visited[n] = visited[n] || 0; }\n        }\n      }\n\n      if (regionTiles.length === 0) continue;\n      this._addRegion(t, regionTiles, W, H, TS);\n    }\n  }\n\n      _addRegion(type, tileIndices, mapWidth, mapHeight, tileSize) {\n        const node = new Container();\n        const mask = new Graphics();\n        // SVARGI: v8 maskas labk strd bez addChild, ja ts ir Graphics\n        const worldW = mapWidth * tileSize;\n        const worldH = mapHeight * tileSize;\n\n        mask.clear();\n        const bleed = 1; // Palielints bleed, lai nosegtu spraugas\n        for (let k = 0; k < tileIndices.length; k++) {\n          const idx = tileIndices[k];\n          const gx = (idx % mapWidth);\n          const gy = Math.floor(idx / mapWidth);\n          mask.rect(\n            gx * tileSize - bleed,\n            gy * tileSize - bleed,\n            tileSize + bleed * 2,\n            tileSize + bleed * 2\n          );\n        }\n        mask.fill({ color: 0xffffff, alpha: 1 });\n\n        const tex = type === 'lava' ? (this._lavaTex || (this._lavaTex = this._createLavaTexture(tileSize)))\n                                     : (this._waterTex || (this._waterTex = this._createWaterTexture(tileSize)));\n        \n        // v8 addressMode iestatana\n        if (tex.source && tex.source.style) {\n          tex.source.style.addressMode = 'repeat';\n        }\n\n        const tiling = new TilingSprite({\n          texture: tex,\n          width: worldW,\n          height: worldH\n        });\n        \n        tiling.tileScale.set(1, 1);\n        tiling.alpha = type === 'lava' ? 0.98 : 0.92;\n        node.addChild(tiling);\n\n        // Noise sli\n        const noiseTex = this._noiseTex || (this._noiseTex = this._createNoiseTexture(256, 256));\n        if (noiseTex.source && noiseTex.source.style) {\n          noiseTex.source.style.addressMode = 'repeat';\n        }\n\n        const noise1 = new TilingSprite({ texture: noiseTex, width: worldW, height: worldH });\n        const noise2 = new TilingSprite({ texture: noiseTex, width: worldW, height: worldH });\n        \n        if (type === 'water') {\n          noise1.alpha = 0.08; noise2.alpha = 0.1;\n        } else {\n          noise1.alpha = 0.12; noise2.alpha = 0.15;\n        }\n        node.addChild(noise1, noise2);\n\n        // LABOJUMS: Maska tiek pievienota k brns, lai t sekotu ldzi node koordintm\n        node.addChild(mask);\n        node.mask = mask;\n\n        if (type === 'water') {\n          const capG = new Graphics();\n          node.addChild(capG);\n          const topEdges = this._computeTopEdgeSpans(tileIndices, mapWidth, tileSize);\n          // Saglabjam atsauces uz r reistr\n          this._regions.push({ type, node, mask, sprite: tiling, noise1, noise2, capG, topEdges, waves: [] });\n        } else {\n          this._regions.push({ type, node, mask, sprite: tiling, noise1, noise2, waves: [] });\n        }\n\n        this.container.addChild(node);\n      }\n\n      _createWaterTexture(tileSize) {\n        const canvas = document.createElement('canvas');\n        const size = 64; // Power of Two obligts v8 tilingam\n        canvas.width = size; canvas.height = size;\n        const ctx = canvas.getContext('2d');\n\n        // SEAMLESS gradients (skums un beigas ir #3a7fb8)\n        const g = ctx.createLinearGradient(0, 0, 0, size);\n        g.addColorStop(0, '#3a7fb8');   \n        g.addColorStop(0.5, '#5ba3d9'); \n        g.addColorStop(1, '#3a7fb8');   \n        ctx.fillStyle = g;\n        ctx.fillRect(0, 0, size, size);\n\n        return Texture.from(canvas);\n      }\n\n      _createLavaTexture(tileSize) {\n        const canvas = document.createElement('canvas');\n        const size = 64; \n        canvas.width = size; canvas.height = size;\n        const ctx = canvas.getContext('2d');\n\n        // SEAMLESS gradients lavai\n        const g = ctx.createLinearGradient(0, 0, 0, size);\n        g.addColorStop(0, '#ffa229');\n        g.addColorStop(0.5, '#ffb84d');\n        g.addColorStop(1, '#ffa229');\n        ctx.fillStyle = g;\n        ctx.fillRect(0, 0, size, size);\n\n        return Texture.from(canvas);\n  }\n\n  _createNoiseTexture(w = 256, h = 256) {\n    const canvas = document.createElement('canvas');\n    canvas.width = w; canvas.height = h;\n    const ctx = canvas.getContext('2d');\n    \n    ctx.fillStyle = '#ffffff';\n    for(let i=0; i<500; i++) {\n      ctx.globalAlpha = Math.random() * 0.05;\n      ctx.fillRect(Math.random()*w, Math.random()*h, 2, 2);\n    }\n\n    return Texture.from(canvas);\n  }\n\n  // Given tile indices of a region, compute horizontal spans representing its top boundary per row.\n  _computeTopEdgeSpans(tileIndices, mapWidth, tileSize) {\n    // Build a set for O(1) membership\n    const set = new Set(tileIndices);\n    const spans = [];\n    // For each tile that has no neighbor directly above, create a span; merge contiguous tiles in that row\n    const tilesByRow = new Map();\n    for (const idx of tileIndices) {\n      const gy = Math.floor(idx / mapWidth);\n      const gx = idx % mapWidth;\n      const above = idx - mapWidth;\n      if (!set.has(above)) {\n        // This tile contributes to the top edge\n        const rowList = tilesByRow.get(gy) || [];\n        rowList.push(gx);\n        tilesByRow.set(gy, rowList);\n      }\n    }\n    // Merge contiguous gx into spans\n    for (const [gy, cols] of tilesByRow.entries()) {\n      cols.sort((a, b) => a - b);\n      let start = null; let prev = null;\n      for (const gx of cols) {\n        if (start === null) { start = gx; prev = gx; continue; }\n        if (gx === prev + 1) { prev = gx; continue; }\n        // flush previous span\n        spans.push({ x: start * tileSize, y: gy * tileSize, w: (prev - start + 1) * tileSize });\n        start = gx; prev = gx;\n      }\n      if (start !== null) {\n        spans.push({ x: start * tileSize, y: gy * tileSize, w: (prev - start + 1) * tileSize });\n      }\n    }\n    return spans;\n  }\n\n  // Public: add a ripple/wave on a liquid surface of given type at world x\n  // type: 'water'|'lava'\n  // x: world pixel X\n  // strength: 0.2..3 roughly; maps to amplitude and speed\n  addWave(type, x, strength = 1) {\n    const t = (type === 'lava') ? 'lava' : 'water';\n    const X = Math.max(0, Math.min(this.mapWidth * this.tileSize, Number(x) || 0));\n    // Find region and a top edge span containing x\n    for (const r of this._regions) {\n      if (r.type !== t) continue;\n      const spans = r.topEdges;\n      if (!Array.isArray(spans) || spans.length === 0) continue;\n      for (let i = 0; i < spans.length; i++) {\n        const e = spans[i];\n        if (X >= e.x && X <= e.x + e.w) {\n          if (!Array.isArray(r.waves)) r.waves = [];\n          // Cap total waves to keep perf stable\n          if (r.waves.length > 24) r.waves.shift();\n          const ts = this.tileSize;\n          const s = Math.max(0.15, Math.min(3, Number(strength) || 1));\n          const baseAmp = (t === 'water') ? ts * 0.18 : ts * 0.10; // pixels\n          const amp = baseAmp * (0.4 + 0.6 * Math.min(1.0, s));\n          const speed = (t === 'water') ? (40 + 60 * s) : (30 + 40 * s); // px/s growth\n          const startRadius = Math.max(4, ts * 0.2);\n          // lifetimes in ms\n          const lifeMsWater = 1600 + 900 * s;\n          const lifeMsLava = 900 + 600 * s;\n          r.waves.push({ cx: X, t: 0, amp, ampNow: amp, speed, radius: startRadius, startRadius, lifeMsWater, lifeMsLava });\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n}\n","// Lightweight reusable health bar for PixiJS\n// Usage:\n//   import { HealthBar } from './HealthBar';\n//   const hb = new HealthBar({ width: 32, height: 4, offsetY: -6 });\n//   container.addChild(hb);\n//   hb.update(currentHealth, maxHealth);\n\nimport { Container, Graphics } from 'pixi.js';\n\nexport class HealthBar extends Container {\n  constructor(options = {}) {\n    super();\n    const {\n      width = 32,\n      height = 4,\n      offsetX = 0,\n      offsetY = -6,\n      thresholds = { warn: 0.55, danger: 0.35 },\n      colors = { ok: 0x2ecc71, warn: 0xf1c40f, danger: 0xe74c3c },\n      // Use a neutral gray track instead of near-black; keep border options for backward compat (unused)\n      trackColor = 0x666666,\n      borderColor = 0x000000,\n      borderAlpha = 0.8,\n    } = options;\n\n    this._w = Math.max(4, Math.floor(width));\n    this._h = Math.max(2, Math.floor(height));\n    this._pct = -1; // force first draw\n    this._color = 0xffffff;\n    this._thresholds = thresholds;\n    this._colors = colors;\n    this._trackColor = trackColor;\n    this._borderColor = borderColor;\n    this._borderAlpha = borderAlpha;\n\n    this.x = offsetX || 0;\n    this.y = offsetY || 0;\n\n    this._track = new Graphics();\n    this._fill = new Graphics();\n    this.addChild(this._track);\n    this.addChild(this._fill);\n\n    this._redrawAll();\n  }\n\n  resize(width, height) {\n    const w = Math.max(4, Math.floor(width || this._w));\n    const h = Math.max(2, Math.floor(height || this._h));\n    if (w === this._w && h === this._h) return;\n    this._w = w; this._h = h;\n    this._redrawAll();\n  }\n\n  update(current, max) {\n    const m = Math.max(0, Number(max) || 0);\n    if (m <= 0 || !Number.isFinite(current)) {\n      this.visible = false;\n      return;\n    }\n    const c = Math.max(0, Math.min(m, Number(current)));\n    const pct = m > 0 ? c / m : 0;\n    this.visible = true;\n\n    const color = pct < this._thresholds.danger\n      ? this._colors.danger\n      : (pct < this._thresholds.warn ? this._colors.warn : this._colors.ok);\n\n    // Only redraw fill if percent or color changed noticeably\n    if (Math.abs(pct - this._pct) > 0.001 || color !== this._color) {\n      this._pct = pct;\n      this._color = color;\n      this._redrawFill();\n    }\n  }\n\n  _redrawAll() {\n    // Track (no border)\n    const w = this._w, h = this._h;\n    this._track.clear();\n    this._track.roundRect(0, 0, w, h, Math.min(3, h * 0.5));\n    this._track.fill({ color: this._trackColor, alpha: 0.85 });\n    // Redraw fill with current state\n    this._redrawFill();\n  }\n\n  _redrawFill() {\n    const w = this._w, h = this._h;\n    const innerW = Math.max(0, Math.floor(w * Math.max(0, Math.min(1, this._pct))));\n    const radius = Math.min(2, Math.floor(h / 2));\n    this._fill.clear();\n    if (innerW <= 0) return;\n    this._fill.roundRect(0, 0, innerW, h, radius);\n    this._fill.fill({ color: this._color, alpha: 1 });\n  }\n}\n\nexport default HealthBar;\n","// Centralized z-order constants for Pixi stage layers\n// Higher numbers render above lower numbers when sortableChildren = true\nexport const LAYERS = Object.freeze({\n  parallax: 10,\n  tiles: 20,\n  tilesAnim: 25,\n  objBehind: 30,\n  secretsBelow: 35,\n  player: 40,\n  projectiles: 50,\n  objFront: 60,\n  secretsAbove: 65,\n  weather: 70,\n  fog: 80,\n  liquids: 90,\n  liquidFx: 100,\n  overlay: 110,\n});\n\nexport default LAYERS;\n","import { Texture } from 'pixi.js';\n\n// Small helper cache for textures\nconst textureCacheMap = new Map();\n\nexport const getTexture = (url) => {\n  if (!url) {\n    console.warn('[getTexture] No URL provided');\n    return null;\n  }\n  if (textureCacheMap.has(url)) {\n    return textureCacheMap.get(url);\n  }\n  try {\n    const tex = Texture.from(url);\n    if (!tex) {\n      console.warn('[getTexture] Failed to create texture from URL:', url);\n      return null;\n    }\n    textureCacheMap.set(url, tex);\n    return tex;\n  } catch (e) {\n    console.error('[getTexture] Error creating texture:', url, e);\n    return null;\n  }\n};\n\nexport const clearTextureCache = () => {\n  textureCacheMap.forEach((t) => t.destroy && t.destroy(true));\n  textureCacheMap.clear();\n};\n\n// Background images resolver (from src/assets/background)\n// Meta stores `/assets/background/<name>`\nexport const createBackgroundResolver = () => {\n  let bgContext;\n  try {\n    // webpack require.context (CRA)\n    // relative to this file: '../../../../assets/background'\n    bgContext = require.context('../../../../assets/background', false, /\\.(png|jpe?g|svg)$/);\n  } catch (e) {\n    bgContext = null;\n  }\n\n  return (metaPath) => {\n    if (!bgContext) {\n      console.warn('[BackgroundResolver] No bgContext available');\n      return null;\n    }\n    if (!metaPath) {\n      const keys = bgContext.keys();\n      if (keys && keys.length) {\n        const mod = bgContext(keys[0]);\n        return mod.default || mod;\n      }\n      return null;\n    }\n    const name = metaPath.split('/').pop();\n    const rel = `./${name}`;\n    try {\n      const mod = bgContext(rel);\n      return mod.default || mod;\n    } catch (e) {\n      // fallback to first available\n      const keys = bgContext.keys();\n      if (keys && keys.length) {\n        const mod = bgContext(keys[0]);\n        return mod.default || mod;\n      }\n      return null;\n    }\n  };\n};\n\n// Convert ms-per-frame (JSON) to Pixi AnimatedSprite speed factor (1 = 60fps)\nexport const msToSpeed = (ms) => {\n  const m = Number(ms);\n  const msPerFrame = Number.isFinite(m) && m > 0 ? m : 500;\n  const fps = 1000 / msPerFrame;\n  return fps / 60; // Pixi speed factor\n};\n\n// Helper to get registry item by id\nexport const getRegItem = (registryItems, id) => registryItems.find((r) => r.id === id);\n\n// Solid collision helper for world tiles (used by weather systems)\nexport const createSolidChecker = (mapWidth, mapHeight, tileSize, tileMapData, registryItems) => {\n  return (wx, wy) => {\n    // Allow particles (snow/rain) to spawn above the top edge and fall into the world.\n    // Negative Y should NOT be treated as solid, otherwise flakes will \"settle\" off-screen.\n    if (wy < 0) return false;\n    // Keep left-of-world as solid to avoid pushing from outside horizontally.\n    if (wx < 0) return true;\n    const gx = Math.floor(wx / tileSize);\n    const gy = Math.floor(wy / tileSize);\n    if (gx < 0 || gy < 0 || gx >= mapWidth || gy >= mapHeight) return false; // below world is not solid\n    const idx = gy * mapWidth + gx;\n    const id = tileMapData[idx];\n    if (!id) return false;\n    const def = getRegItem(registryItems, id);\n    if (!def) return false;\n    const c = def.collision;\n    if (!c) return false;\n    if (c === true) return true;\n    if (typeof c === 'object') {\n      return !!(c.top || c.bottom || c.left || c.right);\n    }\n    return false;\n  };\n};\n","import { Texture } from 'pixi.js';\n\n// Generate procedural water frames (cached per tile size)\nexport const createWaterFrames = (tileSize) => {\n  const frames = [];\n  const F = 8; // frame count\n  for (let i = 0; i < F; i++) {\n    const canvas = document.createElement('canvas');\n    canvas.width = tileSize;\n    canvas.height = tileSize;\n    const ctx = canvas.getContext('2d');\n\n    // background gradient\n    const g = ctx.createLinearGradient(0, 0, 0, tileSize);\n    g.addColorStop(0, '#2a5d8f');\n    g.addColorStop(1, '#174369');\n    ctx.fillStyle = g;\n    ctx.fillRect(0, 0, tileSize, tileSize);\n\n    // animated ripples via sine stripes\n    ctx.globalAlpha = 0.25;\n    ctx.fillStyle = '#8fc0ff';\n    const t = i / F;\n    const bands = 3;\n    for (let b = 0; b < bands; b++) {\n      const y = Math.floor((tileSize / bands) * b + (tileSize / bands) * 0.5 + Math.sin((t + b * 0.33) * Math.PI * 2) * (tileSize * 0.08));\n      ctx.fillRect(0, y, tileSize, Math.max(1, Math.floor(tileSize * 0.06)));\n    }\n\n    // soft top highlight\n    ctx.globalAlpha = 0.18;\n    ctx.fillStyle = '#c9ecff';\n    ctx.fillRect(0, 0, tileSize, Math.max(1, Math.floor(tileSize * 0.12)));\n\n    const tex = Texture.from(canvas);\n    frames.push(tex);\n  }\n  return frames;\n};\n\n// Generate procedural lava frames (cached per tile size)\nexport const createLavaFrames = (tileSize) => {\n  const frames = [];\n  const F = 8;\n  for (let i = 0; i < F; i++) {\n    const canvas = document.createElement('canvas');\n    canvas.width = tileSize;\n    canvas.height = tileSize;\n    const ctx = canvas.getContext('2d');\n\n    // base gradient (dark red to orange)\n    const g = ctx.createLinearGradient(0, 0, 0, tileSize);\n    g.addColorStop(0, '#6b1a07');\n    g.addColorStop(1, '#c43f0f');\n    ctx.fillStyle = g;\n    ctx.fillRect(0, 0, tileSize, tileSize);\n\n    // glowing veins\n    const t = i / F;\n    ctx.globalAlpha = 0.3;\n    for (let b = 0; b < 3; b++) {\n      const y = Math.floor((tileSize / 3) * b + (tileSize / 3) * 0.5 + Math.sin((t * 2 + b * 0.6) * Math.PI * 2) * (tileSize * 0.1));\n      const h = Math.max(1, Math.floor(tileSize * 0.07));\n      const grad = ctx.createLinearGradient(0, y, 0, y + h);\n      grad.addColorStop(0, '#ffed8a');\n      grad.addColorStop(1, '#ff7b00');\n      ctx.fillStyle = grad;\n      ctx.fillRect(0, y, tileSize, h);\n    }\n\n    // bubbles/dots\n    ctx.globalAlpha = 0.25;\n    ctx.fillStyle = '#ffd36e';\n    const count = Math.max(2, Math.floor(tileSize * 0.12));\n    for (let k = 0; k < count; k++) {\n      const rx = Math.floor((k * 37 + i * 13) % tileSize);\n      const ry = Math.floor((k * 53 + i * 29) % tileSize);\n      ctx.fillRect(rx, ry, 1, 1);\n    }\n\n    const tex = Texture.from(canvas);\n    frames.push(tex);\n  }\n  return frames;\n};\n\n// Helpers to check if a definition is water or lava\nexport const isWaterDef = (def) => !!(def && def.flags && def.flags.water);\nexport const isLavaDef = (def) => !!(def && def.flags && def.flags.lava);\n","import { TilingSprite, Sprite, Texture, WRAP_MODES, BlurFilter, Assets } from 'pixi.js';\n\n// Parallax background helper. Manages background layers (solid color and image).\nexport class ParallaxBackground {\n  constructor(container, textureCache) {\n    this.container = container;\n    this.cache = textureCache;\n    this.bgSprite = null; // Solid color layer\n    this.imgSprite = null; // Image layer\n    this._worldW = 0;\n    this._worldH = 0;\n    this._lastCameraX = 0;\n    this._currentUrl = null;\n  }\n\n  build({ worldWidth, worldHeight, url, color, factor = 0.3, minWidth = 0, minHeight = 0 }) {\n    if (!this.container) return;\n    this.clear();\n\n    const w = Math.max(worldWidth, minWidth);\n    const h = Math.max(worldHeight, minHeight);\n\n    this._worldW = worldWidth;\n    this._worldH = worldHeight;\n    this._currentUrl = url;\n\n    // 1. Render solid color background FIRST (always present as base)\n    const hex = (typeof color === 'string' && color.startsWith('#'))\n      ? parseInt(color.slice(1), 16)\n      : (Number(color) || 0x87CEEB);\n    \n    const solid = new Sprite(Texture.WHITE);\n    solid.tint = hex;\n    solid.width = w;\n    solid.height = h;\n    solid.alpha = 1.0;\n    try {\n      solid.filters = [new BlurFilter({ strength: 0.8, quality: 2 })];\n    } catch {}\n    this.container.addChild(solid);\n    this.bgSprite = solid;\n\n    // 2. If URL is provided, attempt to load and render image on top\n    if (url) {\n      const setupImage = (tex) => {\n        if (!this.container || this._currentUrl !== url) return;\n        \n        // Remove old image if any\n        if (this.imgSprite) {\n          try { this.container.removeChild(this.imgSprite); } catch {}\n          try { this.imgSprite.destroy(); } catch {}\n          this.imgSprite = null;\n        }\n\n        if (!tex) {\n          console.warn('[ParallaxBackground] setupImage called with no texture');\n          return;\n        }\n\n        // Fix wrap mode for tiling\n        if (tex.baseTexture) tex.baseTexture.wrapMode = WRAP_MODES.REPEAT;\n        if (tex.source) tex.source.addressMode = 'repeat';\n\n        const sprite = new TilingSprite({ texture: tex, width: w, height: h });\n        const texH = (tex.height || (tex.source ? tex.source.height : 0) || 1);\n        const scaleY = h / texH;\n        sprite.tileScale.set(1, scaleY);\n        sprite.alpha = 1.0;\n        try {\n          sprite.filters = [new BlurFilter({ strength: 1.2, quality: 2 })];\n        } catch {}\n        \n        this.container.addChild(sprite);\n        this.imgSprite = sprite;\n        this.setScroll(this._lastCameraX || 0, factor);\n      };\n\n      // Try to get from Assets cache or Texture cache\n      let tex = null;\n      try {\n        tex = Assets.get(url);\n      } catch (e) {\n        tex = this.cache?.get(url) || Texture.from(url);\n      }\n\n      const isValid = tex && (\n        tex.valid || \n        (tex.baseTexture && tex.baseTexture.valid) || \n        (tex.source && tex.source.width > 0)\n      );\n\n      if (isValid) {\n        console.log('[ParallaxBackground] Texture already ready');\n        setupImage(tex);\n      } else {\n        console.log('[ParallaxBackground] Texture not ready, loading via Assets.load...');\n        Assets.load(url).then((loadedTex) => {\n          console.log('[ParallaxBackground] Texture loaded via Assets.load');\n          setupImage(loadedTex);\n        }).catch(err => {\n          console.error('[ParallaxBackground] Failed to load background image:', url, err);\n        });\n      }\n    }\n  }\n\n  setScroll(cameraX, factor = 0.3) {\n    this._lastCameraX = cameraX;\n    if (this.imgSprite && 'tilePosition' in this.imgSprite) {\n      this.imgSprite.tilePosition.x = -cameraX * factor;\n      this.imgSprite.tilePosition.y = 0;\n    }\n  }\n\n  resize(worldWidth, worldHeight, minWidth = 0, minHeight = 0) {\n    const w = Math.max(worldWidth, minWidth);\n    const h = Math.max(worldHeight, minHeight);\n\n    this._worldW = worldWidth;\n    this._worldH = worldHeight;\n    if (this.bgSprite) {\n      this.bgSprite.width = w;\n      this.bgSprite.height = h;\n    }\n    if (this.imgSprite) {\n      this.imgSprite.width = w;\n      this.imgSprite.height = h;\n      const tex = this.imgSprite.texture;\n      const texH = (tex?.height || (tex?.source ? tex.source.height : 0) || 1);\n      if (this.imgSprite.tileScale && texH > 0) {\n        const scaleY = h / texH;\n        this.imgSprite.tileScale.set(1, scaleY);\n      }\n    }\n  }\n\n  clear() {\n    if (this.bgSprite) {\n      try { this.container.removeChild(this.bgSprite); } catch {}\n      try { this.bgSprite.destroy(); } catch {}\n      this.bgSprite = null;\n    }\n    if (this.imgSprite) {\n      try { this.container.removeChild(this.imgSprite); } catch {}\n      try { this.imgSprite.destroy(); } catch {}\n      this.imgSprite = null;\n    }\n  }\n\n  destroy() {\n    this.clear();\n    this.container = null;\n    this.cache = null;\n  }\n}\n","import { ParallaxBackground } from '../../../../Pixi/layers/ParallaxBackground';\n\n// Build or rebuild parallax background via helper\nexport const createParallaxManager = (parallaxLayer, textureCacheRef) => {\n  let parallaxHelper = null;\n  let parallaxSprite = null;\n\n  const build = (options) => {\n    const { worldWidth, worldHeight, url, color, factor, resolveBackgroundUrl, minWidth = 0, minHeight = 0 } = options;\n\n    if (!parallaxHelper) {\n      parallaxHelper = new ParallaxBackground(parallaxLayer, textureCacheRef);\n    }\n\n    // Resolve URL and validate it exists\n    let resolvedUrl = null;\n    if (url) {\n      resolvedUrl = resolveBackgroundUrl ? resolveBackgroundUrl(url) : url;\n    }\n\n    // If no valid URL, pass null so ParallaxBackground uses solid color fallback\n    parallaxHelper.build({\n      worldWidth,\n      worldHeight,\n      url: resolvedUrl,\n      color: color || '#87CEEB',\n      factor: factor || 0.3,\n      minWidth,\n      minHeight\n    });\n\n    parallaxSprite = parallaxHelper.imgSprite || parallaxHelper.bgSprite;\n  };\n\n  const setScroll = (cameraX, factor) => {\n    if (parallaxHelper) {\n      parallaxHelper.setScroll(cameraX, factor);\n    }\n  };\n\n  const resize = (worldWidth, worldHeight, minWidth = 0, minHeight = 0) => {\n    if (parallaxHelper) {\n      parallaxHelper.resize(worldWidth, worldHeight, minWidth, minHeight);\n    }\n  };\n\n  const destroy = () => {\n    if (parallaxHelper) {\n      try {\n        parallaxHelper.destroy();\n      } catch (e) {\n        // ignore\n      }\n      parallaxHelper = null;\n      parallaxSprite = null;\n    }\n  };\n\n  return {\n    build,\n    setScroll,\n    resize,\n    destroy,\n    get sprite() {\n      return parallaxHelper?.imgSprite || parallaxHelper?.bgSprite;\n    },\n    get helper() {\n      return parallaxHelper;\n    }\n  };\n};\n","import { Sprite, AnimatedSprite, Texture, Container, Text } from 'pixi.js';\nimport { getTexture, msToSpeed } from './helpers';\nimport HealthBar from '../../../../Pixi/ui/HealthBar';\n\n// Build sprite from definition (static or animated)\nexport const buildSpriteFromDef = (def) => {\n  if (!def) return null;\n\n  let spr = null;\n  if (Array.isArray(def.textures) && def.textures.length > 1) {\n    const frames = def.textures.map((u) => getTexture(u)).filter(Boolean);\n    if (frames.length > 0) {\n      spr = new AnimatedSprite(frames);\n      spr.animationSpeed = msToSpeed(def.animationSpeed);\n      spr.play();\n    }\n  }\n\n  // Ja nav tekstru masva vai tas ir tuks, minm parasto tekstru\n  if (!spr && def.texture) {\n    const tex = getTexture(def.texture);\n    if (tex) {\n      spr = new Sprite(tex);\n    }\n  }\n\n  // Ja joprojm nav spr (piemram, nav tekstras), prbaudm editorIcon\n  if (!spr && def.editorIcon) {\n    spr = new Text({\n        text: def.editorIcon,\n        style: {\n            fontSize: 24,\n            fill: 0xffffff,\n            fontWeight: 'bold',\n            dropShadow: true,\n            dropShadowColor: 0x000000,\n            dropShadowBlur: 4,\n            dropShadowDistance: 2\n        }\n    });\n    // Centrjam tekstu tile ietvaros\n    spr.anchor.set(0.5, 0.5);\n    // T k ms lietojam anchor 0.5, mums bs jpielgo pozcija vlk vai eit\n    // Bet buildSpriteFromDef parasti atgrie objektu, kura anchor ir (0,0) pc noklusjuma\n    // lai tas atbilstu tileSize pozicionanai.\n    // Tpc iestatsim anchor uz 0, bet nedaudz nobdsim?\n    // Labk lietot anchor 0.5 un layerBuilder- pieskaitt tileSize/2.\n  }\n\n  if (!spr) {\n    spr = new Sprite(Texture.WHITE);\n  }\n\n  if (spr instanceof Sprite) {\n    spr.anchor.set(0, 0);\n  } else if (spr instanceof Text) {\n    // Tekstam ms gribam, lai tas btu centr, tpc atstjam 0.5\n  }\n  \n  return spr;\n};\n\n// Create player container with default and hit sprites\nexport const createPlayerContainer = (playerVisuals, registryItems, playerState, tileSize) => {\n  const playerContainer = new Container();\n\n  // Default visuals from prop\n  const defaultDef = playerVisuals || null;\n\n  // Target visuals: try specific IDs\n  const targetDef = Array.isArray(registryItems)\n    ? (registryItems.find(r => r.id === 'player_target_100') || registryItems.find(r => r.id === 'player_target'))\n    : null;\n\n  const defSprite = buildSpriteFromDef(defaultDef) || new Sprite(Texture.WHITE);\n  const hitSprite = buildSpriteFromDef(targetDef) || null;\n\n  playerContainer.addChild(defSprite);\n  if (hitSprite) playerContainer.addChild(hitSprite);\n\n  // Health bar above player\n  let healthBar = null;\n  try {\n    healthBar = new HealthBar({\n      width: (playerState?.width) || tileSize,\n      height: 4,\n      offsetX: 0,\n      offsetY: -5\n    });\n    playerContainer.addChild(healthBar);\n  } catch (e) {\n    console.warn('Failed to create health bar:', e);\n  }\n\n  // Initial visibility\n  defSprite.visible = true;\n  if (hitSprite) hitSprite.visible = false;\n\n  return {\n    container: playerContainer,\n    sprites: { def: defSprite, hit: hitSprite },\n    healthBar\n  };\n};\n\n// Update player sprite position, direction, and visibility\nexport const updatePlayerSprite = (refs, playerState, tileSize, healthBarEnabled) => {\n  const { container, sprites, healthBar } = refs;\n  if (!playerState || !container) return;\n\n  const { def, hit } = sprites || {};\n\n  // Resize child sprites to match player state\n  if (def) {\n    if (playerState.width) def.width = playerState.width;\n    if (playerState.height) def.height = playerState.height;\n  }\n  if (hit) {\n    if (playerState.width) hit.width = playerState.width;\n    if (playerState.height) hit.height = playerState.height;\n  }\n\n  // Update health bar size and value\n  if (healthBar) {\n    const enabled = healthBarEnabled !== false;\n    const inWater = !!playerState.inWater;\n    const inLava = playerState.liquidType === 'lava';\n    if (!enabled) {\n      healthBar.visible = false;\n    } else {\n      // When in water or lava, hide the player-attached HB and use overlay version instead\n      healthBar.visible = !(inWater || inLava);\n      const effectiveWidth = playerState.width || (def?.width) || tileSize;\n      healthBar.resize(effectiveWidth, 4);\n      healthBar.y = -Math.max(4, Math.floor((playerState.height || def?.height || tileSize) * 0.12));\n      healthBar.update(playerState.health, (Number(playerState.maxHealth) || 100));\n    }\n  }\n\n  // Choose which sprite is visible based on hit timer\n  const isHit = Number(playerState.hitTimerMs) > 0 && !!hit;\n  if (def) def.visible = !isHit;\n  if (hit) hit.visible = isHit;\n\n  // Direction flip is applied to the container\n  const dir = playerState.direction || 1;\n  const mag = Math.abs(container.scale.x || 1);\n  container.scale.x = dir >= 0 ? mag : -mag;\n\n  // Position container; when flipped, offset by width\n  const effectiveWidth = playerState.width || (def?.width) || tileSize;\n  container.x = dir >= 0 ? (playerState.x || 0) : ((playerState.x || 0) + effectiveWidth);\n  container.y = playerState.y || 0;\n};\n","import { Sprite, AnimatedSprite, Texture, Rectangle, Container } from 'pixi.js';\nimport { getTexture, msToSpeed, getRegItem } from './helpers';\nimport { buildSpriteFromDef } from './playerManager';\nimport { isWaterDef, isLavaDef } from './liquidRendering';\nimport HealthBar from '../../../../Pixi/ui/HealthBar';\n\n// Build layers: tiles, objects, and secret overlays\nexport const rebuildLayers = (refs, options) => {\n  const {\n    mapWidth,\n    mapHeight,\n    tileSize,\n    tileMapData,\n    objectMapData,\n    secretMapData,\n    revealedSecrets,\n    registryItems,\n    objectMetadata,\n    isEditor\n  } = options;\n\n  const { bgRef, objBehindRef, objFrontRef, secretLayerRef } = refs;\n\n  if (!bgRef || !objBehindRef || !objFrontRef) return;\n\n  // Clear previous\n  bgRef.removeChildren();\n  objBehindRef.removeChildren();\n  objFrontRef.removeChildren();\n  secretLayerRef?.below?.removeChildren();\n  secretLayerRef?.above?.removeChildren();\n\n  // Helper: resolve registry item by id\n  const getDef = (id) => getRegItem(registryItems, id);\n\n  // Background tiles (skip liquids; they are handled by LiquidRegionSystem)\n  let secretLayerCount = 0;\n  let normalLayerCount = 0;\n\n  for (let i = 0; i < mapWidth * mapHeight; i++) {\n    const id = tileMapData[i];\n    if (!id) continue;\n    const def = getDef(id);\n    if (!def) continue;\n\n    // Check if this tile is in a secret zone\n    const secretId = secretMapData?.[i];\n    const secretDef = secretId ? getDef(secretId) : null;\n    const secretSubtype = secretDef?.subtype;\n    const isInOpenArea = secretSubtype === 'open' || secretSubtype === 'below';\n    const isInSecretArea = secretSubtype === 'secret' || secretSubtype === 'above';\n    const isSecretRevealed = revealedSecrets && revealedSecrets.includes(i);\n\n    // Determine if this tile should be rendered with filter on secret layer\n    let renderOnSecretLayer = false;\n    if (isInOpenArea) {\n      // open.area: always render on secret layer with filter\n      renderOnSecretLayer = true;\n      secretLayerCount++;\n    } else if (isInSecretArea && isSecretRevealed) {\n      // secret.area: only render on secret layer with filter AFTER revealed\n      renderOnSecretLayer = true;\n      secretLayerCount++;\n    } else {\n      normalLayerCount++;\n    }\n\n    let sprite;\n    let frames = null;\n    if (isWaterDef(def) || isLavaDef(def) || def.type === 'entity' || def.subtype === 'platform') {\n      // liquids are handled by LiquidRegionSystem; skip per-tile sprite\n      // entities and platforms are handled by separate managers\n      continue;\n    } else {\n      if (Array.isArray(def.textures) && def.textures.length > 1) {\n        frames = def.textures.map((u) => getTexture(u)).filter(Boolean);\n      }\n      if (frames && frames.length > 0) {\n        sprite = new AnimatedSprite(frames);\n        sprite.animationSpeed = msToSpeed(def.animationSpeed);\n        sprite.play();\n      } else {\n        const tex = getTexture(def.texture) || null;\n        if (!tex) continue;\n        sprite = new Sprite(tex);\n      }\n    }\n\n    const x = (i % mapWidth) * tileSize;\n    const y = Math.floor(i / mapWidth) * tileSize;\n    sprite.x = x;\n    sprite.y = y;\n    sprite.width = tileSize;\n    sprite.height = tileSize;\n\n    // Apply filter if rendering on secret layer\n    if (renderOnSecretLayer) {\n      sprite.alpha = 0.4; // darken the tile\n      // Add to secret layer (below player always for tiles)\n      if (secretLayerRef?.below) {\n        secretLayerRef.below.addChild(sprite);\n      } else {\n        bgRef.addChild(sprite);\n      }\n    } else {\n      // Normal rendering on tiles layer\n      bgRef.addChild(sprite);\n    }\n  }\n\n  // Objects (non-player)\n  for (let i = 0; i < mapWidth * mapHeight; i++) {\n    const id = objectMapData[i];\n    if (!id || id.includes('player')) continue;\n    const def = getDef(id);\n    if (!def || def.type === 'entity' || def.subtype === 'platform') continue;\n\n    const meta = (objectMetadata && objectMetadata[i]) || {};\n    const maxH = def.maxHealth || 100;\n    const health = meta.health !== undefined ? meta.health : maxH;\n\n    let visualElement;\n    if (def.spriteSheet && def.spriteSheet.enabled) {\n      const totalSprites = def.spriteSheet.totalSprites || 1;\n      const columns = def.spriteSheet.columns || totalSprites;\n      \n      const healthPercent = Math.max(0, Math.min(100, (health / maxH) * 100));\n      let frameIndex = Math.floor((1 - healthPercent / 100) * (totalSprites - 1));\n      frameIndex = Math.max(0, Math.min(totalSprites - 1, frameIndex));\n\n      const baseTexture = getTexture(def.texture);\n      const source = baseTexture?.source;\n      if (source && source.width > 1) {\n        const texWidth = source.width;\n        const texHeight = source.height;\n\n        const frameWidth = texWidth / columns;\n        const frameHeight = texHeight / Math.ceil(totalSprites / columns);\n        \n        const col = frameIndex % columns;\n        const row = Math.floor(frameIndex / columns);\n        \n        const rect = new Rectangle(col * frameWidth, row * frameHeight, frameWidth, frameHeight);\n        \n        const frameTexture = new Texture({\n            source: source,\n            frame: rect\n        });\n        visualElement = new Sprite(frameTexture);\n      } else {\n        visualElement = buildSpriteFromDef(def);\n      }\n    } else {\n      visualElement = buildSpriteFromDef(def);\n    }\n\n    if (!visualElement) continue;\n\n    const x = (i % mapWidth) * tileSize;\n    const y = Math.floor(i / mapWidth) * tileSize;\n    \n    // Ja tas ir teksts (piemram, bultia redaktor), centrjam to tile ietvaros\n    if (visualElement.anchor && visualElement.anchor.x === 0.5) {\n      visualElement.x = tileSize / 2;\n      visualElement.y = tileSize / 2;\n    } else {\n      visualElement.x = 0;\n      visualElement.y = 0;\n    }\n    \n    visualElement.width = tileSize;\n    visualElement.height = tileSize;\n\n    // Create a container if we need a health bar or just to keep it clean\n    const container = new Container();\n    container.x = x;\n    container.y = y;\n    \n    // Slpjam objektus, kuriem ir isHiddenInGame: true (piemram, bultias spl)\n    // Bet ja ms esam redaktor, ms gribam ts redzt.\n    if (def.isHiddenInGame && !isEditor) {\n        container.visible = false;\n    }\n    \n    container.addChild(visualElement);\n\n    // Add health bar for destructible objects if damaged\n    if (def.isDestructible && health < maxH && health > 0) {\n      try {\n        const hb = new HealthBar({\n          width: tileSize,\n          height: 4,\n          offsetX: 0,\n          offsetY: -5\n        });\n        hb.update(health, maxH);\n        container.addChild(hb);\n      } catch (e) {}\n    }\n\n    const renderAbove = !!def.renderAbovePlayer;\n    if (renderAbove) {\n      objFrontRef.addChild(container);\n    } else {\n      objBehindRef.addChild(container);\n    }\n  }\n};\n","import React, { useEffect, useRef, useMemo, useCallback } from 'react';\nimport PropTypes from 'prop-types';\nimport { Application, Container, Graphics, Assets } from 'pixi.js';\nimport { TextureCache } from '../../../../Pixi/TextureCache';\nimport { Rain as WeatherRain, Snow as WeatherSnow, Clouds as WeatherClouds, Fog as WeatherFog, Thunder as WeatherThunder } from '../../../../Pixi/effects/weather';\nimport { WaterSplashFX, LavaEmbers, LavaSteamFX, LiquidRegionSystem } from '../../../../Pixi/effects/liquids';\nimport HealthBar from '../../../../Pixi/ui/HealthBar';\nimport LAYERS from '../../../../renderer/stage/layers/LayerOrder';\nimport { clearTextureCache, createBackgroundResolver, createSolidChecker } from './helpers';\nimport { createWaterFrames, createLavaFrames } from './liquidRendering';\nimport { createParallaxManager } from './parallaxManager';\nimport { createPlayerContainer, updatePlayerSprite } from './playerManager';\nimport { syncProjectiles, cleanupProjectiles } from './projectileManager';\nimport { syncEntities, cleanupEntities } from './entityManager';\nimport { rebuildLayers } from './layerBuilder';\n\n// Suppress noisy Pixi Assets warnings for inlined data URLs (we load textures directly)\nAssets.setPreferences?.({ skipCacheIdWarning: true });\n\nconst EMPTY_ARRAY = [];\nconst EMPTY_OBJECT = {};\n\nconst PixiStage = ({\n  mapWidth,\n  mapHeight,\n  tileSize = 32,\n  tileMapData = EMPTY_ARRAY,\n  objectMapData = EMPTY_ARRAY,\n  secretMapData = EMPTY_ARRAY,\n  revealedSecrets = EMPTY_ARRAY,\n  registryItems = EMPTY_ARRAY,\n  playerState,\n  playerVisuals,\n  backgroundImage,\n  backgroundColor,\n  backgroundParallaxFactor = 0.3,\n  cameraScrollX = 0,\n  weatherRain = 0,\n  weatherSnow = 0,\n  weatherClouds = 0,\n  projectiles = EMPTY_ARRAY,\n  healthBarEnabled = true,\n  objectMetadata = EMPTY_OBJECT,\n  weatherFog = 0,\n  weatherThunder = 0,\n  oxygenBarEnabled = true,\n  lavaBarEnabled = true,\n  waterSplashesEnabled = true,\n  lavaEmbersEnabled = true,\n  isEditor = false,\n}) => {\n  const mountRef = useRef(null);\n  const appRef = useRef(null);\n  const parallaxRef = useRef(null);\n  const parallaxManagerRef = useRef(null);\n  const cameraScrollRef = useRef(0);\n  const parallaxFactorRef = useRef(Number(backgroundParallaxFactor) || 0.3);\n  const cameraPosRef = useRef({ x: 0, y: 0 });\n  const bgRef = useRef(null);\n  const bgAnimRef = useRef(null);\n  const bgImageRef = useRef(backgroundImage);\n  const bgColorRef = useRef(backgroundColor);\n  const objBehindRef = useRef(null);\n  const objFrontRef = useRef(null);\n  const secretLayerRef = useRef(null);\n  const playerRef = useRef(null);\n  const playerSpriteRefs = useRef({ def: null, hit: null });\n  const playerHealthBarRef = useRef(null);\n  const playerStateRef = useRef(null);\n  const weatherLayerRef = useRef(null);\n  const liquidLayerRef = useRef(null);\n  const liquidSystemRef = useRef(null);\n  const fogLayerRef = useRef(null);\n  const weatherSystemsRef = useRef({ rain: null, snow: null, clouds: null, thunder: null });\n  const projectilesLayerRef = useRef(null);\n  const projectileSpritesRef = useRef(new Map());\n  const entitiesLayerRef = useRef(null);\n  const entitySpritesRef = useRef(new Map());\n  const projectilesPropRef = useRef(EMPTY_ARRAY);\n  const pixiTextureCacheRef = useRef(null);\n  const hbEnabledRef = useRef(healthBarEnabled !== false);\n  const oxyEnabledRef = useRef(oxygenBarEnabled !== false);\n  const lavaEnabledRef = useRef(lavaBarEnabled !== false);\n  const overlayLayerRef = useRef(null);\n  const underwaterRef = useRef({ g: null, time: 0 });\n  const waterFramesRef = useRef(null);\n  const lavaFramesRef = useRef(null);\n  const overlayHBRef = useRef(null);\n  const oxygenBarRef = useRef(null);\n  const lavaBarRef = useRef(null);\n  const waterFxRef = useRef(null);\n  const lavaEmbersRef = useRef(null);\n  const lavaSteamRef = useRef(null);\n  const splashesEnabledRef = useRef(waterSplashesEnabled !== false);\n  const embersEnabledRef = useRef(lavaEmbersEnabled !== false);\n  const waterStateRef = useRef({ inWater: false, headUnder: false, vy: 0 });\n\n  // Keep latest state in refs for ticker\n  useEffect(() => { playerStateRef.current = playerState; }, [playerState]);\n  useEffect(() => { projectilesPropRef.current = Array.isArray(projectiles) ? projectiles : []; }, [projectiles]);\n  useEffect(() => { hbEnabledRef.current = healthBarEnabled !== false; }, [healthBarEnabled]);\n  useEffect(() => { oxyEnabledRef.current = oxygenBarEnabled !== false; }, [oxygenBarEnabled]);\n  useEffect(() => { lavaEnabledRef.current = lavaBarEnabled !== false; }, [lavaBarEnabled]);\n  useEffect(() => { splashesEnabledRef.current = waterSplashesEnabled !== false; }, [waterSplashesEnabled]);\n  useEffect(() => { embersEnabledRef.current = lavaEmbersEnabled !== false; }, [lavaEmbersEnabled]);\n  useEffect(() => { cameraScrollRef.current = Number(cameraScrollX) || 0; }, [cameraScrollX]);\n  useEffect(() => { parallaxFactorRef.current = Number(backgroundParallaxFactor) || 0.3; }, [backgroundParallaxFactor]);\n  useEffect(() => { bgImageRef.current = backgroundImage; }, [backgroundImage]);\n  useEffect(() => { bgColorRef.current = backgroundColor; }, [backgroundColor]);\n\n  // Background resolver and solid checker (memoized per map)\n  const resolveBackgroundUrl = useMemo(() => createBackgroundResolver(), []);\n  const isSolidAt = useMemo(() => createSolidChecker(mapWidth, mapHeight, tileSize, tileMapData, registryItems), [mapWidth, mapHeight, tileSize, tileMapData, registryItems]);\n\n  // Rebuild parallax helper\n  const rebuildParallax = useCallback(() => {\n    const layer = parallaxRef.current;\n    if (!layer) return;\n    if (!pixiTextureCacheRef.current) pixiTextureCacheRef.current = new TextureCache();\n    if (!parallaxManagerRef.current) {\n      parallaxManagerRef.current = createParallaxManager(layer, pixiTextureCacheRef.current);\n    }\n    \n    const bgUrl = bgImageRef.current;\n    const bgColor = bgColorRef.current;\n    const factor = parallaxFactorRef.current || 0.3;\n\n    parallaxManagerRef.current.build({\n      worldWidth: mapWidth * tileSize,\n      worldHeight: mapHeight * tileSize,\n      url: bgUrl,\n      color: bgColor,\n      factor,\n      resolveBackgroundUrl,\n      minWidth: appRef.current?.screen?.width || 0,\n      minHeight: appRef.current?.screen?.height || 0\n    });\n  }, [mapWidth, mapHeight, tileSize, resolveBackgroundUrl]);\n\n  // Initialize Application\n  useEffect(() => {\n    let destroyed = false;\n\n    const init = async () => {\n      if (appRef.current) return;\n\n      const app = new Application();\n      try {\n        await app.init({\n          resizeTo: mountRef.current,\n          backgroundAlpha: 0,\n          antialias: false,\n          autoDensity: true,\n        });\n\n        if (destroyed) {\n          app.destroy(true, { children: true, texture: true });\n          return;\n        }\n\n        if (!app.renderer) return;\n\n        appRef.current = app;\n        app.stage.sortableChildren = true;\n\n        // Create layers\n      const bg = new Container();\n      const bgAnim = new Container();\n      const objBehind = new Container();\n      const objFront = new Container();\n      const secretBelowLayer = new Container();\n      const secretAboveLayer = new Container();\n      const playerLayer = new Container();\n      const entitiesLayer = new Container();\n      const weatherLayer = new Container();\n      const liquidLayer = new Container();\n      const liquidFxLayer = new Container();\n      const fogLayer = new Container();\n      const projLayer = new Container();\n      const overlayLayer = new Container();\n\n      // Assign zIndex\n      const parallaxLayer = new Container();\n      parallaxLayer.zIndex = LAYERS.parallax;\n      bg.zIndex = LAYERS.tiles;\n      bgAnim.zIndex = LAYERS.tilesAnim;\n      objBehind.zIndex = LAYERS.objBehind;\n      objFront.zIndex = LAYERS.objFront;\n      secretBelowLayer.zIndex = LAYERS.secretsBelow;\n      secretAboveLayer.zIndex = LAYERS.secretsAbove;\n      playerLayer.zIndex = LAYERS.player;\n      entitiesLayer.zIndex = LAYERS.player;\n      weatherLayer.zIndex = LAYERS.weather;\n      fogLayer.zIndex = LAYERS.fog;\n      liquidLayer.zIndex = LAYERS.liquids;\n      liquidFxLayer.zIndex = LAYERS.liquidFx;\n      projLayer.zIndex = LAYERS.projectiles;\n      overlayLayer.zIndex = LAYERS.overlay;\n\n      bgRef.current = bg;\n      bgAnimRef.current = bgAnim;\n      objBehindRef.current = objBehind;\n      objFrontRef.current = objFront;\n      secretLayerRef.current = { below: secretBelowLayer, above: secretAboveLayer };\n      weatherLayerRef.current = weatherLayer;\n      liquidLayerRef.current = liquidLayer;\n      fogLayerRef.current = fogLayer;\n      projectilesLayerRef.current = projLayer;\n      entitiesLayerRef.current = entitiesLayer;\n      overlayLayerRef.current = overlayLayer;\n      parallaxRef.current = parallaxLayer;\n\n      // Add all layers to stage\n      app.stage.addChild(bg, bgAnim, parallaxLayer, objBehind, secretBelowLayer, playerLayer, entitiesLayer, projLayer, objFront, secretAboveLayer, weatherLayer, fogLayer, liquidLayer, liquidFxLayer, overlayLayer);\n\n      // Preload textures to avoid Assets cache warnings and ensure textures are ready\n      try {\n        const urlSet = new Set();\n        const addUrl = (u) => { if (typeof u === 'string' && u.length) urlSet.add(u); };\n        registryItems.forEach((def) => {\n          addUrl(def?.texture);\n          if (Array.isArray(def?.textures)) def.textures.forEach(addUrl);\n        });\n        if (playerVisuals) {\n          addUrl(playerVisuals.texture);\n          if (Array.isArray(playerVisuals.textures)) playerVisuals.textures.forEach(addUrl);\n        }\n        const bgUrl = resolveBackgroundUrl(bgImageRef.current);\n        if (bgUrl) addUrl(bgUrl);\n        const urls = Array.from(urlSet);\n        if (urls.length) {\n          console.log('[PixiStage] Preloading', urls.length, 'textures...');\n          await Assets.load(urls);\n          console.log('[PixiStage] Textures preloaded successfully');\n        }\n      } catch (e) {\n        console.warn('Pixi Assets preload encountered an issue (continuing):', e);\n      }\n\n      // Create player\n      const playerComponents = createPlayerContainer(playerVisuals, registryItems, playerState, tileSize);\n      playerLayer.addChild(playerComponents.container);\n      playerRef.current = playerComponents.container;\n      playerSpriteRefs.current = playerComponents.sprites;\n      playerHealthBarRef.current = playerComponents.healthBar;\n\n      // Mount canvas - DROA PIEVIENOANA\n      if (mountRef.current && app.renderer && app.canvas) {\n        mountRef.current.innerHTML = '';\n        mountRef.current.appendChild(app.canvas);\n      }\n\n      // Build underwater overlay\n      const g = new Graphics();\n      overlayLayer.addChild(g);\n      underwaterRef.current.g = g;\n      const W = mapWidth * tileSize;\n      const H = mapHeight * tileSize;\n      g.clear();\n      g.rect(0, 0, W, H);\n      g.fill({ color: 0x1d4875, alpha: 1 });\n      g.alpha = 0;\n      g.visible = false;\n\n      // Build overlay bars\n      const hbOverlay = new HealthBar({ width: (playerState?.width) || tileSize, height: 4, offsetX: 0, offsetY: 0 });\n      hbOverlay.visible = false;\n      overlayLayer.addChild(hbOverlay);\n      overlayHBRef.current = hbOverlay;\n\n      const oxyColors = { ok: 0x2ecdf1, warn: 0x3498db, danger: 0x1f6fb2 };\n      const oxyBar = new HealthBar({ width: (playerState?.width) || tileSize, height: 4, offsetX: 0, offsetY: 0, colors: oxyColors });\n      oxyBar.visible = false;\n      overlayLayer.addChild(oxyBar);\n      oxygenBarRef.current = oxyBar;\n\n      const lavaColors = { ok: 0xffa229, warn: 0xff7b00, danger: 0xff3b1a };\n      const lvBar = new HealthBar({ width: (playerState?.width) || tileSize, height: 4, offsetX: 0, offsetY: 0, colors: lavaColors });\n      lvBar.visible = false;\n      overlayLayer.addChild(lvBar);\n      lavaBarRef.current = lvBar;\n\n      // WebGL context loss/restore handlers\n      if (app.canvas && app.renderer) {\n        app.canvas.addEventListener('webglcontextlost', (e) => {\n          e.preventDefault();\n          console.warn('WebGL context lost');\n        });\n        app.canvas.addEventListener('webglcontextrestored', () => {\n          console.info('WebGL context restored');\n          rebuildLayers(\n            { bgRef: bgRef.current, objBehindRef: objBehindRef.current, objFrontRef: objFrontRef.current, secretLayerRef: secretLayerRef.current },\n            { mapWidth, mapHeight, tileSize, tileMapData, objectMapData, secretMapData, revealedSecrets, registryItems, objectMetadata, isEditor }\n          );\n          rebuildParallax();\n          try {\n            if (liquidSystemRef.current) liquidSystemRef.current.destroy();\n            liquidSystemRef.current = new LiquidRegionSystem(liquidLayerRef.current, { mapWidth, mapHeight, tileSize });\n            liquidSystemRef.current.build({ mapWidth, mapHeight, tileSize, tileMapData, registryItems });\n          } catch (e) { console.warn('LiquidRegionSystem rebuild failed:', e); }\n          try { lavaEmbersRef.current?.rebuildSurfaces({ mapWidth, mapHeight, tileSize, tileMapData, registryItems }); } catch {}\n        });\n      }\n\n      // First draw\n      rebuildLayers(\n        { bgRef: bgRef.current, objBehindRef: objBehindRef.current, objFrontRef: objFrontRef.current, secretLayerRef: secretLayerRef.current },\n        { mapWidth, mapHeight, tileSize, tileMapData, objectMapData, secretMapData, revealedSecrets, registryItems, objectMetadata, isEditor }\n      );\n\n      // Initialize liquid system\n      try {\n        if (liquidSystemRef.current) liquidSystemRef.current.destroy();\n        liquidSystemRef.current = new LiquidRegionSystem(liquidLayerRef.current, { mapWidth, mapHeight, tileSize });\n        liquidSystemRef.current.build({ mapWidth, mapHeight, tileSize, tileMapData, registryItems });\n      } catch (e) { console.warn('LiquidRegionSystem init failed:', e); }\n\n      // FX systems\n      try { waterFxRef.current = new WaterSplashFX(liquidFxLayer); } catch {}\n      try { lavaSteamRef.current = new LavaSteamFX(liquidFxLayer); } catch {}\n      try {\n        lavaEmbersRef.current = new LavaEmbers(liquidLayerRef.current, { mapWidth, mapHeight, tileSize }, () => (embersEnabledRef.current ? 100 : 0));\n        lavaEmbersRef.current.rebuildSurfaces({ mapWidth, mapHeight, tileSize, tileMapData, registryItems });\n      } catch {}\n\n      rebuildParallax();\n\n      // Ticker\n      app.ticker.add(() => {\n        const s = playerStateRef.current;\n        if (s && playerRef.current) {\n          updatePlayerSprite(\n            { container: playerRef.current, sprites: playerSpriteRefs.current, healthBar: playerHealthBarRef.current },\n            s,\n            tileSize,\n            hbEnabledRef.current\n          );\n        }\n\n        // Camera Follow\n        const sw = app.screen.width;\n        const sh = app.screen.height;\n        const worldW = mapWidth * tileSize;\n        const worldH = mapHeight * tileSize;\n\n        if (s) {\n          const targetX = (s.x || 0) + (s.width || tileSize) / 2;\n          const targetY = (s.y || 0) + (s.height || tileSize) / 2;\n\n          let camX = targetX - sw / 2;\n          let camY = targetY - sh / 2;\n\n          // Constraints with centering for small maps\n          if (worldW < sw) {\n            camX = (worldW - sw) / 2;\n          } else {\n            camX = Math.max(0, Math.min(camX, worldW - sw));\n          }\n\n          if (worldH < sh) {\n            camY = (worldH - sh) / 2;\n          } else {\n            camY = Math.max(0, Math.min(camY, worldH - sh));\n          }\n\n          cameraPosRef.current = { x: camX, y: camY };\n          app.stage.pivot.set(camX, camY);\n\n          if (parallaxRef.current) {\n            parallaxRef.current.position.set(camX, camY);\n          }\n\n          const f = parallaxFactorRef.current;\n          if (parallaxManagerRef.current) {\n            parallaxManagerRef.current.resize(worldW, worldH, sw, sh);\n            parallaxManagerRef.current.setScroll(camX, f);\n          }\n        }\n\n        // Weather\n        const dt = app.ticker?.deltaMS || 16.67;\n        const systems = weatherSystemsRef.current;\n        if (systems.rain) systems.rain.update(dt);\n        if (systems.snow) systems.snow.update(dt);\n        if (systems.clouds) systems.clouds.update(dt);\n        if (systems.fog) systems.fog.update(dt);\n        if (systems.thunder) systems.thunder.update(dt);\n\n        // Liquids\n        try {\n          if (liquidSystemRef.current && s) {\n            liquidSystemRef.current.setPlayerState(s);\n          }\n          liquidSystemRef.current?.update(dt);\n        } catch {}\n\n        // FX\n        try { lavaEmbersRef.current?.update(dt); } catch {}\n        try { waterFxRef.current?.update(dt); } catch {}\n        try { lavaSteamRef.current?.update(dt); } catch {}\n\n        // Underwater overlay\n        try {\n          const u = underwaterRef.current;\n          const sNow = playerStateRef.current || {};\n          if (u && u.g) {\n            const submerged = !!(sNow && sNow.headUnderWater && sNow.liquidType === 'water');\n            if (submerged) {\n              u.time += dt;\n              const pulse = 0.12 + 0.06 * Math.sin(u.time * 0.0025);\n              u.g.visible = true;\n              u.g.alpha = pulse;\n            } else if (u.g.visible) {\n              u.g.alpha *= 0.85;\n              if (u.g.alpha < 0.01) { u.g.alpha = 0; u.g.visible = false; }\n            }\n          }\n\n          // Water splash detection\n          try {\n            const prev = waterStateRef.current || { inWater: false, headUnder: false, vy: 0 };\n            const nowInWater = !!sNow.inWater;\n            const nowLiquid = sNow.liquidType;\n            const centerX = (sNow.x || 0) + (sNow.width || tileSize) * 0.5;\n\n            if (splashesEnabledRef.current && nowLiquid === 'water' && nowInWater && !prev.inWater) {\n              const sy = liquidSystemRef.current?.getSurfaceY?.('water', centerX);\n              const vy = Number(sNow.vy) || 0;\n              const strength = Math.min(3, Math.max(0.2, Math.abs(vy) * 0.12));\n              waterFxRef.current?.trigger({ x: centerX, y: (Number.isFinite(sy) ? sy : (sNow.y || 0)), strength, upward: false });\n              try { liquidSystemRef.current?.addWave?.('water', centerX, Math.min(2.5, 0.6 + Math.abs(vy) * 0.08)); } catch {}\n            }\n            if (splashesEnabledRef.current && prev.inWater && !nowInWater) {\n              const sy = liquidSystemRef.current?.getSurfaceY?.('water', centerX);\n              const vy = Number(sNow.vy) || 0;\n              const strength = Math.min(3, Math.max(0.2, Math.abs(vy) * 0.08));\n              waterFxRef.current?.trigger({ x: centerX, y: (Number.isFinite(sy) ? sy : (sNow.y || 0)), strength, upward: true });\n              try { liquidSystemRef.current?.addWave?.('water', centerX, Math.min(2.0, 0.4 + Math.abs(vy) * 0.05)); } catch {}\n            }\n            waterStateRef.current = { inWater: nowInWater, headUnder: !!sNow.headUnderWater, vy: Number(sNow.vy) || 0 };\n          } catch {}\n        } catch {}\n\n        // Overlay bars\n        try {\n          const s2 = playerStateRef.current || {};\n          const effW = (s2.width || tileSize);\n          const effH = (s2.height || tileSize);\n          const baseYOffset = Math.max(4, Math.floor(effH * 0.12));\n          const baseX = (s2.x || 0);\n          const baseY = (s2.y || 0) - baseYOffset;\n\n          const hbO = overlayHBRef.current;\n          if (hbO) {\n            const enabled = hbEnabledRef.current !== false;\n            const show = enabled && (!!s2.inWater || s2.liquidType === 'lava');\n            hbO.visible = !!show;\n            if (show) {\n              hbO.x = baseX;\n              hbO.y = baseY;\n              hbO.resize(effW, 4);\n              hbO.update(s2.health, (Number(s2.maxHealth) || 100));\n            }\n          }\n\n          let nextBarY = baseY;\n          if (hbO && hbO.visible) nextBarY += 6;\n\n          const oxyBar = oxygenBarRef.current;\n          if (oxyBar) {\n            const enabled = oxyEnabledRef.current !== false;\n            const maxOxy = Math.max(1, Number(s2.maxOxygen) || 100);\n            const curOxy = Math.max(0, Number(s2.oxygen));\n            const show = enabled && ((s2.liquidType === 'water' || s2.inWater) || (curOxy < maxOxy));\n            oxyBar.visible = !!show;\n            if (show) {\n              oxyBar.x = baseX;\n              oxyBar.y = nextBarY;\n              oxyBar.resize(effW, 4);\n              oxyBar.update((Number.isFinite(curOxy) ? curOxy : maxOxy), maxOxy);\n              nextBarY += 6;\n            }\n          }\n\n          const lvBar = lavaBarRef.current;\n          if (lvBar) {\n            const enabled = lavaEnabledRef.current !== false;\n            const maxLv = Math.max(1, Number(s2.maxLavaResist) || 100);\n            const curLv = Math.max(0, Number(s2.lavaResist));\n            const show = enabled && (s2.liquidType === 'lava' || (curLv < maxLv));\n            lvBar.visible = !!show;\n            if (show) {\n              lvBar.x = baseX;\n              lvBar.y = nextBarY;\n              lvBar.resize(effW, 4);\n              lvBar.update((Number.isFinite(curLv) ? curLv : maxLv), maxLv);\n            }\n          }\n        } catch {}\n\n        // Projectiles\n        syncProjectiles(projectilesLayerRef.current, projectileSpritesRef.current, projectilesPropRef.current, registryItems, tileSize);\n\n        // Entities\n        const sNow = playerStateRef.current || {};\n        syncEntities(entitiesLayerRef.current, entitySpritesRef.current, sNow.entities, registryItems, tileSize);\n      });\n    } catch (error) {\n      console.error('PixiStage init failed:', error);\n    }\n  };\n\n  init();\n\n  return () => {\n    destroyed = true;\n    if (appRef.current) {\n      const appToDestroy = appRef.current;\n      appRef.current = null;\n      appToDestroy.destroy(true, { children: true, texture: true });\n    }\n    try { liquidSystemRef.current?.destroy(); } catch {}\n    try { waterFxRef.current?.destroy(); } catch {}\n    try { lavaEmbersRef.current?.destroy(); } catch {}\n    try { lavaSteamRef.current?.destroy(); } catch {}\n    try { parallaxManagerRef.current?.destroy(); } catch {}\n    parallaxManagerRef.current = null;\n    try { pixiTextureCacheRef.current?.clear?.(); } catch {}\n    try {\n      weatherSystemsRef.current.rain?.destroy();\n      weatherSystemsRef.current.snow?.destroy();\n      weatherSystemsRef.current.fog?.destroy();\n    } catch {}\n    cleanupProjectiles(projectileSpritesRef.current);\n    cleanupEntities(entitySpritesRef.current);\n    clearTextureCache();\n  };\n  }, [mapWidth, mapHeight, tileSize, playerVisuals]);\n\n  // Rebuild layers when map data changes\n  useEffect(() => {\n    const app = appRef.current;\n    if (!app) return;\n\n    if (bgRef.current && objBehindRef.current && objFrontRef.current) {\n      rebuildLayers(\n        { bgRef: bgRef.current, objBehindRef: objBehindRef.current, objFrontRef: objFrontRef.current, secretLayerRef: secretLayerRef.current },\n        { mapWidth, mapHeight, tileSize, tileMapData, objectMapData, secretMapData, revealedSecrets, registryItems, objectMetadata, isEditor }\n      );\n\n      // Rebuild liquid regions\n      try {\n        if (liquidSystemRef.current) liquidSystemRef.current.destroy();\n        if (liquidLayerRef.current) {\n          liquidSystemRef.current = new LiquidRegionSystem(liquidLayerRef.current, { mapWidth, mapHeight, tileSize });\n          liquidSystemRef.current.build({ mapWidth, mapHeight, tileSize, tileMapData, registryItems });\n        }\n      } catch (e) { console.warn('LiquidRegionSystem rebuild failed:', e); }\n      try { lavaEmbersRef.current?.rebuildSurfaces({ mapWidth, mapHeight, tileSize, tileMapData, registryItems }); } catch {}\n    }\n  }, [tileMapData, objectMapData, registryItems, mapWidth, mapHeight, tileSize, secretMapData, revealedSecrets, objectMetadata]);\n\n  // Weather systems lifecycle\n  useEffect(() => {\n    const app = appRef.current;\n    const weatherLayer = weatherLayerRef.current;\n    const fogLayer = fogLayerRef.current;\n    if (!app || !weatherLayer || !fogLayer) return;\n\n    const api = {\n      isSolidAt,\n      mapWidth,\n      mapHeight,\n      tileSize,\n      getLiquidSurfaceY: (type, x) => {\n        try { return liquidSystemRef.current?.getSurfaceY?.(type, x); } catch { return null; }\n      },\n      onWaterImpact: ({ x, strength = 0.8 }) => {\n        try {\n          const sy = liquidSystemRef.current?.getSurfaceY?.('water', x);\n          if (Number.isFinite(sy)) waterFxRef.current?.trigger({ x, y: sy, strength: Math.max(0.2, Math.min(2, strength)), upward: false });\n          try { liquidSystemRef.current?.addWave?.('water', x, Math.max(0.2, Math.min(2.2, strength))); } catch {}\n        } catch {}\n      },\n      onLavaImpact: ({ x, y, strength = 0.6 }) => {\n        try {\n          const sy = liquidSystemRef.current?.getSurfaceY?.('lava', x);\n          const yy = Number.isFinite(y) ? y : (Number.isFinite(sy) ? sy : null);\n          if (yy != null) lavaSteamRef.current?.trigger({ x, y: yy, strength });\n        } catch {}\n      }\n    };\n\n    const getRainIntensity = () => Math.max(0, Math.min(100, Number(weatherRain) || 0));\n    const getSnowIntensity = () => Math.max(0, Math.min(100, Number(weatherSnow) || 0));\n    const getCloudsIntensity = () => Math.max(0, Math.min(100, Number(weatherClouds) || 0));\n    const getThunderIntensity = () => Math.max(0, Math.min(100, Number(weatherThunder) || 0));\n\n    // Reset systems\n    try { weatherSystemsRef.current.rain?.destroy(); } catch {}\n    try { weatherSystemsRef.current.snow?.destroy(); } catch {}\n    try { weatherSystemsRef.current.clouds?.destroy(); } catch {}\n    try { weatherSystemsRef.current.fog?.destroy(); } catch {}\n    try { weatherSystemsRef.current.thunder?.destroy(); } catch {}\n    weatherSystemsRef.current.rain = null;\n    weatherSystemsRef.current.snow = null;\n    weatherSystemsRef.current.clouds = null;\n    weatherSystemsRef.current.fog = null;\n    weatherSystemsRef.current.thunder = null;\n\n    // Rain\n    if (getRainIntensity() > 0) {\n      weatherSystemsRef.current.rain = new WeatherRain(weatherLayer, api, getRainIntensity);\n      weatherSystemsRef.current.rain.setIntensity(getRainIntensity());\n    }\n\n    // Snow\n    if (getSnowIntensity() > 0) {\n      weatherSystemsRef.current.snow = new WeatherSnow(weatherLayer, api, getSnowIntensity);\n      weatherSystemsRef.current.snow.setIntensity(getSnowIntensity());\n    }\n\n    // Clouds\n    if (getCloudsIntensity() > 0) {\n      weatherSystemsRef.current.clouds = new WeatherClouds(fogLayer, api, getCloudsIntensity);\n      weatherSystemsRef.current.clouds.setIntensity(getCloudsIntensity());\n    }\n\n    // Fog\n    if (Number(weatherFog) > 0) {\n      weatherSystemsRef.current.fog = new WeatherFog(fogLayer, api, () => Number(weatherFog) || 0);\n      weatherSystemsRef.current.fog.setIntensity(Number(weatherFog) || 0);\n    }\n\n    // Thunder\n    if (getThunderIntensity() > 0) {\n      weatherSystemsRef.current.thunder = new WeatherThunder(fogLayer, api, getThunderIntensity);\n      weatherSystemsRef.current.thunder.setIntensity(getThunderIntensity());\n    }\n  }, [weatherRain, weatherSnow, weatherClouds, weatherFog, weatherThunder, mapWidth, mapHeight, tileSize, isSolidAt]);\n\n  // Rebuild parallax when props change\n  useEffect(() => {\n    rebuildParallax();\n  }, [backgroundImage, backgroundColor, rebuildParallax]);\n\n  return <div ref={mountRef} style={{ width: '100%', height: '100%' }} />;\n};\n\nPixiStage.propTypes = {\n  mapWidth: PropTypes.number.isRequired,\n  mapHeight: PropTypes.number.isRequired,\n  tileSize: PropTypes.number,\n  tileMapData: PropTypes.array,\n  objectMapData: PropTypes.array,\n  secretMapData: PropTypes.array,\n  revealedSecrets: PropTypes.array,\n  registryItems: PropTypes.array,\n  playerState: PropTypes.object,\n  playerVisuals: PropTypes.object,\n  backgroundImage: PropTypes.string,\n  backgroundColor: PropTypes.string,\n  backgroundParallaxFactor: PropTypes.number,\n  cameraScrollX: PropTypes.number,\n  weatherRain: PropTypes.number,\n  weatherSnow: PropTypes.number,\n  weatherClouds: PropTypes.number,\n  projectiles: PropTypes.array,\n  healthBarEnabled: PropTypes.bool,\n  objectMetadata: PropTypes.object,\n  weatherFog: PropTypes.number,\n  weatherThunder: PropTypes.number,\n  oxygenBarEnabled: PropTypes.bool,\n  lavaBarEnabled: PropTypes.bool,\n  waterSplashesEnabled: PropTypes.bool,\n  lavaEmbersEnabled: PropTypes.bool,\n};\n\nexport default PixiStage;\n","import { Sprite, AnimatedSprite, Texture } from 'pixi.js';\nimport { getTexture, msToSpeed, getRegItem } from './helpers';\n\n// Sync and update projectiles: create missing sprites, remove stale ones, update positions\nexport const syncProjectiles = (projectilesLayer, projectileSpritesMap, projectilesList, registryItems, tileSize) => {\n  if (!projectilesLayer) return;\n\n  const map = projectileSpritesMap;\n  const list = projectilesList || [];\n  const seen = new Set();\n\n  // Create or update sprites for current projectiles\n  for (let i = 0; i < list.length; i++) {\n    const p = list[i];\n    const key = p.id;\n    seen.add(key);\n\n    let spr = map.get(key);\n    if (!spr) {\n      // Create new sprite\n      const def = getRegItem(registryItems, p.defId);\n      if (def && Array.isArray(def.textures) && def.textures.length > 1) {\n        const frames = def.textures.map((u) => getTexture(u)).filter(Boolean);\n        if (frames.length > 0) {\n          spr = new AnimatedSprite(frames);\n          spr.animationSpeed = msToSpeed(def.animationSpeed);\n          spr.play();\n        }\n      }\n      if (!spr) {\n        const tex = getTexture(getRegItem(registryItems, p.defId)?.texture) || Texture.WHITE;\n        spr = new Sprite(tex);\n      }\n      spr.anchor.set(0.5, 0.5);\n      spr.width = Math.max(2, p.w || tileSize * 0.25);\n      spr.height = Math.max(2, p.h || tileSize * 0.25);\n      projectilesLayer.addChild(spr);\n      map.set(key, spr);\n    }\n\n    // Update position and direction\n    spr.x = p.x + (p.dir >= 0 ? 0 : 0);\n    spr.y = p.y;\n    const mag = Math.abs(spr.scale.x || 1);\n    spr.scale.x = p.dir >= 0 ? mag : -mag;\n  }\n\n  // Remove sprites that no longer exist\n  for (const [key, spr] of map.entries()) {\n    if (!seen.has(key)) {\n      try {\n        spr.parent && spr.parent.removeChild(spr);\n      } catch (e) {\n        // ignore\n      }\n      try {\n        spr.destroy && spr.destroy();\n      } catch (e) {\n        // ignore\n      }\n      map.delete(key);\n    }\n  }\n};\n\n// Cleanup all projectile sprites\nexport const cleanupProjectiles = (projectileSpritesMap) => {\n  try {\n    for (const spr of projectileSpritesMap.values()) {\n      try {\n        spr.parent && spr.parent.removeChild(spr);\n      } catch (e) {\n        // ignore\n      }\n      try {\n        spr.destroy && spr.destroy();\n      } catch (e) {\n        // ignore\n      }\n    }\n    projectileSpritesMap.clear();\n  } catch (e) {\n    // ignore\n  }\n};\n","import { Sprite, Texture, Rectangle } from 'pixi.js';\nimport { getTexture } from './helpers';\n\n/**\n * Sinhroniz un atjaunina kustgo enttiju (piem. tanku) spraitus.\n * @param {Container} entitiesLayer PixiJS konteiners enttijm\n * @param {Map} entitySpritesMap Map, kur glabjas esoie spraiti (pc ID)\n * @param {Array} entitiesList Enttiju saraksts no dzinja\n * @param {Array} registryItems Reistra elementi\n * @param {number} tileSize Flzes izmrs pikseos\n */\nexport const syncEntities = (entitiesLayer, entitySpritesMap, entitiesList, registryItems, tileSize) => {\n  if (!entitiesLayer) return;\n\n  const seen = new Set();\n  const list = entitiesList || [];\n\n  for (const ent of list) {\n    const key = ent.id;\n    seen.add(key);\n\n    let spr = entitySpritesMap.get(key);\n    const def = ent.def || {};\n\n    if (!spr) {\n      // Izveidojam jaunu spraitu ar baltu tekstru k aizvietotju, kamr ldjas st\n      spr = new Sprite(Texture.WHITE);\n      spr.anchor.set(0, 0);\n      entitiesLayer.addChild(spr);\n      entitySpritesMap.set(key, spr);\n      spr._lastFrameIndex = -1;\n    }\n\n    // Atjaunojam tekstru no spritesheet, ja nepiecieams\n    const baseTexture = getTexture(def.texture);\n    const source = baseTexture?.source;\n    const isTextureReady = source && source.width > 1;\n\n    if (def.spriteSheet && def.spriteSheet.enabled && isTextureReady) {\n      const columns = def.spriteSheet.columns || 1;\n      const frameIndex = ent.currentSpriteIndex !== undefined ? ent.currentSpriteIndex : 0;\n      \n      if (spr._lastFrameIndex !== frameIndex) {\n        const texWidth = source.width;\n        const texHeight = source.height;\n        const totalSprites = def.spriteSheet.totalSprites || 1;\n\n        // Ja kolonnu skaits JSON ir nepareizs vai trkst, minm to aprint\n        let effectiveColumns = columns;\n        if (!effectiveColumns || effectiveColumns <= 0) {\n            effectiveColumns = Math.floor(texWidth / (def.spriteSheet.frameWidth || 32)) || 1;\n        }\n\n        const frameWidth = texWidth / effectiveColumns;\n        const frameHeight = texHeight / Math.ceil(totalSprites / effectiveColumns);\n        \n        const col = frameIndex % effectiveColumns;\n        const row = Math.floor(frameIndex / effectiveColumns);\n        \n        const rect = new Rectangle(col * frameWidth, row * frameHeight, frameWidth, frameHeight);\n        \n        try {\n            spr.texture = new Texture({\n              source: source,\n              frame: rect\n            });\n            spr._lastFrameIndex = frameIndex;\n        } catch (e) {\n            console.warn(`Failed to create texture for entity ${key} frame ${frameIndex}`, e);\n            spr.texture = baseTexture;\n        }\n      }\n    } else if (isTextureReady) {\n      if (spr.texture !== baseTexture) {\n        spr.texture = baseTexture;\n        spr._lastFrameIndex = -1;\n      }\n    } else if (def.editorIcon) {\n        // Ja nav tekstras, bet ir ikona (piemram, bultia, kaut gan ts te nevajadztu bt k enttijai)\n        if (spr.texture !== Texture.WHITE) spr.texture = Texture.WHITE;\n    }\n\n    // Pozcija un izmrs\n    // Svargi: Vispirms iestatm izmru, tad virzienu\n    const targetWidth = ent.width || tileSize;\n    const targetHeight = ent.height || tileSize;\n    \n    spr.width = targetWidth;\n    spr.height = targetHeight;\n    \n    // Nodroinm, ka scale nav 0 vai NaN (ja tekstra bija dvaina skum)\n    if (!spr.scale.x || isNaN(spr.scale.x)) spr.scale.x = 1;\n    if (!spr.scale.y || isNaN(spr.scale.y)) spr.scale.y = 1;\n\n    // Virziens (flipping)\n    const direction = ent.direction !== undefined ? ent.direction : 1;\n    const absScaleX = Math.abs(spr.scale.x);\n    spr.scale.x = direction >= 0 ? absScaleX : -absScaleX;\n    \n    // Pozicionana emot vr flipping\n    spr.x = ent.x + (direction < 0 ? targetWidth : 0);\n    spr.y = ent.y;\n  }\n\n  // Noemam spraitus enttijm, kas vairs neeksist\n  for (const [key, spr] of entitySpritesMap.entries()) {\n    if (!seen.has(key)) {\n      if (spr.parent) spr.parent.removeChild(spr);\n      spr.destroy({ children: true, texture: false }); // Tekstras koplietoanas d ts neizncinm\n      entitySpritesMap.delete(key);\n    }\n  }\n};\n\n/**\n * Attra visus enttiju spraitus.\n */\nexport const cleanupEntities = (entitySpritesMap) => {\n  for (const spr of entitySpritesMap.values()) {\n    if (spr.parent) spr.parent.removeChild(spr);\n    spr.destroy({ children: true, texture: false });\n  }\n  entitySpritesMap.clear();\n};\n","/**\n * Secrets Detection and Reveal Logic\n * Handles AboveSecret zone detection and revealing when player enters\n */\n\n/**\n * Flood fill to find all connected secret tiles of the same type\n * @param {number} startIndex - Starting tile index\n * @param {Array} secretMapData - Secret layer data\n * @param {number} mapWidth - Map width in tiles\n * @param {number} mapHeight - Map height in tiles\n * @param {Array} registryItems - Registry items to lookup secret definitions\n * @returns {Array} - Array of connected tile indices\n */\nexport function floodFillSecretZone(startIndex, secretMapData, mapWidth, mapHeight, registryItems) {\n  const startSecretId = secretMapData[startIndex];\n  if (!startSecretId) return [];\n\n  const startDef = registryItems.find(r => r.id === startSecretId);\n  if (!startDef || startDef.type !== 'secret') return [];\n\n  const visited = new Set();\n  const result = [];\n  const queue = [startIndex];\n\n  while (queue.length > 0) {\n    const idx = queue.shift();\n    if (visited.has(idx)) continue;\n    if (idx < 0 || idx >= secretMapData.length) continue;\n\n    visited.add(idx);\n\n    const secretId = secretMapData[idx];\n    if (!secretId || secretId !== startSecretId) continue;\n\n    result.push(idx);\n\n    // Check 4 neighbors (up, down, left, right)\n    const x = idx % mapWidth;\n    const y = Math.floor(idx / mapWidth);\n\n    // Up\n    if (y > 0) queue.push((y - 1) * mapWidth + x);\n    // Down\n    if (y < mapHeight - 1) queue.push((y + 1) * mapWidth + x);\n    // Left\n    if (x > 0) queue.push(y * mapWidth + (x - 1));\n    // Right\n    if (x < mapWidth - 1) queue.push(y * mapWidth + (x + 1));\n  }\n\n  return result;\n}\n\n/**\n * Check if player is touching any AboveSecret tiles\n * @param {Object} params - Detection parameters\n * @returns {Array|null} - Array of tile indices to reveal, or null if no detection\n */\nexport function checkSecretDetection({\n  currentX,\n  currentY,\n  width,\n  height,\n  secretMapData,\n  revealedSecrets,\n  mapWidth,\n  mapHeight,\n  registryItems,\n  TILE_SIZE\n}) {\n  if (!secretMapData || secretMapData.length === 0) return null;\n\n  // Player AABB in world pixels\n  const playerLeft = currentX;\n  const playerRight = currentX + width;\n  const playerTop = currentY;\n  const playerBottom = currentY + height;\n\n  // Overlapped tile rectangle\n  const minGX = Math.floor(playerLeft / TILE_SIZE);\n  const maxGX = Math.floor((playerRight - 1) / TILE_SIZE);\n  const minGY = Math.floor(playerTop / TILE_SIZE);\n  const maxGY = Math.floor((playerBottom - 1) / TILE_SIZE);\n\n  // Check all overlapping tiles for AboveSecret\n  for (let gy = minGY; gy <= maxGY; gy++) {\n    for (let gx = minGX; gx <= maxGX; gx++) {\n      if (gx < 0 || gx >= mapWidth || gy < 0 || gy >= mapHeight) continue;\n\n      const idx = gy * mapWidth + gx;\n      const secretId = secretMapData[idx];\n      if (!secretId) continue;\n\n      // Already revealed?\n      if (revealedSecrets && revealedSecrets.includes(idx)) continue;\n\n      const def = registryItems.find(r => r.id === secretId);\n      if (!def || def.type !== 'secret') continue;\n\n      // Only secret.area (subtype: 'secret' or old name 'above') can be revealed\n      const isSecretArea = def.subtype === 'secret' || def.subtype === 'above';\n      if (!isSecretArea || !def.revealOnEnter) continue;\n\n      // Found an unrevealed secret.area that player is touching!\n      // Flood fill to find all connected tiles\n      const connectedIndices = floodFillSecretZone(idx, secretMapData, mapWidth, mapHeight, registryItems);\n\n      // Filter out already revealed indices to prevent infinite loop\n      const newIndices = connectedIndices.filter(i => !revealedSecrets || !revealedSecrets.includes(i));\n\n      console.log('[SECRETS] Revealing zone:', {\n        triggerIndex: idx,\n        triggerSecretId: secretId,\n        triggerSubtype: def.subtype,\n        totalConnected: connectedIndices.length,\n        newToReveal: newIndices.length,\n        firstFiveNew: newIndices.slice(0, 5),\n        connectedSecretIds: newIndices.slice(0, 5).map(i => secretMapData[i])\n      });\n\n      // Only return if there are NEW indices to reveal\n      return newIndices.length > 0 ? newIndices : null;\n    }\n  }\n\n  return null;\n}\n\nexport default { checkSecretDetection, floodFillSecretZone };\n","// Audio utilities extracted from useGameEngine.js\n\n// Usage: playSfx({ soundEnabledRef, audioCtxRef, audioCtxUnlockedRef }, url, volume)\nexport function playSfx(ctx, url, volume) {\n  const { soundEnabledRef, audioCtxRef } = ctx || {};\n  try {\n    if (!soundEnabledRef?.current) return;\n    const vol = Math.max(0, Math.min(1, volume ?? 1));\n    // 1) Try HTMLAudio first\n    if (url && typeof url === 'string' && url.length > 0) {\n      try {\n        const audio = new Audio(url);\n        audio.volume = vol;\n        audio.addEventListener?.('error', () => {\n          try { audio.pause(); } catch {}\n          beepFallback(ctx, vol);\n        }, { once: true });\n        const p = audio.play?.();\n        if (p && typeof p.catch === 'function') p.catch(() => beepFallback(ctx, vol));\n        return;\n      } catch {\n        // fallback below\n      }\n    }\n    // 2) Fallback beep via WebAudio\n    beepFallback(ctx, vol);\n  } catch {}\n}\n\nexport function beepFallback(ctx, vol) {\n  try {\n    const AC = window.AudioContext || window.webkitAudioContext;\n    if (!AC) return;\n    if (!ctx?.audioCtxRef) return;\n    if (!ctx.audioCtxRef.current) ctx.audioCtxRef.current = new AC();\n    const audioCtx = ctx.audioCtxRef.current;\n    if (!audioCtx) return;\n    if (audioCtx.state === 'suspended') audioCtx.resume?.();\n    const now = audioCtx.currentTime;\n    const osc = audioCtx.createOscillator();\n    const gain = audioCtx.createGain();\n    // short square click ~520Hz for ~90ms\n    osc.type = 'square';\n    osc.frequency.setValueAtTime(520, now);\n    gain.gain.setValueAtTime(0.0001, now);\n    gain.gain.exponentialRampToValueAtTime(Math.max(0.05, (vol ?? 0.2) * 0.2), now + 0.01);\n    gain.gain.exponentialRampToValueAtTime(0.0001, now + 0.08);\n    osc.connect(gain);\n    gain.connect(audioCtx.destination);\n    osc.start(now);\n    osc.stop(now + 0.09);\n  } catch {}\n}\n","// Horizontal movement extracted from useGameEngine.js\n\n// Calculates horizontal velocity/direction and resolves horizontal collision with snap.\n// Args:\n// - keys: input state (expects boolean a/d)\n// - state: { x, width, direction }\n// - MOVE_SPEED, TILE_SIZE, mapWidth, mapHeight\n// - checkCollision: function(newX, newY, mapWidth, mapHeight)  boolean\n// Returns: { x, vx, direction }\nexport function moveHorizontal({\n  keys,\n  state,\n  MOVE_SPEED,\n  TILE_SIZE,\n  mapWidth,\n  mapHeight,\n  checkCollision,\n  friction = 0.8,\n  acceleration = 0.2\n}) {\n  let { x, vx, width, direction } = state;\n  \n  const targetVx = keys?.a ? -MOVE_SPEED : (keys?.d ? MOVE_SPEED : 0);\n  \n  if (targetVx !== 0) {\n    // Accelerate\n    vx += targetVx * acceleration;\n    if (Math.abs(vx) > MOVE_SPEED) vx = Math.sign(vx) * MOVE_SPEED;\n    direction = Math.sign(targetVx);\n  } else {\n    // Apply friction\n    vx *= friction;\n    if (Math.abs(vx) < 0.1) vx = 0;\n  }\n\n  const proposedX = x + vx;\n  if (checkCollision(proposedX, state.y ?? 0, mapWidth, mapHeight)) {\n    if (vx > 0) {\n      // Snap to left edge of the blocking tile\n      x = Math.floor((proposedX + width) / TILE_SIZE) * TILE_SIZE - width;\n    } else if (vx < 0) {\n      // Snap to right edge of the blocking tile\n      x = Math.ceil(proposedX / TILE_SIZE) * TILE_SIZE;\n    }\n    vx = 0;\n  } else {\n    x = proposedX;\n  }\n\n  return { x, vx, direction };\n}\n\nexport default null;\n","// Vertical physics (gravity, jump, vertical collisions)\n// Migrated from GameEngine/applyVerticalPhysics.js to make core the source of truth.\n\n// Args:\n// - keys, x, y, vy, isGrounded, animation\n// - GRAVITY, TERMINAL_VELOCITY, JUMP_FORCE, TILE_SIZE\n// - width, height, mapWidth, mapHeight\n// - checkCollision(newX, newY, mapWidth, mapHeight)\n// - isWaterAt(wx, wy): optional helper to detect liquid tiles at a world pixel\n// - vx: horizontal velocity (for deciding run/idle when landing)\n// - prevInWater: whether player was in water on previous frame\n// Returns: { y, vy, isGrounded, animation, inWater, headUnderWater, atSurface }\nexport function applyVerticalPhysics({\n  keys,\n  x,\n  y,\n  vy,\n  isGrounded,\n  animation,\n  GRAVITY,\n  TERMINAL_VELOCITY,\n  JUMP_FORCE,\n  TILE_SIZE,\n  width,\n  height,\n  mapWidth,\n  mapHeight,\n  checkCollision,\n  vx,\n  isWaterAt,\n  prevInWater\n}) {\n  // Liquid defaults (can be overridden in future via per-tile sampling)\n  const LIQ_BUOYANCY = 0.5; // reduces effective gravity by 50%\n  const LIQ_DRAG_Y = 0.88;  // vertical damping per frame when in liquid\n  const LIQ_TERMINAL = Math.max(2, Math.floor(TERMINAL_VELOCITY * 0.4));\n\n  // Water detection using centerline points\n  let inWater = false;\n  let headUnderWater = false;\n  let atSurface = false;\n  if (typeof isWaterAt === 'function') {\n    const cx = x + (width || TILE_SIZE) * 0.5;\n    const headY = y + Math.min(4, (height || TILE_SIZE) * 0.125);\n    const feetY = y + (height || TILE_SIZE) - 2;\n    const chestY = y + (height || TILE_SIZE) * 0.45;\n    inWater = !!(isWaterAt(cx, feetY) || isWaterAt(cx, chestY));\n    headUnderWater = !!isWaterAt(cx, headY);\n    atSurface = inWater && !headUnderWater;\n  }\n\n  // Jump\n  if (keys?.space || keys?.w) {\n    if (inWater) {\n      // Swim stroke (allow even when not grounded)\n      const swimImpulse = Math.max(2, Math.floor(JUMP_FORCE * 0.55));\n      vy = Math.min(vy, 0); // prevent extra downward boost\n      vy -= swimImpulse * 0.5; // smaller continuous impulse\n      animation = 'jump';\n    } else if (isGrounded) {\n      vy = -JUMP_FORCE;\n      isGrounded = false;\n      animation = 'jump';\n    }\n  }\n\n  // Gravity (reduced in liquid) + vertical drag\n  if (inWater) {\n    // Entrance damping to remove harsh fall shock\n    if (!prevInWater) {\n      vy *= 0.4;\n    }\n    vy += GRAVITY * (1 - LIQ_BUOYANCY);\n    vy *= LIQ_DRAG_Y;\n    if (vy > LIQ_TERMINAL) vy = LIQ_TERMINAL;\n  } else {\n    vy += GRAVITY;\n    if (vy > TERMINAL_VELOCITY) vy = TERMINAL_VELOCITY;\n  }\n\n  // Check vertical collision at proposed Y\n  if (checkCollision(x, y + vy, mapWidth, mapHeight)) {\n    if (vy > 0) {\n      // Landing on ground\n      isGrounded = true;\n      y = Math.floor((y + vy + height) / TILE_SIZE) * TILE_SIZE - height;\n      if (Math.abs(vx || 0) > 0) {\n        animation = 'run';\n      } else {\n        animation = 'idle';\n      }\n    } else if (vy < 0) {\n      // Hitting ceiling\n      y = Math.ceil((y + vy) / TILE_SIZE) * TILE_SIZE;\n    }\n    vy = 0;\n  } else {\n    // Free fall\n    isGrounded = false;\n    y += vy;\n    if (vy > 0) {\n      animation = 'fall';\n    }\n  }\n\n  return { y, vy, isGrounded, animation, inWater, headUnderWater, atSurface };\n}\n\nexport default null;\n","// Generic liquid helpers (water, lava, etc.)\n// Liquids are defined as blocks with flags.liquid === true and optional flags.water/flags.lava\n// Optional physics params live under def.liquid: { buoyancy, drag:{x,y}, surface, swimmable, damagePerSecond }\n\n/**\n * Sample registry tile definition at world pixel and return liquid info if present.\n * @param {number} wx world x in pixels\n * @param {number} wy world y in pixels\n * @param {number} mapWidthTiles\n * @param {number} mapHeightTiles\n * @param {number} TILE_SIZE\n * @param {Array<string|null>} tileData tile ids array (background layer)\n * @param {Array<object>} registryItems game registry array\n * @returns {null|{def:object, type:'water'|'lava'|'liquid', params:object}}\n */\nexport function getLiquidAtPixel(wx, wy, mapWidthTiles, mapHeightTiles, TILE_SIZE, tileData, registryItems) {\n  if (wy < 0) return null;\n  const gx = Math.floor(wx / TILE_SIZE);\n  const gy = Math.floor(wy / TILE_SIZE);\n  if (gx < 0 || gy < 0 || gx >= mapWidthTiles || gy >= mapHeightTiles) return null;\n  const idx = gy * mapWidthTiles + gx;\n  const id = tileData[idx];\n  if (!id) return null;\n  const def = Array.isArray(registryItems) ? registryItems.find(r => r.id === id) : null;\n  if (!def || !def.flags || !def.flags.liquid) return null;\n  const type = def.flags.water ? 'water' : (def.flags.lava ? 'lava' : 'liquid');\n  const params = {\n    buoyancy: Number(def?.liquid?.buoyancy),\n    dragX: Number(def?.liquid?.drag?.x),\n    dragY: Number(def?.liquid?.drag?.y),\n    surface: !!def?.liquid?.surface,\n    swimmable: def?.flags?.swimmable === true || def?.liquid?.swimmable === true,\n    dps: Number(def?.liquid?.damagePerSecond),\n    // Optional resource models\n    oxygen: {\n      drainPerSecond: Number(def?.liquid?.oxygen?.drainPerSecond),\n      regenPerSecond: Number(def?.liquid?.oxygen?.regenPerSecond),\n      damagePerSecondWhenDepleted: Number(def?.liquid?.oxygen?.damagePerSecondWhenDepleted)\n    },\n    resistance: {\n      drainPerSecond: Number(def?.liquid?.resistance?.drainPerSecond),\n      regenPerSecond: Number(def?.liquid?.resistance?.regenPerSecond),\n      damagePerSecondWhenDepleted: Number(def?.liquid?.resistance?.damagePerSecondWhenDepleted)\n    }\n  };\n  return { def, type, params };\n}\n\n/**\n * Convenience: returns whether any liquid exists at world pixel.\n */\nexport function isLiquidAtPixel(wx, wy, mapWidthTiles, mapHeightTiles, TILE_SIZE, tileData, registryItems) {\n  return !!getLiquidAtPixel(wx, wy, mapWidthTiles, mapHeightTiles, TILE_SIZE, tileData, registryItems);\n}\n\n/**\n * Compute liquid occupancy for a player AABB and derive head/feet status.\n * @returns { inLiquid:boolean, headUnder:boolean, atSurface:boolean, type:string|null, params:object }\n */\nexport function sampleLiquidForAABB({ x, y, width, height, TILE_SIZE, mapWidth, mapHeight, tileData, registryItems }) {\n  const cx = x + width * 0.5;\n  const headY = y + Math.min(4, height * 0.125);\n  const chestY = y + height * 0.45;\n  const feetY = y + height - 2;\n\n  const feet = getLiquidAtPixel(cx, feetY, mapWidth, mapHeight, TILE_SIZE, tileData, registryItems);\n  const chest = getLiquidAtPixel(cx, chestY, mapWidth, mapHeight, TILE_SIZE, tileData, registryItems);\n  const head = getLiquidAtPixel(cx, headY, mapWidth, mapHeight, TILE_SIZE, tileData, registryItems);\n\n  const candidate = feet || chest || head;\n  if (!candidate) {\n    return { inLiquid: false, headUnder: false, atSurface: false, type: null, params: null };\n  }\n  const type = candidate.type;\n  // Merge params with sane defaults if missing\n  const p = {\n    buoyancy: Number.isFinite(candidate.params.buoyancy) ? candidate.params.buoyancy : 0.5,\n    dragX: Number.isFinite(candidate.params.dragX) ? candidate.params.dragX : 0.55,\n    dragY: Number.isFinite(candidate.params.dragY) ? candidate.params.dragY : 0.65,\n    surface: !!candidate.params.surface,\n    swimmable: !!candidate.params.swimmable,\n    dps: Number.isFinite(candidate.params.dps) ? Math.max(0, candidate.params.dps) : 0,\n    oxygen: {\n      drainPerSecond: Number.isFinite(candidate.params?.oxygen?.drainPerSecond) ? Math.max(0, candidate.params.oxygen.drainPerSecond) : 20,\n      regenPerSecond: Number.isFinite(candidate.params?.oxygen?.regenPerSecond) ? Math.max(0, candidate.params.oxygen.regenPerSecond) : 35,\n      damagePerSecondWhenDepleted: Number.isFinite(candidate.params?.oxygen?.damagePerSecondWhenDepleted) ? Math.max(0, candidate.params.oxygen.damagePerSecondWhenDepleted) : 10\n    },\n    resistance: {\n      drainPerSecond: Number.isFinite(candidate.params?.resistance?.drainPerSecond) ? Math.max(0, candidate.params.resistance.drainPerSecond) : 25,\n      regenPerSecond: Number.isFinite(candidate.params?.resistance?.regenPerSecond) ? Math.max(0, candidate.params.resistance.regenPerSecond) : 40,\n      damagePerSecondWhenDepleted: Number.isFinite(candidate.params?.resistance?.damagePerSecondWhenDepleted) ? Math.max(0, candidate.params.resistance.damagePerSecondWhenDepleted) : 15\n    }\n  };\n  const inLiquid = !!(feet || chest);\n  const headUnder = !!head;\n  const atSurface = inLiquid && !headUnder;\n  return { inLiquid, headUnder, atSurface, type, params: p };\n}\n\n/**\n * Manage per-second liquid damage. Mutates gameState.current.health and hitTimer.\n * @param {{accRef: {current:number}, gameState: any, JUMP_FORCE?:number}} env\n * @param {number} deltaMs\n * @param {{ dps:number }} params\n */\nexport function tickLiquidDamage(env, deltaMs, params) {\n  const dps = Math.max(0, Number(params?.dps) || 0);\n  if (dps <= 0) { env.accRef.current = 0; return; }\n  env.accRef.current += Math.max(0, Number(deltaMs) || 0);\n  const TICK = 1000;\n  while (env.accRef.current >= TICK) {\n    env.accRef.current -= TICK;\n    const cur = Number(env.gameState.current.health) || 0;\n    env.gameState.current.health = Math.max(0, cur - dps);\n    const HIT_FLASH_MS = 500;\n    const prev = Number(env.gameState.current.hitTimerMs) || 0;\n    env.gameState.current.hitTimerMs = Math.max(prev, HIT_FLASH_MS);\n  }\n}\n\nexport default {\n  getLiquidAtPixel,\n  isLiquidAtPixel,\n  sampleLiquidForAABB,\n  tickLiquidDamage\n};\n","// One-frame update orchestrator (migrated from GameEngine/updateFrame.js)\nimport { moveHorizontal } from '../physics/horizontal';\nimport { applyVerticalPhysics } from '../physics/vertical';\nimport { tickLiquidDamage } from '../liquids/liquidUtils';\nimport { updateEntities } from '../gameplay/entities';\n\n// updateFrame(ctx, timestamp)  { continue: boolean }\n// ctx expects:\n// - mapData, objectData\n// - input\n// - refs: { gameState, isInitialized, lastTimeRef, projectilesRef, shootCooldownRef, liquidDamageAccumulatorRef, oxygenDepleteAccRef, lavaDepleteAccRef }\n// - constants: { TILE_SIZE, GRAVITY, TERMINAL_VELOCITY, MOVE_SPEED, JUMP_FORCE }\n// - helpers: { checkCollision, isWaterAt, getLiquidSample }\n// - actions: {\n//     collectItem(x, y, mapWidth, objectData),\n//     checkHazardDamage(x, y, mapWidth, objectData, deltaMs),\n//     spawnProjectile(originX, originY, direction),\n//     updateProjectiles(deltaMs, mapWidth, mapHeight),\n//     setPlayer(nextState),\n//     onGameOver()\n//   }\nexport function updateFrame(ctx, timestamp) {\n  const {\n    mapData,\n    objectData,\n    input,\n    refs,\n    constants,\n    helpers,\n    actions\n  } = ctx;\n\n  const { gameState, isInitialized, lastTimeRef, projectilesRef, entitiesRef, shootCooldownRef, liquidDamageAccumulatorRef, oxygenDepleteAccRef, lavaDepleteAccRef } = refs;\n  const { TILE_SIZE, GRAVITY, TERMINAL_VELOCITY, MOVE_SPEED, JUMP_FORCE } = constants;\n  const { checkCollision, isWaterAt, getLiquidSample } = helpers;\n  const { collectItem, checkInteractables, checkHazardDamage, checkSecrets, spawnProjectile, updateProjectiles, setPlayer, onGameOver } = actions;\n\n  // Keep RAF alive even if init not finished yet\n  if (!isInitialized.current || !mapData) {\n    return { continue: true };\n  }\n\n  // Delta time ms\n  if (!lastTimeRef.current) {\n    lastTimeRef.current = timestamp;\n  }\n  const deltaMs = timestamp - lastTimeRef.current;\n  lastTimeRef.current = timestamp;\n\n  // Pause while terminal is open\n  try {\n    if (window.__GAME_TERMINAL_OPEN__) {\n      return { continue: true };\n    }\n  } catch {}\n\n  const mapWidth = mapData.meta?.width || mapData.width || 20;\n  const mapHeight = mapData.meta?.height || mapData.height || 15;\n  const keys = input.current;\n\n  let {\n    x,\n    y,\n    vx,\n    vy,\n    width,\n    height,\n    isGrounded,\n    direction,\n    animation,\n    ammo,\n    iceResist,\n    maxIceResist\n  } = gameState.current;\n\n  const dt = Math.max(0, deltaMs || 0);\n\n  // 0.5) Resources update (before physics to affect them)\n  // Ice resistance depletion: drains while on slippery surface; regenerates otherwise\n  const backgroundLayer = ctx.mapData.layers.find(l => l.name === 'background')?.data || [];\n  const surface = helpers.getSurfaceProperties ? helpers.getSurfaceProperties(x, y, width, height, mapWidth, mapHeight, TILE_SIZE, backgroundLayer, ctx.registryItems) : { friction: 0.8, acceleration: 0.2 };\n  \n  const isSlippery = surface.friction >= 0.9;\n  let currentIceRes = Number(iceResist);\n  const maxIce = Math.max(1, Number(maxIceResist || 100));\n  if (!Number.isFinite(currentIceRes)) currentIceRes = maxIce;\n\n  if (isSlippery) {\n    currentIceRes -= (20 * dt) / 1000;\n  } else {\n    currentIceRes += (35 * dt) / 1000;\n  }\n  currentIceRes = Math.max(0, Math.min(maxIce, currentIceRes));\n  gameState.current.iceResist = currentIceRes;\n\n  let effectiveFriction = surface.friction;\n  if (isSlippery && currentIceRes > 0) {\n      const ratio = currentIceRes / maxIce;\n      const targetFriction = 0.8;\n      effectiveFriction = surface.friction - (surface.friction - targetFriction) * ratio;\n  }\n\n  // 1) Horizontal movement\n  const checkCollisionExtended = (nx, ny, mw, mh, w, h) => {\n    // Statisk pasaule\n    if (checkCollision(nx, ny, mw, mh, w, h)) return true;\n    \n    // Enttijas (tanki)\n    if (entitiesRef.current) {\n      const pw = w || width;\n      const ph = h || height;\n      // Izmantojam punktu prbaudi ar nelielu nobdi uz ieku (0.01), \n      // ldzgi k statiskaj checkCollision, lai izvairtos no snmalu iespranas.\n      const points = [\n        { x: nx + 0.01, y: ny + 0.01 },\n        { x: nx + pw - 0.01, y: ny + 0.01 },\n        { x: nx + 0.01, y: ny + ph - 0.01 },\n        { x: nx + pw - 0.01, y: ny + ph - 0.01 }\n      ];\n\n      for (const ent of entitiesRef.current) {\n        if (ent.health <= 0 || ent.isExploding || ent.subtype === 'platform') continue;\n        \n        for (const pt of points) {\n          if (pt.x >= ent.x && pt.x <= ent.x + ent.width && pt.y >= ent.y && pt.y <= ent.y + ent.height) {\n            return true;\n          }\n        }\n      }\n    }\n    return false;\n  };\n\n  const mh = moveHorizontal({\n    keys,\n    state: { x, y, vx, width, direction },\n    MOVE_SPEED,\n    TILE_SIZE,\n    mapWidth,\n    mapHeight,\n    checkCollision: checkCollisionExtended,\n    friction: effectiveFriction,\n    acceleration: isSlippery ? (currentIceRes > 0 ? 0.15 : surface.acceleration) : surface.acceleration\n  });\n  x = mh.x; vx = mh.vx; direction = mh.direction;\n\n  // 2) Vertical physics\n  const vp = applyVerticalPhysics({\n    keys,\n    x,\n    y,\n    vy,\n    isGrounded,\n    animation,\n    GRAVITY,\n    TERMINAL_VELOCITY,\n    JUMP_FORCE,\n    TILE_SIZE,\n    width,\n    height,\n    mapWidth,\n    mapHeight,\n    checkCollision: checkCollisionExtended,\n    vx,\n    isWaterAt: (wx, wy) => {\n      try { return typeof isWaterAt === 'function' ? !!isWaterAt(wx, wy) : false; } catch { return false; }\n    },\n    prevInWater: !!gameState.current.inWater\n  });\n  y = vp.y; vy = vp.vy; isGrounded = vp.isGrounded; animation = vp.animation;\n  const inWater = !!vp.inWater;\n  const headUnderWater = !!vp.headUnderWater;\n  const atSurface = !!vp.atSurface;\n\n  // 2.5) Generic liquid sampling (water, lava, etc.)\n  let liquidType = null;\n  let liquidParams = null;\n  if (typeof getLiquidSample === 'function') {\n    try {\n      const sample = getLiquidSample({ x, y, width, height, TILE_SIZE, mapWidth, mapHeight });\n      if (sample && sample.inLiquid) {\n        liquidType = sample.type || null;\n        liquidParams = sample.params || null;\n      }\n      // Reset DPS accumulator if we just left liquids\n      if (!sample || !sample.inLiquid) {\n        if (liquidDamageAccumulatorRef) liquidDamageAccumulatorRef.current = 0;\n      }\n    } catch {}\n  }\n\n  // Extra horizontal damping when in liquids\n  if (inWater || liquidType) {\n    if (liquidType === 'lava') {\n      vx *= 0.78;\n    } else {\n      vx *= 0.82;\n    }\n  }\n\n  // 2.6) Apply liquid damage-per-second if defined (e.g., lava)\n  // Will be gated later for lava by resistance depletion; water dps usually 0.\n\n  // 2.7) Resource bars logic (oxygen & lava resistance indicators)\n  try {\n    // Initialize defaults if missing\n    const maxOxy = Math.max(1, Number(gameState.current.maxOxygen || 100));\n    const maxLava = Math.max(1, Number(gameState.current.maxLavaResist || 100));\n    let oxy = Number(gameState.current.oxygen);\n    let lavaRes = Number(gameState.current.lavaResist);\n    if (!Number.isFinite(oxy)) oxy = maxOxy;\n    if (!Number.isFinite(lavaRes)) lavaRes = maxLava;\n    // Resolve per-liquid parameters (with safe defaults)\n    const oxyParams = liquidParams?.oxygen || { drainPerSecond: 20, regenPerSecond: 35, damagePerSecondWhenDepleted: 10 };\n    const lavaParams = liquidParams?.resistance || { drainPerSecond: 25, regenPerSecond: 40, damagePerSecondWhenDepleted: 15 };\n\n    // Oxygen: drains only while head is under water; otherwise regenerates to 100 even after leaving water\n    if (headUnderWater && (liquidType === 'water' || inWater)) {\n      oxy -= (Math.max(0, Number(oxyParams.drainPerSecond) || 0) * dt) / 1000;\n    } else {\n      oxy += (Math.max(0, Number(oxyParams.regenPerSecond) || 0) * dt) / 1000;\n    }\n    // Clamp and write back\n    oxy = Math.max(0, Math.min(maxOxy, oxy));\n    gameState.current.oxygen = oxy;\n    gameState.current.maxOxygen = maxOxy;\n\n    // Lava resist depletion while in lava; regenerates outside\n    if (liquidType === 'lava') {\n      lavaRes -= (Math.max(0, Number(lavaParams.drainPerSecond) || 0) * dt) / 1000;\n    } else {\n      lavaRes += (Math.max(0, Number(lavaParams.regenPerSecond) || 0) * dt) / 1000;\n    }\n    lavaRes = Math.max(0, Math.min(maxLava, lavaRes));\n    gameState.current.lavaResist = lavaRes;\n    gameState.current.maxLavaResist = maxLava;\n\n    // Apply depletion health damage when at zero and still in corresponding liquid\n    const tickDepleteDps = (accRef, dpsValue) => {\n      const v = Math.max(0, Number(dpsValue) || 0);\n      if (v <= 0) { accRef.current = 0; return; }\n      accRef.current += dt;\n      const T = 1000;\n      while (accRef.current >= T) {\n        accRef.current -= T;\n        gameState.current.health = Math.max(0, (Number(gameState.current.health) || 0) - v);\n        // Hit flash\n        const HIT_FLASH_MS = 500;\n        const prev = Number(gameState.current.hitTimerMs) || 0;\n        gameState.current.hitTimerMs = Math.max(prev, HIT_FLASH_MS);\n      }\n    };\n\n    // Oxygen depleted and still underwater  damage\n    if ((headUnderWater && (liquidType === 'water' || inWater)) && oxy <= 0) {\n      tickDepleteDps(oxygenDepleteAccRef, oxyParams.damagePerSecondWhenDepleted);\n    } else if (oxygenDepleteAccRef) {\n      oxygenDepleteAccRef.current = 0;\n    }\n\n    // Lava resist depleted and still in lava  health damage model is gated by base DPS below\n    if (liquidType === 'lava' && lavaRes <= 0) {\n      if (lavaDepleteAccRef) lavaDepleteAccRef.current = 0;\n    } else if (lavaDepleteAccRef) {\n      lavaDepleteAccRef.current = 0;\n    }\n  } catch {}\n\n  // 2.8) Base liquid DPS (e.g., lava)  only after resource logic so we can gate by resistance\n  if (liquidType && liquidParams && Number(liquidParams.dps) > 0) {\n    try {\n      if (liquidType === 'lava') {\n        const curRes = Math.max(0, Number(gameState.current.lavaResist));\n        if (curRes <= 0) {\n          tickLiquidDamage({ accRef: liquidDamageAccumulatorRef, gameState }, deltaMs, liquidParams);\n        } else {\n          if (liquidDamageAccumulatorRef) liquidDamageAccumulatorRef.current = 0;\n        }\n      } else {\n        // Other liquids (if any in future) apply their DPS normally\n        tickLiquidDamage({ accRef: liquidDamageAccumulatorRef, gameState }, deltaMs, liquidParams);\n      }\n    } catch {}\n  } else {\n    if (liquidDamageAccumulatorRef) liquidDamageAccumulatorRef.current = 0;\n  }\n\n  // 3) Item collection and triggers\n  // Sync moved state to Ref so triggers can see it and modify it (Teleport, Knockback, etc.)\n  gameState.current.x = x;\n  gameState.current.y = y;\n  gameState.current.vx = vx;\n  gameState.current.vy = vy;\n  gameState.current.isGrounded = isGrounded;\n  gameState.current.animation = animation;\n\n  collectItem(x, y, mapWidth, objectData);\n\n  // 3.5) Interactables check (berry bushes etc.)\n  try { checkInteractables(x, y, mapWidth, objectData); } catch {}\n\n  // 4) Hazard damage check (bushes etc.)\n  try { checkHazardDamage(x, y, mapWidth, objectData, deltaMs); } catch {}\n\n  // Sync back from Ref in case triggers changed something\n  x = gameState.current.x;\n  y = gameState.current.y;\n  vx = gameState.current.vx;\n  vy = gameState.current.vy;\n\n  // 4.5) Secrets detection and reveal\n  try { if (checkSecrets) checkSecrets(x, y, width, height, mapWidth, mapHeight); } catch {}\n\n  // 5) Shooting & projectiles\n  // Cooldown update\n  if (shootCooldownRef.current > 0) shootCooldownRef.current = Math.max(0, shootCooldownRef.current - deltaMs);\n  // Get fresh ammo value after item collection\n  const currentAmmo = Math.max(0, Number(gameState.current.ammo) || 0);\n  if (keys?.mouseLeft && shootCooldownRef.current <= 0 && currentAmmo > 0) {\n    const originX = x + (direction >= 0 ? width + 4 : -4);\n    const originY = y + height / 2;\n    spawnProjectile(originX, originY, direction >= 0 ? 1 : -1, 'player');\n    shootCooldownRef.current = 350; // ms cooldown\n    gameState.current.ammo = Math.max(0, currentAmmo - 1);\n  }\n  // Update existing projectiles\n  try { updateProjectiles(deltaMs, mapWidth, mapHeight); } catch {}\n\n  // 5.5) Update entities (tanks etc.)\n  try {\n    updateEntities({\n      entitiesRef,\n      gameState,\n      mapData,\n      objectData,\n      mapWidth,\n      mapHeight,\n      TILE_SIZE,\n      checkCollision,\n      isWaterAt,\n      spawnProjectile,\n      constants,\n      registryItems: ctx.registryItems\n    }, Math.min(dt, 100)); // Ierobeojam deltaMs uz 100ms, lai izvairtos no milzgiem lcieniem\n    \n    // Sinhronizjam loklos maingos pc enttiju (platformu) ietekmes\n    x = gameState.current.x;\n    y = gameState.current.y;\n    vx = gameState.current.vx;\n    vy = gameState.current.vy;\n    isGrounded = gameState.current.isGrounded;\n    animation = gameState.current.animation;\n    \n    // Kontaktbojjumi no enttijm\n    const player = gameState.current;\n    if (entitiesRef.current && entitiesRef.current.length > 0) {\n      for (const ent of entitiesRef.current) {\n        if (ent.health <= 0 || ent.isExploding) continue;\n        \n        // AABB prbaude\n        const hit = (\n          player.x < ent.x + ent.width &&\n          player.x + player.width > ent.x &&\n          player.y < ent.y + ent.height &&\n          player.y + player.height > ent.y\n        );\n        \n        if (hit && Number(player.hitTimerMs) <= 0) {\n          // Pievienojam nelielu atgrdienu (knockback)\n          const knockbackDir = player.x + player.width / 2 < ent.x + ent.width / 2 ? -1 : 1;\n          gameState.current.vx = knockbackDir * 5;\n          gameState.current.vy = -3;\n          \n          // Iestatm bezsmertbas periodu un vizulo flash\n          gameState.current.hitTimerMs = 500;\n          \n          // Samazinm spltja veselbu\n          gameState.current.health = Math.max(0, (Number(gameState.current.health) || 0) - 10);\n          \n          if (actions.onStateUpdate) {\n            actions.onStateUpdate('playerDamage', { damage: 10 });\n          }\n        }\n      }\n    }\n  } catch (e) {\n    console.error(\"Entity update failed:\", e);\n  }\n\n  // 6) Clamp player to world bounds horizontally; allow falling below map to trigger game over\n  const maxX = mapWidth * TILE_SIZE - width;\n  x = Math.max(0, Math.min(maxX, x));\n\n  // 7) Win and Death check\n  if (gameState.current.isWinning) {\n    gameState.current.winCounter = (gameState.current.winCounter || 0) + (gameState.current.winCountSpeed || 10) * (deltaMs / 100);\n    if (gameState.current.winCounter >= 100) {\n      gameState.current.winCounter = 100;\n      // Trigger level win event if needed\n      if (actions.onStateUpdate) actions.onStateUpdate('levelWin');\n    }\n  }\n\n  if ((Number(gameState.current.health) || 0) <= 0) {\n    try { onGameOver && onGameOver(); } catch {}\n  }\n\n  // 8) Decrement hit flash timer\n  try {\n    if (Number(gameState.current.hitTimerMs) > 0) {\n      gameState.current.hitTimerMs = Math.max(0, Number(gameState.current.hitTimerMs) - deltaMs);\n    }\n  } catch {}\n\n  // 9) Commit new state for renderer\n  gameState.current = {\n    ...gameState.current,\n    x,\n    y,\n    vx,\n    vy,\n    width,\n    height,\n    isGrounded,\n    direction,\n    animation,\n    inWater,\n    headUnderWater,\n    atSurface,\n    liquidType: liquidType || null,\n    onIce: isSlippery\n  };\n  setPlayer({ ...gameState.current, projectiles: projectilesRef.current || [], entities: entitiesRef.current || [] });\n\n  return { continue: true };\n}\n\nexport default null;\n","import { moveHorizontal } from '../physics/horizontal';\nimport { applyVerticalPhysics } from '../physics/vertical';\n\n/**\n * Atjaunina visas aktvs enttijas (piemram, tankus).\n * @param {Object} ctx Konteksts ar nepiecieamajiem datiem un funkcijm\n * @param {number} deltaMs Laiks kop pdj kadra\n */\nexport function updateEntities(ctx, deltaMs) {\n  const {\n    entitiesRef,\n    gameState,\n    mapWidth,\n    mapHeight,\n    TILE_SIZE,\n    checkCollision,\n    spawnProjectile,\n    constants,\n    objectData,\n    mapData\n  } = ctx;\n\n  if (!entitiesRef.current || entitiesRef.current.length === 0) return;\n\n  const { GRAVITY, TERMINAL_VELOCITY } = constants;\n  const playerX = gameState.current.x;\n  const playerY = gameState.current.y;\n\n  // Ms modificjam enttijas pa tieo ref\n  entitiesRef.current = entitiesRef.current.map(entity => {\n    // 1. Ja enttija ir mirusi, apstrdjam sprdzienu vai noemanu\n    if (entity.health <= 0) {\n      if (!entity.isExploding) {\n        entity.isExploding = true;\n        entity.animation = 'explode';\n        entity.animFrame = 0;\n        entity.animTimer = 0;\n        entity.vx = 0; // Apstjamies sprdziena laik\n        entity.vy = 0;\n        entity.isGrounded = true; // Sprgst uz zemes\n      }\n      \n      const def = entity.def;\n      const explodeAnim = def.spriteSheet?.animations?.explode || [];\n      const totalFrames = explodeAnim.length;\n      const frameDuration = 100; // ms uz kadru\n      \n      entity.animTimer += deltaMs;\n      if (entity.animTimer >= frameDuration) {\n        entity.animTimer = 0;\n        entity.animFrame++;\n        if (entity.animFrame >= totalFrames) {\n          entity.shouldRemove = true;\n        }\n      }\n      return entity;\n    }\n\n    const def = entity.def;\n    \n    // Platformu loika\n    if (entity.subtype === 'platform') {\n      const speed = def.speed || 1.5;\n      const mapW = mapWidth;\n      const mapH = mapHeight;\n      \n      // Mekljam bultias vairkos punktos (centr un mals), lai nepalaistu garm\n      const points = [\n        { x: entity.x + entity.width / 2, y: entity.y + entity.height / 2 }, // Centrs\n        { x: entity.x + 5, y: entity.y + entity.height / 2 },                // Kreis mala\n        { x: entity.x + entity.width - 5, y: entity.y + entity.height / 2 }  // Lab mala\n      ];\n      \n      let arrowId = null;\n      let foundArrowDef = null;\n\n      for (const p of points) {\n        const tx = Math.floor(p.x / TILE_SIZE);\n        const ty = Math.floor(p.y / TILE_SIZE);\n        \n        if (tx < 0 || tx >= mapW || ty < 0 || ty >= mapH) continue;\n        const idx = ty * mapW + tx;\n\n        // 1. Specilais arrows slnis\n        const arrowsLayer = ctx.mapData?.layers?.find(l => l.name === 'arrows' || l.name === 'Arrows')?.data;\n        let id = arrowsLayer ? arrowsLayer[idx] : null;\n        \n        // 2. Objektu slnis\n        if (!id && ctx.objectData) {\n          id = ctx.objectData[idx];\n        }\n\n        if (id) {\n          const aDef = ctx.registryItems.find(r => r.id === id);\n          if (aDef && aDef.subtype === 'arrow') {\n            arrowId = id;\n            foundArrowDef = aDef;\n            break; \n          }\n        }\n      }\n      \n      if (foundArrowDef) {\n        // Mainm kustbas virzienu atbilstoi bultiai\n        if (foundArrowDef.direction === 'up') { entity.vx = 0; entity.vy = -speed; }\n        else if (foundArrowDef.direction === 'down') { entity.vx = 0; entity.vy = speed; }\n        else if (foundArrowDef.direction === 'left') { entity.vx = -speed; entity.vy = 0; }\n        else if (foundArrowDef.direction === 'right') { entity.vx = speed; entity.vy = 0; }\n      }\n\n      // Ja platforma vl nekustas, iedodam tai skuma impulsu\n      if (entity.vx === 0 && entity.vy === 0) {\n        entity.vx = speed;\n      }\n\n      // Kustba\n      let nextX = entity.x + entity.vx * (deltaMs / 16.6);\n      let nextY = entity.y + entity.vy * (deltaMs / 16.6);\n      \n      // Robeu prbaude (neaujam aizbraukt aiz kartes)\n      const worldW = mapWidth * TILE_SIZE;\n      const worldH = mapHeight * TILE_SIZE;\n      \n      if (nextX < 0) { \n        nextX = 0; \n        entity.vx = Math.abs(entity.vx); // Move Right\n      } else if (nextX + entity.width > worldW) { \n        nextX = worldW - entity.width; \n        entity.vx = -Math.abs(entity.vx); // Move Left\n      }\n      \n      if (nextY < 0) { \n        nextY = 0; \n        entity.vy = Math.abs(entity.vy); // Move Down\n      } else if (nextY + entity.height > worldH) { \n        nextY = worldH - entity.height; \n        entity.vy = -Math.abs(entity.vy); // Move Up\n      }\n      \n      entity.x = nextX;\n      entity.y = nextY;\n\n      // Spltja \"prveana\"\n      const player = gameState.current;\n      const onPlatform = (\n        player.x + player.width > entity.x &&\n        player.x < entity.x + entity.width &&\n        Math.abs((player.y + player.height) - entity.y) < 5 &&\n        player.vy >= 0\n      );\n\n      if (onPlatform) {\n        player.x += entity.vx * (deltaMs / 16.6);\n        player.y = entity.y - player.height;\n        player.vy = 0;\n        player.isGrounded = true;\n        \n        // Atjauninam animciju, lai nebtu \"fall\" uz platformas\n        if (Math.abs(player.vx) > 0.1) {\n          player.animation = 'run';\n        } else {\n          player.animation = 'idle';\n        }\n      }\n\n      return entity;\n    }\n\n    const ai = def.ai || {};\n    const reactionDist = (ai.reactionDistance || 10) * TILE_SIZE;\n    const shootDist = (ai.shootDistance || 8) * TILE_SIZE;\n    const speed = def.speed || 1.2;\n\n    const dx = playerX - entity.x;\n    const dy = playerY - entity.y;\n    const dist = Math.sqrt(dx * dx + dy * dy);\n\n    let keys = { a: false, d: false, w: false };\n\n    // 2. AI Uzvedba\n    if (dist < reactionDist) {\n      // Sekojam spltjam\n      if (dx > TILE_SIZE * 0.5) {\n          keys.d = true;\n          entity.direction = 1;\n      } else if (dx < -TILE_SIZE * 0.5) {\n          keys.a = true;\n          entity.direction = -1;\n      }\n\n      // Lkana, ja AI to atbalsta un priek ir rslis\n      if (ai.canJump && entity.isGrounded) {\n          const nextX = entity.x + entity.direction * 10;\n          if (checkCollision(nextX, entity.y, mapWidth, mapHeight, entity.width, entity.height)) {\n              keys.w = true;\n          }\n      }\n\n      // auana\n      if (dist < shootDist) {\n        if (entity.shootCooldown <= 0) {\n           const facingPlayer = (dx > 0 && entity.direction > 0) || (dx < 0 && entity.direction < 0);\n           // Tanks auj, ja skats uz spltju vai ja tas ir pietiekami tuvu\n           if (facingPlayer || dist < TILE_SIZE * 2) {\n             entity.isShooting = true;\n             entity.shootCooldown = ai.shootCooldown || 2000;\n             \n             // Izsaucam via izveidi\n             if (typeof spawnProjectile === 'function') {\n                // Novietojam viu rpus tanka korpusa (atkarb no virziena)\n                const spawnX = entity.x + (entity.width / 2) + (entity.direction * (entity.width / 2 + 10));\n                const spawnY = entity.y + (entity.height * 0.4); // Nedaudz augstk par centru (stobrs)\n                \n                spawnProjectile(\n                  spawnX, \n                  spawnY, \n                  entity.direction,\n                  entity.id\n                );\n             }\n           }\n        }\n      }\n    } else if (ai.patrol) {\n      // Patruanas rems\n      if (entity.direction > 0) keys.d = true;\n      else keys.a = true;\n\n    // Sienas un ru prbaude, lai grieztos atpaka\n    const nextX = entity.x + entity.direction * 10;\n    let hitSomething = checkCollision(nextX, entity.y, mapWidth, mapHeight, entity.width, entity.height);\n\n    // Tanku specifisk kolzija (ar spltju un citiem tankiem)\n    if (!hitSomething && entity.subtype === 'tank') {\n      // 1. Prbaude ar spltju\n      const p = gameState.current;\n      if (nextX < p.x + p.width && nextX + entity.width > p.x && entity.y < p.y + p.height && entity.y + entity.height > p.y) {\n        hitSomething = true;\n      }\n\n      // 2. Prbaude ar citiem tankiem\n      if (!hitSomething) {\n        for (const other of entitiesRef.current) {\n          if (other === entity || other.health <= 0 || other.isExploding) continue;\n          if (other.subtype !== 'tank') continue;\n\n          if (nextX < other.x + other.width && nextX + entity.width > other.x && entity.y < other.y + other.height && entity.y + entity.height > other.y) {\n            hitSomething = true;\n            // Liekam ar otram tankam maint virzienu, ja tie brauc viens otram virs\n            if ((entity.direction > 0 && other.direction < 0) || (entity.direction < 0 && other.direction > 0)) {\n               other.direction *= -1;\n            }\n            break;\n          }\n        }\n      }\n    }\n\n    if (hitSomething) {\n      entity.direction *= -1;\n    }\n    \n    // Platformas malas prbaude\n      if (ai.stayOnPlatform && entity.isGrounded) {\n          const groundX = entity.x + (entity.direction > 0 ? entity.width : 0) + entity.direction * 5;\n          const groundY = entity.y + entity.height + 5;\n          if (!checkCollision(groundX, groundY, mapWidth, mapHeight, 2, 2)) {\n              entity.direction *= -1;\n          }\n      }\n    }\n\n    // Cooldown atjaunoana\n    if (entity.shootCooldown > 0) {\n      entity.shootCooldown -= deltaMs;\n      // Pc 300ms prtraucam auanas animciju\n      if (entity.shootCooldown < (ai.shootCooldown || 2000) - 300) {\n        entity.isShooting = false;\n      }\n    }\n\n    // 3. Fizika un kustba\n    const frameSpeed = speed * (deltaMs / 16.67);\n    \n    const checkEntityCollision = (nx, ny) => {\n        // Statisk pasaule\n        if (checkCollision(nx, ny, mapWidth, mapHeight, entity.width, entity.height)) return true;\n        \n        // Tankiem blojam ceu, ja priek ir spltjs vai cits tanks\n        if (entity.subtype === 'tank') {\n            const p = gameState.current;\n            if (nx < p.x + p.width && nx + entity.width > p.x && ny < p.y + p.height && ny + entity.height > p.y) return true;\n            \n            for (const other of entitiesRef.current) {\n                if (other === entity || other.health <= 0 || other.isExploding) continue;\n                if (other.subtype !== 'tank') continue;\n                if (nx < other.x + other.width && nx + entity.width > other.x && ny < other.y + other.height && ny + entity.height > other.y) return true;\n            }\n        }\n        return false;\n    };\n\n    const mh = moveHorizontal({\n      keys,\n      state: { \n        x: entity.x, \n        y: entity.y, \n        vx: entity.vx || 0,\n        width: entity.width, \n        direction: entity.direction \n      },\n      MOVE_SPEED: frameSpeed,\n      TILE_SIZE,\n      mapWidth,\n      mapHeight,\n      checkCollision: checkEntityCollision\n    });\n    entity.x = mh.x;\n    entity.vx = mh.vx;\n    entity.direction = mh.direction;\n\n    const vp = applyVerticalPhysics({\n      keys,\n      x: entity.x,\n      y: entity.y,\n      vy: entity.vy,\n      isGrounded: entity.isGrounded,\n      animation: entity.animation,\n      GRAVITY,\n      TERMINAL_VELOCITY,\n      JUMP_FORCE: ai.canJump ? 8 : 0,\n      TILE_SIZE,\n      width: entity.width,\n      height: entity.height,\n      mapWidth,\n      mapHeight,\n      checkCollision: checkEntityCollision,\n      isWaterAt: ctx.isWaterAt,\n      vx: entity.vx\n    });\n    entity.y = vp.y;\n    entity.vy = vp.vy;\n    entity.isGrounded = vp.isGrounded;\n\n    // 4. Animcijas stvoka noteikana\n    if (entity.isShooting) {\n      entity.animation = 'shoot';\n    } else if (entity.health <= (def.maxHealth || 100) * 0.5) {\n      entity.animation = 'move_damaged';\n    } else if (entity.vx === 0 && entity.isGrounded) {\n      entity.animation = 'idle';\n    } else {\n      entity.animation = 'move';\n    }\n\n    // Atjaunojam animcijas rmi, ja tas nav sprdziens\n    if (!entity.isExploding) {\n        const anims = def.spriteSheet?.animations || {};\n        let currentAnim = anims[entity.animation];\n        \n        // Rezerves varianti, ja specifisk animcija nav atrasta\n        if (!currentAnim || !Array.isArray(currentAnim) || currentAnim.length === 0) {\n            currentAnim = anims['move'] || anims['idle'] || [0];\n        }\n        \n        entity.animTimer = (entity.animTimer || 0) + deltaMs;\n        const frameDur = 100; // ms\n        if (entity.animTimer >= frameDur) {\n            entity.animTimer = 0;\n            entity.animFrame = (entity.animFrame || 0) + 1;\n            if (entity.animFrame >= currentAnim.length) {\n                entity.animFrame = 0;\n            }\n        }\n        entity.currentSpriteIndex = currentAnim[entity.animFrame % currentAnim.length];\n    } else {\n        const explodeAnim = def.spriteSheet?.animations?.explode || [39];\n        // Sprdziena animcija tiek vadta augstk (death sekcij)\n        entity.currentSpriteIndex = explodeAnim[Math.min(entity.animFrame, explodeAnim.length - 1)];\n    }\n\n    return entity;\n  }).filter(e => !e.shouldRemove);\n}\n","// Collision helpers (migrated from GameEngine/collision.js)\n\n// Check whether a world pixel (wx, wy) is solid (collides with a tile or an object)\n// Params:\n// - wx, wy: world pixel coordinates\n// - mapWidthTiles, mapHeightTiles: map size in tiles\n// - TILE_SIZE: tile size in pixels\n// - tileData: tile layer array (ids)\n// - registryItems: registry to resolve definitions\n// - secretData: secret layer array (ids)\n// - objectData: object layer array (ids)\n// - objectMetadata: metadata for objects (e.g. health)\nexport function isSolidAtPixel(wx, wy, mapWidthTiles, mapHeightTiles, TILE_SIZE, tileData, registryItems, secretData, objectData, objectMetadata) {\n  // Allow movement above the map\n  if (wy < 0) return false;\n  const gx = Math.floor(wx / TILE_SIZE);\n  const gy = Math.floor(wy / TILE_SIZE);\n  // Out of world is not solid\n  if (gx < 0 || gy < 0 || gx >= mapWidthTiles || gy >= mapHeightTiles) return false;\n  const index = gy * mapWidthTiles + gx;\n\n  // Check if this tile has a secret - secrets make tiles passable\n  if (secretData && secretData[index]) {\n    return false;\n  }\n\n  // 1. Check objects layer first (like the wooden box)\n  if (objectData && objectData[index]) {\n    const objId = objectData[index];\n    const objDef = registryItems.find(r => r.id === objId);\n    \n    // Ignorjam enttijas kolziju prbauds (tm ir sava fizika un ts nevajadztu uztvert k blokus)\n    // Prbaudm pc vairkm pazmm, lai btu droi\n    const isEntity = objDef && (\n      objDef.type === 'entity' || \n      objDef.subtype === 'tank' || \n      objDef.subtype === 'platform' ||\n      (objDef.name && objDef.name.toLowerCase().includes('entities.'))\n    );\n\n    if (objDef && objDef.collision && !isEntity) {\n      // Special logic for destructible objects like the wooden box\n      if (objDef.isDestructible && objectMetadata && objectMetadata[index]) {\n        const health = objectMetadata[index].health !== undefined ? objectMetadata[index].health : objDef.maxHealth;\n        const threshold = objDef.passableHealthThreshold || 0;\n        if (health <= threshold) {\n          return false; // Box is broken, can pass through\n        }\n      }\n      return true;\n    }\n  }\n\n  // 2. Check tiles layer\n  const tileId = tileData[index];\n  if (!tileId) return false;\n  const tileDef = registryItems.find(r => r.id === tileId);\n  if (!tileDef || !tileDef.collision) return false;\n  if (tileDef.collision === true) return true;\n  if (typeof tileDef.collision === 'object') {\n    return !!(\n      tileDef.collision.top ||\n      tileDef.collision.bottom ||\n      tileDef.collision.left ||\n      tileDef.collision.right\n    );\n  }\n  return false;\n}\n\n// AABB collision check for player rectangle at (newX, newY)\nexport function checkCollision(newX, newY, mapWidthTiles, mapHeightTiles, TILE_SIZE, tileData, registryItems, width, height, secretData, objectData, objectMetadata) {\n  const points = [\n    { x: newX, y: newY }, // Top Left\n    { x: newX + width - 0.01, y: newY }, // Top Right\n    { x: newX, y: newY + height - 0.01 }, // Bottom Left\n    { x: newX + width - 0.01, y: newY + height - 0.01 } // Bottom Right\n  ];\n\n  for (let p of points) {\n    const gx = Math.floor(p.x / TILE_SIZE);\n    const gy = Math.floor(p.y / TILE_SIZE);\n    \n    // Boundary checks: block left, right, and top edges of the world.\n    // Allow falling off the bottom (gy >= mapHeightTiles).\n    if (gx < 0 || gx >= mapWidthTiles || gy < 0) return true;\n\n    if (isSolidAtPixel(p.x, p.y, mapWidthTiles, mapHeightTiles, TILE_SIZE, tileData, registryItems, secretData, objectData, objectMetadata)) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * Gets physical properties of the surface below the player (friction, acceleration)\n */\nexport function getSurfaceProperties(x, y, width, height, mapWidthTiles, mapHeightTiles, TILE_SIZE, tileData, registryItems) {\n  const cx = x + width / 2;\n  const feetY = y + height + 1; // 1 pixel below feet\n  const gx = Math.floor(cx / TILE_SIZE);\n  const gy = Math.floor(feetY / TILE_SIZE);\n  \n  if (gx < 0 || gy < 0 || gx >= mapWidthTiles || gy >= mapHeightTiles) {\n    return { friction: 0.8, acceleration: 0.2 };\n  }\n  \n  const index = gy * mapWidthTiles + gx;\n  const tileId = tileData[index];\n  if (!tileId) return { friction: 0.8, acceleration: 0.2 };\n  \n  const tileDef = registryItems.find(r => r.id === tileId);\n  if (!tileDef) return { friction: 0.8, acceleration: 0.2 };\n  \n  // If block has slipperiness, use it. Default friction is 0.8.\n  const slipperiness = tileDef.slipperiness !== undefined ? tileDef.slipperiness : 0.8;\n  \n  return {\n    friction: slipperiness,\n    // When slippery, acceleration is lower (harder to start/change direction)\n    acceleration: tileDef.slipperiness !== undefined ? (1 - slipperiness) * 2 + 0.05 : 0.2\n  };\n}\n\nexport default {\n  isSolidAtPixel,\n  checkCollision,\n  getSurfaceProperties\n};\n","/**\n * Centralized Error Handler\n * Provides unified error handling and logging across the application\n */\n\nclass ErrorHandler {\n  constructor() {\n    this.errorListeners = [];\n    this.logLevel = process.env.NODE_ENV === 'production' ? 'error' : 'debug';\n  }\n\n  /**\n   * Log levels: debug, info, warn, error\n   */\n  setLogLevel(level) {\n    this.logLevel = level;\n  }\n\n  /**\n   * Add error listener callback\n   * @param {Function} callback - Callback function to receive errors\n   */\n  addListener(callback) {\n    this.errorListeners.push(callback);\n  }\n\n  /**\n   * Remove error listener callback\n   * @param {Function} callback - Callback to remove\n   */\n  removeListener(callback) {\n    this.errorListeners = this.errorListeners.filter(cb => cb !== callback);\n  }\n\n  /**\n   * Notify all listeners of an error\n   * @param {Error} error - The error object\n   * @param {Object} context - Additional context information\n   */\n  notifyListeners(error, context = {}) {\n    this.errorListeners.forEach(callback => {\n      try {\n        callback(error, context);\n      } catch (err) {\n        console.error('Error in error listener:', err);\n      }\n    });\n  }\n\n  /**\n   * Handle and log an error\n   * @param {Error|string} error - The error to handle\n   * @param {Object} context - Additional context information\n   * @param {string} level - Log level (debug, info, warn, error)\n   */\n  handle(error, context = {}, level = 'error') {\n    const errorObj = error instanceof Error ? error : new Error(String(error));\n    const timestamp = new Date().toISOString();\n\n    const logData = {\n      timestamp,\n      level,\n      message: errorObj.message,\n      stack: errorObj.stack,\n      context,\n    };\n\n    // Console logging based on level\n    if (this.shouldLog(level)) {\n      const logMethod = console[level] || console.error;\n      logMethod(`[${timestamp}] [${level.toUpperCase()}]`, errorObj.message, context);\n\n      if (errorObj.stack && level === 'error') {\n        console.error(errorObj.stack);\n      }\n    }\n\n    // Notify listeners\n    if (level === 'error' || level === 'warn') {\n      this.notifyListeners(errorObj, context);\n    }\n\n    // In development, you could send to external logging service\n    if (process.env.NODE_ENV === 'production') {\n      this.sendToLoggingService(logData);\n    }\n\n    return errorObj;\n  }\n\n  /**\n   * Determine if a log level should be printed based on current log level setting\n   * @param {string} level - The log level to check\n   * @returns {boolean}\n   */\n  shouldLog(level) {\n    const levels = { debug: 0, info: 1, warn: 2, error: 3 };\n    const currentLevel = levels[this.logLevel] || 0;\n    const messageLevel = levels[level] || 0;\n    return messageLevel >= currentLevel;\n  }\n\n  /**\n   * Send error data to external logging service (stub for now)\n   * @param {Object} logData - The log data to send\n   */\n  sendToLoggingService(logData) {\n    // TODO: Implement integration with external logging service\n    // (e.g., Sentry, LogRocket, etc.)\n  }\n\n  /**\n   * Convenience methods for different log levels\n   */\n  debug(message, context = {}) {\n    return this.handle(message, context, 'debug');\n  }\n\n  info(message, context = {}) {\n    return this.handle(message, context, 'info');\n  }\n\n  warn(message, context = {}) {\n    return this.handle(message, context, 'warn');\n  }\n\n  error(message, context = {}) {\n    return this.handle(message, context, 'error');\n  }\n\n  /**\n   * Wrap an async function with error handling\n   * @param {Function} fn - The async function to wrap\n   * @param {Object} context - Additional context for errors\n   * @returns {Function} Wrapped function\n   */\n  wrapAsync(fn, context = {}) {\n    return async (...args) => {\n      try {\n        return await fn(...args);\n      } catch (error) {\n        this.handle(error, { ...context, args }, 'error');\n        throw error;\n      }\n    };\n  }\n\n  /**\n   * Wrap a sync function with error handling\n   * @param {Function} fn - The function to wrap\n   * @param {Object} context - Additional context for errors\n   * @returns {Function} Wrapped function\n   */\n  wrapSync(fn, context = {}) {\n    return (...args) => {\n      try {\n        return fn(...args);\n      } catch (error) {\n        this.handle(error, { ...context, args }, 'error');\n        throw error;\n      }\n    };\n  }\n}\n\n// Export singleton instance\nconst errorHandler = new ErrorHandler();\n\nexport default errorHandler;\nexport { ErrorHandler };\n","import { useState, useEffect, useRef } from 'react';\nimport { useInput } from './useInput';\nimport { findItemById } from '../engine/registry';\nimport { checkHazardDamage, spawnProjectile as spawnProjectileExternal, collectItem, checkInteractables, updateProjectiles } from '../engine/gameplay';\nimport { checkSecretDetection } from '../engine/gameplay/secrets';\nimport { playSfx } from '../engine/audio';\nimport { updateFrame } from '../engine/loop/updateFrame';\nimport { getLiquidAtPixel, isLiquidAtPixel as isLiquidAtPixelUtil, sampleLiquidForAABB } from '../engine/liquids/liquidUtils';\nimport { isSolidAtPixel as isSolidAtPixelExternal, checkCollision as checkCollisionExternal, getSurfaceProperties } from '../engine/physics';\nimport {\n    TILE_SIZE,\n    GRAVITY,\n    TERMINAL_VELOCITY,\n    MOVE_SPEED,\n    JUMP_FORCE,\n    MAX_HEALTH,\n    MAX_OXYGEN,\n    MAX_LAVA_RESIST,\n    MAX_ICE_RESIST\n} from '../constants/gameConstants';\nimport errorHandler from '../services/errorHandler';\n\n// Helper: accept boolean or string values like \"true\"/\"false\"\nconst parseBool = (v, def = false) => {\n    if (typeof v === 'boolean') return v;\n    if (typeof v === 'string') return v.trim().toLowerCase() === 'true';\n    return def;\n};\n\n// Modified arguments: added objectData, secretData, revealedSecrets, onRevealSecret, objectMetadata\nexport const useGameEngine = (mapData, tileData, objectData, secretData, revealedSecrets, registryItems, onGameOver, onStateUpdate, onRevealSecret, objectMetadata) => {\n    const input = useInput();\n\n    // Player state\n    const [player, setPlayer] = useState({\n        x: 0, // In pixels\n        y: 0, // In pixels\n        width: 32, // Default, will be overwritten from registry\n        height: 32,\n        vx: 0,\n        vy: 0,\n        isGrounded: false,\n        direction: 1, // 1 right, -1 left\n        animation: 'idle', // idle, run, jump\n        health: 90, // Initial health (for testing, to allow picking up hearts)\n        maxHealth: MAX_HEALTH,\n        ammo: 0, // Fireball ammunition\n        // New resources for display\n        oxygen: MAX_OXYGEN,\n        maxOxygen: MAX_OXYGEN,\n        lavaResist: MAX_LAVA_RESIST,\n        maxLavaResist: MAX_LAVA_RESIST,\n        iceResist: MAX_ICE_RESIST,\n        maxIceResist: MAX_ICE_RESIST,\n        isWinning: false,\n        winCounter: 0,\n        projectiles: [] // Active projectiles for rendering\n  });\n\n    // Ref objects for game logic\n    const gameState = useRef({ ...player });               // Player state for loop (avoids closure issues)\n    const requestRef = useRef();                           // requestAnimationFrame id\n    const isInitialized = useRef(false);                   // Whether game is initialized\n    const lastTimeRef = useRef(0);                         // Time between frames (t)\n    const hazardDamageAccumulatorRef = useRef(0);          // Accumulated time for hazard damage over time\n    const lastHazardIndexRef = useRef(null);               // Last hazard tile index cache (to associate damage with specific hazard)\n    const triggeredHazardsRef = useRef(new Set());         // Hazards with damageOnce: true that have already triggered\n    const projectilesRef = useRef([]);                     // Active projectiles\n    const shootCooldownRef = useRef(0);                    // Remaining cooldown time (ms)\n    const projectileIdRef = useRef(1);                     // Auto-incrementing ID\n    const soundEnabledRef = useRef(false);                 // Global sound toggle\n    const audioCtxRef = useRef(null);                      // WebAudio context (fallback)\n    const audioCtxUnlockedRef = useRef(false);             // Whether AudioContext is unlocked with user gesture\n    const liquidDamageAccumulatorRef = useRef(0);          // Accumulated time for liquid DPS ticking (e.g., lava)\n    const oxygenDepleteAccRef = useRef(0);                 // O2 depletion DPS accumulator\n    const lavaDepleteAccRef = useRef(0);                   // Lava resist depletion DPS accumulator\n    const entitiesRef = useRef([]);                        // Active moving entities (tanks, etc.)\n\n    // Refs for props to avoid stale closures in the game loop\n    const onStateUpdateRef = useRef(onStateUpdate);\n    const onRevealSecretRef = useRef(onRevealSecret);\n    const onGameOverRef = useRef(onGameOver);\n    const objectMetadataRef = useRef(objectMetadata);\n    const revealedSecretsRef = useRef(revealedSecrets);\n\n    useEffect(() => { onStateUpdateRef.current = onStateUpdate; }, [onStateUpdate]);\n    useEffect(() => { onRevealSecretRef.current = onRevealSecret; }, [onRevealSecret]);\n    useEffect(() => { onGameOverRef.current = onGameOver; }, [onGameOver]);\n    useEffect(() => { objectMetadataRef.current = objectMetadata; }, [objectMetadata]);\n    useEffect(() => { revealedSecretsRef.current = revealedSecrets; }, [revealedSecrets]);\n\n    // Sync global sound toggle from localStorage and events\n    useEffect(() => {\n        try {\n            const v = localStorage.getItem('game_sound_enabled');\n            soundEnabledRef.current = (v === null ? false : v !== '0');\n        } catch { soundEnabledRef.current = false; }\n        const onToggle = (e) => {\n            try {\n                const enabled = !!(e?.detail?.enabled);\n                soundEnabledRef.current = enabled;\n            } catch {}\n        };\n        window.addEventListener('game-sound-toggle', onToggle);\n        // AudioContext unlocking with user gesture (click on HUD button, etc.)\n        const onUserGesture = () => {\n            try {\n                if (!audioCtxRef.current) {\n                    const AC = window.AudioContext || window.webkitAudioContext;\n                    if (AC) audioCtxRef.current = new AC();\n                }\n                if (audioCtxRef.current && audioCtxRef.current.state === 'suspended') {\n                    audioCtxRef.current.resume?.();\n                }\n                if (audioCtxRef.current && audioCtxRef.current.state === 'running') {\n                    audioCtxUnlockedRef.current = true;\n                }\n            } catch {}\n        };\n        window.addEventListener('game-sound-user-gesture', onUserGesture);\n        return () => {\n            window.removeEventListener('game-sound-toggle', onToggle);\n            window.removeEventListener('game-sound-user-gesture', onUserGesture);\n        };\n    }, []);\n\n    // Helper function: play SFX (delegated to GameEngine/audio)\n    const playShotSfx = (url, volume) => {\n        return playSfx({ soundEnabledRef, audioCtxRef, audioCtxUnlockedRef }, url, volume);\n    };\n\n    // Adapter: correctly calls GameEngine/checkHazardDamage with options object\n    const checkHazardDamageWrapper = (currentX, currentY, mapWidth, objectLayerData, deltaMs) => {\n        try {\n            return checkHazardDamage({\n                currentX,\n                currentY,\n                mapWidth,\n                objectLayerData,\n                deltaMs,\n                registryItems,\n                TILE_SIZE,\n                MOVE_SPEED,\n                JUMP_FORCE,\n                hazardDamageAccumulatorRef,\n                lastHazardIndexRef,\n                triggeredHazardsRef,\n                gameState\n            });\n        } catch (error) {\n            errorHandler.error(error, {\n                component: 'useGameEngine',\n                function: 'checkHazardDamageWrapper',\n                playerPosition: { x: currentX, y: currentY },\n                mapWidth\n            });\n            return { damage: 0, damageType: null };\n        }\n    };\n\n    // Track revealed secrets locally to prevent duplicate reveals before state updates\n    const localRevealedRef = useRef(new Set());\n\n    // Secrets detection wrapper\n    const checkSecretsWrapper = (currentX, currentY, width, height, mapWidth, mapHeight) => {\n        try {\n            if (!secretData || !onRevealSecretRef.current) return;\n\n            // Merge prop revealedSecrets with local tracking\n            const mergedRevealed = [\n                ...(revealedSecretsRef.current || []),\n                ...Array.from(localRevealedRef.current)\n            ];\n\n            const indicesToReveal = checkSecretDetection({\n                currentX,\n                currentY,\n                width,\n                height,\n                secretMapData: secretData,\n                revealedSecrets: mergedRevealed,\n                mapWidth,\n                mapHeight,\n                registryItems,\n                TILE_SIZE\n            });\n\n            if (indicesToReveal && indicesToReveal.length > 0) {\n                // Add to local tracking immediately (before state updates)\n                indicesToReveal.forEach(idx => localRevealedRef.current.add(idx));\n                onRevealSecretRef.current(indicesToReveal);\n            }\n        } catch (error) {\n            errorHandler.error(error, {\n                component: 'useGameEngine',\n                function: 'checkSecretsWrapper',\n                playerPosition: { x: currentX, y: currentY }\n            });\n        }\n    };\n\n    const lastMapIdRef = useRef(null);\n\n    // Initialize player at starting position\n    useEffect(() => {\n        if (!mapData) {\n            isInitialized.current = false;\n            lastMapIdRef.current = null;\n            return;\n        }\n\n        // Unique identifier for the map session\n        // We use created_at/updated time or just the object reference itself if it's a completely new load\n        // In Game/index.jsx loadMapData creates a new object {...activeMapData} for reset.\n        const meta = mapData.meta || {};\n        const currentMapId = meta.date_map_last_updated || meta.date_map_created_at || mapData.name || 'default';\n        const isNewMapLoad = currentMapId !== lastMapIdRef.current;\n\n        // Ja sple jau ir inicializta UN t ir t pati karte, nemainm spltja pozciju\n        // Tas novr \"reset\" uz skumu, kad spltjs pace itemu (kas maina mapData atsauci, bet ne saturu)\n        // Ataujam prldi, ja enttiju saraksts ir tuks (drobai)\n        if (isInitialized.current && !isNewMapLoad && entitiesRef.current.length > 0) return;\n\n        lastMapIdRef.current = currentMapId;\n\n        // Reset state for new initialization\n        lastTimeRef.current = 0;\n        hazardDamageAccumulatorRef.current = 0;\n        lastHazardIndexRef.current = null;\n        triggeredHazardsRef.current = new Set();\n        projectilesRef.current = [];\n        entitiesRef.current = [];\n        shootCooldownRef.current = 0;\n        projectileIdRef.current = 1;\n\n        if (mapData && mapData.layers) {\n            const mapW = mapData.meta?.width || mapData.width || 20;\n            const mapH = mapData.meta?.height || mapData.height || 15;\n            \n            // Search for entities in objectData\n            const initialEntities = [];\n            if (objectData && Array.isArray(objectData)) {\n                objectData.forEach((id, idx) => {\n                    if (id && !id.includes('player')) {\n                        const def = findItemById(id) || registryItems.find(r => r.id === id);\n                        const isEntity = def && (\n                            def.type === 'entity' || \n                            def.subtype === 'tank' || \n                            def.subtype === 'platform' ||\n                            (def.name && def.name.toLowerCase().includes('entities.'))\n                        );\n\n                        if (isEntity) {\n                            initialEntities.push({\n                                id: `entity_${idx}_${Date.now()}_${idx}`,\n                                defId: id,\n                                def: def,\n                                x: (idx % mapW) * TILE_SIZE,\n                                y: Math.floor(idx / mapW) * TILE_SIZE,\n                                width: (Number(def.width) || 1) * TILE_SIZE,\n                                height: (Number(def.height) || 1) * TILE_SIZE,\n                                vx: 0,\n                                vy: 0,\n                                health: def.maxHealth || 100,\n                                direction: def.subtype === 'platform' ? 1 : -1,\n                                animation: def.subtype === 'platform' ? 'idle' : 'move',\n                                animFrame: 0,\n                                animTimer: 0,\n                                isGrounded: false,\n                                shootCooldown: 0,\n                                currentSpriteIndex: 0,\n                                subtype: def.subtype\n                            });\n                        }\n                    }\n                });\n            }\n            entitiesRef.current = initialEntities;\n\n            const objLayer = mapData.layers.find(l => l.name === 'entities');\n            if (objLayer) {\n                // Search for player (anything containing 'player')\n                const startIndex = objLayer.data.findIndex(id => id && id.includes('player'));\n\n                if (startIndex !== -1) {\n                    let startX = (startIndex % mapW) * TILE_SIZE;\n                    let startY = Math.floor(startIndex / mapW) * TILE_SIZE;\n\n                    // Get data from registry\n                    const playerId = objLayer.data[startIndex];\n                    const registryPlayer = findItemById(playerId) || findItemById(\"player\"); // Fallback to generic player\n                    const maxHealth = Math.max(1, Number(registryPlayer?.maxHealth) || MAX_HEALTH);\n\n                    // Completely overwrite gameState with default values + new position\n                    gameState.current = {\n                        x: startX,\n                        y: startY,\n                        width: (registryPlayer?.width || 1) * TILE_SIZE * 0.8,\n                        height: (registryPlayer?.height || 1) * TILE_SIZE,\n                        vx: 0,\n                        vy: 0,\n                        isGrounded: false,\n                        direction: 1,\n                        animation: 'idle',\n                        health: Math.min(90, maxHealth), // Reset to 90 (not MAX) to allow testing items\n                        maxHealth,\n                        ammo: 0,\n                        // resources\n                        oxygen: MAX_OXYGEN,\n                        maxOxygen: MAX_OXYGEN,\n                        lavaResist: MAX_LAVA_RESIST,\n                        maxLavaResist: MAX_LAVA_RESIST,\n                        isWinning: false,\n                        winCounter: 0\n                    };\n\n                    // If start position sinks into block, move up to safe location\n                    let guard = 0;\n                    while (checkCollision(gameState.current.x, gameState.current.y, mapW, mapH) && guard < mapH) {\n                        gameState.current.y = Math.max(0, gameState.current.y - TILE_SIZE);\n                        guard++;\n                    }\n                    // Ensure we're not outside world boundaries horizontally\n                    const maxXAtStart = mapW * TILE_SIZE - gameState.current.width;\n                    gameState.current.x = Math.max(0, Math.min(gameState.current.x, maxXAtStart));\n\n                    setPlayer({ ...gameState.current, projectiles: [], entities: entitiesRef.current });\n                    isInitialized.current = true;\n                } else {\n                    // If player not found in map, place at 0,0 or some safe location\n                    gameState.current = {\n                        ...gameState.current,\n                        x: 0,\n                        y: 0,\n                        vx: 0,\n                        vy: 0,\n                        oxygen: MAX_OXYGEN,\n                        maxOxygen: MAX_OXYGEN,\n                        lavaResist: MAX_LAVA_RESIST,\n                        maxLavaResist: MAX_LAVA_RESIST\n                    };\n                    setPlayer({ ...gameState.current, projectiles: [], entities: entitiesRef.current });\n                    isInitialized.current = true; // allow loop to work even without start position\n                }\n            } else {\n                // No entities layer  still start game at 0,0\n                gameState.current = {\n                    ...gameState.current,\n                    x: 0,\n                    y: 0,\n                    vx: 0,\n                    vy: 0,\n                    oxygen: MAX_OXYGEN,\n                    maxOxygen: MAX_OXYGEN,\n                    lavaResist: MAX_LAVA_RESIST,\n                    maxLavaResist: MAX_LAVA_RESIST\n                };\n                setPlayer({ ...gameState.current, projectiles: [], entities: entitiesRef.current });\n                isInitialized.current = true;\n            }\n        }\n    }, [mapData, objectData]);\n\n    // Helper function for collisions (AABB Collision) with blocks (tile layer)  delegates to GameEngine/collision\n    const checkCollision = (newX, newY, mapWidth, mapHeightParam, widthOverride, heightOverride) => {\n        return checkCollisionExternal(\n            newX,\n            newY,\n            mapWidth,\n            mapHeightParam,\n            TILE_SIZE,\n            tileData,\n            registryItems,\n            widthOverride !== undefined ? widthOverride : gameState.current.width,\n            heightOverride !== undefined ? heightOverride : gameState.current.height,\n            secretData,\n            objectData,\n            objectMetadataRef.current || mapData?.meta?.objectMetadata\n        );\n    };\n\n    // Simple point solidity check for projectiles  delegates to GameEngine/collision\n    const isSolidAtPixel = (wx, wy, mapWidthTiles, mapHeightTiles, TILE_SIZE_OVERRIDE, tileDataOverride, registryItemsOverride, secretDataOverride, objectDataOverride, objectMetadataOverride) => {\n        return isSolidAtPixelExternal(\n            wx,\n            wy,\n            mapWidthTiles,\n            mapHeightTiles,\n            TILE_SIZE_OVERRIDE || TILE_SIZE,\n            tileDataOverride || tileData,\n            registryItemsOverride || registryItems,\n            secretDataOverride || secretData,\n            objectDataOverride || objectData,\n            objectMetadataOverride || objectMetadataRef.current || mapData?.meta?.objectMetadata\n        );\n    };\n\n    // New: water presence check at a world pixel\n    const isWaterAtPixel = (wx, wy, mapWidthTiles, mapHeightTiles) => {\n        // Strict: Only treat WATER as buoyant/swimmable in vertical physics\n        const liq = getLiquidAtPixel(wx, wy, mapWidthTiles, mapHeightTiles, TILE_SIZE, tileData, registryItems);\n        return !!(liq && liq.type === 'water');\n    };\n\n    // Liquid sampling helper for update loop (AABB based)\n    const sampleLiquid = (aabb, mapWidthTiles, mapHeightTiles) => {\n        return sampleLiquidForAABB({\n            x: aabb.x,\n            y: aabb.y,\n            width: aabb.width,\n            height: aabb.height,\n            TILE_SIZE,\n            mapWidth: mapWidthTiles,\n            mapHeight: mapHeightTiles,\n            tileData,\n            registryItems\n        });\n    };\n\n    // Item collection  moved to GameEngine/collectItem\n\n    // Helper function: create new projectile  moved to separate module\n    const spawnProjectile = (originX, originY, direction, ownerId = 'player') => {\n        return spawnProjectileExternal({\n            findItemById,\n            TILE_SIZE,\n            parseBool,\n            projectilesRef,\n            projectileIdRef,\n            playShotSfx\n        }, originX, originY, direction, ownerId);\n    };\n\n    // Game Loop (delegated to GameEngine/updateFrame)\n    const update = (timestamp) => {\n        const ctx = {\n            mapData,\n            objectData,\n            input,\n            refs: { gameState, isInitialized, lastTimeRef, projectilesRef, entitiesRef, shootCooldownRef, liquidDamageAccumulatorRef, oxygenDepleteAccRef, lavaDepleteAccRef },\n            constants: { TILE_SIZE, GRAVITY, TERMINAL_VELOCITY, MOVE_SPEED, JUMP_FORCE },\n            registryItems,\n            helpers: {\n                checkCollision,\n                getSurfaceProperties: (x, y, w, h, mw, mh, ts, td, ri) => getSurfaceProperties(x, y, w, h, mw, mh, ts, td, ri),\n                isWaterAt: (wx, wy) => isWaterAtPixel(wx, wy, (mapData?.meta?.width || mapData?.width || 20), (mapData?.meta?.height || mapData?.height || 15)),\n                getLiquidSample: ({ x, y, width, height, TILE_SIZE: TS, mapWidth, mapHeight }) =>\n                    sampleLiquid({ x, y, width, height }, (mapData?.meta?.width || mapData?.width || 20), (mapData?.meta?.height || mapData?.height || 15))\n            },\n            actions: {\n                collectItem: (x, y, mapWidth, objectLayer) =>\n                    collectItem({ registryItems, TILE_SIZE, MAX_HEALTH, playShotSfx, onStateUpdate: onStateUpdateRef.current, gameState }, x, y, mapWidth, objectLayer),\n                checkInteractables: (x, y, mapWidth, objectLayer) =>\n                    checkInteractables({ registryItems, TILE_SIZE, MAX_HEALTH, playShotSfx, onStateUpdate: onStateUpdateRef.current, gameState, mapData }, x, y, mapWidth, objectLayer),\n                checkHazardDamage: (x, y, mapWidth, objectLayer, deltaMs) =>\n                    checkHazardDamageWrapper(x, y, mapWidth, objectLayer, deltaMs),\n                checkSecrets: (x, y, width, height, mapWidth, mapHeight) =>\n                    checkSecretsWrapper(x, y, width, height, mapWidth, mapHeight),\n                spawnProjectile: (originX, originY, direction, ownerId) =>\n                    spawnProjectile(originX, originY, direction, ownerId),\n                updateProjectiles: (deltaMs, mapWidth, mapHeight) =>\n                    updateProjectiles({ \n                        projectilesRef, \n                        entitiesRef,\n                        playerState: gameState.current,\n                        TILE_SIZE, \n                        isSolidAtPixel, \n                        findItemById, \n                        objectData, \n                        objectMetadata: objectMetadataRef.current || mapData?.meta?.objectMetadata, \n                        onStateUpdate: onStateUpdateRef.current\n                    }, deltaMs, mapWidth, mapHeight),\n                setPlayer: (next) => setPlayer(next),\n                onGameOver: onGameOverRef.current\n            }\n        };\n        const res = updateFrame(ctx, timestamp);\n        if (res?.continue !== false) {\n            requestRef.current = requestAnimationFrame(update);\n        }\n    };\n\n    // Loop initialization / restart\n    useEffect(() => {\n        if (!mapData) return;\n        requestRef.current = requestAnimationFrame(update);\n        return () => {\n            if (requestRef.current) cancelAnimationFrame(requestRef.current);\n        };\n    }, [mapData, objectData]); // Restart loop if map or objects change\n\n    return player;\n};\n","import { useEffect, useRef } from 'react';\n\nexport const useInput = () => {\n    const keys = useRef({\n        w: false,\n        a: false,\n        s: false,\n        d: false,\n        space: false,\n        mouseLeft: false\n    });\n\n    useEffect(() => {\n        const isTerminalOpen = () => {\n            try { return !!window.__GAME_TERMINAL_OPEN__; } catch { return false; }\n        };\n\n        const clearKeys = () => {\n            keys.current.w = false;\n            keys.current.a = false;\n            keys.current.s = false;\n            keys.current.d = false;\n            keys.current.space = false;\n            keys.current.mouseLeft = false;\n        };\n\n        const handleKeyDown = (e) => {\n            // Do not toggle when typing into inputs/textareas/contenteditable\n            const tag = (e.target && e.target.tagName) ? e.target.tagName.toUpperCase() : '';\n            const typing = tag === 'INPUT' || tag === 'TEXTAREA' || (e.target && e.target.isContentEditable);\n\n            // Toggle in-game terminal with 'T'\n            if (!typing && e.code === 'KeyT' && !e.repeat) {\n                try { window.dispatchEvent(new CustomEvent('game-toggle-terminal')); } catch {}\n                clearKeys();\n                // prevent game movement while toggling\n                if (typeof e.preventDefault === 'function') e.preventDefault();\n                return;\n            }\n\n            // Prevent browser scrolling / focus hijack for game controls only when NOT typing and terminal is closed\n            if (!typing && !isTerminalOpen()) {\n                switch (e.code) {\n                    case 'KeyW':\n                    case 'ArrowUp':\n                    case 'KeyA':\n                    case 'ArrowLeft':\n                    case 'KeyS':\n                    case 'ArrowDown':\n                    case 'KeyD':\n                    case 'ArrowRight':\n                    case 'Space':\n                        if (typeof e.preventDefault === 'function') e.preventDefault();\n                        break;\n                    default:\n                        break;\n                }\n            }\n\n            // If terminal is open, ignore gameplay inputs so player doesn't move while typing\n            if (isTerminalOpen()) return;\n\n            switch (e.code) {\n                case 'KeyW':\n                case 'ArrowUp':\n                    keys.current.w = true; break;\n                case 'KeyA':\n                case 'ArrowLeft':\n                    keys.current.a = true; break;\n                case 'KeyS':\n                case 'ArrowDown':\n                    keys.current.s = true; break;\n                case 'KeyD':\n                case 'ArrowRight':\n                    keys.current.d = true; break;\n                case 'Space': keys.current.space = true; break;\n                default: break;\n            }\n        };\n\n        const handleMouseDown = (e) => {\n            // Left button only\n            if (e.button !== 0) return;\n            if (isTerminalOpen()) return;\n            keys.current.mouseLeft = true;\n        };\n\n        const handleMouseUp = (e) => {\n            if (e.button !== 0) return;\n            if (isTerminalOpen()) return;\n            keys.current.mouseLeft = false;\n        };\n\n        const handleKeyUp = (e) => {\n            // Allow closing terminal with Escape (terminal component also handles it)\n            if (e.code === 'Escape') return;\n\n            if (isTerminalOpen()) {\n                // When terminal is open, we do not change gameplay key states here\n                return;\n            }\n\n            switch (e.code) {\n                case 'KeyW':\n                case 'ArrowUp':\n                    keys.current.w = false; break;\n                case 'KeyA':\n                case 'ArrowLeft':\n                    keys.current.a = false; break;\n                case 'KeyS':\n                case 'ArrowDown':\n                    keys.current.s = false; break;\n                case 'KeyD':\n                case 'ArrowRight':\n                    keys.current.d = false; break;\n                case 'Space': keys.current.space = false; break;\n                default: break;\n            }\n        };\n\n        const onToggleTerminal = () => clearKeys();\n\n        // non-passive to allow preventDefault on Space/Arrow keys\n        window.addEventListener('keydown', handleKeyDown, { passive: false });\n        window.addEventListener('keyup', handleKeyUp, { passive: false });\n        window.addEventListener('game-toggle-terminal', onToggleTerminal);\n        window.addEventListener('mousedown', handleMouseDown, { passive: true });\n        window.addEventListener('mouseup', handleMouseUp, { passive: true });\n\n        return () => {\n            window.removeEventListener('keydown', handleKeyDown, { passive: false });\n            window.removeEventListener('keyup', handleKeyUp, { passive: false });\n            window.removeEventListener('game-toggle-terminal', onToggleTerminal);\n            window.removeEventListener('mousedown', handleMouseDown, { passive: true });\n            window.removeEventListener('mouseup', handleMouseUp, { passive: true });\n        };\n    }, []);\n\n    return keys;\n};","// Hazard damage calculation (migrated from GameEngine/checkHazardDamage.js)\n\nexport function checkHazardDamage({\n  currentX,\n  currentY,\n  mapWidth,\n  objectLayerData,\n  deltaMs,\n  registryItems,\n  TILE_SIZE,\n  MOVE_SPEED,\n  JUMP_FORCE,\n  hazardDamageAccumulatorRef,\n  lastHazardIndexRef,\n  triggeredHazardsRef,\n  gameState\n}) {\n  if (!objectLayerData) {\n    hazardDamageAccumulatorRef.current = 0;\n    lastHazardIndexRef.current = null;\n    return;\n  }\n\n  const width = gameState.current.width;\n  const height = gameState.current.height;\n\n  // Player AABB in world pixels\n  const playerLeft = currentX;\n  const playerRight = currentX + width;\n  const playerTop = currentY;\n  const playerBottom = currentY + height;\n\n  // Overlapped tile rectangle (inclusive)\n  const minGX = Math.floor(playerLeft / TILE_SIZE);\n  const maxGX = Math.floor(playerRight / TILE_SIZE);\n  const minGY = Math.floor(playerTop / TILE_SIZE);\n  const maxGY = Math.floor(playerBottom / TILE_SIZE);\n\n  // Collect candidate hazards that match direction rules\n  const candidates = [];\n\n  const pushCandidate = (idx, def, touch) => {\n    const dirs = def.damageDirections || { top: true, bottom: true, left: true, right: true };\n    const ok = (touch.top && dirs.top) || (touch.bottom && dirs.bottom) || (touch.left && dirs.left) || (touch.right && dirs.right);\n    if (!ok) return;\n    candidates.push({ index: idx, def, touch });\n  };\n\n  for (let gy = minGY; gy <= maxGY; gy++) {\n    for (let gx = minGX; gx <= maxGX; gx++) {\n      const idx = gy * mapWidth + gx;\n      if (idx < 0 || idx >= objectLayerData.length) continue;\n      const objId = objectLayerData[idx];\n      if (!objId) continue;\n      const def = registryItems.find(r => r.id === objId);\n      if (!def || def.type !== 'hazard') continue;\n\n      const tileLeft = gx * TILE_SIZE;\n      const tileRight = tileLeft + TILE_SIZE;\n      const tileTop = gy * TILE_SIZE;\n      const tileBottom = tileTop + TILE_SIZE;\n\n      const overlapsHorizontally = playerRight >= tileLeft && playerLeft <= tileRight;\n      const overlapsVertically = playerBottom >= tileTop && playerTop <= tileBottom;\n      if (!overlapsHorizontally || !overlapsVertically) continue;\n\n      // Allow per-hazard touch margin; default 4px\n      let m = Number(def.touchMargin);\n      if (!Number.isFinite(m)) m = 4;\n      m = Math.max(1, Math.min(8, m));\n\n      let touchingTop = playerBottom >= tileTop && playerBottom <= tileTop + m;\n      let touchingBottom = playerTop <= tileBottom && playerTop >= tileBottom - m;\n      let touchingLeft = playerRight >= tileRight - m && playerRight <= tileRight;\n      let touchingRight = playerLeft <= tileLeft + m && playerLeft >= tileLeft;\n\n      // Fallback: infer side by smallest penetration when inside tile\n      if (!touchingTop && !touchingBottom && !touchingLeft && !touchingRight) {\n        const distTop = Math.abs(playerBottom - tileTop);\n        const distBottom = Math.abs(tileBottom - playerTop);\n        const distLeft = Math.abs(playerRight - tileLeft);\n        const distRight = Math.abs(tileRight - playerLeft);\n        const min = Math.min(distTop, distBottom, distLeft, distRight);\n        touchingTop = (min === distTop);\n        touchingBottom = (!touchingTop && min === distBottom);\n        touchingLeft = (!touchingTop && !touchingBottom && min === distLeft);\n        touchingRight = (!touchingTop && !touchingBottom && !touchingLeft);\n      }\n\n      pushCandidate(idx, def, { top: touchingTop, bottom: touchingBottom, left: touchingLeft, right: touchingRight });\n    }\n  }\n\n  if (candidates.length === 0) {\n    hazardDamageAccumulatorRef.current = 0;\n    lastHazardIndexRef.current = null;\n    return;\n  }\n\n  // Choose deterministic candidate: prefer top > bottom > left > right\n  const sideScore = (t) => (t.top ? 4 : 0) + (t.bottom ? 3 : 0) + (t.left ? 2 : 0) + (t.right ? 1 : 0);\n  candidates.sort((a, b) => sideScore(b.touch) - sideScore(a.touch));\n  const chosen = candidates[0];\n  const index = chosen.index;\n  const objDef = chosen.def;\n  const touch = chosen.touch;\n\n  // Update active hazard index\n  const prevIndex = lastHazardIndexRef.current;\n  lastHazardIndexRef.current = index;\n\n  const damageOnce = !!objDef.damageOnce;\n  const baseDamage = objDef.damage ?? 0;\n  const dps = objDef.damagePerSecond ?? baseDamage;\n\n  if (damageOnce) {\n    if (!triggeredHazardsRef.current.has(index)) {\n      triggeredHazardsRef.current.add(index);\n      gameState.current.health = Math.max(0, gameState.current.health - baseDamage);\n      // Hit flash to trigger temporary target animation\n      const HIT_FLASH_MS = 500;\n      const prev = Number(gameState.current.hitTimerMs) || 0;\n      gameState.current.hitTimerMs = Math.max(prev, HIT_FLASH_MS);\n      if (touch.top) {\n        gameState.current.vy = -JUMP_FORCE * 0.4;\n      } else if (touch.left) {\n        gameState.current.vx = -MOVE_SPEED * 1.5;\n      } else if (touch.right) {\n        gameState.current.vx = MOVE_SPEED * 1.5;\n      }\n      return;\n    }\n  } else {\n    // Continuous DPS: reset accumulator if we switched tiles\n    const firstTouch = prevIndex !== index;\n    if (firstTouch) {\n      // Immediate damage on first contact, then start ticking\n      hazardDamageAccumulatorRef.current = 0;\n      const immediate = Number.isFinite(baseDamage) && baseDamage > 0 ? baseDamage : dps;\n      if (immediate > 0) {\n        gameState.current.health = Math.max(0, gameState.current.health - immediate);\n        // Hit flash on immediate hit\n        const HIT_FLASH_MS = 500;\n        const prev = Number(gameState.current.hitTimerMs) || 0;\n        gameState.current.hitTimerMs = Math.max(prev, HIT_FLASH_MS);\n      }\n      // Skip DPS accumulation this same frame to avoid double damage on long frames\n      return;\n    }\n\n    hazardDamageAccumulatorRef.current += deltaMs;\n    const TICK_MS = 1000;\n    while (hazardDamageAccumulatorRef.current >= TICK_MS) {\n      hazardDamageAccumulatorRef.current -= TICK_MS;\n      gameState.current.health = Math.max(0, gameState.current.health - dps);\n      // Refresh hit timer on each damage tick\n      const HIT_FLASH_MS = 500;\n      const prev = Number(gameState.current.hitTimerMs) || 0;\n      gameState.current.hitTimerMs = Math.max(prev, HIT_FLASH_MS);\n    }\n  }\n}\n\nexport default null;\n","// Projectile spawning extracted from useGameEngine.js\n\nexport function spawnProjectile(ctx, originX, originY, direction, ownerId = 'player') {\n  const { findItemById, TILE_SIZE, parseBool, projectilesRef, projectileIdRef, playShotSfx } = ctx;\n\n  const pDef = findItemById('fireball_basic');\n  const id = projectileIdRef.current++;\n  const w = Math.max(2, ((pDef?.width || 0.25) * TILE_SIZE));\n  const h = Math.max(2, ((pDef?.height || 0.25) * TILE_SIZE));\n  const speedPxPerSec = (pDef?.speed ? pDef.speed * 60 : 14 * 60);\n  const vx = (direction >= 0 ? 1 : -1) * speedPxPerSec;\n  const vy = 0;\n  const life = Math.max(200, pDef?.lifespan || 600);\n  const ricochetFlag = (typeof pDef?.ricochetOnTiles !== 'undefined')\n    ? !!pDef.ricochetOnTiles\n    : parseBool(pDef?.collisionWithPenetration, true);\n\n  const proj = {\n    id,\n    ownerId, // Tagad ms zinm, kur izva\n    x: originX,\n    y: originY,\n    vx,\n    vy,\n    w,\n    h,\n    life,\n    defId: pDef?.id || 'fireball_basic',\n    dir: direction >= 0 ? 1 : -1,\n    cwt: !!(pDef && pDef.collisionWithTiles),\n    hbs: Math.max(0.1, Math.min(1.0, (pDef?.hitboxScale ?? 1))),\n    ric: ricochetFlag,\n    dmg: pDef?.damage || 10\n  };\n  projectilesRef.current.push(proj);\n\n  try {\n    const vol = Math.max(0, Math.min(1, pDef?.sfxVolume ?? 1));\n    playShotSfx(pDef?.sfx, vol);\n  } catch {}\n}\n","// Item collection extracted from useGameEngine.js\n\n// Collects item under player's center if pickup-able.\n// Args (ctx): { registryItems, TILE_SIZE, MAX_HEALTH, playShotSfx, onStateUpdate, gameState }\n// Params: currentX, currentY, mapWidth, objectLayerData\nexport function collectItem(ctx, currentX, currentY, mapWidth, objectLayerData) {\n  const { registryItems, TILE_SIZE, MAX_HEALTH, playShotSfx, onStateUpdate, gameState } = ctx;\n  if (!objectLayerData) return;\n\n  const centerX = currentX + gameState.current.width / 2;\n  const centerY = currentY + gameState.current.height / 2;\n\n  const gridX = Math.floor(centerX / TILE_SIZE);\n  const gridY = Math.floor(centerY / TILE_SIZE);\n  const index = gridY * mapWidth + gridX;\n  if (index < 0 || index >= objectLayerData.length) return;\n\n  const itemId = objectLayerData[index];\n  if (!itemId) return;\n\n  const itemDef = registryItems.find(r => r.id === itemId);\n  if (!itemDef || !itemDef.pickup || itemId.includes('player')) return;\n\n  // Skip interactables - they are handled by checkInteractables()\n  if (itemDef.name && itemDef.name.startsWith('interactable.')) return;\n\n  // Health pickup\n  if (itemDef.effect && itemDef.effect.health) {\n    const healthBonus = parseInt(itemDef.effect.health, 10);\n    if (gameState.current.health >= MAX_HEALTH) return;\n    const newHealth = Math.min(gameState.current.health + healthBonus, MAX_HEALTH);\n    gameState.current.health = newHealth;\n    try {\n      const vol = Math.max(0, Math.min(1, itemDef?.sfxVolume ?? 1));\n      playShotSfx(itemDef?.sfx, vol);\n    } catch {}\n    if (onStateUpdate) onStateUpdate('collectItem', index);\n    return;\n  }\n\n  // Fireball ammo pickup\n  if (itemDef.effect && itemDef.effect.fireball) {\n    const ammoBonus = parseInt(itemDef.effect.fireball, 10) || 0;\n    gameState.current.ammo = Math.max(0, (gameState.current.ammo || 0) + ammoBonus);\n    try {\n      const vol = Math.max(0, Math.min(1, itemDef?.sfxVolume ?? 1));\n      playShotSfx(itemDef?.sfx, vol);\n    } catch {}\n    if (onStateUpdate) onStateUpdate('collectItem', index);\n    return;\n  }\n}\n","// Interactables logic - objects that can be used once and change state\n// Unlike items (which disappear), interactables stay but change texture\n\nexport function checkInteractables(ctx, currentX, currentY, mapWidth, objectLayerData) {\n  const { registryItems, TILE_SIZE, MAX_HEALTH, playShotSfx, onStateUpdate, gameState, mapData } = ctx;\n  if (!objectLayerData) return;\n\n  const centerX = currentX + gameState.current.width / 2;\n  const centerY = currentY + gameState.current.height / 2;\n\n  const gridX = Math.floor(centerX / TILE_SIZE);\n  const gridY = Math.floor(centerY / TILE_SIZE);\n  const index = gridY * mapWidth + gridX;\n  if (index < 0 || index >= objectLayerData.length) return;\n\n  const objId = objectLayerData[index];\n  if (!objId) return;\n\n  const objDef = registryItems.find(r => r.id === objId);\n  if (!objDef || !objDef.name || !objDef.name.startsWith('interactable.')) return;\n\n  // Check for Teleport logic\n  const metadata = mapData?.meta?.objectMetadata;\n  const currentMeta = metadata?.[index];\n  \n  if (objId.includes('portal') && currentMeta && currentMeta.triggerId !== undefined && currentMeta.triggerId !== null) {\n      // Find destination\n      for (let i = 0; i < objectLayerData.length; i++) {\n          if (i === index) continue;\n          const destId = objectLayerData[i];\n          if (destId && (destId.includes('target') || destId === 'portal_target')) {\n              const destMeta = metadata?.[i];\n              if (destMeta && destMeta.triggerId === currentMeta.triggerId) {\n                  // TELEPORT!\n                  const tx = (i % mapWidth) * TILE_SIZE;\n                  const ty = Math.floor(i / mapWidth) * TILE_SIZE;\n                  \n                  // Move player to target\n                  gameState.current.x = tx;\n                  gameState.current.y = ty;\n                  \n                  // Play sound\n                  try {\n                      const vol = Math.max(0, Math.min(1, objDef?.sfxVolume ?? 1));\n                      playShotSfx(objDef?.sfx || \"/assets/sound/sfx/teleport.ogg\", vol);\n                  } catch {}\n\n                  // For teleport we don't necessarily mark as used if we want multi-use\n                  // but if the user wants it to disappear/change state, we can.\n                  // For now, let's just teleport.\n                  return;\n              }\n          }\n      }\n  }\n\n  // Check for End Level logic\n  if (objDef.subtype === 'end' && !gameState.current.isWinning) {\n    gameState.current.isWinning = true;\n    gameState.current.winCounter = 0;\n    gameState.current.winCountSpeed = objDef.winCountSpeed || 10;\n    return;\n  }\n\n  // Check if already used (track used interactables in gameState)\n  if (!gameState.current.usedInteractables) {\n    gameState.current.usedInteractables = new Set();\n  }\n\n  if (gameState.current.usedInteractables.has(index)) return; // Already used\n\n  // Check if has effect\n  if (!objDef.effect) return;\n\n  // Health effect\n  if (objDef.effect.health) {\n    const healthBonus = parseInt(objDef.effect.health, 10);\n    if (gameState.current.health >= MAX_HEALTH) return; // Don't use if already full health\n\n    const newHealth = Math.min(gameState.current.health + healthBonus, MAX_HEALTH);\n    gameState.current.health = newHealth;\n\n    // Play sound\n    try {\n      const vol = Math.max(0, Math.min(1, objDef?.sfxVolume ?? 1));\n      playShotSfx(objDef?.sfx, vol);\n    } catch {}\n\n    // Mark as used\n    gameState.current.usedInteractables.add(index);\n\n    // Notify state update with 'interactable' event - this will switch to next texture\n    if (onStateUpdate) onStateUpdate('interactable', index);\n    return;\n  }\n\n  // Future: Add other interactable effects (ammo, etc.)\n  if (objDef.effect.fireball) {\n    const ammoBonus = parseInt(objDef.effect.fireball, 10) || 0;\n    gameState.current.ammo = Math.max(0, (gameState.current.ammo || 0) + ammoBonus);\n\n    try {\n      const vol = Math.max(0, Math.min(1, objDef?.sfxVolume ?? 1));\n      playShotSfx(objDef?.sfx, vol);\n    } catch {}\n\n    gameState.current.usedInteractables.add(index);\n    if (onStateUpdate) onStateUpdate('interactable', index);\n    return;\n  }\n}\n","// Projectile update and ricochet simulation extracted from useGameEngine.js\n\n// ctx: { projectilesRef, entitiesRef, playerState, TILE_SIZE, isSolidAtPixel, findItemById, objectData, objectMetadata, onStateUpdate }\n// updateProjectiles(ctx, deltaMs, mapWidth, mapHeight)\nexport function updateProjectiles(ctx, deltaMs, mapWidth, mapHeight) {\n  const { projectilesRef, entitiesRef, playerState, TILE_SIZE, isSolidAtPixel, findItemById, objectData, objectMetadata, onStateUpdate } = ctx;\n  const dtProj = deltaMs / 1000;\n  const worldW = mapWidth * TILE_SIZE;\n  const worldH = mapHeight * TILE_SIZE;\n\n  const isSolidRect = (cx, cy, hw, hh) => {\n    const pts = [\n      { x: cx - hw, y: cy - hh },\n      { x: cx + hw, y: cy - hh },\n      { x: cx - hw, y: cy + hh },\n      { x: cx + hw, y: cy + hh },\n    ];\n    for (let k = 0; k < pts.length; k++) {\n      const pt = pts[k];\n      // Updated isSolidAtPixel call with all necessary layers\n      if (isSolidAtPixel(pt.x, pt.y, mapWidth, mapHeight, TILE_SIZE, null, null, null, objectData, objectMetadata)) return true;\n    }\n    return false;\n  };\n\n  const checkObjectHit = (cx, cy, hw, hh) => {\n    if (!objectData) return null;\n    const pts = [\n        { x: cx - hw, y: cy - hh },\n        { x: cx + hw, y: cy - hh },\n        { x: cx - hw, y: cy + hh },\n        { x: cx + hw, y: cy + hh },\n        { x: cx, y: cy }\n    ];\n    for (const pt of pts) {\n        const gx = Math.floor(pt.x / TILE_SIZE);\n        const gy = Math.floor(pt.y / TILE_SIZE);\n        if (gx < 0 || gy < 0 || gx >= mapWidth || gy >= mapHeight) continue;\n        const index = gy * mapWidth + gx;\n        const objId = objectData[index];\n        if (objId) {\n            const def = findItemById(objId);\n            if (def && def.isDestructible) {\n                // Check if already passable\n                const currentMeta = objectMetadata?.[index] || {};\n                const health = currentMeta.health !== undefined ? currentMeta.health : def.maxHealth;\n                if (health > (def.passableHealthThreshold || 0)) {\n                    return index;\n                }\n            }\n        }\n    }\n    return null;\n  };\n\n  const checkEntityHit = (cx, cy, hw, hh, p) => {\n    if (!entitiesRef?.current) return null;\n    for (const ent of entitiesRef.current) {\n        if (ent.health <= 0 || ent.isExploding) continue;\n        if (ent.id === p.ownerId) continue; // Ignorjam izvju\n\n        const ex = ent.x;\n        const ey = ent.y;\n        const ew = ent.width;\n        const eh = ent.height;\n        if (cx + hw > ex && cx - hw < ex + ew &&\n            cy + hh > ey && cy - hh < ey + eh) {\n            return ent;\n        }\n    }\n    return null;\n  };\n\n  const checkPlayerHit = (cx, cy, hw, hh, p) => {\n    if (!playerState || p.ownerId === 'player') return false; // Ignorjam, ja izva spltjs\n    \n    const ex = playerState.x;\n    const ey = playerState.y;\n    const ew = playerState.width || TILE_SIZE;\n    const eh = playerState.height || TILE_SIZE;\n    if (cx + hw > ex && cx - hw < ex + ew &&\n        cy + hh > ey && cy - hh < ey + eh) {\n        return true;\n    }\n    return false;\n  };\n\n  if (!projectilesRef.current.length) return;\n\n  for (let i = projectilesRef.current.length - 1; i >= 0; i--) {\n    const p = projectilesRef.current[i];\n\n    if (p.bounces == null) p.bounces = 0;\n    const maxBounces = Number.isFinite(p.maxBounces)\n      ? p.maxBounces\n      : (findItemById(p.defId)?.maxBounces ?? 3);\n    const bounceDamp = Number.isFinite(p.bounceDamping)\n      ? p.bounceDamping\n      : (findItemById(p.defId)?.bounceDamping ?? 0.6);\n    const ricRand = Number.isFinite(p.ricochetRandom)\n      ? p.ricochetRandom\n      : (findItemById(p.defId)?.ricochetRandom ?? 0.15);\n\n    const maxDelta = Math.max(Math.abs(p.vx * dtProj), Math.abs(p.vy * dtProj));\n    let steps = Math.ceil(maxDelta / 4);\n    if (!Number.isFinite(steps) || steps < 1) steps = 1;\n    steps = Math.min(steps, 20);\n    const stepTime = dtProj / steps;\n\n    let cx = p.x;\n    let cy = p.y;\n    const hw = (p.w * (p.hbs || 1)) * 0.5;\n    const hh = (p.h * (p.hbs || 1)) * 0.5;\n\n    let removed = false;\n\n    for (let s = 0; s < steps; s++) {\n      // 1) X axis\n      let nextX = cx + p.vx * stepTime;\n      \n      const hitPlayerX = checkPlayerHit(nextX, cy, hw, hh, p);\n      if (hitPlayerX) {\n        if (playerState) {\n          playerState.health = Math.max(0, (Number(playerState.health) || 0) - (p.dmg || 10));\n        }\n        if (onStateUpdate) onStateUpdate('playerDamage', { damage: p.dmg || 10 });\n        removed = true;\n        break;\n      }\n\n      const hitEntX = checkEntityHit(nextX, cy, hw, hh, p);\n      if (hitEntX) {\n        hitEntX.health -= p.dmg || 10;\n        removed = true;\n        break;\n      }\n\n      const hitIdxX = checkObjectHit(nextX, cy, hw, hh);\n      if (hitIdxX !== null) {\n        if (onStateUpdate) onStateUpdate('objectDamage', { index: hitIdxX, damage: p.dmg || 10 });\n        removed = true;\n        break;\n      }\n\n      if (p.cwt && isSolidRect(nextX, cy, hw, hh)) {\n        if (p.ric) {\n          p.vx = -p.vx * bounceDamp;\n          const sp = Math.max(40, Math.hypot(p.vx, p.vy));\n          const jitter = (Math.random() * 2 - 1) * sp * ricRand;\n          p.vy += jitter * 0.15;\n          p.bounces += 1;\n          p.life = Math.max(0, p.life - 80);\n        } else {\n          removed = true;\n          break;\n        }\n      } else {\n        cx = nextX;\n      }\n\n      // 2) Y axis\n      let nextY = cy + p.vy * stepTime;\n      \n      const hitPlayerY = checkPlayerHit(cx, nextY, hw, hh, p);\n      if (hitPlayerY) {\n        if (playerState) {\n          playerState.health = Math.max(0, (Number(playerState.health) || 0) - (p.dmg || 10));\n        }\n        if (onStateUpdate) onStateUpdate('playerDamage', { damage: p.dmg || 10 });\n        removed = true;\n        break;\n      }\n\n      const hitEntY = checkEntityHit(cx, nextY, hw, hh, p);\n      if (hitEntY) {\n        hitEntY.health -= p.dmg || 10;\n        removed = true;\n        break;\n      }\n\n      const hitIdxY = checkObjectHit(cx, nextY, hw, hh);\n      if (hitIdxY !== null) {\n        if (onStateUpdate) onStateUpdate('objectDamage', { index: hitIdxY, damage: p.dmg || 10 });\n        removed = true;\n        break;\n      }\n\n      if (p.cwt && isSolidRect(cx, nextY, hw, hh)) {\n        if (p.ric) {\n          p.vy = -p.vy * bounceDamp;\n          const sp = Math.max(40, Math.hypot(p.vx, p.vy));\n          const jitter = (Math.random() * 2 - 1) * sp * ricRand;\n          p.vx += jitter * 0.15;\n          p.bounces += 1;\n          p.life = Math.max(0, p.life - 80);\n        } else {\n          removed = true;\n          break;\n        }\n      } else {\n        cy = nextY;\n      }\n\n      // 3) Corner stuck safeguard\n      if (p.cwt && isSolidRect(cx, cy, hw, hh)) {\n        if (p.ric) {\n          p.vx = -p.vx * bounceDamp;\n          p.vy = -p.vy * bounceDamp;\n          p.bounces += 1;\n          cx -= Math.sign(p.vx || 1) * 0.5;\n          cy -= Math.sign(p.vy || 1) * 0.5;\n        } else {\n          removed = true;\n          break;\n        }\n      }\n    }\n\n    p.x = cx;\n    p.y = cy;\n\n    p.life -= deltaMs;\n    if (\n      p.life <= 0 ||\n      p.x < -32 ||\n      p.y < -32 ||\n      p.x > worldW + 32 ||\n      p.y > worldH + 32 ||\n      removed ||\n      (p.bounces || 0) > (maxBounces || 0)\n    ) {\n      projectilesRef.current.splice(i, 1);\n      continue;\n    }\n  }\n}\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport styled from 'styled-components';\n\nconst HeaderContainer = styled.div`\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 110px;\n    background-color: rgba(0, 0, 0, 0.3);\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 0 20px;\n    box-sizing: border-box;\n    z-index: 1000;\n    pointer-events: none;\n`;\n\nconst AmmoDisplay = styled.div`\n    font-size: 28px;\n    font-weight: bold;\n    color: rgba(255, 200, 50, 0.95);\n    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);\n    font-family: monospace;\n    pointer-events: none;\n`;\n\nconst RightSection = styled.div`\n    display: flex;\n    flex-direction: column;\n    align-items: flex-end;\n    gap: 8px;\n`;\n\nconst BarsContainer = styled.div`\n    display: flex;\n    flex-direction: column;\n    gap: 4px;\n    width: 200px;\n`;\n\nconst BarWrapper = styled.div`\n    width: 100%;\n    height: 8px;\n    background-color: rgba(0, 0, 0, 0.5);\n    border: 1px solid rgba(255, 255, 255, 0.4);\n    position: relative;\n    box-shadow: inset 0 0 0 1px rgba(0,0,0,0.3);\n`;\n\nconst BarFill = styled.div`\n    height: 100%;\n    width: ${props => props.$percent}%;\n    background-color: ${props => props.$color};\n    transition: width 0.3s ease;\n`;\n\nconst BarLabel = styled.div`\n    position: absolute;\n    top: -12px;\n    left: 0;\n    font-size: 9px;\n    color: white;\n    font-weight: bold;\n    text-shadow: 1px 1px 2px black;\n    pointer-events: none;\n    white-space: nowrap;\n    text-transform: uppercase;\n`;\n\nconst GameHeader = ({ \n    health, \n    maxHealth = 100, \n    ammo = 0, \n    oxygen = 100, \n    maxOxygen = 100, \n    lavaResist = 100, \n    maxLavaResist = 100,\n    iceResist = 100,\n    maxIceResist = 100,\n    inWater = false,\n    liquidType = null,\n    onIce = false\n}) => {\n    const hpPercent = Math.max(0, Math.min(100, (health / maxHealth) * 100));\n    const oxyPercent = Math.max(0, Math.min(100, (oxygen / maxOxygen) * 100));\n    const lavaPercent = Math.max(0, Math.min(100, (lavaResist / maxLavaResist) * 100));\n    const icePercent = Math.max(0, Math.min(100, (iceResist / maxIceResist) * 100));\n\n    const showOxy = inWater || liquidType === 'water' || oxyPercent < 100;\n    const showLava = liquidType === 'lava' || lavaPercent < 100;\n    const showIce = onIce || icePercent < 100;\n\n    return (\n        <HeaderContainer>\n            <AmmoDisplay>\n                 {ammo || 0}\n            </AmmoDisplay>\n\n            <RightSection>\n                <BarsContainer style={{ gap: '12px' }}>\n                    {/* HP Bar */}\n                    <BarWrapper>\n                        <BarLabel>HP: {Math.round(health)}%</BarLabel>\n                        <BarFill $percent={hpPercent} $color=\"#ff3232\" />\n                    </BarWrapper>\n\n                    {/* Oxygen Bar */}\n                    <BarWrapper>\n                        <BarLabel>O2: {Math.round(oxyPercent)}%</BarLabel>\n                        <BarFill $percent={oxyPercent} $color=\"#2ecdf1\" />\n                    </BarWrapper>\n\n                    {/* Lava Bar */}\n                    <BarWrapper>\n                        <BarLabel>LAVA: {Math.round(lavaPercent)}%</BarLabel>\n                        <BarFill $percent={lavaPercent} $color=\"#ffa229\" />\n                    </BarWrapper>\n\n                    {/* Ice Bar */}\n                    <BarWrapper>\n                        <BarLabel>ICE: {Math.round(icePercent)}%</BarLabel>\n                        <BarFill $percent={icePercent} $color=\"#a5f3fc\" />\n                    </BarWrapper>\n                </BarsContainer>\n            </RightSection>\n        </HeaderContainer>\n    );\n};\n\nGameHeader.propTypes = {\n    health: PropTypes.number.isRequired,\n    maxHealth: PropTypes.number,\n    ammo: PropTypes.number,\n    oxygen: PropTypes.number,\n    maxOxygen: PropTypes.number,\n    lavaResist: PropTypes.number,\n    maxLavaResist: PropTypes.number,\n    iceResist: PropTypes.number,\n    maxIceResist: PropTypes.number,\n    inWater: PropTypes.bool,\n    liquidType: PropTypes.string,\n    onIce: PropTypes.bool\n};\n\nexport default GameHeader;","// Simple command registry for in-game terminal\n// Each command: { name, description, handler(input, ctx) => string | void }\n\nconst commands = [];\n\nconst register = (cmd) => {\n  if (!cmd || !cmd.name) return;\n  commands.push(cmd);\n};\n\nexport const listCommands = () => commands.map(c => ({ name: c.name, description: c.description }));\n\nexport const executeCommand = (input, context = {}) => {\n  const raw = String(input || '').trim();\n  if (!raw) return '';\n  const [name, ...args] = raw.split(/\\s+/);\n  const cmd = commands.find(c => c.name.toLowerCase() === name.toLowerCase());\n  if (!cmd) {\n    return `Unknown command: ${name}. Type 'help' to list commands.`;\n  }\n  try {\n    const res = cmd.handler({ args, raw, context });\n    return typeof res === 'string' ? res : '';\n  } catch (e) {\n    return `Error executing '${name}': ${e?.message || e}`;\n  }\n};\n\n// Built-in: help\nregister({\n  name: 'help',\n  description: 'Show available commands',\n  handler() {\n    const list = listCommands()\n      .map(c => `- ${c.name}${c.description ? `: ${c.description}` : ''}`)\n      .join('\\n');\n    return list || 'No commands available.';\n  }\n});\n\n// Built-in: clear\nregister({\n  name: 'clear',\n  description: 'Clear terminal output',\n  handler() {\n    // Signal to UI to clear output; UI can interpret special token\n    try { window.dispatchEvent(new CustomEvent('game-terminal-clear')); } catch {}\n    return '';\n  }\n});\n\n// First requested command: settings\nregister({\n  name: 'settings',\n  description: \"Open the draggable game settings window\",\n  handler() {\n    try { \n      window.dispatchEvent(new CustomEvent('game-open-settings'));\n      // Also close terminal automatically when opening settings\n      window.dispatchEvent(new CustomEvent('game-close-terminal'));\n    } catch {}\n    return 'Opening settings...';\n  }\n});\n\nexport default {\n  register,\n  listCommands,\n  executeCommand,\n};\n","import React, { useEffect, useRef, useState } from 'react';\nimport { executeCommand } from '../../../commands/gameCommands';\n\nconst panelStyleBase = {\n  position: 'fixed',\n  left: 0,\n  right: 0,\n  bottom: 0,\n  height: '220px',\n  backgroundColor: 'rgba(10, 10, 10, 0.95)',\n  color: '#d6d6d6',\n  fontFamily: 'ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, \"Liberation Mono\", \"Courier New\", monospace',\n  fontSize: '12px',\n  borderTop: '1px solid #333',\n  boxShadow: '0 -6px 16px rgba(0,0,0,0.5)',\n  display: 'flex',\n  flexDirection: 'column',\n  zIndex: 3000,\n  transition: 'transform 160ms ease',\n};\n\nexport default function GameTerminal() {\n  const [open, setOpen] = useState(false);\n  const [lines, setLines] = useState([\"Type 'help' to list commands. Press ESC to close.\"]);\n  const [input, setInput] = useState('');\n  const scrollRef = useRef(null);\n  const inputRef = useRef(null);\n  const suppressUntilRef = useRef(0);\n  const suppressActiveRef = useRef(false);\n\n  // Toggle handler from global events\n  useEffect(() => {\n    const onToggle = () => setOpen(prev => !prev);\n    const onClear = () => setLines([]);\n    const onClose = () => setOpen(false);\n    window.addEventListener('game-toggle-terminal', onToggle);\n    window.addEventListener('game-terminal-clear', onClear);\n    window.addEventListener('game-close-terminal', onClose);\n    return () => {\n      window.removeEventListener('game-toggle-terminal', onToggle);\n      window.removeEventListener('game-terminal-clear', onClear);\n      window.removeEventListener('game-close-terminal', onClose);\n    };\n  }, []);\n\n  // Track open state globally so input hook can disable movement\n  useEffect(() => {\n    try { window.__GAME_TERMINAL_OPEN__ = open; } catch {}\n    if (open) {\n      // Clear any previous text and suppress initial keystrokes that were held during gameplay\n      setInput('');\n      try { suppressUntilRef.current = (typeof performance !== 'undefined' ? performance.now() : Date.now()) + 220; } catch { suppressUntilRef.current = Date.now() + 220; }\n      setTimeout(() => inputRef.current && inputRef.current.focus(), 0);\n    }\n  }, [open]);\n\n  // Close with ESC when focused\n  useEffect(() => {\n    const onKey = (e) => {\n      if (!open) return;\n      if (e.key === 'Escape') {\n        setOpen(false);\n      }\n    };\n    window.addEventListener('keydown', onKey);\n    return () => window.removeEventListener('keydown', onKey);\n  }, [open]);\n\n  // Auto-scroll to bottom when lines change\n  useEffect(() => {\n    if (!scrollRef.current) return;\n    scrollRef.current.scrollTop = scrollRef.current.scrollHeight;\n  }, [lines, open]);\n\n  const onSubmit = (e) => {\n    e.preventDefault();\n    const value = input.trim();\n    if (!value) return;\n    setLines(prev => [...prev, `> ${value}`]);\n    const res = executeCommand(value, {});\n    if (res) setLines(prev => [...prev, res]);\n    setInput('');\n  };\n\n  const style = {\n    ...panelStyleBase,\n    transform: open ? 'translateY(0)' : 'translateY(100%)',\n  };\n\n  return (\n    <div style={style} aria-hidden={!open}>\n      <div style={{ padding: '6px 8px', borderBottom: '1px solid #333', color: '#9cdcfe' }}>\n        In-Game Terminal  press T to toggle\n      </div>\n      <div ref={scrollRef} style={{ flex: 1, overflowY: 'auto', padding: '8px 10px', whiteSpace: 'pre-wrap', lineHeight: 1.4 }}>\n        {lines.map((l, i) => (\n          <div key={i} style={{ color: l.startsWith('>') ? '#dcdcaa' : '#d6d6d6' }}>{l}</div>\n        ))}\n      </div>\n      <form onSubmit={onSubmit} style={{ display: 'flex', gap: '6px', padding: '8px', borderTop: '1px solid #333' }}>\n        <span style={{ color: '#6a9955' }}>$</span>\n        <input\n          ref={inputRef}\n          value={input}\n          onKeyDown={(e) => {\n            const now = (typeof performance !== 'undefined' ? performance.now() : Date.now());\n            if (now < (suppressUntilRef.current || 0) && e.key !== 'Escape') {\n              if (typeof e.preventDefault === 'function') e.preventDefault();\n              if (typeof e.stopPropagation === 'function') e.stopPropagation();\n              return;\n            }\n          }}\n          onChange={(e) => setInput(e.target.value)}\n          placeholder=\"Enter command...\"\n          style={{ flex: 1, background: '#111', color: '#fff', border: '1px solid #333', padding: '6px 8px', borderRadius: '3px', outline: 'none' }}\n        />\n        <button type=\"submit\" style={{ background: '#0e639c', color: '#fff', border: '1px solid #0b5c8a', padding: '6px 10px', borderRadius: '3px', cursor: 'pointer' }}>\n          Run\n        </button>\n      </form>\n    </div>\n  );\n}\n","import React, { useEffect, useRef, useState } from 'react';\n\n// Simple draggable, minimizable settings window.\n// Opens when the custom event 'game-open-settings' is dispatched (from terminal command `settings`).\n// Renders above the game canvas but below the in-game terminal.\nexport default function GameSettings() {\n  // Runtime-linked settings (live updates)\n  const [activeTab, setActiveTab] = useState(() => {\n    try {\n      return localStorage.getItem('game_settings_tab') || 'Audio';\n    } catch {}\n    return 'Audio';\n  });\n  const [parallax, setParallax] = useState(() => {\n    try {\n      const g = window.__GAME_RUNTIME_SETTINGS__;\n      if (g && typeof g.backgroundParallaxFactor === 'number') return g.backgroundParallaxFactor;\n    } catch {}\n    return 0.3;\n  });\n  const [rain, setRain] = useState(() => {\n    try {\n      const ls = localStorage.getItem('game_weather_rain');\n      if (ls !== null) return Math.max(0, Math.min(100, parseInt(ls, 10) || 0));\n      const g = window.__GAME_RUNTIME_SETTINGS__;\n      if (g && typeof g.weatherRain === 'number') return Math.max(0, Math.min(100, g.weatherRain));\n    } catch {}\n    return 0;\n  });\n  const [snow, setSnow] = useState(() => {\n    try {\n      const ls = localStorage.getItem('game_weather_snow');\n      if (ls !== null) return Math.max(0, Math.min(100, parseInt(ls, 10) || 0));\n      const g = window.__GAME_RUNTIME_SETTINGS__;\n      if (g && typeof g.weatherSnow === 'number') return Math.max(0, Math.min(100, g.weatherSnow));\n    } catch {}\n    return 0;\n  });\n  const [clouds, setClouds] = useState(() => {\n    try {\n      // New key first\n      const lsNew = localStorage.getItem('game_weather_clouds');\n      if (lsNew !== null) return Math.max(0, Math.min(100, parseInt(lsNew, 10) || 0));\n      // Backward compatibility: read old fog key if exists\n      const lsOld = localStorage.getItem('game_weather_fog');\n      if (lsOld !== null) return Math.max(0, Math.min(100, parseInt(lsOld, 10) || 0));\n      const g = window.__GAME_RUNTIME_SETTINGS__;\n      // Prefer clouds but also accept legacy fog\n      if (g && typeof g.weatherClouds === 'number') return Math.max(0, Math.min(100, g.weatherClouds));\n      if (g && typeof g.weatherFog === 'number') return Math.max(0, Math.min(100, g.weatherFog));\n    } catch {}\n    return 0;\n  });\n  // New: Thunder (Lightning) intensity 0..100\n  const [thunder, setThunder] = useState(() => {\n    try {\n      const ls = localStorage.getItem('game_weather_thunder');\n      if (ls !== null) return Math.max(0, Math.min(100, parseInt(ls, 10) || 0));\n      const g = window.__GAME_RUNTIME_SETTINGS__;\n      if (g && typeof g.weatherThunder === 'number') return Math.max(0, Math.min(100, g.weatherThunder));\n    } catch {}\n    return 0;\n  });\n  // New: dedicated Fog density (0..100)\n  const [fog, setFog] = useState(() => {\n    try {\n      const ls = localStorage.getItem('game_weather_fog');\n      if (ls !== null) return Math.max(0, Math.min(100, parseInt(ls, 10) || 0));\n      const g = window.__GAME_RUNTIME_SETTINGS__;\n      if (g && typeof g.weatherFog === 'number') return Math.max(0, Math.min(100, g.weatherFog));\n    } catch {}\n    return 0;\n  });\n  // UI: Health bar visibility\n  const [healthBarEnabled, setHealthBarEnabled] = useState(() => {\n    try {\n      const ls = localStorage.getItem('game_ui_healthbar');\n      if (ls !== null) return ls !== '0';\n      const g = window.__GAME_RUNTIME_SETTINGS__;\n      if (g && typeof g.healthBarEnabled === 'boolean') return g.healthBarEnabled;\n    } catch {}\n    return true;\n  });\n  // UI: Oxygen/Lava bars visibility\n  const [oxygenBarEnabled, setOxygenBarEnabled] = useState(() => {\n    try {\n      const ls = localStorage.getItem('game_ui_oxygenbar');\n      if (ls !== null) return ls !== '0';\n      const g = window.__GAME_RUNTIME_SETTINGS__;\n      if (g && typeof g.oxygenBarEnabled === 'boolean') return g.oxygenBarEnabled;\n    } catch {}\n    return true;\n  });\n  const [lavaBarEnabled, setLavaBarEnabled] = useState(() => {\n    try {\n      const ls = localStorage.getItem('game_ui_lavabar');\n      if (ls !== null) return ls !== '0';\n      const g = window.__GAME_RUNTIME_SETTINGS__;\n      if (g && typeof g.lavaBarEnabled === 'boolean') return g.lavaBarEnabled;\n    } catch {}\n    return true;\n  });\n  // FX toggles\n  const [waterSplashesEnabled, setWaterSplashesEnabled] = useState(() => {\n    try {\n      const ls = localStorage.getItem('game_fx_water_splashes');\n      if (ls !== null) return ls !== '0';\n      const g = window.__GAME_RUNTIME_SETTINGS__;\n      if (g && typeof g.waterSplashesEnabled === 'boolean') return g.waterSplashesEnabled;\n    } catch {}\n    return true;\n  });\n  const [lavaEmbersEnabled, setLavaEmbersEnabled] = useState(() => {\n    try {\n      const ls = localStorage.getItem('game_fx_lava_embers');\n      if (ls !== null) return ls !== '0';\n      const g = window.__GAME_RUNTIME_SETTINGS__;\n      if (g && typeof g.lavaEmbersEnabled === 'boolean') return g.lavaEmbersEnabled;\n    } catch {}\n    return true;\n  });\n  const [open, setOpen] = useState(false);\n  const [minimized, setMinimized] = useState(false);\n  const [pos, setPos] = useState(() => {\n    // Restore last position from localStorage if available\n    try {\n      const raw = localStorage.getItem('game_settings_pos');\n      if (raw) return JSON.parse(raw);\n    } catch {}\n    return { left: 12, top: 64 };\n  });\n\n  const [size, setSize] = useState(() => {\n    try {\n      const raw = localStorage.getItem('game_settings_size');\n      if (raw) return JSON.parse(raw);\n    } catch {}\n    return { width: 300, height: 220 };\n  });\n\n  const draggingRef = useRef({ active: false, offsetX: 0, offsetY: 0 });\n\n  // Helper: clamp position so the window stays within viewport (with small margin)\n  const clampPos = (p, sz, isMin) => {\n    const margin = 12;\n    const vw = (typeof window !== 'undefined' ? window.innerWidth : 0) || 0;\n    const vh = (typeof window !== 'undefined' ? window.innerHeight : 0) || 0;\n    const maxL = Math.max(0, vw - (sz?.width || 300) - margin);\n    const maxT = Math.max(0, vh - (isMin ? 36 : (sz?.height || 220)) - margin);\n    let left = Number(p?.left);\n    let top = Number(p?.top);\n    if (!Number.isFinite(left)) left = margin;\n    if (!Number.isFinite(top)) top = margin;\n    left = Math.max(0, Math.min(maxL, left));\n    top = Math.max(0, Math.min(maxT, top));\n    return { left, top };\n  };\n\n  // Restore minimized state\n  useEffect(() => {\n    try {\n      const raw = localStorage.getItem('game_settings_min');\n      if (raw) setMinimized(raw === '1');\n    } catch {}\n  }, []);\n\n  // Open handler from global event\n  useEffect(() => {\n    const onOpen = () => {\n      // Ensure the window will be visible even if saved pos was off-screen\n      setPos((p) => clampPos(p, size, false));\n      setOpen(true);\n      setMinimized(false);\n      // Sync current values from global when opening\n      try {\n        const g = window.__GAME_RUNTIME_SETTINGS__ || {};\n        if (typeof g.backgroundParallaxFactor === 'number') {\n          setParallax(g.backgroundParallaxFactor);\n        }\n        if (typeof g.weatherRain === 'number') setRain(Math.max(0, Math.min(100, g.weatherRain)));\n        if (typeof g.weatherSnow === 'number') setSnow(Math.max(0, Math.min(100, g.weatherSnow)));\n        if (typeof g.weatherClouds === 'number') setClouds(Math.max(0, Math.min(100, g.weatherClouds)));\n        if (typeof g.weatherFog === 'number') setFog(Math.max(0, Math.min(100, g.weatherFog)));\n        if (typeof g.weatherThunder === 'number') setThunder(Math.max(0, Math.min(100, g.weatherThunder)));\n        if (typeof g.healthBarEnabled === 'boolean') setHealthBarEnabled(!!g.healthBarEnabled);\n        if (typeof g.oxygenBarEnabled === 'boolean') setOxygenBarEnabled(!!g.oxygenBarEnabled);\n        if (typeof g.lavaBarEnabled === 'boolean') setLavaBarEnabled(!!g.lavaBarEnabled);\n        if (typeof g.waterSplashesEnabled === 'boolean') setWaterSplashesEnabled(!!g.waterSplashesEnabled);\n        if (typeof g.lavaEmbersEnabled === 'boolean') setLavaEmbersEnabled(!!g.lavaEmbersEnabled);\n      } catch {}\n      // Auto-close the in-game terminal when settings opens\n      try { window.dispatchEvent(new CustomEvent('game-close-terminal')); } catch {}\n    };\n    window.addEventListener('game-open-settings', onOpen);\n    return () => window.removeEventListener('game-open-settings', onOpen);\n  }, []);\n\n  // Persist position and size/minimized\n  useEffect(() => {\n    try { localStorage.setItem('game_settings_pos', JSON.stringify(pos)); } catch {}\n  }, [pos]);\n  useEffect(() => {\n    try { localStorage.setItem('game_settings_size', JSON.stringify(size)); } catch {}\n  }, [size]);\n  useEffect(() => {\n    try { localStorage.setItem('game_settings_min', minimized ? '1' : '0'); } catch {}\n  }, [minimized]);\n  useEffect(() => {\n    try { localStorage.setItem('game_settings_tab', String(activeTab)); } catch {}\n  }, [activeTab]);\n\n  // Drag logic\n  useEffect(() => {\n    const onMove = (e) => {\n      if (!draggingRef.current.active) return;\n      e.preventDefault();\n      const nx = e.clientX - draggingRef.current.offsetX;\n      const ny = e.clientY - draggingRef.current.offsetY;\n      const maxL = Math.max(0, (window.innerWidth || 0) - size.width - 6);\n      const maxT = Math.max(0, (window.innerHeight || 0) - (minimized ? 36 : size.height) - 6);\n      setPos({\n        left: Math.max(0, Math.min(maxL, nx)),\n        top: Math.max(0, Math.min(maxT, ny)),\n      });\n    };\n    const onUp = () => { draggingRef.current.active = false; };\n    window.addEventListener('mousemove', onMove);\n    window.addEventListener('mouseup', onUp);\n    return () => {\n      window.removeEventListener('mousemove', onMove);\n      window.removeEventListener('mouseup', onUp);\n    };\n  }, [size.width, size.height, minimized]);\n\n  // Re-clamp into viewport when window resizes while settings are open\n  useEffect(() => {\n    if (!open) return;\n    const onResize = () => setPos((p) => clampPos(p, size, minimized));\n    window.addEventListener('resize', onResize);\n    // Run once immediately to correct if needed\n    onResize();\n    return () => window.removeEventListener('resize', onResize);\n  }, [open, size.width, size.height, minimized]);\n\n  const onHeaderMouseDown = (e) => {\n    draggingRef.current.active = true;\n    draggingRef.current.offsetX = e.clientX - pos.left;\n    draggingRef.current.offsetY = e.clientY - pos.top;\n  };\n\n  const onClose = () => setOpen(false);\n  const onMinToggle = () => setMinimized((m) => !m);\n\n  const emitUpdate = (patch) => {\n    try {\n      window.dispatchEvent(new CustomEvent('game-settings-update', { detail: patch }));\n      // Mirror into a global bag for components that want to read without listeners\n      window.__GAME_RUNTIME_SETTINGS__ = {\n        ...(window.__GAME_RUNTIME_SETTINGS__ || {}),\n        ...patch,\n      };\n    } catch {}\n  };\n\n  const onResizeMouseDown = (e) => {\n    // Simple bottom-right resize drag\n    e.preventDefault();\n    const startX = e.clientX;\n    const startY = e.clientY;\n    const startW = size.width;\n    const startH = size.height;\n\n    const move = (ev) => {\n      const dw = ev.clientX - startX;\n      const dh = ev.clientY - startY;\n      const nw = Math.max(220, startW + dw);\n      const nh = Math.max(140, startH + dh);\n      setSize({ width: nw, height: nh });\n    };\n    const up = () => {\n      window.removeEventListener('mousemove', move);\n      window.removeEventListener('mouseup', up);\n    };\n    window.addEventListener('mousemove', move);\n    window.addEventListener('mouseup', up);\n  };\n\n  if (!open) return null;\n\n  const panelStyle = {\n    position: 'fixed',\n    left: pos.left,\n    top: pos.top,\n    width: size.width,\n    height: minimized ? 36 : size.height,\n    background: 'rgba(20,20,20,0.96)',\n    color: '#eaeaea',\n    border: '1px solid #2a2a2a',\n    borderRadius: 6,\n    boxShadow: '0 8px 24px rgba(0,0,0,0.6)',\n    zIndex: 2600, // below terminal (3000), above canvas/HUD\n    display: 'flex',\n    flexDirection: 'column',\n    userSelect: draggingRef.current.active ? 'none' : 'auto',\n    overflow: 'hidden',\n  };\n\n  const headerStyle = {\n    cursor: 'move',\n    background: 'linear-gradient(180deg, #2a2a2a, #1c1c1c)',\n    padding: '6px 8px',\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    borderBottom: '1px solid #333',\n    fontSize: 12,\n  };\n\n  const contentStyle = {\n    flex: 1,\n    display: minimized ? 'none' : 'block',\n    padding: 10,\n    overflow: 'auto',\n    background: 'rgba(10,10,10,0.4)'\n  };\n\n  const buttonStyle = {\n    background: '#0e639c',\n    color: '#fff',\n    border: '1px solid #0b5c8a',\n    padding: '4px 8px',\n    borderRadius: 4,\n    fontSize: 11,\n    cursor: 'pointer',\n    marginLeft: 6,\n  };\n\n  const tabsBarStyle = {\n    display: minimized ? 'none' : 'flex',\n    alignItems: 'center',\n    gap: 6,\n    padding: '6px 8px',\n    borderBottom: '1px solid #2a2a2a',\n    background: 'rgba(0,0,0,0.25)',\n    whiteSpace: 'nowrap',\n    overflowX: 'auto'\n  };\n  const tabBtnStyle = (tab) => ({\n    background: activeTab === tab ? '#1e1e1e' : 'transparent',\n    color: activeTab === tab ? '#9cdcfe' : '#ddd',\n    border: activeTab === tab ? '1px solid #3a3a3a' : '1px solid transparent',\n    padding: '4px 10px',\n    borderRadius: 4,\n    fontSize: 12,\n    cursor: 'pointer',\n  });\n\n  const renderAudio = () => (\n    <section style={{ marginBottom: 10 }}>\n      <div style={{ fontSize: 12, marginBottom: 6, color: '#d6d6d6' }}>Audio</div>\n      <div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>\n        <label style={{ fontSize: 12, width: 120 }}>Master Volume</label>\n        <input type=\"range\" min=\"0\" max=\"1\" step=\"0.01\" defaultValue={0.7} />\n      </div>\n    </section>\n  );\n\n  const renderGraphics = () => (\n    <>\n      <section style={{ marginBottom: 10 }}>\n        <div style={{ fontSize: 12, marginBottom: 6, color: '#d6d6d6' }}>Graphics</div>\n        <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginBottom: 6 }}>\n          <label style={{ fontSize: 12, width: 120 }}>Parallax Factor</label>\n          <input\n            type=\"range\"\n            min=\"0\"\n            max=\"1\"\n            step=\"0.05\"\n            value={Number.isFinite(parallax) ? parallax : 0.3}\n            onChange={(e) => {\n              const v = parseFloat(e.target.value);\n              setParallax(v);\n              emitUpdate({ backgroundParallaxFactor: v });\n            }}\n          />\n          <span style={{ fontSize: 12, width: 40, textAlign: 'right' }}>{(Number.isFinite(parallax) ? parallax : 0.3).toFixed(2)}</span>\n        </div>\n        <div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>\n          <label style={{ fontSize: 12, width: 120 }}>VSync</label>\n          <input type=\"checkbox\" defaultChecked />\n        </div>\n      </section>\n      {/* Keep existing Gameplay controls inside Graphics tab for now */}\n      <section>\n        <div style={{ fontSize: 12, marginBottom: 6, color: '#d6d6d6' }}>Gameplay</div>\n        <div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>\n          <label style={{ fontSize: 12, width: 120 }}>Invert Jump (W)</label>\n          <input type=\"checkbox\" />\n        </div>\n        <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginTop: 6 }}>\n          <label style={{ fontSize: 12, width: 120 }}>Show Health Bar</label>\n          <input\n            type=\"checkbox\"\n            checked={!!healthBarEnabled}\n            onChange={(e) => {\n              const v = !!e.target.checked;\n              setHealthBarEnabled(v);\n              try { localStorage.setItem('game_ui_healthbar', v ? '1' : '0'); } catch {}\n              emitUpdate({ healthBarEnabled: v });\n            }}\n          />\n        </div>\n        <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginTop: 6 }}>\n          <label style={{ fontSize: 12, width: 120 }}>Show Oxygen Bar</label>\n          <input\n            type=\"checkbox\"\n            checked={!!oxygenBarEnabled}\n            onChange={(e) => {\n              const v = !!e.target.checked;\n              setOxygenBarEnabled(v);\n              try { localStorage.setItem('game_ui_oxygenbar', v ? '1' : '0'); } catch {}\n              emitUpdate({ oxygenBarEnabled: v });\n            }}\n          />\n        </div>\n        <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginTop: 6 }}>\n          <label style={{ fontSize: 12, width: 120 }}>Show Lava Bar</label>\n          <input\n            type=\"checkbox\"\n            checked={!!lavaBarEnabled}\n            onChange={(e) => {\n              const v = !!e.target.checked;\n              setLavaBarEnabled(v);\n              try { localStorage.setItem('game_ui_lavabar', v ? '1' : '0'); } catch {}\n              emitUpdate({ lavaBarEnabled: v });\n            }}\n          />\n        </div>\n        <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginTop: 6 }}>\n          <label style={{ fontSize: 12, width: 120 }}>Water Splashes</label>\n          <input\n            type=\"checkbox\"\n            checked={!!waterSplashesEnabled}\n            onChange={(e) => {\n              const v = !!e.target.checked;\n              setWaterSplashesEnabled(v);\n              try { localStorage.setItem('game_fx_water_splashes', v ? '1' : '0'); } catch {}\n              emitUpdate({ waterSplashesEnabled: v });\n            }}\n          />\n        </div>\n        <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginTop: 6 }}>\n          <label style={{ fontSize: 12, width: 120 }}>Lava Embers</label>\n          <input\n            type=\"checkbox\"\n            checked={!!lavaEmbersEnabled}\n            onChange={(e) => {\n              const v = !!e.target.checked;\n              setLavaEmbersEnabled(v);\n              try { localStorage.setItem('game_fx_lava_embers', v ? '1' : '0'); } catch {}\n              emitUpdate({ lavaEmbersEnabled: v });\n            }}\n          />\n        </div>\n      </section>\n    </>\n  );\n\n  const renderWeather = () => (\n    <section style={{ marginBottom: 10 }}>\n      <div style={{ fontSize: 12, marginBottom: 6, color: '#d6d6d6' }}>Weather</div>\n      <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginBottom: 6 }}>\n        <label style={{ fontSize: 12, width: 120 }}>Lietus (Rain)</label>\n        <input\n          type=\"range\"\n          min=\"0\"\n          max=\"100\"\n          step=\"1\"\n          value={Number.isFinite(rain) ? rain : 0}\n          onChange={(e) => {\n            const v = Math.max(0, Math.min(100, parseInt(e.target.value, 10) || 0));\n            setRain(v);\n            try { localStorage.setItem('game_weather_rain', String(v)); } catch {}\n            emitUpdate({ weatherRain: v });\n          }}\n        />\n        <span style={{ fontSize: 12, width: 34, textAlign: 'right' }}>{Number.isFinite(rain) ? rain : 0}</span>\n      </div>\n      <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginBottom: 6 }}>\n        <label style={{ fontSize: 12, width: 120 }}>Sniegs (Snow)</label>\n        <input\n          type=\"range\"\n          min=\"0\"\n          max=\"100\"\n          step=\"1\"\n          value={Number.isFinite(snow) ? snow : 0}\n          onChange={(e) => {\n            const v = Math.max(0, Math.min(100, parseInt(e.target.value, 10) || 0));\n            setSnow(v);\n            try { localStorage.setItem('game_weather_snow', String(v)); } catch {}\n            emitUpdate({ weatherSnow: v });\n          }}\n        />\n        <span style={{ fontSize: 12, width: 34, textAlign: 'right' }}>{Number.isFinite(snow) ? snow : 0}</span>\n      </div>\n      <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginBottom: 6 }}>\n        <label style={{ fontSize: 12, width: 120 }}>Migla (Fog)</label>\n        <input\n          type=\"range\"\n          min=\"0\"\n          max=\"100\"\n          step=\"1\"\n          value={Number.isFinite(fog) ? fog : 0}\n          onChange={(e) => {\n            const v = Math.max(0, Math.min(100, parseInt(e.target.value, 10) || 0));\n            setFog(v);\n            try { localStorage.setItem('game_weather_fog', String(v)); } catch {}\n            emitUpdate({ weatherFog: v });\n          }}\n        />\n        <span style={{ fontSize: 12, width: 34, textAlign: 'right' }}>{Number.isFinite(fog) ? fog : 0}</span>\n      </div>\n      <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginBottom: 6 }}>\n        <label style={{ fontSize: 12, width: 120 }}>Zibens (Thunder)</label>\n        <input\n          type=\"range\"\n          min=\"0\"\n          max=\"100\"\n          step=\"1\"\n          value={Number.isFinite(thunder) ? thunder : 0}\n          onChange={(e) => {\n            const v = Math.max(0, Math.min(100, parseInt(e.target.value, 10) || 0));\n            setThunder(v);\n            try { localStorage.setItem('game_weather_thunder', String(v)); } catch {}\n            emitUpdate({ weatherThunder: v });\n          }}\n        />\n        <span style={{ fontSize: 12, width: 34, textAlign: 'right' }}>{Number.isFinite(thunder) ? thunder : 0}</span>\n      </div>\n      <div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>\n        <label style={{ fontSize: 12, width: 120 }}>Mkoi (Clouds)</label>\n        <input\n          type=\"range\"\n          min=\"0\"\n          max=\"100\"\n          step=\"1\"\n          value={Number.isFinite(clouds) ? clouds : 0}\n          onChange={(e) => {\n            const v = Math.max(0, Math.min(100, parseInt(e.target.value, 10) || 0));\n            setClouds(v);\n            try { localStorage.setItem('game_weather_clouds', String(v)); } catch {}\n            emitUpdate({ weatherClouds: v });\n          }}\n        />\n        <span style={{ fontSize: 12, width: 34, textAlign: 'right' }}>{Number.isFinite(clouds) ? clouds : 0}</span>\n      </div>\n    </section>\n  );\n\n  return (\n    <div style={panelStyle}>\n      <div style={headerStyle} onMouseDown={onHeaderMouseDown}>\n        <div style={{ fontWeight: 600, color: '#9cdcfe' }}>Game Settings</div>\n        <div style={{ display: 'flex', alignItems: 'center' }}>\n          <button onClick={onMinToggle} title={minimized ? 'Expand' : 'Minimize'} style={buttonStyle}>\n            {minimized ? '' : ''}\n          </button>\n          <button onClick={onClose} title=\"Close\" style={{ ...buttonStyle, background: '#a33', borderColor: '#822' }}></button>\n        </div>\n      </div>\n\n      {/* Tabs bar: one-line menu */}\n      <div style={tabsBarStyle}>\n        {['Audio','Graphics','Weather'].map((t) => (\n          <button key={t} style={tabBtnStyle(t)} onClick={() => setActiveTab(t)}>{t}</button>\n        ))}\n      </div>\n\n      <div style={contentStyle}>\n        {activeTab === 'Audio' && renderAudio()}\n        {activeTab === 'Graphics' && renderGraphics()}\n        {activeTab === 'Weather' && renderWeather()}\n      </div>\n\n      {/* Resize handle */}\n      {!minimized && (\n        <div\n          onMouseDown={onResizeMouseDown}\n          title=\"Resize\"\n          style={{ position: 'absolute', right: 0, bottom: 0, width: 16, height: 16, cursor: 'nwse-resize',\n                   background: 'linear-gradient(135deg, transparent 0, transparent 50%, #666 50%, #666 100%)' }}\n        />\n      )}\n    </div>\n  );\n}\n","import React, { useEffect, useRef } from 'react';\n\n// Lightweight background music player that resolves a meta path like\n// \"/sound/background/track.ogg\" to a build URL via require.context and\n// plays/pauses a looping HTMLAudioElement.\n// Props:\n// - metaPath: string | null  stored in map meta (e.g., \"/sound/background/foo.ogg\")\n// - enabled: boolean  global sound toggle\n// - volume: number (0..1)\nexport default function BackgroundMusicPlayer({ metaPath, enabled = false, volume = 0.6 }) {\n  const audioRef = useRef(null);\n  const currentSrcRef = useRef(null);\n\n  // Resolve ogg assets from src/assets/sound/background\n  let musicContext = null;\n  try {\n    // utilities -> ../assets/sound/background\n    musicContext = require.context('../assets/sound/background', false, /\\.ogg$/);\n  } catch (e) {\n    musicContext = null;\n  }\n\n  const resolveUrl = (path) => {\n    if (!path) return null;\n    const name = path.split('/').pop();\n    if (!name) return null;\n    if (musicContext) {\n      try {\n        const mod = musicContext(`./${name}`);\n        return mod.default || mod;\n      } catch (e) {\n        console.warn(`Background music not found: ${name}`);\n      }\n    }\n    return null;\n  };\n\n  const cleanup = () => {\n    try {\n      if (audioRef.current) {\n        audioRef.current.pause();\n        audioRef.current.src = '';\n        audioRef.current = null;\n        currentSrcRef.current = null;\n      }\n    } catch {}\n  };\n\n  // Build/rebuild audio element when metaPath changes\n  useEffect(() => {\n    const url = resolveUrl(metaPath);\n\n    // If unchanged, just update enabled/volume in next effect\n    if (url && currentSrcRef.current === url && audioRef.current) {\n      return () => {};\n    }\n\n    // Rebuild\n    cleanup();\n    if (!url) return () => {};\n\n    const audio = new Audio(url);\n    audio.loop = true;\n    audio.volume = Math.max(0, Math.min(1, Number(volume) || 0));\n    audioRef.current = audio;\n    currentSrcRef.current = url;\n\n    // Try to pre-play if enabled (may be blocked by autoplay policy)\n    if (enabled) {\n      audio.play().catch(() => {\n        // Will try again on explicit user gesture via custom event\n      });\n    }\n\n    return () => cleanup();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [metaPath]);\n\n  // React to enabled/volume changes\n  useEffect(() => {\n    const audio = audioRef.current;\n    if (!audio) return;\n    audio.volume = Math.max(0, Math.min(1, Number(volume) || 0));\n    if (enabled) {\n      // Attempt to play; may require user gesture\n      audio.play().catch(() => {\n        // try again on gesture event\n      });\n    } else {\n      try { audio.pause(); } catch {}\n    }\n  }, [enabled, volume]);\n\n  // Listen for a gesture-driven event to force playback immediately in handler\n  useEffect(() => {\n    const onGesture = () => {\n      const audio = audioRef.current;\n      if (audio && enabled) {\n        audio.play().catch(() => {});\n      }\n    };\n    const onToggle = (e) => {\n      const val = !!(e && e.detail && e.detail.enabled);\n      const audio = audioRef.current;\n      if (!audio) return;\n      if (val) {\n        audio.play().catch(() => {});\n      } else {\n        try { audio.pause(); } catch {}\n      }\n    };\n    window.addEventListener('game-sound-user-gesture', onGesture);\n    window.addEventListener('game-sound-toggle', onToggle);\n    return () => {\n      window.removeEventListener('game-sound-user-gesture', onGesture);\n      window.removeEventListener('game-sound-toggle', onToggle);\n    };\n  }, [enabled]);\n\n  return null;\n}\n","import React, { useState, useEffect, useMemo, useRef, useCallback } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { getRegistry, findItemById } from '../../../engine/registry';\nimport PixiStage from './PixiStage';\nimport { useGameEngine } from '../../../utilities/useGameEngine';\nimport GameHeader from './GameHeader';\nimport GameTerminal from './GameTerminal';\nimport GameSettings from './GameSettings';\nimport BackgroundMusicPlayer from '../../../utilities/BackgroundMusicPlayer';\nimport { setActiveMap, removeObjectAtIndex, updateObjectAtIndex, updateObjectMetadata, setObjectTextureIndex, revealSecretZone, resetGame } from '../../../store/slices/gameSlice';\nimport { setMapModalOpen, setCameraScrollX, setShouldCenterMap } from '../../../store/slices/uiSlice';\nimport { setSoundEnabled } from '../../../store/slices/settingsSlice';\nimport errorHandler from '../../../services/errorHandler';\nimport styled from 'styled-components';\n\n// Import maps (static files usually need to be imported or fetched in React/Webpack)\nimport map1 from '../../../assets/maps/Temp_01.json';\nimport map2 from '../../../assets/maps/Temp_02.json';\nimport map3 from '../../../assets/maps/Temp_03.json';\n\n// Simulate file list from folder\nconst BUILT_IN_MAPS = [map1, map2, map3];\n\n// Styled Components\nconst GameContainer = styled.div`\n    position: relative;\n    height: 100%;\n    overflow: hidden;\n    background-color: #333;\n`;\n\nconst ModalOverlay = styled.div`\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background-color: rgba(0, 0, 0, 0.6);\n    z-index: 1000;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    backdrop-filter: blur(2px);\n`;\n\nconst ModalContent = styled.div`\n    background-color: #fff;\n    padding: 20px;\n    border-radius: 8px;\n    width: 500px;\n    max-height: 80%;\n    overflow-y: auto;\n    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);\n    display: flex;\n    flex-direction: column;\n    gap: 15px;\n`;\n\nconst ModalTitle = styled.h2`\n    margin: 0;\n    border-bottom: 2px solid #eee;\n    padding-bottom: 10px;\n`;\n\nconst MapList = styled.div`\n    display: flex;\n    flex-direction: column;\n    gap: 10px;\n`;\n\nconst MapCard = styled.div`\n    border: 1px solid #ddd;\n    border-radius: 6px;\n    padding: 10px;\n    cursor: pointer;\n    background-color: #f9f9f9;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n\n    &:hover {\n        background-color: #e8e8e8;\n    }\n`;\n\nconst MapTitle = styled.div`\n    font-weight: bold;\n    font-size: 16px;\n`;\n\nconst MapAuthor = styled.div`\n    font-size: 12px;\n    color: #666;\n`;\n\nconst MapInfo = styled.div`\n    text-align: right;\n    font-size: 11px;\n    color: #555;\n`;\n\nconst WinCounterOverlay = styled.div`\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    font-size: 120px;\n    font-weight: bold;\n    color: #fff;\n    text-shadow: 0 0 20px rgba(0,0,0,0.8), 0 0 40px rgba(255,255,255,0.5);\n    z-index: 2000;\n    pointer-events: none;\n    font-family: 'Courier New', Courier, monospace;\n`;\n\nconst ModalDivider = styled.div`\n    border-top: 2px solid #eee;\n    padding-top: 15px;\n    margin-top: 10px;\n`;\n\nconst FileUploadLabel = styled.label`\n    padding: 8px 16px;\n    background-color: #2196F3;\n    color: white;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n    font-weight: bold;\n    text-align: center;\n    display: inline-block;\n    width: 100%;\n    box-sizing: border-box;\n\n    &:hover {\n        background-color: #1976D2;\n    }\n`;\n\nconst HiddenFileInput = styled.input`\n    display: none;\n`;\n\nconst Viewport = styled.div`\n    height: 100%;\n    overflow: hidden;\n    filter: ${props => props.$blurred ? 'blur(5px)' : 'none'};\n    pointer-events: ${props => props.$blurred ? 'none' : 'auto'};\n    transition: filter 0.3s ease;\n`;\n\nconst GameCanvas = styled.div`\n    position: relative;\n    width: 100%;\n    height: 100%;\n    background-color: #111;\n`;\n\nconst PlaceholderMessage = styled.div`\n    color: #777;\n    font-size: 24px;\n`;\n\nexport default function Game() {\n    const dispatch = useDispatch();\n    const viewportRef = useRef(null);\n    const player = useSelector(state => state.player); // Ensure this isn't undefined\n\n    // Redux state\n    const { activeMapData, tileMapData, objectMapData, secretMapData, objectMetadata, revealedSecrets, objectTextureIndices, mapWidth, mapHeight } = useSelector(state => state.game);\n    const { isMapModalOpen, cameraScrollX, shouldCenterMap } = useSelector(state => state.ui);\n    const { sound } = useSelector(state => state.settings);\n    const soundEnabled = sound.enabled;\n\n    // Runtime settings that can be changed from GameSettings on the fly\n    const [runtimeSettings, setRuntimeSettings] = useState({});\n\n    // Registry\n    const registryItems = getRegistry() || [];\n\n    const handleGameOver = () => {\n        // Reload current map using Redux\n        if (activeMapData) {\n            console.log(\"Game Over! Reloading map...\");\n            // Pievienojam timestamp, lai dzinjs zintu, ka is ir restarts/jauna ielde\n            const mapToLoad = {\n                ...activeMapData,\n                meta: {\n                    ...activeMapData.meta,\n                    date_map_last_updated: new Date().toISOString()\n                }\n            };\n            loadMapData(mapToLoad);\n        }\n    };\n\n    const handleStateUpdate = useCallback((action, payload) => {\n        if (action === 'collectItem') {\n            const indexToRemove = payload;\n            dispatch(removeObjectAtIndex(indexToRemove));\n        } else if (action === 'interactable') {\n            const index = payload;\n            // Switch interactable to \"used\" variant by changing ID\n            // e.g., berry_bush_01 -> berry_bush_01_used\n            const currentId = objectMapData[index];\n            if (currentId) {\n                dispatch(updateObjectAtIndex({ index, newId: currentId + '_used' }));\n            }\n        } else if (action === 'objectDamage') {\n            const { index, damage } = payload;\n            const objId = objectMapData[index];\n            if (objId) {\n                const def = registryItems.find(r => r.id === objId);\n                if (def && def.isDestructible) {\n                    const currentMeta = objectMetadata[index] || {};\n                    const maxH = def.maxHealth || 100;\n                    const newHealth = Math.max(0, (currentMeta.health !== undefined ? currentMeta.health : maxH) - damage);\n                    dispatch(updateObjectMetadata({ index, metadata: { health: newHealth } }));\n                }\n            }\n        } else if (action === 'playerDamage' && payload !== undefined) {\n            // eit ms nevaram viegli atjaunint Redux katr kadr,\n            // bet varam atskaot trpjuma skau\n            console.log(\"Player hit by entity!\");\n        } else if (action === 'levelWin') {\n            console.log(\"Level Win! Returning to map selection.\");\n            setTimeout(() => {\n                alert(\"Level Complete!\");\n                dispatch(setMapModalOpen(true));\n            }, 500);\n        }\n    }, [dispatch, objectMapData, objectMetadata, registryItems]);\n\n    // We no longer need 'engineMapData' with layers, as we pass objectMapData separately.\n    // So we pass the original 'activeMapData' as first argument (for initialization to work correctly and not reset),\n    // and 'objectMapData' as third argument for item checking.\n\n    // Callback for revealing secret zones\n    const handleRevealSecret = (indices) => {\n        dispatch(revealSecretZone(indices));\n    };\n\n    // --- START ENGINE ---\n    // Engine returns player coordinates and state\n    // objectMapData contains dynamic data (removed items)\n    const playerState = useGameEngine(\n        activeMapData,\n        tileMapData,\n        objectMapData,\n        secretMapData,\n        revealedSecrets,\n        registryItems,\n        handleGameOver,\n        handleStateUpdate,\n        handleRevealSecret,\n        objectMetadata\n    );\n\n    // Iegstam spltja vizulo izskatu (Texture)\n    const playerVisuals = useMemo(() => {\n        // eit vartu bt loika, kas maina tekstru atkarb no playerState.direction vai playerState.vx\n        // Pagaidm paemam noklusto\n        return findItemById(\"player_default_100\") || findItemById(\"player\");\n    }, []);\n    // --- END ENGINE ---\n\n    // Listen for runtime settings updates from GameSettings (live apply)\n    useEffect(() => {\n        const onSettingsUpdate = (e) => {\n            const patch = (e && e.detail) || {};\n            setRuntimeSettings(prev => ({ ...prev, ...patch }));\n        };\n        window.addEventListener('game-settings-update', onSettingsUpdate);\n        return () => window.removeEventListener('game-settings-update', onSettingsUpdate);\n    }, []);\n\n    // Listen for navigation buttons\n    useEffect(() => {\n        const handleOpenModalEvent = () => dispatch(setMapModalOpen(true));\n        window.addEventListener('open-new-game-modal', handleOpenModalEvent);\n        return () => window.removeEventListener('open-new-game-modal', handleOpenModalEvent);\n    }, [dispatch]);\n\n    // Mirror current effective runtime settings for other components to read (like GameSettings)\n    useEffect(() => {\n        try {\n            const clouds = (runtimeSettings.weatherClouds ?? 0);\n            const fog = (runtimeSettings.weatherFog ?? 0);\n            const thunder = (runtimeSettings.weatherThunder ?? 0);\n            window.__GAME_RUNTIME_SETTINGS__ = {\n                ...(window.__GAME_RUNTIME_SETTINGS__ || {}),\n                backgroundParallaxFactor: (runtimeSettings.backgroundParallaxFactor ?? activeMapData?.meta?.backgroundParallaxFactor ?? 0.3),\n                weatherRain: (runtimeSettings.weatherRain ?? 0),\n                weatherSnow: (runtimeSettings.weatherSnow ?? 0),\n                weatherClouds: clouds,\n                weatherFog: fog,\n                weatherThunder: thunder,\n                healthBarEnabled: (runtimeSettings.healthBarEnabled ?? true),\n                oxygenBarEnabled: (runtimeSettings.oxygenBarEnabled ?? true),\n                lavaBarEnabled: (runtimeSettings.lavaBarEnabled ?? true),\n                waterSplashesEnabled: (runtimeSettings.waterSplashesEnabled ?? true),\n                lavaEmbersEnabled: (runtimeSettings.lavaEmbersEnabled ?? true),\n                // legacy mirror for compatibility (e.g., older UI)\n                weatherFogLegacy: fog,\n            };\n        } catch {}\n    }, [runtimeSettings, activeMapData]);\n\n    const loadMapData = (mapData) => {\n        try {\n            if (!mapData) {\n                errorHandler.warn('loadMapData called with empty mapData', { component: 'Game' });\n                return;\n            }\n\n            const w = mapData.meta?.width || mapData.width || 20;\n            const h = mapData.meta?.height || mapData.height || 15;\n\n            let tileData = [];\n            let objData = [];\n            let secretData = [];\n\n            if (mapData.layers) {\n                const bgLayer = mapData.layers.find(l => l.name === 'background');\n                tileData = bgLayer ? bgLayer.data : Array(w * h).fill(null);\n\n                const objLayer = mapData.layers.find(l => l.name === 'entities');\n                objData = objLayer ? objLayer.data : Array(w * h).fill(null);\n\n                const secretLayer = mapData.layers.find(l => l.name === 'secrets');\n                secretData = secretLayer ? secretLayer.data : Array(w * h).fill(null);\n            } else {\n                tileData = mapData.tiles || Array(w * h).fill(null);\n                objData = Array(w * h).fill(null);\n                secretData = Array(w * h).fill(null);\n            }\n\n            // Debug logging\n            console.log('[DEBUG] Loading map with secrets:', {\n                hasSecretsLayer: !!mapData.layers?.find(l => l.name === 'secrets'),\n                secretDataLength: secretData?.length,\n                secretDataNonNull: secretData?.filter(s => s !== null).length,\n                secretDataSample: secretData?.filter(s => s !== null).slice(0, 5)\n            });\n\n            // Update Redux store\n            dispatch(setActiveMap({\n                mapData,\n                tileMapData: tileData,\n                objectMapData: objData,\n                secretMapData: secretData,\n                mapWidth: w,\n                mapHeight: h\n            }));\n            dispatch(setCameraScrollX(0));\n            dispatch(setMapModalOpen(false));\n\n            errorHandler.info('Map loaded successfully', {\n                component: 'Game',\n                mapName: mapData.meta?.name || 'Unknown',\n                dimensions: `${w}x${h}`\n            });\n        } catch (error) {\n            errorHandler.error(error, {\n                component: 'Game',\n                function: 'loadMapData',\n                mapData\n            });\n            alert('Error loading map. Check console for details.');\n        }\n    };\n\n    const handleCustomMapUpload = (event) => {\n        try {\n            const file = event.target.files[0];\n            if (!file) return;\n\n            const fileReader = new FileReader();\n            fileReader.readAsText(file, \"UTF-8\");\n            fileReader.onload = (e) => {\n                try {\n                    const loaded = JSON.parse(e.target.result);\n                    loadMapData(loaded);\n                } catch (error) {\n                    errorHandler.error(error, {\n                        component: 'Game',\n                        function: 'handleCustomMapUpload',\n                        fileName: file.name\n                    });\n                    alert(\"Invalid map file! Check console for details.\");\n                }\n            };\n            fileReader.onerror = (error) => {\n                errorHandler.error(error, {\n                    component: 'Game',\n                    function: 'handleCustomMapUpload',\n                    fileName: file.name,\n                    phase: 'fileReader'\n                });\n                alert(\"Error reading file!\");\n            };\n        } catch (error) {\n            errorHandler.error(error, {\n                component: 'Game',\n                function: 'handleCustomMapUpload'\n            });\n        }\n    };\n\n    return (\n        <GameContainer>\n        \n            {/* Game Header */}\n            {/* UI Overlays */}\n            {playerState?.isWinning && (\n                <WinCounterOverlay>\n                    {Math.floor(playerState.winCounter || 0)}\n                </WinCounterOverlay>\n            )}\n\n            <GameHeader \n                health={playerState.health} \n                maxHealth={playerState.maxHealth}\n                ammo={playerState.ammo || 0} \n                oxygen={playerState.oxygen}\n                maxOxygen={playerState.maxOxygen}\n                lavaResist={playerState.lavaResist}\n                maxLavaResist={playerState.maxLavaResist}\n                iceResist={playerState.iceResist}\n                maxIceResist={playerState.maxIceResist}\n                inWater={playerState.inWater}\n                liquidType={playerState.liquidType}\n                onIce={playerState.onIce}\n            />\n\n\n            {isMapModalOpen && (\n                <ModalOverlay>\n                    <ModalContent>\n                        <ModalTitle>Select a Map</ModalTitle>\n                        <MapList>\n                            {BUILT_IN_MAPS.map((map, index) => (\n                                <MapCard key={index} onClick={() => loadMapData(map)}>\n                                    <div>\n                                        <MapTitle>{map.meta?.name || \"Unnamed Map\"}</MapTitle>\n                                        <MapAuthor>By: {map.meta?.author || \"Unknown\"}</MapAuthor>\n                                    </div>\n                                    <MapInfo>\n                                        <div>Size: {map.meta?.width}x{map.meta?.height}</div>\n                                    </MapInfo>\n                                </MapCard>\n                            ))}\n                        </MapList>\n                        <ModalDivider>\n                            <FileUploadLabel>\n                                 Load Custom Map from Computer\n                                <HiddenFileInput type=\"file\" accept=\".json\" onChange={handleCustomMapUpload} />\n                            </FileUploadLabel>\n                        </ModalDivider>\n                    </ModalContent>\n                </ModalOverlay>\n            )}\n\n            <Viewport\n                ref={viewportRef}\n                $blurred={isMapModalOpen}\n            >\n                {activeMapData ? (\n                    <GameCanvas>\n                    \n                        {/* PIXI RENDERER */}\n                        <PixiStage\n                            mapWidth={mapWidth}\n                            mapHeight={mapHeight}\n                            tileSize={32}\n                            tileMapData={tileMapData}\n                            objectMapData={objectMapData}\n                            secretMapData={secretMapData}\n                            revealedSecrets={revealedSecrets}\n                            objectTextureIndices={objectTextureIndices}\n                            registryItems={registryItems}\n                            playerState={playerState}\n                            playerVisuals={playerVisuals}\n                            projectiles={playerState.projectiles || []}\n                            objectMetadata={objectMetadata}\n                            backgroundImage={activeMapData?.meta?.backgroundImage}\n                            backgroundColor={activeMapData?.meta?.backgroundColor}\n                            backgroundParallaxFactor={(runtimeSettings.backgroundParallaxFactor ?? activeMapData?.meta?.backgroundParallaxFactor)}\n                            cameraScrollX={cameraScrollX}\n                            weatherRain={runtimeSettings.weatherRain ?? 0}\n                            weatherSnow={runtimeSettings.weatherSnow ?? 0}\n                            weatherClouds={runtimeSettings.weatherClouds ?? 0}\n                            weatherFog={runtimeSettings.weatherFog ?? 0}\n                            weatherThunder={runtimeSettings.weatherThunder ?? 0}\n                            healthBarEnabled={runtimeSettings.healthBarEnabled ?? true}\n                            oxygenBarEnabled={runtimeSettings.oxygenBarEnabled ?? true}\n                            lavaBarEnabled={runtimeSettings.lavaBarEnabled ?? true}\n                            waterSplashesEnabled={runtimeSettings.waterSplashesEnabled ?? true}\n                            lavaEmbersEnabled={runtimeSettings.lavaEmbersEnabled ?? true}\n                            isEditor={false}\n                        />\n\n                    </GameCanvas>\n                ) : (\n                    <PlaceholderMessage>Select a map to start playing</PlaceholderMessage>\n                )}\n            </Viewport>\n\n            {/* Background music runtime player */}\n            <BackgroundMusicPlayer metaPath={activeMapData?.meta?.backgroundMusic} enabled={soundEnabled} volume={0.6} />\n\n            {/* Overlays at root level so they sit above the canvas and slide from the footer area */}\n            <GameSettings />\n            <GameTerminal />\n        </GameContainer>\n    );\n}\n","// Progressive save utility for web: prefers File System Access API (Chromium)\n// Fallbacks to classic Blob download when not available or when permission denied.\n\n/**\n * Save a file, letting the user choose directory/filename when supported.\n * @param {string|Blob|Uint8Array} contents - Data to write\n * @param {string} suggestedName - Suggested filename, e.g., \"my_map.json\"\n * @param {string} mimeType - MIME type, e.g., \"application/json\"\n * @returns {Promise<boolean>} true if saved, false if cancelled or failed\n */\nexport async function saveFile(contents, suggestedName = 'file.txt', mimeType = 'application/octet-stream') {\n  try {\n    // Prefer native file picker if available (Chromium: Edge/Chrome/Opera/Brave)\n    const hasPicker = typeof window !== 'undefined' && typeof window.showSaveFilePicker === 'function';\n    if (hasPicker) {\n      const opts = {\n        suggestedName,\n        types: [\n          {\n            description: 'File',\n            accept: { [mimeType || 'application/octet-stream']: [`.${(suggestedName.split('.').pop() || 'dat')}`] }\n          }\n        ]\n      };\n      let handle;\n      try {\n        handle = await window.showSaveFilePicker(opts);\n      } catch (e) {\n        // User cancelled the dialog\n        if (e && (e.name === 'AbortError' || e.name === 'NotAllowedError')) return false;\n        throw e;\n      }\n\n      const writable = await handle.createWritable();\n      const blob = contents instanceof Blob ? contents : new Blob([contents], { type: mimeType });\n      await writable.write(blob);\n      await writable.close();\n      return true;\n    }\n  } catch (e) {\n    // fall through to fallback\n    try { console.warn('Native save picker failed, using download fallback:', e); } catch {}\n  }\n\n  // Fallback: trigger a download to the browser default location\n  try {\n    const blob = contents instanceof Blob ? contents : new Blob([contents], { type: mimeType });\n    const link = document.createElement('a');\n    link.href = URL.createObjectURL(blob);\n    link.download = suggestedName || 'file.dat';\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n    setTimeout(() => URL.revokeObjectURL(link.href), 0);\n    return true;\n  } catch (e) {\n    try { console.error('Download fallback failed:', e); } catch {}\n    return false;\n  }\n}\n\nexport default saveFile;\n","export const getFloodFillIndices = (startIndex, currentData, mapWidth, mapHeight) => {\n    const startId = currentData[startIndex];\n    const width = mapWidth;\n    const height = mapHeight;\n    const stack = [startIndex];\n    const visited = new Set();\n    const matchingIndices = [];\n\n    while (stack.length > 0) {\n        const idx = stack.pop();\n        if (visited.has(idx)) continue;\n        visited.add(idx);\n        if (idx < 0 || idx >= currentData.length) continue;\n        if (currentData[idx] !== startId) continue;\n        matchingIndices.push(idx);\n\n        const x = idx % width;\n        const y = Math.floor(idx / width);\n        if (x > 0) stack.push(idx - 1);\n        if (x < width - 1) stack.push(idx + 1);\n        if (y > 0) stack.push(idx - width);\n        if (y < height - 1) stack.push(idx + width);\n    }\n    return matchingIndices;\n};\n\nexport const floodFill = (startIndex, targetId, getCurrentData, setCurrentData, mapWidth, mapHeight) => {\n    const currentData = getCurrentData();\n    const startId = currentData[startIndex];\n    if (startId === targetId) return;\n\n    const indices = getFloodFillIndices(startIndex, currentData, mapWidth, mapHeight);\n    const newData = [...currentData];\n    indices.forEach(idx => newData[idx] = targetId);\n    setCurrentData(newData);\n};\n\nexport const paintTile = (index, selectedTile, brushSize, mapWidth, mapHeight, getCurrentData, setCurrentData) => {\n    const currentData = getCurrentData();\n    const newData = [...currentData];\n    const x = index % mapWidth;\n    const y = Math.floor(index / mapWidth);\n\n    for (let dy = 0; dy < brushSize; dy++) {\n        for (let dx = 0; dx < brushSize; dx++) {\n            const targetX = x + dx;\n            const targetY = y + dy;\n            if (targetX < mapWidth && targetY < mapHeight) {\n                const targetIndex = targetY * mapWidth + targetX;\n                newData[targetIndex] = selectedTile ? selectedTile.id : null;\n            }\n        }\n    }\n    setCurrentData(newData);\n};\n","import React, { useState, useEffect } from 'react';\n\nconst AnimatedItem = ({ textures, texture, speed, style, alt, className, spriteSheet }) => {\n    const [index, setIndex] = useState(0);\n\n    useEffect(() => {\n        // Ja ir vairkas tekstras, skam animciju\n        if (textures && textures.length > 1) {\n            const interval = setInterval(() => {\n                setIndex((prevIndex) => (prevIndex + 1) % textures.length);\n            }, speed || 500); // Noklusjuma trums 500ms\n\n            return () => clearInterval(interval);\n        }\n    }, [textures, speed]);\n\n    // Izvlamies ko rendert: animcijas kadru, viengo tekstru vai statisko bildi\n    let imgSrc = null;\n    if (textures && textures.length > 0) {\n        imgSrc = textures[index % textures.length];\n    } else if (texture) {\n        imgSrc = texture;\n    }\n\n    if (!imgSrc) return null;\n\n    // Ja ir spraitts, rdm tikai pirmo kadru (vai citu, ja nordts)\n    if (spriteSheet && spriteSheet.enabled) {\n        const columns = spriteSheet.columns || 1;\n        const total = spriteSheet.totalSprites || 1;\n        const rows = Math.ceil(total / columns);\n        \n        // Editor parasti rdm pirmo kadru (index 0)\n        const frameIndex = 0;\n        const col = frameIndex % columns;\n        const row = Math.floor(frameIndex / columns);\n\n        return (\n            <div className={className} style={{\n                ...style,\n                overflow: 'hidden',\n                display: 'inline-block',\n                width: style?.width || '32px',\n                height: style?.height || '32px',\n                position: 'relative'\n            }}>\n                <img\n                    src={imgSrc}\n                    alt={alt || ''}\n                    style={{\n                        position: 'absolute',\n                        width: `${columns * 100}%`,\n                        height: `${rows * 100}%`,\n                        left: `-${col * 100}%`,\n                        top: `-${row * 100}%`,\n                        maxWidth: 'none',\n                        maxHeight: 'none',\n                        display: 'block'\n                    }}\n                    draggable={false}\n                />\n            </div>\n        );\n    }\n\n    return (\n        <img\n            src={imgSrc}\n            alt={alt || ''}\n            style={style}\n            className={className}\n            draggable={false}\n        />\n    );\n};\n\nexport default AnimatedItem;","import React from 'react';\nimport AnimatedItem from '../../../utilities/AnimatedItem';\nimport { TILE_SIZE } from '../../../constants/gameConstants';\n\nexport const Viewport = ({\n    mapWidth,\n    mapHeight,\n    selectedBackgroundUrl,\n    selectedBackgroundColor,\n    selectedBackgroundImage,\n    showGrid,\n    activeLayer,\n    activeTool,\n    tileMapData,\n    objectMapData,\n    secretMapData,\n    objectMetadata,\n    registryItems,\n    hoverIndex,\n    highlightedIndex,\n    brushSize,\n    bucketPreviewIndices,\n    selection,\n    previewPosition,\n    dragStart,\n    isDragging,\n    handleGridMouseDown,\n    handleGridMouseEnter,\n    handleGridMouseUp,\n    handleGridMouseLeave,\n    setIsDragging\n}) => {\n    return (\n        <div className=\"viewport\"\n            style={{\n                flex: 1, padding: '40px', backgroundColor: '#555',\n                overflow: 'auto', position: 'relative', userSelect: 'none'\n            }}\n            onMouseUp={() => setIsDragging(false)}>\n            <div style={{ position: 'relative', width: 'fit-content' }} onMouseLeave={handleGridMouseLeave}>\n                {/* Visual links between portals and targets */}\n                <svg style={{\n                    position: 'absolute',\n                    top: 0,\n                    left: 0,\n                    width: mapWidth * 32,\n                    height: mapHeight * 32,\n                    zIndex: 10,\n                    pointerEvents: 'none',\n                    opacity: 0.6\n                }}>\n                    {(() => {\n                        const links = [];\n                        const portals = [];\n                        const targets = [];\n\n                        // Collect all portals and targets with Trigger IDs\n                        objectMapData.forEach((id, index) => {\n                            if (!id) return;\n                            const metadata = objectMetadata?.[index];\n                            if (!metadata || metadata.triggerId === undefined || metadata.triggerId === null) return;\n\n                            const x = (index % mapWidth) * 32 + 16;\n                            const y = Math.floor(index / mapWidth) * 32 + 16;\n\n                            if (id.includes('portal') && !id.includes('target')) {\n                                portals.push({ x, y, id: metadata.triggerId });\n                            } else if (id.includes('target') || id === 'portal_target') {\n                                targets.push({ x, y, id: metadata.triggerId });\n                            }\n                        });\n\n                        // Draw lines between matching IDs\n                        portals.forEach(p => {\n                            targets.forEach(t => {\n                                if (p.id === t.id) {\n                                    links.push(\n                                        <line\n                                            key={`link-${p.x}-${p.y}-${t.x}-${t.y}`}\n                                            x1={p.x} y1={p.y}\n                                            x2={t.x} y2={t.y}\n                                            stroke=\"#fff\"\n                                            strokeWidth=\"2\"\n                                            strokeDasharray=\"5,5\"\n                                        />\n                                    );\n                                }\n                            });\n                        });\n                        return links;\n                    })()}\n                </svg>\n\n                {/* Background preview layer */}\n                <div\n                    style={{\n                        position: 'absolute',\n                        top: 0,\n                        left: 0,\n                        width: mapWidth * 32,\n                        height: mapHeight * 32,\n                        backgroundImage: selectedBackgroundUrl ? `url(${selectedBackgroundUrl})` : 'none',\n                        backgroundColor: !selectedBackgroundUrl ? selectedBackgroundColor : 'transparent',\n                        backgroundRepeat: 'repeat-x',\n                        backgroundSize: 'auto 100%',\n                        zIndex: 0,\n                        pointerEvents: 'none'\n                    }}\n                />\n                <div className=\"grid\"\n                    style={{\n                        display: 'grid',\n                        gridTemplateColumns: `repeat(${mapWidth}, 32px)`,\n                        gridTemplateRows: `repeat(${mapHeight}, 32px)`,\n                        gap: '0px',\n                        border: '1px solid #444',\n                        backgroundColor: 'transparent',\n                        position: 'relative',\n                        cursor: activeTool === 'bucket' ? 'cell' : 'default',\n                        zIndex: 1\n                    }}>\n                    {Array(mapWidth * mapHeight).fill(0).map((_, index) => {\n                        const x = index % mapWidth;\n                        const y = Math.floor(index / mapWidth);\n\n                        // Check if this tile is in preview selection area\n                        let displayTileId = tileMapData[index];\n                        let displayObjectId = objectMapData[index];\n                        let displaySecretId = secretMapData?.[index];\n\n                        // If we have a preview position, check if this tile should show selection content\n                        if (selection && previewPosition) {\n                            const selX = previewPosition.x;\n                            const selY = previewPosition.y;\n\n                            if (x >= selX && x < selX + selection.w && y >= selY && y < selY + selection.h) {\n                                // This tile is in the preview selection area\n                                const offsetX = x - selX;\n                                const offsetY = y - selY;\n                                const selectionIndex = offsetY * selection.w + offsetX;\n\n                                displayTileId = selection.tileData[selectionIndex];\n                                displayObjectId = selection.objectData[selectionIndex];\n                                displaySecretId = selection.secretData?.[selectionIndex];\n                            }\n                        }\n\n                        const tileObj = displayTileId ? registryItems.find(r => r.id === displayTileId) : null;\n                        const objObj = displayObjectId ? registryItems.find(r => r.id === displayObjectId) : null;\n                        const secretObj = displaySecretId ? registryItems.find(r => r.id === displaySecretId) : null;\n\n                        let isSelected = false;\n                        let isPreviewSelection = false;\n\n                        // Use previewPosition if available, otherwise use selection.x/y\n                        const selX = previewPosition ? previewPosition.x : (selection ? selection.x : 0);\n                        const selY = previewPosition ? previewPosition.y : (selection ? selection.y : 0);\n\n                        if (selection && x >= selX && x < selX + selection.w && y >= selY && y < selY + selection.h) {\n                            isSelected = true;\n                            if (previewPosition && (previewPosition.x !== selection.originalX || previewPosition.y !== selection.originalY)) {\n                                isPreviewSelection = true;\n                            }\n                        }\n\n                        let isMoveSelecting = false;\n                        let isMoveHover = false;\n                        if (activeTool === 'move') {\n                            if (isDragging && dragStart && hoverIndex !== null) {\n                                const hx = hoverIndex % mapWidth;\n                                const hy = Math.floor(hoverIndex / mapWidth);\n                                const sx = dragStart.x;\n                                const sy = dragStart.y;\n                                const minX = Math.min(sx, hx);\n                                const minY = Math.min(sy, hy);\n                                const maxX = Math.max(sx, hx);\n                                const maxY = Math.max(sy, hy);\n                                if (x >= minX && x <= maxX && y >= minY && y <= maxY) isMoveSelecting = true;\n                            } else if (!isDragging && hoverIndex === index) {\n                                isMoveHover = true;\n                            }\n                        }\n\n                        let isBrushTarget = false;\n                        if ((activeTool === 'brush') && hoverIndex !== null) {\n                            const hx = hoverIndex % mapWidth;\n                            const hy = Math.floor(hoverIndex / mapWidth);\n                            if (x >= hx && x < hx + brushSize && y >= hy && y < hy + brushSize) isBrushTarget = true;\n                        }\n\n                        let isBucketTarget = false;\n                        let isBucketPreview = false;\n                        if (activeTool === 'bucket') {\n                            if (bucketPreviewIndices.has(index)) isBucketPreview = true;\n                            else if (hoverIndex === index) isBucketTarget = true;\n                        }\n\n                        let borderStyle = showGrid ? '0.5px solid rgba(128,128,128,0.5)' : 'none';\n                        let bgStyle = 'transparent';\n                        const isHighlighted = highlightedIndex === index;\n\n                        const isLiquidTile = !!(tileObj && tileObj.flags && tileObj.flags.liquid);\n                        const isWaterTile = !!(tileObj && tileObj.flags && tileObj.flags.water);\n                        const isLavaTile = !!(tileObj && tileObj.flags && tileObj.flags.lava);\n\n                        if (isBrushTarget) borderStyle = '2px solid red';\n                        else if (isBucketPreview) { borderStyle = '1px dashed orange'; bgStyle = 'rgb(168,187,220)'; }\n                        else if (isBucketTarget) borderStyle = '2px solid orange';\n                        else if (isMoveHover) borderStyle = '2px solid blue';\n                        else if (isMoveSelecting) { borderStyle = '1px dashed blue'; bgStyle = 'rgba(0, 0, 255, 0.1)'; }\n                        else if (isHighlighted) { borderStyle = '3px solid gold'; bgStyle = 'rgba(255, 215, 0, 0.4)'; }\n                        else if (isSelected) {\n                            if (isPreviewSelection) {\n                                borderStyle = '2px solid cyan';\n                                bgStyle = 'rgba(0, 255, 255, 0.2)';\n                            } else {\n                                borderStyle = '1px dashed red';\n                                bgStyle = 'rgba(255, 255, 0, 0.3)';\n                            }\n                        }\n                        else if (!showGrid) borderStyle = 'none';\n\n                        let backgroundStyleObj = {};\n                        if (bgStyle !== 'transparent') {\n                            backgroundStyleObj.backgroundColor = bgStyle;\n                        } else if (isLiquidTile) {\n                            if (isWaterTile) {\n                                backgroundStyleObj.background = 'linear-gradient(180deg, #2a5d8f, #174369)';\n                            } else if (isLavaTile) {\n                                backgroundStyleObj.background = 'linear-gradient(180deg, #6b1a07, #c43f0f)';\n                            } else {\n                                backgroundStyleObj.background = 'linear-gradient(180deg, #3a3a3a, #1e1e1e)';\n                            }\n                        }\n\n                        return (\n                            <div key={index}\n                                onMouseDown={(e) => handleGridMouseDown(index, e)}\n                                onMouseEnter={() => handleGridMouseEnter(index)}\n                                onMouseUp={() => handleGridMouseUp(index)}\n                                style={{\n                                    width: '32px', height: '32px', border: borderStyle,\n                                    zIndex: (isBrushTarget || isBucketTarget || isBucketPreview || isMoveHover || isMoveSelecting) ? 20 : (isSelected ? 15 : 1),\n                                    boxSizing: 'border-box', display: 'flex', alignItems: 'center', justifyContent: 'center', position: 'relative',\n                                    ...backgroundStyleObj\n                                }}>\n                                {/* Background Layer (Tiles) */}\n                                {tileObj && (\n                                    tileObj.editorIcon ? (\n                                        <div style={{ position: 'absolute', zIndex: 2, fontSize: '20px', fontWeight: 'bold' }}>\n                                            {tileObj.editorIcon}\n                                        </div>\n                                    ) : (\n                                        <AnimatedItem\n                                            textures={tileObj.textures}\n                                            texture={tileObj.texture}\n                                            speed={tileObj.animationSpeed}\n                                            spriteSheet={tileObj.spriteSheet}\n                                            style={{ position: 'absolute', width: '100%', height: '100%', objectFit: 'contain', zIndex: 2 }}\n                                        />\n                                    )\n                                )}\n\n                                {/* Foreground Layer (Objects) */}\n                                {objObj && (\n                                    <div style={{ position: 'absolute', width: '100%', height: '100%', zIndex: 3, display: 'flex', alignItems: 'center', justifyContent: 'center' }}>\n                                        {objObj.editorIcon ? (\n                                            <div style={{ fontSize: '24px', fontWeight: 'bold', color: '#fff', textShadow: '0 0 4px #000' }}>\n                                                {objObj.editorIcon}\n                                            </div>\n                                        ) : (\n                                            <AnimatedItem\n                                                textures={objObj.textures}\n                                                texture={objObj.texture}\n                                                speed={objObj.animationSpeed}\n                                                spriteSheet={objObj.spriteSheet}\n                                                style={{ width: '100%', height: '100%', objectFit: 'contain' }}\n                                            />\n                                        )}\n                                        {/* Render Trigger ID if present */}\n                                        {objectMetadata && objectMetadata[index] && objectMetadata[index].triggerId !== undefined && objectMetadata[index].triggerId !== null && (\n                                            <div style={{\n                                                position: 'absolute',\n                                                top: '-15px',\n                                                left: '50%',\n                                                transform: 'translateX(-50%)',\n                                                backgroundColor: 'rgba(0,0,0,0.7)',\n                                                color: '#fff',\n                                                padding: '1px 4px',\n                                                borderRadius: '3px',\n                                                fontSize: '10px',\n                                                whiteSpace: 'nowrap',\n                                                zIndex: 10,\n                                                border: '1px solid #fff'\n                                            }}>\n                                                ID: {objectMetadata[index].triggerId}\n                                            </div>\n                                        )}\n                                    </div>\n                                )}\n\n                                {/* Secret Layer (Dark Filter) */}\n                                {secretObj && (\n                                    <div style={{\n                                        position: 'absolute',\n                                        width: '100%',\n                                        height: '100%',\n                                        background: secretObj.filterColor || 'rgba(0, 0, 0, 0.5)',\n                                        zIndex: 4,\n                                        display: 'flex',\n                                        alignItems: 'center',\n                                        justifyContent: 'center',\n                                        fontSize: '8px',\n                                        color: 'rgba(255, 255, 255, 0.6)',\n                                        fontWeight: 'bold',\n                                        pointerEvents: 'none'\n                                    }}>\n                                        {secretObj.subtype === 'above' ? 'A' : 'B'}\n                                    </div>\n                                )}\n\n                                <div style={{ position: 'absolute', top: 0, left: 0, width: '100%', height: '100%', zIndex: 10 }} />\n                            </div>\n                        );\n                    })}\n                </div>\n            </div>\n        </div>\n    );\n};\n","export const baseButtonStyle = {\n    display: 'inline-flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    cursor: 'pointer',\n    border: '1px solid #333',\n    padding: '0 10px',\n    height: '28px',\n    backgroundColor: '#e0e0e0',\n    marginRight: '5px',\n    marginBottom: '5px',\n    fontSize: '13px',\n    color: '#000',\n    borderRadius: '3px',\n    userSelect: 'none',\n    minWidth: '30px',\n    boxSizing: 'border-box',\n    textDecoration: 'none',\n    lineHeight: 'normal'\n};\n\nexport const buttonStyle = { ...baseButtonStyle };\n\nexport const activeButtonStyle = {\n    ...baseButtonStyle,\n    backgroundColor: '#aaa',\n    borderColor: '#000',\n    fontWeight: 'bold'\n};\n","import React from 'react';\nimport { buttonStyle } from './constants';\n\nexport const NewMapModal = ({\n    isOpen,\n    tempMapName,\n    setTempMapName,\n    tempCreatorName,\n    setTempCreatorName,\n    confirmNewMap,\n    onClose\n}) => {\n    if (!isOpen) return null;\n\n    return (\n        <div style={{\n            position: 'absolute', top: 0, left: 0, width: '100%', height: '100%',\n            backgroundColor: 'rgba(0, 0, 0, 0.5)', zIndex: 1000,\n            display: 'flex', alignItems: 'center', justifyContent: 'center'\n        }}>\n            <div style={{\n                backgroundColor: '#fff', padding: '20px', borderRadius: '8px',\n                boxShadow: '0 4px 6px rgba(0,0,0,0.1)', width: '300px',\n                display: 'flex', flexDirection: 'column', gap: '10px'\n            }}>\n                <h3 style={{ marginTop: 0 }}>Create New Map</h3>\n\n                <div>\n                    <label style={{ display: 'block', fontSize: '12px', marginBottom: '4px' }}>Map Name:</label>\n                    <input\n                        type=\"text\"\n                        value={tempMapName}\n                        onChange={(e) => setTempMapName(e.target.value)}\n                        style={{ width: '100%', padding: '5px', boxSizing: 'border-box' }}\n                    />\n                </div>\n\n                <div>\n                    <label style={{ display: 'block', fontSize: '12px', marginBottom: '4px' }}>Creator Nickname:</label>\n                    <input\n                        type=\"text\"\n                        value={tempCreatorName}\n                        onChange={(e) => setTempCreatorName(e.target.value)}\n                        style={{ width: '100%', padding: '5px', boxSizing: 'border-box' }}\n                    />\n                </div>\n\n                <div style={{ display: 'flex', justifyContent: 'flex-end', gap: '10px', marginTop: '10px' }}>\n                    <button onClick={onClose} style={{ ...buttonStyle, backgroundColor: '#f0f0f0' }}>Cancel</button>\n                    <button onClick={confirmNewMap} style={{ ...buttonStyle, backgroundColor: '#4CAF50', color: 'white', borderColor: '#4CAF50' }}>Create</button>\n                </div>\n            </div>\n        </div>\n    );\n};\n","import React, { useState, useRef, useEffect } from 'react';\n\nexport const DraggableWindow = ({\n    title,\n    children,\n    defaultPosition = { x: 20, y: 20 },\n    defaultWidth = 280,\n    isOpenDefault = true,\n    onHeightChange\n}) => {\n    const [position] = useState(defaultPosition);\n    const [isDragging, setIsDragging] = useState(false);\n    const [dragOffset, setDragOffset] = useState({ x: 0, y: 0 });\n    const [currentPosition, setCurrentPosition] = useState(defaultPosition);\n    const [isMinimized, setIsMinimized] = useState(!isOpenDefault);\n    const [isClosed, setIsClosed] = useState(false);\n    const [hasBeenDragged, setHasBeenDragged] = useState(false);\n    const windowRef = useRef(null);\n\n    // Update position from parent when not dragged\n    useEffect(() => {\n        if (!hasBeenDragged) {\n            setCurrentPosition(defaultPosition);\n        }\n    }, [defaultPosition, hasBeenDragged]);\n\n    const lastHeightRef = useRef(0);\n\n    // Notify parent about height changes\n    useEffect(() => {\n        if (windowRef.current && onHeightChange) {\n            const height = windowRef.current.offsetHeight;\n            if (height !== lastHeightRef.current) {\n                lastHeightRef.current = height;\n                onHeightChange(height);\n            }\n        }\n    });\n\n    useEffect(() => {\n        if (isDragging) {\n            const handleMouseMove = (e) => {\n                setCurrentPosition({\n                    x: e.clientX - dragOffset.x,\n                    y: e.clientY - dragOffset.y\n                });\n            };\n\n            const handleMouseUp = () => {\n                setIsDragging(false);\n            };\n\n            document.addEventListener('mousemove', handleMouseMove);\n            document.addEventListener('mouseup', handleMouseUp);\n\n            return () => {\n                document.removeEventListener('mousemove', handleMouseMove);\n                document.removeEventListener('mouseup', handleMouseUp);\n            };\n        }\n    }, [isDragging, dragOffset]);\n\n    const handleMouseDown = (e) => {\n        if (windowRef.current) {\n            const rect = windowRef.current.getBoundingClientRect();\n            setDragOffset({\n                x: e.clientX - rect.left,\n                y: e.clientY - rect.top\n            });\n            setIsDragging(true);\n            setHasBeenDragged(true);\n        }\n    };\n\n    if (isClosed) return null;\n\n    return (\n        <div\n            ref={windowRef}\n            style={{\n                position: 'fixed',\n                left: currentPosition.x,\n                top: currentPosition.y,\n                width: defaultWidth,\n                backgroundColor: '#f8f8f8',\n                border: '1px solid #ccc',\n                borderRadius: '4px',\n                boxShadow: '0 2px 8px rgba(0,0,0,0.15)',\n                zIndex: 10,\n                display: 'flex',\n                flexDirection: 'column',\n                maxHeight: '80vh'\n            }}\n        >\n            {/* Window Header */}\n            <div\n                onMouseDown={handleMouseDown}\n                style={{\n                    padding: '8px 10px',\n                    backgroundColor: '#e0e0e0',\n                    borderTopLeftRadius: '4px',\n                    borderTopRightRadius: '4px',\n                    cursor: isDragging ? 'grabbing' : 'grab',\n                    fontWeight: 'bold',\n                    fontSize: '13px',\n                    display: 'flex',\n                    justifyContent: 'space-between',\n                    alignItems: 'center',\n                    userSelect: 'none',\n                    borderBottom: '1px solid #ccc'\n                }}\n            >\n                <span>{title}</span>\n                <div style={{ display: 'flex', gap: '4px' }}>\n                    <button\n                        onClick={(e) => {\n                            e.stopPropagation();\n                            setIsMinimized(!isMinimized);\n                        }}\n                        style={{\n                            background: '#ffc107',\n                            border: 'none',\n                            borderRadius: '2px',\n                            width: '18px',\n                            height: '18px',\n                            cursor: 'pointer',\n                            fontSize: '12px',\n                            display: 'flex',\n                            alignItems: 'center',\n                            justifyContent: 'center',\n                            padding: 0\n                        }}\n                        title={isMinimized ? \"Maximize\" : \"Minimize\"}\n                    >\n                        {isMinimized ? '' : ''}\n                    </button>\n                    <button\n                        onClick={(e) => {\n                            e.stopPropagation();\n                            setIsClosed(true);\n                        }}\n                        style={{\n                            background: '#f44336',\n                            border: 'none',\n                            borderRadius: '2px',\n                            width: '18px',\n                            height: '18px',\n                            cursor: 'pointer',\n                            color: '#fff',\n                            fontSize: '12px',\n                            display: 'flex',\n                            alignItems: 'center',\n                            justifyContent: 'center',\n                            padding: 0\n                        }}\n                        title=\"Close\"\n                    >\n                        \n                    </button>\n                </div>\n            </div>\n\n            {/* Window Content */}\n            {!isMinimized && (\n                <div\n                    style={{\n                        padding: '10px',\n                        overflowY: 'auto',\n                        flex: 1\n                    }}\n                >\n                    {children}\n                </div>\n            )}\n        </div>\n    );\n};\n","import React, { useState } from 'react';\n\nexport const PaletteSection = ({ title, children, isOpenDefault = false }) => {\n    const [isOpen, setIsOpen] = useState(isOpenDefault);\n    return (\n        <div style={{ marginBottom: '5px', border: '1px solid #ddd', borderRadius: '4px', backgroundColor: '#fff' }}>\n            <div onClick={() => setIsOpen(!isOpen)} style={{ padding: '8px', cursor: 'pointer', backgroundColor: '#f0f0f0', fontWeight: 'bold', fontSize: '12px', display: 'flex', justifyContent: 'space-between', alignItems: 'center', userSelect: 'none' }}>\n                <span>{title}</span><span>{isOpen ? '' : ''}</span>\n            </div>\n            {isOpen && <div style={{ padding: '8px', maxHeight: '200px', overflowY: 'auto' }}>{children}</div>}\n        </div>\n    );\n};\n","import React, { useRef, useEffect } from 'react';\n\nexport const Minimap = ({\n    mapWidth,\n    mapHeight,\n    tileMapData,\n    objectMapData,\n    objectMetadata,\n    registryItems\n}) => {\n    const canvasRef = useRef(null);\n    const minimapWidth = 250;\n    const minimapHeight = 200;\n\n    useEffect(() => {\n        const canvas = canvasRef.current;\n        if (!canvas) return;\n\n        const ctx = canvas.getContext('2d');\n        const tileWidth = minimapWidth / mapWidth;\n        const tileHeight = minimapHeight / mapHeight;\n\n        // Clear canvas\n        ctx.fillStyle = '#87CEEB';\n        ctx.fillRect(0, 0, minimapWidth, minimapHeight);\n\n        // Draw tiles\n        for (let y = 0; y < mapHeight; y++) {\n            for (let x = 0; x < mapWidth; x++) {\n                const index = y * mapWidth + x;\n                const tileId = tileMapData[index];\n                const objectId = objectMapData[index];\n\n                const px = x * tileWidth;\n                const py = y * tileHeight;\n\n                // Draw tile\n                if (tileId !== null) {\n                    const tile = registryItems.find(item => item.id === tileId);\n                    if (tile) {\n                        if (tile.flags?.liquid) {\n                            if (tile.flags.water) {\n                                ctx.fillStyle = '#2a5d8f';\n                            } else if (tile.flags.lava) {\n                                ctx.fillStyle = '#c43f0f';\n                            } else {\n                                ctx.fillStyle = '#888';\n                            }\n                        } else {\n                            // Solid block - darker color\n                            ctx.fillStyle = '#654321';\n                        }\n                        ctx.fillRect(px, py, Math.ceil(tileWidth), Math.ceil(tileHeight));\n                    }\n                }\n\n                // Draw object on top\n                if (objectId !== null) {\n                    const obj = registryItems.find(item => item.id === objectId);\n                    if (obj) {\n                        // Objects in bright colors\n                        if (obj.name?.startsWith('entities.')) {\n                            ctx.fillStyle = '#ff0000'; // Red for entities\n                        } else if (obj.name?.startsWith('item.')) {\n                            ctx.fillStyle = '#00ff00'; // Green for items\n                        } else if (obj.name?.startsWith('interactable.')) {\n                            ctx.fillStyle = '#ff00ff'; // Magenta for interactables\n                        } else if (obj.type === 'hazard') {\n                            ctx.fillStyle = '#ff8800'; // Orange for hazards\n                        } else {\n                            ctx.fillStyle = '#ffff00'; // Yellow for others\n                        }\n                        ctx.fillRect(px, py, Math.ceil(tileWidth), Math.ceil(tileHeight));\n                    }\n                }\n            }\n        }\n\n        // Draw grid\n        ctx.strokeStyle = 'rgba(255, 255, 255, 0.2)';\n        ctx.lineWidth = 0.5;\n        for (let x = 0; x <= mapWidth; x++) {\n            ctx.beginPath();\n            ctx.moveTo(x * tileWidth, 0);\n            ctx.lineTo(x * tileWidth, minimapHeight);\n            ctx.stroke();\n        }\n        for (let y = 0; y <= mapHeight; y++) {\n            ctx.beginPath();\n            ctx.moveTo(0, y * tileHeight);\n            ctx.lineTo(minimapWidth, y * tileHeight);\n            ctx.stroke();\n        }\n\n        // Draw connections between portals and targets\n        if (objectMetadata) {\n            const portals = [];\n            const targets = [];\n\n            for (let i = 0; i < mapWidth * mapHeight; i++) {\n                const id = objectMapData[i];\n                if (!id) continue;\n                const metadata = objectMetadata[i];\n                if (!metadata || metadata.triggerId === null || metadata.triggerId === undefined) continue;\n\n                const pos = {\n                    x: (i % mapWidth) * tileWidth + tileWidth / 2,\n                    y: Math.floor(i / mapWidth) * tileHeight + tileHeight / 2\n                };\n\n                if (id.includes('portal') && !id.includes('target')) {\n                    portals.push({ triggerId: metadata.triggerId, pos });\n                } else if (id.includes('target') || id === 'portal_target') {\n                    targets.push({ triggerId: metadata.triggerId, pos });\n                }\n            }\n\n            portals.forEach(portal => {\n                const target = targets.find(t => t.triggerId === portal.triggerId);\n                if (target) {\n                    ctx.beginPath();\n                    ctx.setLineDash([5, 3]);\n                    ctx.strokeStyle = '#fff';\n                    ctx.lineWidth = 2;\n                    ctx.moveTo(portal.pos.x, portal.pos.y);\n                    ctx.lineTo(target.pos.x, target.pos.y);\n                    ctx.stroke();\n                    ctx.setLineDash([]);\n                }\n            });\n        }\n\n    }, [mapWidth, mapHeight, tileMapData, objectMapData, objectMetadata, registryItems]);\n\n    return (\n        <canvas\n            ref={canvasRef}\n            width={minimapWidth}\n            height={minimapHeight}\n            style={{\n                width: '100%',\n                height: 'auto',\n                border: '1px solid #ccc',\n                borderRadius: '4px',\n                backgroundColor: '#87CEEB',\n                imageRendering: 'pixelated'\n            }}\n        />\n    );\n};\n","import React, { useState, useRef, useEffect } from 'react';\n\nexport const MapResizer = ({\n    mapWidth,\n    mapHeight,\n    onResize\n}) => {\n    const containerRef = useRef(null);\n    const [isDragging, setIsDragging] = useState(false);\n    const [startSize, setStartSize] = useState({ width: mapWidth, height: mapHeight });\n    const [startMousePos, setStartMousePos] = useState({ x: 0, y: 0 });\n\n    // Calculate display size (each block is represented by 10px)\n    const displayWidth = mapWidth * 10;\n    const displayHeight = mapHeight * 10;\n\n    const handleCornerMouseDown = (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        setIsDragging(true);\n        setStartSize({ width: mapWidth, height: mapHeight });\n        setStartMousePos({ x: e.clientX, y: e.clientY });\n    };\n\n    useEffect(() => {\n        if (!isDragging) return;\n\n        const handleMouseMove = (e) => {\n            const dx = e.clientX - startMousePos.x;\n            const dy = e.clientY - startMousePos.y;\n\n            // Each 10px of drag = 1 block\n            const blocksX = Math.round(dx / 10);\n            const blocksY = Math.round(dy / 10);\n\n            const newWidth = Math.max(5, Math.min(100, startSize.width + blocksX));\n            const newHeight = Math.max(5, Math.min(100, startSize.height + blocksY));\n\n            if (newWidth !== mapWidth || newHeight !== mapHeight) {\n                onResize(newWidth, newHeight);\n            }\n        };\n\n        const handleMouseUp = () => {\n            setIsDragging(false);\n        };\n\n        document.addEventListener('mousemove', handleMouseMove);\n        document.addEventListener('mouseup', handleMouseUp);\n\n        return () => {\n            document.removeEventListener('mousemove', handleMouseMove);\n            document.removeEventListener('mouseup', handleMouseUp);\n        };\n    }, [isDragging, startMousePos, startSize, mapWidth, mapHeight, onResize]);\n\n    return (\n        <div style={{ display: 'flex', flexDirection: 'column', gap: '10px' }}>\n            <div style={{ fontSize: '14px', fontWeight: 'bold', textAlign: 'center' }}>\n                Map Size: <span style={{ color: '#4CAF50' }}>{mapWidth}  {mapHeight}</span> blocks\n            </div>\n\n            <div\n                ref={containerRef}\n                style={{\n                    position: 'relative',\n                    width: displayWidth + 'px',\n                    height: displayHeight + 'px',\n                    border: '2px solid #4CAF50',\n                    backgroundColor: '#e8f5e9',\n                    borderRadius: '4px',\n                    display: 'flex',\n                    alignItems: 'center',\n                    justifyContent: 'center',\n                    fontSize: '12px',\n                    color: '#2e7d32',\n                    fontWeight: 'bold',\n                    userSelect: 'none',\n                    minWidth: '50px',\n                    minHeight: '50px'\n                }}\n            >\n                {mapWidth}  {mapHeight}\n\n                {/* Resize handle - bottom right corner */}\n                <div\n                    onMouseDown={handleCornerMouseDown}\n                    style={{\n                        position: 'absolute',\n                        bottom: -5,\n                        right: -5,\n                        width: '15px',\n                        height: '15px',\n                        backgroundColor: '#4CAF50',\n                        cursor: 'nwse-resize',\n                        borderRadius: '50%',\n                        border: '2px solid #fff',\n                        boxShadow: '0 2px 4px rgba(0,0,0,0.2)',\n                        zIndex: 10\n                    }}\n                />\n            </div>\n\n            <div style={{ fontSize: '11px', color: '#666', textAlign: 'center' }}>\n                 Drag the corner to resize the map<br/>\n                (Min: 55, Max: 100100)\n            </div>\n        </div>\n    );\n};\n","import React, { useState, useEffect, useCallback, useMemo } from 'react';\nimport { DraggableWindow } from './DraggableWindow';\nimport { PaletteSection } from './PaletteSection';\nimport { Minimap } from './Minimap';\nimport { MapResizer } from './MapResizer';\nimport AnimatedItem from '../../../utilities/AnimatedItem';\nimport BackgroundMusicPlayer from '../../../utilities/BackgroundMusicPlayer';\nimport { buttonStyle, activeButtonStyle } from './constants';\n\nexport const ToolbarWindows = ({\n    mapName,\n    creatorName,\n    openNewMapModal,\n    saveMap,\n    loadMap,\n    showGrid,\n    setShowGrid,\n    clearMap,\n    isPlayMode,\n    handlePlay,\n    handlePause,\n    handleReset,\n    activeTool,\n    setActiveTool,\n    brushSize,\n    setBrushSize,\n    activeLayer,\n    selection,\n    moveSelection,\n    setSelection,\n    selectionMode,\n    setSelectionMode,\n    commitSelection,\n    cancelSelection,\n    selectedTile,\n    handlePaletteSelect,\n    blocks,\n    liquids,\n    entities,\n    items,\n    decorations,\n    interactables,\n    hazards,\n    secrets,\n    backgroundOptions,\n    selectedBackgroundImage,\n    setSelectedBackgroundImage,\n    selectedBackgroundColor,\n    setSelectedBackgroundColor,\n    backgroundParallaxFactor,\n    setBackgroundParallaxFactor,\n    musicOptions,\n    selectedBackgroundMusic,\n    setSelectedBackgroundMusic,\n    totalTiles,\n    filledBlocks,\n    emptyBlocks,\n    objectsCount,\n    mapWidth,\n    mapHeight,\n    tileMapData,\n    objectMapData,\n    objectMetadata,\n    setObjectMetadata,\n    registryItems,\n    onMapResize,\n    highlightedIndex,\n    setHighlightedIndex\n}) => {\n    const [activePanel, setActivePanel] = useState(null); // 'map', 'tools', 'palette', 'bg', 'stats', 'props'\n    const [isMinimapOpen, setIsMinimapOpen] = useState(false);\n    const [isSettingsOpen, setIsSettingsOpen] = useState(false);\n    const [isResizeWindowOpen, setIsResizeWindowOpen] = useState(false);\n\n    const togglePanel = (panel) => {\n        setActivePanel(prev => prev === panel ? null : panel);\n    };\n\n    const sidebarButtonStyle = {\n        width: '40px',\n        height: '40px',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        cursor: 'pointer',\n        backgroundColor: '#333',\n        color: '#fff',\n        border: '1px solid #444',\n        borderRadius: '4px',\n        marginBottom: '10px',\n        fontSize: '20px',\n        transition: 'all 0.2s ease',\n        boxShadow: '0 2px 4px rgba(0,0,0,0.2)'\n    };\n\n    const activeSidebarButtonStyle = {\n        ...sidebarButtonStyle,\n        backgroundColor: '#2196F3',\n        borderColor: '#1E88E5',\n        transform: 'scale(1.05)'\n    };\n\n    const panelStyle = {\n        position: 'absolute',\n        top: 0,\n        left: '60px',\n        width: '320px',\n        height: '100%',\n        backgroundColor: '#fff',\n        boxShadow: '2px 0 10px rgba(0,0,0,0.2)',\n        zIndex: 100,\n        display: 'flex',\n        flexDirection: 'column',\n        borderRight: '1px solid #ddd',\n        overflowY: 'auto',\n        padding: '20px',\n        boxSizing: 'border-box'\n    };\n\n    const rightSidebarStyle = {\n        position: 'absolute',\n        top: '20px',\n        right: '20px',\n        display: 'flex',\n        flexDirection: 'column',\n        gap: '10px',\n        zIndex: 101\n    };\n\n    const panelHeaderStyle = {\n        display: 'flex',\n        justifyContent: 'space-between',\n        alignItems: 'center',\n        marginBottom: '15px',\n        borderBottom: '2px solid #eee',\n        paddingBottom: '10px'\n    };\n\n    const panelTitleStyle = {\n        margin: 0,\n        fontSize: '18px',\n        fontWeight: 'bold',\n        color: '#333'\n    };\n    const renderPaletteItem = (item, color, layer) => {\n        const hasImage = !!(item.texture || (Array.isArray(item.textures) && item.textures.length > 0));\n        const editorIcon = item.editorIcon;\n        const isLiquid = !!(item.flags && item.flags.liquid);\n        const isWater = !!(item.flags && item.flags.water);\n        const isLava = !!(item.flags && item.flags.lava);\n        const isSecret = item.type === 'secret';\n        const swatchStyle = isWater\n            ? { background: 'linear-gradient(180deg,#2a5d8f,#174369)' }\n            : (isLava ? { background: 'linear-gradient(180deg,#6b1a07,#c43f0f)' } : { background: '#eee' });\n\n        return (\n            <div\n                key={item.id}\n                onClick={() => handlePaletteSelect(item, layer)}\n                title={item.name}\n                style={{\n                    border: selectedTile?.id === item.id ? `2px solid ${color}` : '1px solid #ccc',\n                    cursor: 'pointer', padding: '2px', width: '36px', height: '36px',\n                    display: 'flex', alignItems: 'center', justifyContent: 'center', backgroundColor: '#fff',\n                    position: 'relative'\n                }}\n            >\n                {isSecret ? (\n                    <div style={{\n                        width: '100%', height: '100%', borderRadius: 2,\n                        display: 'flex', alignItems: 'center', justifyContent: 'center',\n                        background: item.filterColor || 'rgba(0, 0, 0, 0.5)',\n                        color: '#fff', fontSize: 8, textAlign: 'center', lineHeight: 1.1, fontWeight: 'bold'\n                    }}>\n                        {item.subtype === 'above' ? 'ABOVE' : 'BELOW'}\n                    </div>\n                ) : editorIcon ? (\n                    <div style={{ fontSize: '24px', fontWeight: 'bold', color: '#333' }}>\n                        {editorIcon}\n                    </div>\n                ) : hasImage ? (\n                    <AnimatedItem\n                        textures={item.textures}\n                        texture={item.texture}\n                        speed={item.animationSpeed}\n                        spriteSheet={item.spriteSheet}\n                        style={{ maxWidth: '100%', maxHeight: '100%', objectFit: 'contain' }}\n                        alt={item.name}\n                    />\n                ) : (\n                    <div style={{\n                        width: '100%', height: '100%', borderRadius: 2,\n                        display: 'flex', alignItems: 'center', justifyContent: 'center', color: '#fff',\n                        fontSize: 10, textAlign: 'center', lineHeight: 1.1,\n                        ...swatchStyle\n                    }}>\n                        {isLiquid ? (isWater ? 'WATER' : (isLava ? 'LAVA' : 'LIQ')) : (item.name || '')}\n                    </div>\n                )}\n            </div>\n        );\n    };\n\n    const BlockEraser = () => (\n        <div onClick={() => { handlePaletteSelect(null, 'tile'); }} title=\"Erase Blocks (Background)\"\n            style={{\n                border: (selectedTile === null && activeLayer === 'tile') ? `2px solid blue` : '1px solid #ccc',\n                cursor: 'pointer', padding: '2px', width: '36px', height: '36px',\n                display: 'flex', alignItems: 'center', justifyContent: 'center',\n                backgroundColor: '#f0f8ff', fontSize: '16px', color: 'blue'\n            }}>\n            B\n        </div>\n    );\n\n    const ObjectEraser = () => (\n        <div onClick={() => { handlePaletteSelect(null, 'object'); }} title=\"Erase Objects (Entities/Items)\"\n            style={{\n                border: (selectedTile === null && activeLayer === 'object') ? `2px solid red` : '1px solid #ccc',\n                cursor: 'pointer', padding: '2px', width: '36px', height: '36px',\n                display: 'flex', alignItems: 'center', justifyContent: 'center',\n                backgroundColor: '#fff0f0', fontSize: '16px', color: 'red'\n            }}>\n            O\n        </div>\n    );\n\n    const SecretEraser = () => (\n        <div onClick={() => { handlePaletteSelect(null, 'secret'); }} title=\"Erase Secrets\"\n            style={{\n                border: (selectedTile === null && activeLayer === 'secret') ? `2px solid purple` : '1px solid #ccc',\n                cursor: 'pointer', padding: '2px', width: '36px', height: '36px',\n                display: 'flex', alignItems: 'center', justifyContent: 'center',\n                backgroundColor: '#f8f0ff', fontSize: '16px', color: 'purple'\n            }}>\n            S\n        </div>\n    );\n\n\n    return (\n        <div style={{ display: 'contents' }}>\n            {/* Sidebar Left */}\n            <div style={{\n                width: '60px',\n                height: '100%',\n                backgroundColor: '#222',\n                display: 'flex',\n                flexDirection: 'column',\n                alignItems: 'center',\n                paddingTop: '20px',\n                zIndex: 102,\n                borderRight: '1px solid #000',\n                flexShrink: 0\n            }}>\n                <div onClick={() => togglePanel('map')} style={activePanel === 'map' ? activeSidebarButtonStyle : sidebarButtonStyle} title=\"Map Controls\"></div>\n                <div onClick={() => togglePanel('tools')} style={activePanel === 'tools' ? activeSidebarButtonStyle : sidebarButtonStyle} title=\"Tools\"></div>\n                <div onClick={() => togglePanel('palette')} style={activePanel === 'palette' ? activeSidebarButtonStyle : sidebarButtonStyle} title=\"Palette\"></div>\n                <div onClick={() => togglePanel('bg')} style={activePanel === 'bg' ? activeSidebarButtonStyle : sidebarButtonStyle} title=\"Background & Music\"></div>\n                <div onClick={() => togglePanel('stats')} style={activePanel === 'stats' ? activeSidebarButtonStyle : sidebarButtonStyle} title=\"Statistics\"></div>\n                <div onClick={() => togglePanel('props')} style={activePanel === 'props' ? activeSidebarButtonStyle : sidebarButtonStyle} title=\"Object Properties\"></div>\n            </div>\n\n            {/* Panels */}\n            {activePanel === 'map' && (\n                <div style={panelStyle}>\n                    <div style={panelHeaderStyle}>\n                        <h3 style={panelTitleStyle}>Map Controls</h3>\n                        <button onClick={() => setActivePanel(null)} style={{ ...buttonStyle, margin: 0 }}></button>\n                    </div>\n                    <div style={{ display: 'flex', flexDirection: 'column', gap: '15px' }}>\n                        <div style={{ padding: '10px', backgroundColor: '#f9f9f9', borderRadius: '4px', border: '1px solid #ddd' }}>\n                            <div style={{ fontSize: '13px', marginBottom: '5px' }}>Map: <strong>{mapName}</strong></div>\n                            <div style={{ fontSize: '13px' }}>Author: <strong>{creatorName}</strong></div>\n                        </div>\n\n                        <div style={{ display: 'flex', flexWrap: 'wrap', gap: '8px' }}>\n                            <button onClick={openNewMapModal} style={{ ...buttonStyle, backgroundColor: '#4CAF50', color: '#fff', borderColor: '#388E3C', flex: '1' }}>New</button>\n                            <button onClick={saveMap} style={{ ...buttonStyle, flex: '1' }}>Save</button>\n                            <label style={{ ...buttonStyle, flex: '1' }}>Load <input type=\"file\" accept=\".json,.txt\" onChange={loadMap} style={{ display: 'none' }} /></label>\n                        </div>\n                        \n                        <div style={{ display: 'flex', flexWrap: 'wrap', gap: '8px' }}>\n                            <button onClick={() => setIsResizeWindowOpen(!isResizeWindowOpen)} style={{ ...(isResizeWindowOpen ? activeButtonStyle : buttonStyle), flex: '1' }} title=\"Resize Map\"> Resize</button>\n                            <button onClick={() => setShowGrid(!showGrid)} style={{ ...(showGrid ? activeButtonStyle : buttonStyle), flex: '1' }}>{showGrid ? 'Hide Grid' : 'Show Grid'} #</button>\n                            <button onClick={clearMap} style={{ ...buttonStyle, color: 'red', flex: '1' }} title=\"Clear Map\"> Clear</button>\n                        </div>\n\n                        <div style={{ borderTop: '2px solid #eee', paddingTop: '15px', marginTop: '5px' }}>\n                            <div style={{ fontSize: '14px', fontWeight: 'bold', marginBottom: '10px' }}>PLAY MODE</div>\n                            <div style={{ display: 'flex', gap: '8px' }}>\n                                {!isPlayMode ? (\n                                    <button onClick={handlePlay} style={{ ...buttonStyle, backgroundColor: '#4CAF50', color: '#fff', borderColor: '#388E3C', flex: '1', height: '40px', fontSize: '16px' }} title=\"Play from current position\"> Play</button>\n                                ) : (\n                                    <>\n                                        <button onClick={handlePause} style={{ ...buttonStyle, backgroundColor: '#FF9800', color: '#fff', borderColor: '#F57C00', flex: '1', height: '40px' }} title=\"Pause and return to editor\"> Pause</button>\n                                        <button onClick={handleReset} style={{ ...buttonStyle, backgroundColor: '#2196F3', color: '#fff', borderColor: '#1976D2', flex: '1', height: '40px' }} title=\"Reset collected objects\"> Reset</button>\n                                    </>\n                                )}\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            )}\n\n            {activePanel === 'tools' && (\n                <div style={panelStyle}>\n                    <div style={panelHeaderStyle}>\n                        <h3 style={panelTitleStyle}>Tools & Erase</h3>\n                        <button onClick={() => setActivePanel(null)} style={{ ...buttonStyle, margin: 0 }}></button>\n                    </div>\n                    {isPlayMode ? (\n                        <div style={{ padding: '20px', fontSize: '14px', color: '#666', textAlign: 'center', backgroundColor: '#f9f9f9', borderRadius: '8px' }}>\n                            Tools disabled during Play mode\n                        </div>\n                    ) : (\n                        <div style={{ display: 'flex', flexDirection: 'column', gap: '20px' }}>\n                            <section>\n                                <span style={{ fontSize: '12px', fontWeight: 'bold', display: 'block', marginBottom: '10px', color: '#555' }}>DRAWING TOOLS</span>\n                                <div style={{ display: 'flex', gap: '10px' }}>\n                                    <button onClick={() => setActiveTool('brush')} style={{ ...(activeTool === 'brush' ? activeButtonStyle : buttonStyle), width: '40px', height: '40px', fontSize: '20px', margin: 0 }}></button>\n                                    <button onClick={() => setActiveTool('bucket')} style={{ ...(activeTool === 'bucket' ? activeButtonStyle : buttonStyle), width: '40px', height: '40px', fontSize: '20px', margin: 0 }}></button>\n                                    <button onClick={() => setActiveTool('move')} style={{ ...(activeTool === 'move' ? activeButtonStyle : buttonStyle), width: '40px', height: '40px', fontSize: '20px', margin: 0 }}></button>\n                                </div>\n                            </section>\n\n                            {activeTool === 'brush' && (\n                                <section style={{ backgroundColor: '#f9f9f9', padding: '10px', borderRadius: '6px' }}>\n                                    <span style={{ fontSize: '12px', fontWeight: 'bold', display: 'block', marginBottom: '10px' }}>BRUSH SIZE</span>\n                                    <div style={{ display: 'flex', gap: '5px' }}>\n                                        {[1, 2, 3, 4, 5].map(size => (\n                                            <button key={size} onClick={() => setBrushSize(size)}\n                                                style={{ ...(brushSize === size ? activeButtonStyle : buttonStyle), padding: '0 10px', minWidth: '35px', height: '35px' }}>\n                                                {size}\n                                            </button>\n                                        ))}\n                                    </div>\n                                </section>\n                            )}\n\n                            <section style={{ padding: '10px', backgroundColor: activeLayer === 'tile' ? '#e6f7ff' : (activeLayer === 'object' ? '#fff1f0' : '#f8f0ff'), borderRadius: '6px', border: '1px solid #ccc' }}>\n                                <span style={{ fontSize: '13px' }}>Active Layer: <strong>{activeLayer === 'tile' ? ' Background' : (activeLayer === 'object' ? ' Objects' : ' Secrets')}</strong></span>\n                            </section>\n\n                            {activeTool === 'move' && (\n                                <section style={{ backgroundColor: '#fffbe6', padding: '10px', borderRadius: '6px', border: '1px solid #ffe58f' }}>\n                                    <span style={{ fontSize: '12px', fontWeight: 'bold', display: 'block', marginBottom: '10px' }}>SELECTION MODE</span>\n                                    <div style={{ display: 'flex', gap: '8px' }}>\n                                        <button onClick={() => setSelectionMode('cut')} style={{ ...(selectionMode === 'cut' ? activeButtonStyle : buttonStyle), flex: 1 }}> Cut</button>\n                                        <button onClick={() => setSelectionMode('copy')} style={{ ...(selectionMode === 'copy' ? activeButtonStyle : buttonStyle), flex: 1 }}> Copy</button>\n                                    </div>\n                                </section>\n                            )}\n\n                            {activeTool === 'move' && selection && (\n                                <section style={{ padding: '12px', backgroundColor: '#fff3cd', borderRadius: '6px', border: '1px solid #ffc107' }}>\n                                    <span style={{ fontSize: '13px', display: 'block', marginBottom: '8px', fontWeight: 'bold' }}>Selection Active</span>\n                                    <div style={{ fontSize: '11px', marginBottom: '10px', lineHeight: '1.4' }}>\n                                         Drag with mouse or use arrows<br/>\n                                         Press <strong>Enter</strong> to confirm<br/>\n                                         Press <strong>Esc</strong> to cancel\n                                    </div>\n                                    <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', gap: '5px' }}>\n                                        <button onClick={() => moveSelection(0, -1)} style={{ ...buttonStyle, margin: 0 }}></button>\n                                        <div style={{ display: 'flex', gap: '5px' }}>\n                                            <button onClick={() => moveSelection(-1, 0)} style={{ ...buttonStyle, margin: 0 }}></button>\n                                            <button onClick={() => moveSelection(1, 0)} style={{ ...buttonStyle, margin: 0 }}></button>\n                                        </div>\n                                        <button onClick={() => moveSelection(0, 1)} style={{ ...buttonStyle, margin: 0 }}></button>\n                                    </div>\n                                    <div style={{ display: 'flex', gap: '8px', marginTop: '15px' }}>\n                                        <button onClick={commitSelection} style={{ ...buttonStyle, backgroundColor: '#28a745', color: '#fff', flex: 1, height: '35px' }}> Confirm</button>\n                                        <button onClick={cancelSelection} style={{ ...buttonStyle, backgroundColor: '#dc3545', color: '#fff', flex: 1, height: '35px' }}> Cancel</button>\n                                    </div>\n                                </section>\n                            )}\n\n                            <section>\n                                <span style={{ fontSize: '12px', fontWeight: 'bold', display: 'block', marginBottom: '10px', color: '#555' }}>ERASERS</span>\n                                <div style={{ display: 'flex', gap: '8px' }}>\n                                    <BlockEraser />\n                                    <ObjectEraser />\n                                    <SecretEraser />\n                                </div>\n                            </section>\n                        </div>\n                    )}\n                </div>\n            )}\n\n            {activePanel === 'palette' && (\n                <div style={panelStyle}>\n                    <div style={panelHeaderStyle}>\n                        <h3 style={panelTitleStyle}>Palette</h3>\n                        <button onClick={() => setActivePanel(null)} style={{ ...buttonStyle, margin: 0 }}></button>\n                    </div>\n                    {isPlayMode ? (\n                        <div style={{ padding: '20px', fontSize: '14px', color: '#666', textAlign: 'center', backgroundColor: '#f9f9f9', borderRadius: '8px' }}>\n                            Palette disabled during Play mode\n                        </div>\n                    ) : (\n                        <div style={{ display: 'flex', flexDirection: 'column', gap: '10px' }}>\n                            <PaletteSection title=\"Blocks (Background)\" isOpenDefault={true}>\n                                <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                                    {blocks.map(b => renderPaletteItem(b, 'blue', 'tile'))}\n                                </div>\n                            </PaletteSection>\n\n                            <PaletteSection title=\"Liquids (Blocks)\" isOpenDefault={false}>\n                                <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                                    {liquids.map(li => renderPaletteItem(li, 'blue', 'tile'))}\n                                </div>\n                            </PaletteSection>\n\n                            <PaletteSection title=\"Entities (Objects)\" isOpenDefault={true}>\n                                <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                                    {entities.map(e => renderPaletteItem(e, 'red', 'object'))}\n                                </div>\n                            </PaletteSection>\n\n                            <PaletteSection title=\"Decorations\" isOpenDefault={true}>\n                                <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                                    {decorations && decorations.map(d => renderPaletteItem(d, 'purple', 'object'))}\n                                </div>\n                            </PaletteSection>\n\n                            <PaletteSection title=\"Items (Objects)\" isOpenDefault={true}>\n                                <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                                    {items.map(i => renderPaletteItem(i, 'green', 'object'))}\n                                </div>\n                            </PaletteSection>\n\n                            <PaletteSection title=\"Interactables\" isOpenDefault={true}>\n                                <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                                    {interactables.map(i => renderPaletteItem(i, 'purple', 'object'))}\n                                </div>\n                            </PaletteSection>\n\n                            <PaletteSection title=\"Hazards\" isOpenDefault={true}>\n                                <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                                    {hazards.map(h => renderPaletteItem(h, 'orange', 'object'))}\n                                </div>\n                            </PaletteSection>\n\n                            <PaletteSection title=\"Secrets\" isOpenDefault={false}>\n                                <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                                    {secrets && secrets.map(s => renderPaletteItem(s, 'purple', 'secret'))}\n                                </div>\n                            </PaletteSection>\n                        </div>\n                    )}\n                </div>\n            )}\n\n            {activePanel === 'bg' && (\n                <div style={panelStyle}>\n                    <div style={panelHeaderStyle}>\n                        <h3 style={panelTitleStyle}>Background & Music</h3>\n                        <button onClick={() => setActivePanel(null)} style={{ ...buttonStyle, margin: 0 }}></button>\n                    </div>\n                    <div style={{ display: 'flex', flexDirection: 'column', gap: '20px' }}>\n                        <section>\n                            <span style={{ fontSize: '13px', fontWeight: 'bold', display: 'block', marginBottom: '12px' }}>Background Image</span>\n                            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '10px' }}>\n                                <div onClick={() => setSelectedBackgroundImage(null)}\n                                    style={{\n                                        border: selectedBackgroundImage ? '1px solid #ccc' : '2px solid #2196F3',\n                                        borderRadius: '6px', padding: '4px', cursor: 'pointer', background: '#fff',\n                                        boxShadow: !selectedBackgroundImage ? '0 0 8px rgba(33, 150, 243, 0.3)' : 'none'\n                                    }}\n                                    title=\"Solid Color\">\n                                    <div style={{ width: '100%', height: '60px', background: selectedBackgroundColor, display: 'block', borderRadius: '4px' }} />\n                                    <div style={{ fontSize: '11px', textAlign: 'center', paddingTop: '5px', fontWeight: !selectedBackgroundImage ? 'bold' : 'normal' }}>Solid Color</div>\n                                </div>\n                                {backgroundOptions.map((bg) => (\n                                    <div key={bg.name} onClick={() => setSelectedBackgroundImage(bg.metaPath)}\n                                        style={{\n                                            border: selectedBackgroundImage === bg.metaPath ? '2px solid #2196F3' : '1px solid #ccc',\n                                            borderRadius: '6px', padding: '4px', cursor: 'pointer', background: '#fff',\n                                            boxShadow: selectedBackgroundImage === bg.metaPath ? '0 0 8px rgba(33, 150, 243, 0.3)' : 'none'\n                                        }}\n                                        title={bg.name}>\n                                        <img src={bg.src} alt={bg.name} style={{ width: '100%', height: '60px', objectFit: 'cover', display: 'block', borderRadius: '4px' }} />\n                                        <div style={{ fontSize: '11px', textAlign: 'center', paddingTop: '5px', fontWeight: selectedBackgroundImage === bg.metaPath ? 'bold' : 'normal' }}>{bg.name}</div>\n                                    </div>\n                                ))}\n                            </div>\n                        </section>\n\n                        <section style={{ backgroundColor: '#f9f9f9', padding: '15px', borderRadius: '8px', border: '1px solid #ddd' }}>\n                            <div style={{ marginBottom: '15px' }}>\n                                <label style={{ fontSize: '13px', fontWeight: 'bold', display: 'block', marginBottom: '8px' }}>Parallax Effect:</label>\n                                <div style={{ display: 'flex', alignItems: 'center', gap: '10px' }}>\n                                    <input type=\"range\" min=\"0\" max=\"1\" step=\"0.05\" value={backgroundParallaxFactor}\n                                        onChange={(e) => setBackgroundParallaxFactor(parseFloat(e.target.value))}\n                                        style={{ flex: 1 }} />\n                                    <span style={{ fontSize: '13px', fontWeight: 'bold', minWidth: '35px' }}>{backgroundParallaxFactor.toFixed(2)}</span>\n                                </div>\n                            </div>\n                            <div>\n                                <label style={{ fontSize: '13px', fontWeight: 'bold', display: 'block', marginBottom: '8px' }}>Background Color:</label>\n                                <div style={{ display: 'flex', alignItems: 'center', gap: '10px' }}>\n                                    <input type=\"color\" value={selectedBackgroundColor}\n                                        onChange={(e) => setSelectedBackgroundColor(e.target.value)}\n                                        style={{ width: '40px', height: '40px', border: 'none', padding: 0, cursor: 'pointer' }} />\n                                    <span style={{ fontSize: '13px', fontFamily: 'monospace' }}>{selectedBackgroundColor.toUpperCase()}</span>\n                                </div>\n                            </div>\n                        </section>\n\n                        <section style={{ borderTop: '2px solid #eee', paddingTop: '15px' }}>\n                            <span style={{ fontSize: '13px', fontWeight: 'bold', display: 'block', marginBottom: '10px' }}>Background Music</span>\n                            <select\n                                value={selectedBackgroundMusic || ''}\n                                onChange={(e) => setSelectedBackgroundMusic(e.target.value || null)}\n                                style={{ width: '100%', padding: '10px', borderRadius: '6px', border: '1px solid #ccc', fontSize: '13px', marginBottom: '10px' }}>\n                                <option value=\"\"> No Music </option>\n                                {musicOptions.map(m => (\n                                    <option key={m.name} value={m.metaPath}>{m.name}</option>\n                                ))}\n                            </select>\n                            <BackgroundMusicPlayer metaPath={selectedBackgroundMusic} enabled={true} volume={0.4} />\n                            <div style={{ fontSize: '12px', color: '#666', fontStyle: 'italic' }}>\n                                Status: {selectedBackgroundMusic ? 'Music selected' : 'Silence'}\n                            </div>\n                        </section>\n                    </div>\n                </div>\n            )}\n\n            {activePanel === 'stats' && (\n                <div style={panelStyle}>\n                    <div style={panelHeaderStyle}>\n                        <h3 style={panelTitleStyle}>Statistics</h3>\n                        <button onClick={() => setActivePanel(null)} style={{ ...buttonStyle, margin: 0 }}></button>\n                    </div>\n                    <div style={{ display: 'flex', flexDirection: 'column', gap: '12px' }}>\n                        <div style={{ padding: '15px', backgroundColor: '#e6f7ff', borderRadius: '8px', border: '1px solid #91d5ff' }}>\n                            <div style={{ fontSize: '14px', marginBottom: '8px' }}>Total Map Area: <strong>{totalTiles}</strong> tiles</div>\n                            <div style={{ fontSize: '13px', color: '#0050b3' }}>Dimensions: {mapWidth} x {mapHeight}</div>\n                        </div>\n                        <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '10px' }}>\n                            <div style={{ padding: '12px', backgroundColor: '#f6ffed', borderRadius: '8px', border: '1px solid #b7eb8f', textAlign: 'center' }}>\n                                <div style={{ fontSize: '20px', fontWeight: 'bold', color: '#389e0d' }}>{filledBlocks}</div>\n                                <div style={{ fontSize: '11px', color: '#555' }}>FILLED BLOCKS</div>\n                            </div>\n                            <div style={{ padding: '12px', backgroundColor: '#fff7e6', borderRadius: '8px', border: '1px solid #ffd591', textAlign: 'center' }}>\n                                <div style={{ fontSize: '20px', fontWeight: 'bold', color: '#d46b08' }}>{objectsCount}</div>\n                                <div style={{ fontSize: '11px', color: '#555' }}>OBJECTS</div>\n                            </div>\n                        </div>\n                        <div style={{ padding: '12px', backgroundColor: '#f9f9f9', borderRadius: '8px', border: '1px solid #ddd', textAlign: 'center' }}>\n                                <div style={{ fontSize: '20px', fontWeight: 'bold', color: '#666' }}>{emptyBlocks}</div>\n                                <div style={{ fontSize: '11px', color: '#555' }}>EMPTY SPACE</div>\n                        </div>\n                    </div>\n                </div>\n            )}\n\n            {activePanel === 'props' && (\n                <div style={panelStyle}>\n                    <div style={panelHeaderStyle}>\n                        <h3 style={{ margin: 0 }}>Object Properties</h3>\n                        <div onClick={() => setActivePanel(null)} style={{ cursor: 'pointer' }}></div>\n                    </div>\n                    <div style={{ padding: '10px 0' }}>\n                        <p style={{ fontSize: '12px', color: '#666', lineHeight: '1.4' }}>\n                            Configure triggers for Portals and Targets.\n                            <br />\n                            <strong>1.</strong> Place a <strong>Portal</strong> and a <strong>Portal Target</strong> from the palette.\n                            <br />\n                            <strong>2.</strong> Link them by giving them the <strong>same Trigger ID</strong> here.\n                            <br />\n                            <i style={{ fontSize: '11px' }}>* Tip: You can see visual links between them in the editor and minimap.</i>\n                        </p>\n                        <div style={{ maxHeight: 'calc(100vh - 200px)', overflowY: 'auto' }}>\n                            {objectMapData.map((id, index) => {\n                                if (!id) return null;\n                                const def = registryItems.find(r => r.id === id);\n                                if (!def || (!id.includes('portal') && !id.includes('target') && id !== 'portal_target')) return null;\n\n                                const x = index % mapWidth;\n                                const y = Math.floor(index / mapWidth);\n                                const metadata = objectMetadata[index] || {};\n                                const isHighlighted = highlightedIndex === index;\n\n                                return (\n                                    <div key={index} \n                                        onMouseEnter={() => setHighlightedIndex(index)}\n                                        onMouseLeave={() => setHighlightedIndex(null)}\n                                        style={{\n                                            padding: '10px',\n                                            border: isHighlighted ? '1px solid gold' : '1px solid #eee',\n                                            display: 'flex',\n                                            flexDirection: 'column',\n                                            gap: '5px',\n                                            backgroundColor: isHighlighted ? '#fffde7' : '#f9f9f9',\n                                            marginBottom: '5px',\n                                            borderRadius: '4px',\n                                            transition: 'all 0.2s ease'\n                                        }}\n                                    >\n                                        <div style={{ fontWeight: 'bold', fontSize: '13px', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\n                                            <span style={{ display: 'flex', alignItems: 'center', gap: '5px' }}>\n                                                {id.includes('portal') && !id.includes('target') ? '' : ''} {def.name}\n                                            </span>\n                                            <div style={{ display: 'flex', gap: '5px', alignItems: 'center' }}>\n                                                <span style={{ color: '#666', fontSize: '11px' }}>({x}, {y})</span>\n                                                <button \n                                                    onClick={() => {\n                                                        const el = document.querySelector(`.viewport`);\n                                                        if (el) {\n                                                            const scrollX = x * 32 - el.clientWidth / 2 + 16;\n                                                            const scrollY = y * 32 - el.clientHeight / 2 + 16;\n                                                            el.scrollTo({ left: scrollX, top: scrollY, behavior: 'smooth' });\n                                                        }\n                                                    }}\n                                                    style={{ \n                                                        padding: '2px 6px', fontSize: '10px', cursor: 'pointer',\n                                                        backgroundColor: '#eee', border: '1px solid #ccc', borderRadius: '3px'\n                                                    }}\n                                                    title=\"Scroll to this object\"\n                                                >\n                                                    Locate\n                                                </button>\n                                            </div>\n                                        </div>\n                                        <div style={{ display: 'flex', alignItems: 'center', gap: '10px' }}>\n                                            <label style={{ fontSize: '12px', fontWeight: 'bold' }}>Trigger ID:</label>\n                                            <input\n                                                type=\"number\"\n                                                value={metadata.triggerId || ''}\n                                                onChange={(e) => {\n                                                    const val = parseInt(e.target.value);\n                                                    setObjectMetadata(prev => ({\n                                                        ...prev,\n                                                        [index]: { ...prev[index], triggerId: isNaN(val) ? null : val }\n                                                    }));\n                                                }}\n                                                style={{\n                                                    flex: 1,\n                                                    padding: '4px 8px',\n                                                    border: '1px solid #ccc',\n                                                    borderRadius: '4px',\n                                                    fontSize: '13px',\n                                                    backgroundColor: isHighlighted ? '#fff' : '#f0f0f0'\n                                                }}\n                                                placeholder=\"Enter ID (e.g. 1)\"\n                                            />\n                                        </div>\n                                    </div>\n                                );\n                            })}\n                            {objectMapData.filter(id => id && (id.includes('portal') || id.includes('target'))).length === 0 && (\n                                <p style={{ textAlign: 'center', color: '#999', marginTop: '20px', fontSize: '14px' }}>\n                                    No portals or targets found on map.\n                                </p>\n                            )}\n                        </div>\n                    </div>\n                </div>\n            )}\n\n            {/* Right side buttons */}\n            <div style={rightSidebarStyle}>\n                <div onClick={() => setIsMinimapOpen(!isMinimapOpen)} style={isMinimapOpen ? activeSidebarButtonStyle : sidebarButtonStyle} title=\"Minimap\"></div>\n                <div onClick={() => setIsSettingsOpen(!isSettingsOpen)} style={isSettingsOpen ? activeSidebarButtonStyle : sidebarButtonStyle} title=\"Settings\"></div>\n            </div>\n\n            {/* Floating Windows (Minimap / Settings) */}\n            {isMinimapOpen && (\n                <DraggableWindow\n                    title=\"Minimap\"\n                    defaultPosition={{ x: window.innerWidth - 340, y: 80 }}\n                    defaultWidth={300}\n                    isOpenDefault={true}\n                    onClose={() => setIsMinimapOpen(false)}\n                >\n                    <Minimap\n                        mapWidth={mapWidth}\n                        mapHeight={mapHeight}\n                        tileMapData={tileMapData}\n                        objectMapData={objectMapData}\n                        objectMetadata={objectMetadata}\n                        registryItems={registryItems}\n                    />\n                </DraggableWindow>\n            )}\n\n            {isSettingsOpen && (\n                <DraggableWindow\n                    title=\"Editor Settings\"\n                    defaultPosition={{ x: window.innerWidth - 340, y: 400 }}\n                    defaultWidth={300}\n                    isOpenDefault={true}\n                    onClose={() => setIsSettingsOpen(false)}\n                >\n                    <div style={{ display: 'flex', flexDirection: 'column', gap: '10px' }}>\n                         <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}>\n                            <span style={{ fontSize: '13px' }}>Show Grid:</span>\n                            <button onClick={() => setShowGrid(!showGrid)} style={showGrid ? activeButtonStyle : buttonStyle}>\n                                {showGrid ? 'ON' : 'OFF'}\n                            </button>\n                        </div>\n                        <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}>\n                            <span style={{ fontSize: '13px' }}>Brush Size:</span>\n                            <div style={{ display: 'flex', gap: '2px' }}>\n                                {[1, 2, 3, 4, 5].map(s => (\n                                    <button key={s} onClick={() => setBrushSize(s)} style={{ ...(brushSize === s ? activeButtonStyle : buttonStyle), minWidth: '25px', padding: 0 }}>{s}</button>\n                                ))}\n                            </div>\n                        </div>\n                        <div style={{ borderTop: '1px solid #eee', paddingTop: '10px', marginTop: '5px' }}>\n                            <button onClick={clearMap} style={{ ...buttonStyle, color: 'red', width: '100%' }}> Clear Entire Map</button>\n                        </div>\n                    </div>\n                </DraggableWindow>\n            )}\n\n            {/* Resize Map Popup */}\n            {isResizeWindowOpen && (\n                <DraggableWindow\n                    title=\"Resize Map\"\n                    defaultPosition={{ x: 400, y: 100 }}\n                    defaultWidth={300}\n                    isOpenDefault={true}\n                    onClose={() => setIsResizeWindowOpen(false)}\n                >\n                    <MapResizer\n                        mapWidth={mapWidth}\n                        mapHeight={mapHeight}\n                        onResize={onMapResize}\n                    />\n                </DraggableWindow>\n            )}\n        </div>\n    );\n};\n","import React, { useState, useEffect, useRef, useMemo, useCallback } from 'react';\nimport { getRegistry } from '../../../engine/registry';\nimport { TILE_SIZE } from '../../../constants/gameConstants';\nimport { saveMap, loadMap, clearMap, resizeMapData } from './mapOperations';\nimport { getFloodFillIndices, floodFill, paintTile } from './paintingTools';\nimport { loadBackgroundOptions, loadMusicOptions } from './assetLoaders';\nimport { Viewport } from './Viewport';\nimport { NewMapModal } from './NewMapModal';\nimport { ToolbarWindows } from './ToolbarWindows';\nimport { useGameEngine } from '../../../utilities/useGameEngine';\nimport PixiStage from '../game/PixiStage';\n\nconst EMPTY_ARRAY = [];\nconst EMPTY_OBJECT = {};\n\nexport const Editor = () => {\n    // 1. Definjam registryItems pa aug\n    const registryItems = useMemo(() => getRegistry() || [], []);\n    const playerVisuals = useMemo(() => registryItems.find(item => item.id === 'player') || EMPTY_OBJECT, [registryItems]);\n\n    // Editor state: map dimensions, tile/object data, selected tile, tools\n    const [mapWidth, setMapWidth] = useState(20);\n    const [mapHeight, setMapHeight] = useState(15);\n    const [tileMapData, setTileMapData] = useState([]);\n    const [objectMapData, setObjectMapData] = useState([]);\n    const [secretMapData, setSecretMapData] = useState([]);\n    const [objectMetadata, setObjectMetadata] = useState({});\n    const [selectedTile, setSelectedTile] = useState(null);\n    const [showGrid, setShowGrid] = useState(true);\n\n    const [isDragging, setIsDragging] = useState(false);\n    const [brushSize, setBrushSize] = useState(1);\n    const [activeTool, setActiveTool] = useState('brush');\n\n    const [selection, setSelection] = useState(null);\n    const [hoverIndex, setHoverIndex] = useState(null);\n    const [activeLayer, setActiveLayer] = useState('tile');\n    const [dragStart, setDragStart] = useState(null);\n    const [bucketPreviewIndices, setBucketPreviewIndices] = useState(new Set());\n    const [selectionMode, setSelectionMode] = useState('cut'); // 'cut' or 'copy'\n    const [isMovingSelection, setIsMovingSelection] = useState(false);\n    const [previewPosition, setPreviewPosition] = useState(null);\n    const [originalMapData, setOriginalMapData] = useState(null);\n    const bucketTimerRef = useRef(null);\n    const stateRef = useRef({ mapWidth, mapHeight, tileMapData, objectMapData, secretMapData, objectMetadata });\n\n    // Map metadata\n    const [mapName, setMapName] = useState(\"New Map\");\n    const [creatorName, setCreatorName] = useState(\"Anonymous\");\n    const [createdAt, setCreatedAt] = useState(null);\n    const [highlightedIndex, setHighlightedIndex] = useState(null);\n    const [isNewMapModalOpen, setIsNewMapModalOpen] = useState(false);\n    const [tempMapName, setTempMapName] = useState(\"\");\n    const [tempCreatorName, setTempCreatorName] = useState(\"\");\n\n    // 2. NOEM O RINDIU (t vairs nav vajadzga eit):\n    // const registryItems = getRegistry() || [];\n\n    // Background and music options (memoized to avoid reloading every frame)\n    const backgroundOptions = useMemo(() => loadBackgroundOptions(), []);\n    const musicOptions = useMemo(() => loadMusicOptions(), []);\n\n    // Background state - needed before Play/Pause state\n    const [selectedBackgroundImage, setSelectedBackgroundImage] = useState(backgroundOptions[0]?.metaPath || null);\n    const [backgroundParallaxFactor, setBackgroundParallaxFactor] = useState(0.3);\n    const [selectedBackgroundColor, setSelectedBackgroundColor] = useState('#87CEEB');\n    const [selectedBackgroundMusic, setSelectedBackgroundMusic] = useState(null);\n\n    // 3. Definjam stabilu handleSaveMap funkciju\n    const handleSaveMap = useCallback(() => {\n        saveMap({\n            mapWidth, mapHeight, tileMapData, objectMapData, secretMapData, objectMetadata,\n            mapName, creatorName, createdAt,\n            selectedBackgroundImage, selectedBackgroundColor,\n            backgroundParallaxFactor, selectedBackgroundMusic,\n            registryItems, setCreatedAt\n        });\n    }, [\n        mapWidth, mapHeight, tileMapData, objectMapData, secretMapData, objectMetadata,\n        mapName, creatorName, createdAt,\n        selectedBackgroundImage, selectedBackgroundColor,\n        backgroundParallaxFactor, selectedBackgroundMusic,\n        registryItems\n    ]);\n\n    // Play/Pause/Reset state\n    const [isPlayMode, setIsPlayMode] = useState(false);\n    const [editorSnapshot, setEditorSnapshot] = useState(null);\n    const [playerPosition, setPlayerPosition] = useState({ x: 100, y: 100 });\n    const [revealedSecrets, setRevealedSecrets] = useState([]);\n    const [playModeObjectData, setPlayModeObjectData] = useState([]);\n    const [playModeSecretData, setPlayModeSecretData] = useState([]);\n\n    // Game engine integration for Play mode\n    const mapDataForGame = useMemo(() => ({\n        meta: {\n            width: mapWidth,\n            height: mapHeight,\n            tileSize: TILE_SIZE,\n            backgroundImage: selectedBackgroundImage,\n            backgroundColor: selectedBackgroundColor,\n            backgroundParallaxFactor: backgroundParallaxFactor,\n            objectMetadata: objectMetadata\n        },\n        layers: [\n            { type: \"tile\", name: \"background\", data: tileMapData },\n            { type: \"object\", name: \"entities\", data: playModeObjectData }\n        ]\n    }), [mapWidth, mapHeight, selectedBackgroundImage, selectedBackgroundColor, backgroundParallaxFactor, tileMapData, playModeObjectData, objectMetadata]);\n\n    const handleGameOver = useCallback(() => {\n        // On game over in editor, just pause\n        setIsPlayMode(false);\n    }, []);\n\n    const handleStateUpdate = useCallback((newState, payload) => {\n        // Update player position during play or handle events like item collection\n        if (newState && typeof newState === 'object' && newState.x !== undefined && newState.y !== undefined) {\n            setPlayerPosition({ x: newState.x, y: newState.y });\n        } else if (newState === 'collectItem' && payload !== undefined) {\n            setPlayModeObjectData(prev => {\n                const newData = [...prev];\n                newData[payload] = null;\n                return newData;\n            });\n        } else if (newState === 'objectDamage' && payload !== undefined) {\n            const { index, damage } = payload;\n            setObjectMetadata(prev => {\n                const current = prev[index] || {};\n                const objId = playModeObjectData[index];\n                const def = registryItems.find(r => r.id === objId);\n                if (!def) return prev;\n                const maxH = def.maxHealth || 100;\n                const newHealth = Math.max(0, (current.health !== undefined ? current.health : maxH) - damage);\n                \n                return {\n                    ...prev,\n                    [index]: { ...current, health: newHealth }\n                };\n            });\n        } else if (newState === 'playerDamage' && payload !== undefined) {\n            // Reistrjam spltja bojjumus editora play rem (vizulai atgriezeniskajai saitei)\n            // eit vartu atskaot skau vai ko citu, bet dzinjs pats iestata hitTimerMs\n        }\n    }, [playModeObjectData, registryItems]);\n\n    const handleRevealSecret = useCallback((secretIndex) => {\n        setRevealedSecrets(prev => [...prev, secretIndex]);\n    }, []);\n\n    const gameEngineState = useGameEngine(\n        isPlayMode ? mapDataForGame : null,\n        isPlayMode ? tileMapData : EMPTY_ARRAY,\n        isPlayMode ? playModeObjectData : EMPTY_ARRAY,\n        isPlayMode ? playModeSecretData : EMPTY_ARRAY,\n        revealedSecrets,\n        registryItems,\n        handleGameOver,\n        handleStateUpdate,\n        handleRevealSecret,\n        objectMetadata\n    );\n\n    useEffect(() => {\n        stateRef.current = { mapWidth, mapHeight, tileMapData, objectMapData, secretMapData, objectMetadata };\n    }, [mapWidth, mapHeight, tileMapData, objectMapData, secretMapData, objectMetadata]);\n\n    useEffect(() => {\n        const size = 15 * 20;\n        setTileMapData(Array(size).fill(null));\n        setObjectMapData(Array(size).fill(null));\n        setSecretMapData(Array(size).fill(null));\n    }, []);\n\n    // Keyboard handler for Enter (commit) and Escape (cancel)\n    useEffect(() => {\n        const handleKeyDown = (e) => {\n            if (selection) {\n                if (e.key === 'Enter') {\n                    e.preventDefault();\n                    commitSelection();\n                } else if (e.key === 'Escape') {\n                    e.preventDefault();\n                    cancelSelection();\n                }\n            }\n        };\n\n        window.addEventListener('keydown', handleKeyDown);\n        return () => window.removeEventListener('keydown', handleKeyDown);\n    }, [selection, previewPosition, originalMapData, selectionMode]);\n\n    const blocks = useMemo(() => registryItems.filter(item => item.name && item.name.startsWith('block.') && !(item.flags && item.flags.liquid)), [registryItems]);\n    const liquids = useMemo(() => registryItems.filter(item => item.flags && item.flags.liquid), [registryItems]);\n    const entities = useMemo(() => registryItems.filter(item => {\n        if (!item.name || !item.name.toLowerCase().includes('entities.')) return false;\n        if (item.isHiddenInEditor) return false;\n        // Tips var bt entity, default vai pat nebt nordts, ja nosaukums sakrt\n        return !item.type || item.type === 'default' || item.type === 'entity' || item.subtype === 'tank';\n    }), [registryItems]);\n    const decorations = useMemo(() => registryItems.filter(item => {\n        if (item.type === 'decoration') return true;\n        if (item.name && item.name.toLowerCase().includes('decoration.')) return true;\n        if (item.id && item.id.includes('stone_pack')) return true;\n        return false;\n    }), [registryItems]);\n    const items = useMemo(() => registryItems.filter(item => item.name && item.name.toLowerCase().includes('item.')), [registryItems]);\n    const interactables = useMemo(() => registryItems.filter(item => item.name && item.name.toLowerCase().includes('interactable.')), [registryItems]);\n    const hazards = useMemo(() => registryItems.filter(item => item.type === 'hazard' || (item.name && item.name.toLowerCase().includes('hazard.'))), [registryItems]);\n    const secrets = useMemo(() => registryItems.filter(item => item.type === 'secret' || (item.name && item.name.toLowerCase().includes('secret.'))), [registryItems]);\n\n    const selectedBgOption = backgroundOptions.find((bg) => bg.metaPath === selectedBackgroundImage) || backgroundOptions[0];\n    const selectedBackgroundUrl = selectedBgOption && selectedBackgroundImage ? selectedBgOption.src : null;\n\n    const openNewMapModal = () => {\n        setTempMapName(\"New Map\");\n        setTempCreatorName(creatorName);\n        setIsNewMapModalOpen(true);\n    };\n\n    const confirmNewMap = () => {\n        if (window.confirm(\"Are you sure you want to create a new map? Unsaved changes will be lost.\")) {\n            const size = 20 * 15;\n            setMapWidth(20);\n            setMapHeight(15);\n            setTileMapData(Array(size).fill(null));\n            setObjectMapData(Array(size).fill(null));\n            setSecretMapData(Array(size).fill(null));\n\n            setMapName(tempMapName || \"New Map\");\n            setCreatorName(tempCreatorName || \"Anonymous\");\n            setCreatedAt(null);\n            setSelectedBackgroundImage(backgroundOptions[0]?.metaPath || null);\n            setBackgroundParallaxFactor(0.3);\n            setSelectedBackgroundColor('#87CEEB');\n            setSelectedBackgroundMusic(null);\n\n            setIsNewMapModalOpen(false);\n        }\n    };\n\n    const getCurrentData = () => {\n        if (activeLayer === 'tile') return tileMapData;\n        if (activeLayer === 'object') return objectMapData;\n        if (activeLayer === 'secret') return secretMapData;\n        return tileMapData;\n    };\n    const setCurrentData = (newData) => {\n        if (activeLayer === 'tile') setTileMapData(newData);\n        else if (activeLayer === 'object') {\n            // Ja ms mainm objektu slni, prbaudm vai vajag izdzst metadatus\n            setObjectMapData((prev) => {\n                const newMetadata = { ...objectMetadata };\n                let metadataChanged = false;\n                \n                newData.forEach((id, idx) => {\n                    if (prev[idx] !== id && objectMetadata[idx]) {\n                        delete newMetadata[idx];\n                        metadataChanged = true;\n                    }\n                });\n                \n                if (metadataChanged) setObjectMetadata(newMetadata);\n                return newData;\n            });\n        }\n        else if (activeLayer === 'secret') setSecretMapData(newData);\n    };\n\n    const handleGridMouseDown = (index, e) => {\n        e.preventDefault();\n\n        // Check if clicking on existing selection to move it\n        if (selection && previewPosition) {\n            const x = index % mapWidth;\n            const y = Math.floor(index / mapWidth);\n\n            // Check if click is inside selection\n            if (x >= previewPosition.x && x < previewPosition.x + selection.w &&\n                y >= previewPosition.y && y < previewPosition.y + selection.h) {\n                setIsMovingSelection(true);\n                setIsDragging(true);\n                return;\n            }\n        }\n\n        if (activeTool === 'brush') {\n            setIsDragging(true);\n            paintTile(index, selectedTile, brushSize, mapWidth, mapHeight, getCurrentData, setCurrentData);\n        }\n        else if (activeTool === 'bucket') {\n            const targetId = selectedTile ? selectedTile.id : null;\n            floodFill(index, targetId, getCurrentData, setCurrentData, mapWidth, mapHeight);\n            setBucketPreviewIndices(new Set());\n        } else if (activeTool === 'move') {\n            const x = index % mapWidth;\n            const y = Math.floor(index / mapWidth);\n            setDragStart({ x, y });\n            setSelection(null);\n            setPreviewPosition(null);\n            setOriginalMapData(null);\n            setIsDragging(true);\n        }\n    };\n\n    const handleGridMouseEnter = (index) => {\n        setHoverIndex(index);\n\n        // If moving selection, update preview position\n        if (isMovingSelection && isDragging && previewPosition) {\n            const x = index % mapWidth;\n            const y = Math.floor(index / mapWidth);\n            setPreviewPosition({ x, y });\n            return;\n        }\n\n        if (bucketTimerRef.current) {\n            clearTimeout(bucketTimerRef.current);\n            bucketTimerRef.current = null;\n        }\n        setBucketPreviewIndices(new Set());\n        if (activeTool === 'brush' && isDragging) {\n            paintTile(index, selectedTile, brushSize, mapWidth, mapHeight, getCurrentData, setCurrentData);\n        }\n        else if (activeTool === 'bucket' && !isDragging) {\n            bucketTimerRef.current = setTimeout(() => {\n                const currentData = getCurrentData();\n                const indices = getFloodFillIndices(index, currentData, mapWidth, mapHeight);\n                setBucketPreviewIndices(new Set(indices));\n            }, 600);\n        }\n    };\n\n    const handleGridMouseLeave = () => {\n        setHoverIndex(null);\n        if (bucketTimerRef.current) clearTimeout(bucketTimerRef.current);\n        setBucketPreviewIndices(new Set());\n    };\n\n    const handleGridMouseUp = (index) => {\n        if (isMovingSelection) {\n            // Just stop moving, don't commit yet (wait for Enter)\n            setIsMovingSelection(false);\n            return;\n        }\n\n        setIsDragging(false);\n        if (activeTool === 'move' && dragStart) {\n            const endX = index % mapWidth;\n            const endY = Math.floor(index / mapWidth);\n            const x1 = Math.min(dragStart.x, endX);\n            const y1 = Math.min(dragStart.y, endY);\n            const x2 = Math.max(dragStart.x, endX);\n            const y2 = Math.max(dragStart.y, endY);\n            const w = x2 - x1 + 1;\n            const h = y2 - y1 + 1;\n\n            const selTileData = [];\n            const selObjectData = [];\n            const selSecretData = [];\n\n            for (let py = 0; py < h; py++) {\n                for (let px = 0; px < w; px++) {\n                    const idx = (y1 + py) * mapWidth + (x1 + px);\n                    selTileData.push(tileMapData[idx]);\n                    selObjectData.push(objectMapData[idx]);\n                    selSecretData.push(secretMapData[idx]);\n                }\n            }\n\n            // Save original map state\n            setOriginalMapData({\n                tileMap: [...tileMapData],\n                objectMap: [...objectMapData],\n                secretMap: [...secretMapData]\n            });\n\n            setSelection({ x: x1, y: y1, w, h, tileData: selTileData, objectData: selObjectData, secretData: selSecretData, originalX: x1, originalY: y1 });\n            setPreviewPosition({ x: x1, y: y1 });\n            setDragStart(null);\n        }\n    };\n\n    const moveSelection = (dx, dy) => {\n        if (!selection || !previewPosition) return;\n\n        const newX = previewPosition.x + dx;\n        const newY = previewPosition.y + dy;\n\n        // Just update preview position\n        setPreviewPosition({ x: newX, y: newY });\n    };\n\n    const commitSelection = () => {\n        if (!selection || !previewPosition || !originalMapData) return;\n\n        const newTileMap = [...originalMapData.tileMap];\n        const newObjectMap = [...originalMapData.objectMap];\n        const newSecretMap = [...originalMapData.secretMap];\n\n        // If cut mode, clear original position\n        if (selectionMode === 'cut') {\n            for (let py = 0; py < selection.h; py++) {\n                for (let px = 0; px < selection.w; px++) {\n                    const idx = (selection.originalY + py) * mapWidth + (selection.originalX + px);\n                    if (idx >= 0 && idx < newTileMap.length) {\n                        newTileMap[idx] = null;\n                        newObjectMap[idx] = null;\n                        newSecretMap[idx] = null;\n                    }\n                }\n            }\n        }\n\n        // Place selection at new position\n        for (let py = 0; py < selection.h; py++) {\n            for (let px = 0; px < selection.w; px++) {\n                const destX = previewPosition.x + px;\n                const destY = previewPosition.y + py;\n                if (destX >= 0 && destX < mapWidth && destY >= 0 && destY < mapHeight) {\n                    const destIdx = destY * mapWidth + destX;\n                    const srcDataIdx = py * selection.w + px;\n\n                    newTileMap[destIdx] = selection.tileData[srcDataIdx];\n                    newObjectMap[destIdx] = selection.objectData[srcDataIdx];\n                    newSecretMap[destIdx] = selection.secretData?.[srcDataIdx] || null;\n                }\n            }\n        }\n\n        setTileMapData(newTileMap);\n        setObjectMapData(newObjectMap);\n        setSecretMapData(newSecretMap);\n        setSelection(null);\n        setPreviewPosition(null);\n        setOriginalMapData(null);\n    };\n\n    const cancelSelection = () => {\n        setSelection(null);\n        setPreviewPosition(null);\n        setOriginalMapData(null);\n        setIsMovingSelection(false);\n    };\n\n    const handleMapResize = (newWidth, newHeight) => {\n        if (newWidth === mapWidth && newHeight === mapHeight) return;\n\n        resizeMapData({\n            newWidth,\n            newHeight,\n            stateRef,\n            setMapWidth,\n            setMapHeight,\n            setTileMapData,\n            setObjectMapData,\n            setSecretMapData,\n            setObjectMetadata\n        });\n    };\n\n    const handlePaletteSelect = (item, layer) => {\n        setSelectedTile(item);\n        setActiveLayer(layer);\n        setActiveTool('brush');\n        setSelection(null);\n    };\n\n    // Play/Pause/Reset handlers\n    const handlePlay = () => {\n        // Save snapshot of current state (original editor data)\n        setEditorSnapshot({\n            objectMapData: [...objectMapData],\n            secretMapData: [...secretMapData],\n            objectMetadata: { ...objectMetadata },\n            playerPosition: { ...playerPosition }\n        });\n\n        // Create copies for play mode (these will be modified by game engine)\n        const playData = [...objectMapData];\n\n        // Find player spawn position or use default center position\n        let spawnIndex = playData.findIndex(id => id && id.includes('player'));\n        if (spawnIndex === -1) {\n            // No player found, place at center of map (or position 3,3)\n            const spawnX = Math.min(3, mapWidth - 1);\n            const spawnY = Math.min(3, mapHeight - 1);\n            spawnIndex = spawnY * mapWidth + spawnX;\n            // Add temporary player marker (use ID 'player' which is in registry)\n            playData[spawnIndex] = 'player';\n        }\n\n        setPlayModeObjectData(playData);\n        setPlayModeSecretData([...secretMapData]);\n        setRevealedSecrets([]);\n\n        setIsPlayMode(true);\n    };\n\n    const handlePause = () => {\n        setIsPlayMode(false);\n        // When pausing, update editor's objectMapData with current play state\n        // This simulates \"saving\" the collected items during play\n        const pauseData = [...playModeObjectData];\n\n        // Remove temporary player if it was auto-added (not in original editor data)\n        const originalHadPlayer = editorSnapshot.objectMapData.findIndex(id => id && id.includes('player')) !== -1;\n        if (!originalHadPlayer) {\n            const playerIndex = pauseData.findIndex(id => id && id.includes('player'));\n            if (playerIndex !== -1) {\n                pauseData[playerIndex] = null;\n            }\n        }\n\n        setObjectMapData(pauseData);\n        setSecretMapData([...playModeSecretData]);\n    };\n\n    const handleReset = () => {\n        if (editorSnapshot && isPlayMode) {\n            // Restore objects from snapshot but keep player position\n            // This resets collected objects during play mode\n            const resetData = [...editorSnapshot.objectMapData];\n\n            // Re-add player at same spawn position\n            let spawnIndex = resetData.findIndex(id => id && id.includes('player'));\n            if (spawnIndex === -1) {\n                const spawnX = Math.min(3, mapWidth - 1);\n                const spawnY = Math.min(3, mapHeight - 1);\n                spawnIndex = spawnY * mapWidth + spawnX;\n                resetData[spawnIndex] = 'player';\n            }\n\n            setPlayModeObjectData(resetData);\n            setPlayModeSecretData([...editorSnapshot.secretMapData]);\n            setObjectMetadata({ ...editorSnapshot.objectMetadata });\n            setRevealedSecrets([]);\n            // Player position is maintained by useGameEngine state\n        }\n    };\n\n    const totalTiles = mapWidth * mapHeight;\n    const filledBlocks = tileMapData.filter(t => t !== null).length;\n    const emptyBlocks = totalTiles - filledBlocks;\n    const objectsCount = objectMapData.filter(o => o !== null).length;\n\n    return (\n        <div className=\"editor-wrapper\" style={{ position: 'relative', height: '100%', overflow: 'hidden' }}>\n            <NewMapModal\n                isOpen={isNewMapModalOpen}\n                tempMapName={tempMapName}\n                setTempMapName={setTempMapName}\n                tempCreatorName={tempCreatorName}\n                setTempCreatorName={setTempCreatorName}\n                confirmNewMap={confirmNewMap}\n                onClose={() => setIsNewMapModalOpen(false)}\n            />\n\n            <div className=\"editor-container\" style={{\n                display: 'flex', height: '100%', flexDirection: 'row',\n                filter: isNewMapModalOpen ? 'blur(4px) brightness(0.7)' : 'none',\n                transition: 'filter 0.2s ease',\n                pointerEvents: isNewMapModalOpen ? 'none' : 'auto'\n            }}>\n                <ToolbarWindows\n                    mapName={mapName}\n                    creatorName={creatorName}\n                    openNewMapModal={openNewMapModal}\n                    saveMap={handleSaveMap} // 4. Izmanto jauno handleSaveMap\n                    loadMap={(event) => loadMap({\n                        event, setMapWidth, setMapHeight, setMapName, setCreatorName,\n                        setCreatedAt, setSelectedBackgroundImage, setSelectedBackgroundColor,\n                        setBackgroundParallaxFactor, setSelectedBackgroundMusic,\n                        setTileMapData, setObjectMapData, setSecretMapData, setObjectMetadata\n                    })}\n                    showGrid={showGrid}\n                    setShowGrid={setShowGrid}\n                    clearMap={() => clearMap({ mapWidth, mapHeight, setTileMapData, setObjectMapData, setSecretMapData, setObjectMetadata })}\n                    isPlayMode={isPlayMode}\n                    handlePlay={handlePlay}\n                    handlePause={handlePause}\n                    handleReset={handleReset}\n                    activeTool={activeTool}\n                    setActiveTool={setActiveTool}\n                    brushSize={brushSize}\n                    setBrushSize={setBrushSize}\n                    activeLayer={activeLayer}\n                    selection={selection}\n                    moveSelection={moveSelection}\n                    setSelection={setSelection}\n                    selectionMode={selectionMode}\n                    setSelectionMode={setSelectionMode}\n                    commitSelection={commitSelection}\n                    cancelSelection={cancelSelection}\n                    selectedTile={selectedTile}\n                    handlePaletteSelect={handlePaletteSelect}\n                    blocks={blocks}\n                    liquids={liquids}\n                    entities={entities}\n                    items={items}\n                    decorations={decorations}\n                    interactables={interactables}\n                    hazards={hazards}\n                    secrets={secrets}\n                    backgroundOptions={backgroundOptions}\n                    selectedBackgroundImage={selectedBackgroundImage}\n                    setSelectedBackgroundImage={setSelectedBackgroundImage}\n                    selectedBackgroundColor={selectedBackgroundColor}\n                    setSelectedBackgroundColor={setSelectedBackgroundColor}\n                    backgroundParallaxFactor={backgroundParallaxFactor}\n                    setBackgroundParallaxFactor={setBackgroundParallaxFactor}\n                    musicOptions={musicOptions}\n                    selectedBackgroundMusic={selectedBackgroundMusic}\n                    setSelectedBackgroundMusic={setSelectedBackgroundMusic}\n                    totalTiles={totalTiles}\n                    filledBlocks={filledBlocks}\n                    emptyBlocks={emptyBlocks}\n                    objectsCount={objectsCount}\n                    mapWidth={mapWidth}\n                    mapHeight={mapHeight}\n                    tileMapData={tileMapData}\n                    objectMapData={objectMapData}\n                    objectMetadata={objectMetadata}\n                    setObjectMetadata={setObjectMetadata}\n                    registryItems={registryItems}\n                    onMapResize={handleMapResize}\n                    highlightedIndex={highlightedIndex}\n                    setHighlightedIndex={setHighlightedIndex}\n                />\n\n                {!isPlayMode ? (\n                    <Viewport\n                        mapWidth={mapWidth}\n                        mapHeight={mapHeight}\n                        selectedBackgroundUrl={selectedBackgroundUrl}\n                        selectedBackgroundColor={selectedBackgroundColor}\n                        selectedBackgroundImage={selectedBackgroundImage}\n                        showGrid={showGrid}\n                        activeLayer={activeLayer}\n                        activeTool={activeTool}\n                        tileMapData={tileMapData}\n                        objectMapData={objectMapData}\n                        secretMapData={secretMapData}\n                        objectMetadata={objectMetadata}\n                        registryItems={registryItems}\n                        hoverIndex={hoverIndex}\n                        highlightedIndex={highlightedIndex}\n                        brushSize={brushSize}\n                        bucketPreviewIndices={bucketPreviewIndices}\n                        selection={selection}\n                        previewPosition={previewPosition}\n                        dragStart={dragStart}\n                        isDragging={isDragging}\n                        handleGridMouseDown={handleGridMouseDown}\n                        handleGridMouseEnter={handleGridMouseEnter}\n                        handleGridMouseUp={handleGridMouseUp}\n                        handleGridMouseLeave={handleGridMouseLeave}\n                        setIsDragging={setIsDragging}\n                    />\n                ) : (\n                    <div style={{ flex: 1, position: 'relative', backgroundColor: '#000' }}>\n                        <PixiStage\n                            mapWidth={mapWidth}\n                            mapHeight={mapHeight}\n                            tileSize={TILE_SIZE}\n                            tileMapData={tileMapData}\n                            objectMapData={playModeObjectData}\n                            secretMapData={playModeSecretData}\n                            revealedSecrets={revealedSecrets}\n                            registryItems={registryItems}\n                            playerState={gameEngineState}\n                            playerVisuals={playerVisuals}\n                            objectMetadata={objectMetadata}\n                            backgroundImage={selectedBackgroundImage}\n                            backgroundColor={selectedBackgroundColor}\n                            backgroundParallaxFactor={backgroundParallaxFactor}\n                            projectiles={gameEngineState?.projectiles || EMPTY_ARRAY}\n                            healthBarEnabled={true}\n                            oxygenBarEnabled={true}\n                            lavaBarEnabled={true}\n                            isEditor={true}\n                        />\n                    </div>\n                )}\n            </div>\n        </div>\n    );\n};\n","export const loadBackgroundOptions = () => {\n    const bgContext = require.context('../../../assets/background', false, /\\.(png|jpe?g|svg)$/);\n    return bgContext.keys().map((key) => {\n        const mod = bgContext(key);\n        const url = mod.default || mod;\n        const name = key.replace('./', '');\n        return { key, name, src: url, metaPath: `/assets/background/${name}` };\n    });\n};\n\nexport const loadMusicOptions = () => {\n    const musicContext = require.context('../../../assets/sound/background', false, /\\.ogg$/);\n    return musicContext.keys().map((key) => {\n        const mod = musicContext(key);\n        const name = key.replace('./', '');\n        return { key, name, src: (mod.default || mod), metaPath: `/assets/sound/background/${name}` };\n    });\n};\n","import saveFile from '../../../utilities/saveFile';\nimport errorHandler from '../../../services/errorHandler';\n\nexport const saveMap = async ({\n    mapWidth,\n    mapHeight,\n    tileMapData,\n    objectMapData,\n    secretMapData,\n    objectMetadata,\n    mapName,\n    creatorName,\n    createdAt,\n    selectedBackgroundImage,\n    selectedBackgroundColor,\n    backgroundParallaxFactor,\n    selectedBackgroundMusic,\n    registryItems,\n    setCreatedAt\n}) => {\n    const currentDate = new Date().toISOString();\n    const createdDate = createdAt || currentDate;\n\n    // Statistics calculation\n    const filledBlocks = tileMapData.filter(t => t !== null).length;\n    const objectsCount = objectMapData.filter(o => o !== null).length;\n    const itemsCount = objectMapData.filter(o => {\n        if (!o) return false;\n        const item = registryItems.find(r => r.id === o);\n        return item && item.name && item.name.startsWith('item.');\n    }).length;\n\n    const mapData = {\n        meta: {\n            width: mapWidth,\n            height: mapHeight,\n            tileSize: 32,\n            version: \"1.0\",\n            name: mapName,\n            author: creatorName,\n            date_map_created_at: createdDate,\n            date_map_last_updated: currentDate,\n            backgroundImage: selectedBackgroundImage || null,\n            backgroundColor: selectedBackgroundImage ? null : selectedBackgroundColor,\n            backgroundParallaxFactor: backgroundParallaxFactor,\n            backgroundMusic: selectedBackgroundMusic || null,\n            objectMetadata: objectMetadata || {}\n        },\n        statistics: {\n            total_tiles: mapWidth * mapHeight,\n            filled_tiles: filledBlocks,\n            total_objects: objectsCount,\n            total_items: itemsCount\n        },\n        layers: [\n            { type: \"tile\", name: \"background\", data: tileMapData },\n            { type: \"object\", name: \"entities\", data: objectMapData },\n            { type: \"secret\", name: \"secrets\", data: secretMapData || Array(mapWidth * mapHeight).fill(null) }\n        ]\n    };\n\n    const fileName = `${mapName.replace(/\\s+/g, '_')}.json`;\n    const json = JSON.stringify(mapData, null, 2);\n\n    try {\n        const saved = await saveFile(json, fileName, 'application/json');\n        if (saved) {\n            if (!createdAt) setCreatedAt(currentDate);\n            errorHandler.info('Map saved successfully', {\n                component: 'Editor',\n                mapName,\n                fileName,\n                dimensions: `${mapWidth}x${mapHeight}`\n            });\n        }\n    } catch (error) {\n        errorHandler.error(error, {\n            component: 'Editor',\n            function: 'saveMap',\n            mapName,\n            fileName\n        });\n        alert('Failed to save map. Check console for details.');\n    }\n};\n\nexport const loadMap = ({\n    event,\n    setMapWidth,\n    setMapHeight,\n    setMapName,\n    setCreatorName,\n    setCreatedAt,\n    setSelectedBackgroundImage,\n    setSelectedBackgroundColor,\n    setBackgroundParallaxFactor,\n    setSelectedBackgroundMusic,\n    setTileMapData,\n    setObjectMapData,\n    setSecretMapData,\n    setObjectMetadata\n}) => {\n    const fileReader = new FileReader();\n    const file = event.target.files[0];\n    if (file) {\n        fileReader.readAsText(file, \"UTF-8\");\n        fileReader.onload = (e) => {\n            try {\n                const loaded = JSON.parse(e.target.result);\n                if (loaded.meta) {\n                    setMapWidth(loaded.meta.width);\n                    setMapHeight(loaded.meta.height);\n\n                    if (loaded.meta.name) setMapName(loaded.meta.name);\n                    if (loaded.meta.author) setCreatorName(loaded.meta.author);\n                    if (loaded.meta.date_map_created_at) setCreatedAt(loaded.meta.date_map_created_at);\n\n                    if (typeof loaded.meta.backgroundImage !== 'undefined' && loaded.meta.backgroundImage) {\n                        setSelectedBackgroundImage(loaded.meta.backgroundImage);\n                    } else {\n                        setSelectedBackgroundImage(null);\n                    }\n                    if (typeof loaded.meta.backgroundColor !== 'undefined' && loaded.meta.backgroundColor) {\n                        setSelectedBackgroundColor(loaded.meta.backgroundColor);\n                    }\n                    if (typeof loaded.meta.backgroundParallaxFactor !== 'undefined') {\n                        setBackgroundParallaxFactor(loaded.meta.backgroundParallaxFactor);\n                    } else {\n                        setBackgroundParallaxFactor(0.3);\n                    }\n                    if (typeof loaded.meta.backgroundMusic !== 'undefined' && loaded.meta.backgroundMusic) {\n                        const m = loaded.meta.backgroundMusic;\n                        const normalized = typeof m === 'string' ? m.replace('/sound/background/', '/assets/sound/background/') : m;\n                        setSelectedBackgroundMusic(normalized);\n                    } else {\n                        setSelectedBackgroundMusic(null);\n                    }\n\n                    if (loaded.meta.objectMetadata) {\n                        setObjectMetadata(loaded.meta.objectMetadata);\n                    } else {\n                        setObjectMetadata({});\n                    }\n\n                    const bgLayer = loaded.layers.find(l => l.name === 'background');\n                    const objLayer = loaded.layers.find(l => l.name === 'entities');\n                    const secretLayer = loaded.layers.find(l => l.name === 'secrets');\n                    if (bgLayer) setTileMapData(bgLayer.data);\n                    if (objLayer) setObjectMapData(objLayer.data);\n                    if (secretLayer) {\n                        setSecretMapData(secretLayer.data);\n                    } else {\n                        setSecretMapData(Array(loaded.meta.width * loaded.meta.height).fill(null));\n                    }\n\n                    errorHandler.info('Map loaded successfully', {\n                        component: 'Editor',\n                        mapName: loaded.meta.name,\n                        dimensions: `${loaded.meta.width}x${loaded.meta.height}`\n                    });\n                } else {\n                    // Old format\n                    if (loaded.width) setMapWidth(loaded.width);\n                    if (loaded.height) setMapHeight(loaded.height);\n                    if (loaded.tiles) setTileMapData(loaded.tiles);\n                    setObjectMapData(Array(loaded.width * loaded.height).fill(null));\n\n                    errorHandler.warn('Loaded map in legacy format', {\n                        component: 'Editor',\n                        fileName: file.name\n                    });\n                }\n            } catch (error) {\n                errorHandler.error(error, {\n                    component: 'Editor',\n                    function: 'loadMap',\n                    fileName: file.name\n                });\n                alert('Error loading map. Check console for details.');\n            }\n        };\n        fileReader.onerror = (error) => {\n            errorHandler.error(error, {\n                component: 'Editor',\n                function: 'loadMap',\n                fileName: file.name,\n                phase: 'fileReader'\n            });\n            alert('Error reading file!');\n        };\n    }\n};\n\nexport const clearMap = ({ mapWidth, mapHeight, setTileMapData, setObjectMapData, setSecretMapData, setObjectMetadata }) => {\n    if (window.confirm(\"Are you sure you want to clear the map?\")) {\n        const size = mapWidth * mapHeight;\n        setTileMapData(Array(size).fill(null));\n        setObjectMapData(Array(size).fill(null));\n        setSecretMapData(Array(size).fill(null));\n        setObjectMetadata({});\n    }\n};\n\nexport const resizeMapData = ({ newWidth, newHeight, stateRef, setMapWidth, setMapHeight, setTileMapData, setObjectMapData, setSecretMapData, setObjectMetadata }) => {\n    const { mapWidth: oldW, mapHeight: oldH, tileMapData: oldTiles, objectMapData: oldObjs, secretMapData: oldSecrets, objectMetadata: oldMeta } = stateRef.current;\n    if (newWidth < 1 || newHeight < 1) return;\n    if (newWidth === oldW && newHeight === oldH) return;\n\n    const resizeArray = (oldArr) => {\n        const newArr = Array(newWidth * newHeight).fill(null);\n        if (!oldArr) return newArr;\n        for (let y = 0; y < Math.min(oldH, newHeight); y++) {\n            for (let x = 0; x < Math.min(oldW, newWidth); x++) {\n                newArr[y * newWidth + x] = oldArr[y * oldW + x];\n            }\n        }\n        return newArr;\n    };\n\n    const resizeMetadata = (oldM) => {\n        const newM = {};\n        if (!oldM) return newM;\n        for (let y = 0; y < Math.min(oldH, newHeight); y++) {\n            for (let x = 0; x < Math.min(oldW, newWidth); x++) {\n                const oldIdx = y * oldW + x;\n                const newIdx = y * newWidth + x;\n                if (oldM[oldIdx]) {\n                    newM[newIdx] = oldM[oldIdx];\n                }\n            }\n        }\n        return newM;\n    };\n\n    setMapWidth(newWidth);\n    setMapHeight(newHeight);\n    setTileMapData(resizeArray(oldTiles));\n    setObjectMapData(resizeArray(oldObjs));\n    setSecretMapData(resizeArray(oldSecrets));\n    setObjectMetadata(resizeMetadata(oldMeta));\n};\n","\n\nexport default function Crystals() {\n\n    return (\n        <>\n            <p>Crystals</p>\n        </>\n    )\n}","import React, { useState, useEffect } from 'react';\nimport { getRegistry } from '../../engine/registry';\nimport AnimatedItem from '../../utilities/AnimatedItem';\n\nexport default function Repository() {\n    const registryItems = getRegistry();\n\n    // Container style for grid layout\n    const containerStyle = {\n        display: 'flex',\n        flexWrap: 'wrap',\n        gap: '20px',\n        padding: '20px'\n    };\n\n    // Style for each card\n    const cardStyle = {\n        border: '1px solid #ccc',\n        borderRadius: '8px',\n        padding: '10px',\n        width: '200px',\n        display: 'flex',\n        flexDirection: 'column',\n        alignItems: 'center',\n        backgroundColor: '#f9f9f9'\n    };\n\n    // Image style (64x64)\n    const imageStyle = {\n        width: '64px',\n        height: '64px',\n        objectFit: 'contain', // Prevent image stretching if proportions aren't perfect\n        imageRendering: 'pixelated', // Important for pixel graphics (2D games)\n        marginBottom: '10px',\n        border: '1px dashed #aaa'\n    };\n\n    const fieldsContainerStyle = {\n        width: '100%',\n        fontSize: '12px',\n        textAlign: 'left'\n    };\n\n    return (\n        <div style={containerStyle}>\n            {registryItems.map((item, index) => (\n                <div key={item.id || index} style={cardStyle}>\n                    \n                    {/* Choose: Animation or Static image */}\n                    {item.textures && item.textures.length > 0 ? (\n                        <AnimatedItem\n                            textures={item.textures}\n                            texture={item.texture}\n                            speed={item.animationSpeed}\n                            style={imageStyle}\n                            alt={item.name}\n                        />\n                    ) : (\n                        <img \n                            src={item.texture} \n                            alt={item.name} \n                            style={imageStyle}\n                            onError={(e) => { e.target.style.display = 'none'; }} \n                        />\n                    )}\n\n                    {/* Filter out 'texture', 'textures', and 'animationSpeed' from text list */}\n                    <div style={fieldsContainerStyle}>\n                        {Object.entries(item)\n                            .filter(([key]) => !['texture', 'textures', 'animationSpeed'].includes(key))\n                            .map(([key, value]) => (\n                                <div key={key} style={{ marginBottom: '4px', wordBreak: 'break-all' }}>\n                                    <strong>{key}:</strong> \n                                    <span style={{ marginLeft: '5px', color: '#555' }}>\n                                        {typeof value === 'object' ? JSON.stringify(value) : String(value)}\n                                    </span>\n                                </div>\n                        ))}\n                    </div>\n                </div>\n            ))}\n            \n            {registryItems.length === 0 && <p>No items found in registry.</p>}\n        </div>\n    );\n}","import React from 'react'\nimport ReactDOM from 'react-dom/client'\nimport { BrowserRouter, Routes, Route } from \"react-router-dom\"\nimport { Provider } from 'react-redux'\nimport { ThemeProvider } from 'styled-components'\nimport store from './store'\nimport theme from './styles/theme'\nimport GlobalStyles from './styles/GlobalStyles'\nimport './i18n/i18n'\nimport './index.css'\nimport App from './App'\nimport Home from \"./sections/chapters/home\"\nimport Game from \"./sections/chapters/game\"\nimport {Editor} from \"./sections/chapters/editor/index\"\nimport Crystals from \"./sections/chapters/crystals\"\nimport Repository from \"./sections/chapters/repository\"\n\nconst root = ReactDOM.createRoot(document.getElementById('root'))\nroot.render(\n    <Provider store={store}>\n        <ThemeProvider theme={theme}>\n            <GlobalStyles />\n            <BrowserRouter basename={process.env.PUBLIC_URL}>\n                <Routes>\n\n                <Route path=\"/\" element={<App />}>\n                    <Route index element={<Home />} />\n                    <Route path=\"game\" element={<Game />} />\n                    <Route path=\"editor\" element={<Editor />} />\n                    <Route path=\"crystals\" element={<Crystals />} />\n                    <Route path=\"repository\" element={<Repository />} />\n                </Route>\n\n                </Routes>\n            </BrowserRouter>\n        </ThemeProvider>\n    </Provider>\n)\n","var map = {\n\t\"./background/170515__rolandasb__forest_ambient_01_loop.ogg\": 344,\n\t\"./background/830253__nicktayloe__afternoon-woods-in-october-midwest-us-loop.ogg\": 3004,\n\t\"./sfx/zzox-fx_nite-hit-item.ogg\": 9750,\n\t\"./sfx/zzox-fx_sling-selector.ogg\": 7973\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 6431;","var map = {\n\t\"./blocks/desert_block_0001.json\": 6918,\n\t\"./blocks/desert_block_0002.json\": 8359,\n\t\"./blocks/desert_block_0003.json\": 324,\n\t\"./blocks/desert_block_0004.json\": 2149,\n\t\"./blocks/desert_block_0005.json\": 5418,\n\t\"./blocks/desert_block_0006.json\": 5531,\n\t\"./blocks/desert_block_0007.json\": 4136,\n\t\"./blocks/desert_block_0008.json\": 329,\n\t\"./blocks/desert_block_0009.json\": 9518,\n\t\"./blocks/diorite_block.json\": 3929,\n\t\"./blocks/dirt_block_0001.json\": 3462,\n\t\"./blocks/dirt_block_0002.json\": 5655,\n\t\"./blocks/dirt_block_0003.json\": 4932,\n\t\"./blocks/dirt_block_0004.json\": 5653,\n\t\"./blocks/dirt_block_0005.json\": 8970,\n\t\"./blocks/dirt_block_0006.json\": 2251,\n\t\"./blocks/grass_block_0001.json\": 7865,\n\t\"./blocks/ice_block_0001.json\": 3322,\n\t\"./blocks/lava_block.json\": 2619,\n\t\"./blocks/sand_block_0001.json\": 7323,\n\t\"./blocks/sand_block_0002.json\": 7210,\n\t\"./blocks/water_block.json\": 5688,\n\t\"./decorations/stone_pack_01_001.json\": 5247,\n\t\"./decorations/stone_pack_01_002.json\": 5134,\n\t\"./decorations/stone_pack_01_003.json\": 9593,\n\t\"./decorations/stone_pack_01_004.json\": 9840,\n\t\"./decorations/stone_pack_01_005.json\": 2867,\n\t\"./decorations/stone_pack_01_006.json\": 7618,\n\t\"./decorations/stone_pack_01_007.json\": 9069,\n\t\"./decorations/stone_pack_01_008.json\": 9588,\n\t\"./decorations/stone_pack_01_009.json\": 3975,\n\t\"./entities/player/player.json\": 6411,\n\t\"./entities/player/player_dead.json\": 5998,\n\t\"./entities/player/player_default.json\": 2333,\n\t\"./entities/player/player_target.json\": 6513,\n\t\"./entities/tank_0000.json\": 9381,\n\t\"./entities/tank_0001.json\": 8938,\n\t\"./entities/tank_0002.json\": 9179,\n\t\"./hazards/bushes_001.json\": 3540,\n\t\"./hazards/death_block_0001.json\": 2068,\n\t\"./interactables/arrows/arrow_down.json\": 3741,\n\t\"./interactables/arrows/arrow_left.json\": 4636,\n\t\"./interactables/arrows/arrow_right.json\": 9821,\n\t\"./interactables/arrows/arrow_up.json\": 7852,\n\t\"./interactables/berry_bush_01.json\": 7043,\n\t\"./interactables/berry_bush_01_used.json\": 8669,\n\t\"./interactables/ends/end_0001.json\": 9318,\n\t\"./interactables/platforms/platform_0001.json\": 2008,\n\t\"./interactables/portal_001.json\": 3742,\n\t\"./interactables/portal_target.json\": 4198,\n\t\"./interactables/wooden_box_0001.json\": 2010,\n\t\"./items/fireball_ammo.json\": 8443,\n\t\"./items/hertz_item.json\": 1752,\n\t\"./projectiles/firebal_basic.json\": 8097,\n\t\"./secrets/open_area.json\": 3106,\n\t\"./secrets/secret_above.json\": 5536,\n\t\"./secrets/secret_area.json\": 4330,\n\t\"./secrets/secret_below.json\": 632\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 6570;","var map = {\n\t\"./seamless_01.jpg\": 2436,\n\t\"./seamless_02.jpg\": 2147,\n\t\"./seamless_03.jpg\": 2038,\n\t\"./seamless_04.jpg\": 8237,\n\t\"./seamless_05.jpg\": 3344,\n\t\"./seamless_06.jpg\": 719,\n\t\"./seamless_07.png\": 6390\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 8870;"],"names":["map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","resolve","module","exports","initialState","activeMapData","tileMapData","objectMapData","secretMapData","objectMetadata","revealedSecrets","objectTextureIndices","mapWidth","mapHeight","isLoading","error","isPaused","isGameOver","gameSlice","createSlice","name","reducers","setActiveMap","state","action","mapData","payload","meta","updateObjectMap","updateObjectMetadata","index","metadata","removeObjectAtIndex","undefined","updateObjectAtIndex","newId","setObjectTextureIndex","textureIndex","revealSecretZone","forEach","idx","includes","push","setLoading","setError","setPaused","setGameOver","resetGame","actions","TILE_SIZE","MAX_HEALTH","MAX_OXYGEN","MAX_LAVA_RESIST","x","y","width","height","vx","vy","isGrounded","direction","animation","health","maxHealth","ammo","oxygen","maxOxygen","lavaResist","maxLavaResist","projectiles","inWater","headUnderWater","atSurface","liquidType","hitTimerMs","isWinning","winCounter","playerSlice","updateState","setPosition","setVelocity","setHealth","Math","max","min","addHealth","takeDamage","setAmmo","addAmmo","setOxygen","setLavaResist","setProjectiles","addProjectile","removeProjectile","filter","p","setDirection","setAnimation","setGrounded","setInWater","setLiquidType","resetPlayer","sound","enabled","masterVolume","sfxVolume","musicVolume","graphics","backgroundParallaxFactor","weatherRain","weatherSnow","weatherClouds","weatherFog","weatherThunder","ui","healthBarEnabled","oxygenBarEnabled","lavaBarEnabled","waterSplashesEnabled","lavaEmbersEnabled","controls","keyUp","keyDown","keyLeft","keyRight","keyJump","keyShoot","settingsSlice","loadSettings","saved","localStorage","getItem","parsed","JSON","parse","console","updateSettings","newState","setItem","stringify","setSoundEnabled","setSoundVolume","type","volume","setGraphicsSetting","key","value","setUISetting","setControlBinding","resetSettings","removeItem","isMapModalOpen","isSettingsOpen","isTerminalOpen","isPauseMenuOpen","notifications","cameraScrollX","shouldCenterMap","uiSlice","setMapModalOpen","setSettingsOpen","setTerminalOpen","window","__GAME_TERMINAL_OPEN__","setPauseMenuOpen","addNotification","Date","now","timestamp","toISOString","removeNotification","n","clearNotifications","setCameraScrollX","setShouldCenterMap","resetUI","configureStore","reducer","game","gameReducer","player","playerReducer","settings","settingsReducer","uiReducer","middleware","getDefaultMiddleware","serializableCheck","ignoredActions","ignoredActionPaths","ignoredPaths","devTools","process","colors","primary","secondary","danger","warning","success","info","dark","darkGray","mediumGray","lightGray","background","surface","overlay","text","textLight","textDark","border","borderLight","spacing","xs","sm","md","lg","xl","xxl","borderRadius","round","shadows","fontSize","base","fontWeight","light","normal","medium","semibold","bold","transitions","fast","slow","zIndex","dropdown","modal","tooltip","notification","breakpoints","mobile","tablet","desktop","wide","createGlobalStyle","lv_navigation","no_navigation","en_navigation","ru_navigation","ja_navigation","i18n","initReactI18next","init","lng","fallbackLng","supportedLngs","ns","defaultNS","interpolation","escapeValue","resources","lv","navigation","no","en","ru","ja","NavLinkButton","styled","NavLink","withConfig","componentId","SectionHeaderNavigationChapters","t","useTranslation","chapter_home","chapter_game","chapter_editor","chapter_crystals","chapter_repository","_jsxs","style","display","gap","children","_jsx","to","className","isActive","onClick","handleNewGameClick","dispatchEvent","Event","NavButton","button","DropdownContainer","div","DropdownMenu","MenuItem","ToggleSwitch","props","$active","SectionHeaderNavigationLanguages","dispatch","useDispatch","dropdownRef","useRef","isMenuOpen","setIsMenuOpen","useState","useSelector","soundEnabled","currentLang","language","handleLanguageChange","newLang","changeLanguage","useEffect","handleClickOutside","event","current","contains","target","document","addEventListener","removeEventListener","ref","title","toggleSound","next","CustomEvent","detail","backgroundColor","margin","padding","color","StyledLogo","SectionHeaderNavigationLogo","StyledSectionHeaderNavigation","StyledSectionHeaderFooter","StyledSectionContent","_registry","initRegistry","time","jsonContext","require","imageContext","soundContext","warn","resolvePath","rawPath","cleanPath","replace","relativePath","startsWith","imageModule","default","_warnedUnresolvedSound","resolveSound","rel","out","normalize","mod","data","item","resolvedTexture","texture","resolvedTextures","textures","Array","isArray","path","sfx","sfxResolved","defaultAnimation","animItem","find","r","length","animationSpeed","isHiddenInEditor","deadAnimation","deadItem","targetAnimation","targetItem","log","timeEnd","getRegistry","findItemById","items","flexDirection","justifyContent","alignItems","overflow","flexShrink","SectionHeader","SectionContent","flexGrow","Outlet","SectionFooter","Home","_Fragment","TextureCache","constructor","this","_map","Map","get","url","m","has","tex","Texture","from","set","dispose","delete","clear","WeatherRain","container","api","getIntensity","tileSize","particles","intensity","area","maxParticles","floor","setIntensity","v","Number","spawnOne","g","Graphics","rect","fill","alpha","random","speed","rotation","addChild","bounces","alive","update","dtMs","norm","scaled","pow","deficit","maxPerFrame","smooth","ceil","toSpawn","i","surplus","toCull","pop","parent","removeChild","destroy","dt","toRemove","nx","ny","getLiquidSurfaceY","syWater","isFinite","strength","onWaterImpact","syLava","onLavaImpact","isSolidAt","guard","abs","j","splice","WeatherSnow","flakes","maxFlakes","circle","drift","settled","life","phase","restMs","f","sin","sYwater","sYlava","gAcc","WeatherClouds","bandHeight","patches","filters","BlurFilter","quality","rebuild","nv","count","w","h","rx","ry","circles","baseR","k","PI","dist","cx","cos","cy","cur","W","bandBottom","osc","WeatherFog","noiseTex","_createNoiseTexture","layer1","TilingSprite","layer2","tileScale","_recalcParams","_draw","_alphaFromIntensity","_applyAlphas","resize","baseAlpha","pulse","tilePosition","speed1","speed2","pulseFactor","noiseAlpha","lerp","a","b","u","canvas","createElement","ctx","getContext","img","createImageData","putImageData","WeatherThunder","nextStrikeMs","Infinity","flashAlpha","flashDecay","boltAlive","boltTime","boltDuration","flashG","boltG","_scheduleNextStrike","_redrawFlash","_clearBolt","H","curInt","_triggerFlash","_createBolt","decayPerMs","remain","initial","minDelay","_lerp","maxDelay","delay","_rand","topY","targetY","_findGroundY","endY","segments","jitterX","points","thickness","moveTo","lineTo","stroke","alignment","cap","join","branchCount","len","ang","bx","by","worldX","maxH","isSolid","WaterSplashFX","node","Container","droplets","rings","maxDroplets","maxRings","trigger","upward","s","vr","spd","d","size","LavaEmbers","spawnAcc","embers","maxEmbers","surfaces","rebuildSurfaces","registryItems","getDef","isLava","def","flags","lava","TS","spans","gy","runStart","gx","aboveLava","_spawnOne","trail","baseRate","mult","shift","emberAlpha","emberSize","p0","p1","LavaSteamFX","puffs","maxPuffs","radius","LiquidRegionSystem","opts","_regions","_waterTex","_lavaTex","_time","_noiseTex","_playerState","setPlayerState","playerState","_checkPlayerInRegion","region","px","py","pw","ph","getBounds","getSurfaceY","X","topEdges","mw","mh","ts","changed","waterDrift","lavaDrift","sprite","playerInRegion","noise1","noise2","waves","lifeMsWater","lifeMsLava","startRadius","decay","exp","ampNow","amp","capG","dy","centerX","dx","sigma","gauss","maxDisp","build","typeAt","liquid","water","visited","Uint8Array","dirs","regionTiles","queue","_addRegion","tileIndices","mask","worldW","worldH","bleed","_createLavaTexture","_createWaterTexture","source","addressMode","tiling","_computeTopEdgeSpans","createLinearGradient","addColorStop","fillStyle","fillRect","globalAlpha","Set","tilesByRow","above","rowList","cols","entries","sort","start","prev","addWave","HealthBar","options","super","offsetX","offsetY","thresholds","ok","trackColor","borderColor","borderAlpha","_w","_h","_pct","_color","_thresholds","_colors","_trackColor","_borderColor","_borderAlpha","_track","_fill","_redrawAll","visible","c","pct","_redrawFill","roundRect","innerW","freeze","parallax","tiles","tilesAnim","objBehind","secretsBelow","objFront","secretsAbove","weather","fog","liquids","liquidFx","textureCacheMap","getTexture","msToSpeed","ms","getRegItem","isWaterDef","isLavaDef","ParallaxBackground","textureCache","cache","bgSprite","imgSprite","_worldW","_worldH","_lastCameraX","_currentUrl","worldWidth","worldHeight","factor","minWidth","minHeight","hex","parseInt","slice","solid","Sprite","WHITE","tint","setupImage","baseTexture","wrapMode","WRAP_MODES","REPEAT","texH","scaleY","setScroll","Assets","valid","load","then","loadedTex","catch","err","cameraX","buildSpriteFromDef","spr","frames","Boolean","AnimatedSprite","play","editorIcon","Text","dropShadow","dropShadowColor","dropShadowBlur","dropShadowDistance","anchor","rebuildLayers","refs","isEditor","bgRef","objBehindRef","objFrontRef","secretLayerRef","removeChildren","below","secretId","secretDef","secretSubtype","subtype","isInOpenArea","isInSecretArea","isSecretRevealed","renderOnSecretLayer","normalLayerCount","visualElement","spriteSheet","totalSprites","columns","healthPercent","frameIndex","frameWidth","frameHeight","col","row","Rectangle","frameTexture","frame","isHiddenInGame","isDestructible","hb","renderAbovePlayer","setPreferences","skipCacheIdWarning","EMPTY_ARRAY","EMPTY_OBJECT","PixiStage","playerVisuals","backgroundImage","mountRef","appRef","parallaxRef","parallaxManagerRef","cameraScrollRef","parallaxFactorRef","cameraPosRef","bgAnimRef","bgImageRef","bgColorRef","playerRef","playerSpriteRefs","hit","playerHealthBarRef","playerStateRef","weatherLayerRef","liquidLayerRef","liquidSystemRef","fogLayerRef","weatherSystemsRef","rain","snow","clouds","thunder","projectilesLayerRef","projectileSpritesRef","entitiesLayerRef","entitySpritesRef","projectilesPropRef","pixiTextureCacheRef","hbEnabledRef","oxyEnabledRef","lavaEnabledRef","overlayLayerRef","underwaterRef","overlayHBRef","oxygenBarRef","lavaBarRef","waterFxRef","lavaEmbersRef","lavaSteamRef","splashesEnabledRef","embersEnabledRef","waterStateRef","headUnder","resolveBackgroundUrl","useMemo","createBackgroundResolver","bgContext","metaPath","split","createSolidChecker","wx","wy","collision","top","bottom","left","right","rebuildParallax","useCallback","layer","createParallaxManager","parallaxLayer","textureCacheRef","parallaxHelper","parallaxSprite","resolvedUrl","helper","bgUrl","bgColor","screen","destroyed","async","app","Application","resizeTo","backgroundAlpha","antialias","autoDensity","renderer","stage","sortableChildren","bg","bgAnim","secretBelowLayer","secretAboveLayer","playerLayer","entitiesLayer","weatherLayer","liquidLayer","liquidFxLayer","fogLayer","projLayer","overlayLayer","LAYERS","urlSet","addUrl","add","urls","playerComponents","createPlayerContainer","playerContainer","defaultDef","targetDef","defSprite","hitSprite","healthBar","sprites","innerHTML","appendChild","hbOverlay","oxyColors","oxyBar","lavaColors","lvBar","preventDefault","ticker","updatePlayerSprite","inLava","effectiveWidth","isHit","dir","mag","scale","sw","sh","camX","camY","pivot","position","deltaMS","systems","sNow","nowInWater","nowLiquid","sy","s2","effW","effH","baseYOffset","baseX","baseY","hbO","show","nextBarY","maxOxy","curOxy","maxLv","curLv","syncProjectiles","projectilesLayer","projectileSpritesMap","projectilesList","list","seen","defId","syncEntities","entitySpritesMap","entitiesList","ent","_lastFrameIndex","isTextureReady","currentSpriteIndex","texWidth","texHeight","effectiveColumns","targetWidth","targetHeight","isNaN","absScaleX","entities","appToDestroy","values","cleanupProjectiles","cleanupEntities","yy","getRainIntensity","getSnowIntensity","getCloudsIntensity","getThunderIntensity","propTypes","PropTypes","isRequired","floodFillSecretZone","startIndex","startSecretId","startDef","result","checkSecretDetection","currentX","currentY","playerLeft","playerRight","playerTop","playerBottom","minGX","maxGX","minGY","maxGY","revealOnEnter","connectedIndices","newIndices","triggerIndex","triggerSecretId","triggerSubtype","totalConnected","newToReveal","firstFiveNew","connectedSecretIds","beepFallback","vol","AC","AudioContext","webkitAudioContext","audioCtxRef","audioCtx","resume","currentTime","createOscillator","gain","createGain","frequency","setValueAtTime","exponentialRampToValueAtTime","connect","destination","stop","moveHorizontal","MOVE_SPEED","checkCollision","friction","acceleration","targetVx","sign","proposedX","applyVerticalPhysics","GRAVITY","TERMINAL_VELOCITY","JUMP_FORCE","isWaterAt","prevInWater","LIQ_TERMINAL","headY","chestY","space","swimImpulse","getLiquidAtPixel","mapWidthTiles","mapHeightTiles","tileData","params","buoyancy","dragX","drag","dragY","swimmable","dps","damagePerSecond","drainPerSecond","regenPerSecond","damagePerSecondWhenDepleted","resistance","sampleLiquidForAABB","feet","chest","head","candidate","inLiquid","tickLiquidDamage","env","deltaMs","accRef","gameState","HIT_FLASH_MS","updateFrame","objectData","input","constants","helpers","isInitialized","lastTimeRef","projectilesRef","entitiesRef","shootCooldownRef","liquidDamageAccumulatorRef","oxygenDepleteAccRef","lavaDepleteAccRef","getLiquidSample","collectItem","checkInteractables","checkHazardDamage","checkSecrets","spawnProjectile","updateProjectiles","setPlayer","onGameOver","continue","iceResist","maxIceResist","backgroundLayer","layers","l","getSurfaceProperties","isSlippery","currentIceRes","maxIce","effectiveFriction","ratio","targetFriction","checkCollisionExtended","isExploding","pt","vp","liquidParams","sample","maxLava","oxy","lavaRes","oxyParams","lavaParams","tickDepleteDps","dpsValue","currentAmmo","mouseLeft","playerX","playerY","entity","animFrame","animTimer","totalFrames","animations","explode","frameDuration","shouldRemove","mapW","mapH","arrowId","foundArrowDef","tx","ty","arrowsLayer","aDef","nextX","nextY","ai","reactionDist","reactionDistance","shootDist","shootDistance","sqrt","canJump","shootCooldown","isShooting","spawnX","spawnY","patrol","hitSomething","other","stayOnPlatform","groundX","groundY","frameSpeed","checkEntityCollision","explodeAnim","anims","currentAnim","frameDur","updateEntities","knockbackDir","onStateUpdate","damage","maxX","winCountSpeed","onIce","isSolidAtPixel","secretData","objId","objDef","isEntity","toLowerCase","passableHealthThreshold","tileId","tileDef","newX","newY","feetY","slipperiness","errorListeners","logLevel","setLogLevel","level","addListener","callback","removeListener","cb","notifyListeners","context","handle","errorObj","String","logData","message","stack","shouldLog","toUpperCase","sendToLoggingService","levels","debug","currentLevel","wrapAsync","fn","args","wrapSync","parseBool","trim","useGameEngine","onRevealSecret","useInput","clearKeys","handleKeyDown","tag","tagName","typing","isContentEditable","repeat","handleMouseDown","handleMouseUp","handleKeyUp","onToggleTerminal","passive","requestRef","hazardDamageAccumulatorRef","lastHazardIndexRef","triggeredHazardsRef","projectileIdRef","soundEnabledRef","audioCtxUnlockedRef","onStateUpdateRef","onRevealSecretRef","onGameOverRef","objectMetadataRef","revealedSecretsRef","onToggle","onUserGesture","playShotSfx","audio","Audio","pause","once","playSfx","checkHazardDamageWrapper","objectLayerData","candidates","pushCandidate","touch","damageDirections","tileLeft","tileRight","tileTop","tileBottom","touchMargin","touchingTop","touchingBottom","touchingLeft","touchingRight","distTop","distBottom","distLeft","distRight","sideScore","chosen","prevIndex","damageOnce","baseDamage","immediate","TICK_MS","errorHandler","component","function","playerPosition","damageType","localRevealedRef","lastMapIdRef","currentMapId","date_map_last_updated","date_map_created_at","isNewMapLoad","initialEntities","objLayer","findIndex","startX","startY","playerId","registryPlayer","maxXAtStart","mapHeightParam","widthOverride","heightOverride","checkCollisionExternal","TILE_SIZE_OVERRIDE","tileDataOverride","registryItemsOverride","secretDataOverride","objectDataOverride","objectMetadataOverride","isSolidAtPixelExternal","originX","originY","ownerId","pDef","lifespan","ricochetFlag","ricochetOnTiles","collisionWithPenetration","proj","cwt","collisionWithTiles","hbs","hitboxScale","ric","dmg","spawnProjectileExternal","td","ri","isWaterAtPixel","liq","sampleLiquid","aabb","objectLayer","centerY","gridX","itemId","itemDef","pickup","effect","healthBonus","newHealth","fireball","ammoBonus","currentMeta","triggerId","destId","destMeta","usedInteractables","checkSecretsWrapper","mergedRevealed","indicesToReveal","dtProj","isSolidRect","hw","hh","pts","checkObjectHit","checkEntityHit","ex","ey","ew","eh","checkPlayerHit","maxBounces","bounceDamp","bounceDamping","ricRand","ricochetRandom","maxDelta","steps","stepTime","removed","hitEntX","hitIdxX","sp","hypot","jitter","hitEntY","hitIdxY","res","requestAnimationFrame","cancelAnimationFrame","HeaderContainer","AmmoDisplay","RightSection","BarsContainer","BarWrapper","BarFill","$percent","$color","BarLabel","GameHeader","hpPercent","oxyPercent","lavaPercent","icePercent","commands","register","cmd","listCommands","description","executeCommand","raw","handler","panelStyleBase","fontFamily","borderTop","boxShadow","transition","GameTerminal","open","setOpen","lines","setLines","setInput","scrollRef","inputRef","suppressUntilRef","onClear","onClose","performance","setTimeout","focus","onKey","scrollTop","scrollHeight","transform","borderBottom","flex","overflowY","whiteSpace","lineHeight","onSubmit","onKeyDown","stopPropagation","onChange","placeholder","outline","cursor","GameSettings","activeTab","setActiveTab","setParallax","__GAME_RUNTIME_SETTINGS__","setRain","ls","setSnow","setClouds","lsNew","lsOld","setThunder","setFog","setHealthBarEnabled","setOxygenBarEnabled","setLavaBarEnabled","setWaterSplashesEnabled","setLavaEmbersEnabled","minimized","setMinimized","pos","setPos","setSize","draggingRef","active","clampPos","sz","isMin","vw","innerWidth","vh","innerHeight","maxL","maxT","onOpen","onMove","clientX","clientY","onUp","onResize","emitUpdate","patch","panelStyle","userSelect","contentStyle","buttonStyle","marginLeft","tabsBarStyle","overflowX","onMouseDown","onMinToggle","tab","marginBottom","step","defaultValue","parseFloat","textAlign","toFixed","defaultChecked","marginTop","checked","startW","startH","move","ev","dw","dh","nw","nh","up","BackgroundMusicPlayer","audioRef","currentSrcRef","musicContext","cleanup","src","resolveUrl","loop","onGesture","val","BUILT_IN_MAPS","GameContainer","ModalOverlay","ModalContent","ModalTitle","h2","MapList","MapCard","MapTitle","MapAuthor","MapInfo","WinCounterOverlay","ModalDivider","FileUploadLabel","label","HiddenFileInput","Viewport","$blurred","GameCanvas","PlaceholderMessage","Game","viewportRef","runtimeSettings","setRuntimeSettings","handleStateUpdate","currentId","alert","handleGameOver","mapToLoad","loadMapData","indices","onSettingsUpdate","handleOpenModalEvent","weatherFogLegacy","objData","bgLayer","secretLayer","hasSecretsLayer","secretDataLength","secretDataNonNull","secretDataSample","mapName","dimensions","author","accept","file","files","fileReader","FileReader","readAsText","onload","loaded","fileName","onerror","backgroundMusic","contents","suggestedName","mimeType","showSaveFilePicker","types","writable","createWritable","blob","Blob","write","close","link","href","URL","createObjectURL","download","body","click","revokeObjectURL","getFloodFillIndices","currentData","startId","matchingIndices","paintTile","selectedTile","brushSize","getCurrentData","setCurrentData","newData","targetX","AnimatedItem","alt","setIndex","interval","setInterval","clearInterval","imgSrc","total","rows","maxWidth","maxHeight","draggable","selectedBackgroundUrl","selectedBackgroundColor","selectedBackgroundImage","showGrid","activeLayer","activeTool","hoverIndex","highlightedIndex","bucketPreviewIndices","selection","previewPosition","dragStart","isDragging","handleGridMouseDown","handleGridMouseEnter","handleGridMouseUp","handleGridMouseLeave","setIsDragging","onMouseUp","onMouseLeave","pointerEvents","opacity","links","portals","targets","x1","y1","x2","y2","strokeWidth","strokeDasharray","backgroundRepeat","backgroundSize","gridTemplateColumns","gridTemplateRows","_","displayTileId","displayObjectId","displaySecretId","selX","selY","selectionIndex","tileObj","objObj","secretObj","isSelected","isPreviewSelection","originalX","originalY","isMoveSelecting","isMoveHover","hx","hy","sx","minX","minY","maxY","isBrushTarget","isBucketTarget","isBucketPreview","borderStyle","bgStyle","isHighlighted","isLiquidTile","isWaterTile","isLavaTile","backgroundStyleObj","onMouseEnter","boxSizing","objectFit","textShadow","filterColor","baseButtonStyle","marginRight","textDecoration","activeButtonStyle","NewMapModal","isOpen","tempMapName","setTempMapName","tempCreatorName","setTempCreatorName","confirmNewMap","DraggableWindow","defaultPosition","defaultWidth","isOpenDefault","onHeightChange","dragOffset","setDragOffset","currentPosition","setCurrentPosition","isMinimized","setIsMinimized","isClosed","setIsClosed","hasBeenDragged","setHasBeenDragged","windowRef","lastHeightRef","offsetHeight","handleMouseMove","getBoundingClientRect","borderTopLeftRadius","borderTopRightRadius","PaletteSection","setIsOpen","Minimap","canvasRef","minimapWidth","minimapHeight","tileWidth","tileHeight","objectId","tile","obj","strokeStyle","lineWidth","beginPath","portal","setLineDash","imageRendering","MapResizer","containerRef","startSize","setStartSize","startMousePos","setStartMousePos","displayWidth","displayHeight","blocksX","blocksY","newWidth","newHeight","ToolbarWindows","creatorName","openNewMapModal","saveMap","loadMap","setShowGrid","clearMap","isPlayMode","handlePlay","handlePause","handleReset","setActiveTool","setBrushSize","moveSelection","setSelection","selectionMode","setSelectionMode","commitSelection","cancelSelection","handlePaletteSelect","blocks","decorations","interactables","hazards","secrets","backgroundOptions","setSelectedBackgroundImage","setSelectedBackgroundColor","setBackgroundParallaxFactor","musicOptions","selectedBackgroundMusic","setSelectedBackgroundMusic","totalTiles","filledBlocks","emptyBlocks","objectsCount","setObjectMetadata","onMapResize","setHighlightedIndex","activePanel","setActivePanel","isMinimapOpen","setIsMinimapOpen","setIsSettingsOpen","isResizeWindowOpen","setIsResizeWindowOpen","togglePanel","panel","sidebarButtonStyle","activeSidebarButtonStyle","borderRight","panelHeaderStyle","paddingBottom","panelTitleStyle","renderPaletteItem","hasImage","isLiquid","isWater","isSecret","swatchStyle","BlockEraser","ObjectEraser","SecretEraser","paddingTop","flexWrap","li","fontStyle","el","querySelector","scrollX","clientWidth","scrollY","clientHeight","scrollTo","behavior","Editor","setMapWidth","setMapHeight","setTileMapData","setObjectMapData","setSecretMapData","setSelectedTile","setHoverIndex","setActiveLayer","setDragStart","setBucketPreviewIndices","isMovingSelection","setIsMovingSelection","setPreviewPosition","originalMapData","setOriginalMapData","bucketTimerRef","stateRef","setMapName","setCreatorName","createdAt","setCreatedAt","isNewMapModalOpen","setIsNewMapModalOpen","loadBackgroundOptions","loadMusicOptions","handleSaveMap","currentDate","version","statistics","total_tiles","filled_tiles","total_objects","total_items","json","saveFile","setIsPlayMode","editorSnapshot","setEditorSnapshot","setPlayerPosition","setRevealedSecrets","playModeObjectData","setPlayModeObjectData","playModeSecretData","setPlayModeSecretData","mapDataForGame","handleRevealSecret","secretIndex","gameEngineState","selectedBgOption","newMetadata","metadataChanged","newTileMap","tileMap","newObjectMap","objectMap","newSecretMap","secretMap","destX","destY","destIdx","srcDataIdx","confirm","normalized","playData","spawnIndex","pauseData","playerIndex","resetData","handleMapResize","resizeMapData","oldW","oldH","oldTiles","oldObjs","oldSecrets","oldMeta","resizeArray","oldArr","newArr","oldM","newM","oldIdx","newIdx","resizeMetadata","floodFill","targetId","clearTimeout","endX","selTileData","selObjectData","selSecretData","Crystals","Repository","cardStyle","imageStyle","fieldsContainerStyle","onError","wordBreak","ReactDOM","getElementById","render","Provider","store","ThemeProvider","theme","GlobalStyles","BrowserRouter","basename","Routes","Route","element","App"],"ignoreList":[],"sourceRoot":""}