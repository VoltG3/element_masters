{"version":3,"file":"static/js/main.2c655dca.js","mappings":"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","sources":["webpack://element_masters/./src/assets/images/ sync \\.(png%7Cjpe","webpack://element_masters/./src/assets/background/ sync nonrecursive \\.(png%7Cjpe","webpack://element_masters/./src/store/slices/gameSlice.js","webpack://element_masters/./src/store/slices/uiSlice.js","webpack://element_masters/./src/store/index.js","webpack://element_masters/./src/styles/theme.js","webpack://element_masters/./src/styles/GlobalStyles.js","webpack://element_masters/./src/i18n/i18n.js","webpack://element_masters/./src/sections/section.header.navigation.chapters.js","webpack://element_masters/./src/sections/section.header.navigation.languages.js","webpack://element_masters/./src/sections/section.header.navigation.logo.js","webpack://element_masters/./src/sections/section.header.js","webpack://element_masters/./src/sections/section.footer.js","webpack://element_masters/./src/sections/section.content.js","webpack://element_masters/./src/engine/registry/index.js","webpack://element_masters/./src/App.js","webpack://element_masters/./src/config.js","webpack://element_masters/./src/sections/chapters/home.jsx","webpack://element_masters/./src/Pixi/TextureCache.js","webpack://element_masters/./src/Pixi/effects/weather/Rain.js","webpack://element_masters/./src/Pixi/effects/weather/Snow.js","webpack://element_masters/./src/Pixi/effects/weather/Clouds.js","webpack://element_masters/./src/Pixi/effects/weather/Fog.js","webpack://element_masters/./src/Pixi/effects/weather/Thunder.js","webpack://element_masters/./src/Pixi/effects/weather/LavaRain.js","webpack://element_masters/./src/Pixi/effects/weather/RadioactiveFog.js","webpack://element_masters/./src/Pixi/effects/weather/MeteorRain.js","webpack://element_masters/./src/Pixi/effects/liquids/WaterSplashFX.js","webpack://element_masters/./src/Pixi/effects/liquids/BubbleFX.js","webpack://element_masters/./src/Pixi/effects/liquids/LavaEmbers.js","webpack://element_masters/./src/Pixi/effects/liquids/LavaSteamFX.js","webpack://element_masters/./src/Pixi/effects/liquids/LiquidRegionSystem.js","webpack://element_masters/./src/Pixi/ui/HealthBar.js","webpack://element_masters/./src/renderer/stage/layers/LayerOrder.js","webpack://element_masters/./src/sections/chapters/game/PixiStage/helpers.js","webpack://element_masters/./src/sections/chapters/game/PixiStage/liquidRendering.js","webpack://element_masters/./src/Pixi/layers/ParallaxBackground.js","webpack://element_masters/./src/sections/chapters/game/PixiStage/parallaxManager.js","webpack://element_masters/./src/sections/chapters/game/PixiStage/playerManager.js","webpack://element_masters/./src/sections/chapters/game/PixiStage/layerBuilder.js","webpack://element_masters/./src/sections/chapters/game/PixiStage/floatingTextManager.js","webpack://element_masters/./src/sections/chapters/game/PixiStage/breakEffectManager.js","webpack://element_masters/./src/engine/liquids/liquidUtils.js","webpack://element_masters/./src/sections/chapters/game/PixiStage/index.jsx","webpack://element_masters/./src/sections/chapters/game/PixiStage/projectileManager.js","webpack://element_masters/./src/sections/chapters/game/PixiStage/entityManager.js","webpack://element_masters/./src/engine/gameplay/collectItem.js","webpack://element_masters/./src/engine/gameplay/interactables/context.js","webpack://element_masters/./src/engine/gameplay/interactables/spawn.js","webpack://element_masters/./src/engine/gameplay/interactables/doors.js","webpack://element_masters/./src/engine/gameplay/interactables/teleport.js","webpack://element_masters/./src/engine/gameplay/interactables/effects.js","webpack://element_masters/./src/engine/gameplay/secrets/reveal.js","webpack://element_masters/./src/i18n/tutorialMessages.js","webpack://element_masters/./src/engine/gameplay/secrets/triggers.js","webpack://element_masters/./src/engine/gameplay/secrets/wolfSecret.js","webpack://element_masters/./src/engine/gameplay/secrets/crackBlock.js","webpack://element_masters/./src/engine/gameplay/interactables/checkInteractables.js","webpack://element_masters/./src/engine/gameplay/hazards.js","webpack://element_masters/./src/engine/gameplay/meteorBreakEffects.js","webpack://element_masters/./src/engine/gameplay/biologicalBreakEffects.js","webpack://element_masters/./src/engine/audio/audio.js","webpack://element_masters/./src/engine/physics/horizontal.js","webpack://element_masters/./src/engine/physics/vertical.js","webpack://element_masters/./src/engine/gameplay/weatherDamage.js","webpack://element_masters/./src/engine/physics/collision.js","webpack://element_masters/./src/engine/gameplay/weatherCover.js","webpack://element_masters/./src/engine/gameplay/entities.js","webpack://element_masters/./src/engine/loop/updateFrame.js","webpack://element_masters/./src/constants/gameConstants.js","webpack://element_masters/./src/services/errorHandler.js","webpack://element_masters/./src/utilities/useGameEngine.js","webpack://element_masters/./src/utilities/useInput.js","webpack://element_masters/./src/engine/gameplay/weatherEffects.js","webpack://element_masters/./src/engine/gameplay/spawnProjectile.js","webpack://element_masters/./src/engine/gameplay/updateProjectiles.js","webpack://element_masters/./src/utilities/AnimatedItem.jsx","webpack://element_masters/./src/sections/chapters/game/GameHeader.jsx","webpack://element_masters/./src/commands/gameCommands.js","webpack://element_masters/./src/sections/chapters/game/GameTerminal.jsx","webpack://element_masters/./src/sections/chapters/game/GameSettings.jsx","webpack://element_masters/./src/engine/gameplay/breakEffects.js","webpack://element_masters/./src/utilities/BackgroundMusicPlayer.jsx","webpack://element_masters/./src/sections/chapters/shared/MessageOverlay.jsx","webpack://element_masters/./src/constants/builtInMaps.js","webpack://element_masters/./src/sections/chapters/game/index.jsx","webpack://element_masters/./src/utilities/saveFile.js","webpack://element_masters/./src/sections/chapters/editor/editorTools/mapOperations.js","webpack://element_masters/./src/sections/chapters/editor/viewport/ObjectLinks.jsx","webpack://element_masters/./src/sections/chapters/editor/viewport/EditorTile.jsx","webpack://element_masters/./src/sections/chapters/editor/Viewport.jsx","webpack://element_masters/./src/sections/chapters/editor/styles/EditorToolsButton.jsx","webpack://element_masters/./src/sections/chapters/editor/styles/EditorElementsButtonStyle.js","webpack://element_masters/./src/sections/chapters/editor/editorTools/NewMapModal.jsx","webpack://element_masters/./src/sections/chapters/editor/editorTools/BuiltInMapsModal.jsx","webpack://element_masters/./src/sections/chapters/editor/editorScene/DraggableWindow.jsx","webpack://element_masters/./src/sections/chapters/editor/editorScene/EditorMapResizer.jsx","webpack://element_masters/./src/sections/chapters/editor/editorScene/Minimap.jsx","webpack://element_masters/./src/sections/chapters/editor/editorScene/WorldView.jsx","webpack://element_masters/./src/sections/chapters/editor/editorScene/BackgroundPanel.jsx","webpack://element_masters/./src/sections/chapters/editor/editorScene/MusicPanel.jsx","webpack://element_masters/./src/sections/chapters/editor/editorScene/WeatherPanel.jsx","webpack://element_masters/./src/sections/chapters/editor/styles/EditorSceneButtonStyle.js","webpack://element_masters/./src/sections/chapters/editor/EditorScene.jsx","webpack://element_masters/./src/sections/chapters/editor/editorElements/OperationsPanel.jsx","webpack://element_masters/./src/sections/chapters/editor/editorElements/CollapsiblePanel.jsx","webpack://element_masters/./src/sections/chapters/editor/editorElements/PalettePanel.jsx","webpack://element_masters/./src/sections/chapters/editor/editorElements/StatisticsPanel.jsx","webpack://element_masters/./src/sections/chapters/editor/editorElements/ObjectPropsPanel.jsx","webpack://element_masters/./src/sections/chapters/editor/EditorElements.jsx","webpack://element_masters/./src/sections/chapters/editor/EditorTools.jsx","webpack://element_masters/./src/sections/chapters/editor/hooks/useEditorPlayMode.js","webpack://element_masters/./src/sections/chapters/editor/hooks/useEditorOperations.js","webpack://element_masters/./src/sections/chapters/editor/editorTools/paintingTools.js","webpack://element_masters/./src/sections/chapters/editor/hooks/useEditorPainting.js","webpack://element_masters/./src/sections/chapters/editor/Editor.jsx","webpack://element_masters/./src/sections/chapters/editor/assetLoaders.js","webpack://element_masters/./src/sections/chapters/editor/hooks/useEditorMaps.js","webpack://element_masters/./src/sections/chapters/editor/hooks/useEditorRegistry.js","webpack://element_masters/./src/sections/chapters/editor/hooks/useEditorSelection.js","webpack://element_masters/./src/sections/chapters/crystals.jsx","webpack://element_masters/./src/sections/chapters/repository.jsx","webpack://element_masters/./src/index.js","webpack://element_masters/./src/assets/sound/ sync \\.(mp3%7Cwav%7Cogg%7Cm4a%7Caac%7Cflac%7Cwebm)$","webpack://element_masters/./src/assets/json/ sync \\.json$","webpack://element_masters/./src/assets/sound/background/ sync nonrecursive \\.(ogg%7Cmp3%7Cwav%7Cm4a)$i"],"sourcesContent":["var map = {\n\t\"./blocks/block_pack_01/block_pack_01.png\": 8473,\n\t\"./blocks/block_pack_01/ice_block_0001.png\": 9745,\n\t\"./blocks/brick_block_0001.png\": 3611,\n\t\"./blocks/desert_pack_01/desert_pack_0001.png\": 7741,\n\t\"./blocks/desert_pack_01/desert_pack_0002.png\": 182,\n\t\"./blocks/desert_pack_01/desert_pack_0003.png\": 1727,\n\t\"./blocks/desert_pack_01/desert_pack_0004.png\": 6352,\n\t\"./blocks/desert_pack_01/desert_pack_0005.png\": 2601,\n\t\"./blocks/desert_pack_01/desert_pack_0006.png\": 6018,\n\t\"./blocks/desert_pack_01/desert_pack_0007.png\": 6523,\n\t\"./blocks/desert_pack_01/desert_pack_0008.png\": 5132,\n\t\"./blocks/desert_pack_01/desert_pack_0009.png\": 1045,\n\t\"./blocks/diorite_block.png\": 8276,\n\t\"./blocks/dirt_block_0001.png\": 9538,\n\t\"./blocks/grass_block_0001.png\": 1764,\n\t\"./blocks/sand_block_0001.png\": 2250,\n\t\"./blocks/sand_block_0002.png\": 2145,\n\t\"./blocks/water_block.png\": 1635,\n\t\"./decorations/stone_pack_01/stone_pack_01_001.png\": 1978,\n\t\"./decorations/stone_pack_01/stone_pack_01_002.png\": 4526,\n\t\"./decorations/stone_pack_01/stone_pack_01_003.png\": 7928,\n\t\"./decorations/stone_pack_01/stone_pack_01_004.png\": 9447,\n\t\"./decorations/stone_pack_01/stone_pack_01_005.png\": 1134,\n\t\"./decorations/stone_pack_01/stone_pack_01_006.png\": 8485,\n\t\"./decorations/stone_pack_01/stone_pack_01_007.png\": 3036,\n\t\"./decorations/stone_pack_01/stone_pack_01_008.png\": 7195,\n\t\"./decorations/stone_pack_01/stone_pack_01_009.png\": 9330,\n\t\"./decorations/stone_pack_01/stone_pack_01_010.png\": 2952,\n\t\"./entities/animals/fish_01.png\": 6781,\n\t\"./entities/player/player_dead_01.png\": 2735,\n\t\"./entities/player/player_dead_02.png\": 2820,\n\t\"./entities/player/player_dead_03.png\": 5325,\n\t\"./entities/player/player_dead_04.png\": 3762,\n\t\"./entities/player/player_dead_05.png\": 2763,\n\t\"./entities/player/player_dead_06.png\": 7728,\n\t\"./entities/player/player_dead_07.png\": 8905,\n\t\"./entities/player/player_dead_08.png\": 3662,\n\t\"./entities/player/player_dead_09.png\": 1351,\n\t\"./entities/player/player_dead_10.png\": 1297,\n\t\"./entities/player/player_default_100.A.png\": 6847,\n\t\"./entities/player/player_default_100.B.png\": 4388,\n\t\"./entities/player/player_target_100.A.png\": 2155,\n\t\"./entities/player/player_target_100.B.png\": 8336,\n\t\"./entities/tanks/tank_0000.png\": 2386,\n\t\"./entities/tanks/tank_0001.png\": 3563,\n\t\"./entities/tanks/tank_0002.png\": 5232,\n\t\"./hazards/bushes_001.png\": 6343,\n\t\"./hazards/death_block_0001.png\": 3527,\n\t\"./interactables/arrows/arrow_down.png\": 7152,\n\t\"./interactables/arrows/arrow_left.png\": 8047,\n\t\"./interactables/arrows/arrow_right.png\": 592,\n\t\"./interactables/arrows/arrow_up.png\": 7263,\n\t\"./interactables/berry_bush_01_A.png\": 2534,\n\t\"./interactables/berry_bush_01_B.png\": 4157,\n\t\"./interactables/berry_bush_02_A.png\": 3945,\n\t\"./interactables/berry_bush_02_B.png\": 7858,\n\t\"./interactables/doors/door_0001.png\": 175,\n\t\"./interactables/ends/end_0001.png\": 8597,\n\t\"./interactables/ledders/ledder_steel_01.png\": 5227,\n\t\"./interactables/ledders/ledder_wooden_01.png\": 3368,\n\t\"./interactables/platforms/platform_0001.png\": 9427,\n\t\"./interactables/portals/portal_01/portal_A_001.png\": 8518,\n\t\"./interactables/portals/portal_01/portal_A_002.png\": 3933,\n\t\"./interactables/portals/portal_01/portal_A_003.png\": 692,\n\t\"./interactables/portals/portal_01/portal_A_004.png\": 5499,\n\t\"./interactables/portals/portal_01/portal_A_005.png\": 3954,\n\t\"./interactables/portals/portal_01/portal_A_006.png\": 8489,\n\t\"./interactables/portals/portal_01/portal_A_007.png\": 4288,\n\t\"./interactables/portals/portal_01/portal_A_008.png\": 8519,\n\t\"./interactables/portals/portal_01/portal_A_009.png\": 2734,\n\t\"./interactables/portals/portal_01/portal_A_010.png\": 3124,\n\t\"./interactables/portals/portal_01/portal_A_011.png\": 4253,\n\t\"./interactables/portals/portal_01/portal_A_012.png\": 6838,\n\t\"./interactables/portals/portal_01/portal_A_013.png\": 5583,\n\t\"./interactables/portals/portal_01/portal_A_014.png\": 9712,\n\t\"./interactables/portals/portal_01/portal_A_015.png\": 5465,\n\t\"./interactables/portals/portal_01/portal_A_016.png\": 1458,\n\t\"./interactables/stone_0001.png\": 1020,\n\t\"./interactables/wooden_box_0001.png\": 1169,\n\t\"./items/fireball_basic_A.png\": 9240,\n\t\"./items/fireball_basic_B.png\": 4851,\n\t\"./items/fireball_basic_C.png\": 9290,\n\t\"./items/fireball_basic_D.png\": 9717,\n\t\"./items/hertz_item.A.png\": 7720,\n\t\"./items/hertz_item.B.png\": 3475,\n\t\"./projectiles/fireball_basic_A.png\": 9792,\n\t\"./projectiles/fireball_basic_B.png\": 1083,\n\t\"./projectiles/fireball_basic_C.png\": 9954,\n\t\"./projectiles/fireball_basic_D.png\": 4205,\n\t\"./secrets/crack_block.png\": 2789,\n\t\"./signs/sign01.png\": 9784\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 1621;","var map = {\n\t\"./City.png\": 3676,\n\t\"./Forest.png\": 6370,\n\t\"./UndergroundCave.png\": 2445,\n\t\"./seamless_01.jpg\": 2436,\n\t\"./seamless_02.jpg\": 2147,\n\t\"./seamless_03.jpg\": 2038,\n\t\"./seamless_04.jpg\": 8237,\n\t\"./seamless_05.jpg\": 3344,\n\t\"./seamless_06.jpg\": 719,\n\t\"./seamless_07.png\": 6390\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 2201;","/**\n * Game Slice\n * Manages game-level state (maps, registry, game status)\n */\n\nimport { createSlice } from '@reduxjs/toolkit';\n\nconst initialState = {\n  activeMapData: null,\n  tileMapData: [],\n  objectMapData: [],\n  secretMapData: [],\n  objectMetadata: {}, // Track metadata per object position { index: { health: 100, etc } }\n  revealedSecrets: [], // Track which secret zones have been revealed (array of indices)\n  objectTextureIndices: {}, // Track texture index per object position { index: textureIndex }\n  mapWidth: 20,\n  mapHeight: 15,\n  projectMaps: {}, // For Project v2.0 (multi-map)\n  isLoading: false,\n  error: null,\n  isPaused: false,\n  isGameOver: false,\n  activeRoomIds: [], // IDs of currently active rooms (overlays)\n};\n\nconst gameSlice = createSlice({\n  name: 'game',\n  initialState,\n  reducers: {\n    setActiveMap: (state, action) => {\n      const { mapData, tileMapData, objectMapData, secretMapData, mapWidth, mapHeight } = action.payload;\n      state.activeMapData = mapData;\n      state.tileMapData = tileMapData;\n      state.objectMapData = objectMapData;\n      state.secretMapData = secretMapData || [];\n      state.objectMetadata = mapData?.meta?.objectMetadata || mapData?.objectMetadata || {}; // Load initial metadata from map\n      state.revealedSecrets = []; // Reset revealed secrets on new map\n      state.objectTextureIndices = {}; // Reset texture indices on new map\n      state.mapWidth = mapWidth;\n      state.mapHeight = mapHeight;\n      state.activeRoomIds = []; // Reset active rooms on new map load\n      state.isGameOver = false;\n\n      // If this is a project (v2.0) with multiple maps\n      if (mapData?.maps) {\n        state.projectMaps = mapData.maps;\n      }\n    },\n    updateObjectMap: (state, action) => {\n      state.objectMapData = action.payload;\n    },\n    updateObjectMetadata: (state, action) => {\n      const { index, metadata, mapId } = action.payload;\n      const activeId = state.activeMapData?.meta?.activeMapId || state.activeMapData?.meta?.activeMap || 'main';\n      const targetId = mapId || activeId;\n      if (!mapId || mapId === 'main') {\n        state.objectMetadata[index] = {\n          ...(state.objectMetadata[index] || {}),\n          ...metadata\n        };\n        if (state.projectMaps[targetId]) {\n          if (!state.projectMaps[targetId].objectMetadata) {\n            state.projectMaps[targetId].objectMetadata = {};\n          }\n          state.projectMaps[targetId].objectMetadata[index] = {\n            ...(state.projectMaps[targetId].objectMetadata[index] || {}),\n            ...metadata\n          };\n        }\n      } else if (state.projectMaps[mapId]) {\n        if (mapId === activeId) {\n          state.objectMetadata[index] = {\n            ...(state.objectMetadata[index] || {}),\n            ...metadata\n          };\n        }\n        if (!state.projectMaps[mapId].objectMetadata) {\n          state.projectMaps[mapId].objectMetadata = {};\n        }\n        state.projectMaps[mapId].objectMetadata[index] = {\n          ...(state.projectMaps[mapId].objectMetadata[index] || {}),\n          ...metadata\n        };\n      }\n    },\n    removeObjectAtIndex: (state, action) => {\n      const { index, mapId } = typeof action.payload === 'object' ? action.payload : { index: action.payload, mapId: null };\n      const activeId = state.activeMapData?.meta?.activeMapId || state.activeMapData?.meta?.activeMap || 'main';\n      const targetId = mapId || activeId;\n      if (!mapId || mapId === 'main') {\n        if (state.objectMapData[index] !== undefined) {\n          state.objectMapData[index] = null;\n        }\n        if (state.projectMaps[targetId]) {\n          const room = state.projectMaps[targetId];\n          if (!room.objectMapData) {\n            const layerData = room.layers?.find(l => l.name === 'entities' || l.type === 'object')?.data;\n            room.objectMapData = layerData ? [...layerData] : [];\n          } else {\n            room.objectMapData = [...room.objectMapData];\n          }\n          if (index >= 0 && index < room.objectMapData.length) {\n            room.objectMapData[index] = null;\n          }\n        }\n      } else if (state.projectMaps[mapId]) {\n        if (mapId === activeId) {\n          if (state.objectMapData[index] !== undefined) {\n            state.objectMapData[index] = null;\n          }\n        }\n        const room = state.projectMaps[mapId];\n        if (!room.objectMapData) {\n          const layerData = room.layers?.find(l => l.name === 'entities' || l.type === 'object')?.data;\n          room.objectMapData = layerData ? [...layerData] : [];\n        } else {\n          // Make sure we are working with a fresh array if we want to trigger changes reliably\n          room.objectMapData = [...room.objectMapData];\n        }\n        \n        if (index >= 0 && index < room.objectMapData.length) {\n          room.objectMapData[index] = null;\n        }\n      }\n    },\n    removeTileAtIndex: (state, action) => {\n      const index = action.payload;\n      if (state.tileMapData[index] !== undefined) {\n        state.tileMapData[index] = null;\n      }\n    },\n    moveTileInMap: (state, action) => {\n      const { fromIndex, toIndex } = action.payload;\n      const len = state.tileMapData.length;\n      if (fromIndex < 0 || toIndex < 0 || fromIndex >= len || toIndex >= len) return;\n      if (state.tileMapData[fromIndex] === undefined) return;\n      state.tileMapData[toIndex] = state.tileMapData[fromIndex];\n      state.tileMapData[fromIndex] = null;\n    },\n    moveObjectInMap: (state, action) => {\n      const { fromIndex, toIndex } = action.payload;\n      const len = state.objectMapData.length;\n      if (fromIndex < 0 || toIndex < 0 || fromIndex >= len || toIndex >= len) return;\n      if (state.objectMapData[fromIndex] === undefined) return;\n      state.objectMapData[toIndex] = state.objectMapData[fromIndex];\n      state.objectMapData[fromIndex] = null;\n      \n      // Move metadata as well\n      if (state.objectMetadata[fromIndex]) {\n        state.objectMetadata[toIndex] = state.objectMetadata[fromIndex];\n        delete state.objectMetadata[fromIndex];\n      }\n    },\n    updateObjectAtIndex: (state, action) => {\n      const { index, newId, mapId } = action.payload;\n      const activeId = state.activeMapData?.meta?.activeMapId || state.activeMapData?.meta?.activeMap || 'main';\n      const targetId = mapId || activeId;\n      if (!mapId || mapId === 'main') {\n        if (state.objectMapData[index] !== undefined) {\n          state.objectMapData[index] = newId;\n        }\n        if (state.projectMaps[targetId]) {\n          const room = state.projectMaps[targetId];\n          if (!room.objectMapData) {\n            const layerData = room.layers?.find(l => l.name === 'entities' || l.type === 'object')?.data;\n            room.objectMapData = layerData ? [...layerData] : [];\n          } else {\n            room.objectMapData = [...room.objectMapData];\n          }\n          if (index >= 0 && index < room.objectMapData.length) {\n            room.objectMapData[index] = newId;\n          }\n        }\n      } else if (state.projectMaps[mapId]) {\n        if (mapId === activeId) {\n          if (state.objectMapData[index] !== undefined) {\n            state.objectMapData[index] = newId;\n          }\n        }\n        const room = state.projectMaps[mapId];\n        if (!room.objectMapData) {\n          const layerData = room.layers?.find(l => l.name === 'entities' || l.type === 'object')?.data;\n          room.objectMapData = layerData ? [...layerData] : [];\n        } else {\n          room.objectMapData = [...room.objectMapData];\n        }\n        if (index >= 0 && index < room.objectMapData.length) {\n          room.objectMapData[index] = newId;\n        }\n      }\n    },\n    setObjectTextureIndex: (state, action) => {\n      const { index, textureIndex } = action.payload;\n      state.objectTextureIndices[index] = textureIndex;\n    },\n    revealSecretZone: (state, action) => {\n      const indices = action.payload; // Array of tile indices to reveal\n      // Add new indices to revealed array (avoid duplicates)\n      indices.forEach(idx => {\n        if (!state.revealedSecrets.includes(idx)) {\n          state.revealedSecrets.push(idx);\n        }\n      });\n    },\n    toggleRoom: (state, action) => {\n      const roomId = action.payload;\n      if (state.activeRoomIds.includes(roomId)) {\n        state.activeRoomIds = state.activeRoomIds.filter(id => id !== roomId);\n      } else {\n        state.activeRoomIds.push(roomId);\n      }\n    },\n    clearRooms: (state) => {\n      state.activeRoomIds = [];\n    },\n    setLoading: (state, action) => {\n      state.isLoading = action.payload;\n    },\n    setError: (state, action) => {\n      state.error = action.payload;\n    },\n    setPaused: (state, action) => {\n      state.isPaused = action.payload;\n    },\n    setGameOver: (state, action) => {\n      state.isGameOver = action.payload;\n    },\n    resetGame: (state) => {\n      return { ...initialState, activeMapData: state.activeMapData };\n    },\n  },\n});\n\nexport const {\n  setActiveMap,\n  updateObjectMap,\n  updateObjectMetadata,\n  removeObjectAtIndex,\n  removeTileAtIndex,\n  moveTileInMap,\n  moveObjectInMap,\n  updateObjectAtIndex,\n  setObjectTextureIndex,\n  revealSecretZone,\n  toggleRoom,\n  clearRooms,\n  setLoading,\n  setError,\n  setPaused,\n  setGameOver,\n  resetGame,\n} = gameSlice.actions;\n\nexport default gameSlice.reducer;\n","/**\n * UI Slice\n * Manages UI state (modals, menus, notifications, etc.)\n */\n\nimport { createSlice } from '@reduxjs/toolkit';\n\nconst initialState = {\n  isMapModalOpen: true,\n  isSettingsOpen: false,\n  isTerminalOpen: false,\n  isPauseMenuOpen: false,\n  notifications: [],\n  cameraScrollX: 0,\n  shouldCenterMap: false,\n};\n\nconst uiSlice = createSlice({\n  name: 'ui',\n  initialState,\n  reducers: {\n    setMapModalOpen: (state, action) => {\n      state.isMapModalOpen = action.payload;\n    },\n    setSettingsOpen: (state, action) => {\n      state.isSettingsOpen = action.payload;\n    },\n    setTerminalOpen: (state, action) => {\n      state.isTerminalOpen = action.payload;\n      // Also set global flag for game loop\n      try {\n        window.__GAME_TERMINAL_OPEN__ = action.payload;\n      } catch {}\n    },\n    setPauseMenuOpen: (state, action) => {\n      state.isPauseMenuOpen = action.payload;\n    },\n    addNotification: (state, action) => {\n      state.notifications.push({\n        id: Date.now(),\n        timestamp: new Date().toISOString(),\n        ...action.payload,\n      });\n    },\n    removeNotification: (state, action) => {\n      state.notifications = state.notifications.filter(n => n.id !== action.payload);\n    },\n    clearNotifications: (state) => {\n      state.notifications = [];\n    },\n    setCameraScrollX: (state, action) => {\n      state.cameraScrollX = action.payload;\n    },\n    setShouldCenterMap: (state, action) => {\n      state.shouldCenterMap = action.payload;\n    },\n    resetUI: () => initialState,\n  },\n});\n\nexport const {\n  setMapModalOpen,\n  setSettingsOpen,\n  setTerminalOpen,\n  setPauseMenuOpen,\n  addNotification,\n  removeNotification,\n  clearNotifications,\n  setCameraScrollX,\n  setShouldCenterMap,\n  resetUI,\n} = uiSlice.actions;\n\nexport default uiSlice.reducer;\n","/**\n * Redux Store Configuration\n * Centralized state management for the game\n */\n\nimport { configureStore } from '@reduxjs/toolkit';\nimport gameReducer from './slices/gameSlice';\nimport uiReducer from './slices/uiSlice';\n\nconst store = configureStore({\n  reducer: {\n    game: gameReducer,\n    ui: uiReducer,\n  },\n  middleware: (getDefaultMiddleware) =>\n    getDefaultMiddleware({\n      serializableCheck: {\n        // Ignore these action types for serialization checks\n        ignoredActions: ['game/setActiveMap'],\n        // Ignore these field paths in all actions\n        ignoredActionPaths: ['payload.projectiles', 'payload.timestamp'],\n        // Ignore these paths in the state\n        ignoredPaths: ['game.activeMapData'],\n      },\n    }),\n  devTools: process.env.NODE_ENV !== 'production',\n});\n\nexport default store;\n","/**\n * Theme Configuration for Styled Components\n * Centralized design tokens and theme variables\n */\n\nconst theme = {\n  colors: {\n    primary: '#4CAF50',\n    secondary: '#2196F3',\n    danger: '#f44336',\n    warning: '#ff9800',\n    success: '#8bc34a',\n    info: '#00bcd4',\n    dark: '#222',\n    darkGray: '#333',\n    mediumGray: '#555',\n    lightGray: '#777',\n    background: '#111',\n    surface: '#f9f9f9',\n    overlay: 'rgba(0, 0, 0, 0.6)',\n    text: '#333',\n    textLight: '#666',\n    textDark: '#fff',\n    border: '#ddd',\n    borderLight: '#eee',\n  },\n\n  spacing: {\n    xs: '4px',\n    sm: '8px',\n    md: '16px',\n    lg: '24px',\n    xl: '32px',\n    xxl: '48px',\n  },\n\n  borderRadius: {\n    sm: '4px',\n    md: '6px',\n    lg: '8px',\n    xl: '12px',\n    round: '50%',\n  },\n\n  shadows: {\n    sm: '0 2px 4px rgba(0,0,0,0.1)',\n    md: '0 4px 8px rgba(0,0,0,0.2)',\n    lg: '0 10px 25px rgba(0,0,0,0.5)',\n  },\n\n  fontSize: {\n    xs: '11px',\n    sm: '12px',\n    md: '14px',\n    base: '16px',\n    lg: '18px',\n    xl: '24px',\n    xxl: '32px',\n  },\n\n  fontWeight: {\n    light: 300,\n    normal: 400,\n    medium: 500,\n    semibold: 600,\n    bold: 700,\n  },\n\n  transitions: {\n    fast: '0.15s ease',\n    normal: '0.3s ease',\n    slow: '0.5s ease',\n  },\n\n  zIndex: {\n    base: 1,\n    dropdown: 100,\n    modal: 1000,\n    tooltip: 1100,\n    notification: 1200,\n  },\n\n  breakpoints: {\n    mobile: '480px',\n    tablet: '768px',\n    desktop: '1024px',\n    wide: '1280px',\n  },\n};\n\nexport default theme;\n","/**\n * Global Styles using Styled Components\n */\n\nimport { createGlobalStyle } from 'styled-components';\n\nconst GlobalStyles = createGlobalStyle`\n  * {\n    margin: 0;\n    padding: 0;\n    box-sizing: border-box;\n  }\n\n  body {\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',\n      'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',\n      sans-serif;\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    overflow: hidden;\n  }\n\n  code {\n    font-family: source-code-pro, Menlo, Monaco, Consolas, 'Courier New',\n      monospace;\n  }\n\n  button {\n    cursor: pointer;\n    font-family: inherit;\n\n    &:disabled {\n      cursor: not-allowed;\n      opacity: 0.6;\n    }\n  }\n\n  input, textarea, select {\n    font-family: inherit;\n  }\n\n  a {\n    text-decoration: none;\n    color: inherit;\n  }\n\n  ul, ol {\n    list-style: none;\n  }\n\n  img {\n    max-width: 100%;\n    height: auto;\n  }\n\n  /* Scrollbar Styles */\n  ::-webkit-scrollbar {\n    width: 10px;\n    height: 10px;\n  }\n\n  ::-webkit-scrollbar-track {\n    background: #222;\n  }\n\n  ::-webkit-scrollbar-thumb {\n    background: #555;\n    border-radius: 5px;\n\n    &:hover {\n      background: #777;\n    }\n  }\n`;\n\nexport default GlobalStyles;\n","import i18n from \"i18next\"\nimport { initReactI18next } from \"react-i18next\"\n\nimport lv_navigation_home from \"./translations/lv/navigation_home.json\"\nimport no_navigation_home from  \"./translations/no/navigation_home.json\"\nimport en_navigation_home from  \"./translations/en/navigation_home.json\"\nimport ru_navigation_home from  \"./translations/ru/navigation_home.json\"\nimport ja_navigation_home from  \"./translations/ja/navigation_home.json\"\nimport lv_tutorial_messages from \"./translations/lv/tutorial_messages.json\"\nimport no_tutorial_messages from \"./translations/no/tutorial_messages.json\"\nimport en_tutorial_messages from \"./translations/en/tutorial_messages.json\"\nimport ru_tutorial_messages from \"./translations/ru/tutorial_messages.json\"\nimport ja_tutorial_messages from \"./translations/ja/tutorial_messages.json\"\nimport en_game_map_selector from \"./translations/en/game_map_selector.json\"\nimport en_editor_elements from \"./translations/en/editor_elements.json\"\nimport en_editor_scene from \"./translations/en/editor_scene.json\"\nimport en_editor_tools from \"./translations/en/editor_tools.json\"\nimport lv_game_map_selector from \"./translations/lv/game_map_selector.json\"\nimport no_game_map_selector from \"./translations/no/game_map_selector.json\"\nimport ru_game_map_selector from \"./translations/ru/game_map_selector.json\"\nimport ja_game_map_selector from \"./translations/ja/game_map_selector.json\"\nimport lv_editor_elements from \"./translations/lv/editor_elements.json\"\nimport no_editor_elements from \"./translations/no/editor_elements.json\"\nimport ru_editor_elements from \"./translations/ru/editor_elements.json\"\nimport ja_editor_elements from \"./translations/ja/editor_elements.json\"\nimport lv_editor_scene from \"./translations/lv/editor_scene.json\"\nimport no_editor_scene from \"./translations/no/editor_scene.json\"\nimport ru_editor_scene from \"./translations/ru/editor_scene.json\"\nimport ja_editor_scene from \"./translations/ja/editor_scene.json\"\nimport lv_editor_tools from \"./translations/lv/editor_tools.json\"\nimport no_editor_tools from \"./translations/no/editor_tools.json\"\nimport ru_editor_tools from \"./translations/ru/editor_tools.json\"\nimport ja_editor_tools from \"./translations/ja/editor_tools.json\"\n\nconst lv_navigation = {\n    ...lv_navigation_home\n}\n\nconst no_navigation = {\n    ...no_navigation_home\n}\n\nconst en_navigation = {\n    ...en_navigation_home\n}\n\nconst ru_navigation = {\n    ...ru_navigation_home\n}\n\nconst ja_navigation = {\n    ...ja_navigation_home\n}\n\ni18n\n    .use(initReactI18next)\n    .init({\n        lng: \"en\",\n        fallbackLng: \"en\",\n        supportedLngs: [\"lv\", \"no\", \"en\", \"ru\", \"ja\"],\n        ns: [\"navigation\", \"tutorial\", \"game\", \"editor_elements\", \"editor_scene\", \"editor_tools\"],\n        defaultNS: \"navigation\",\n        interpolation: { escapeValue: false },\n        resources: {\n            lv: {\n                navigation: lv_navigation,\n                tutorial: lv_tutorial_messages,\n                game: lv_game_map_selector,\n                editor_elements: lv_editor_elements,\n                editor_scene: lv_editor_scene,\n                editor_tools: lv_editor_tools\n            },\n            no: {\n                navigation: no_navigation,\n                tutorial: no_tutorial_messages,\n                game: no_game_map_selector,\n                editor_elements: no_editor_elements,\n                editor_scene: no_editor_scene,\n                editor_tools: no_editor_tools\n            },\n            en: {\n                navigation: en_navigation,\n                tutorial: en_tutorial_messages,\n                game: en_game_map_selector,\n                editor_elements: en_editor_elements,\n                editor_scene: en_editor_scene,\n                editor_tools: en_editor_tools\n            },\n            ru: {\n                navigation: ru_navigation,\n                tutorial: ru_tutorial_messages,\n                game: ru_game_map_selector,\n                editor_elements: ru_editor_elements,\n                editor_scene: ru_editor_scene,\n                editor_tools: ru_editor_tools\n            },\n            ja: {\n                navigation: ja_navigation,\n                tutorial: ja_tutorial_messages,\n                game: ja_game_map_selector,\n                editor_elements: ja_editor_elements,\n                editor_scene: ja_editor_scene,\n                editor_tools: ja_editor_tools\n            },\n        },\n    })\n\nexport default i18n\n","import styled from \"styled-components\"\nimport { NavLink } from \"react-router-dom\"\nimport { useTranslation } from \"react-i18next\"\n\nexport const NavLinkButton = styled(NavLink)`\n    display: flex;\n    align-items: center;\n    justify-content: center;\n\n    background-color: transparent;\n    color: lightgray;\n    border: 1px solid rgba(255, 255, 255, 0.3);\n    padding: 0 10px;\n    font-size: 13px;\n    font-weight: 600;\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n    cursor: pointer;\n    transition: all 0.3s ease;\n    white-space: nowrap;\n    border-radius: 0;\n    text-decoration: none;\n\n    &:hover {\n        background-color: #f4c542;\n        color: #2a2a2a;\n        border-color: #f4c542;\n    }\n\n    &.active {\n        background-color: rgba(255, 255, 255, 0.15);\n        border-color: rgba(255, 255, 255, 0.5);\n        color: black;\n    }\n`\n\nexport function SectionHeaderNavigationChapters() {\n    const { t } = useTranslation(\"navigation\");\n    const chapter_home = t(\"NAVIGATION_HOME\")\n    const chapter_game = t(\"NAVIGATION_NEW_GAME\")\n    const chapter_editor = t(\"NAVIGATION_EDITOR\")\n    const chapter_crystals = t(\"NAVIGATION_CRYSTALS\")\n    const chapter_repository = t(\"NAVIGATION_REPOSITORY\")\n\n    // JAUNS: Funkcija, kas nosta signlu atvrt modlo logu\n    const handleNewGameClick = () => {\n        // Nostam globlu notikumu, ko 'game.jsx' vars uztvert\n        window.dispatchEvent(new Event('open-new-game-modal'));\n    };\n\n    return (\n        <nav style={{ display: \"flex\", gap: \"0\" }}>\n            <NavLinkButton to=\"/\" className={({ isActive }) => isActive ? \"active\" : \"\"}>\n                { chapter_home }\n            </NavLinkButton>\n\n            {/* JAUNS: Pievienots onClick handleris */}\n            <NavLinkButton to=\"/game\" onClick={handleNewGameClick} className={({ isActive }) => isActive ? \"active\" : \"\"}>\n                { chapter_game }\n            </NavLinkButton>\n\n            <NavLinkButton to=\"/editor\" className={({ isActive }) => isActive ? \"active\" : \"\"}>\n                { chapter_editor }\n            </NavLinkButton>\n\n            <NavLinkButton to=\"/crystals\" className={({ isActive }) => isActive ? \"active\" : \"\"}>\n                { chapter_crystals }\n            </NavLinkButton>\n\n\n        </nav>\n    )\n}\n\n/*\n<NavLinkButton to=\"/repository\" className={({ isActive }) => isActive ? \"active\" : \"\"}>\n                { chapter_repository }\n            </NavLinkButton>\n* */","import styled from \"styled-components\"\nimport { useTranslation } from \"react-i18next\"\nimport { useState, useRef, useEffect } from \"react\"\n\nconst NavButton = styled.button`\n    display: flex;\n    align-items: center;\n    justify-content: center;\n\n    background-color: transparent;\n    color: lightgray;\n    border: 1px solid rgba(255, 255, 255, 0.3);\n    //height: 36px;              /* fiksts augstums desktop */\n    padding: 0 10px;           /* horizontlais padding */\n    font-size: 13px;\n    font-weight: 600;\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n    cursor: pointer;\n    transition: all 0.3s ease;\n    white-space: nowrap;\n    border-radius: 0;\n    height: 36px;\n\n    &:hover {\n        background-color: #f4c542;\n        color: #2a2a2a;\n        border-color: #f4c542;\n    }\n\n    &.active {\n        background-color: rgba(255, 255, 255, 0.15);\n        border-color: rgba(255, 255, 255, 0.5);\n        color: black;\n    }\n`\n\nconst SettingsButton = styled(NavButton)`\n    ${props => props.$soundOff ? `\n        animation: soundOffPulse 2s ease-in-out infinite;\n        @keyframes soundOffPulse {\n            0% { box-shadow: 0 0 0 rgba(86, 255, 138, 0.0); border-color: rgba(86, 255, 138, 0.3); color: #7dffb4; }\n            50% { box-shadow: 0 0 12px rgba(86, 255, 138, 0.5); border-color: rgba(86, 255, 138, 0.9); color: #e8fff2; }\n            100% { box-shadow: 0 0 0 rgba(86, 255, 138, 0.0); border-color: rgba(86, 255, 138, 0.3); color: #7dffb4; }\n        }\n    ` : ''}\n`;\n\nconst DropdownContainer = styled.div`\n    position: relative;\n    display: flex;\n`\n\nconst DropdownMenu = styled.div`\n    position: absolute;\n    top: 100%;\n    right: 0;\n    background-color: #333;\n    border: 1px solid #444;\n    border-radius: 4px;\n    padding: 10px;\n    z-index: 2000;\n    box-shadow: 0 4px 12px rgba(0,0,0,0.5);\n    min-width: 150px;\n    margin-top: 5px;\n`\n\nconst MenuItem = styled.div`\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    padding: 8px;\n    color: white;\n    font-size: 12px;\n    cursor: pointer;\n    border-radius: 4px;\n\n    &:hover {\n        background-color: #444;\n    }\n`\n\nconst ToggleSwitch = styled.div`\n    width: 34px;\n    height: 18px;\n    background-color: ${props => props.$active ? '#f4c542' : '#666'};\n    border-radius: 9px;\n    position: relative;\n    transition: background-color 0.3s;\n\n    &::after {\n        content: '';\n        position: absolute;\n        top: 2px;\n        left: ${props => props.$active ? '18px' : '2px'};\n        width: 14px;\n        height: 14px;\n        background-color: white;\n        border-radius: 50%;\n        transition: left 0.3s;\n    }\n`\n\nexport default function SectionHeaderNavigationLanguages() {\n    const { i18n } = useTranslation();\n    const dropdownRef = useRef(null);\n    const [isMenuOpen, setIsMenuOpen] = useState(false);\n    const [soundEnabled, setSoundEnabled] = useState(() => {\n        try {\n            const v = localStorage.getItem('game_sound_enabled');\n            if (v === null) return false;\n            return v !== '0';\n        } catch {\n            return false;\n        }\n    });\n\n    const currentLang = i18n.language || 'en'\n\n    const handleLanguageChange = (newLang) => {\n        i18n.changeLanguage(newLang)\n    }\n\n    const toggleSound = () => {\n        const next = !soundEnabled;\n        setSoundEnabled(next);\n        try { localStorage.setItem('game_sound_enabled', next ? '1' : '0'); } catch {}\n        try { window.dispatchEvent(new CustomEvent('game-sound-toggle', { detail: { enabled: next } })); } catch {}\n        try { window.dispatchEvent(new CustomEvent('game-sound-user-gesture')); } catch {}\n    };\n\n    useEffect(() => {\n        const handleClickOutside = (event) => {\n            if (dropdownRef.current && !dropdownRef.current.contains(event.target)) {\n                setIsMenuOpen(false);\n            }\n        };\n        document.addEventListener('mousedown', handleClickOutside);\n        return () => document.removeEventListener('mousedown', handleClickOutside);\n    }, []);\n\n    return (\n        <nav style={{ display: \"flex\", gap: \"0\" }}>\n            <NavButton\n                className={currentLang === 'lv' ? 'active' : ''}\n                onClick={() => handleLanguageChange('lv')}\n            >\n                LV\n            </NavButton>\n\n            <NavButton\n                className={currentLang === 'no' ? 'active' : ''}\n                onClick={() => handleLanguageChange('no')}\n            >\n                NO\n            </NavButton>\n\n            <NavButton\n                className={currentLang === 'en' ? 'active' : ''}\n                onClick={() => handleLanguageChange('en')}\n            >\n                EN\n            </NavButton>\n\n            <NavButton\n                className={currentLang === 'ru' ? 'active' : ''}\n                onClick={() => handleLanguageChange('ru')}\n            >\n                RU\n            </NavButton>\n\n            <NavButton\n                className={currentLang === 'ja' ? 'active' : ''}\n                onClick={() => handleLanguageChange('ja')}\n            >\n                JA\n            </NavButton>\n\n            <DropdownContainer ref={dropdownRef}>\n                <SettingsButton\n                    onClick={() => setIsMenuOpen(!isMenuOpen)}\n                    title=\"Settings\"\n                    $soundOff={!soundEnabled}\n                >\n                    \n                </SettingsButton>\n                {isMenuOpen && (\n                    <DropdownMenu>\n                        <MenuItem onClick={toggleSound}>\n                            <span>Sound Effects</span>\n                            <ToggleSwitch $active={soundEnabled} />\n                        </MenuItem>\n                        <div style={{ height: '1px', backgroundColor: '#444', margin: '5px 0' }} />\n                        <div style={{ padding: '5px 8px', fontSize: '10px', color: '#888' }}>\n                            GAME SETTINGS\n                        </div>\n                    </DropdownMenu>\n                )}\n            </DropdownContainer>\n        </nav>\n    )\n}\n","import styled from \"styled-components\"\n\nconst StyledLogo = styled.p`\n    display: flex;\n    flex-direction: column;\n    gap: 2px;\n    text-transform: uppercase;\n    margin: 0;\n    line-height: 1.1;\n\n    .tagline {\n        font-size: 0.7rem;\n        letter-spacing: 0.04em;\n        text-transform: lowercase;\n        opacity: 0.7;\n    }\n`\n\nexport function SectionHeaderNavigationLogo() {\n    const tag = (process.env.APP_GIT_TAG || '').trim();\n\n    return (\n        <StyledLogo>\n            <span>Element Masters</span>\n            {tag ? <span className=\"tagline\">{tag.toLowerCase()}</span> : null}\n        </StyledLogo>\n    )\n}\n","import styled from \"styled-components\"\nimport { SectionHeaderNavigationChapters } from \"./section.header.navigation.chapters\"\nimport SectionHeaderNavigationLanguages from \"./section.header.navigation.languages\"\nimport {SectionHeaderNavigationLogo} from \"./section.header.navigation.logo\";\n\nconst StyledSectionHeaderNavigation = styled.div`\n    display: flex;\n    flex-direction: row;\n    width: 100%;\n    height: auto;\n    border: solid 1px lightgrey;\n    \n    .innerHeader {\n        display: flex;\n        flex-direction: row;\n        width: 100%;\n        height: auto;\n        margin: 5px 20px;\n        //border: solid 1px red;\n        \n        .innerHeaderLogo {\n            display: flex;\n            flex-direction: row;\n            width: 220px;\n            height: auto;\n            //border: solid 1px green;\n        }\n        \n        .innerHeaderChapters {\n            display: flex;\n            flex-direction: row;\n            justify-content: center;\n            width: 100%;\n            height: auto;\n            //border: solid 1px brown;\n        }\n        \n        .innerHeaderLanguages {\n            display: flex;\n            flex-direction: row;\n            width: auto;\n            height: auto;\n            //border: solid 1px red;\n        }\n    }\n`\n\nfunction SectionHeader() {\n\n    return (\n        <StyledSectionHeaderNavigation>\n            <div className=\"innerHeader\">\n                <div className=\"innerHeaderLogo\">\n                    <SectionHeaderNavigationLogo />\n                </div>\n\n                <div className=\"innerHeaderChapters\">\n                    <SectionHeaderNavigationChapters />\n                </div>\n\n                <div className=\"innerHeaderLanguages\">\n                    <SectionHeaderNavigationLanguages />\n                </div>\n            </div>\n        </StyledSectionHeaderNavigation>\n    )\n}\n\nexport default SectionHeader","import styled from \"styled-components\"\n\nconst StyledSectionHeaderFooter = styled.div`\n    display: flex;\n    flex-direction: row;\n    justify-content: center;\n    width: 100%;\n    height: auto;\n    border: solid 1px lightgray;\n\n    .innerFooter {\n        display: flex;\n        flex-direction: row;\n        justify-content: flex-end;\n        width: 100%;\n        height: auto;\n        margin: 5px 20px;\n        //border: solid 1px red;\n    }\n\n    p {\n        font-size: 12px;\n        color: lightgrey;\n    }\n`\n\nfunction SectionFooter() {\n\n    return (\n        <StyledSectionHeaderFooter>\n            <div className=\"innerFooter\">\n                <p>element_masters v.0.0.0</p>\n            </div>\n        </StyledSectionHeaderFooter>\n    )\n}\n\nexport default SectionFooter","import styled from \"styled-components\"\n\nconst StyledSectionContent = styled.div`\n    display: flex;\n    flex-direction: column;\n    width: 100%;\n    height: 100%;\n    border: solid 1px lightgray;\n`\n\nfunction SectionContent({ children, style }) {\n\n    return (\n        <StyledSectionContent style={style}>\n            { children }\n        </StyledSectionContent>\n    )\n}\n\nexport default SectionContent","/**\n * Game Registry Module\n * Loads all JSON files and creates a registry array.\n * Executed only once during initialization.\n */\n\nlet _registry = null;\nlet _registryMap = null;\n\n/**\n * Initialize the registry by loading all JSON, image, and sound assets.\n * This is executed only once when the module is first imported.\n * @returns {Array} The loaded registry items\n */\nconst initRegistry = () => {\n    // If registry already exists, do nothing\n    if (_registry) return _registry;\n\n    console.time(\"Registry Load Time\");\n\n    try {\n        // 1. Load JSON data\n        const jsonContext = require.context('../../assets/json', true, /\\.json$/);\n\n        // 2. Load IMAGES\n        const imageContext = require.context('../../assets/images', true, /\\.(png|jpe?g|svg)$/);\n\n        // 3. Load SOUNDS (non-fatal: if not supported or directory doesn't exist, continue without sounds)\n        let soundContext = null;\n        try {\n            soundContext = require.context('../../assets/sound', true, /\\.(mp3|wav|ogg|m4a|aac|flac|webm)$/);\n        } catch (e) {\n            // Sound context not available  not fatal\n            soundContext = null;\n        }\n\n        // Check if sound context is available\n        if (!soundContext) {\n            console.warn('Sound context unavailable. Continuing without pre-resolved sound assets.');\n        }\n\n        // Helper function for path resolution\n        const resolvePath = (rawPath) => {\n            if (!rawPath) return null;\n            try {\n                // Convert JSON path to relative Webpack path\n                // Example: \"/assets/images/blocks/dirt.png\" -> \"./blocks/dirt.png\"\n                const cleanPath = rawPath.replace('/assets/images/', './').replace('src/assets/images/', './');\n                const relativePath = cleanPath.startsWith('./') ? cleanPath : `./${cleanPath}`;\n\n                const imageModule = imageContext(relativePath);\n                return imageModule.default || imageModule;\n            } catch (e) {\n                console.warn(`Image not found: ${rawPath}`);\n                return rawPath; // If not found, return original path\n            }\n        };\n\n        let _warnedUnresolvedSound = false;\n        const resolveSound = (rawPath) => {\n            if (!rawPath) return null;\n            // Normalize path for sound context\n            const normalize = (p) => {\n                let out = p;\n                out = out.replace('/assets/sounds/', './').replace('src/assets/sounds/', './');\n                out = out.replace('/assets/sound/', './').replace('src/assets/sound/', './');\n                return out.startsWith('./') ? out : `./${out}`;\n            };\n            const rel = normalize(rawPath);\n            // Try to resolve with sound context\n            if (soundContext) {\n                try {\n                    const mod = soundContext(rel);\n                    return mod.default || mod;\n                } catch {}\n            }\n            // Unable to resolve in bundler  return original path to try loading via public URL\n            if (!_warnedUnresolvedSound) {\n                console.warn(`SFX not bundled: ${rawPath}. Will try loading via public URL. Place files under src/assets/sound, or copy to public/assets/sound.`);\n                _warnedUnresolvedSound = true;\n            }\n            return rawPath;\n        };\n\n        _registry = jsonContext.keys().map((key) => {\n            const data = jsonContext(key);\n            const item = data.default || data;\n\n            // Apstrdjam vienu bildi (vecais variants)\n            let resolvedTexture = resolvePath(item.texture);\n\n            // Apstrdjam bilu masvu (jaunais variants animcijm)\n            let resolvedTextures = [];\n            if (item.textures && Array.isArray(item.textures)) {\n                resolvedTextures = item.textures.map(path => resolvePath(path));\n            }\n\n            return {\n                ...item,\n                texture: resolvedTexture,     // Viena bilde (ja ir)\n                textures: resolvedTextures,   // Masvs (ja ir)\n                // Skaas ce (ja ir)  prvrsts uz bundlera URL\n                sfx: resolveSound(item.sfx || item.sfxResolved || null)\n            };\n        });\n\n        // --- JAUNS: Pcapstrde (Linking & Merging) ---\n        // Ms ejam cauri visiem elementiem un mekljam tos, kuriem ir 'defaultAnimation'.\n        // Ja atrodam, ms kopjam vizulos datus no animcijas uz galveno objektu.\n        \n        _registry.forEach(item => {\n            if (item.defaultAnimation) {\n                // Mekljam animcijas objektu pc ID\n                // Piezme: Tav piemr player.json ir \"player_default\", bet fail id ir \"player_default_100\". \n                // eit ms minm atrast preczu vai daju atbilstbu, lai kods strdtu abos gadjumos.\n                const animItem = _registry.find(r => r.id === item.defaultAnimation || r.id === item.defaultAnimation + \"_100\");\n                \n                if (animItem) {\n                    // Kopjam vizulos datus uz galveno 'player' objektu\n                    if (!item.texture) item.texture = animItem.texture;\n                    if (!item.textures || item.textures.length === 0) item.textures = animItem.textures;\n                    if (!item.animationSpeed) item.animationSpeed = animItem.animationSpeed;\n                    \n                    // Iezmjam animcijas objektu k 'hidden', lai to nerdtu Editor\n                    animItem.isHiddenInEditor = true;\n                }\n                \n                // Tpat paslpjam ar dead un target animcijas, ja ts eksist k atsevii itemi\n                if (item.deadAnimation) {\n                     const deadItem = _registry.find(r => r.id === item.deadAnimation);\n                     if (deadItem) deadItem.isHiddenInEditor = true;\n                }\n                if (item.targetAnimation) {\n                     const targetItem = _registry.find(r => r.id === item.targetAnimation || r.id === item.targetAnimation + \"_100\");\n                     if (targetItem) targetItem.isHiddenInEditor = true;\n                }\n            }\n        });\n\n        _registryMap = new Map();\n        _registry.forEach(item => {\n            if (item && item.id) _registryMap.set(item.id, item);\n        });\n        _registry.__byId = _registryMap;\n\n        console.log(` Game Registry initialized. Loaded ${_registry.length} items.`);\n\n    } catch (error) {\n        console.error(\" Failed to load Game Registry:\", error);\n        _registry = [];\n    }\n\n    console.timeEnd(\"Registry Load Time\");\n    return _registry;\n};\n\n// Automtiski inicializjam, kad is fails tiek importts pirmo reizi\ninitRegistry();\n\n// Eksportjam funkciju, lai piektu datiem (getter)\nexport const getRegistry = () => {\n    return _registry;\n};\n\n// Eksportjam palgfunkciju, lai mekltu pc ID\nexport const findItemById = (id) => {\n    if (!_registry) return null;\n    if (_registryMap) return _registryMap.get(id) || null;\n    return _registry.find(item => item.id === id);\n};\n\nexport default _registry;\n","import React, { useEffect } from 'react';\nimport { Outlet, Link } from \"react-router-dom\"\nimport SectionHeader from \"./sections/section.header\";\nimport SectionFooter from \"./sections/section.footer\";\nimport SectionContent from \"./sections/section.content\";\n\n// Import the registry getter from the centralized engine registry\n// The import itself ensures that the registry code executes and data loads into memory.\nimport { getRegistry } from './engine/registry';\n\nfunction App() {\n\n  useEffect(() => {\n    // Verify that registry data is loaded into memory\n    const items = getRegistry();\n    console.log(\"App start - Current Registry in Memory:\", items);\n  }, []);\n\n  return (\n        <div style={{\n            display: 'flex',\n            flexDirection: 'column',\n            justifyContent: 'flex-start',\n            alignItems: 'center',\n            width: '100vw',\n            height: '100vh',\n            overflow: 'hidden'\n        }}>\n            <div style={{ width: '100%', flexShrink: 0 }}>\n                <SectionHeader />\n            </div>\n            <SectionContent style={{ flexGrow: 1, width: '100%', overflow: 'auto' }}>\n                <Outlet />\n            </SectionContent>\n\n        </div>\n      )\n    }\n\nexport default App\n/*\n <div style={{ width: '100%', flexShrink: 0 }}>\n                <SectionFooter />\n            </div>\n* */","import Logo1 from './assets/logo/Logo1.png';\nimport Logo2 from './assets/logo/Logo2.png';\nimport Logo3 from './assets/logo/Logo3.png';\nimport Logo4 from './assets/logo/Logo4.png';\nimport Logo5 from './assets/logo/Logo5.png';\n\nconst config = {\n    apiUrl: (typeof process !== 'undefined' && process.env?.REACT_APP_API_URL) || 'http://localhost:8000',\n\n    logo: {\n        URL_LOGO_01: Logo1,\n        URL_LOGO_02: Logo2,\n        URL_LOGO_03: Logo3,\n        URL_LOGO_04: Logo4,\n        URL_LOGO_05: Logo5,\n    },\n\n};\n\nexport default config\n","import React from 'react'\nimport styled from 'styled-components'\nimport config from '../../config'\n\nconst HomeContainer = styled.div`\n    display: flex;\n    flex-direction: column;\n    width: 100%;\n    height: 100%;\n    //background-color: darkred;\n    \n    .logoRow{\n        display: flex;\n        flex-direction: row;\n        justify-content: space-between;\n        width: 100%;\n        height: auto;\n        margin: 10px;\n        //border: solid 1px red;\n        \n        & img {\n            width: 350px;\n        }\n    }\n`\n\nexport default function Home() {\n    const LOGO_01 = config.logo.URL_LOGO_01\n    const LOGO_02 = config.logo.URL_LOGO_02\n    const LOGO_03 = config.logo.URL_LOGO_03\n    const LOGO_04 = config.logo.URL_LOGO_04\n    const LOGO_05 = config.logo.URL_LOGO_05\n    console.log(LOGO_01, LOGO_02, LOGO_03, LOGO_04, LOGO_05)\n\n    return (\n        <HomeContainer>\n           <div className={\"logoRow\"}>\n               <img src={LOGO_01} alt=\"logo\" />\n               <img src={LOGO_02} alt=\"logo\" />\n               <img src={LOGO_03} alt=\"logo\" />\n               <img src={LOGO_04} alt=\"logo\" />\n\n           </div>\n        </HomeContainer>\n    )\n}\n","// Lightweight texture cache around PIXI.Texture.from\n// Usage:\n//   const cache = new TextureCache();\n//   const tex = cache.get(url);\n//   cache.dispose(); // optional\n\nimport { Texture } from 'pixi.js';\n\nexport class TextureCache {\n  constructor() {\n    this._map = new Map();\n  }\n\n  get(url) {\n    if (!url) return null;\n    const m = this._map;\n    if (m.has(url)) return m.get(url);\n    const tex = Texture.from(url);\n    m.set(url, tex);\n    return tex;\n  }\n\n  has(url) {\n    return this._map.has(url);\n  }\n\n  dispose(url) {\n    // Do not destroy textures created by Texture.from (managed by Pixi's cache);\n    // only release our Map reference.\n    if (url && this._map.has(url)) this._map.delete(url);\n  }\n\n  clear() {\n    this._map.clear();\n  }\n}\n","import { Graphics } from 'pixi.js';\n\n// Simple rain system with variable speeds and single-bounce behavior on solid tiles.\nexport default class WeatherRain {\n  constructor(container, api, getIntensity) {\n    this.container = container;\n    this.api = api;\n    this.getIntensity = getIntensity || (() => 0);\n    this.width = api.mapWidth * api.tileSize;\n    this.height = api.mapHeight * api.tileSize;\n    this.particles = [];\n    this.intensity = 0;\n    const area = this.width * this.height;\n    // Reasonable particle cap depending on viewport area to keep FPS stable\n    this.maxParticles = 400; // Base for 1280x720\n  }\n\n  resize(width, height) {\n    const area = width * height;\n    this.maxParticles = Math.max(160, Math.floor(area / 2300));\n  }\n\n  setIntensity(v) {\n    this.intensity = Math.max(0, Math.min(100, Number(v) || 0));\n  }\n\n  spawnOne() {\n    const g = new Graphics();\n    g.clear();\n    // Draw a thin slanted line to mimic a raindrop motion blur\n    g.rect(0, 0, 1.3, 9);\n    g.fill({ color: 0x4aa3ff, alpha: 0.92 });\n\n    // Get viewport info if available\n    const viewport = this.api.getViewport ? this.api.getViewport() : null;\n    \n    let x, y;\n    if (viewport) {\n      // Spawn within viewport plus a small margin for slanted fall\n      x = viewport.x - 100 + Math.random() * (viewport.width + 200);\n      y = viewport.y - 10 - Math.random() * 30;\n    } else {\n      x = Math.random() * this.width;\n      y = -10 - Math.random() * 30;\n    }\n\n    const speed = 520 + Math.random() * 520; // px/s, different speeds for depth\n    const vx = (Math.random() * 60 - 30); // slight wind\n    const vy = speed;\n    g.x = x;\n    g.y = y;\n    g.rotation = 0.15; // slight tilt\n    this.container.addChild(g);\n    this.particles.push({ g, x, y, vx, vy, bounces: 0, alive: true });\n  }\n\n  update(dtMs) {\n    // Get viewport info if available\n    const viewport = this.api.getViewport ? this.api.getViewport() : null;\n\n    // Smooth intensity transition\n    const targetIntensity = Math.max(0, Math.min(100, this.getIntensity()));\n    if (Math.abs(targetIntensity - this.intensity) > 0.1) {\n      // Exponential smoothing (approx 2s to reach 95% of target)\n      const lerpFactor = 1 - Math.exp(-0.0015 * dtMs);\n      this.intensity += (targetIntensity - this.intensity) * lerpFactor;\n    } else if (this.intensity !== targetIntensity) {\n      this.intensity = targetIntensity;\n    }\n\n    // Constant-density controller: keep active particles near target count\n    const norm = Math.max(0, Math.min(1, this.intensity / 100));\n    const scaled = Math.pow(norm, 1.15);\n    let target = Math.floor(this.maxParticles * scaled);\n    if (scaled > 0 && target < 8) target = 8; // small baseline so low intensity still visible\n\n    const deficit = target - this.particles.length;\n    if (deficit > 0) {\n      // Smooth ramp, spawn only a fraction per frame to avoid bursts\n      const maxPerFrame = 48;\n      const smooth = Math.max(1, Math.ceil(target * 0.02));\n      const toSpawn = Math.min(deficit, smooth, maxPerFrame);\n      for (let i = 0; i < toSpawn; i++) this.spawnOne();\n    }\n    // Gentle over-target culling to keep density steady\n    if (this.particles.length > target) {\n      const surplus = this.particles.length - target;\n      const toCull = Math.min(surplus, Math.max(1, Math.ceil(this.particles.length * 0.02)));\n      for (let i = 0; i < toCull; i++) {\n        const p = this.particles.pop();\n        if (!p) break;\n        try { p.g.parent && p.g.parent.removeChild(p.g); } catch {}\n        try { p.g.destroy(); } catch {}\n      }\n    }\n\n    const gAcc = 1800; // gravity px/s^2\n    const dt = dtMs / 1000;\n    const toRemove = [];\n\n    for (let i = 0; i < this.particles.length; i++) {\n      const p = this.particles[i];\n      if (!p.alive) { toRemove.push(i); continue; }\n\n      p.vy += gAcc * dt;\n      let nx = p.x + p.vx * dt;\n      let ny = p.y + p.vy * dt;\n\n      // Liquid surface interaction: water/lava\n      try {\n        if (typeof this.api.getLiquidSurfaceY === 'function') {\n          // Prefer closest surface above current ny\n          const syWater = this.api.getLiquidSurfaceY('water', nx);\n          if (Number.isFinite(syWater) && ny >= syWater) {\n            // Hit water surface  spawn small splash and despawn\n            const speed = Math.max(0, Math.min(1500, p.vy));\n            const strength = Math.min(2, 0.4 + speed / 900);\n            if (typeof this.api.onWaterImpact === 'function') this.api.onWaterImpact({ x: nx, strength });\n            p.alive = false; toRemove.push(i);\n            continue;\n          }\n          const syLava = this.api.getLiquidSurfaceY('lava', nx);\n          if (Number.isFinite(syLava) && ny >= syLava) {\n            // Hit lava  steam puff and despawn\n            const speed = Math.max(0, Math.min(1500, p.vy));\n            const strength = Math.min(2, 0.35 + speed / 1200);\n            if (typeof this.api.onLavaImpact === 'function') this.api.onLavaImpact({ x: nx, y: syLava, strength });\n            p.alive = false; toRemove.push(i);\n            continue;\n          }\n        }\n      } catch {}\n\n      // Collision check (treat as point)\n      if (this.api.isSolidAt(nx, ny)) {\n        // Backtrack slightly to stand above surface\n        let guard = 0;\n        while (this.api.isSolidAt(nx, ny) && guard < 6) { ny -= 1; guard++; }\n        // Bounce once, then fade out quickly on next impact\n        if (p.bounces === 0 && Math.abs(p.vy) > 150) {\n          p.vy = -p.vy * 0.3; // dampened bounce\n          p.vx *= 0.8;\n          p.bounces++;\n        } else {\n          // Small splash effect: shrink line and fade\n          p.alive = false;\n          toRemove.push(i);\n        }\n      }\n\n      p.x = nx;\n      p.y = ny;\n      p.g.x = p.x;\n      p.g.y = p.y;\n\n      // Off-screen cleanup\n      const vY = viewport ? viewport.y : 0;\n      const vH = viewport ? viewport.height : this.height;\n      if (p.y > vY + vH + 100 || p.y > this.height + 40 || p.x < -40 || p.x > this.width + 40) {\n        p.alive = false;\n        toRemove.push(i);\n      }\n    }\n\n    // remove in reverse\n    for (let j = toRemove.length - 1; j >= 0; j--) {\n      const idx = toRemove[j];\n      const p = this.particles[idx];\n      if (p && p.g && p.g.parent) p.g.parent.removeChild(p.g);\n      if (p && p.g && p.g.destroy) try { p.g.destroy(); } catch {}\n      this.particles.splice(idx, 1);\n    }\n  }\n\n  destroy() {\n    this.particles.forEach(p => {\n      try { p.g.parent && p.g.parent.removeChild(p.g); } catch {}\n      try { p.g.destroy(); } catch {}\n    });\n    this.particles = [];\n  }\n}\n","import { Graphics } from 'pixi.js';\n\n// Snow system: slow fluttering flakes with varied speeds; stop on blocks without bouncing.\nexport default class WeatherSnow {\n  constructor(container, api, getIntensity) {\n    this.container = container;\n    this.api = api;\n    this.getIntensity = getIntensity || (() => 0);\n    this.width = api.mapWidth * api.tileSize;\n    this.height = api.mapHeight * api.tileSize;\n    this.flakes = [];\n    this.intensity = 0;\n    this.seeded = false;\n    const area = this.width * this.height;\n    // Snow lasts longer; keep a tighter cap than rain for performance\n    this.maxFlakes = 300; // Base for 1280x720\n  }\n\n  resize(width, height) {\n    const area = width * height;\n    this.maxFlakes = Math.max(120, Math.floor(area / 3000));\n  }\n\n  setIntensity(v) {\n    this.intensity = Math.max(0, Math.min(100, Number(v) || 0));\n  }\n\n  spawnOne(options = null) {\n    const g = new Graphics();\n    g.clear();\n    // Slightly larger/more visible flakes on average\n    const r = 1.2 + Math.random() * 2.0; // radius\n    g.circle(0, 0, r);\n    g.fill({ color: 0xffffff, alpha: 0.97 });\n\n    // Get viewport info if available\n    const viewport = this.api.getViewport ? this.api.getViewport() : null;\n\n    let x, y;\n    if (viewport) {\n      // Spawn within viewport plus margin\n      x = viewport.x - 100 + Math.random() * (viewport.width + 200);\n      const minY = options && Number.isFinite(options.minY) ? options.minY : (viewport.y - 10);\n      const maxY = options && Number.isFinite(options.maxY) ? options.maxY : (viewport.y - 40);\n      y = minY + Math.random() * Math.max(1, (maxY - minY));\n    } else {\n      x = Math.random() * this.width;\n      const minY = options && Number.isFinite(options.minY) ? options.minY : -10;\n      const maxY = options && Number.isFinite(options.maxY) ? options.maxY : -40;\n      y = minY + Math.random() * Math.max(1, (maxY - minY));\n    }\n\n    const speed = 40 + Math.random() * 80; // slower than rain, but a bit more range\n    const drift = (Math.random() * 50 - 25); // horizontal drift\n    g.x = x;\n    g.y = y;\n    this.container.addChild(g);\n    this.flakes.push({ g, x, y, vx: drift, vy: speed, alive: true, settled: false, life: 1.0, phase: 'fall', restMs: 0 });\n  }\n\n  update(dtMs) {\n    // Get viewport info if available\n    const viewport = this.api.getViewport ? this.api.getViewport() : null;\n\n    // Smooth intensity transition\n    const targetIntensity = Math.max(0, Math.min(100, this.getIntensity()));\n    if (Math.abs(targetIntensity - this.intensity) > 0.1) {\n      // Exponential smoothing (approx 2s to reach 95% of target)\n      const lerpFactor = 1 - Math.exp(-0.0015 * dtMs);\n      this.intensity += (targetIntensity - this.intensity) * lerpFactor;\n    } else if (this.intensity !== targetIntensity) {\n      this.intensity = targetIntensity;\n    }\n\n    // Constant-density controller to avoid wavey bursts\n    const norm = Math.max(0, Math.min(1, this.intensity / 100));\n    const scaled = Math.pow(norm, 1.15);\n    let target = Math.floor(this.maxFlakes * scaled);\n    if (scaled > 0 && target < 10) target = 10;\n\n    if (target === 0) {\n      this.seeded = false;\n    }\n\n    const deficit = target - this.flakes.length;\n    if (!this.seeded && target > 0) {\n      const viewportH = viewport ? viewport.height : this.height;\n      const viewportY = viewport ? viewport.y : 0;\n      const seedCount = Math.min(target, Math.max(24, Math.floor(this.maxFlakes * 0.35)));\n      for (let i = 0; i < seedCount; i++) {\n        this.spawnOne({\n          minY: viewportY - viewportH * 0.35,\n          maxY: viewportY + viewportH * 0.9\n        });\n      }\n      this.seeded = true;\n    }\n    if (deficit > 0) {\n      const maxPerFrame = 24; // slower than rain\n      const smooth = Math.max(1, Math.ceil(target * 0.015));\n      const toSpawn = Math.min(deficit, smooth, maxPerFrame);\n      for (let i = 0; i < toSpawn; i++) this.spawnOne();\n    }\n    // Gentle over-target culling to keep density steady when slider decreases\n    if (this.flakes.length > target) {\n      const surplus = this.flakes.length - target;\n      const toCull = Math.min(surplus, Math.max(1, Math.ceil(this.flakes.length * 0.015)));\n      for (let i = 0; i < toCull; i++) {\n        const f = this.flakes.pop();\n        if (!f) break;\n        try { f.g.parent && f.g.parent.removeChild(f.g); } catch {}\n        try { f.g.destroy(); } catch {}\n      }\n    }\n\n    const gAcc = 200; // gentle gravity\n    const dt = dtMs / 1000;\n    const toRemove = [];\n\n    for (let i = 0; i < this.flakes.length; i++) {\n      const f = this.flakes[i];\n      if (!f.alive) { toRemove.push(i); continue; }\n\n      if (f.phase === 'fall') {\n        f.vy = Math.min(140, f.vy + gAcc * dt);\n        // small oscillation for flutter\n        f.vx += Math.sin((f.y + i) * 0.02) * 7 * dt;\n        let nx = f.x + f.vx * dt;\n        let ny = f.y + f.vy * dt;\n\n        // Liquid interaction first\n        try {\n          if (typeof this.api.getLiquidSurfaceY === 'function') {\n            const sYwater = this.api.getLiquidSurfaceY('water', nx);\n            if (Number.isFinite(sYwater) && ny >= sYwater) {\n              // Land on water surface and rest for a bit\n              ny = sYwater - 0.5;\n              f.x = nx; f.y = ny; f.vx = 0; f.vy = 0;\n              f.phase = 'rest';\n              f.restMs = 800 + Math.random() * 400; // 0.8..1.2s\n              // Do not continue to solid collision checks this frame\n              // Update display and proceed to next flake\n              f.g.x = f.x; f.g.y = f.y;\n              continue;\n            }\n            const sYlava = this.api.getLiquidSurfaceY('lava', nx);\n            if (Number.isFinite(sYlava) && ny >= sYlava) {\n              // Steam puff and despawn\n              if (typeof this.api.onLavaImpact === 'function') this.api.onLavaImpact({ x: nx, y: sYlava, strength: 0.5 });\n              f.alive = false; toRemove.push(i); continue;\n            }\n          }\n        } catch {}\n\n        // Solid collision\n        if (this.api.isSolidAt(nx, ny)) {\n          // backtrack up to stand above the surface\n          let guard = 0;\n          while (this.api.isSolidAt(nx, ny) && guard < 10) { ny -= 1; guard++; }\n          f.settled = true;\n          f.vx = 0;\n          f.vy = 0;\n          f.phase = 'rest';\n          f.restMs = 800 + Math.random() * 400;\n        }\n\n        f.x = nx;\n        f.y = ny;\n      } else if (f.phase === 'rest') {\n        // Flake rests on surface for a short time (water or ground), then starts sinking/falling slowly\n        f.restMs -= dtMs;\n        if (f.restMs <= 0) {\n          f.phase = 'sinking';\n          // resume gentle fall with reduced alpha\n          f.vx = (Math.random() * 20 - 10);\n          f.vy = 20 + Math.random() * 20;\n        }\n      } else if (f.phase === 'sinking') {\n        // Continue downward slowly; fade out progressively\n        f.vy = Math.min(60, f.vy + gAcc * 0.3 * dt);\n        f.x += f.vx * dt;\n        f.y += f.vy * dt;\n        f.life -= 0.22 * dt;\n        if (f.life <= 0) { f.alive = false; toRemove.push(i); }\n      }\n\n      f.g.x = f.x;\n      f.g.y = f.y;\n      if (f.phase === 'rest' || f.phase === 'sinking' || f.settled) f.g.alpha = Math.max(0, Math.min(1, f.life));\n\n      if (f.y > this.height + 40 || f.x < -40 || f.x > this.width + 40 || (viewport && f.y > viewport.y + viewport.height + 100)) {\n        f.alive = false;\n        toRemove.push(i);\n      }\n    }\n\n    for (let j = toRemove.length - 1; j >= 0; j--) {\n      const idx = toRemove[j];\n      const f = this.flakes[idx];\n      if (f && f.g && f.g.parent) f.g.parent.removeChild(f.g);\n      if (f && f.g && f.g.destroy) try { f.g.destroy(); } catch {}\n      this.flakes.splice(idx, 1);\n    }\n  }\n\n  destroy() {\n    this.flakes.forEach(f => {\n      try { f.g.parent && f.g.parent.removeChild(f.g); } catch {}\n      try { f.g.destroy(); } catch {}\n    });\n    this.flakes = [];\n  }\n}\n","import { Graphics, BlurFilter } from 'pixi.js';\n\n// Clouds overlay: organic cloud blobs drifting in the top 30% of the screen.\nexport default class WeatherClouds {\n  constructor(container, api, getIntensity) {\n    this.container = container;\n    this.api = api;\n    this.getIntensity = getIntensity || (() => 0);\n    this.width = api.mapWidth * api.tileSize;\n    this.height = api.mapHeight * api.tileSize;\n    this.bandHeight = Math.max(1, Math.floor(this.height * 0.3)); // top 30%\n    this.patches = [];\n    this.intensity = 0;\n    this.windDirection = 1; // 1: from left to right, -1: from right to left\n\n    // Soft blur for nicer cloud appearance\n    try {\n      this.container.filters = [new BlurFilter({ strength: 2.0, quality: 2 })];\n    } catch {}\n\n    this.rebuild();\n  }\n\n  setIntensity(v) {\n    this.intensity = Math.max(0, Math.min(100, Number(v) || 0));\n  }\n\n  spawnOne(isInitial = false) {\n    const g = new Graphics();\n    const w = 140 + Math.random() * 300; // cloud size\n    const h = 80 + Math.random() * 160;\n    \n    // Get viewport info if available\n    const viewport = this.api.getViewport ? this.api.getViewport() : null;\n    const vX = viewport ? viewport.x : 0;\n    const vY = viewport ? viewport.y : 0;\n    const vW = viewport ? viewport.width : this.width;\n\n    let x;\n    if (isInitial) {\n      // Initial scatter across the whole viewport (or map if no viewport)\n      const range = Math.max(vW, this.width) + 800;\n      const startX = viewport ? vX - 400 : -400;\n      x = startX + Math.random() * range;\n    } else if (viewport) {\n      // Dynamic spawn: place in or near viewport so the user sees results quickly\n      // We scatter them in a wider area around viewport [x-400, x+width+400]\n      x = viewport.x - 400 + Math.random() * (viewport.width + 800);\n    } else {\n      // Fallback to edges\n      x = (Math.random() < 0.5 ? -180 : this.width + 180);\n    }\n    \n    const y = vY - 40 + Math.random() * (this.bandHeight - 20); // only in band\n    const alpha = 0.08 + (this.intensity / 100) * (0.12 + Math.random() * 0.08);\n    const speed = 8 + Math.random() * 22; // horizontal drift speed\n    const vy = (Math.random() - 0.5) * 4; // subtle vertical drift\n\n    // Draw an organic cloud using overlapping circles (soft edges)\n    const rx = w * 0.5;\n    const ry = h * 0.5;\n    const circles = 8 + Math.floor(Math.random() * 6); // 8..13 lobes\n    const baseR = Math.min(rx, ry) * 0.55;\n    for (let k = 0; k < circles; k++) {\n      const t = (k / circles) * Math.PI * 2 + Math.random() * 0.6;\n      const dist = 0.2 + Math.random() * 0.35;\n      const cx = Math.cos(t) * rx * dist;\n      const cy = Math.sin(t) * ry * dist;\n      const r = baseR * (0.7 + Math.random() * 0.7);\n      g.circle(cx, cy, r);\n    }\n    // central mass\n    g.circle(0, 0, baseR * (0.9 + Math.random() * 0.5));\n    g.fill({ color: 0xffffff, alpha: 1.0 });\n    g.alpha = 0; // Start invisible for fade-in\n    g.x = x;\n    g.y = y;\n    this.container.addChild(g);\n    this.patches.push({ \n      g, w, h, \n      vx: speed * this.windDirection, \n      vy, \n      targetAlpha: alpha, \n      currentAlpha: 0,\n      phase: Math.random() * Math.PI * 2,\n      dying: false\n    });\n  }\n\n  resize(width, height) {\n    const w = Math.max(1, Math.floor(width));\n    const h = Math.max(1, Math.floor(height));\n    // We don't change this.width/height here as they are map bounds,\n    // but we can update bandHeight if the screen height changed significantly.\n    this.bandHeight = Math.max(1, Math.floor(h * 0.3)); \n  }\n\n  rebuild() {\n    // Clear existing\n    for (const p of this.patches) {\n      try { p.g.parent && p.g.parent.removeChild(p.g); } catch {}\n      try { p.g.destroy(); } catch {}\n    }\n    this.patches = [];\n\n    const viewport = this.api.getViewport ? this.api.getViewport() : null;\n    const vW = viewport ? viewport.width : 1280;\n    const targetCount = Math.round((this.intensity / 100) * 18 * (vW / 1280));\n    \n    for (let i = 0; i < targetCount; i++) {\n      this.spawnOne(true);\n      // For initial ones, set alpha immediately\n      if (this.patches.length > 0) {\n        const p = this.patches[this.patches.length - 1];\n        p.currentAlpha = p.targetAlpha;\n        p.g.alpha = p.currentAlpha;\n      }\n    }\n  }\n\n  update(dtMs) {\n    // Live intensity update with smoothing\n    const targetIntensity = Math.max(0, Math.min(100, this.getIntensity()));\n    if (Math.abs(targetIntensity - this.intensity) > 0.1) {\n      const lerpFactor = 1 - Math.exp(-0.0015 * dtMs);\n      this.intensity += (targetIntensity - this.intensity) * lerpFactor;\n    } else if (this.intensity !== targetIntensity) {\n      this.intensity = targetIntensity;\n    }\n\n    const dt = dtMs / 1000;\n    const W = this.width;\n    const viewport = this.api.getViewport ? this.api.getViewport() : null;\n    const vX = viewport ? viewport.x : 0;\n    const vY = viewport ? viewport.y : 0;\n    const vW = viewport ? viewport.width : 1280;\n    const vH = viewport ? viewport.height : 720;\n\n    const bandTop = vY - 100;\n    const bandBottom = vY + this.bandHeight;\n\n    // Adjust cloud count gradually\n    // We scale target count based on viewport width (default 18 for 1280px)\n    const targetCount = Math.round((this.intensity / 100) * 18 * (vW / 1280));\n    \n    const activePatches = this.patches.filter(p => {\n      if (p.dying) return false;\n      if (!viewport) return true;\n      // Only count patches that are within a reasonable distance of the viewport\n      return p.g.x > vX - 1000 && p.g.x < vX + vW + 1000;\n    });\n    \n    if (activePatches.length < targetCount) {\n      // Spawn one cloud per ~300ms if needed, to avoid sudden pops\n      this._spawnTimer = (this._spawnTimer || 0) + dtMs;\n      if (this._spawnTimer > 300 || activePatches.length === 0) {\n        this.spawnOne(activePatches.length === 0);\n        this._spawnTimer = 0;\n      }\n    } else if (activePatches.length > targetCount) {\n      // Mark one for death\n      const toKill = activePatches[0];\n      if (toKill) toKill.dying = true;\n    }\n\n    const toRemove = [];\n    for (let i = 0; i < this.patches.length; i++) {\n      const p = this.patches[i];\n      // drift\n      p.g.x += p.vx * dt;\n      p.g.y += p.vy * dt;\n\n      // Alpha handling\n      p.phase += dt * 0.35;\n      const osc = (Math.sin(p.phase) + 1) * 0.5; // 0..1\n      \n      // Cleanup if too far from viewport (e.g. teleport)\n      if (viewport && !p.dying && (p.g.x < vX - 2500 || p.g.x > vX + vW + 2500)) {\n        p.dying = true;\n      }\n\n      if (p.dying) {\n        p.currentAlpha -= dt * 0.1; // Fade out slowly\n        if (p.currentAlpha <= 0) {\n          toRemove.push(i);\n          continue;\n        }\n      } else if (p.currentAlpha < p.targetAlpha) {\n        p.currentAlpha += dt * 0.05; // Fade in slowly\n        if (p.currentAlpha > p.targetAlpha) p.currentAlpha = p.targetAlpha;\n      }\n\n      p.g.alpha = Math.max(0, Math.min(0.55, p.currentAlpha * (0.75 + 0.5 * osc)));\n\n      // wrap horizontally\n      const margin = 800; // Increased margin to ensure they don't pop out visibly\n      if (viewport) {\n          const leftBound = vX - margin;\n          const rightBound = vX + vW + margin;\n          if (p.g.x < leftBound) p.g.x = rightBound;\n          if (p.g.x > rightBound) p.g.x = leftBound;\n      } else {\n          if (p.g.x < -margin) p.g.x = W + margin;\n          if (p.g.x > W + margin) p.g.x = -margin;\n      }\n      // constrain within top band vertically (wrap within band only)\n      if (p.g.y < bandTop) p.g.y = bandBottom;\n      if (p.g.y > bandBottom) p.g.y = bandTop;\n    }\n\n    // Remove dead patches\n    for (let j = toRemove.length - 1; j >= 0; j--) {\n      const idx = toRemove[j];\n      const p = this.patches[idx];\n      try { p.g.parent && p.g.parent.removeChild(p.g); } catch {}\n      try { p.g.destroy(); } catch {}\n      this.patches.splice(idx, 1);\n    }\n  }\n\n  destroy() {\n    try { this.container.filters = []; } catch {}\n    for (const p of this.patches) {\n      try { p.g.parent && p.g.parent.removeChild(p.g); } catch {}\n      try { p.g.destroy(); } catch {}\n    }\n    this.patches = [];\n  }\n}\n","import { Graphics, Texture, TilingSprite } from 'pixi.js';\n\n// Full-screen fog overlay: a semi-transparent rectangle covering entire viewport.\n// Intensity 0..100 maps to alpha 0..0.65.\nexport default class WeatherFog {\n  constructor(container, api, getIntensity) {\n    this.container = container;\n    this.api = api;\n    this.getIntensity = getIntensity || (() => 0);\n    this.width = api.mapWidth * api.tileSize;\n    this.height = api.mapHeight * api.tileSize;\n    this.intensity = 0;\n    this.time = 0; // ms accumulator for subtle breathing\n\n    // Base tint rectangle drawn once; alpha controlled via displayObject alpha (no redraws per frame)\n    this.g = new Graphics();\n    this.container.addChild(this.g);\n\n    // Build procedural noise texture once (small size, repeats as tiling sprites)\n    this.noiseTex = WeatherFog._createNoiseTexture(128, 128);\n    this.layer1 = new TilingSprite(this.noiseTex, this.width, this.height);\n    this.layer2 = new TilingSprite(this.noiseTex, this.width, this.height);\n    // Different scales for parallax effect\n    this.layer1.tileScale.set(1.0, 1.0);\n    this.layer2.tileScale.set(0.6, 0.8);\n    // Start with zero alpha; will be set based on intensity\n    this.layer1.alpha = 0;\n    this.layer2.alpha = 0;\n    this.container.addChild(this.layer1);\n    this.container.addChild(this.layer2);\n\n    // Precompute parameters\n    this._recalcParams();\n    this._draw();\n  }\n\n  _alphaFromIntensity(v) {\n    const t = Math.max(0, Math.min(100, Number(v) || 0)) / 100; // 0..1\n    return Math.max(0, Math.min(0.65, t * 0.65));\n  }\n\n  setIntensity(v) {\n    const nv = Math.max(0, Math.min(100, Number(v) || 0));\n    if (nv === this.intensity) return;\n    this.intensity = nv;\n    this._recalcParams();\n    this._applyAlphas(0); // update layer alphas based on new intensity\n    this._draw();\n  }\n\n  resize(width, height) {\n    const w = Math.max(1, Math.floor(width));\n    const h = Math.max(1, Math.floor(height));\n    if (w === this.width && h === this.height) return;\n    this.width = w;\n    this.height = h;\n    // Resize tiling sprites and redraw base rect\n    if (this.layer1) { this.layer1.width = w; this.layer1.height = h; }\n    if (this.layer2) { this.layer2.width = w; this.layer2.height = h; }\n    this._draw();\n  }\n\n  _draw() {\n    const w = this.width;\n    const h = this.height;\n    const g = this.g;\n    g.clear();\n    const baseAlpha = this._alphaFromIntensity(this.intensity);\n    if (baseAlpha <= 0) {\n      g.alpha = 0;\n      return;\n    }\n    // Draw once with alpha 1, then control real alpha via g.alpha each frame\n    // We draw a large rectangle to cover the viewport\n    g.rect(0, 0, w, h);\n    g.fill({ color: 0x9fb7c9, alpha: 1 });\n    g.alpha = baseAlpha;\n  }\n\n  update(dtMs) {\n    // Smooth intensity transition\n    const targetIntensity = Math.max(0, Math.min(100, this.getIntensity()));\n    if (Math.abs(targetIntensity - this.intensity) > 0.1) {\n      const lerpFactor = 1 - Math.exp(-0.0015 * dtMs);\n      this.setIntensity(this.intensity + (targetIntensity - this.intensity) * lerpFactor);\n    } else if (this.intensity !== targetIntensity) {\n      this.setIntensity(targetIntensity);\n    }\n\n    const viewport = this.api.getViewport ? this.api.getViewport() : null;\n    if (viewport) {\n      // Follow camera\n      if (this.g) this.g.x = viewport.x;\n      if (this.layer1) this.layer1.x = viewport.x;\n      if (this.layer2) this.layer2.x = viewport.x;\n      \n      // We also need to follow Y if the map is tall\n      if (this.g) this.g.y = viewport.y;\n      if (this.layer1) this.layer1.y = viewport.y;\n      if (this.layer2) this.layer2.y = viewport.y;\n    }\n\n    // Advance time for breathing/pulse\n    const dt = Math.max(0, Number(dtMs) || 16.67);\n    this.time += dt;\n    // Very subtle breathing: sine between ~0.96 .. 1.04\n    const pulse = 1 + 0.04 * Math.sin(this.time * 0.0012);\n    this._applyAlphas(pulse);\n\n    // Scroll noise layers slowly\n    if (this.layer1) {\n      this.layer1.tilePosition.x += this.speed1.x * dt;\n      this.layer1.tilePosition.y += this.speed1.y * dt;\n    }\n    if (this.layer2) {\n      this.layer2.tilePosition.x += this.speed2.x * dt;\n      this.layer2.tilePosition.y += this.speed2.y * dt;\n    }\n  }\n\n  destroy() {\n    if (this.g) {\n      try { this.g.parent && this.g.parent.removeChild(this.g); } catch {}\n      try { this.g.destroy(); } catch {}\n    }\n    this.g = null;\n    try {\n      if (this.layer1) { this.layer1.parent && this.layer1.parent.removeChild(this.layer1); this.layer1.destroy(true); }\n    } catch {}\n    try {\n      if (this.layer2) { this.layer2.parent && this.layer2.parent.removeChild(this.layer2); this.layer2.destroy(true); }\n    } catch {}\n    this.layer1 = null;\n    this.layer2 = null;\n    try { this.noiseTex?.destroy(true); } catch {}\n    this.noiseTex = null;\n  }\n\n  _applyAlphas(pulseFactor = 1) {\n    const base = this._alphaFromIntensity(this.intensity);\n    // Noise contribution grows with intensity but remains subtle\n    const t = Math.max(0, Math.min(1, this.intensity / 100));\n    const noiseAlpha = base * (0.25 + 0.35 * t); // up to ~0.4 of base\n    if (this.g) this.g.alpha = base * pulseFactor;\n    if (this.layer1) this.layer1.alpha = noiseAlpha * 0.8;\n    if (this.layer2) this.layer2.alpha = noiseAlpha;\n  }\n\n  _recalcParams() {\n    // Map intensity to drift speeds (pixels per ms)\n    const t = Math.max(0, Math.min(1, this.intensity / 100));\n    const lerp = (a, b, u) => a + (b - a) * u;\n    // Two layers drifting in different directions\n    this.speed1 = { x: lerp(0.005, 0.025, t), y: lerp(0.0, 0.012, t) };\n    this.speed2 = { x: lerp(-0.006, -0.018, t), y: lerp(0.004, 0.02, t) };\n  }\n\n  // Static helper: generate small grayscale noise texture\n  static _createNoiseTexture(w = 128, h = 128) {\n    const canvas = document.createElement('canvas');\n    canvas.width = w; canvas.height = h;\n    const ctx = canvas.getContext('2d');\n    const img = ctx.createImageData(w, h);\n    // Use a gentle noise range to avoid harsh contrast\n    for (let i = 0; i < img.data.length; i += 4) {\n      const v = 200 + Math.floor(Math.random() * 55); // 200..254\n      img.data[i] = v;\n      img.data[i + 1] = v;\n      img.data[i + 2] = v;\n      img.data[i + 3] = 255;\n    }\n    ctx.putImageData(img, 0, 0);\n    return Texture.from(canvas);\n  }\n}\n","import { Graphics, BlurFilter } from 'pixi.js';\n\n// Thunder/Lightning weather effect\n// API:\n//   new WeatherThunder(container, api, getIntensity)\n//   setIntensity(v), resize(w,h), update(dtMs), destroy()\n// Notes:\n// - Renders inside weather layer (below fog). Blocks/tiles remain above fog.\n// - Picks random strike targets above solid tiles using api.isSolidAt(x,y).\nexport default class WeatherThunder {\n  constructor(container, api, getIntensity) {\n    this.container = container;\n    this.api = api || {};\n    this.getIntensity = getIntensity || (() => 0);\n    this.width = (api?.mapWidth || 0) * (api?.tileSize || 32);\n    this.height = (api?.mapHeight || 0) * (api?.tileSize || 32);\n\n    this.intensity = 0;\n    this.time = 0;\n    this.nextStrikeMs = Infinity; // scheduled delay to next strike\n    this.flashAlpha = 0; // global white flash\n    this.flashDecay = 0.0;\n    this.boltAlive = false;\n    this.boltTime = 0; // ms since bolt spawned\n    this.boltDuration = 0; // ms total\n\n    // Graphics\n    this.flashG = new Graphics();\n    this.boltG = new Graphics();\n    // Add slight glow to bolt\n    try {\n      this.boltG.filters = [new BlurFilter(2, 1)];\n    } catch {}\n    this.container.addChild(this.flashG);\n    this.container.addChild(this.boltG);\n\n    // Build once\n    this._scheduleNextStrike(true);\n  }\n\n  setIntensity(v) {\n    const nv = Math.max(0, Math.min(100, Number(v) || 0));\n    if (nv === this.intensity) return;\n    this.intensity = nv;\n    if (nv <= 0) {\n      // disable visuals\n      this.flashAlpha = 0;\n      this.boltAlive = false;\n      this._redrawFlash();\n      this._clearBolt();\n      this.nextStrikeMs = Infinity;\n    } else if (!Number.isFinite(this.nextStrikeMs) || this.nextStrikeMs === Infinity) {\n      this._scheduleNextStrike(true);\n    }\n  }\n\n  resize(w, h) {\n    const W = Math.max(1, Math.floor(w));\n    const H = Math.max(1, Math.floor(h));\n    if (W === this.width && H === this.height) return;\n    this.width = W;\n    this.height = H;\n    // redraw flash when active\n    if (this.flashAlpha > 0) this._redrawFlash();\n  }\n\n  update(dtMs) {\n    // Smooth intensity transition\n    const targetIntensity = Math.max(0, Math.min(100, this.getIntensity()));\n    if (Math.abs(targetIntensity - this.intensity) > 0.1) {\n      const lerpFactor = 1 - Math.exp(-0.0015 * dtMs);\n      this.setIntensity(this.intensity + (targetIntensity - this.intensity) * lerpFactor);\n    } else if (this.intensity !== targetIntensity) {\n      this.setIntensity(targetIntensity);\n    }\n\n    const dt = Math.max(0, Number(dtMs) || 16.67);\n    if (this.intensity <= 0) return;\n\n    // Update scheduling\n    this.nextStrikeMs -= dt;\n    if (this.nextStrikeMs <= 0) {\n      // Perform strike: trigger screen flash and draw bolt\n      this._triggerFlash();\n      this._createBolt();\n      this._scheduleNextStrike(false); // schedule next time after immediate strike window\n    }\n\n    // Flash decay\n    if (this.flashAlpha > 0) {\n      // exponential-like decay via linear factor raised with dt\n      const decayPerMs = this.flashDecay || 0.004; // higher = quicker fade\n      this.flashAlpha = Math.max(0, this.flashAlpha - decayPerMs * dt);\n      this._redrawFlash();\n    }\n\n    // Bolt lifetime\n    if (this.boltAlive) {\n      this.boltTime += dt;\n      const t = this.boltTime / Math.max(1, this.boltDuration);\n      // Fade color/alpha over time\n      const remain = Math.max(0, 1 - t);\n      this.boltG.alpha = 0.25 + 0.75 * remain;\n      if (this.boltTime >= this.boltDuration) {\n        this._clearBolt();\n      }\n    }\n  }\n\n  destroy() {\n    try { this.flashG.parent && this.flashG.parent.removeChild(this.flashG); } catch {}\n    try { this.flashG.destroy(true); } catch {}\n    try { this.boltG.parent && this.boltG.parent.removeChild(this.boltG); } catch {}\n    try { this.boltG.destroy(true); } catch {}\n    this.flashG = null;\n    this.boltG = null;\n    this.container = null;\n  }\n\n  // Internal helpers\n  _scheduleNextStrike(initial) {\n    // Map intensity 1..100 to delay: from ~9000..6000 ms down to ~2500..1000 ms\n    if (this.intensity <= 0) { this.nextStrikeMs = Infinity; return; }\n    const t = Math.max(0, Math.min(1, this.intensity / 100));\n    const minDelay = this._lerp(1000, 2500, 1 - t); // at high intensity, between 12.5s\n    const maxDelay = this._lerp(2500, 9000, 1 - t); // at low intensity, up to ~9s\n    const delay = this._rand(minDelay, maxDelay);\n    this.nextStrikeMs = initial ? this._rand(400, 1400) : delay; // first strike quicker on enable\n  }\n\n  _triggerFlash() {\n    // Brightness based on intensity, with slight randomness\n    const t = Math.max(0, Math.min(1, this.intensity / 100));\n    const base = this._lerp(0.25, 0.9, t);\n    this.flashAlpha = Math.min(1, base * this._rand(0.8, 1));\n    // fade time scales with intensity (brighter fades a bit slower)\n    this.flashDecay = this._lerp(0.008, 0.004, t);\n    this._redrawFlash();\n  }\n\n  _redrawFlash() {\n    const g = this.flashG;\n    g.clear();\n    if (this.flashAlpha <= 0) return;\n    \n    const viewport = this.api.getViewport ? this.api.getViewport() : null;\n    if (viewport) {\n      g.x = viewport.x;\n      g.y = viewport.y;\n      g.rect(0, 0, viewport.width, viewport.height);\n    } else {\n      g.rect(0, 0, this.width, this.height);\n    }\n    g.fill({ color: 0xffffff, alpha: this.flashAlpha });\n  }\n\n  _createBolt() {\n    // Determine target using solid scan from top\n    const W = this.width, H = this.height;\n    \n    // Get viewport info if available\n    const viewport = this.api.getViewport ? this.api.getViewport() : null;\n    \n    let x, topY;\n    if (viewport) {\n      // Strike within viewport\n      x = Math.floor(viewport.x + this._rand(8, viewport.width - 8));\n      topY = viewport.y - Math.floor(this._rand(10, 40));\n    } else {\n      x = Math.floor(this._rand(8, W - 8));\n      topY = -Math.floor(this._rand(10, 40)); // start slightly above top\n    }\n\n    const targetY = this._findGroundY(x, H);\n    const endY = Number.isFinite(targetY) ? Math.max(0, targetY - this._rand(8, 16)) : Math.floor(H * 0.6);\n\n    // Build polyline with jittered segments from top to end\n    const segments = Math.max(8, Math.floor((endY - topY) / this._rand(10, 16)));\n    const jitterX = this._lerp(6, 18, Math.max(0, Math.min(1, this.intensity / 100)));\n    const points = [];\n    let cx = x;\n    let cy = topY;\n    points.push({ x: cx, y: cy });\n    for (let i = 1; i <= segments; i++) {\n      const ny = topY + Math.floor(((endY - topY) * i) / segments);\n      const nx = x + this._rand(-jitterX, jitterX);\n      cx = nx; cy = ny;\n      points.push({ x: cx, y: cy });\n    }\n\n    // Draw main bolt\n    const g = this.boltG;\n    g.clear();\n    const thickness = this._lerp(2, 5, Math.max(0, Math.min(1, this.intensity / 100)));\n    const color = 0xCCEEFF;\n    g.moveTo(points[0].x, points[0].y);\n    for (let i = 1; i < points.length; i++) g.lineTo(points[i].x, points[i].y);\n    g.stroke({ width: thickness, color, alpha: 1, alignment: 0.5, cap: 'round', join: 'round' });\n\n    // Branches: some short forks from random mid points\n    const branchCount = Math.floor(this._lerp(1, 3, Math.max(0, Math.min(1, this.intensity / 100))));\n    for (let b = 0; b < branchCount; b++) {\n      const idx = Math.floor(this._rand(2, points.length - 2));\n      const p = points[idx];\n      const len = this._rand(30, 80);\n      const ang = this._rand(-Math.PI * 0.5, Math.PI * 0.5);\n      const bx = p.x + Math.cos(ang) * len;\n      const by = p.y + Math.sin(ang) * len;\n      g.moveTo(p.x, p.y);\n      g.lineTo(bx, by);\n      g.stroke({ width: Math.max(1, thickness * 0.55), color, alpha: 0.9, alignment: 0.5 });\n    }\n\n    this.boltAlive = true;\n    this.boltTime = 0;\n    this.boltDuration = this._rand(120, 260); // very brief\n    this.boltG.alpha = 1;\n  }\n\n  _clearBolt() {\n    if (!this.boltG) return;\n    this.boltAlive = false;\n    this.boltTime = 0;\n    this.boltDuration = 0;\n    try { this.boltG.clear(); } catch {}\n  }\n\n  _findGroundY(worldX, maxH) {\n    // Scan from top to bottom to find first solid tile boundary\n    const isSolid = this.api?.isSolidAt;\n    if (typeof isSolid !== 'function') return null;\n    for (let y = 0; y < maxH; y += 4) {\n      if (isSolid(worldX, y)) {\n        return y;\n      }\n    }\n    return null;\n  }\n\n  _rand(a, b) {\n    if (b === undefined) { b = a; a = 0; }\n    return a + Math.random() * (b - a);\n  }\n\n  _lerp(a, b, t) { return a + (b - a) * t; }\n}\n","import { Graphics } from 'pixi.js';\n\n// Lava rain system: similar to rain but red/orange and potentially deals damage (handled by engine)\nexport default class WeatherLavaRain {\n  constructor(container, api, getIntensity) {\n    this.container = container;\n    this.api = api;\n    this.getIntensity = getIntensity || (() => 0);\n    this.width = api.mapWidth * api.tileSize;\n    this.height = api.mapHeight * api.tileSize;\n    this.particles = [];\n    this.intensity = 0;\n    this.maxParticles = 300; \n  }\n\n  resize(width, height) {\n    const area = width * height;\n    this.maxParticles = Math.max(120, Math.floor(area / 3000));\n  }\n\n  spawnOne() {\n    const g = new Graphics();\n    g.clear();\n    // Lava drops are slightly thicker and more glowing\n    g.rect(0, 0, 2, 10);\n    // Glowing yellow/orange color\n    const color = Math.random() > 0.3 ? 0xffaa00 : 0xffcc00;\n    g.fill({ color, alpha: 0.95 });\n\n    const viewport = this.api.getViewport ? this.api.getViewport() : null;\n    \n    let x, y;\n    if (viewport) {\n      x = viewport.x - 100 + Math.random() * (viewport.width + 200);\n      y = viewport.y - 10 - Math.random() * 30;\n    } else {\n      x = Math.random() * this.width;\n      y = -10 - Math.random() * 30;\n    }\n\n    const speed = 400 + Math.random() * 400; // slightly slower/heavier than water rain\n    const vx = (Math.random() * 40 - 20); \n    const vy = speed;\n    g.x = x;\n    g.y = y;\n    g.rotation = 0.1; \n    this.container.addChild(g);\n    this.particles.push({ g, x, y, vx, vy, alive: true });\n  }\n\n  update(dtMs) {\n    const targetIntensity = Math.max(0, Math.min(100, this.getIntensity()));\n    if (Math.abs(targetIntensity - this.intensity) > 0.1) {\n      const lerpFactor = 1 - Math.exp(-0.0015 * dtMs);\n      this.intensity += (targetIntensity - this.intensity) * lerpFactor;\n    } else {\n      this.intensity = targetIntensity;\n    }\n\n    const norm = Math.max(0, Math.min(1, this.intensity / 100));\n    let target = Math.floor(this.maxParticles * norm);\n    if (norm > 0 && target < 5) target = 5;\n\n    const deficit = target - this.particles.length;\n    if (deficit > 0) {\n      const toSpawn = Math.min(deficit, Math.max(1, Math.ceil(target * 0.02)), 30);\n      for (let i = 0; i < toSpawn; i++) this.spawnOne();\n    }\n    \n    if (this.particles.length > target) {\n      const surplus = this.particles.length - target;\n      const toCull = Math.min(surplus, Math.max(1, Math.ceil(this.particles.length * 0.02)));\n      for (let i = 0; i < toCull; i++) {\n        const p = this.particles.pop();\n        if (p) {\n          try { p.g.parent && p.g.parent.removeChild(p.g); p.g.destroy(); } catch {}\n        }\n      }\n    }\n\n    const dt = dtMs / 1000;\n    const gAcc = 1200; \n    const toRemove = [];\n\n    for (let i = 0; i < this.particles.length; i++) {\n      const p = this.particles[i];\n      p.vy += gAcc * dt;\n      p.x += p.vx * dt;\n      p.y += p.vy * dt;\n\n      p.g.x = p.x;\n      p.g.y = p.y;\n\n      // Interaction with surfaces / water\n      if (this.api.getLiquidSurfaceY) {\n        const waterY = this.api.getLiquidSurfaceY('water', p.x);\n        if (Number.isFinite(waterY) && p.y >= waterY) {\n          if (typeof this.api.onLavaImpact === 'function') {\n            this.api.onLavaImpact({ x: p.x, y: waterY, strength: 0.9 });\n          }\n          p.alive = false;\n          toRemove.push(i);\n          continue;\n        }\n      }\n\n      // Interaction with solid surfaces\n      if (this.api.isSolidAt(p.x, p.y)) {\n         // Lava drops just vanish on hit with a tiny \"ember\" effect (optional)\n         if (typeof this.api.onLavaImpact === 'function' && Math.random() > 0.5) {\n            this.api.onLavaImpact({ x: p.x, y: p.y, strength: 0.2 });\n         }\n         p.alive = false;\n         toRemove.push(i);\n         continue;\n      }\n\n      const viewport = this.api.getViewport ? this.api.getViewport() : null;\n      const vY = viewport ? viewport.y : 0;\n      const vH = viewport ? viewport.height : this.height;\n      if (p.y > vY + vH + 50 || p.y > this.height + 40 || p.x < -40 || p.x > this.width + 40) {\n        p.alive = false;\n        toRemove.push(i);\n      }\n    }\n\n    for (let j = toRemove.length - 1; j >= 0; j--) {\n      const idx = toRemove[j];\n      const p = this.particles[idx];\n      if (p && p.g) {\n        try { p.g.parent && p.g.parent.removeChild(p.g); p.g.destroy(); } catch {}\n      }\n      this.particles.splice(idx, 1);\n    }\n  }\n\n  destroy() {\n    this.particles.forEach(p => {\n      try { p.g.parent && p.g.parent.removeChild(p.g); p.g.destroy(); } catch {}\n    });\n    this.particles = [];\n  }\n}\n","import { Graphics, Texture, TilingSprite } from 'pixi.js';\n\n// Radioactive fog overlay: similar to fog but toxic green\nexport default class WeatherRadioactiveFog {\n  constructor(container, api, getIntensity) {\n    this.container = container;\n    this.api = api;\n    this.getIntensity = getIntensity || (() => 0);\n    this.width = api.mapWidth * api.tileSize;\n    this.height = api.mapHeight * api.tileSize;\n    this.intensity = 0;\n    this.time = 0;\n\n    this.g = new Graphics();\n    this.container.addChild(this.g);\n\n    this.noiseTex = WeatherRadioactiveFog._createNoiseTexture(128, 128);\n    this.layer1 = new TilingSprite({ texture: this.noiseTex, width: this.width, height: this.height });\n    this.layer2 = new TilingSprite({ texture: this.noiseTex, width: this.width, height: this.height });\n    \n    this.layer1.tileScale.set(1.2, 1.2);\n    this.layer2.tileScale.set(0.7, 0.9);\n    this.layer1.alpha = 0;\n    this.layer2.alpha = 0;\n    this.container.addChild(this.layer1);\n    this.container.addChild(this.layer2);\n\n    this._recalcParams();\n    this._draw();\n  }\n\n  _alphaFromIntensity(v) {\n    const t = Math.max(0, Math.min(100, Number(v) || 0)) / 100;\n    return Math.max(0, Math.min(0.75, t * 0.75));\n  }\n\n  setIntensity(v) {\n    const nv = Math.max(0, Math.min(100, Number(v) || 0));\n    if (nv === this.intensity) return;\n    this.intensity = nv;\n    this._recalcParams();\n    this._applyAlphas(0);\n    this._draw();\n  }\n\n  resize(width, height) {\n    const w = Math.max(1, Math.floor(width));\n    const h = Math.max(1, Math.floor(height));\n    if (w === this.width && h === this.height) return;\n    this.width = w;\n    this.height = h;\n    if (this.layer1) { this.layer1.width = w; this.layer1.height = h; }\n    if (this.layer2) { this.layer2.width = w; this.layer2.height = h; }\n    this._draw();\n  }\n\n  _draw() {\n    const w = this.width;\n    const h = this.height;\n    const g = this.g;\n    g.clear();\n    const baseAlpha = this._alphaFromIntensity(this.intensity);\n    if (baseAlpha <= 0) {\n      g.alpha = 0;\n      return;\n    }\n    g.rect(0, 0, w, h);\n    // Toxic green tint\n    g.fill({ color: 0x1a5c1a, alpha: 1 });\n    g.alpha = baseAlpha;\n  }\n\n  update(dtMs) {\n    const targetIntensity = Math.max(0, Math.min(100, this.getIntensity()));\n    if (Math.abs(targetIntensity - this.intensity) > 0.1) {\n      const lerpFactor = 1 - Math.exp(-0.0015 * dtMs);\n      this.setIntensity(this.intensity + (targetIntensity - this.intensity) * lerpFactor);\n    } else {\n      this.setIntensity(targetIntensity);\n    }\n\n    const viewport = this.api.getViewport ? this.api.getViewport() : null;\n    if (viewport) {\n      if (this.g) { this.g.x = viewport.x; this.g.y = viewport.y; }\n      if (this.layer1) { this.layer1.x = viewport.x; this.layer1.y = viewport.y; }\n      if (this.layer2) { this.layer2.x = viewport.x; this.layer2.y = viewport.y; }\n    }\n\n    const dt = Math.max(0, Number(dtMs) || 16.67);\n    this.time += dt;\n    const pulse = 1 + 0.06 * Math.sin(this.time * 0.001);\n    this._applyAlphas(pulse);\n\n    if (this.layer1) {\n      this.layer1.tilePosition.x += this.speed1.x * dt;\n      this.layer1.tilePosition.y += this.speed1.y * dt;\n    }\n    if (this.layer2) {\n      this.layer2.tilePosition.x += this.speed2.x * dt;\n      this.layer2.tilePosition.y += this.speed2.y * dt;\n    }\n  }\n\n  destroy() {\n    if (this.g) {\n      try { this.g.parent && this.g.parent.removeChild(this.g); this.g.destroy(); } catch {}\n    }\n    this.g = null;\n    if (this.layer1) { try { this.layer1.parent && this.layer1.parent.removeChild(this.layer1); this.layer1.destroy(true); } catch {} }\n    if (this.layer2) { try { this.layer2.parent && this.layer2.parent.removeChild(this.layer2); this.layer2.destroy(true); } catch {} }\n    this.layer1 = null; this.layer2 = null;\n    try { this.noiseTex?.destroy(true); } catch {}\n    this.noiseTex = null;\n  }\n\n  _applyAlphas(pulseFactor = 1) {\n    const base = this._alphaFromIntensity(this.intensity);\n    const t = Math.max(0, Math.min(1, this.intensity / 100));\n    const noiseAlpha = base * (0.3 + 0.4 * t);\n    if (this.g) this.g.alpha = base * pulseFactor;\n    if (this.layer1) this.layer1.alpha = noiseAlpha * 0.7;\n    if (this.layer2) this.layer2.alpha = noiseAlpha;\n  }\n\n  _recalcParams() {\n    const t = Math.max(0, Math.min(1, this.intensity / 100));\n    const lerp = (a, b, u) => a + (b - a) * u;\n    this.speed1 = { x: lerp(0.004, 0.02, t), y: lerp(0.0, 0.01, t) };\n    this.speed2 = { x: lerp(-0.005, -0.015, t), y: lerp(0.003, 0.015, t) };\n  }\n\n  static _createNoiseTexture(w = 128, h = 128) {\n    const canvas = document.createElement('canvas');\n    canvas.width = w; canvas.height = h;\n    const ctx = canvas.getContext('2d');\n    const img = ctx.createImageData(w, h);\n    for (let i = 0; i < img.data.length; i += 4) {\n      const v = 180 + Math.floor(Math.random() * 75); \n      img.data[i] = v * 0.4;\n      img.data[i + 1] = v;\n      img.data[i + 2] = v * 0.4;\n      img.data[i + 3] = 255;\n    }\n    ctx.putImageData(img, 0, 0);\n    return Texture.from(canvas);\n  }\n}\n","import { Graphics } from 'pixi.js';\n\n// Meteor rain system: large falling fireballs that can deal damage via API callback\nexport default class WeatherMeteorRain {\n  constructor(container, api, getIntensity) {\n    this.container = container;\n    this.api = api;\n    this.getIntensity = getIntensity || (() => 0);\n    this.width = api.mapWidth * api.tileSize;\n    this.height = api.mapHeight * api.tileSize;\n    this.particles = [];\n    this.intensity = 0;\n    this.maxParticles = 15; // Meteors are rare and large\n  }\n\n  resize(width, height) {\n    this.width = width;\n    this.height = height;\n  }\n\n  spawnOne() {\n    const size = 4 + Math.random() * 8; // Meteor radius\n    const isLarge = size > 9;\n    \n    const g = new Graphics();\n    g.clear();\n    \n    // Core\n    g.circle(0, 0, size);\n    g.fill({ color: 0x555555, alpha: 1 });\n    \n    // Glow/Fire\n    g.circle(0, 0, size * 1.5);\n    g.fill({ color: 0xff4500, alpha: 0.4 });\n    \n    // Tail\n    g.moveTo(-size, 0);\n    g.lineTo(0, -size * 4);\n    g.lineTo(size, 0);\n    g.fill({ color: 0xff8c00, alpha: 0.6 });\n\n    const viewport = this.api.getViewport ? this.api.getViewport() : null;\n    \n    let x, y;\n    if (viewport) {\n      x = viewport.x - 200 + Math.random() * (viewport.width + 400);\n      y = viewport.y - 100 - Math.random() * 200;\n    } else {\n      x = Math.random() * this.width;\n      y = -100 - Math.random() * 200;\n    }\n\n    const vx = 100 + Math.random() * 100; // slanted fall\n    const vy = 400 + Math.random() * 300;\n    \n    g.x = x;\n    g.y = y;\n    // Rotate towards fall direction\n    g.rotation = Math.atan2(vy, vx) - Math.PI/2;\n    \n    this.container.addChild(g);\n    this.particles.push({ g, x, y, vx, vy, size, isLarge, alive: true, waterTouched: false });\n  }\n\n  update(dtMs) {\n    const targetIntensity = Math.max(0, Math.min(100, this.getIntensity()));\n    if (Math.abs(targetIntensity - this.intensity) > 0.1) {\n      const lerpFactor = 1 - Math.exp(-0.0005 * dtMs);\n      this.intensity += (targetIntensity - this.intensity) * lerpFactor;\n    } else {\n      this.intensity = targetIntensity;\n    }\n\n    const norm = this.intensity / 100;\n    const target = Math.floor(this.maxParticles * norm);\n\n    if (this.particles.length < target && Math.random() < 0.02 * norm) {\n      this.spawnOne();\n    }\n\n    const dt = dtMs / 1000;\n    const toRemove = [];\n\n    for (let i = 0; i < this.particles.length; i++) {\n      const p = this.particles[i];\n      p.x += p.vx * dt;\n      p.y += p.vy * dt;\n      p.g.x = p.x;\n      p.g.y = p.y;\n\n      const playerState = typeof this.api.getPlayerState === 'function'\n        ? this.api.getPlayerState()\n        : null;\n      let hitEntity = false;\n      if (playerState) {\n        const px = (playerState.x || 0) + (playerState.width || 0) / 2;\n        const py = (playerState.y || 0) + (playerState.height || 0) / 2;\n        const pr = Math.max(6, Math.max(playerState.width || 0, playerState.height || 0) / 2);\n        const dx = px - p.x;\n        const dy = py - p.y;\n        if ((dx * dx + dy * dy) <= Math.pow(p.size + pr, 2)) {\n          hitEntity = true;\n        } else if (Array.isArray(playerState.entities)) {\n          for (const ent of playerState.entities) {\n            const ex = (ent.x || 0) + (ent.width || 0) / 2;\n            const ey = (ent.y || 0) + (ent.height || 0) / 2;\n            const er = Math.max(6, Math.max(ent.width || 0, ent.height || 0) / 2);\n            const edx = ex - p.x;\n            const edy = ey - p.y;\n            if ((edx * edx + edy * edy) <= Math.pow(p.size + er, 2)) {\n              hitEntity = true;\n              break;\n            }\n          }\n        }\n      }\n\n      if (hitEntity) {\n        if (typeof this.api.onMeteorHit === 'function') {\n          this.api.onMeteorHit({ x: p.x, y: p.y, size: p.size, isLarge: p.isLarge, surfaceType: 'air' });\n        }\n        p.alive = false;\n        toRemove.push(i);\n        continue;\n      }\n\n      const liquidType = typeof this.api.getLiquidTypeAt === 'function'\n        ? this.api.getLiquidTypeAt(p.x, p.y)\n        : null;\n\n      if (liquidType) {\n        if (liquidType === 'water' && typeof this.api.onWaterImpact === 'function') {\n          if (!p.waterTouched) {\n            this.api.onWaterImpact({ x: p.x, strength: p.isLarge ? 1.4 : 0.8 });\n            p.waterTouched = true;\n          }\n          // Meteors pass through water until hitting solid ground\n        } else {\n          if (liquidType === 'lava' && typeof this.api.onLavaImpact === 'function') {\n            this.api.onLavaImpact({ x: p.x, y: p.y, strength: p.isLarge ? 1.6 : 0.9 });\n          }\n\n          if (typeof this.api.onMeteorHit === 'function') {\n            this.api.onMeteorHit({ x: p.x, y: p.y, size: p.size, isLarge: p.isLarge, surfaceType: liquidType });\n          }\n\n          p.alive = false;\n          toRemove.push(i);\n          continue;\n        }\n      }\n\n      // Check collision with solid world\n      if (this.api.isSolidAt(p.x, p.y)) {\n        // Explosion effect\n        if (typeof this.api.onLavaImpact === 'function') {\n           this.api.onLavaImpact({ x: p.x, y: p.y, strength: p.isLarge ? 1.5 : 0.8 });\n        }\n        \n        // Notify engine about meteor hit for damage\n        if (typeof this.api.onMeteorHit === 'function') {\n           this.api.onMeteorHit({ x: p.x, y: p.y, size: p.size, isLarge: p.isLarge, surfaceType: 'ground' });\n        }\n\n        p.alive = false;\n        toRemove.push(i);\n        continue;\n      }\n\n      const viewport = this.api.getViewport ? this.api.getViewport() : null;\n      if (viewport && (p.y > viewport.y + viewport.height + 100 || p.x > viewport.x + viewport.width + 100)) {\n        p.alive = false;\n        toRemove.push(i);\n      } else if (!viewport && (p.y > this.height + 100 || p.x > this.width + 100)) {\n        p.alive = false;\n        toRemove.push(i);\n      }\n    }\n\n    for (let j = toRemove.length - 1; j >= 0; j--) {\n      const idx = toRemove[j];\n      const p = this.particles[idx];\n      if (p && p.g) {\n        try { p.g.parent && p.g.parent.removeChild(p.g); p.g.destroy(); } catch {}\n      }\n      this.particles.splice(idx, 1);\n    }\n  }\n\n  destroy() {\n    this.particles.forEach(p => {\n      try { p.g.parent && p.g.parent.removeChild(p.g); p.g.destroy(); } catch {}\n    });\n    this.particles = [];\n  }\n}\n","import { Container, Graphics } from 'pixi.js';\n\n// WaterSplashFX: lightweight pooled splash particles (droplets + ring ripples)\n// API:\n//   const fx = new WaterSplashFX(container)\n//   fx.trigger({ x, y, strength, upward }) // upward=true for exit splash\n//   fx.update(dtMs)\n//   fx.resize(w,h) // noop (kept for symmetry)\n//   fx.destroy()\nexport default class WaterSplashFX {\n  constructor(container) {\n    this.container = container;\n    this.node = new Container();\n    this.container.addChild(this.node);\n    this.droplets = []; // {g,x,y,vx,vy,life,max}\n    this.rings = [];    // {g,x,y,r,vr,life,max}\n    this.maxDroplets = 48;\n    this.maxRings = 6;\n  }\n\n  destroy() {\n    try { this.node.parent && this.node.parent.removeChild(this.node); } catch {}\n    try { this.node.destroy({ children: true }); } catch {}\n    this.node = null;\n    this.droplets = [];\n    this.rings = [];\n  }\n\n  resize() {}\n\n  trigger({ x = 0, y = 0, strength = 1, upward = false } = {}) {\n    const s = Math.max(0.2, Math.min(3, Number(strength) || 1));\n    // Ring ripple on surface (entry/exit)\n    if (this.rings.length < this.maxRings) {\n      const g = new Graphics();\n      g.x = 0; g.y = 0; g.alpha = 0.8;\n      this.node.addChild(g);\n      this.rings.push({ g, x, y, r: 2 + 4 * s, vr: 0.08 + 0.12 * s, life: 0, max: 450 + 250 * s });\n    }\n    // Droplets burst\n    const count = Math.floor(8 + 18 * s);\n    for (let i = 0; i < count && this.droplets.length < this.maxDroplets; i++) {\n      const ang = upward ? (-Math.PI * 0.15 + Math.random() * Math.PI * 0.3) : (Math.PI * 0.6 + (Math.random() - 0.5) * Math.PI * 0.6);\n      const spd = (0.12 + Math.random() * 0.25) * (upward ? 1.2 : 1) * (0.6 + 0.8 * s);\n      const g = new Graphics();\n      g.x = 0; g.y = 0; g.alpha = 1;\n      this.node.addChild(g);\n      this.droplets.push({ g, x, y, vx: Math.cos(ang) * spd, vy: Math.sin(ang) * spd, life: 0, max: 500 + Math.random() * 400 });\n    }\n  }\n\n  update(dtMs) {\n    const dt = Math.max(0, Number(dtMs) || 16.67);\n    // Droplets update\n    for (let i = this.droplets.length - 1; i >= 0; i--) {\n      const d = this.droplets[i];\n      d.life += dt;\n      d.vy += 0.0018 * dt; // gravity\n      d.x += d.vx * dt;\n      d.y += d.vy * dt;\n      const t = Math.min(1, d.life / d.max);\n      const alpha = 1 - t;\n      const size = 1 + 1.5 * (1 - t);\n      const g = d.g; g.clear();\n      g.circle(d.x, d.y, size);\n      g.fill({ color: 0xc9ecff, alpha: Math.max(0, alpha) });\n      if (d.life >= d.max) {\n        try { g.parent && g.parent.removeChild(g); } catch {}\n        try { g.destroy(); } catch {}\n        this.droplets.splice(i, 1);\n      }\n    }\n    // Rings update\n    for (let i = this.rings.length - 1; i >= 0; i--) {\n      const r = this.rings[i];\n      r.life += dt;\n      r.r += r.vr * dt;\n      const t = Math.min(1, r.life / r.max);\n      const alpha = 0.6 * (1 - t);\n      const g = r.g; g.clear();\n      g.circle(r.x, r.y, r.r);\n      g.stroke({ width: 1.5, color: 0xc9ecff, alpha: Math.max(0, alpha) });\n      if (r.life >= r.max) {\n        try { g.parent && g.parent.removeChild(g); } catch {}\n        try { g.destroy(); } catch {}\n        this.rings.splice(i, 1);\n      }\n    }\n  }\n}\n","import { Container, Graphics } from 'pixi.js';\n\n// BubbleFX: lightweight bubble particles for underwater ambience\nexport default class BubbleFX {\n  constructor(container) {\n    this.container = container;\n    this.node = new Container();\n    this.container.addChild(this.node);\n    this.bubbles = [];\n    this.maxBubbles = 120;\n  }\n\n  destroy() {\n    try { this.node.parent && this.node.parent.removeChild(this.node); } catch {}\n    try { this.node.destroy({ children: true }); } catch {}\n    this.node = null;\n    this.bubbles = [];\n  }\n\n  trigger({ x = 0, y = 0, size = 2, rise = 0.03, life = 1200, drift = 0.02 } = {}) {\n    if (this.bubbles.length >= this.maxBubbles) return;\n    const g = new Graphics();\n    g.x = 0;\n    g.y = 0;\n    this.node.addChild(g);\n    this.bubbles.push({\n      g,\n      x,\n      y,\n      size,\n      rise,\n      drift,\n      life: 0,\n      max: life\n    });\n  }\n\n  update(dtMs) {\n    const dt = Math.max(0, Number(dtMs) || 16.67);\n    for (let i = this.bubbles.length - 1; i >= 0; i--) {\n      const b = this.bubbles[i];\n      b.life += dt;\n      b.y -= b.rise * dt;\n      b.x += (Math.random() - 0.5) * b.drift * dt;\n      const t = Math.min(1, b.life / b.max);\n      const alpha = 0.7 * (1 - t);\n      const size = Math.max(0.5, b.size * (1 - t * 0.2));\n      const g = b.g;\n      g.clear();\n      g.circle(b.x, b.y, size);\n      g.stroke({ width: 1, color: 0xc9ecff, alpha: Math.max(0, alpha) });\n      if (b.life >= b.max) {\n        try { g.parent && g.parent.removeChild(g); } catch {}\n        try { g.destroy(); } catch {}\n        this.bubbles.splice(i, 1);\n      }\n    }\n  }\n}\n","import { Container, Graphics } from 'pixi.js';\n\n// LavaEmbers: ambient embers with tiny smoke trails spawning from lava surface tiles\n// API:\n//   const fx = new LavaEmbers(container, api, getIntensity)\n//   fx.setIntensity(v)\n//   fx.rebuildSurfaces({ mapWidth, mapHeight, tileSize, tileMapData, registryItems })\n//   fx.update(dtMs)\n//   fx.resize(w,h)\n//   fx.destroy()\nexport default class LavaEmbers {\n  constructor(container, api, getIntensity) {\n    this.container = container;\n    this.api = api || {};\n    this.getIntensity = getIntensity || (() => 0);\n    this.node = new Container();\n    this.container.addChild(this.node);\n    this.intensity = 0;\n    this.time = 0;\n    this.spawnAcc = 0;\n    this.embers = []; // {g,x,y,vx,vy,life,max,trail}\n    this.maxEmbers = 60;\n    this.surfaces = []; // {x,y,w}\n  }\n\n  destroy() {\n    try { this.node.parent && this.node.parent.removeChild(this.node); } catch {}\n    try { this.node.destroy({ children: true }); } catch {}\n    this.embers = [];\n    this.surfaces = [];\n  }\n\n  setIntensity(v) {\n    const nv = Math.max(0, Math.min(100, Number(v) || 0));\n    this.intensity = nv;\n  }\n\n  resize() {}\n\n  rebuildSurfaces({ mapWidth, mapHeight, tileSize, tileMapData, registryItems }) {\n    const getDef = (id) => Array.isArray(registryItems) ? registryItems.find(r => r.id === id) : null;\n    const isLava = (def) => !!(def && def.flags && def.flags.lava);\n    const W = mapWidth, H = mapHeight, TS = tileSize;\n    const spans = [];\n    for (let gy = 0; gy < H; gy++) {\n      let runStart = -1;\n      for (let gx = 0; gx < W; gx++) {\n        const idx = gy * W + gx;\n        const id = tileMapData[idx];\n        if (!id) { if (runStart !== -1) { runStart = -1; } continue; }\n        const def = getDef(id);\n        const aboveIdx = (gy - 1) * W + gx;\n        const aboveLava = gy > 0 && isLava(getDef(tileMapData[aboveIdx]));\n        const hereLava = isLava(def);\n        const isSurface = hereLava && !aboveLava;\n        if (isSurface) {\n          if (runStart === -1) runStart = gx;\n        } else {\n          if (runStart !== -1) {\n            const w = (gx - runStart) * TS;\n            if (w > 0) spans.push({ x: runStart * TS, y: gy * TS, w });\n            runStart = -1;\n          }\n        }\n      }\n      if (runStart !== -1) {\n        const w = (W - runStart) * TS;\n        if (w > 0) spans.push({ x: runStart * TS, y: gy * TS, w });\n      }\n    }\n    this.surfaces = spans;\n  }\n\n  _spawnOne() {\n    if (!this.surfaces.length) return;\n    if (this.embers.length >= this.maxEmbers) return;\n    const s = this.surfaces[Math.floor(Math.random() * this.surfaces.length)];\n    const x = s.x + Math.random() * s.w;\n    const y = s.y - 2; // just above surface\n    const g = new Graphics();\n    this.node.addChild(g);\n    const vx = (Math.random() - 0.5) * 0.02; // small horizontal drift\n    const vy = -0.05 - Math.random() * 0.06; // initial upward\n    const life = 0; const max = 1200 + Math.random() * 1200; // 1.2..2.4s\n    this.embers.push({ g, x, y, vx, vy, life, max, trail: [] });\n  }\n\n  update(dtMs) {\n    const dt = Math.max(0, Number(dtMs) || 16.67);\n    // live intensity\n    const cur = Math.max(0, Math.min(100, this.getIntensity()))\n    this.setIntensity(cur);\n    if (this.intensity <= 0) return;\n\n    // Spawn rate depends on intensity and surface count\n    const baseRate = 0.0015 + 0.0035 * (this.intensity / 100); // embers per ms\n    const mult = Math.max(0.5, Math.min(3, this.surfaces.length / 6));\n    this.spawnAcc += dt * baseRate * mult;\n    while (this.spawnAcc >= 1) {\n      this._spawnOne();\n      this.spawnAcc -= 1;\n    }\n\n    // Update embers\n    for (let i = this.embers.length - 1; i >= 0; i--) {\n      const e = this.embers[i];\n      e.life += dt;\n      // motion: rise then fall slightly\n      e.vy += 0.00006 * dt; // gravity slowly pulls down\n      e.x += e.vx * dt;\n      e.y += e.vy * dt;\n      // record simple smoke trail points\n      if (e.trail.length < 14) e.trail.push({ x: e.x, y: e.y });\n      else { e.trail.shift(); e.trail.push({ x: e.x, y: e.y }); }\n\n      const t = Math.min(1, e.life / e.max);\n      const emberAlpha = 1 - t;\n      const emberSize = 1 + 1.5 * (1 - t);\n      const g = e.g; g.clear();\n      // smoke trail (fainter)\n      for (let k = 1; k < e.trail.length; k++) {\n        const p0 = e.trail[k - 1]; const p1 = e.trail[k];\n        g.moveTo(p0.x, p0.y);\n        g.lineTo(p1.x, p1.y);\n      }\n      g.stroke({ width: 1, color: 0x555555, alpha: 0.25 * emberAlpha });\n\n      // glowing ember\n      g.circle(e.x, e.y, emberSize);\n      g.fill({ color: 0xffa229, alpha: 0.9 * emberAlpha });\n\n      if (e.life >= e.max) {\n        try { g.parent && g.parent.removeChild(g); } catch {}\n        try { g.destroy(); } catch {}\n        this.embers.splice(i, 1);\n      }\n    }\n  }\n}\n","import { Container, Graphics } from 'pixi.js';\n\n// LavaSteamFX: tiny steam puffs when rain/snow hits lava surface\n// API:\n//   const steam = new LavaSteamFX(parentContainer)\n//   steam.trigger({ x, y, strength })\n//   steam.update(dtMs)\n//   steam.destroy()\nexport default class LavaSteamFX {\n  constructor(container) {\n    this.container = container;\n    this.node = new Container();\n    this.container.addChild(this.node);\n    this.puffs = []; // {g,x,y,vx,vy,life,max,r}\n    this.maxPuffs = 80;\n  }\n\n  destroy() {\n    try { this.node.parent && this.node.parent.removeChild(this.node); } catch {}\n    try { this.node.destroy({ children: true }); } catch {}\n    this.node = null;\n    this.puffs = [];\n  }\n\n  resize() {}\n\n  trigger({ x = 0, y = 0, strength = 0.7 } = {}) {\n    const s = Math.max(0.2, Math.min(2.5, Number(strength) || 0.7));\n    const count = Math.max(2, Math.floor(3 + 4 * s));\n    for (let i = 0; i < count && this.puffs.length < this.maxPuffs; i++) {\n      const g = new Graphics();\n      this.node.addChild(g);\n      const vx = (Math.random() - 0.5) * (0.03 + 0.03 * s);\n      const vy = -(0.08 + Math.random() * 0.08) * (0.8 + 0.4 * s);\n      const r = 1.5 + Math.random() * (2.5 * s);\n      const max = 450 + Math.random() * 350;\n      this.puffs.push({ g, x, y: y - 2, vx, vy, life: 0, max, r });\n    }\n  }\n\n  update(dtMs) {\n    const dt = Math.max(0, Number(dtMs) || 16.67);\n    for (let i = this.puffs.length - 1; i >= 0; i--) {\n      const p = this.puffs[i];\n      p.life += dt;\n      p.x += p.vx * dt;\n      p.y += p.vy * dt;\n      // slight expansion and fade\n      const t = Math.min(1, p.life / p.max);\n      const alpha = 0.75 * (1 - t);\n      const radius = p.r * (1 + 0.8 * t);\n      const g = p.g; g.clear();\n      // soft grey-white steam\n      g.circle(p.x, p.y, radius);\n      g.fill({ color: 0xdfdad2, alpha: Math.max(0, alpha) });\n      if (p.life >= p.max) {\n        try { g.parent && g.parent.removeChild(g); } catch {}\n        try { g.destroy(); } catch {}\n        this.puffs.splice(i, 1);\n      }\n    }\n  }\n}\n","import { Container, Graphics, Texture, TilingSprite, Sprite } from 'pixi.js';\n\n// LiquidRegionSystem: groups contiguous liquid tiles (water/lava) into regions\n// and renders each region as a masked, animated tiling surface (weather-like style)\n// while constrained to the exact sector (region) shape.\n//\n// API:\n//   const sys = new LiquidRegionSystem(parentContainer, { mapWidth, mapHeight, tileSize });\n//   sys.build({ mapWidth, mapHeight, tileSize, tileMapData, registryItems });\n//   sys.update(dtMs);\n//   sys.resize(mapWidth, mapHeight, tileSize);\n//   sys.destroy();\n\nexport default class LiquidRegionSystem {\n  constructor(container, opts = {}) {\n    this.container = container;\n    this.bgContainer = opts.bgContainer || null;\n    this.mapWidth = opts.mapWidth || 0;\n    this.mapHeight = opts.mapHeight || 0;\n    this.tileSize = opts.tileSize || 32;\n    this._regions = []; // { type, node, mask, sprite, noise1, noise2, capG, topEdges, waves:[] }\n    this._waterTex = null;\n    this._lavaTex = null;\n    this._quicksandTex = null;\n    this._waterfallTex = null;\n    this._lavaWaterfallTex = null;\n    this._radioactiveWaterTex = null;\n    this._radioactiveWaterfallTex = null;\n    this._time = 0;\n    this._noiseTex = null;\n    this._lavaDetailTex = null;\n    this._waterDetailTex = null;\n    this._quicksandDetailTex = null;\n    this._playerState = null; // Will be set from PixiStage\n  }\n\n  setPlayerState(playerState) {\n    this._playerState = playerState;\n  }\n\n  _checkPlayerInRegion(region) {\n    if (!this._playerState || !region || !region.node) return false;\n    const p = this._playerState;\n    const px = p.x || 0;\n    const py = p.y || 0;\n    const pw = p.width || 32;\n    const ph = p.height || 32;\n\n    // Use multiple sample points for better precision\n    // 1. Center\n    const points = [\n      { x: px + pw * 0.5, y: py + ph * 0.5 },\n      { x: px + pw * 0.5, y: py + ph * 0.1 }, // Top\n      { x: px + pw * 0.5, y: py + ph * 0.9 }, // Bottom\n    ];\n\n    for (const pt of points) {\n      const gx = Math.floor(pt.x / this.tileSize);\n      const gy = Math.floor(pt.y / this.tileSize);\n      const idx = gy * this.mapWidth + gx;\n      if (region.tileIndicesSet && region.tileIndicesSet.has(idx)) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  // Query approximate surface Y (pixel) for a given X within liquid regions of type ('water'|'lava')\n  getSurfaceY(type, x) {\n    if (!Array.isArray(this._regions) || this._regions.length === 0) return null;\n    const X = Math.max(0, Math.floor(Number(x) || 0));\n    for (const r of this._regions) {\n      if (r.type !== type) continue;\n      if (!Array.isArray(r.topEdges)) continue;\n      for (let i = 0; i < r.topEdges.length; i++) {\n        const e = r.topEdges[i];\n        if (X >= e.x && X <= e.x + e.w) {\n          return e.y; // region tile top in pixels\n        }\n      }\n    }\n    return null;\n  }\n\n  destroy() {\n    try {\n      for (const r of this._regions) {\n        try { if (r.node && r.node.parent) r.node.parent.removeChild(r.node); } catch {}\n        try { if (r.bgNode && r.bgNode.parent) r.bgNode.parent.removeChild(r.bgNode); } catch {}\n        try { r.node?.destroy({ children: true }); } catch {}\n        try { r.bgNode?.destroy({ children: true }); } catch {}\n      }\n    } catch {}\n    this._regions = [];\n    try { this._waterTex?.destroy(true); } catch {}\n    try { this._lavaTex?.destroy(true); } catch {}\n    try { this._quicksandTex?.destroy(true); } catch {}\n    try { this._waterfallTex?.destroy(true); } catch {}\n    try { this._lavaWaterfallTex?.destroy(true); } catch {}\n    try { this._radioactiveWaterTex?.destroy(true); } catch {}\n    try { this._radioactiveWaterfallTex?.destroy(true); } catch {}\n    try { this._noiseTex?.destroy(true); } catch {}\n    try { this._lavaDetailTex?.destroy(true); } catch {}\n    try { this._waterDetailTex?.destroy(true); } catch {}\n    try { this._quicksandDetailTex?.destroy(true); } catch {}\n    this._waterTex = null;\n    this._lavaTex = null;\n    this._quicksandTex = null;\n    this._waterfallTex = null;\n    this._lavaWaterfallTex = null;\n    this._radioactiveWaterTex = null;\n    this._radioactiveWaterfallTex = null;\n    this._noiseTex = null;\n    this._lavaDetailTex = null;\n    this._waterDetailTex = null;\n    this._quicksandDetailTex = null;\n    if (this._gradTextures) {\n      for (const k in this._gradTextures) {\n        try { this._gradTextures[k].destroy(true); } catch {}\n      }\n      this._gradTextures = null;\n    }\n  }\n\n  clear() {\n    for (const r of this._regions) {\n      try { r.node?.parent && r.node.parent.removeChild(r.node); } catch {}\n      try { r.bgNode?.parent && r.bgNode.parent.removeChild(r.bgNode); } catch {}\n      try { r.node?.destroy({ children: true }); } catch {}\n      try { r.bgNode?.destroy({ children: true }); } catch {}\n    }\n    this._regions = [];\n  }\n\n  resize(mapWidth, mapHeight, tileSize) {\n    const mw = Math.max(1, mapWidth | 0);\n    const mh = Math.max(1, mapHeight | 0);\n    const ts = Math.max(1, tileSize | 0);\n    const changed = mw !== this.mapWidth || mh !== this.mapHeight || ts !== this.tileSize;\n    this.mapWidth = mw; this.mapHeight = mh; this.tileSize = ts;\n    if (changed) {\n      // rebuild textures at new tile size; regions will be rebuilt by caller\n      try { this._waterTex?.destroy(true); } catch {}\n      try { this._lavaTex?.destroy(true); } catch {}\n      try { this._quicksandTex?.destroy(true); } catch {}\n      try { this._waterfallTex?.destroy(true); } catch {}\n      try { this._lavaWaterfallTex?.destroy(true); } catch {}\n      try { this._radioactiveWaterTex?.destroy(true); } catch {}\n      try { this._radioactiveWaterfallTex?.destroy(true); } catch {}\n      try { this._lavaDetailTex?.destroy(true); } catch {}\n      try { this._waterDetailTex?.destroy(true); } catch {}\n      try { this._quicksandDetailTex?.destroy(true); } catch {}\n      this._waterTex = null; this._lavaTex = null; this._quicksandTex = null; this._waterfallTex = null;\n      this._lavaWaterfallTex = null;\n      this._radioactiveWaterTex = null; this._radioactiveWaterfallTex = null;\n      this._lavaDetailTex = null; this._waterDetailTex = null; this._quicksandDetailTex = null;\n    }\n  }\n\n  update(dtMs) {\n    const dt = Math.max(0, Number(dtMs) || 16.67);\n    this._time += dt;\n    // Gentle drift speeds (px/ms) per liquid type\n    const waterDrift = { x: 0, y: 0 }; // Static (bubbles added via texture/noise)\n    const lavaDrift = { x: 0, y: 0 }; // Static (floating pieces added via noise/texture)\n    const quicksandDrift = { x: 0, y: 0 }; // Static (pixels fade via noise)\n    const waterfallDrift = { x: 0, y: 0.15 }; // Fast vertical drift\n    const lavaWaterfallDrift = { x: 0, y: 0.12 }; // Lava falls a bit slower/thicker\n    const radioactiveWaterDrift = { x: 0, y: 0 }; // Static\n    const radioactiveWaterfallDrift = { x: 0, y: 0.12 }; // Match lava waterfall speed or similar\n    for (const r of this._regions) {\n      const sprite = r.sprite;\n      if (!sprite) continue;\n      const drift = r.type === 'lava' ? lavaDrift : (r.type === 'quicksand' ? quicksandDrift : (r.type === 'waterfall' ? waterfallDrift : (r.type === 'lava_waterfall' ? lavaWaterfallDrift : (r.type === 'radioactive_waterfall' ? radioactiveWaterfallDrift : (r.type === 'radioactive_water' ? radioactiveWaterDrift : waterDrift)))));\n      sprite.tilePosition.x += drift.x * dt;\n      sprite.tilePosition.y += drift.y * dt;\n      // Alpha: normally opaque, but becomes transparent when player is inside!\n      // (We'll detect player position and adjust alpha accordingly with smooth transitions)\n      let targetAlpha = 0.95;\n      if (r.type === 'water') {\n        const playerInRegion = this._checkPlayerInRegion(r);\n        targetAlpha = playerInRegion ? 0.50 : 0.95;\n      } else if (r.type === 'quicksand') {\n        const playerInRegion = this._checkPlayerInRegion(r);\n        targetAlpha = playerInRegion ? 0.70 : 1.0;\n      } else if (r.type === 'waterfall' || r.type === 'lava_waterfall' || r.type === 'radioactive_waterfall') {\n        const playerInRegion = this._checkPlayerInRegion(r);\n        targetAlpha = playerInRegion ? 0.40 : 0.65;\n      } else if (r.type === 'radioactive_water') {\n        const playerInRegion = this._checkPlayerInRegion(r);\n        targetAlpha = playerInRegion ? 0.55 : 0.90;\n      } else {\n        // Lava\n        const playerInRegion = this._checkPlayerInRegion(r);\n        targetAlpha = playerInRegion ? 0.60 : 0.98;\n      }\n\n      // Smooth transition (lerp)\n      if (r.currentAlpha === undefined) r.currentAlpha = sprite.alpha;\n      const lerpFactor = 0.005; // Adjust for speed of transition\n      const alphaDiff = targetAlpha - r.currentAlpha;\n      r.currentAlpha += alphaDiff * Math.min(1, dt * lerpFactor);\n      sprite.alpha = r.currentAlpha;\n\n      // Splash animation for waterfalls\n      if ((r.type === 'waterfall' || r.type === 'lava_waterfall' || r.type === 'radioactive_waterfall') && r.splashG && Array.isArray(r.bottomEdges)) {\n        const g = r.splashG;\n        g.clear();\n        const thickness = Math.max(2, Math.floor(this.tileSize * 0.25));\n        const F = 1000;\n        const cycle = (this._time % F) / F;\n        \n        for (const e of r.bottomEdges) {\n          // Animated foam/splash at the bottom\n          const splashHeight = thickness * (0.8 + Math.sin(this._time * 0.01 + e.x) * 0.2);\n          g.rect(e.x, e.y + this.tileSize - splashHeight, e.w, splashHeight);\n          \n          // Bubbles\n          for (let k = 0; k < 5; k++) {\n             const bx = e.x + ((e.x * 13 + k * 37 + this._time * 0.05) % e.w);\n             const by = e.y + this.tileSize - (Math.random() * thickness * 2);\n             g.circle(bx, by, 1 + Math.random() * 2);\n          }\n        }\n        const splashColor = r.type === 'lava_waterfall' ? 0xffcc00 : (r.type === 'radioactive_waterfall' ? 0xadff2f : 0xffffff);\n        g.fill({ color: splashColor, alpha: 0.5 + Math.sin(this._time * 0.02) * 0.2 });\n      }\n\n      // Animate noise/detail overlays\n      if (r.noise1) {\n        if (r.type === 'water') {\n          r.noise1.tilePosition.y -= 0.015 * dt; // Bubbles go UP\n          r.noise1.tilePosition.x += Math.sin(this._time * 0.001) * 0.005 * dt; \n        } else if (r.type === 'lava') {\n          r.noise1.tilePosition.x += 0.004 * dt; \n          r.noise1.tilePosition.y += 0.002 * dt;\n        } else if (r.type === 'quicksand') {\n          // Fade effect for pixels\n          r.noise1.alpha = 0.4 + Math.sin(this._time * 0.001) * 0.2;\n          r.noise1.tilePosition.x += 0.001 * dt;\n        } else if (r.type.includes('waterfall')) {\n          r.noise1.tilePosition.y += drift.y * 0.8 * dt;\n          r.noise1.tilePosition.x += Math.sin(this._time * 0.002) * 0.02 * dt;\n        } else {\n          r.noise1.tilePosition.x += 0.008 * dt;\n          r.noise1.tilePosition.y += 0.004 * dt;\n        }\n      }\n      if (r.noise2) {\n        if (r.type === 'quicksand') {\n          r.noise2.alpha = 0.2 + Math.cos(this._time * 0.0015) * 0.1;\n        } else if (r.type.includes('waterfall')) {\n          r.noise2.tilePosition.y += drift.y * 1.2 * dt;\n        } else {\n          r.noise2.tilePosition.x -= 0.005 * dt;\n          r.noise2.tilePosition.y += 0.003 * dt;\n        }\n      }\n\n      // Update interactive surface waves (small ripples from impacts)\n      if (!Array.isArray(r.waves)) r.waves = [];\n      if (r.waves.length) {\n        for (let i = r.waves.length - 1; i >= 0; i--) {\n          const w = r.waves[i];\n          w.t += dt; // ms\n          // Lifetimes: water longer than lava\n          const life = r.type === 'water' ? w.lifeMsWater : w.lifeMsLava;\n          if (w.t >= life) { r.waves.splice(i, 1); continue; }\n          // expand radius over time (px)\n          w.radius = w.startRadius + w.speed * (w.t / 1000);\n          // exponential decay of amplitude\n          const decay = Math.exp(-w.t / (r.type === 'water' ? 1400 : 900));\n          w.ampNow = w.amp * decay;\n        }\n      }\n\n      // Animate water surface cap (rim light) with slight sine undulation\n      if (r.type === 'water' && r.capG && Array.isArray(r.topEdges) && r.topEdges.length) {\n        const g = r.capG;\n        const amp = Math.max(1, Math.floor(this.tileSize * 0.06));\n        const thickness = Math.max(1, Math.floor(this.tileSize * 0.08));\n        g.clear();\n        for (let i = 0; i < r.topEdges.length; i++) {\n          const e = r.topEdges[i];\n          // slight vertical offset wave\n          let dy = Math.sin((this._time * 0.002) + e.x * 0.15) * (amp * 0.5);\n          // Add contributions from interactive waves (Gaussian falloff)\n          if (r.waves && r.waves.length) {\n            // use span center for sampling; keeps draw perf O(spans + waves)\n            const centerX = e.x + e.w * 0.5;\n            for (let k = 0; k < r.waves.length; k++) {\n              const w = r.waves[k];\n              const dx = centerX - w.cx;\n              const dist = Math.abs(dx);\n              if (dist > w.radius + e.w * 0.6) continue; // early reject\n              const sigma = Math.max(8, w.radius * 0.6);\n              const gauss = Math.exp(-(dx * dx) / (2 * sigma * sigma));\n              dy += w.ampNow * gauss;\n            }\n            // clamp to avoid excessive displacement\n            const maxDisp = Math.max(2, this.tileSize * 0.22);\n            if (dy > maxDisp) dy = maxDisp;\n            if (dy < -maxDisp) dy = -maxDisp;\n          }\n          g.rect(e.x, e.y - thickness + dy, e.w, thickness);\n        }\n        g.fill({ color: 0xc9ecff, alpha: 0.35 });\n      }\n    }\n  }\n\n  build({ mapWidth, mapHeight, tileSize, tileMapData, registryItems }) {\n    if (!Array.isArray(tileMapData) || !Array.isArray(registryItems)) return;\n    this.resize(mapWidth, mapHeight, tileSize);\n    this.clear();\n\n    const W = this.mapWidth;\n    const H = this.mapHeight;\n    const TS = this.tileSize;\n    const count = W * H;\n\n    const getDef = (id) => registryItems.find((r) => r.id === id);\n    const typeAt = (i) => {\n      const id = tileMapData[i];\n      if (!id) return null;\n      const def = getDef(id);\n      if (!def || !def.flags || !def.flags.liquid) return null;\n      if (def.flags.lava_waterfall) return 'lava_waterfall';\n      if (def.flags.radioactive_waterfall) return 'radioactive_waterfall';\n      if (def.flags.waterfall) return 'waterfall';\n      if (def.flags.radioactive_water) return 'radioactive_water';\n      if (def.flags.quicksand) return 'quicksand';\n      if (def.flags.lava) return 'lava';\n      if (def.flags.water) return 'water';\n      return 'liquid';\n    };\n\n    const visited = new Uint8Array(count);\n    const dirs = [1, -1, W, -W]; // 4-connectivity\n\n    for (let i = 0; i < count; i++) {\n      if (visited[i]) continue;\n      const t = typeAt(i);\n      if (!t) { visited[i] = 1; continue; }\n\n      // Flood fill this region for same liquid type\n      const regionTiles = [];\n      const queue = [i];\n      visited[i] = 1;\n      while (queue.length) {\n        const idx = queue.pop();\n        regionTiles.push(idx);\n        for (let d = 0; d < 4; d++) {\n          const n = idx + dirs[d];\n          if (n < 0 || n >= count) continue;\n          if (visited[n]) continue;\n          // prevent wrapping on left/right when using +/-1\n          if (d < 2) {\n            const row = Math.floor(idx / W);\n            const nrow = Math.floor(n / W);\n            if (row !== nrow) continue;\n          }\n          const nt = typeAt(n);\n          if (nt === t) { visited[n] = 1; queue.push(n); }\n          else { visited[n] = visited[n] || 0; }\n        }\n      }\n\n      if (regionTiles.length === 0) continue;\n      this._addRegion(t, regionTiles, W, H, TS);\n    }\n  }\n\n      _addRegion(type, tileIndices, mapWidth, mapHeight, tileSize) {\n        const node = new Container();\n        const mask = new Graphics();\n        const worldW = mapWidth * tileSize;\n        const worldH = mapHeight * tileSize;\n\n        const tileIndicesSet = new Set(tileIndices);\n\n        mask.clear();\n        const bleed = 1; // Palielints bleed, lai nosegtu spraugas\n        for (let k = 0; k < tileIndices.length; k++) {\n          const idx = tileIndices[k];\n          const gx = (idx % mapWidth);\n          const gy = Math.floor(idx / mapWidth);\n          mask.rect(\n            gx * tileSize - bleed,\n            gy * tileSize - bleed,\n            tileSize + bleed * 2,\n            tileSize + bleed * 2\n          );\n        }\n        mask.fill({ color: 0xffffff, alpha: 1 });\n\n        const tex = type === 'lava' ? (this._lavaTex || (this._lavaTex = this._createLavaTexture(tileSize)))\n                                     : (type === 'quicksand' ? (this._quicksandTex || (this._quicksandTex = this._createQuicksandTexture(tileSize)))\n                                     : (type === 'waterfall' ? (this._waterfallTex || (this._waterfallTex = this._createWaterfallTexture(tileSize)))\n                                     : (type === 'lava_waterfall' ? (this._lavaWaterfallTex || (this._lavaWaterfallTex = this._createLavaWaterfallTexture(tileSize)))\n                                     : (type === 'radioactive_waterfall' ? (this._radioactiveWaterfallTex || (this._radioactiveWaterfallTex = this._createRadioactiveWaterfallTexture(tileSize)))\n                                     : (type === 'radioactive_water' ? (this._radioactiveWaterTex || (this._radioactiveWaterTex = this._createRadioactiveWaterTexture(tileSize)))\n                                     : (this._waterTex || (this._waterTex = this._createWaterTexture(tileSize))))))));\n        \n        // v8 addressMode iestatana\n        if (tex.source && tex.source.style) {\n          tex.source.style.addressMode = 'repeat';\n        }\n\n        const tiling = new TilingSprite({\n          texture: tex,\n          width: worldW,\n          height: worldH\n        });\n        \n        tiling.tileScale.set(1, 1);\n        tiling.alpha = type === 'lava' ? 0.98 : ((type === 'waterfall' || type === 'lava_waterfall' || type === 'radioactive_waterfall') ? 0.6 : 0.92);\n        node.addChild(tiling);\n\n        // Noise/Detail sli\n        let detailTex1, detailTex2;\n        if (type.includes('lava')) {\n          detailTex1 = this._lavaDetailTex || (this._lavaDetailTex = this._createLavaDetailTexture());\n          detailTex2 = this._noiseTex || (this._noiseTex = this._createNoiseTexture());\n        } else if (type === 'quicksand') {\n          detailTex1 = this._quicksandDetailTex || (this._quicksandDetailTex = this._createQuicksandDetailTexture());\n          detailTex2 = this._noiseTex || (this._noiseTex = this._createNoiseTexture());\n        } else if (type.includes('radioactive')) {\n          detailTex1 = this._noiseTex || (this._noiseTex = this._createNoiseTexture());\n          detailTex2 = this._noiseTex;\n        } else {\n          // water, waterfall\n          detailTex1 = this._waterDetailTex || (this._waterDetailTex = this._createWaterDetailTexture());\n          detailTex2 = this._noiseTex || (this._noiseTex = this._createNoiseTexture());\n        }\n\n        if (detailTex1.source && detailTex1.source.style) detailTex1.source.style.addressMode = 'repeat';\n        if (detailTex2.source && detailTex2.source.style) detailTex2.source.style.addressMode = 'repeat';\n\n        const noise1 = new TilingSprite({ texture: detailTex1, width: worldW, height: worldH });\n        const noise2 = new TilingSprite({ texture: detailTex2, width: worldW, height: worldH });\n        \n        if (type === 'water' || type === 'radioactive_water') {\n          noise1.alpha = 0.25; noise2.alpha = 0.15;\n        } else if (type === 'waterfall' || type === 'lava_waterfall' || type === 'radioactive_waterfall') {\n          noise1.alpha = 0.2; noise2.alpha = 0.15;\n        } else if (type === 'lava') {\n          noise1.alpha = 0.4; noise2.alpha = 0.2;\n        } else if (type === 'quicksand') {\n          noise1.alpha = 0.6; noise2.alpha = 0.3;\n        } else {\n          noise1.alpha = 0.12; noise2.alpha = 0.15;\n        }\n        node.addChild(noise1, noise2);\n\n        // LABOJUMS: Maska tiek pievienota k brns, lai t sekotu ldzi node koordintm\n        node.addChild(mask);\n        node.mask = mask;\n\n        // Background slnis (zIndex 28) - lai aizsegtu fonu caur deni\n        let bgNode = null;\n        if (this.bgContainer) {\n          bgNode = new Container();\n          const bgMask = new Graphics();\n          bgMask.clear();\n          for (let k = 0; k < tileIndices.length; k++) {\n            const idx = tileIndices[k];\n            const gx = (idx % mapWidth);\n            const gy = Math.floor(idx / mapWidth);\n            bgMask.rect(gx * tileSize - bleed, gy * tileSize - bleed, tileSize + bleed * 2, tileSize + bleed * 2);\n          }\n          bgMask.fill({ color: 0xffffff, alpha: 1 });\n          bgNode.addChild(bgMask);\n          bgNode.mask = bgMask;\n\n          const bgG = new Graphics();\n          let minY = Infinity, maxY = -Infinity;\n          for (let k = 0; k < tileIndices.length; k++) {\n            const gy = Math.floor(tileIndices[k] / mapWidth) * tileSize;\n            if (gy < minY) minY = gy;\n            if (gy + tileSize > maxY) maxY = gy + tileSize;\n          }\n\n          if (!this._gradTextures) this._gradTextures = {};\n          if (!this._gradTextures[type]) {\n            let color, bottomColor;\n            if (type.includes('lava')) {\n              color = '#ffaa00'; bottomColor = '#884400';\n            } else if (type.includes('radioactive')) {\n              color = '#004400'; bottomColor = '#001100';\n            } else if (type === 'quicksand') {\n              color = '#5d4037'; bottomColor = '#2d1d19';\n            } else { \n              color = '#3a7fb8'; bottomColor = '#0b1d2e';\n            }\n            this._gradTextures[type] = this._createGradientTexture(color, bottomColor);\n          }\n\n          const bgSprite = new Sprite(this._gradTextures[type]);\n          bgSprite.width = worldW;\n          bgSprite.height = worldH;\n          bgSprite.y = 0;\n          \n          bgNode.addChild(bgSprite);\n          this.bgContainer.addChild(bgNode);\n        }\n\n        const baseAlpha = type === 'lava' ? 0.98 : ((type === 'waterfall' || type === 'lava_waterfall' || type === 'radioactive_waterfall') ? 0.6 : 0.92);\n\n        if (type === 'water' || type === 'radioactive_water') {\n          const capG = new Graphics();\n          node.addChild(capG);\n          const topEdges = this._computeTopEdgeSpans(tileIndices, mapWidth, tileSize);\n          // Saglabjam atsauces uz r reistr\n          this._regions.push({ type, node, bgNode, mask, sprite: tiling, noise1, noise2, capG, topEdges, waves: [], tileIndicesSet, currentAlpha: baseAlpha });\n        } else if (type === 'waterfall' || type === 'lava_waterfall' || type === 'radioactive_waterfall') {\n          const splashG = new Graphics();\n          node.addChild(splashG);\n          const bottomEdges = this._computeBottomEdgeSpans(tileIndices, mapWidth, tileSize);\n          this._regions.push({ type, node, bgNode, mask, sprite: tiling, noise1, noise2, splashG, bottomEdges, tileIndicesSet, currentAlpha: baseAlpha });\n        } else {\n          this._regions.push({ type, node, bgNode, mask, sprite: tiling, noise1, noise2, waves: [], tileIndicesSet, currentAlpha: baseAlpha });\n        }\n\n        this.container.addChild(node);\n      }\n\n      _createGradientTexture(topColor, bottomColor) {\n        const canvas = document.createElement('canvas');\n        const size = 64; \n        canvas.width = 2; canvas.height = size;\n        const ctx = canvas.getContext('2d');\n        const g = ctx.createLinearGradient(0, 0, 0, size);\n        g.addColorStop(0, topColor);\n        g.addColorStop(1, bottomColor);\n        ctx.fillStyle = g;\n        ctx.fillRect(0, 0, 2, size);\n        return Texture.from(canvas);\n      }\n\n  _createWaterTexture(tileSize) {\n    const canvas = document.createElement('canvas');\n    const size = 64; \n    canvas.width = size; canvas.height = size;\n    const ctx = canvas.getContext('2d');\n\n    // Solid color instead of gradient to remove horizontal bars\n    ctx.fillStyle = '#3a7fb8';\n    ctx.fillRect(0, 0, size, size);\n\n    return Texture.from(canvas);\n  }\n\n  _createLavaTexture(tileSize) {\n    const canvas = document.createElement('canvas');\n    const size = 64; \n    canvas.width = size; canvas.height = size;\n    const ctx = canvas.getContext('2d');\n\n    // Solid color instead of gradient\n    ctx.fillStyle = '#ffcc00';\n    ctx.fillRect(0, 0, size, size);\n\n    return Texture.from(canvas);\n  }\n\n  _createLavaWaterfallTexture(tileSize) {\n    const canvas = document.createElement('canvas');\n    const size = 64; \n    canvas.width = size; canvas.height = size;\n    const ctx = canvas.getContext('2d');\n\n    // No horizontal gradient to remove bars\n    ctx.fillStyle = '#ffcc00';\n    ctx.fillRect(0, 0, size, size);\n\n    // Lava pieces/streaks (vertical) - these go down\n    ctx.fillStyle = '#ffed8a';\n    for (let k = 0; k < 10; k++) {\n      ctx.globalAlpha = 0.2 + Math.random() * 0.3;\n      const x = Math.random() * size;\n      const y = Math.random() * size;\n      const h = 10 + Math.random() * 15;\n      const w = 3 + Math.random() * 4; // Wider \"chunks\"\n      ctx.fillRect(x, y, w, h);\n      if (y + h > size) ctx.fillRect(x, y - size, w, h);\n    }\n\n    return Texture.from(canvas);\n  }\n\n  _createQuicksandTexture(tileSize) {\n    const canvas = document.createElement('canvas');\n    const size = 64; \n    canvas.width = size; canvas.height = size;\n    const ctx = canvas.getContext('2d');\n\n    // Solid sand color\n    ctx.fillStyle = '#a6915b';\n    ctx.fillRect(0, 0, size, size);\n\n    // grainy texture (static here, will animate pixels via noise)\n    ctx.globalAlpha = 0.3;\n    ctx.fillStyle = '#5c5031';\n    for (let k = 0; k < 25; k++) {\n      ctx.fillRect(Math.random() * size, Math.random() * size, 1, 1);\n    }\n\n    return Texture.from(canvas);\n  }\n\n  _createWaterfallTexture(tileSize) {\n    const canvas = document.createElement('canvas');\n    const size = 64; \n    canvas.width = size; canvas.height = size;\n    const ctx = canvas.getContext('2d');\n\n    // Background color\n    ctx.fillStyle = '#3a7fb8';\n    ctx.fillRect(0, 0, size, size);\n\n    // Vertical streaks\n    ctx.fillStyle = '#ffffff';\n    for (let k = 0; k < 15; k++) {\n      ctx.globalAlpha = 0.1 + Math.random() * 0.4;\n      const x = Math.random() * size;\n      const y = Math.random() * size;\n      const h = 10 + Math.random() * 25;\n      const w = 1 + Math.random() * 2;\n      ctx.fillRect(x, y, w, h);\n      if (y + h > size) ctx.fillRect(x, y - size, w, h);\n    }\n\n    return Texture.from(canvas);\n  }\n\n  _createRadioactiveWaterTexture(tileSize) {\n    const canvas = document.createElement('canvas');\n    const size = 64; \n    canvas.width = size; canvas.height = size;\n    const ctx = canvas.getContext('2d');\n\n    // Solid toxic green\n    ctx.fillStyle = '#1a5c1a';\n    ctx.fillRect(0, 0, size, size);\n\n    // Some mini bubbles (static here, noise provides movement)\n    ctx.fillStyle = '#adff2f';\n    for (let k = 0; k < 12; k++) {\n      ctx.globalAlpha = 0.3 + Math.random() * 0.4;\n      ctx.beginPath();\n      ctx.arc(Math.random() * size, Math.random() * size, 1 + Math.random() * 1.5, 0, Math.PI * 2);\n      ctx.fill();\n    }\n\n    return Texture.from(canvas);\n  }\n\n  _createRadioactiveWaterfallTexture(tileSize) {\n    const canvas = document.createElement('canvas');\n    const size = 64; \n    canvas.width = size; canvas.height = size;\n    const ctx = canvas.getContext('2d');\n\n    ctx.fillStyle = '#1a5c1a';\n    ctx.fillRect(0, 0, size, size);\n\n    // Vertical streaks\n    ctx.fillStyle = '#adff2f';\n    for (let k = 0; k < 12; k++) {\n      ctx.globalAlpha = 0.15 + Math.random() * 0.3;\n      const x = Math.random() * size;\n      const y = Math.random() * size;\n      const h = 8 + Math.random() * 15;\n      const w = 1 + Math.random() * 2;\n      ctx.fillRect(x, y, w, h);\n      if (y + h > size) ctx.fillRect(x, y - size, w, h);\n    }\n    \n    // Pievienojam burbuus (prasba: \"var pieveinot burbuus kuri iet uzleju k radioactive water\")\n    ctx.fillStyle = '#ffffff';\n    for (let k = 0; k < 6; k++) {\n      ctx.globalAlpha = 0.2 + Math.random() * 0.3;\n      ctx.beginPath();\n      ctx.arc(Math.random() * size, Math.random() * size, 1 + Math.random(), 0, Math.PI * 2);\n      ctx.fill();\n    }\n\n    return Texture.from(canvas);\n  }\n\n  _createLavaDetailTexture(w = 128, h = 128) {\n    const canvas = document.createElement('canvas');\n    canvas.width = w; canvas.height = h;\n    const ctx = canvas.getContext('2d');\n    ctx.fillStyle = '#ff8800'; \n    for (let i = 0; i < 10; i++) {\n      ctx.globalAlpha = 0.3 + Math.random() * 0.4;\n      const sw = 12 + Math.random() * 24;\n      const sh = 10 + Math.random() * 20;\n      ctx.fillRect(Math.random() * w, Math.random() * h, sw, sh);\n    }\n    return Texture.from(canvas);\n  }\n\n  _createWaterDetailTexture(w = 128, h = 128) {\n    const canvas = document.createElement('canvas');\n    canvas.width = w; canvas.height = h;\n    const ctx = canvas.getContext('2d');\n    ctx.fillStyle = '#ffffff';\n    for (let i = 0; i < 12; i++) {\n      ctx.globalAlpha = 0.2 + Math.random() * 0.4;\n      ctx.beginPath();\n      ctx.arc(Math.random() * w, Math.random() * h, 1 + Math.random() * 2, 0, Math.PI * 2);\n      ctx.fill();\n    }\n    return Texture.from(canvas);\n  }\n\n  _createQuicksandDetailTexture(w = 128, h = 128) {\n    const canvas = document.createElement('canvas');\n    canvas.width = w; canvas.height = h;\n    const ctx = canvas.getContext('2d');\n    ctx.fillStyle = '#5c5031';\n    for (let i = 0; i < 100; i++) {\n      ctx.globalAlpha = 0.1 + Math.random() * 0.5;\n      ctx.fillRect(Math.random() * w, Math.random() * h, 1, 1);\n    }\n    return Texture.from(canvas);\n  }\n\n  _createNoiseTexture(w = 256, h = 256) {\n    const canvas = document.createElement('canvas');\n    canvas.width = w; canvas.height = h;\n    const ctx = canvas.getContext('2d');\n    \n    ctx.fillStyle = '#ffffff';\n    for(let i=0; i<500; i++) {\n      ctx.globalAlpha = Math.random() * 0.05;\n      ctx.fillRect(Math.random()*w, Math.random()*h, 2, 2);\n    }\n\n    return Texture.from(canvas);\n  }\n\n  // Given tile indices of a region, compute horizontal spans representing its top boundary per row.\n  _computeTopEdgeSpans(tileIndices, mapWidth, tileSize) {\n    // Build a set for O(1) membership\n    const set = new Set(tileIndices);\n    const spans = [];\n    // For each tile that has no neighbor directly above, create a span; merge contiguous tiles in that row\n    const tilesByRow = new Map();\n    for (const idx of tileIndices) {\n      const gy = Math.floor(idx / mapWidth);\n      const gx = idx % mapWidth;\n      const above = idx - mapWidth;\n      if (!set.has(above)) {\n        // This tile contributes to the top edge\n        const rowList = tilesByRow.get(gy) || [];\n        rowList.push(gx);\n        tilesByRow.set(gy, rowList);\n      }\n    }\n    // Merge contiguous gx into spans\n    for (const [gy, cols] of tilesByRow.entries()) {\n      cols.sort((a, b) => a - b);\n      let start = null; let prev = null;\n      for (const gx of cols) {\n        if (start === null) { start = gx; prev = gx; continue; }\n        if (gx === prev + 1) { prev = gx; continue; }\n        // flush previous span\n        spans.push({ x: start * tileSize, y: gy * tileSize, w: (prev - start + 1) * tileSize });\n        start = gx; prev = gx;\n      }\n      if (start !== null) {\n        spans.push({ x: start * tileSize, y: gy * tileSize, w: (prev - start + 1) * tileSize });\n      }\n    }\n    return spans;\n  }\n\n  // Given tile indices of a region, compute horizontal spans representing its bottom boundary per row.\n  _computeBottomEdgeSpans(tileIndices, mapWidth, tileSize) {\n    const set = new Set(tileIndices);\n    const spans = [];\n    const tilesByRow = new Map();\n    for (const idx of tileIndices) {\n      const gy = Math.floor(idx / mapWidth);\n      const gx = idx % mapWidth;\n      const below = idx + mapWidth;\n      if (!set.has(below)) {\n        const rowList = tilesByRow.get(gy) || [];\n        rowList.push(gx);\n        tilesByRow.set(gy, rowList);\n      }\n    }\n    for (const [gy, cols] of tilesByRow.entries()) {\n      cols.sort((a, b) => a - b);\n      let start = null; let prev = null;\n      for (const gx of cols) {\n        if (start === null) { start = gx; prev = gx; continue; }\n        if (gx === prev + 1) { prev = gx; continue; }\n        spans.push({ x: start * tileSize, y: gy * tileSize, w: (prev - start + 1) * tileSize });\n        start = gx; prev = gx;\n      }\n      if (start !== null) {\n        spans.push({ x: start * tileSize, y: gy * tileSize, w: (prev - start + 1) * tileSize });\n      }\n    }\n    return spans;\n  }\n\n  // Public: add a ripple/wave on a liquid surface of given type at world x\n  // type: 'water'|'lava'\n  // x: world pixel X\n  // strength: 0.2..3 roughly; maps to amplitude and speed\n  addWave(type, x, strength = 1) {\n    const t = (type === 'lava') ? 'lava' : 'water';\n    const X = Math.max(0, Math.min(this.mapWidth * this.tileSize, Number(x) || 0));\n    // Find region and a top edge span containing x\n    for (const r of this._regions) {\n      if (r.type !== t) continue;\n      const spans = r.topEdges;\n      if (!Array.isArray(spans) || spans.length === 0) continue;\n      for (let i = 0; i < spans.length; i++) {\n        const e = spans[i];\n        if (X >= e.x && X <= e.x + e.w) {\n          if (!Array.isArray(r.waves)) r.waves = [];\n          // Cap total waves to keep perf stable\n          if (r.waves.length > 24) r.waves.shift();\n          const ts = this.tileSize;\n          const s = Math.max(0.15, Math.min(3, Number(strength) || 1));\n          const baseAmp = (t === 'water') ? ts * 0.18 : ts * 0.10; // pixels\n          const amp = baseAmp * (0.4 + 0.6 * Math.min(1.0, s));\n          const speed = (t === 'water') ? (40 + 60 * s) : (30 + 40 * s); // px/s growth\n          const startRadius = Math.max(4, ts * 0.2);\n          // lifetimes in ms\n          const lifeMsWater = 1600 + 900 * s;\n          const lifeMsLava = 900 + 600 * s;\n          r.waves.push({ cx: X, t: 0, amp, ampNow: amp, speed, radius: startRadius, startRadius, lifeMsWater, lifeMsLava });\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n}\n","// Lightweight reusable health bar for PixiJS\n// Usage:\n//   import { HealthBar } from './HealthBar';\n//   const hb = new HealthBar({ width: 32, height: 4, offsetY: -6 });\n//   container.addChild(hb);\n//   hb.update(currentHealth, maxHealth);\n\nimport { Container, Graphics } from 'pixi.js';\n\nexport class HealthBar extends Container {\n  constructor(options = {}) {\n    super();\n    const {\n      width = 32,\n      height = 4,\n      offsetX = 0,\n      offsetY = -6,\n      thresholds = { warn: 0.55, danger: 0.35 },\n      colors = { ok: 0x2ecc71, warn: 0xf1c40f, danger: 0xe74c3c },\n      // Use a neutral gray track instead of near-black; keep border options for backward compat (unused)\n      trackColor = 0x666666,\n      borderColor = 0x000000,\n      borderAlpha = 0.8,\n    } = options;\n\n    this._w = Math.max(4, Math.floor(width));\n    this._h = Math.max(2, Math.floor(height));\n    this._pct = -1; // force first draw\n    this._color = 0xffffff;\n    this._thresholds = thresholds;\n    this._colors = colors;\n    this._trackColor = trackColor;\n    this._borderColor = borderColor;\n    this._borderAlpha = borderAlpha;\n\n    this.x = offsetX || 0;\n    this.y = offsetY || 0;\n\n    this._track = new Graphics();\n    this._fill = new Graphics();\n    this.addChild(this._track);\n    this.addChild(this._fill);\n\n    this._redrawAll();\n  }\n\n  resize(width, height) {\n    const w = Math.max(4, Math.floor(width || this._w));\n    const h = Math.max(2, Math.floor(height || this._h));\n    if (w === this._w && h === this._h) return;\n    this._w = w; this._h = h;\n    this._redrawAll();\n  }\n\n  update(current, max) {\n    const m = Math.max(0, Number(max) || 0);\n    if (m <= 0 || !Number.isFinite(current)) {\n      this.visible = false;\n      return;\n    }\n    const c = Math.max(0, Math.min(m, Number(current)));\n    const pct = m > 0 ? c / m : 0;\n    this.visible = true;\n\n    const color = pct < this._thresholds.danger\n      ? this._colors.danger\n      : (pct < this._thresholds.warn ? this._colors.warn : this._colors.ok);\n\n    // Only redraw fill if percent or color changed noticeably\n    if (Math.abs(pct - this._pct) > 0.001 || color !== this._color) {\n      this._pct = pct;\n      this._color = color;\n      this._redrawFill();\n    }\n  }\n\n  _redrawAll() {\n    // Track (no border)\n    const w = this._w, h = this._h;\n    this._track.clear();\n    this._track.roundRect(0, 0, w, h, Math.min(3, h * 0.5));\n    this._track.fill({ color: this._trackColor, alpha: 0.85 });\n    // Redraw fill with current state\n    this._redrawFill();\n  }\n\n  _redrawFill() {\n    const w = this._w, h = this._h;\n    const innerW = Math.max(0, Math.floor(w * Math.max(0, Math.min(1, this._pct))));\n    const radius = Math.min(2, Math.floor(h / 2));\n    this._fill.clear();\n    if (innerW <= 0) return;\n    this._fill.roundRect(0, 0, innerW, h, radius);\n    this._fill.fill({ color: this._color, alpha: 1 });\n  }\n}\n\nexport default HealthBar;\n","// Centralized z-order constants for Pixi stage layers\n// Higher numbers render above lower numbers when sortableChildren = true\nexport const LAYERS = Object.freeze({\n  parallax: 10,\n  tiles: 20,\n  tilesAnim: 25,\n  liquidBackground: 28,\n  objBehind: 30,\n  secretsBelow: 35,\n  player: 40,\n  projectiles: 50,\n  objFront: 60,\n  secretsAbove: 65,\n  weather: 70,\n  fog: 80,\n  liquids: 90,\n  liquidFx: 100,\n  overlay: 110,\n});\n\nexport default LAYERS;\n","import { Texture } from 'pixi.js';\n\n// Small helper cache for textures\nconst textureCacheMap = new Map();\n\nexport const getTexture = (url) => {\n  if (!url) {\n    console.warn('[getTexture] No URL provided');\n    return null;\n  }\n  if (textureCacheMap.has(url)) {\n    return textureCacheMap.get(url);\n  }\n  try {\n    const tex = Texture.from(url);\n    if (!tex) {\n      console.warn('[getTexture] Failed to create texture from URL:', url);\n      return null;\n    }\n    textureCacheMap.set(url, tex);\n    return tex;\n  } catch (e) {\n    console.error('[getTexture] Error creating texture:', url, e);\n    return null;\n  }\n};\n\nexport const clearTextureCache = () => {\n  textureCacheMap.forEach((t) => t.destroy && t.destroy(true));\n  textureCacheMap.clear();\n};\n\n// Background images resolver (from src/assets/background)\n// Meta stores `/assets/background/<name>`\nexport const createBackgroundResolver = () => {\n  let bgContext;\n  try {\n    // webpack require.context (CRA)\n    // relative to this file: '../../../../assets/background'\n    bgContext = require.context('../../../../assets/background', false, /\\.(png|jpe?g|svg|webp)$/i);\n  } catch (e) {\n    bgContext = null;\n  }\n\n  return (metaPath) => {\n    if (!bgContext) {\n      console.warn('[BackgroundResolver] No bgContext available');\n      return null;\n    }\n    if (!metaPath) {\n      const keys = bgContext.keys();\n      if (keys && keys.length) {\n        const mod = bgContext(keys[0]);\n        return mod.default || mod;\n      }\n      return null;\n    }\n    const name = metaPath.split('/').pop();\n    const rel = `./${name}`;\n    try {\n      const mod = bgContext(rel);\n      return mod.default || mod;\n    } catch (e) {\n      // fallback to first available\n      const keys = bgContext.keys();\n      if (keys && keys.length) {\n        const mod = bgContext(keys[0]);\n        return mod.default || mod;\n      }\n      return null;\n    }\n  };\n};\n\n// Convert ms-per-frame (JSON) to Pixi AnimatedSprite speed factor (1 = 60fps)\nexport const msToSpeed = (ms) => {\n  const m = Number(ms);\n  const msPerFrame = Number.isFinite(m) && m > 0 ? m : 500;\n  const fps = 1000 / msPerFrame;\n  return fps / 60; // Pixi speed factor\n};\n\n// Helper to get registry item by id\nexport const getRegItem = (registryItems, id) => registryItems.find((r) => r.id === id);\n\n// Solid collision helper for world tiles (used by weather systems)\nexport const createSolidChecker = (mapWidth, mapHeight, tileSize, tileMapData, registryItems) => {\n  return (wx, wy) => {\n    // Allow particles (snow/rain) to spawn above the top edge and fall into the world.\n    // Negative Y should NOT be treated as solid, otherwise flakes will \"settle\" off-screen.\n    if (wy < 0) return false;\n    // Keep left-of-world as solid to avoid pushing from outside horizontally.\n    if (wx < 0) return true;\n    const gx = Math.floor(wx / tileSize);\n    const gy = Math.floor(wy / tileSize);\n    if (gx < 0 || gy < 0 || gx >= mapWidth || gy >= mapHeight) return false; // below world is not solid\n    const idx = gy * mapWidth + gx;\n    const id = tileMapData[idx];\n    if (!id) return false;\n    const def = getRegItem(registryItems, id);\n    if (!def) return false;\n    const c = def.collision;\n    if (!c) return false;\n    if (c === true) return true;\n    if (typeof c === 'object') {\n      return !!(c.top || c.bottom || c.left || c.right);\n    }\n    return false;\n  };\n};\n","import { Texture } from 'pixi.js';\n\n// Generate procedural water frames (cached per tile size)\nexport const createWaterFrames = (tileSize) => {\n  const frames = [];\n  const F = 8; // frame count\n  for (let i = 0; i < F; i++) {\n    const canvas = document.createElement('canvas');\n    canvas.width = tileSize;\n    canvas.height = tileSize;\n    const ctx = canvas.getContext('2d');\n\n    // background gradient\n    const g = ctx.createLinearGradient(0, 0, 0, tileSize);\n    g.addColorStop(0, '#3a7fb8');\n    g.addColorStop(0.5, '#5ba3d9');\n    g.addColorStop(1, '#3a7fb8');\n    ctx.fillStyle = g;\n    ctx.fillRect(0, 0, tileSize, tileSize);\n\n    // animated ripples via sine stripes\n    ctx.globalAlpha = 0.25;\n    ctx.fillStyle = '#8fc0ff';\n    const t = i / F;\n    const bands = 3;\n    for (let b = 0; b < bands; b++) {\n      const y = Math.floor((tileSize / bands) * b + (tileSize / bands) * 0.5 + Math.sin((t + b * 0.33) * Math.PI * 2) * (tileSize * 0.08));\n      ctx.fillRect(0, y, tileSize, Math.max(1, Math.floor(tileSize * 0.06)));\n    }\n\n    // soft top highlight\n    ctx.globalAlpha = 0.18;\n    ctx.fillStyle = '#c9ecff';\n    ctx.fillRect(0, 0, tileSize, Math.max(1, Math.floor(tileSize * 0.12)));\n\n    const tex = Texture.from(canvas);\n    frames.push(tex);\n  }\n  return frames;\n};\n\n// Generate procedural lava frames (cached per tile size)\nexport const createLavaFrames = (tileSize) => {\n  const frames = [];\n  const F = 8;\n  for (let i = 0; i < F; i++) {\n    const canvas = document.createElement('canvas');\n    canvas.width = tileSize;\n    canvas.height = tileSize;\n    const ctx = canvas.getContext('2d');\n\n    // base gradient (yellow to golden)\n    const g = ctx.createLinearGradient(0, 0, 0, tileSize);\n    g.addColorStop(0, '#ffaa00');\n    g.addColorStop(1, '#ffcc00');\n    ctx.fillStyle = g;\n    ctx.fillRect(0, 0, tileSize, tileSize);\n\n    // glowing veins\n    const t = i / F;\n    ctx.globalAlpha = 0.3;\n    for (let b = 0; b < 3; b++) {\n      const y = Math.floor((tileSize / 3) * b + (tileSize / 3) * 0.5 + Math.sin((t * 2 + b * 0.6) * Math.PI * 2) * (tileSize * 0.1));\n      const h = Math.max(1, Math.floor(tileSize * 0.07));\n      const grad = ctx.createLinearGradient(0, y, 0, y + h);\n      grad.addColorStop(0, '#ffff00');\n      grad.addColorStop(1, '#ffaa00');\n      ctx.fillStyle = grad;\n      ctx.fillRect(0, y, tileSize, h);\n    }\n\n    // bubbles/dots\n    ctx.globalAlpha = 0.25;\n    ctx.fillStyle = '#ffffff';\n    const count = Math.max(2, Math.floor(tileSize * 0.12));\n    for (let k = 0; k < count; k++) {\n      const rx = Math.floor((k * 37 + i * 13) % tileSize);\n      const ry = Math.floor((k * 53 + i * 29) % tileSize);\n      ctx.fillRect(rx, ry, 1, 1);\n    }\n\n    const tex = Texture.from(canvas);\n    frames.push(tex);\n  }\n  return frames;\n};\n\n// Helpers to check if a definition is water or lava\nexport const isWaterDef = (def) => !!(def && def.flags && def.flags.water);\nexport const isLavaDef = (def) => !!(def && def.flags && def.flags.lava);\nexport const isQuicksandDef = (def) => !!(def && def.flags && def.flags.quicksand);\nexport const isWaterfallDef = (def) => !!(def && def.flags && def.flags.waterfall);\nexport const isLavaWaterfallDef = (def) => !!(def && def.flags && def.flags.lava_waterfall);\nexport const isRadioactiveWaterDef = (def) => !!(def && def.flags && def.flags.radioactive_water);\nexport const isRadioactiveWaterfallDef = (def) => !!(def && def.flags && def.flags.radioactive_waterfall);\n\n// Generate procedural quicksand frames (cached per tile size)\nexport const createQuicksandFrames = (tileSize) => {\n  const frames = [];\n  const F = 12; // slightly more frames for smoother slow movement\n  for (let i = 0; i < F; i++) {\n    const canvas = document.createElement('canvas');\n    canvas.width = tileSize;\n    canvas.height = tileSize;\n    const ctx = canvas.getContext('2d');\n\n    // base sand color (brownish yellow)\n    const g = ctx.createLinearGradient(0, 0, 0, tileSize);\n    g.addColorStop(0, '#a6915b');\n    g.addColorStop(1, '#7d6d42');\n    ctx.fillStyle = g;\n    ctx.fillRect(0, 0, tileSize, tileSize);\n\n    // grainy texture / swirling patterns\n    const t = i / F;\n    ctx.globalAlpha = 0.2;\n    ctx.fillStyle = '#5c5031';\n    for (let k = 0; k < 4; k++) {\n       const y = Math.floor((tileSize / 4) * k + (t * tileSize)) % tileSize;\n       ctx.fillRect(0, y, tileSize, 1);\n    }\n    \n    // random grains\n    ctx.globalAlpha = 0.15;\n    ctx.fillStyle = '#d1ba7d';\n    const count = Math.max(5, Math.floor(tileSize * 0.25));\n    for (let k = 0; k < count; k++) {\n      const rx = Math.floor((k * 43 + i * 7) % tileSize);\n      const ry = Math.floor((k * 61 + i * 11) % tileSize);\n      ctx.fillRect(rx, ry, 1, 1);\n    }\n\n    const tex = Texture.from(canvas);\n    frames.push(tex);\n  }\n  return frames;\n};\n\n// Generate procedural waterfall frames\nexport const createWaterfallFrames = (tileSize) => {\n  const frames = [];\n  const F = 10;\n  for (let i = 0; i < F; i++) {\n    const canvas = document.createElement('canvas');\n    canvas.width = tileSize;\n    canvas.height = tileSize;\n    const ctx = canvas.getContext('2d');\n\n    // base transparent blue (izmantojam dens krsas)\n    const g = ctx.createLinearGradient(0, 0, 0, tileSize);\n    g.addColorStop(0, 'rgba(42, 93, 143, 0.5)');\n    g.addColorStop(0.5, 'rgba(91, 163, 217, 0.5)');\n    g.addColorStop(1, 'rgba(42, 93, 143, 0.5)');\n    ctx.fillStyle = g;\n    ctx.fillRect(0, 0, tileSize, tileSize);\n\n    // sas vertiklas svtrias\n    const t = i / F;\n    ctx.fillStyle = 'rgba(255, 255, 255, 0.4)';\n    const count = 6;\n    for (let k = 0; k < count; k++) {\n      const x = Math.floor((tileSize / count) * k + (tileSize / (count*2)) + Math.sin(t * Math.PI * 2 + k) * 2);\n      const h = Math.floor(tileSize * 0.3);\n      const y = Math.floor((t * tileSize + k * (tileSize / count)) % tileSize);\n      ctx.fillRect(x, y, 2, h);\n      if (y + h > tileSize) {\n        ctx.fillRect(x, y - tileSize, 2, h);\n      }\n    }\n\n    const tex = Texture.from(canvas);\n    frames.push(tex);\n  }\n  return frames;\n};\n\n// Generate procedural lava waterfall frames\nexport const createLavaWaterfallFrames = (tileSize) => {\n  const frames = [];\n  const F = 10;\n  for (let i = 0; i < F; i++) {\n    const canvas = document.createElement('canvas');\n    canvas.width = tileSize;\n    canvas.height = tileSize;\n    const ctx = canvas.getContext('2d');\n\n    // base transparent lava colors\n    const g = ctx.createLinearGradient(0, 0, 0, tileSize);\n    g.addColorStop(0, 'rgba(255, 170, 0, 0.6)');\n    g.addColorStop(0.5, 'rgba(255, 204, 0, 0.6)');\n    g.addColorStop(1, 'rgba(255, 170, 0, 0.6)');\n    ctx.fillStyle = g;\n    ctx.fillRect(0, 0, tileSize, tileSize);\n\n    // animated lava streaks\n    const t = i / F;\n    ctx.fillStyle = 'rgba(255, 255, 0, 0.5)';\n    const count = 5;\n    for (let k = 0; k < count; k++) {\n      const x = Math.floor((tileSize / count) * k + (tileSize / (count*2)) + Math.sin(t * Math.PI * 2 + k) * 2);\n      const h = Math.floor(tileSize * 0.4);\n      const y = Math.floor((t * tileSize + k * (tileSize / count)) % tileSize);\n      ctx.fillRect(x, y, 2, h);\n      if (y + h > tileSize) {\n        ctx.fillRect(x, y - tileSize, 2, h);\n      }\n    }\n\n    const tex = Texture.from(canvas);\n    frames.push(tex);\n  }\n  return frames;\n};\n\n// Generate procedural radioactive water frames\nexport const createRadioactiveWaterFrames = (tileSize) => {\n  const frames = [];\n  const F = 12;\n  for (let i = 0; i < F; i++) {\n    const canvas = document.createElement('canvas');\n    canvas.width = tileSize;\n    canvas.height = tileSize;\n    const ctx = canvas.getContext('2d');\n\n    // background gradient (toxic green)\n    const g = ctx.createLinearGradient(0, 0, 0, tileSize);\n    g.addColorStop(0, '#1a5c1a');\n    g.addColorStop(1, '#0d2e0d');\n    ctx.fillStyle = g;\n    ctx.fillRect(0, 0, tileSize, tileSize);\n\n    const t = i / F;\n    \n    // Bubbles\n    ctx.globalAlpha = 0.6;\n    ctx.fillStyle = '#32cd32';\n    const bubbleCount = 4;\n    for (let k = 0; k < bubbleCount; k++) {\n      const bx = Math.floor((k * 137 + i * 2) % tileSize);\n      const by = Math.floor((tileSize + k * 43 - (t * tileSize + k * 10)) % tileSize);\n      const size = 1 + (Math.sin(t * Math.PI + k) * 0.5 + 0.5) * 2;\n      ctx.beginPath();\n      ctx.arc(bx, by, size, 0, Math.PI * 2);\n      ctx.fill();\n    }\n\n    // Glow streaks\n    ctx.globalAlpha = 0.2;\n    ctx.fillStyle = '#adff2f';\n    for (let b = 0; b < 2; b++) {\n      const y = Math.floor((tileSize / 2) * b + Math.sin((t + b * 0.5) * Math.PI * 2) * (tileSize * 0.1));\n      ctx.fillRect(0, y, tileSize, 1);\n    }\n\n    const tex = Texture.from(canvas);\n    frames.push(tex);\n  }\n  return frames;\n};\n\n// Generate procedural radioactive waterfall frames\nexport const createRadioactiveWaterfallFrames = (tileSize) => {\n  const frames = [];\n  const F = 16; // more frames for slower motion\n  for (let i = 0; i < F; i++) {\n    const canvas = document.createElement('canvas');\n    canvas.width = tileSize;\n    canvas.height = tileSize;\n    const ctx = canvas.getContext('2d');\n\n    const g = ctx.createLinearGradient(0, 0, 0, tileSize);\n    g.addColorStop(0, 'rgba(26, 92, 26, 0.6)');\n    g.addColorStop(0.5, 'rgba(50, 205, 50, 0.6)');\n    g.addColorStop(1, 'rgba(26, 92, 26, 0.6)');\n    ctx.fillStyle = g;\n    ctx.fillRect(0, 0, tileSize, tileSize);\n\n    const t = i / F;\n    ctx.fillStyle = 'rgba(173, 255, 47, 0.5)';\n    const count = 4; // fewer streaks\n    for (let k = 0; k < count; k++) {\n      const x = Math.floor((tileSize / count) * k + (tileSize / (count*2)) + Math.sin(t * Math.PI * 2 + k) * 2);\n      const h = Math.floor(tileSize * 0.2);\n      const y = Math.floor((t * tileSize + k * (tileSize / count)) % tileSize);\n      ctx.fillRect(x, y, 2, h);\n      if (y + h > tileSize) {\n        ctx.fillRect(x, y - tileSize, 2, h);\n      }\n    }\n\n    const tex = Texture.from(canvas);\n    frames.push(tex);\n  }\n  return frames;\n};\n","import { TilingSprite, Sprite, Texture, WRAP_MODES, BlurFilter, Assets } from 'pixi.js';\n\n// Parallax background helper. Manages background layers (solid color and image).\nexport class ParallaxBackground {\n  constructor(container, textureCache) {\n    this.container = container;\n    this.cache = textureCache;\n    this.bgSprite = null; // Solid color layer\n    this.imgSprite = null; // Image layer\n    this._worldW = 0;\n    this._worldH = 0;\n    this._lastCameraX = 0;\n    this._currentUrl = null;\n  }\n\n  build({ worldWidth, worldHeight, url, color, factor = 0.3, minWidth = 0, minHeight = 0 }) {\n    if (!this.container) return;\n    this.clear();\n\n    const w = Math.max(worldWidth, minWidth);\n    const h = Math.max(worldHeight, minHeight);\n\n    this._worldW = worldWidth;\n    this._worldH = worldHeight;\n    this._currentUrl = url;\n\n    // 1. Render solid color background FIRST (always present as base)\n    const hex = (typeof color === 'string' && color.startsWith('#'))\n      ? parseInt(color.slice(1), 16)\n      : (Number(color) || 0x87CEEB);\n    \n    const solid = new Sprite(Texture.WHITE);\n    solid.tint = hex;\n    solid.width = w;\n    solid.height = h;\n    solid.alpha = 1.0;\n    try {\n      solid.filters = [new BlurFilter({ strength: 0.8, quality: 2 })];\n    } catch {}\n    this.container.addChild(solid);\n    this.bgSprite = solid;\n\n    // 2. If URL is provided, attempt to load and render image on top\n    if (url) {\n      const setupImage = (tex) => {\n        if (!this.container || this._currentUrl !== url) return;\n        \n        // Remove old image if any\n        if (this.imgSprite) {\n          try { this.container.removeChild(this.imgSprite); } catch {}\n          try { this.imgSprite.destroy(); } catch {}\n          this.imgSprite = null;\n        }\n\n        if (!tex) {\n          console.warn('[ParallaxBackground] setupImage called with no texture');\n          return;\n        }\n\n        // Fix wrap mode for tiling\n        if (tex.baseTexture) tex.baseTexture.wrapMode = WRAP_MODES.REPEAT;\n        if (tex.source) tex.source.addressMode = 'repeat';\n\n        const sprite = new TilingSprite({ texture: tex, width: w, height: h });\n        const texH = (tex.height || (tex.source ? tex.source.height : 0) || 1);\n        const scaleY = h / texH;\n        sprite.tileScale.set(1, scaleY);\n        sprite.alpha = 1.0;\n        try {\n          sprite.filters = [new BlurFilter({ strength: 1.2, quality: 2 })];\n        } catch {}\n        \n        this.container.addChild(sprite);\n        this.imgSprite = sprite;\n        this.setScroll(this._lastCameraX || 0, factor);\n      };\n\n      // Try to get from Assets cache or Texture cache\n      let tex = null;\n      try {\n        tex = Assets.get(url);\n      } catch (e) {\n        tex = this.cache?.get(url) || Texture.from(url);\n      }\n\n      const isValid = tex && (\n        tex.valid || \n        (tex.baseTexture && tex.baseTexture.valid) || \n        (tex.source && tex.source.width > 0)\n      );\n\n      if (isValid) {\n        console.log('[ParallaxBackground] Texture already ready');\n        setupImage(tex);\n      } else {\n        console.log('[ParallaxBackground] Texture not ready, loading via Assets.load...');\n        Assets.load(url).then((loadedTex) => {\n          console.log('[ParallaxBackground] Texture loaded via Assets.load');\n          setupImage(loadedTex);\n        }).catch(err => {\n          console.error('[ParallaxBackground] Failed to load background image:', url, err);\n        });\n      }\n    }\n  }\n\n  setScroll(cameraX, factor = 0.3) {\n    this._lastCameraX = cameraX;\n    if (this.imgSprite && 'tilePosition' in this.imgSprite) {\n      this.imgSprite.tilePosition.x = -cameraX * factor;\n      this.imgSprite.tilePosition.y = 0;\n    }\n  }\n\n  resize(worldWidth, worldHeight, minWidth = 0, minHeight = 0) {\n    const w = Math.max(worldWidth, minWidth);\n    const h = Math.max(worldHeight, minHeight);\n\n    this._worldW = worldWidth;\n    this._worldH = worldHeight;\n    if (this.bgSprite) {\n      this.bgSprite.width = w;\n      this.bgSprite.height = h;\n    }\n    if (this.imgSprite) {\n      this.imgSprite.width = w;\n      this.imgSprite.height = h;\n      const tex = this.imgSprite.texture;\n      const texH = (tex?.height || (tex?.source ? tex.source.height : 0) || 1);\n      if (this.imgSprite.tileScale && texH > 0) {\n        const scaleY = h / texH;\n        this.imgSprite.tileScale.set(1, scaleY);\n      }\n    }\n  }\n\n  clear() {\n    if (this.bgSprite) {\n      try { this.container.removeChild(this.bgSprite); } catch {}\n      try { this.bgSprite.destroy(); } catch {}\n      this.bgSprite = null;\n    }\n    if (this.imgSprite) {\n      try { this.container.removeChild(this.imgSprite); } catch {}\n      try { this.imgSprite.destroy(); } catch {}\n      this.imgSprite = null;\n    }\n  }\n\n  destroy() {\n    this.clear();\n    this.container = null;\n    this.cache = null;\n  }\n}\n","import { ParallaxBackground } from '../../../../Pixi/layers/ParallaxBackground';\n\n// Build or rebuild parallax background via helper\nexport const createParallaxManager = (parallaxLayer, textureCacheRef) => {\n  let parallaxHelper = null;\n  let parallaxSprite = null;\n\n  const build = (options) => {\n    const { worldWidth, worldHeight, url, color, factor, resolveBackgroundUrl, minWidth = 0, minHeight = 0 } = options;\n\n    if (!parallaxHelper) {\n      parallaxHelper = new ParallaxBackground(parallaxLayer, textureCacheRef);\n    }\n\n    // Resolve URL and validate it exists\n    let resolvedUrl = null;\n    if (url) {\n      resolvedUrl = resolveBackgroundUrl ? resolveBackgroundUrl(url) : url;\n    }\n\n    // If no valid URL, pass null so ParallaxBackground uses solid color fallback\n    parallaxHelper.build({\n      worldWidth,\n      worldHeight,\n      url: resolvedUrl,\n      color: color || '#87CEEB',\n      factor: factor || 0.3,\n      minWidth,\n      minHeight\n    });\n\n    parallaxSprite = parallaxHelper.imgSprite || parallaxHelper.bgSprite;\n  };\n\n  const setScroll = (cameraX, factor) => {\n    if (parallaxHelper) {\n      parallaxHelper.setScroll(cameraX, factor);\n    }\n  };\n\n  const resize = (worldWidth, worldHeight, minWidth = 0, minHeight = 0) => {\n    if (parallaxHelper) {\n      parallaxHelper.resize(worldWidth, worldHeight, minWidth, minHeight);\n    }\n  };\n\n  const destroy = () => {\n    if (parallaxHelper) {\n      try {\n        parallaxHelper.destroy();\n      } catch (e) {\n        // ignore\n      }\n      parallaxHelper = null;\n      parallaxSprite = null;\n    }\n  };\n\n  return {\n    build,\n    setScroll,\n    resize,\n    destroy,\n    get sprite() {\n      return parallaxHelper?.imgSprite || parallaxHelper?.bgSprite;\n    },\n    get helper() {\n      return parallaxHelper;\n    }\n  };\n};\n","import { Sprite, AnimatedSprite, Texture, Container, Text, Rectangle } from 'pixi.js';\nimport { getTexture, msToSpeed } from './helpers';\nimport HealthBar from '../../../../Pixi/ui/HealthBar';\n\n// Build sprite from definition (static or animated)\nexport const buildSpriteFromDef = (def) => {\n  if (!def) return null;\n\n  let spr = null;\n  if (Array.isArray(def.textures) && def.textures.length > 1) {\n    const frames = def.textures.map((u) => getTexture(u)).filter(Boolean);\n    if (frames.length > 0) {\n      spr = new AnimatedSprite(frames);\n      spr.animationSpeed = msToSpeed(def.animationSpeed);\n      spr.play();\n    }\n  }\n\n  // Static sprite sheet frame (grid-based)\n  if (!spr && def.spriteSheet && def.spriteSheet.enabled && def.texture && Number.isFinite(Number(def.spriteSheet.frameIndex))) {\n    const baseTexture = getTexture(def.texture);\n    const source = baseTexture?.source;\n    if (source && source.width > 1 && source.height > 1) {\n      const totalSprites = Math.max(1, Number(def.spriteSheet.totalSprites) || 1);\n      const columns = Math.max(1, Number(def.spriteSheet.columns) || 1);\n      const rows = Math.ceil(totalSprites / columns);\n      const frameWidth = Number(def.spriteSheet.frameWidth) || (source.width / columns);\n      const frameHeight = Number(def.spriteSheet.frameHeight) || (source.height / rows);\n      const frameIndex = Math.max(0, Math.min(totalSprites - 1, Number(def.spriteSheet.frameIndex)));\n      const col = frameIndex % columns;\n      const row = Math.floor(frameIndex / columns);\n      const rect = new Rectangle(col * frameWidth, row * frameHeight, frameWidth, frameHeight);\n      spr = new Sprite(new Texture({ source, frame: rect }));\n    }\n  }\n\n  // Ja nav tekstru masva vai tas ir tuks, minm parasto tekstru\n  if (!spr && def.texture) {\n    const tex = getTexture(def.texture);\n    if (tex) {\n      spr = new Sprite(tex);\n    }\n  }\n\n  // Ja joprojm nav spr (piemram, nav tekstras), prbaudm editorIcon\n  if (!spr && def.editorIcon) {\n    spr = new Text({\n        text: def.editorIcon,\n        style: {\n            fontSize: 24,\n            fill: 0xffffff,\n            fontWeight: 'bold',\n            dropShadow: true,\n            dropShadowColor: 0x000000,\n            dropShadowBlur: 4,\n            dropShadowDistance: 2\n        }\n    });\n    // Centrjam tekstu tile ietvaros\n    spr.anchor.set(0.5, 0.5);\n    // T k ms lietojam anchor 0.5, mums bs jpielgo pozcija vlk vai eit\n    // Bet buildSpriteFromDef parasti atgrie objektu, kura anchor ir (0,0) pc noklusjuma\n    // lai tas atbilstu tileSize pozicionanai.\n    // Tpc iestatsim anchor uz 0, bet nedaudz nobdsim?\n    // Labk lietot anchor 0.5 un layerBuilder- pieskaitt tileSize/2.\n  }\n\n  if (!spr) {\n    spr = new Sprite(Texture.WHITE);\n  }\n\n  if (spr instanceof Sprite) {\n    spr.anchor.set(0, 0);\n  } else if (spr instanceof Text) {\n    // Tekstam ms gribam, lai tas btu centr, tpc atstjam 0.5\n  }\n  \n  return spr;\n};\n\n// Create player container with default and hit sprites\nexport const createPlayerContainer = (playerVisuals, registryItems, playerState, tileSize) => {\n  const playerContainer = new Container();\n\n  // Default visuals from prop\n  const defaultDef = playerVisuals || null;\n\n  // Target visuals: try specific IDs\n  const targetDef = Array.isArray(registryItems)\n    ? (registryItems.find(r => r.id === 'player_target_100') || registryItems.find(r => r.id === 'player_target'))\n    : null;\n\n  const defSprite = buildSpriteFromDef(defaultDef) || new Sprite(Texture.WHITE);\n  const hitSprite = buildSpriteFromDef(targetDef) || null;\n\n  playerContainer.addChild(defSprite);\n  if (hitSprite) playerContainer.addChild(hitSprite);\n\n  // Health bar above player\n  let healthBar = null;\n  try {\n    healthBar = new HealthBar({\n      width: (playerState?.width) || tileSize,\n      height: 4,\n      offsetX: 0,\n      offsetY: -5\n    });\n    playerContainer.addChild(healthBar);\n  } catch (e) {\n    console.warn('Failed to create health bar:', e);\n  }\n\n  // Initial visibility\n  defSprite.visible = true;\n  if (hitSprite) hitSprite.visible = false;\n\n  return {\n    container: playerContainer,\n    sprites: { def: defSprite, hit: hitSprite },\n    healthBar\n  };\n};\n\n// Update player sprite position, direction, and visibility\nexport const updatePlayerSprite = (refs, playerState, tileSize, healthBarEnabled) => {\n  const { container, sprites, healthBar } = refs;\n  if (!playerState || !container) return;\n\n  const { def, hit } = sprites || {};\n\n  // Resize child sprites to match player state\n  if (def) {\n    if (playerState.width) def.width = playerState.width;\n    if (playerState.height) def.height = playerState.height;\n  }\n  if (hit) {\n    if (playerState.width) hit.width = playerState.width;\n    if (playerState.height) hit.height = playerState.height;\n  }\n\n  // Update health bar size and value\n  if (healthBar) {\n    const enabled = healthBarEnabled !== false;\n    const inWater = !!playerState.inWater;\n    const inLava = playerState.liquidType === 'lava';\n    if (!enabled) {\n      healthBar.visible = false;\n    } else {\n      // When in water or lava, hide the player-attached HB and use overlay version instead\n      healthBar.visible = !(inWater || inLava);\n      const effectiveWidth = playerState.width || (def?.width) || tileSize;\n      healthBar.resize(effectiveWidth, 4);\n      healthBar.y = -Math.max(4, Math.floor((playerState.height || def?.height || tileSize) * 0.12));\n      healthBar.update(playerState.health, (Number(playerState.maxHealth) || 100));\n    }\n  }\n\n  // Choose which sprite is visible based on hit timer\n  const isHit = Number(playerState.hitTimerMs) > 0 && !!hit;\n  if (def) def.visible = !isHit;\n  if (hit) hit.visible = isHit;\n\n  // Direction flip is applied to the container\n  const dir = playerState.direction || 1;\n  const mag = Math.abs(container.scale.x || 1);\n  container.scale.x = dir >= 0 ? mag : -mag;\n\n  // Position container; when flipped, offset by width\n  const effectiveWidth = playerState.width || (def?.width) || tileSize;\n  container.x = Math.round(dir >= 0 ? (playerState.x || 0) : ((playerState.x || 0) + effectiveWidth));\n  container.y = Math.round(playerState.y || 0);\n};\n","import { Sprite, AnimatedSprite, Texture, Rectangle, Container, Graphics } from 'pixi.js';\nimport { getTexture, msToSpeed, getRegItem } from './helpers';\nimport { buildSpriteFromDef } from './playerManager';\nimport { isWaterDef, isLavaDef, isQuicksandDef, isWaterfallDef, isLavaWaterfallDef, isRadioactiveWaterDef, isRadioactiveWaterfallDef, createWaterFrames, createLavaFrames, createQuicksandFrames } from './liquidRendering';\nimport HealthBar from '../../../../Pixi/ui/HealthBar';\n\n// Build layers: tiles, objects, and secret overlays\nexport const rebuildLayers = (refs, options) => {\n  const { bgRef, objBehindRef, objFrontRef, roomBgRef, roomObjBehindRef, roomObjFrontRef, secretLayerRef } = refs;\n  if (!bgRef || !objBehindRef || !objFrontRef) return;\n\n  // Clear previous and destroy old children to prevent memory leaks/ticker buildup\n  const safeDestroy = (container) => {\n    if (!container) return;\n    const children = container.removeChildren();\n    children.forEach(child => {\n      try {\n        // Destroy child but KEEP textures in cache\n        child.destroy({ children: true, texture: false });\n      } catch (e) {}\n    });\n  };\n\n  safeDestroy(bgRef);\n  safeDestroy(objBehindRef);\n  safeDestroy(objFrontRef);\n  safeDestroy(roomBgRef);\n  safeDestroy(roomObjBehindRef);\n  safeDestroy(roomObjFrontRef);\n  safeDestroy(secretLayerRef?.below);\n  safeDestroy(secretLayerRef?.above);\n\n  const secretOverlays = {\n    below: new Map(),\n    above: new Map()\n  };\n\n  // 1. Render main map\n  renderMapContent(refs, options, 0, 0, secretOverlays, bgRef, objBehindRef, objFrontRef);\n\n  // 2. Render active rooms\n  const { activeRoomIds, maps, objectMetadata, secretMapData, mapWidth, tileSize } = options;\n  if (activeRoomIds && activeRoomIds.length > 0 && maps && objectMetadata && secretMapData) {\n    activeRoomIds.forEach(roomId => {\n      const roomMap = maps[roomId];\n      if (!roomMap) return;\n\n      // Find the room_area on the current map that links to this room\n      const roomAreaIndex = Object.keys(objectMetadata).find(idx => \n        secretMapData[idx] === 'room_area' && objectMetadata[idx].linkedMapId === roomId\n      );\n\n      if (roomAreaIndex !== undefined) {\n        const idx = parseInt(roomAreaIndex);\n        const ox = Math.round((idx % mapWidth) * tileSize);\n        const oy = Math.round(Math.floor(idx / mapWidth) * tileSize);\n        \n        const roomSecrets = roomMap.secretMapData || (roomMap.layers?.find(l => l.name === 'secrets' || l.type === 'secret')?.data) || [];\n        \n        const roomOptions = {\n          ...options,\n          mapWidth: roomMap.mapWidth || roomMap.width,\n          mapHeight: roomMap.mapHeight || roomMap.height,\n          tileMapData: roomMap.tileMapData || (roomMap.layers?.find(l => l.name === 'background')?.data) || [],\n          objectMapData: roomMap.objectMapData || (roomMap.layers?.find(l => l.name === 'entities')?.data) || [],\n          secretMapData: roomSecrets,\n          objectMetadata: roomMap.objectMetadata || {},\n          mapType: 'room',\n          backgroundColor: roomMap.selectedBackgroundColor,\n          activeRoomIds: [] // Avoid recursion\n        };\n\n        renderMapContent(refs, roomOptions, ox, oy, secretOverlays, roomBgRef, roomObjBehindRef, roomObjFrontRef);\n      }\n    });\n  }\n\n  // 3. Render collected secret overlays\n  renderSecretOverlays(refs, options, secretOverlays);\n};\n\nconst renderMapContent = (refs, options, offsetX, offsetY, secretOverlays, targetBg, targetObjBehind, targetObjFront) => {\n  const {\n    mapWidth, mapHeight, tileSize, tileMapData, objectMapData, secretMapData,\n    revealedSecrets, registryItems, objectMetadata, isEditor, isEditorPlayMode, mapType,\n    activeRoomIds, maps\n  } = options;\n\n  const { secretLayerRef } = refs;\n  const getDef = (id) => getRegItem(registryItems, id);\n\n  // Pre-calculate indices covered by active rooms to hide main map content under them\n  const activeRoomIndices = new Set();\n  const roomWindowIndices = new Set(); // Store indices where rooms have windows\n\n  if (mapType !== 'room' && activeRoomIds && activeRoomIds.length > 0 && maps) {\n      Object.entries(objectMetadata || {}).forEach(([idxStr, meta]) => {\n          const idx = parseInt(idxStr);\n          if (secretMapData?.[idx] === 'room_area' && meta?.linkedMapId && activeRoomIds.includes(meta.linkedMapId)) {\n              const roomMap = maps[meta.linkedMapId];\n              if (!roomMap) return;\n\n              const roomSecrets = roomMap.secretMapData || (roomMap.layers?.find(l => l.name === 'secrets' || l.type === 'secret')?.data) || [];\n              const rw = meta.width || 1;\n              const rh = meta.height || 1;\n              const rx = idx % mapWidth;\n              const ry = Math.floor(idx / mapWidth);\n              const rMapW = roomMap.mapWidth || roomMap.width || rw;\n\n              for (let dy = 0; dy < rh; dy++) {\n                  for (let dx = 0; dx < rw; dx++) {\n                      const worldIdx = (ry + dy) * mapWidth + (rx + dx);\n                      const localIdx = dy * rMapW + dx;\n                      \n                      // In the main map context, roomWindowIndices are spots where we DON'T hide the main map\n                      // because the room has a \"hole\" (window) there.\n                      // A \"hole\" is defined as no tile AND no object in the room map.\n                      const roomTiles = roomMap.tileMapData || (roomMap.layers?.find(l => l.name === 'background')?.data) || [];\n                      const roomObjs = roomMap.objectMapData || (roomMap.layers?.find(l => l.name === 'entities')?.data) || [];\n                      \n                      if (!roomTiles[localIdx] && !roomObjs[localIdx]) {\n                          roomWindowIndices.add(worldIdx);\n                          activeRoomIndices.add(worldIdx); // Also hide main map tiles here to see background through windows\n                      } else {\n                          activeRoomIndices.add(worldIdx);\n                      }\n                  }\n              }\n          }\n      });\n  }\n\n  // Add background color for rooms\n  if (mapType === 'room') {\n    const bgColorStr = options.backgroundColor || '#1a1a1a';\n    const bgColorHex = bgColorStr.startsWith('#') ? \n        parseInt(bgColorStr.substring(1), 16) : \n        0x1a1a1a;\n    \n    const roomBg = new Graphics();\n    const floorTileIds = new Set(tileMapData.filter(id => id));\n    const floorObjIds = new Set(objectMapData.filter(id => id && !id.includes('player')));\n\n    for (let i = 0; i < mapWidth * mapHeight; i++) {\n        const id = tileMapData[i];\n        const objId = objectMapData[i];\n        \n        // Window logic: if there is no tile AND no object, it's a window (transparent)\n        // Be very strict about what counts as content\n        const hasContent = (id && id !== \"0\") || (objId && objId !== \"0\" && !objId.includes('player'));\n\n        if (hasContent) {\n            const tx = i % mapWidth;\n            const ty = Math.floor(i / mapWidth);\n            const x = offsetX + tx * tileSize;\n            const y = offsetY + ty * tileSize;\n            \n            // Use a slightly larger rect (0.5px) to prevent gaps/bleeding between tiles\n            // but keep the overall room boundary sharp\n            roomBg.rect(x - 0.25, y - 0.25, tileSize + 0.5, tileSize + 0.5);\n        }\n    }\n    roomBg.fill({ color: bgColorHex, alpha: 1 });\n    targetBg.addChild(roomBg);\n  }\n\n  // Background tiles\n  for (let i = 0; i < mapWidth * mapHeight; i++) {\n    const id = tileMapData[i];\n    const secretId = secretMapData?.[i];\n\n    if (mapType === 'room' && secretId === 'room_area') {\n        continue;\n    }\n\n    // Hide content if it's under an active room\n    if (activeRoomIndices.has(i)) {\n        continue;\n    }\n\n    if (!id) continue;\n    const def = getDef(id);\n    if (!def) continue;\n\n    const secretDef = secretId ? getDef(secretId) : null;\n    const secretSubtype = secretDef?.subtype;\n    const isInOpenArea = secretSubtype === 'open' || secretSubtype === 'below';\n    const isInSecretArea = (secretSubtype === 'secret' || secretSubtype === 'above') && secretId !== 'room_area'; // Don't treat room_area as a classic secret filter if it's used as a window\n    const isSecretRevealed = revealedSecrets && revealedSecrets.includes(i);\n\n    const x = offsetX + (i % mapWidth) * tileSize;\n    const y = offsetY + Math.floor(i / mapWidth) * tileSize;\n\n    if (isInSecretArea && isSecretRevealed) {\n      const filterColor = secretDef?.filterColorInGame || secretDef?.filterColor || 'rgba(0, 0, 0, 0.6)';\n      const renderAbove = secretDef?.renderAbovePlayer;\n      const key = `${x},${y}`;\n      if (renderAbove) {\n        secretOverlays.above.set(key, filterColor);\n      } else {\n        secretOverlays.below.set(key, filterColor);\n      }\n    }\n\n    let renderOnSecretLayer = false;\n    if (isInOpenArea) {\n      renderOnSecretLayer = true;\n    } else if (isInSecretArea && isSecretRevealed) {\n      renderOnSecretLayer = true;\n    }\n\n    let sprite;\n    let frames = null;\n    if (isWaterDef(def) || isLavaDef(def) || isWaterfallDef(def) || isLavaWaterfallDef(def) || isRadioactiveWaterDef(def) || isRadioactiveWaterfallDef(def) || def.type === 'entity' || def.subtype === 'platform') {\n      continue;\n    } else {\n      if (Array.isArray(def.textures) && def.textures.length > 1) {\n        frames = def.textures.map((u) => getTexture(u)).filter(Boolean);\n      }\n      if (frames && frames.length > 0) {\n        sprite = new AnimatedSprite(frames);\n        sprite.animationSpeed = msToSpeed(def.animationSpeed);\n        sprite.play();\n      } else {\n        const tex = getTexture(def.texture) || null;\n        if (!tex) continue;\n        sprite = new Sprite(tex);\n      }\n    }\n\n    sprite.x = x;\n    sprite.y = y;\n    sprite.width = tileSize;\n    sprite.height = tileSize;\n\n    if (renderOnSecretLayer) {\n      let backingSprite;\n      if (frames && frames.length > 0) {\n        backingSprite = new AnimatedSprite(frames);\n        backingSprite.animationSpeed = sprite.animationSpeed;\n        backingSprite.play();\n      } else if (sprite.texture) {\n        backingSprite = new Sprite(sprite.texture);\n      }\n\n      if (backingSprite) {\n        backingSprite.x = x;\n        backingSprite.y = y;\n        backingSprite.width = tileSize;\n        backingSprite.height = tileSize;\n        targetBg.addChild(backingSprite);\n      }\n\n      const backing = new Graphics();\n      backing.rect(x, y, tileSize, tileSize);\n      backing.fill({ color: 0x000000, alpha: 0.7 });\n      targetBg.addChild(backing);\n\n      sprite.alpha = 0.4;\n      if (secretLayerRef?.below) {\n        secretLayerRef.below.addChild(sprite);\n      } else {\n        targetBg.addChild(sprite);\n      }\n    } else {\n      targetBg.addChild(sprite);\n    }\n  }\n\n  // Objects\n  for (let i = 0; i < mapWidth * mapHeight; i++) {\n    const id = objectMapData[i];\n    if (!id || id.includes('player')) continue;\n\n    const secretId = secretMapData?.[i];\n    if (mapType === 'room' && secretId === 'room_area') {\n        continue;\n    }\n\n    if (activeRoomIndices.has(i)) {\n        continue;\n    }\n\n    const def = getDef(id);\n    if (!def || def.type === 'entity' || def.subtype === 'platform' || def.subtype === 'pushable' || def.isPushable) continue;\n\n    const meta = (objectMetadata && objectMetadata[i]) || {};\n    const maxH = def.maxHealth || 100;\n    const health = meta.health !== undefined ? meta.health : maxH;\n\n    let visualElement;\n    if (def.spriteSheet && def.spriteSheet.enabled) {\n      const totalSprites = def.spriteSheet.totalSprites || 1;\n      const columns = def.spriteSheet.columns || totalSprites;\n      \n      const healthPercent = Math.max(0, Math.min(100, (health / maxH) * 100));\n      let frameIndex = 0;\n      \n      if (meta.currentFrame !== undefined) {\n        frameIndex = meta.currentFrame;\n      } else if (def.subtype === 'door' && mapType === 'room') {\n        frameIndex = def.interaction?.frames?.inside || 2;\n      } else if (Number.isFinite(Number(def.spriteSheet?.frameIndex))) {\n        frameIndex = Number(def.spriteSheet.frameIndex);\n      } else {\n        frameIndex = Math.floor((1 - healthPercent / 100) * (totalSprites - 1));\n      }\n      \n      frameIndex = Math.max(0, Math.min(totalSprites - 1, frameIndex));\n\n      const baseTexture = getTexture(def.texture);\n      const source = baseTexture?.source;\n      if (source && source.width > 1) {\n        const texWidth = source.width;\n        const texHeight = source.height;\n        const frameWidth = texWidth / columns;\n        const frameHeight = texHeight / Math.ceil(totalSprites / columns);\n        const col = frameIndex % columns;\n        const row = Math.floor(frameIndex / columns);\n        const rect = new Rectangle(col * frameWidth, row * frameHeight, frameWidth, frameHeight);\n        visualElement = new Sprite(new Texture({ source: source, frame: rect }));\n      } else {\n        visualElement = buildSpriteFromDef(def);\n      }\n    } else {\n      visualElement = buildSpriteFromDef(def);\n    }\n\n    if (!visualElement) continue;\n\n    const x = offsetX + (i % mapWidth) * tileSize;\n    const y = offsetY + Math.floor(i / mapWidth) * tileSize;\n    \n    const renderOffsetX = Number(def.render?.offsetX) || 0;\n    const renderOffsetY = Number(def.render?.offsetY) || 0;\n    const overlapX = Number(def.render?.overlapX) || 0;\n    const overlapY = Number(def.render?.overlapY) || 0;\n    if (visualElement.anchor && visualElement.anchor.x === 0.5) {\n      visualElement.x = tileSize / 2 + renderOffsetX - overlapX / 2;\n      visualElement.y = tileSize / 2 + renderOffsetY - overlapY / 2;\n    } else {\n      visualElement.x = renderOffsetX - overlapX / 2;\n      visualElement.y = renderOffsetY - overlapY / 2;\n    }\n    \n    const objWidth = (meta.width || def.width || 1) * tileSize;\n    const objHeight = (meta.height || def.height || 1) * tileSize;\n    visualElement.width = objWidth + overlapX;\n    visualElement.height = objHeight + overlapY;\n\n    const container = new Container();\n    container.x = x;\n    container.y = y;\n    container.isRoomContent = mapType === 'room';\n    \n    const isWeatherTrigger = def.type === 'weather_trigger';\n    const isMessageTrigger = def.type === 'message_trigger';\n    const isWolfSecret = def.type === 'wolf_secret';\n    const shouldShowAnyway = (isWeatherTrigger || isMessageTrigger || isWolfSecret) && (isEditor || isEditorPlayMode);\n    \n    if (def.isHiddenInGame && !isEditor && !shouldShowAnyway) {\n        container.visible = false;\n    }\n\n    const secretDef = secretId ? getDef(secretId) : null;\n    const secretSubtype = secretDef?.subtype;\n    const isInSecretArea = (secretSubtype === 'secret' || secretSubtype === 'above') && secretId !== 'room_area';\n    const isSecretRevealed = revealedSecrets && revealedSecrets.includes(i);\n\n    if (isInSecretArea && !isSecretRevealed && !isEditor) {\n      container.visible = false;\n    }\n\n    container.addChild(visualElement);\n\n    if (def.isDestructible && health < maxH && health > 0) {\n      try {\n        const hb = new HealthBar({\n          width: objWidth,\n          height: 4,\n          offsetX: 0,\n          offsetY: -5\n        });\n        hb.update(health, maxH);\n        container.addChild(hb);\n      } catch (e) {}\n    }\n\n    if (!!def.renderAbovePlayer) {\n      targetObjFront.addChild(container);\n    } else {\n      targetObjBehind.addChild(container);\n    }\n  }\n};\n\nconst renderSecretOverlays = (refs, options, overlays) => {\n  const { tileSize } = options;\n  const { secretLayerRef } = refs;\n\n  const drawOverlay = (map, container) => {\n    if (!container || map.size === 0) return;\n    const overlay = new Graphics();\n    map.forEach((filterColor, key) => {\n      const [x, y] = key.split(',').map(Number);\n      const match = filterColor.match(/rgba?\\((\\d+),\\s*(\\d+),\\s*(\\d+)(?:,\\s*([\\d.]+))?\\)/);\n      if (match) {\n        const r = parseInt(match[1]);\n        const g = parseInt(match[2]);\n        const b = parseInt(match[3]);\n        const a = match[4] ? parseFloat(match[4]) : 1;\n        overlay.rect(x, y, tileSize, tileSize);\n        overlay.fill({ color: (r << 16) | (g << 8) | b, alpha: a });\n      }\n    });\n    container.addChild(overlay);\n  };\n\n  drawOverlay(overlays.below, secretLayerRef?.below);\n  drawOverlay(overlays.above, secretLayerRef?.above);\n};\n","import { Container, Text } from 'pixi.js';\nimport floatConfig from '../../../../assets/json/system/floating_text.json';\n\nexport const createFloatingTextManager = (layer) => {\n  const items = [];\n  const cfg = floatConfig || {};\n  const defaultCfg = cfg.default || {};\n  const critCfg = cfg.crit || {};\n\n  const add = ({\n    x,\n    y,\n    text,\n    color = '#ff3b3b',\n    fontSize = 14,\n    ttlMs = 900,\n    amount,\n    crit\n  }) => {\n    if (!layer || !Number.isFinite(x) || !Number.isFinite(y) || !text) return;\n\n    const amountValue = Number.isFinite(amount) ? amount : null;\n    const critThreshold = Number.isFinite(critCfg.threshold) ? critCfg.threshold : null;\n    const isCrit = !!crit || (amountValue !== null && critThreshold !== null && Math.abs(amountValue) >= critThreshold);\n\n    const baseColor = defaultCfg.color || color;\n    const finalColor = isCrit ? (critCfg.color || baseColor) : baseColor;\n    const finalFontSize = isCrit ? (critCfg.fontSize || Math.round((defaultCfg.fontSize || fontSize) * 1.2)) : (defaultCfg.fontSize || fontSize);\n    const finalTtl = isCrit ? (critCfg.ttlMs || defaultCfg.ttlMs || ttlMs) : (defaultCfg.ttlMs || ttlMs);\n    const riseSpeed = isCrit ? (critCfg.riseSpeed || defaultCfg.riseSpeed || 0.04) : (defaultCfg.riseSpeed || 0.04);\n    const jitterX = Number.isFinite(defaultCfg.jitterX) ? defaultCfg.jitterX : 6;\n    const jitterY = Number.isFinite(defaultCfg.jitterY) ? defaultCfg.jitterY : 2;\n    const prefix = isCrit && typeof critCfg.prefix === 'string' ? critCfg.prefix : '';\n    const suffix = isCrit && typeof critCfg.suffix === 'string' ? critCfg.suffix : '';\n    const finalText = `${prefix}${text}${suffix}`;\n\n    const label = new Text({\n      text: String(finalText),\n      style: {\n        fontFamily: 'monospace',\n        fontSize: finalFontSize,\n        fill: finalColor,\n        stroke: '#000000',\n        strokeThickness: 2,\n        dropShadow: true,\n        dropShadowColor: '#000000',\n        dropShadowBlur: 2,\n        dropShadowDistance: 1\n      }\n    });\n\n    label.anchor.set(0.5, 1);\n    const jitterXValue = (Math.random() * 2 - 1) * jitterX;\n    const jitterYValue = (Math.random() * 2 - 1) * jitterY;\n    label.position.set(x + jitterXValue, y + jitterYValue);\n    layer.addChild(label);\n\n    items.push({\n      label,\n      ttl: finalTtl,\n      total: finalTtl,\n      vy: -riseSpeed\n    });\n  };\n\n  const update = (deltaMs) => {\n    if (!items.length) return;\n    for (let i = items.length - 1; i >= 0; i--) {\n      const item = items[i];\n      item.ttl -= deltaMs;\n      if (item.ttl <= 0) {\n        try { item.label.destroy(); } catch {}\n        items.splice(i, 1);\n        continue;\n      }\n      item.label.y += item.vy * deltaMs;\n      item.label.alpha = Math.max(0, item.ttl / item.total);\n    }\n  };\n\n  return { add, update };\n};\n\nexport const createFloatingTextLayer = () => new Container();\n","import { Container, Graphics } from 'pixi.js';\n\nexport const createBreakEffectLayer = () => {\n  const layer = new Container();\n  layer.sortableChildren = true;\n  return layer;\n};\n\nexport const createBreakEffectManager = (layer) => {\n  const particles = [];\n\n  const add = ({ x, y, config }) => {\n    if (!layer || !config) return;\n    const count = Math.max(1, Number(config.count) || 12);\n    const speed = Math.max(0.2, Number(config.speed) || 2);\n    const lifeMs = Math.max(120, Number(config.lifeMs) || 600);\n    const size = Math.max(1, Number(config.size) || 2);\n    const gravity = Number.isFinite(Number(config.gravity)) ? Number(config.gravity) : 0.02;\n    const shape = config.shape === 'circle' ? 'circle' : 'square';\n    const angleRange = Array.isArray(config.angleRange) && config.angleRange.length >= 2 ? config.angleRange : null;\n    const colors = Array.isArray(config.colors) && config.colors.length ? config.colors : [0xffffff];\n    const chunks = config.chunks && typeof config.chunks === 'object' ? config.chunks : null;\n\n    for (let i = 0; i < count; i++) {\n      const angle = angleRange\n        ? (Number(angleRange[0]) + Math.random() * (Number(angleRange[1]) - Number(angleRange[0])))\n        : (Math.random() * Math.PI * 2);\n      const sp = speed * (0.5 + Math.random() * 0.9);\n      const g = new Graphics();\n      if (shape === 'circle') {\n        g.circle(0, 0, size * 0.6);\n      } else {\n        g.rect(-size / 2, -size / 2, size, size);\n      }\n      g.fill({ color: colors[i % colors.length], alpha: 1 });\n      g.x = x;\n      g.y = y;\n      layer.addChild(g);\n      particles.push({\n        g,\n        x,\n        y,\n        vx: Math.cos(angle) * sp,\n        vy: Math.sin(angle) * sp,\n        life: lifeMs,\n        maxLife: lifeMs,\n        gravity\n      });\n    }\n\n    if (chunks) {\n      const chunkCount = Math.max(0, Number(chunks.count) || 0);\n      const chunkSpeed = Math.max(0.3, Number(chunks.speed) || speed * 1.2);\n      const chunkLife = Math.max(160, Number(chunks.lifeMs) || lifeMs * 1.1);\n      const chunkSize = Math.max(size, Number(chunks.size) || size * 1.6);\n      const chunkGravity = Number.isFinite(Number(chunks.gravity)) ? Number(chunks.gravity) : gravity;\n      const chunkShape = chunks.shape === 'square' ? 'square' : 'circle';\n      const chunkAngle = Array.isArray(chunks.angleRange) && chunks.angleRange.length >= 2 ? chunks.angleRange : angleRange;\n      const chunkColors = Array.isArray(chunks.colors) && chunks.colors.length ? chunks.colors : colors;\n\n      for (let i = 0; i < chunkCount; i++) {\n        const angle = chunkAngle\n          ? (Number(chunkAngle[0]) + Math.random() * (Number(chunkAngle[1]) - Number(chunkAngle[0])))\n          : (Math.random() * Math.PI * 2);\n        const sp = chunkSpeed * (0.6 + Math.random() * 0.9);\n        const g = new Graphics();\n        if (chunkShape === 'circle') {\n          g.circle(0, 0, chunkSize * 0.6);\n        } else {\n          g.rect(-chunkSize / 2, -chunkSize / 2, chunkSize, chunkSize);\n        }\n        g.fill({ color: chunkColors[i % chunkColors.length], alpha: 1 });\n        g.x = x;\n        g.y = y;\n        layer.addChild(g);\n        particles.push({\n          g,\n          x,\n          y,\n          vx: Math.cos(angle) * sp,\n          vy: Math.sin(angle) * sp,\n          life: chunkLife,\n          maxLife: chunkLife,\n          gravity: chunkGravity\n        });\n      }\n    }\n  };\n\n  const update = (dt) => {\n    if (!particles.length) return;\n    const delta = Math.max(0, Number(dt) || 0);\n    for (let i = particles.length - 1; i >= 0; i--) {\n      const p = particles[i];\n      p.life -= delta;\n      if (p.life <= 0) {\n        if (p.g && p.g.parent) p.g.parent.removeChild(p.g);\n        particles.splice(i, 1);\n        continue;\n      }\n      p.x = (p.x || 0) + p.vx * (delta / 16.67);\n      p.y = (p.y || 0) + p.vy * (delta / 16.67);\n      p.vy += (Number(p.gravity) || 0.02) * (delta / 16.67);\n      if (p.g) {\n        p.g.x = p.x;\n        p.g.y = p.y;\n        p.g.alpha = Math.max(0, p.life / p.maxLife);\n      }\n    }\n  };\n\n  const clear = () => {\n    for (const p of particles) {\n      if (p.g && p.g.parent) p.g.parent.removeChild(p.g);\n    }\n    particles.length = 0;\n  };\n\n  return { add, update, clear };\n};\n\nexport default {\n  createBreakEffectLayer,\n  createBreakEffectManager\n};\n","// Generic liquid helpers (water, lava, etc.)\n// Liquids are defined as blocks with flags.liquid === true and optional flags.water/flags.lava\n// Optional physics params live under def.liquid: { buoyancy, drag:{x,y}, surface, swimmable, damagePerSecond }\n\nconst getDefById = (registryItems, id) => {\n  if (!id) return null;\n  const map = registryItems && registryItems.__byId;\n  if (map && typeof map.get === 'function') return map.get(id) || null;\n  return Array.isArray(registryItems) ? registryItems.find(r => r.id === id) : null;\n};\n\n/**\n * Sample registry tile definition at world pixel and return liquid info if present.\n * @param {number} wx world x in pixels\n * @param {number} wy world y in pixels\n * @param {number} mapWidthTiles\n * @param {number} mapHeightTiles\n * @param {number} TILE_SIZE\n * @param {Array<string|null>} tileData tile ids array (background layer)\n * @param {Array<object>} registryItems game registry array\n * @returns {null|{def:object, type:'water'|'lava'|'liquid', params:object}}\n */\nexport function getLiquidAtPixel(wx, wy, mapWidthTiles, mapHeightTiles, TILE_SIZE, tileData, registryItems) {\n  if (wy < 0) return null;\n  const gx = Math.floor(wx / TILE_SIZE);\n  const gy = Math.floor(wy / TILE_SIZE);\n  if (gx < 0 || gy < 0 || gx >= mapWidthTiles || gy >= mapHeightTiles) return null;\n  const idx = gy * mapWidthTiles + gx;\n  const id = tileData[idx];\n  if (!id) return null;\n  const def = getDefById(registryItems, id);\n  if (!def || !def.flags || !def.flags.liquid) return null;\n  const type = def.flags.lava_waterfall ? 'lava_waterfall' :\n               (def.flags.radioactive_waterfall ? 'radioactive_waterfall' :\n               (def.flags.waterfall ? 'waterfall' :\n               (def.flags.radioactive_water ? 'radioactive_water' :\n               (def.flags.quicksand ? 'quicksand' :\n               (def.flags.lava ? 'lava' :\n               (def.flags.water ? 'water' : 'liquid'))))));\n  const overlayColorRaw = def?.liquid?.overlay?.color ?? def?.liquid?.overlayColor ?? def?.tintBelowSurface;\n  const overlayAlphaRaw = def?.liquid?.overlay?.alpha ?? def?.liquid?.overlayAlpha;\n  const params = {\n    buoyancy: Number(def?.liquid?.buoyancy),\n    dragX: Number(def?.liquid?.drag?.x),\n    dragY: Number(def?.liquid?.drag?.y),\n    surface: !!def?.liquid?.surface,\n    swimmable: def?.flags?.swimmable === true || def?.liquid?.swimmable === true,\n    dps: Number(def?.liquid?.damagePerSecond),\n    overlay: {\n      color: Number(overlayColorRaw),\n      alpha: Number(overlayAlphaRaw)\n    },\n    // Optional resource models\n    oxygen: {\n      drainPerSecond: Number(def?.liquid?.oxygen?.drainPerSecond),\n      regenPerSecond: Number(def?.liquid?.oxygen?.regenPerSecond),\n      damagePerSecondWhenDepleted: Number(def?.liquid?.oxygen?.damagePerSecondWhenDepleted)\n    },\n    resistance: {\n      drainPerSecond: Number(def?.liquid?.resistance?.drainPerSecond),\n      regenPerSecond: Number(def?.liquid?.resistance?.regenPerSecond),\n      damagePerSecondWhenDepleted: Number(def?.liquid?.resistance?.damagePerSecondWhenDepleted)\n    },\n    resources: def?.liquid?.resources || {}\n  };\n  return { def, type, params };\n}\n\n/**\n * Convenience: returns whether any liquid exists at world pixel.\n */\nexport function isLiquidAtPixel(wx, wy, mapWidthTiles, mapHeightTiles, TILE_SIZE, tileData, registryItems) {\n  return !!getLiquidAtPixel(wx, wy, mapWidthTiles, mapHeightTiles, TILE_SIZE, tileData, registryItems);\n}\n\n/**\n * Compute liquid occupancy for a player AABB and derive head/feet status.\n * @returns { inLiquid:boolean, headUnder:boolean, atSurface:boolean, type:string|null, params:object }\n */\nexport function sampleLiquidForAABB({ x, y, width, height, TILE_SIZE, mapWidth, mapHeight, tileData, registryItems }) {\n  const cx = x + width * 0.5;\n  const headY = y + Math.min(4, height * 0.125);\n  const chestY = y + height * 0.45;\n  const feetY = y + height - 2;\n\n  const feet = getLiquidAtPixel(cx, feetY, mapWidth, mapHeight, TILE_SIZE, tileData, registryItems);\n  const chest = getLiquidAtPixel(cx, chestY, mapWidth, mapHeight, TILE_SIZE, tileData, registryItems);\n  const head = getLiquidAtPixel(cx, headY, mapWidth, mapHeight, TILE_SIZE, tileData, registryItems);\n\n  const candidate = feet || chest || head;\n  if (!candidate) {\n    return { inLiquid: false, headUnder: false, atSurface: false, type: null, params: null };\n  }\n  const type = candidate.type;\n  const defaultOverlay = (() => {\n    if (type.includes('lava')) return { color: 10914816, alpha: 0.25 };\n    if (type === 'quicksand') return { color: 10916187, alpha: 0.2 };\n    if (type === 'radioactive_water' || type === 'radioactive_waterfall') return { color: 1727514, alpha: 0.18 };\n    return { color: 1919093, alpha: 0.15 };\n  })();\n  const rawOverlayColor = candidate.params?.overlay?.color;\n  const rawOverlayAlpha = candidate.params?.overlay?.alpha;\n  // Merge params with sane defaults if missing\n  const p = {\n    buoyancy: Number.isFinite(candidate.params.buoyancy) ? candidate.params.buoyancy : 0.5,\n    dragX: Number.isFinite(candidate.params.dragX) ? candidate.params.dragX : 0.55,\n    dragY: Number.isFinite(candidate.params.dragY) ? candidate.params.dragY : 0.65,\n    surface: !!candidate.params.surface,\n    swimmable: !!candidate.params.swimmable,\n    dps: Number.isFinite(candidate.params.dps) ? Math.max(0, candidate.params.dps) : 0,\n    overlay: {\n      color: Number.isFinite(rawOverlayColor) ? rawOverlayColor : defaultOverlay.color,\n      alpha: Number.isFinite(rawOverlayAlpha) ? rawOverlayAlpha : defaultOverlay.alpha\n    },\n    oxygen: {\n      drainPerSecond: Number.isFinite(candidate.params?.oxygen?.drainPerSecond) ? Math.max(0, candidate.params.oxygen.drainPerSecond) : 20,\n      regenPerSecond: Number.isFinite(candidate.params?.oxygen?.regenPerSecond) ? Math.max(0, candidate.params.oxygen.regenPerSecond) : 35,\n      damagePerSecondWhenDepleted: Number.isFinite(candidate.params?.oxygen?.damagePerSecondWhenDepleted) ? Math.max(0, candidate.params.oxygen.damagePerSecondWhenDepleted) : 10\n    },\n    resistance: {\n      drainPerSecond: Number.isFinite(candidate.params?.resistance?.drainPerSecond) ? Math.max(0, candidate.params.resistance.drainPerSecond) : 25,\n      regenPerSecond: Number.isFinite(candidate.params?.resistance?.regenPerSecond) ? Math.max(0, candidate.params.resistance.regenPerSecond) : 40,\n      damagePerSecondWhenDepleted: Number.isFinite(candidate.params?.resistance?.damagePerSecondWhenDepleted) ? Math.max(0, candidate.params.resistance.damagePerSecondWhenDepleted) : 15\n    },\n    resources: candidate.params?.resources || {}\n  };\n  const inLiquid = !!(feet || chest);\n  const headUnder = !!head;\n  const atSurface = inLiquid && !headUnder;\n  return { inLiquid, headUnder, atSurface, type, params: p };\n}\n\n/**\n * Manage per-second liquid damage. Mutates gameState.current.health and hitTimer.\n * @param {{accRef: {current:number}, gameState: any, JUMP_FORCE?:number}} env\n * @param {number} deltaMs\n * @param {{ dps:number }} params\n */\nexport function tickLiquidDamage(env, deltaMs, params) {\n  const dps = Math.max(0, Number(params?.dps) || 0);\n  if (dps <= 0) { env.accRef.current = 0; return; }\n  env.accRef.current += Math.max(0, Number(deltaMs) || 0);\n  const TICK = 1000;\n  while (env.accRef.current >= TICK) {\n    env.accRef.current -= TICK;\n    const cur = Number(env.gameState.current.health) || 0;\n    env.gameState.current.health = Math.max(0, cur - dps);\n    const HIT_FLASH_MS = 500;\n    const prev = Number(env.gameState.current.hitTimerMs) || 0;\n    env.gameState.current.hitTimerMs = Math.max(prev, HIT_FLASH_MS);\n  }\n}\n\nexport default {\n  getLiquidAtPixel,\n  isLiquidAtPixel,\n  sampleLiquidForAABB,\n  tickLiquidDamage\n};\n","import React, { useEffect, useRef, useMemo, useCallback, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { Application, Container, Graphics, Assets, BlurFilter, ColorMatrixFilter, Texture, Sprite } from 'pixi.js';\nimport { TextureCache } from '../../../../Pixi/TextureCache';\nimport { Rain as WeatherRain, Snow as WeatherSnow, Clouds as WeatherClouds, Fog as WeatherFog, Thunder as WeatherThunder, LavaRain as WeatherLavaRain, RadioactiveFog as WeatherRadioactiveFog, MeteorRain as WeatherMeteorRain } from '../../../../Pixi/effects/weather';\nimport { WaterSplashFX, BubbleFX, LavaEmbers, LavaSteamFX, LiquidRegionSystem } from '../../../../Pixi/effects/liquids';\nimport HealthBar from '../../../../Pixi/ui/HealthBar';\nimport LAYERS from '../../../../renderer/stage/layers/LayerOrder';\nimport { clearTextureCache, createBackgroundResolver, createSolidChecker } from './helpers';\nimport { createWaterFrames, createLavaFrames } from './liquidRendering';\nimport { createParallaxManager } from './parallaxManager';\nimport { createPlayerContainer, updatePlayerSprite } from './playerManager';\nimport { syncProjectiles, cleanupProjectiles } from './projectileManager';\nimport { syncEntities, cleanupEntities } from './entityManager';\nimport { rebuildLayers } from './layerBuilder';\nimport { createFloatingTextLayer, createFloatingTextManager } from './floatingTextManager';\nimport { createBreakEffectLayer, createBreakEffectManager } from './breakEffectManager';\nimport { getLiquidAtPixel } from '../../../../engine/liquids/liquidUtils';\n\n// Suppress noisy Pixi Assets warnings for inlined data URLs (we load textures directly)\nAssets.setPreferences?.({\n  skipCacheIdWarning: true,\n  preferCreateImageBitmap: false, // Prevents WebGL warning: texImage: Alpha-premult and y-flip are deprecated\n});\n\nconst EMPTY_ARRAY = [];\nconst EMPTY_OBJECT = {};\nconst LIQUID_SURFACE_MAP = [\n  { key: 'lava', surface: 'lava' },\n  { key: 'radioactive', surface: 'radiation' },\n  { key: 'quicksand', surface: 'quicksand' },\n  { key: 'water', surface: 'water' },\n];\n\nconst toSurfaceType = (liquidType) => {\n  if (!liquidType) return null;\n  for (const entry of LIQUID_SURFACE_MAP) {\n    if (liquidType.includes(entry.key)) return entry.surface;\n  }\n  return null;\n};\n\nconst PixiStage = ({\n  mapWidth,\n  mapHeight,\n  tileSize = 32,\n  tileMapData = EMPTY_ARRAY,\n  objectMapData = EMPTY_ARRAY,\n  secretMapData = EMPTY_ARRAY,\n  revealedSecrets = EMPTY_ARRAY,\n  registryItems = EMPTY_ARRAY,\n  playerState,\n  playerVisuals,\n  backgroundImage,\n  backgroundColor,\n  backgroundParallaxFactor = 0.3,\n  cameraScrollX = 0,\n  weatherRain = 0,\n  weatherSnow = 0,\n  weatherClouds = 0,\n  weatherLavaRain = 0,\n  weatherRadioactiveFog = 0,\n  weatherMeteorRain = 0,\n  projectiles = EMPTY_ARRAY,\n  healthBarEnabled = true,\n  objectMetadata = EMPTY_OBJECT,\n  weatherFog = 0,\n  weatherThunder = 0,\n  oxygenBarEnabled = true,\n  lavaBarEnabled = true,\n  waterSplashesEnabled = true,\n  lavaEmbersEnabled = true,\n  isEditor = false,\n  isEditorPlayMode = false,\n  mapType = 'overworld',\n  activeRoomIds = EMPTY_ARRAY,\n  maps = EMPTY_OBJECT,\n  showGrid = false,\n  renderLayers = null, // null means all layers, otherwise an array of layer names to show\n  pointerEvents = 'auto',\n  onWeatherEffectHit = null,\n  roomBlurEnabled = true,\n  debugOverlayEnabled = false,\n}) => {\n  const [isPixiReady, setIsPixiReady] = useState(false);\n\n  const mountRef = useRef(null);\n  const appRef = useRef(null);\n  const parallaxRef = useRef(null);\n  const parallaxManagerRef = useRef(null);\n  const cameraScrollRef = useRef(0);\n  const parallaxFactorRef = useRef(Number(backgroundParallaxFactor) || 0.3);\n  const cameraPosRef = useRef({ x: 0, y: 0 });\n  const bgRef = useRef(null);\n  const bgAnimRef = useRef(null);\n  const bgImageRef = useRef(backgroundImage);\n  const bgColorRef = useRef(backgroundColor);\n  const objBehindRef = useRef(null);\n  const objFrontRef = useRef(null);\n  const roomBgRef = useRef(null);\n  const roomObjBehindRef = useRef(null);\n  const roomObjFrontRef = useRef(null);\n  const secretLayerRef = useRef(null);\n  const playerRef = useRef(null);\n  const playerLayerRef = useRef(null);\n  const playerSpriteRefs = useRef({ def: null, hit: null });\n  const playerHealthBarRef = useRef(null);\n  const playerStateRef = useRef(null);\n  const weatherLayerRef = useRef(null);\n  const liquidLayerRef = useRef(null);\n  const liquidBgLayerRef = useRef(null);\n  const liquidSystemRef = useRef(null);\n  const fogLayerRef = useRef(null);\n  const weatherSystemsRef = useRef({ rain: null, snow: null, clouds: null, thunder: null, fog: null, lavaRain: null, radioactiveFog: null, meteorRain: null });\n  const weatherPropsRef = useRef({ rain: 0, snow: 0, clouds: 0, fog: 0, thunder: 0, lavaRain: 0, radioactiveFog: 0, meteorRain: 0 });\n  const tileMapDataRef = useRef(tileMapData);\n  const registryItemsRef = useRef(registryItems);\n  const projectilesLayerRef = useRef(null);\n  const projectileSpritesRef = useRef(new Map());\n  const entitiesLayerRef = useRef(null);\n  const entitySpritesRef = useRef(new Map());\n  const projectilesPropRef = useRef(EMPTY_ARRAY);\n  const pixiTextureCacheRef = useRef(null);\n  const hbEnabledRef = useRef(healthBarEnabled !== false);\n  const oxyEnabledRef = useRef(oxygenBarEnabled !== false);\n  const lavaEnabledRef = useRef(lavaBarEnabled !== false);\n  const overlayLayerRef = useRef(null);\n  const underwaterRef = useRef({ g: null, time: 0, targetAlpha: 0, currentAlpha: 0 });\n  const waterFramesRef = useRef(null);\n  const lavaFramesRef = useRef(null);\n  const overlayHBRef = useRef(null);\n  const oxygenBarRef = useRef(null);\n  const lavaBarRef = useRef(null);\n  const waterFxRef = useRef(null);\n  const bubbleFxRef = useRef(null);\n  const fishBubbleStateRef = useRef(new Map());\n  const entityWaterStateRef = useRef(new Map());\n  const lavaEmbersRef = useRef(null);\n  const lavaSteamRef = useRef(null);\n  const splashesEnabledRef = useRef(waterSplashesEnabled !== false);\n  const embersEnabledRef = useRef(lavaEmbersEnabled !== false);\n  const waterStateRef = useRef({ inWater: false, headUnder: false, vy: 0 });\n  const gridRef = useRef(null);\n  const showGridRef = useRef(showGrid);\n  const roomBlurEnabledRef = useRef(roomBlurEnabled);\n  const blurFilterRef = useRef(new BlurFilter({ strength: 0 }));\n  const darkenFilterRef = useRef(new ColorMatrixFilter());\n  const roomBrightnessFilterRef = useRef(new ColorMatrixFilter());\n  const vignetteRef = useRef(null);\n  const floatingLayerRef = useRef(null);\n  const debugLayerRef = useRef(null);\n  const debugEnabledRef = useRef(!!debugOverlayEnabled);\n  const floatingManagerRef = useRef(null);\n  const breakFxLayerRef = useRef(null);\n  const breakFxManagerRef = useRef(null);\n\n  // Keep latest state in refs for ticker\n  useEffect(() => { playerStateRef.current = playerState; }, [playerState]);\n  useEffect(() => { showGridRef.current = showGrid; }, [showGrid]);\n  useEffect(() => { projectilesPropRef.current = Array.isArray(projectiles) ? projectiles : []; }, [projectiles]);\n  useEffect(() => { hbEnabledRef.current = healthBarEnabled !== false; }, [healthBarEnabled]);\n  useEffect(() => { oxyEnabledRef.current = oxygenBarEnabled !== false; }, [oxygenBarEnabled]);\n  useEffect(() => { lavaEnabledRef.current = lavaBarEnabled !== false; }, [lavaBarEnabled]);\n  useEffect(() => { splashesEnabledRef.current = waterSplashesEnabled !== false; }, [waterSplashesEnabled]);\n  useEffect(() => { embersEnabledRef.current = lavaEmbersEnabled !== false; }, [lavaEmbersEnabled]);\n  useEffect(() => { roomBlurEnabledRef.current = roomBlurEnabled; }, [roomBlurEnabled]);\n  useEffect(() => { debugEnabledRef.current = !!debugOverlayEnabled; }, [debugOverlayEnabled]);\n  useEffect(() => { cameraScrollRef.current = Number(cameraScrollX) || 0; }, [cameraScrollX]);\n  useEffect(() => { parallaxFactorRef.current = Number(backgroundParallaxFactor) || 0.3; }, [backgroundParallaxFactor]);\n  useEffect(() => { bgImageRef.current = backgroundImage; }, [backgroundImage]);\n  useEffect(() => { bgColorRef.current = backgroundColor; }, [backgroundColor]);\n  useEffect(() => { tileMapDataRef.current = tileMapData; }, [tileMapData]);\n  useEffect(() => { registryItemsRef.current = registryItems; }, [registryItems]);\n\n  // Sync weather props to ref for systems to read live\n  useEffect(() => {\n    weatherPropsRef.current = {\n      rain: Number(weatherRain) || 0,\n      snow: Number(weatherSnow) || 0,\n      clouds: Number(weatherClouds) || 0,\n      fog: Number(weatherFog) || 0,\n      thunder: Number(weatherThunder) || 0,\n      lavaRain: Number(weatherLavaRain) || 0,\n      radioactiveFog: Number(weatherRadioactiveFog) || 0,\n      meteorRain: Number(weatherMeteorRain) || 0,\n    };\n  }, [weatherRain, weatherSnow, weatherClouds, weatherFog, weatherThunder, weatherLavaRain, weatherRadioactiveFog, weatherMeteorRain]);\n\n  // Background resolver and solid checker (memoized per map)\n  const resolveBackgroundUrl = useMemo(() => createBackgroundResolver(), []);\n  const isSolidAt = useMemo(() => createSolidChecker(mapWidth, mapHeight, tileSize, tileMapData, registryItems), [mapWidth, mapHeight, tileSize, tileMapData, registryItems]);\n\n  // Rebuild parallax helper\n  const rebuildParallax = useCallback(() => {\n    const layer = parallaxRef.current;\n    if (!layer) return;\n    if (!pixiTextureCacheRef.current) pixiTextureCacheRef.current = new TextureCache();\n    if (!parallaxManagerRef.current) {\n      parallaxManagerRef.current = createParallaxManager(layer, pixiTextureCacheRef.current);\n    }\n    \n    const bgUrl = bgImageRef.current;\n    const bgColor = bgColorRef.current;\n    const factor = parallaxFactorRef.current || 0.3;\n\n    parallaxManagerRef.current.build({\n      worldWidth: mapWidth * tileSize,\n      worldHeight: mapHeight * tileSize,\n      url: bgUrl,\n      color: bgColor,\n      factor,\n      resolveBackgroundUrl,\n      minWidth: appRef.current?.screen?.width || 0,\n      minHeight: appRef.current?.screen?.height || 0\n    });\n  }, [mapWidth, mapHeight, tileSize, resolveBackgroundUrl]);\n\n  // Initialize Application\n  useEffect(() => {\n    let destroyed = false;\n\n    const init = async () => {\n      if (appRef.current) return;\n\n      const app = new Application();\n      try {\n        await app.init({\n          resizeTo: mountRef.current,\n          backgroundAlpha: 0,\n          antialias: false,\n          autoDensity: true,\n        });\n\n        // Enable z-index sorting for the main stage\n        app.stage.sortableChildren = true;\n\n        if (destroyed) {\n          app.destroy(true, { children: true, texture: true });\n          return;\n        }\n\n        if (!app.renderer) return;\n\n        appRef.current = app;\n        app.stage.sortableChildren = true;\n\n        // Create layers\n      const bg = new Container();\n      const bgAnim = new Container();\n      const objBehind = new Container();\n      const objFront = new Container();\n      const roomBg = new Container();\n      const roomObjBehind = new Container();\n      const roomObjFront = new Container();\n      const secretBelowLayer = new Container();\n      const secretAboveLayer = new Container();\n      const playerLayer = new Container();\n      const entitiesLayer = new Container();\n      const weatherLayer = new Container();\n      const liquidBgLayer = new Container();\n      const liquidLayer = new Container();\n      const liquidFxLayer = new Container();\n      const fogLayer = new Container();\n      const projLayer = new Container();\n      const vignetteLayer = new Container();\n      const overlayLayer = new Container();\n      const floatingLayer = createFloatingTextLayer();\n      const breakFxLayer = createBreakEffectLayer();\n\n      // Assign zIndex\n      const parallaxLayer = new Container();\n      parallaxLayer.zIndex = LAYERS.parallax;\n      bg.zIndex = LAYERS.tiles;\n      bgAnim.zIndex = LAYERS.tilesAnim;\n      roomBg.zIndex = LAYERS.tiles + 1;\n      objBehind.zIndex = LAYERS.objBehind;\n      roomObjBehind.zIndex = LAYERS.objBehind + 1;\n      objFront.zIndex = LAYERS.objFront;\n      roomObjFront.zIndex = LAYERS.objFront + 1;\n      secretBelowLayer.zIndex = LAYERS.secretsBelow;\n      secretAboveLayer.zIndex = LAYERS.secretsAbove;\n      playerLayer.zIndex = LAYERS.player;\n      entitiesLayer.zIndex = LAYERS.player;\n      weatherLayer.zIndex = LAYERS.weather;\n      fogLayer.zIndex = LAYERS.fog;\n      liquidBgLayer.zIndex = LAYERS.liquidBackground;\n      liquidLayer.zIndex = LAYERS.liquids;\n      liquidFxLayer.zIndex = LAYERS.liquidFx;\n      projLayer.zIndex = LAYERS.projectiles;\n      vignetteLayer.zIndex = LAYERS.overlay - 1;\n      overlayLayer.zIndex = LAYERS.overlay;\n      floatingLayer.zIndex = LAYERS.overlay + 1;\n      breakFxLayer.zIndex = LAYERS.overlay + 2;\n\n      bgRef.current = bg;\n      bgAnimRef.current = bgAnim;\n      objBehindRef.current = objBehind;\n      objFrontRef.current = objFront;\n      roomBgRef.current = roomBg;\n      roomObjBehindRef.current = roomObjBehind;\n      roomObjFrontRef.current = roomObjFront;\n      secretLayerRef.current = { below: secretBelowLayer, above: secretAboveLayer };\n      weatherLayerRef.current = weatherLayer;\n      playerLayerRef.current = playerLayer;\n      liquidBgLayerRef.current = liquidBgLayer;\n      liquidLayerRef.current = liquidLayer;\n      fogLayerRef.current = fogLayer;\n      projectilesLayerRef.current = projLayer;\n      entitiesLayerRef.current = entitiesLayer;\n      vignetteRef.current = vignetteLayer;\n      overlayLayerRef.current = overlayLayer;\n      floatingLayerRef.current = floatingLayer;\n      floatingManagerRef.current = createFloatingTextManager(floatingLayer);\n      breakFxLayerRef.current = breakFxLayer;\n      breakFxManagerRef.current = createBreakEffectManager(breakFxLayer);\n    \n      const gridGraphics = new Graphics();\n      gridRef.current = gridGraphics;\n      overlayLayer.addChild(gridGraphics);\n      overlayLayer.addChild(breakFxLayer);\n\n      const debugGraphics = new Graphics();\n      debugLayerRef.current = debugGraphics;\n      overlayLayer.addChild(debugGraphics);\n      parallaxRef.current = parallaxLayer;\n\n      // Add all layers to stage\n      const allLayersMap = {\n        background: [bg, bgAnim],\n        parallax: [parallaxLayer],\n        tiles: [bg, bgAnim], // Aliased for convenience\n        objects: [objBehind, objFront, secretBelowLayer, secretAboveLayer, entitiesLayer, projLayer],\n        player: [playerLayer],\n        weather: [weatherLayer, fogLayer],\n        liquids: [liquidBgLayer, liquidLayer, liquidFxLayer],\n        overlay: [overlayLayer]\n      };\n\n      if (renderLayers) {\n        renderLayers.forEach(layerName => {\n          const layers = allLayersMap[layerName];\n          if (layers) layers.forEach(l => {\n            if (!app.stage.children.includes(l)) app.stage.addChild(l);\n          });\n        });\n      } else {\n        // Add layers in z-order priority (back to front) for stability\n        app.stage.addChild(\n          parallaxLayer,\n          bg, bgAnim, \n          roomBg,\n          liquidBgLayer, \n          objBehind, \n          roomObjBehind,\n          secretBelowLayer, \n          playerLayer, \n          entitiesLayer, \n          projLayer, \n          objFront, \n          roomObjFront,\n          secretAboveLayer, \n          weatherLayer, \n          fogLayer, \n          liquidLayer, \n          liquidFxLayer,\n          vignetteLayer,\n          overlayLayer,\n          floatingLayer\n        );\n      }\n\n      // Preload textures to avoid Assets cache warnings and ensure textures are ready\n      try {\n        const urlSet = new Set();\n        const addUrl = (u) => { if (typeof u === 'string' && u.length) urlSet.add(u); };\n        registryItems.forEach((def) => {\n          addUrl(def?.texture);\n          if (Array.isArray(def?.textures)) def.textures.forEach(addUrl);\n        });\n        if (playerVisuals) {\n          addUrl(playerVisuals.texture);\n          if (Array.isArray(playerVisuals.textures)) playerVisuals.textures.forEach(addUrl);\n        }\n        const bgUrl = resolveBackgroundUrl(bgImageRef.current);\n        if (bgUrl) addUrl(bgUrl);\n        const urls = Array.from(urlSet);\n        if (urls.length) {\n          console.log('[PixiStage] Preloading', urls.length, 'textures...');\n          await Assets.load(urls);\n          console.log('[PixiStage] Textures preloaded successfully');\n        }\n      } catch (e) {\n        console.warn('Pixi Assets preload encountered an issue (continuing):', e);\n      }\n\n      // Create player\n      const playerComponents = createPlayerContainer(playerVisuals, registryItems, playerState, tileSize);\n      playerLayer.addChild(playerComponents.container);\n      playerRef.current = playerComponents.container;\n      playerSpriteRefs.current = playerComponents.sprites;\n      playerHealthBarRef.current = playerComponents.healthBar;\n\n      // Mount canvas - DROA PIEVIENOANA\n      if (mountRef.current && app.renderer && app.canvas) {\n        mountRef.current.innerHTML = '';\n        mountRef.current.appendChild(app.canvas);\n      }\n\n      // Build underwater overlay\n      const g = new Graphics();\n      overlayLayer.addChild(g);\n      underwaterRef.current.g = g;\n      const W = mapWidth * tileSize;\n      const H = mapHeight * tileSize;\n      g.clear();\n      g.rect(0, 0, W, H);\n      g.fill({ color: 0x1d4875, alpha: 1 });\n      g.alpha = 0;\n      g.visible = false;\n\n      // Build overlay bars\n      const hbOverlay = new HealthBar({ width: (playerState?.width) || tileSize, height: 4, offsetX: 0, offsetY: 0 });\n      hbOverlay.visible = false;\n      overlayLayer.addChild(hbOverlay);\n      overlayHBRef.current = hbOverlay;\n\n      const oxyColors = { ok: 0x2ecdf1, warn: 0x3498db, danger: 0x1f6fb2 };\n      const oxyBar = new HealthBar({ width: (playerState?.width) || tileSize, height: 4, offsetX: 0, offsetY: 0, colors: oxyColors });\n      oxyBar.visible = false;\n      overlayLayer.addChild(oxyBar);\n      oxygenBarRef.current = oxyBar;\n\n      const lavaColors = { ok: 0xffcc00, warn: 0xffaa00, danger: 0xff8800 };\n      const lvBar = new HealthBar({ width: (playerState?.width) || tileSize, height: 4, offsetX: 0, offsetY: 0, colors: lavaColors });\n      lvBar.visible = false;\n      overlayLayer.addChild(lvBar);\n      lavaBarRef.current = lvBar;\n\n      // WebGL context loss/restore handlers\n      if (app.canvas && app.renderer) {\n        app.canvas.addEventListener('webglcontextlost', (e) => {\n          e.preventDefault();\n          console.warn('WebGL context lost');\n        });\n        app.canvas.addEventListener('webglcontextrestored', () => {\n          console.info('WebGL context restored');\n          // No need to manually rebuild here as the main useEffect will catch app state or we can just trigger a state change if needed.\n          // But Pixi v8 often recovers automatically. To be safe, we can force a rebuild by just waiting for next tick.\n        });\n      }\n\n      // Initialize liquid system\n      try {\n        if (liquidSystemRef.current) liquidSystemRef.current.destroy();\n        if (liquidLayerRef.current) {\n          liquidSystemRef.current = new LiquidRegionSystem(liquidLayerRef.current, { \n            mapWidth, \n            mapHeight, \n            tileSize,\n            bgContainer: liquidBgLayerRef.current\n          });\n        }\n      } catch (e) { console.warn('LiquidRegionSystem init failed:', e); }\n\n      // FX systems\n      try { waterFxRef.current = new WaterSplashFX(liquidFxLayer); } catch {}\n      try { bubbleFxRef.current = new BubbleFX(liquidFxLayer); } catch {}\n      try { lavaSteamRef.current = new LavaSteamFX(liquidFxLayer); } catch {}\n      try {\n        lavaEmbersRef.current = new LavaEmbers(liquidLayerRef.current, { mapWidth, mapHeight, tileSize }, () => (embersEnabledRef.current ? 100 : 0));\n      } catch {}\n\n      rebuildParallax();\n\n      // Finalize initialization by setting appRef\n      // This will trigger the second useEffect to build layers and player\n      appRef.current = app;\n      setIsPixiReady(true);\n      app.ticker.add(() => {\n        if (gridRef.current) {\n          gridRef.current.clear();\n          if (showGridRef.current) {\n            for (let x = 0; x <= mapWidth; x++) {\n              gridRef.current.moveTo(x * tileSize, 0);\n              gridRef.current.lineTo(x * tileSize, mapHeight * tileSize);\n            }\n            for (let y = 0; y <= mapHeight; y++) {\n              gridRef.current.moveTo(0, y * tileSize);\n              gridRef.current.lineTo(mapWidth * tileSize, y * tileSize);\n            }\n            gridRef.current.stroke({ width: 0.5, color: 0xffffff, alpha: 0.2 });\n          }\n        }\n\n        const s = playerStateRef.current;\n        if (s && playerRef.current) {\n          updatePlayerSprite(\n            { container: playerRef.current, sprites: playerSpriteRefs.current, healthBar: playerHealthBarRef.current },\n            s,\n            tileSize,\n            hbEnabledRef.current\n          );\n        }\n\n        // Camera Follow\n        const sw = app.screen.width;\n        const sh = app.screen.height;\n        const worldW = mapWidth * tileSize;\n        const worldH = mapHeight * tileSize;\n\n        if (s) {\n          const targetX = (s.x || 0) + (s.width || tileSize) / 2;\n          const targetY = (s.y || 0) + (s.height || tileSize) / 2;\n\n          let camX = targetX - sw / 2;\n          let camY = targetY - sh / 2;\n\n          // Constraints with centering for small maps\n          if (worldW < sw) {\n            camX = (worldW - sw) / 2;\n          } else {\n            camX = Math.max(0, Math.min(camX, worldW - sw));\n          }\n\n          if (worldH < sh) {\n            camY = (worldH - sh) / 2;\n          } else {\n            camY = Math.max(0, Math.min(camY, worldH - sh));\n          }\n\n          // Use a small dead-zone/smooth follow to prevent 1px jitter from sub-pixel player movement\n          const lastCam = cameraPosRef.current || { x: camX, y: camY, rawX: camX, rawY: camY };\n          const smoothing = 0.2; // Lerp factor (0 to 1, higher is faster)\n          const rawX = lastCam.rawX !== undefined ? lastCam.rawX : camX;\n          const rawY = lastCam.rawY !== undefined ? lastCam.rawY : camY;\n          \n          const nextRawX = rawX + (camX - rawX) * smoothing;\n          const nextRawY = rawY + (camY - rawY) * smoothing;\n\n          cameraPosRef.current = { \n            x: Math.round(nextRawX), \n            y: Math.round(nextRawY),\n            rawX: nextRawX,\n            rawY: nextRawY\n          };\n          \n          app.stage.pivot.set(Math.round(nextRawX), Math.round(nextRawY));\n          \n          window.__PLAYER_POS__ = { x: s.x, y: s.y };\n\n          if (parallaxRef.current) {\n            parallaxRef.current.position.set(nextRawX, nextRawY);\n          }\n\n          if (vignetteRef.current && vignetteRef.current.visible) {\n            vignetteRef.current.position.set(nextRawX, nextRawY);\n          }\n\n          const f = parallaxFactorRef.current;\n          if (parallaxManagerRef.current) {\n            parallaxManagerRef.current.resize(worldW, worldH, sw, sh);\n            parallaxManagerRef.current.setScroll(nextRawX, f);\n          }\n        }\n\n        // Weather\n        const dt = app.ticker?.deltaMS || 16.67;\n        const systems = weatherSystemsRef.current;\n        const swNow = app.screen.width;\n        const shNow = app.screen.height;\n\n        if (systems.rain) {\n          if (systems.rain.resize) systems.rain.resize(swNow, shNow);\n          systems.rain.update(dt);\n        }\n        if (systems.lavaRain) {\n          if (systems.lavaRain.resize) systems.lavaRain.resize(swNow, shNow);\n          systems.lavaRain.update(dt);\n        }\n        if (systems.snow) {\n          if (systems.snow.resize) systems.snow.resize(swNow, shNow);\n          systems.snow.update(dt);\n        }\n        if (systems.meteorRain) {\n          if (systems.meteorRain.resize) systems.meteorRain.resize(swNow, shNow);\n          systems.meteorRain.update(dt);\n        }\n        if (systems.clouds) {\n          if (systems.clouds.resize) systems.clouds.resize(swNow, shNow);\n          systems.clouds.update(dt);\n        }\n        if (systems.fog) {\n          if (systems.fog.resize) systems.fog.resize(swNow, shNow);\n          systems.fog.update(dt);\n        }\n        if (systems.radioactiveFog) {\n          if (systems.radioactiveFog.resize) systems.radioactiveFog.resize(swNow, shNow);\n          systems.radioactiveFog.update(dt);\n        }\n        if (systems.thunder) {\n          if (systems.thunder.resize) systems.thunder.resize(swNow, shNow);\n          systems.thunder.update(dt);\n        }\n\n        // Liquids\n        try {\n          if (liquidSystemRef.current && s) {\n            liquidSystemRef.current.setPlayerState(s);\n          }\n          liquidSystemRef.current?.update(dt);\n        } catch {}\n\n        // FX\n        try { lavaEmbersRef.current?.update(dt); } catch {}\n        try { waterFxRef.current?.update(dt); } catch {}\n        try { bubbleFxRef.current?.update(dt); } catch {}\n        try { lavaSteamRef.current?.update(dt); } catch {}\n\n        // Underwater/lava overlay with smooth fade-in/out\n        try {\n          const u = underwaterRef.current;\n          const sNow = playerStateRef.current || {};\n\n          // Safety check: ensure graphics object exists and is attached\n          if (u && (!u.g || u.g.destroyed)) {\n            const overlayL = overlayLayerRef.current;\n            if (overlayL) {\n              const g = new Graphics();\n              overlayL.addChild(g);\n              u.g = g;\n              u.currentAlpha = 0;\n              u.targetAlpha = 0;\n              u.time = 0;\n            }\n          }\n\n          if (u && u.g) {\n            // Check if player's head is in water/lava for full overlay\n            // If only body is in liquid, use a much subtler effect or none\n            const liquidType = sNow.liquidType;\n            const headUnder = !!(sNow && sNow.headUnderWater);\n            const inLiquid = !!(sNow && sNow.inWater);\n            \n            const overlayCfg = sNow.liquidOverlay || null;\n            const showOverlay = headUnder && !!overlayCfg;\n\n            let overlayColor = 0x1d4875;\n            let maxTargetAlpha = 0.15;\n\n            if (overlayCfg) {\n              if (Number.isFinite(overlayCfg.color)) overlayColor = overlayCfg.color;\n              if (Number.isFinite(overlayCfg.alpha)) maxTargetAlpha = overlayCfg.alpha;\n            }\n\n            if (showOverlay) {\n              u.time += dt;\n              // Target alpha with pulse effect\n              const pulseBase = (maxTargetAlpha * 0.8) + (maxTargetAlpha * 0.2) * Math.sin(u.time * 0.0025);\n              u.targetAlpha = pulseBase;\n\n              // Smooth fade-in: gradually approach target alpha\n              const fadeSpeed = 0.01; // Faster fade-in for immediate visibility\n              const alphaDiff = u.targetAlpha - u.currentAlpha;\n              u.currentAlpha += alphaDiff * Math.min(1, dt * fadeSpeed);\n\n              // Update color if liquid type changed (only when needed to avoid constant redraw)\n              if (!u.g.visible || u.lastLiquidType !== liquidType) {\n                u.g.clear();\n                u.g.rect(0, 0, mapWidth * tileSize, mapHeight * tileSize);\n                u.g.fill({ color: overlayColor, alpha: 1 });\n                u.lastLiquidType = liquidType;\n              }\n\n              u.g.visible = true;\n              u.g.alpha = u.currentAlpha;\n            } else {\n              // Smooth fade-out\n              u.targetAlpha = 0;\n              const fadeOutSpeed = 0.008; // Faster fade-out\n              const alphaDiff = u.targetAlpha - u.currentAlpha;\n              u.currentAlpha += alphaDiff * Math.min(1, dt * fadeOutSpeed);\n              u.g.alpha = u.currentAlpha;\n\n              if (u.currentAlpha < 0.01) {\n                u.currentAlpha = 0;\n                u.g.alpha = 0;\n                u.g.visible = false;\n                u.time = 0; // Reset time for next submersion\n              }\n            }\n          }\n\n          // Water splash detection\n          try {\n            const prev = waterStateRef.current || { inWater: false, headUnder: false, vy: 0 };\n            const nowInWater = !!sNow.inWater;\n            const nowLiquid = sNow.liquidType;\n            const centerX = (sNow.x || 0) + (sNow.width || tileSize) * 0.5;\n\n            if (splashesEnabledRef.current && nowLiquid === 'water' && nowInWater && !prev.inWater) {\n              const sy = liquidSystemRef.current?.getSurfaceY?.('water', centerX);\n              const vy = Number(sNow.vy) || 0;\n              const strength = Math.min(3, Math.max(0.2, Math.abs(vy) * 0.12));\n              waterFxRef.current?.trigger({ x: centerX, y: (Number.isFinite(sy) ? sy : (sNow.y || 0)), strength, upward: false });\n              try { liquidSystemRef.current?.addWave?.('water', centerX, Math.min(2.5, 0.6 + Math.abs(vy) * 0.08)); } catch {}\n            }\n            if (splashesEnabledRef.current && prev.inWater && !nowInWater) {\n              const sy = liquidSystemRef.current?.getSurfaceY?.('water', centerX);\n              const vy = Number(sNow.vy) || 0;\n              const strength = Math.min(3, Math.max(0.2, Math.abs(vy) * 0.08));\n              waterFxRef.current?.trigger({ x: centerX, y: (Number.isFinite(sy) ? sy : (sNow.y || 0)), strength, upward: true });\n              try { liquidSystemRef.current?.addWave?.('water', centerX, Math.min(2.0, 0.4 + Math.abs(vy) * 0.05)); } catch {}\n            }\n            waterStateRef.current = { inWater: nowInWater, headUnder: !!sNow.headUnderWater, vy: Number(sNow.vy) || 0 };\n          } catch {}\n        } catch {}\n\n        // Overlay bars\n        try {\n          const s2 = playerStateRef.current || {};\n          const effW = (s2.width || tileSize);\n          const effH = (s2.height || tileSize);\n          const baseYOffset = Math.max(4, Math.floor(effH * 0.12));\n          const baseX = (s2.x || 0);\n          const baseY = (s2.y || 0) - baseYOffset;\n\n          const hbO = overlayHBRef.current;\n          if (hbO) {\n            const enabled = hbEnabledRef.current !== false;\n            const show = enabled && (!!s2.inWater || s2.liquidType === 'lava');\n            hbO.visible = !!show;\n            if (show) {\n              hbO.x = baseX;\n              hbO.y = baseY;\n              hbO.resize(effW, 4);\n              hbO.update(s2.health, (Number(s2.maxHealth) || 100));\n            }\n          }\n\n          let nextBarY = baseY;\n          if (hbO && hbO.visible) nextBarY += 6;\n\n          const oxyBar = oxygenBarRef.current;\n          if (oxyBar) {\n            const enabled = oxyEnabledRef.current !== false;\n            const maxOxy = Math.max(1, Number(s2.maxOxygen) || 100);\n            const curOxy = Math.max(0, Number(s2.oxygen));\n            const show = enabled && ((s2.liquidType === 'water' || s2.inWater) || (curOxy < maxOxy));\n            oxyBar.visible = !!show;\n            if (show) {\n              oxyBar.x = baseX;\n              oxyBar.y = nextBarY;\n              oxyBar.resize(effW, 4);\n              oxyBar.update((Number.isFinite(curOxy) ? curOxy : maxOxy), maxOxy);\n              nextBarY += 6;\n            }\n          }\n\n          const lvBar = lavaBarRef.current;\n          if (lvBar) {\n            const enabled = lavaEnabledRef.current !== false;\n            const maxLv = Math.max(1, Number(s2.maxLavaResist) || 100);\n            const curLv = Math.max(0, Number(s2.lavaResist));\n            const show = enabled && (s2.liquidType === 'lava' || (curLv < maxLv));\n            lvBar.visible = !!show;\n            if (show) {\n              lvBar.x = baseX;\n              lvBar.y = nextBarY;\n              lvBar.resize(effW, 4);\n              lvBar.update((Number.isFinite(curLv) ? curLv : maxLv), maxLv);\n            }\n          }\n        } catch {}\n\n        // Projectiles\n        syncProjectiles(projectilesLayerRef.current, projectileSpritesRef.current, projectilesPropRef.current, registryItems, tileSize);\n\n        // Entities\n        const sNow = playerStateRef.current || {};\n        syncEntities(entitiesLayerRef.current, entitySpritesRef.current, sNow.entities, registryItems, tileSize);\n\n        try {\n          const ents = sNow.entities || [];\n          const tileData = tileMapDataRef.current;\n          const regs = registryItemsRef.current;\n          const seen = new Set();\n\n          for (const ent of ents) {\n            if (!ent) continue;\n            const id = ent.id;\n            seen.add(id);\n            const def = ent.def || {};\n            const cx = (ent.x || 0) + (ent.width || tileSize) * 0.5;\n            const cy = (ent.y || 0) + (ent.height || tileSize) * 0.5;\n            const liq = (tileData && regs)\n              ? getLiquidAtPixel(cx, cy, mapWidth, mapHeight, tileSize, tileData, regs)\n              : null;\n            const inWater = !!(liq && (liq.type === 'water' || liq.type === 'waterfall'));\n\n            const prev = entityWaterStateRef.current.get(id) || { inWater: false };\n            if (inWater && !prev.inWater && waterFxRef.current && liquidSystemRef.current) {\n              const sy = liquidSystemRef.current?.getSurfaceY?.('water', cx);\n              const strength = Math.min(2, Math.max(0.3, Math.abs(ent.vy || 0) * 0.08 + 0.4));\n              if (Number.isFinite(sy)) {\n                waterFxRef.current?.trigger({ x: cx, y: sy, strength, upward: false });\n                try { liquidSystemRef.current?.addWave?.('water', cx, Math.min(2.2, strength)); } catch {}\n              }\n            }\n            entityWaterStateRef.current.set(id, { inWater });\n\n            const isFish = def.subtype === 'fish' || def.ai?.type === 'fish' || def.fish;\n            const isAlive = Number(ent.health) > 0;\n            if (isFish && isAlive && !ent.isDormant && inWater && bubbleFxRef.current) {\n              const cfg = def.fish || {};\n              const interval = Math.max(200, Number(cfg.bubbleIntervalMs) || 900);\n              const jitter = Math.max(0, Number(cfg.bubbleJitter) || 0.4);\n              const state = fishBubbleStateRef.current.get(id) || { t: 0 };\n              state.t += dt;\n              if (state.t >= interval) {\n                state.t = 0;\n                const bx = cx + (Math.random() - 0.5) * tileSize * jitter;\n                const by = cy + (Math.random() - 0.5) * tileSize * jitter;\n                bubbleFxRef.current.trigger({\n                  x: bx,\n                  y: by,\n                  size: 2,\n                  rise: 0.025 + Math.random() * 0.02,\n                  life: 1000 + Math.random() * 400,\n                  drift: 0.015 + Math.random() * 0.02\n                });\n              }\n              fishBubbleStateRef.current.set(id, state);\n            } else if (isFish) {\n              fishBubbleStateRef.current.delete(id);\n            }\n          }\n\n          for (const key of fishBubbleStateRef.current.keys()) {\n            if (!seen.has(key)) fishBubbleStateRef.current.delete(key);\n          }\n          for (const key of entityWaterStateRef.current.keys()) {\n            if (!seen.has(key)) entityWaterStateRef.current.delete(key);\n          }\n        } catch {}\n\n        // Floating texts\n        floatingManagerRef.current?.update(dt);\n        // Break FX\n        breakFxManagerRef.current?.update(dt);\n      });\n    } catch (error) {\n      console.error('PixiStage init failed:', error);\n    }\n  };\n\n  init();\n\n  return () => {\n    destroyed = true;\n    if (appRef.current) {\n      const appToDestroy = appRef.current;\n      appRef.current = null;\n      appToDestroy.destroy(true, { children: true, texture: true });\n    }\n    try { liquidSystemRef.current?.destroy(); } catch {}\n    try { waterFxRef.current?.destroy(); } catch {}\n    try { bubbleFxRef.current?.destroy(); } catch {}\n    try { lavaEmbersRef.current?.destroy(); } catch {}\n    try { lavaSteamRef.current?.destroy(); } catch {}\n    try { parallaxManagerRef.current?.destroy(); } catch {}\n    parallaxManagerRef.current = null;\n    try { pixiTextureCacheRef.current?.clear?.(); } catch {}\n    try {\n      weatherSystemsRef.current.rain?.destroy();\n      weatherSystemsRef.current.snow?.destroy();\n      weatherSystemsRef.current.fog?.destroy();\n    } catch {}\n    cleanupProjectiles(projectileSpritesRef.current);\n    cleanupEntities(entitySpritesRef.current);\n    clearTextureCache();\n  };\n  }, []);\n\n  useEffect(() => {\n    const handler = (e) => {\n      const detail = e?.detail || {};\n      floatingManagerRef.current?.add(detail);\n    };\n    window.addEventListener('game-floating-text', handler);\n    return () => window.removeEventListener('game-floating-text', handler);\n  }, []);\n\n  useEffect(() => {\n    const handler = (e) => {\n      const detail = e?.detail || {};\n      if (Number.isFinite(detail.x) && Number.isFinite(detail.y) && detail.config) {\n        breakFxManagerRef.current?.add(detail);\n      }\n    };\n    window.addEventListener('game-break-effect', handler);\n    return () => window.removeEventListener('game-break-effect', handler);\n  }, []);\n\n  useEffect(() => {\n    const isInsideRoom = activeRoomIds && activeRoomIds.length > 0;\n    const targetBlur = (isInsideRoom && roomBlurEnabled) ? 4 : 0;\n    const roomBrightness = isInsideRoom ? 1.25 : 1.0; // Slightly brighter interior\n    \n    if (blurFilterRef.current) {\n      blurFilterRef.current.strength = targetBlur;\n    }\n\n    if (darkenFilterRef.current) {\n      darkenFilterRef.current.reset();\n      if (isInsideRoom) {\n        // Desaturate and darken background when inside\n        darkenFilterRef.current.desaturate();\n        darkenFilterRef.current.brightness(0.75, true);\n      }\n    }\n\n    if (roomBrightnessFilterRef.current) {\n      roomBrightnessFilterRef.current.reset();\n      roomBrightnessFilterRef.current.brightness(roomBrightness, false);\n    }\n\n    if (vignetteRef.current) {\n      vignetteRef.current.visible = isInsideRoom;\n      if (isInsideRoom && !vignetteRef.current.children.length) {\n        const sw = appRef.current?.screen?.width || 800;\n        const sh = appRef.current?.screen?.height || 600;\n        \n        // Create programmatic vignette texture using canvas\n        const canvas = document.createElement('canvas');\n        canvas.width = 512;\n        canvas.height = 512;\n        const ctx = canvas.getContext('2d');\n        const grad = ctx.createRadialGradient(256, 256, 100, 256, 256, 360);\n        grad.addColorStop(0, 'rgba(0,0,0,0)');\n        grad.addColorStop(1, 'rgba(0,0,0,0.6)');\n        ctx.fillStyle = grad;\n        ctx.fillRect(0, 0, 512, 512);\n        \n        const tex = Texture.from(canvas);\n        const sprite = new Sprite(tex);\n        sprite.width = sw;\n        sprite.height = sh;\n        vignetteRef.current.addChild(sprite);\n        \n        // Also update sprite size on resize\n        vignetteRef.current._vignetteSprite = sprite;\n      }\n      \n      // Sync vignette position to camera (it should be screen-space)\n      if (isInsideRoom && vignetteRef.current._vignetteSprite) {\n        vignetteRef.current.x = cameraPosRef.current.x;\n        vignetteRef.current.y = cameraPosRef.current.y;\n        vignetteRef.current._vignetteSprite.width = appRef.current?.screen?.width || 800;\n        vignetteRef.current._vignetteSprite.height = appRef.current?.screen?.height || 600;\n      }\n    }\n\n    const layersToBlur = [\n      bgRef.current,\n      bgAnimRef.current,\n      objBehindRef.current,\n      objFrontRef.current,\n      secretLayerRef.current?.below,\n      secretLayerRef.current?.above,\n      liquidBgLayerRef.current,\n      liquidLayerRef.current,\n      parallaxRef.current\n    ];\n\n    layersToBlur.forEach(layer => {\n      if (layer) {\n        if (!layer.filters) layer.filters = [];\n        \n        // Blur filter\n        if (targetBlur > 0) {\n          if (!layer.filters.includes(blurFilterRef.current)) {\n            layer.filters = [...layer.filters, blurFilterRef.current];\n          }\n        } else {\n          layer.filters = layer.filters.filter(f => f !== blurFilterRef.current);\n        }\n\n        // Darken/Desaturate filter (Background only)\n        if (isInsideRoom) {\n          if (!layer.filters.includes(darkenFilterRef.current)) {\n            layer.filters = [...layer.filters, darkenFilterRef.current];\n          }\n        } else {\n          layer.filters = layer.filters.filter(f => f !== darkenFilterRef.current);\n        }\n\n        if (layer.filters.length === 0) layer.filters = null;\n      }\n    });\n\n    // Apply brightness to room layers\n    const roomLayers = [\n      roomBgRef.current,\n      roomObjBehindRef.current,\n      roomObjFrontRef.current\n    ];\n\n    roomLayers.forEach(layer => {\n      if (layer) {\n        if (!layer.filters) layer.filters = [];\n        if (isInsideRoom) {\n          if (!layer.filters.includes(roomBrightnessFilterRef.current)) {\n            layer.filters = [...layer.filters, roomBrightnessFilterRef.current];\n          }\n        } else {\n          layer.filters = layer.filters.filter(f => f !== roomBrightnessFilterRef.current);\n        }\n        if (layer.filters.length === 0) layer.filters = null;\n      }\n    });\n  }, [activeRoomIds, roomBlurEnabled]);\n\n  useEffect(() => {\n    const g = debugLayerRef.current;\n    if (!g) return;\n    g.clear();\n    if (!debugEnabledRef.current) {\n      g.visible = false;\n      return;\n    }\n    g.visible = true;\n\n    const getDefById = (id) => {\n      if (!id) return null;\n      const map = registryItems && registryItems.__byId;\n      if (map && typeof map.get === 'function') return map.get(id) || null;\n      return Array.isArray(registryItems) ? registryItems.find(r => r.id === id) : null;\n    };\n\n    const tileCount = mapWidth * mapHeight;\n    for (let i = 0; i < tileCount; i++) {\n      const tileId = tileMapData[i];\n      if (!tileId) continue;\n      const def = getDefById(tileId);\n      if (!def) continue;\n      const x = (i % mapWidth) * tileSize;\n      const y = Math.floor(i / mapWidth) * tileSize;\n      const isLiquid = !!def.flags?.liquid;\n      const isLava = !!def.flags?.lava || !!def.flags?.lava_waterfall;\n      const isRadio = !!def.flags?.radioactive || !!def.flags?.radioactive_waterfall;\n      const hasCollision = !!def.collision;\n\n      if (isLiquid) {\n        const color = isLava ? 0xffa500 : (isRadio ? 0x32cd32 : 0x2ecdf1);\n        g.rect(x, y, tileSize, tileSize);\n        g.fill({ color, alpha: 0.18 });\n      } else if (hasCollision) {\n        g.rect(x, y, tileSize, tileSize);\n        g.fill({ color: 0xff3b3b, alpha: 0.12 });\n      }\n    }\n\n    if (Array.isArray(secretMapData) && secretMapData.length) {\n      g.stroke({ width: 1, color: 0xb57bff, alpha: 0.6 });\n      for (let i = 0; i < secretMapData.length; i++) {\n        if (secretMapData[i] !== 'room_area') continue;\n        const x = (i % mapWidth) * tileSize;\n        const y = Math.floor(i / mapWidth) * tileSize;\n        g.rect(x, y, tileSize, tileSize);\n      }\n    }\n  }, [debugOverlayEnabled, tileMapData, secretMapData, mapWidth, mapHeight, tileSize, registryItems]);\n\n  // Rebuild layers when map data changes\n  useEffect(() => {\n    const app = appRef.current;\n    if (!app) return;\n\n    let active = true;\n\n    const runRebuild = async () => {\n        // Collect all textures to preload\n        const urlSet = new Set();\n        const addUrl = (u) => { if (typeof u === 'string' && u.length) urlSet.add(u); };\n        registryItems.forEach((def) => {\n            addUrl(def?.texture);\n            if (Array.isArray(def?.textures)) def.textures.forEach(addUrl);\n        });\n        if (playerVisuals) {\n            addUrl(playerVisuals.texture);\n            if (Array.isArray(playerVisuals.textures)) playerVisuals.textures.forEach(addUrl);\n        }\n\n        const urls = Array.from(urlSet);\n        if (urls.length) {\n            await Assets.load(urls);\n        }\n\n        if (!active || !appRef.current) return;\n\n        if (bgRef.current && objBehindRef.current && objFrontRef.current) {\n            rebuildLayers(\n                { \n                  bgRef: bgRef.current, \n                  objBehindRef: objBehindRef.current, \n                  objFrontRef: objFrontRef.current, \n                  roomBgRef: roomBgRef.current,\n                  roomObjBehindRef: roomObjBehindRef.current,\n                  roomObjFrontRef: roomObjFrontRef.current,\n                  secretLayerRef: secretLayerRef.current \n                },\n                { mapWidth, mapHeight, tileSize, tileMapData, objectMapData, secretMapData, revealedSecrets, registryItems, objectMetadata, isEditor, isEditorPlayMode, mapType, backgroundColor, activeRoomIds, maps }\n            );\n\n            // Rebuild player visuals if visuals changed or player not created yet\n            const pLayer = playerLayerRef.current;\n            if (pLayer) {\n                if (playerRef.current) {\n                    pLayer.removeChild(playerRef.current);\n                    try { playerRef.current.destroy({ children: true }); } catch {}\n                }\n                \n                const playerComponents = createPlayerContainer(playerVisuals, registryItems, playerStateRef.current, tileSize);\n                pLayer.addChild(playerComponents.container);\n                playerRef.current = playerComponents.container;\n                playerSpriteRefs.current = playerComponents.sprites;\n                playerHealthBarRef.current = playerComponents.healthBar;\n            }\n\n            // Rebuild liquid regions only if tileMapData changed (not just revealedSecrets)\n            // This prevents liquid \"jumping\" when revealing secrets\n            const tileDataString = JSON.stringify(tileMapData);\n            const prevTileDataString = liquidSystemRef.current?._lastTileData;\n            if (tileDataString !== prevTileDataString) {\n                try {\n                    if (liquidSystemRef.current) liquidSystemRef.current.destroy();\n                    if (liquidLayerRef.current) {\n                        liquidSystemRef.current = new LiquidRegionSystem(liquidLayerRef.current, { \n                            mapWidth, \n                            mapHeight, \n                            tileSize,\n                            bgContainer: liquidBgLayerRef.current\n                        });\n                        liquidSystemRef.current.build({ mapWidth, mapHeight, tileSize, tileMapData, registryItems });\n                        liquidSystemRef.current._lastTileData = tileDataString; // Track what we built\n                    }\n                } catch (e) { console.warn('LiquidRegionSystem rebuild failed:', e); }\n                try { lavaEmbersRef.current?.rebuildSurfaces({ mapWidth, mapHeight, tileSize, tileMapData, registryItems }); } catch {}\n            }\n\n            // Upload to GPU to avoid lazy initialization warnings\n            if (app.renderer && app.renderer.prepare) {\n                try {\n                    await app.renderer.prepare.upload(app.stage);\n                } catch (e) {\n                    // Prepare might fail in some edge cases or context loss\n                }\n            }\n        }\n    };\n\n    runRebuild();\n\n    return () => { active = false; };\n  }, [tileMapData, objectMapData, registryItems, mapWidth, mapHeight, tileSize, secretMapData, revealedSecrets, objectMetadata, playerVisuals, isPixiReady, activeRoomIds, maps, mapType, backgroundColor]);\n\n  // Weather systems lifecycle\n  useEffect(() => {\n    const app = appRef.current;\n    const weatherLayer = weatherLayerRef.current;\n    const fogLayer = fogLayerRef.current;\n    if (!app || !weatherLayer || !fogLayer || !isPixiReady) return;\n\n    const api = {\n      isSolidAt,\n      mapWidth,\n      mapHeight,\n      tileSize,\n      getPlayerState: () => playerStateRef.current,\n      getLiquidTypeAt: (x, y) => {\n        const tmd = tileMapDataRef.current;\n        const regs = registryItemsRef.current;\n        if (!tmd || !regs) return null;\n        const liq = getLiquidAtPixel(x, y, mapWidth, mapHeight, tileSize, tmd, regs);\n        if (!liq) return null;\n        return toSurfaceType(liq.type);\n      },\n      getLiquidSurfaceY: (type, x) => {\n        try { return liquidSystemRef.current?.getSurfaceY?.(type, x); } catch { return null; }\n      },\n      onWaterImpact: ({ x, strength = 0.8 }) => {\n        try {\n          const sy = liquidSystemRef.current?.getSurfaceY?.('water', x);\n          if (Number.isFinite(sy)) waterFxRef.current?.trigger({ x, y: sy, strength: Math.max(0.2, Math.min(2, strength)), upward: false });\n          try { liquidSystemRef.current?.addWave?.('water', x, Math.max(0.2, Math.min(2.2, strength))); } catch {}\n        } catch {}\n      },\n      onLavaImpact: ({ x, y, strength = 0.6 }) => {\n        try {\n          const sy = liquidSystemRef.current?.getSurfaceY?.('lava', x);\n          const yy = Number.isFinite(y) ? y : (Number.isFinite(sy) ? sy : null);\n          if (yy != null) lavaSteamRef.current?.trigger({ x, y: yy, strength });\n        } catch {}\n      },\n      onMeteorHit: (data) => {\n        if (typeof onWeatherEffectHit === 'function') {\n          onWeatherEffectHit('meteor', data);\n        }\n      },\n      getViewport: () => ({\n        x: cameraPosRef.current.x,\n        y: cameraPosRef.current.y,\n        width: app.screen?.width || 800,\n        height: app.screen?.height || 600\n      })\n    };\n\n    const getRainIntensity = () => Math.max(0, Math.min(100, Number(weatherPropsRef.current.rain) || 0));\n    const getSnowIntensity = () => Math.max(0, Math.min(100, Number(weatherPropsRef.current.snow) || 0));\n    const getCloudsIntensity = () => Math.max(0, Math.min(100, Number(weatherPropsRef.current.clouds) || 0));\n    const getThunderIntensity = () => Math.max(0, Math.min(100, Number(weatherPropsRef.current.thunder) || 0));\n    const getFogIntensity = () => Math.max(0, Math.min(100, Number(weatherPropsRef.current.fog) || 0));\n    const getLavaRainIntensity = () => Math.max(0, Math.min(100, Number(weatherPropsRef.current.lavaRain) || 0));\n    const getRadioactiveFogIntensity = () => Math.max(0, Math.min(100, Number(weatherPropsRef.current.radioactiveFog) || 0));\n    const getMeteorRainIntensity = () => Math.max(0, Math.min(100, Number(weatherPropsRef.current.meteorRain) || 0));\n\n    // Initialize systems if they don't exist\n    if (!weatherSystemsRef.current.rain) {\n      weatherSystemsRef.current.rain = new WeatherRain(weatherLayer, api, getRainIntensity);\n    }\n    if (!weatherSystemsRef.current.lavaRain) {\n      weatherSystemsRef.current.lavaRain = new WeatherLavaRain(weatherLayer, api, getLavaRainIntensity);\n    }\n    if (!weatherSystemsRef.current.snow) {\n      weatherSystemsRef.current.snow = new WeatherSnow(weatherLayer, api, getSnowIntensity);\n    }\n    if (!weatherSystemsRef.current.meteorRain) {\n      weatherSystemsRef.current.meteorRain = new WeatherMeteorRain(weatherLayer, api, getMeteorRainIntensity);\n    }\n    if (!weatherSystemsRef.current.clouds) {\n      weatherSystemsRef.current.clouds = new WeatherClouds(fogLayer, api, getCloudsIntensity);\n    }\n    if (!weatherSystemsRef.current.fog) {\n      weatherSystemsRef.current.fog = new WeatherFog(fogLayer, api, getFogIntensity);\n    }\n    if (!weatherSystemsRef.current.radioactiveFog) {\n      weatherSystemsRef.current.radioactiveFog = new WeatherRadioactiveFog(fogLayer, api, getRadioactiveFogIntensity);\n    }\n    if (!weatherSystemsRef.current.thunder) {\n      weatherSystemsRef.current.thunder = new WeatherThunder(fogLayer, api, getThunderIntensity);\n    }\n\n    // Return cleanup to destroy all when stage unmounts or map changes\n    return () => {\n      try { weatherSystemsRef.current.rain?.destroy(); } catch {}\n      try { weatherSystemsRef.current.lavaRain?.destroy(); } catch {}\n      try { weatherSystemsRef.current.snow?.destroy(); } catch {}\n      try { weatherSystemsRef.current.meteorRain?.destroy(); } catch {}\n      try { weatherSystemsRef.current.clouds?.destroy(); } catch {}\n      try { weatherSystemsRef.current.fog?.destroy(); } catch {}\n      try { weatherSystemsRef.current.radioactiveFog?.destroy(); } catch {}\n      try { weatherSystemsRef.current.thunder?.destroy(); } catch {}\n      weatherSystemsRef.current = { rain: null, lavaRain: null, snow: null, meteorRain: null, clouds: null, thunder: null, fog: null, radioactiveFog: null };\n    };\n  }, [mapWidth, mapHeight, tileSize, isSolidAt, isPixiReady]);\n\n  // Rebuild parallax when props change\n  useEffect(() => {\n    rebuildParallax();\n  }, [backgroundImage, backgroundColor, rebuildParallax]);\n\n  return <div ref={mountRef} style={{ width: '100%', height: '100%', pointerEvents }} />;\n};\n\nPixiStage.propTypes = {\n  mapWidth: PropTypes.number.isRequired,\n  mapHeight: PropTypes.number.isRequired,\n  tileSize: PropTypes.number,\n  tileMapData: PropTypes.array,\n  objectMapData: PropTypes.array,\n  secretMapData: PropTypes.array,\n  revealedSecrets: PropTypes.array,\n  registryItems: PropTypes.array,\n  playerState: PropTypes.object,\n  playerVisuals: PropTypes.object,\n  backgroundImage: PropTypes.string,\n  backgroundColor: PropTypes.string,\n  backgroundParallaxFactor: PropTypes.number,\n  cameraScrollX: PropTypes.number,\n  weatherRain: PropTypes.number,\n  weatherSnow: PropTypes.number,\n  weatherClouds: PropTypes.number,\n  projectiles: PropTypes.array,\n  healthBarEnabled: PropTypes.bool,\n  objectMetadata: PropTypes.object,\n  weatherFog: PropTypes.number,\n  weatherThunder: PropTypes.number,\n  weatherLavaRain: PropTypes.number,\n  weatherRadioactiveFog: PropTypes.number,\n  weatherMeteorRain: PropTypes.number,\n  oxygenBarEnabled: PropTypes.bool,\n  lavaBarEnabled: PropTypes.bool,\n  waterSplashesEnabled: PropTypes.bool,\n  lavaEmbersEnabled: PropTypes.bool,\n  roomBlurEnabled: PropTypes.bool,\n  debugOverlayEnabled: PropTypes.bool,\n  renderLayers: PropTypes.arrayOf(PropTypes.string),\n  pointerEvents: PropTypes.string,\n  onWeatherEffectHit: PropTypes.func,\n};\n\nexport default PixiStage;\n","import { Sprite, AnimatedSprite, Texture } from 'pixi.js';\nimport { getTexture, msToSpeed, getRegItem } from './helpers';\n\n// Sync and update projectiles: create missing sprites, remove stale ones, update positions\nexport const syncProjectiles = (projectilesLayer, projectileSpritesMap, projectilesList, registryItems, tileSize) => {\n  if (!projectilesLayer) return;\n\n  const map = projectileSpritesMap;\n  const list = projectilesList || [];\n  const seen = new Set();\n\n  // Create or update sprites for current projectiles\n  for (let i = 0; i < list.length; i++) {\n    const p = list[i];\n    const key = p.id;\n    seen.add(key);\n\n    let spr = map.get(key);\n    if (!spr) {\n      // Create new sprite\n      const def = getRegItem(registryItems, p.defId);\n      if (def && Array.isArray(def.textures) && def.textures.length > 1) {\n        const frames = def.textures.map((u) => getTexture(u)).filter(Boolean);\n        if (frames.length > 0) {\n          spr = new AnimatedSprite(frames);\n          spr.animationSpeed = msToSpeed(def.animationSpeed);\n          spr.play();\n        }\n      }\n      if (!spr) {\n        const tex = getTexture(getRegItem(registryItems, p.defId)?.texture) || Texture.WHITE;\n        spr = new Sprite(tex);\n      }\n      spr.anchor.set(0.5, 0.5);\n      spr.width = Math.max(2, p.w || tileSize * 0.25);\n      spr.height = Math.max(2, p.h || tileSize * 0.25);\n      projectilesLayer.addChild(spr);\n      map.set(key, spr);\n    }\n\n    // Update position and direction\n    spr.x = p.x + (p.dir >= 0 ? 0 : 0);\n    spr.y = p.y;\n    const mag = Math.abs(spr.scale.x || 1);\n    spr.scale.x = p.dir >= 0 ? mag : -mag;\n  }\n\n  // Remove sprites that no longer exist\n  for (const [key, spr] of map.entries()) {\n    if (!seen.has(key)) {\n      try {\n        spr.parent && spr.parent.removeChild(spr);\n      } catch (e) {\n        // ignore\n      }\n      try {\n        spr.destroy && spr.destroy();\n      } catch (e) {\n        // ignore\n      }\n      map.delete(key);\n    }\n  }\n};\n\n// Cleanup all projectile sprites\nexport const cleanupProjectiles = (projectileSpritesMap) => {\n  try {\n    for (const spr of projectileSpritesMap.values()) {\n      try {\n        spr.parent && spr.parent.removeChild(spr);\n      } catch (e) {\n        // ignore\n      }\n      try {\n        spr.destroy && spr.destroy();\n      } catch (e) {\n        // ignore\n      }\n    }\n    projectileSpritesMap.clear();\n  } catch (e) {\n    // ignore\n  }\n};\n","import { Sprite, Texture, Rectangle } from 'pixi.js';\nimport { getTexture } from './helpers';\n\n/**\n * Sinhroniz un atjaunina kustgo enttiju (piem. tanku) spraitus.\n * @param {Container} entitiesLayer PixiJS konteiners enttijm\n * @param {Map} entitySpritesMap Map, kur glabjas esoie spraiti (pc ID)\n * @param {Array} entitiesList Enttiju saraksts no dzinja\n * @param {Array} registryItems Reistra elementi\n * @param {number} tileSize Flzes izmrs pikseos\n */\nexport const syncEntities = (entitiesLayer, entitySpritesMap, entitiesList, registryItems, tileSize) => {\n  if (!entitiesLayer) return;\n\n  const seen = new Set();\n  const list = entitiesList || [];\n\n  for (const ent of list) {\n    const key = ent.id;\n    seen.add(key);\n\n    let spr = entitySpritesMap.get(key);\n    const def = ent.def || {};\n\n    if (!spr) {\n      // Izveidojam jaunu spraitu ar baltu tekstru k aizvietotju, kamr ldjas st\n      spr = new Sprite(Texture.WHITE);\n      spr.anchor.set(0, 0);\n      entitiesLayer.addChild(spr);\n      entitySpritesMap.set(key, spr);\n      spr._lastFrameIndex = -1;\n    }\n\n    // Atjaunojam tekstru no spritesheet, ja nepiecieams\n    const baseTexture = getTexture(def.texture);\n    const source = baseTexture?.source;\n    const isTextureReady = source && source.width > 1;\n\n    if (def.spriteSheet && def.spriteSheet.enabled && isTextureReady) {\n      const columns = def.spriteSheet.columns || 1;\n      const frameIndex = ent.currentSpriteIndex !== undefined ? ent.currentSpriteIndex : 0;\n      \n      if (spr._lastFrameIndex !== frameIndex) {\n        const texWidth = source.width;\n        const texHeight = source.height;\n        const totalSprites = def.spriteSheet.totalSprites || 1;\n\n        // Ja kolonnu skaits JSON ir nepareizs vai trkst, minm to aprint\n        let effectiveColumns = columns;\n        if (!effectiveColumns || effectiveColumns <= 0) {\n            effectiveColumns = Math.floor(texWidth / (def.spriteSheet.frameWidth || 32)) || 1;\n        }\n\n        const frameWidth = texWidth / effectiveColumns;\n        const frameHeight = texHeight / Math.ceil(totalSprites / effectiveColumns);\n        \n        const col = frameIndex % effectiveColumns;\n        const row = Math.floor(frameIndex / effectiveColumns);\n        \n        const rect = new Rectangle(col * frameWidth, row * frameHeight, frameWidth, frameHeight);\n        \n        try {\n            spr.texture = new Texture({\n              source: source,\n              frame: rect\n            });\n            spr._lastFrameIndex = frameIndex;\n        } catch (e) {\n            console.warn(`Failed to create texture for entity ${key} frame ${frameIndex}`, e);\n            spr.texture = baseTexture;\n        }\n      }\n    } else if (isTextureReady) {\n      if (spr.texture !== baseTexture) {\n        spr.texture = baseTexture;\n        spr._lastFrameIndex = -1;\n      }\n    } else if (def.editorIcon) {\n        // Ja nav tekstras, bet ir ikona (piemram, bultia, kaut gan ts te nevajadztu bt k enttijai)\n        if (spr.texture !== Texture.WHITE) spr.texture = Texture.WHITE;\n    }\n\n    // Pozcija un izmrs\n    const targetWidth = ent.width || tileSize;\n    const targetHeight = ent.height || tileSize;\n    \n    spr.width = targetWidth;\n    spr.height = targetHeight;\n    \n    // Nodroinm, ka scale nav 0 vai NaN (ja tekstra bija dvaina skum)\n    if (!spr.scale.x || isNaN(spr.scale.x)) spr.scale.x = 1;\n    if (!spr.scale.y || isNaN(spr.scale.y)) spr.scale.y = 1;\n\n    // Virziens (flipping)\n    const direction = ent.direction !== undefined ? ent.direction : 1;\n    const flipY = !!ent.flipY;\n    const alpha = Number.isFinite(ent.alpha) ? ent.alpha : 1;\n    \n    // Ja ir definta rotcija (piem. akmeiem), izmantojam centru k enkuru\n    if (ent.rotation !== undefined) {\n        spr.anchor.set(0.5, 0.5);\n        spr.x = ent.x + targetWidth / 2;\n        spr.y = ent.y + targetHeight / 2;\n        spr.rotation = ent.rotation;\n        spr.alpha = alpha;\n        \n        // Flipping ar centru enkuru\n        const absScaleX = Math.abs(spr.scale.x);\n        const absScaleY = Math.abs(spr.scale.y);\n        spr.scale.x = direction >= 0 ? absScaleX : -absScaleX;\n        spr.scale.y = flipY ? -absScaleY : absScaleY;\n    } else {\n        // Standarta enkurs (augjais kreisais stris)\n        spr.anchor.set(0, 0);\n        spr.rotation = 0;\n        spr.alpha = alpha;\n        \n        const absScaleX = Math.abs(spr.scale.x);\n        const absScaleY = Math.abs(spr.scale.y);\n        spr.scale.x = direction >= 0 ? absScaleX : -absScaleX;\n        spr.scale.y = flipY ? -absScaleY : absScaleY;\n        \n        // Pozicionana emot vr flipping pie enkura (0,0)\n        spr.x = ent.x + (direction < 0 ? targetWidth : 0);\n        spr.y = ent.y + (flipY ? targetHeight : 0);\n    }\n  }\n\n  // Noemam spraitus enttijm, kas vairs neeksist\n  for (const [key, spr] of entitySpritesMap.entries()) {\n    if (!seen.has(key)) {\n      if (spr.parent) spr.parent.removeChild(spr);\n      spr.destroy({ children: true, texture: false }); // Tekstras koplietoanas d ts neizncinm\n      entitySpritesMap.delete(key);\n    }\n  }\n};\n\n/**\n * Attra visus enttiju spraitus.\n */\nexport const cleanupEntities = (entitySpritesMap) => {\n  for (const spr of entitySpritesMap.values()) {\n    if (spr.parent) spr.parent.removeChild(spr);\n    spr.destroy({ children: true, texture: false });\n  }\n  entitySpritesMap.clear();\n};\n","// Item collection extracted from useGameEngine.js\n\nconst getDefById = (registryItems, id) => {\n  if (!id) return null;\n  const map = registryItems && registryItems.__byId;\n  if (map && typeof map.get === 'function') return map.get(id) || null;\n  return Array.isArray(registryItems) ? registryItems.find(r => r.id === id) : null;\n};\n\n// Collects item under player's center if pickup-able.\n// Args (ctx): { registryItems, TILE_SIZE, MAX_HEALTH, playShotSfx, onStateUpdate, gameState, maps, activeRoomIds, objectMetadata }\n// Params: currentX, currentY, mapWidth, objectLayerData\nexport function collectItem(ctx, currentX, currentY, mapWidth, objectLayerData) {\n  const { registryItems, TILE_SIZE, MAX_HEALTH, playShotSfx, onStateUpdate, gameState, maps, activeRoomIds, objectMetadata: mainMetadata, secretMapData, activeMapId } = ctx;\n  if (!objectLayerData) return;\n\n  const centerX = currentX + gameState.current.width / 2;\n  const centerY = currentY + gameState.current.height / 2;\n\n  // --- ROOM OVERLAY LOGIC ---\n  if (maps && activeRoomIds && activeRoomIds.length > 0 && mainMetadata) {\n    if (!gameState.current.collectedItems) {\n      gameState.current.collectedItems = new Set();\n    }\n\n    for (const [idxStr, meta] of Object.entries(mainMetadata)) {\n      const idx = parseInt(idxStr);\n      if (secretMapData && secretMapData[idx] !== 'room_area') continue;\n      if (meta.linkedMapId && activeRoomIds.includes(meta.linkedMapId)) {\n        const roomMap = maps[meta.linkedMapId];\n        if (!roomMap) continue;\n\n        const rx = (idx % mapWidth) * TILE_SIZE;\n        const ry = Math.floor(idx / mapWidth) * TILE_SIZE;\n        const rw = (meta.width || 1) * TILE_SIZE;\n        const rh = (meta.height || 1) * TILE_SIZE;\n\n        if (centerX >= rx && centerX < rx + rw && centerY >= ry && centerY < ry + rh) {\n          // Inside a room!\n          const localX = centerX - rx;\n          const localY = centerY - ry;\n          const rWidth = roomMap.mapWidth || roomMap.width || 20;\n          const rgX = Math.floor(localX / TILE_SIZE);\n          const rgY = Math.floor(localY / TILE_SIZE);\n          const rIndex = rgY * rWidth + rgX;\n          \n          const itemKey = `${meta.linkedMapId}:${rIndex}`;\n          if (gameState.current.collectedItems.has(itemKey)) return;\n\n          const rObjectData = roomMap.objectMapData || roomMap.layers?.find(l => l.name === 'entities')?.data;\n          if (rObjectData && rObjectData[rIndex]) {\n            // Call collectItem recursively or just handle it here\n            const rItemId = rObjectData[rIndex];\n            const rItemDef = getDefById(registryItems, rItemId);\n            \n            if (rItemDef && rItemDef.pickup && !rItemId.includes('player')) {\n               if (rItemDef.name && rItemDef.name.startsWith('interactable.')) return;\n\n               // Pick it up\n               let pickedUp = false;\n               if (rItemDef.effect && rItemDef.effect.health) {\n                 const healthBonus = parseInt(rItemDef.effect.health, 10);\n                 if (gameState.current.health < MAX_HEALTH) {\n                   gameState.current.health = Math.min(gameState.current.health + healthBonus, MAX_HEALTH);\n                   pickedUp = true;\n                 }\n               } else if (rItemDef.effect && rItemDef.effect.fireball) {\n                 const ammoBonus = parseInt(rItemDef.effect.fireball, 10) || 0;\n                 gameState.current.ammo = (gameState.current.ammo || 0) + ammoBonus;\n                 pickedUp = true;\n               }\n\n               if (pickedUp) {\n                 gameState.current.collectedItems.add(itemKey);\n                 try {\n                   playShotSfx(rItemDef?.sfx, Math.max(0, Math.min(1, rItemDef?.sfxVolume ?? 1)));\n                 } catch {}\n                 if (onStateUpdate) {\n                   onStateUpdate('collectItem', { index: rIndex, mapId: meta.linkedMapId });\n                 }\n                 return;\n               }\n            }\n          }\n          // If we are in a room, we don't pick up items from the main map below\n          return;\n        }\n      }\n    }\n  }\n  // --- END ROOM OVERLAY LOGIC ---\n\n  if (!gameState.current.collectedItems) {\n    gameState.current.collectedItems = new Set();\n  }\n\n  const gridX = Math.floor(centerX / TILE_SIZE);\n  const gridY = Math.floor(centerY / TILE_SIZE);\n  const index = gridY * mapWidth + gridX;\n  if (index < 0 || index >= objectLayerData.length) return;\n\n  const mapKey = activeMapId || 'main';\n  const itemKey = `${mapKey}:${index}`;\n  if (gameState.current.collectedItems.has(itemKey)) return;\n\n  const itemId = objectLayerData[index];\n  if (!itemId) return;\n\n  const itemDef = getDefById(registryItems, itemId);\n  if (!itemDef || !itemDef.pickup || itemId.includes('player')) return;\n\n  // Skip interactables - they are handled by checkInteractables()\n  if (itemDef.name && itemDef.name.startsWith('interactable.')) return;\n\n  // Health pickup\n  if (itemDef.effect && itemDef.effect.health) {\n    const healthBonus = parseInt(itemDef.effect.health, 10);\n    if (gameState.current.health >= MAX_HEALTH) return;\n    const newHealth = Math.min(gameState.current.health + healthBonus, MAX_HEALTH);\n    gameState.current.health = newHealth;\n    try {\n      const vol = Math.max(0, Math.min(1, itemDef?.sfxVolume ?? 1));\n      playShotSfx(itemDef?.sfx, vol);\n    } catch {}\n    if (onStateUpdate) onStateUpdate('collectItem', { index, mapId: mapKey });\n    return;\n  }\n\n  // Fireball ammo pickup\n  if (itemDef.effect && itemDef.effect.fireball) {\n    const ammoBonus = parseInt(itemDef.effect.fireball, 10) || 0;\n    gameState.current.ammo = Math.max(0, (gameState.current.ammo || 0) + ammoBonus);\n    try {\n      const vol = Math.max(0, Math.min(1, itemDef?.sfxVolume ?? 1));\n      playShotSfx(itemDef?.sfx, vol);\n    } catch {}\n    if (onStateUpdate) onStateUpdate('collectItem', { index, mapId: mapKey });\n    return;\n  }\n}\n","export function resolveInteractableContext({\n  mapData,\n  mapWidth,\n  mapHeight,\n  objectLayerData,\n  mainObjectMetadata,\n  secretMapData,\n  activeRoomIds: activeRoomIdsProp,\n  centerX,\n  centerY,\n  TILE_SIZE\n}) {\n  const hasMainMetadata = mainObjectMetadata && Object.keys(mainObjectMetadata).length > 0;\n  let activeTargetMap = mapData;\n  let activeObjectData = objectLayerData;\n  let activeMetadata = hasMainMetadata\n    ? mainObjectMetadata\n    : (mapData?.objectMetadata || mapData?.meta?.objectMetadata || {});\n  let activeMapWidth = mapWidth;\n  let activeMapHeight = mapHeight;\n  let offsetX = 0;\n  let offsetY = 0;\n  let currentMapId = mapData?.id || 'main';\n\n  const projectMaps = mapData?.maps || mapData?.projectMaps || {};\n  const activeRoomIds = activeRoomIdsProp || mapData?.meta?.activeRoomIds || [];\n\n  if (activeRoomIds.length > 0) {\n    const mainMetadata = hasMainMetadata\n      ? mainObjectMetadata\n      : (mapData?.objectMetadata || mapData?.meta?.objectMetadata || {});\n    for (const [idxStr, meta] of Object.entries(mainMetadata)) {\n      const idx = parseInt(idxStr, 10);\n      if (secretMapData && secretMapData[idx] !== 'room_area') continue;\n      if (meta.linkedMapId && activeRoomIds.includes(meta.linkedMapId)) {\n        const roomMap = projectMaps[meta.linkedMapId];\n        if (!roomMap) continue;\n\n        const rx = (idx % mapWidth) * TILE_SIZE;\n        const ry = Math.floor(idx / mapWidth) * TILE_SIZE;\n        const rw = (meta.width || 1) * TILE_SIZE;\n        const rh = (meta.height || 1) * TILE_SIZE;\n\n        if (centerX >= rx && centerX < rx + rw && centerY >= ry && centerY < ry + rh) {\n          activeTargetMap = roomMap;\n          activeMapWidth = roomMap.mapWidth || roomMap.width || 20;\n          activeMapHeight = roomMap.mapHeight || roomMap.height || 15;\n          activeObjectData = roomMap.objectMapData || roomMap.layers?.find(l => l.name === 'entities')?.data;\n          activeMetadata = roomMap.objectMetadata || {};\n          offsetX = rx;\n          offsetY = ry;\n          currentMapId = meta.linkedMapId;\n          break;\n        }\n      }\n    }\n  }\n\n  return {\n    activeTargetMap,\n    activeObjectData,\n    activeMetadata,\n    activeMapWidth,\n    activeMapHeight,\n    offsetX,\n    offsetY,\n    currentMapId,\n    projectMaps,\n    activeRoomIds\n  };\n}\n\nexport default { resolveInteractableContext };\n","/**\n * Finds spawn position in a map by trigger ID or player start\n */\nexport function findSpawnPosition(map, triggerId, tileSize) {\n  if (!map) return null;\n\n  const mapW = map.width || map.mapWidth || 20;\n  const metadata = map.objectMetadata || {};\n\n  const objLayer = map.layers?.find(l => l.name === 'entities' || l.type === 'object');\n  const objData = map.objectMapData || objLayer?.data;\n\n  if (!objData) return null;\n\n  let spawnIdx = -1;\n\n  const triggerRequested = triggerId !== undefined && triggerId !== null && triggerId !== '';\n  if (triggerRequested) {\n    for (let i = 0; i < objData.length; i++) {\n      if (!objData[i]) continue;\n      if (metadata[i] && metadata[i].triggerId === triggerId) {\n        spawnIdx = i;\n        break;\n      }\n    }\n  }\n\n  if (spawnIdx === -1 && !triggerRequested) {\n    spawnIdx = objData.findIndex(id => id && id.includes('player'));\n  }\n\n  if (spawnIdx !== -1) {\n    return {\n      x: (spawnIdx % mapW) * tileSize,\n      y: Math.floor(spawnIdx / mapW) * tileSize\n    };\n  }\n\n  return null;\n}\n\nexport default { findSpawnPosition };\n","import { findSpawnPosition } from './spawn';\n\nexport function handleDoorInteraction({\n  objDef,\n  currentMeta,\n  actualIndex,\n  keys,\n  gameState,\n  onStateUpdate,\n  playShotSfx,\n  mapData,\n  mapWidth,\n  TILE_SIZE,\n  activeTargetMap,\n  projectMaps\n}) {\n  if (!objDef || objDef.subtype !== 'door') return false;\n  if (!keys?.e) return true;\n\n  if (!gameState.current.lastETime) gameState.current.lastETime = 0;\n  const now = Date.now();\n  if (now - gameState.current.lastETime < 600) return true;\n  gameState.current.lastETime = now;\n\n  const sound = currentMeta?.sound || objDef.interaction?.sound;\n  if (sound) {\n    try { playShotSfx(sound, objDef.sfxVolume || 0.5); } catch {}\n  }\n\n  if (onStateUpdate) {\n    onStateUpdate('setObjectFrame', {\n      index: actualIndex,\n      frame: objDef.interaction?.frames?.opening || 1,\n      mapId: activeTargetMap === mapData ? null : activeTargetMap.id\n    });\n  }\n\n  const delayS = currentMeta?.delaySeconds !== undefined ? currentMeta.delaySeconds : (objDef.interaction?.delaySeconds || 0.5);\n  const targetMapId = currentMeta?.targetMapId;\n\n  if (onStateUpdate && targetMapId) {\n    setTimeout(() => {\n      const targetMap = projectMaps[targetMapId];\n      const isRoom = targetMap && targetMap.type === 'room';\n      const isExitingRoom = !isRoom && activeTargetMap !== mapData && targetMapId === 'main';\n\n      if (isRoom || isExitingRoom) {\n        let newX = gameState.current.x;\n        let newY = gameState.current.y;\n\n        if (isRoom) {\n          const roomAreaEntry = Object.entries(mapData?.meta?.objectMetadata || {})\n            .find(([, m]) => m.linkedMapId === targetMapId);\n          let rx = 0;\n          let ry = 0;\n          if (roomAreaEntry) {\n            const raIdx = parseInt(roomAreaEntry[0], 10);\n            rx = (raIdx % mapWidth) * TILE_SIZE;\n            ry = Math.floor(raIdx / mapWidth) * TILE_SIZE;\n          }\n          const spawn = findSpawnPosition(targetMap, currentMeta.spawnTriggerId, TILE_SIZE);\n          if (spawn) {\n            newX = rx + spawn.x + (TILE_SIZE - gameState.current.width) / 2;\n            newY = ry + spawn.y + (TILE_SIZE - gameState.current.height) / 2;\n          }\n        } else {\n          const roomAreaEntry = Object.entries(mapData?.meta?.objectMetadata || {})\n            .find(([, m]) => m.linkedMapId === activeTargetMap.id);\n          if (roomAreaEntry) {\n            const spawn = findSpawnPosition(mapData, currentMeta.spawnTriggerId, TILE_SIZE);\n            if (spawn) {\n              newX = spawn.x + (TILE_SIZE - gameState.current.width) / 2;\n              newY = spawn.y + (TILE_SIZE - gameState.current.height) / 2;\n            }\n          }\n        }\n\n        gameState.current.x = newX;\n        gameState.current.y = newY;\n        gameState.current.vx = 0;\n        gameState.current.vy = 0;\n        onStateUpdate('switchMap', { targetMapId, triggerId: currentMeta.spawnTriggerId });\n      } else {\n        onStateUpdate('switchMap', { targetMapId, triggerId: currentMeta.spawnTriggerId });\n      }\n    }, delayS * 1000);\n  }\n\n  return true;\n}\n\nexport default { handleDoorInteraction };\n","export function handleTeleportInteraction({\n  objId,\n  objDef,\n  currentMeta,\n  actualIndex,\n  activeObjectData,\n  activeMetadata,\n  activeMapWidth,\n  offsetX,\n  offsetY,\n  projectMaps,\n  onStateUpdate,\n  playShotSfx,\n  gameState,\n  TILE_SIZE\n}) {\n  if (!objId || !objId.includes('portal')) return false;\n  if (!currentMeta || currentMeta.triggerId === undefined || currentMeta.triggerId === null) return true;\n\n  const targetMapId = currentMeta.targetMapId;\n  if (targetMapId && projectMaps && projectMaps[targetMapId]) {\n    if (onStateUpdate) {\n      onStateUpdate('switchMap', {\n        targetMapId,\n        triggerId: currentMeta.triggerId\n      });\n      try {\n        const vol = Math.max(0, Math.min(1, objDef?.sfxVolume ?? 1));\n        playShotSfx(objDef?.sfx || \"/assets/sound/sfx/teleport.ogg\", vol);\n      } catch {}\n    }\n    return true;\n  }\n\n  for (let i = 0; i < (activeObjectData?.length || 0); i++) {\n    if (i === actualIndex) continue;\n    const destId = activeObjectData[i];\n    if (destId && (destId.includes('target') || destId === 'portal_target')) {\n      const destMeta = activeMetadata?.[i];\n      if (destMeta && destMeta.triggerId === currentMeta.triggerId) {\n        const tx = offsetX + (i % activeMapWidth) * TILE_SIZE;\n        const ty = offsetY + Math.floor(i / activeMapWidth) * TILE_SIZE;\n\n        gameState.current.x = tx;\n        gameState.current.y = ty;\n\n        try {\n          const vol = Math.max(0, Math.min(1, objDef?.sfxVolume ?? 1));\n          playShotSfx(objDef?.sfx || \"/assets/sound/sfx/teleport.ogg\", vol);\n        } catch {}\n        return true;\n      }\n    }\n  }\n\n  return true;\n}\n\nexport default { handleTeleportInteraction };\n","export function applyInteractableEffects({\n  objDef,\n  actualIndex,\n  currentMapId,\n  gameState,\n  onStateUpdate,\n  playShotSfx,\n  MAX_HEALTH\n}) {\n  if (!objDef || !objDef.name || !objDef.name.startsWith('interactable.')) return false;\n  if (!objDef.effect) return true;\n\n  const interactableKey = currentMapId === 'main' ? `${actualIndex}` : `${currentMapId}:${actualIndex}`;\n  if (gameState.current.usedInteractables.has(interactableKey)) return true;\n\n  if (objDef.effect.health) {\n    const healthBonus = parseInt(objDef.effect.health, 10);\n    if (gameState.current.health >= MAX_HEALTH) return true;\n\n    gameState.current.health = Math.min(gameState.current.health + healthBonus, MAX_HEALTH);\n\n    try {\n      const vol = Math.max(0, Math.min(1, objDef?.sfxVolume ?? 1));\n      playShotSfx(objDef?.sfx, vol);\n    } catch {}\n\n    gameState.current.usedInteractables.add(interactableKey);\n    if (onStateUpdate) onStateUpdate('interactable', { index: actualIndex, mapId: currentMapId === 'main' ? null : currentMapId });\n    return true;\n  }\n\n  if (objDef.effect.fireball) {\n    const ammoBonus = parseInt(objDef.effect.fireball, 10) || 0;\n    gameState.current.ammo = Math.max(0, (gameState.current.ammo || 0) + ammoBonus);\n\n    try {\n      const vol = Math.max(0, Math.min(1, objDef?.sfxVolume ?? 1));\n      playShotSfx(objDef?.sfx, vol);\n    } catch {}\n\n    gameState.current.usedInteractables.add(interactableKey);\n    if (onStateUpdate) onStateUpdate('interactable', { index: actualIndex, mapId: currentMapId === 'main' ? null : currentMapId });\n    return true;\n  }\n\n  return true;\n}\n\nexport default { applyInteractableEffects };\n","/**\n * Secrets Detection and Reveal Logic\n * Handles AboveSecret zone detection and revealing when player enters\n */\n\nconst getDefById = (registryItems, id) => {\n  if (!id) return null;\n  const map = registryItems && registryItems.__byId;\n  if (map && typeof map.get === 'function') return map.get(id) || null;\n  return Array.isArray(registryItems) ? registryItems.find(r => r.id === id) : null;\n};\n\n/**\n * Flood fill to find all connected secret tiles of the same type\n * @param {number} startIndex - Starting tile index\n * @param {Array} secretMapData - Secret layer data\n * @param {number} mapWidth - Map width in tiles\n * @param {number} mapHeight - Map height in tiles\n * @param {Array} registryItems - Registry items to lookup secret definitions\n * @returns {Array} - Array of connected tile indices\n */\nexport function floodFillSecretZone(startIndex, secretMapData, mapWidth, mapHeight, registryItems) {\n  const startSecretId = secretMapData[startIndex];\n  if (!startSecretId) return [];\n\n  const startDef = getDefById(registryItems, startSecretId);\n  if (!startDef || startDef.type !== 'secret') return [];\n\n  const visited = new Set();\n  const result = [];\n  const queue = [startIndex];\n\n  while (queue.length > 0) {\n    const idx = queue.shift();\n    if (visited.has(idx)) continue;\n    if (idx < 0 || idx >= secretMapData.length) continue;\n\n    visited.add(idx);\n\n    const secretId = secretMapData[idx];\n    if (!secretId || secretId !== startSecretId) continue;\n\n    result.push(idx);\n\n    // Check 4 neighbors (up, down, left, right)\n    const x = idx % mapWidth;\n    const y = Math.floor(idx / mapWidth);\n\n    // Up\n    if (y > 0) queue.push((y - 1) * mapWidth + x);\n    // Down\n    if (y < mapHeight - 1) queue.push((y + 1) * mapWidth + x);\n    // Left\n    if (x > 0) queue.push(y * mapWidth + (x - 1));\n    // Right\n    if (x < mapWidth - 1) queue.push(y * mapWidth + (x + 1));\n  }\n\n  return result;\n}\n\n/**\n * Check if player is touching any AboveSecret tiles\n * @param {Object} params - Detection parameters\n * @returns {Array|null} - Array of tile indices to reveal, or null if no detection\n */\nexport function checkSecretDetection({\n  currentX,\n  currentY,\n  width,\n  height,\n  secretMapData,\n  revealedSecrets,\n  mapWidth,\n  mapHeight,\n  registryItems,\n  TILE_SIZE\n}) {\n  if (!secretMapData || secretMapData.length === 0) return null;\n  const revealedSet = (revealedSecrets instanceof Set)\n    ? revealedSecrets\n    : new Set(revealedSecrets || []);\n\n  // Player AABB in world pixels\n  const playerLeft = currentX;\n  const playerRight = currentX + width;\n  const playerTop = currentY;\n  const playerBottom = currentY + height;\n\n  // Overlapped tile rectangle\n  const minGX = Math.floor(playerLeft / TILE_SIZE);\n  const maxGX = Math.floor((playerRight - 1) / TILE_SIZE);\n  const minGY = Math.floor(playerTop / TILE_SIZE);\n  const maxGY = Math.floor((playerBottom - 1) / TILE_SIZE);\n\n  // Check all overlapping tiles for AboveSecret\n  for (let gy = minGY; gy <= maxGY; gy++) {\n    for (let gx = minGX; gx <= maxGX; gx++) {\n      if (gx < 0 || gx >= mapWidth || gy < 0 || gy >= mapHeight) continue;\n\n      const idx = gy * mapWidth + gx;\n      const secretId = secretMapData[idx];\n      if (!secretId) continue;\n\n      // Already revealed?\n      if (revealedSet.has(idx)) continue;\n\n      const def = getDefById(registryItems, secretId);\n      if (!def || def.type !== 'secret') continue;\n\n      // Only secret.area (subtype: 'secret' or old name 'above') can be revealed\n      const isSecretArea = def.subtype === 'secret' || def.subtype === 'above';\n      if (!isSecretArea || !def.revealOnEnter) continue;\n\n      // Found an unrevealed secret.area that player is touching!\n      // Flood fill to find all connected tiles\n      const connectedIndices = floodFillSecretZone(idx, secretMapData, mapWidth, mapHeight, registryItems);\n\n      // Filter out already revealed indices to prevent infinite loop\n      const newIndices = connectedIndices.filter(i => !revealedSet.has(i));\n\n      console.log('[SECRETS] Revealing zone:', {\n        triggerIndex: idx,\n        triggerSecretId: secretId,\n        triggerSubtype: def.subtype,\n        totalConnected: connectedIndices.length,\n        newToReveal: newIndices.length,\n        firstFiveNew: newIndices.slice(0, 5),\n        connectedSecretIds: newIndices.slice(0, 5).map(i => secretMapData[i])\n      });\n\n      // Only return if there are NEW indices to reveal\n      return newIndices.length > 0 ? newIndices : null;\n    }\n  }\n\n  return null;\n}\n\nexport default { checkSecretDetection, floodFillSecretZone };\n","import i18n from './i18n';\nimport enMessages from './translations/en/tutorial_messages.json';\nimport lvMessages from './translations/lv/tutorial_messages.json';\nimport noMessages from './translations/no/tutorial_messages.json';\nimport ruMessages from './translations/ru/tutorial_messages.json';\nimport jaMessages from './translations/ja/tutorial_messages.json';\n\nconst MESSAGES = {\n  en: enMessages,\n  lv: lvMessages,\n  no: noMessages,\n  ru: ruMessages,\n  ja: jaMessages\n};\n\nconst getLang = (lang) => {\n  const raw = lang || i18n?.language || 'en';\n  const base = raw.includes('-') ? raw.split('-')[0] : raw;\n  return MESSAGES[base] ? base : 'en';\n};\n\nexport const getTutorialChapters = (lang) => {\n  const l = getLang(lang);\n  const data = MESSAGES[l] || {};\n  const fallback = MESSAGES.en || {};\n  return Array.from(new Set([...Object.keys(fallback), ...Object.keys(data)])).sort();\n};\n\nexport const getTutorialItems = (chapter, lang) => {\n  const l = getLang(lang);\n  const data = MESSAGES[l] || {};\n  const fallback = MESSAGES.en || {};\n  const chapterData = (data[chapter] && Object.keys(data[chapter]).length)\n    ? data[chapter]\n    : (fallback[chapter] || {});\n  return Object.keys(chapterData)\n    .sort((a, b) => Number(a) - Number(b))\n    .map((id) => ({ id, text: chapterData[id] }));\n};\n\nexport const getTutorialText = (chapter, id, lang) => {\n  if (!chapter || id === undefined || id === null) return '';\n  const l = getLang(lang);\n  const data = MESSAGES[l] || MESSAGES.en || {};\n  const fallback = (MESSAGES.en || {})[chapter]?.[String(id)] || '';\n  return data[chapter]?.[String(id)] || fallback;\n};\n\nexport default {\n  getTutorialChapters,\n  getTutorialItems,\n  getTutorialText\n};\n","// Secret-related trigger handlers (weather, messages)\nimport { getTutorialText } from '../../../i18n/tutorialMessages';\n\nexport function handleWeatherTrigger({\n  objDef,\n  currentMeta,\n  index,\n  gameState,\n  onStateUpdate,\n  playShotSfx\n}) {\n  if (!objDef || objDef.type !== 'weather_trigger') return false;\n\n  const weatherType = objDef.weatherType; // rain, snow, clouds, fog, thunder\n  const action = objDef.weatherAction; // on, off, set\n  let value = 0;\n\n  if (action === 'set' || action === 'on') {\n    value = currentMeta?.intensity !== undefined ? currentMeta.intensity : (action === 'on' ? 100 : 50);\n  } else if (action === 'off') {\n    value = 0;\n  }\n\n  if (!gameState.current.lastWeatherTrigger) {\n    gameState.current.lastWeatherTrigger = {};\n  }\n\n  const lastVal = gameState.current.lastWeatherTrigger[index];\n  if (lastVal !== value) {\n    if (onStateUpdate) {\n      onStateUpdate('updateWeather', { type: weatherType, value });\n    }\n    gameState.current.lastWeatherTrigger[index] = value;\n\n    if (objDef.sfx) {\n      try {\n        playShotSfx(objDef.sfx, objDef.sfxVolume || 0.5);\n      } catch {}\n    }\n  }\n  return true;\n}\n\nexport function handleMessageTrigger({\n  objDef,\n  currentMeta,\n  index,\n  gameState,\n  onStateUpdate,\n  playShotSfx,\n  keys\n}) {\n  if (!objDef || objDef.type !== 'message_trigger') return false;\n\n  const requiresActionKey = !!(objDef.requiresActionKey || objDef.interaction?.requiresKey);\n  if (requiresActionKey && !keys?.e) {\n    return false;\n  }\n\n  const i18nChapter = currentMeta?.i18nChapter;\n  const i18nId = currentMeta?.i18nId;\n  const message = (currentMeta?.message && String(currentMeta.message).trim())\n    ? currentMeta.message\n    : (i18nChapter && i18nId ? getTutorialText(i18nChapter, i18nId) : null);\n  if (!message) return true;\n\n  if (!gameState.current.lastMessageTrigger) {\n    gameState.current.lastMessageTrigger = {};\n  }\n\n  const lastMsg = gameState.current.lastMessageTrigger[index];\n  if (lastMsg !== message) {\n    if (onStateUpdate) {\n      onStateUpdate('showMessage', { text: message, duration: 8000 });\n    }\n    gameState.current.lastMessageTrigger[index] = message;\n\n    if (objDef.sfx) {\n      try {\n        playShotSfx(objDef.sfx, objDef.sfxVolume || 0.5);\n      } catch {}\n    }\n  }\n  return true;\n}\n\nexport default { handleWeatherTrigger, handleMessageTrigger };\n","// Wolfenstein-style secret triggers and movement handling\n\nexport function triggerWolfSecret({\n  objDef,\n  index,\n  keys,\n  gameState,\n  onStateUpdate,\n  playShotSfx,\n  playerCenterX,\n  playerCenterY,\n  objCenterX,\n  objCenterY,\n  playerGridX,\n  playerGridY,\n  objGridX,\n  objGridY\n}) {\n  if (!objDef || objDef.type !== 'wolf_secret') return false;\n  if (!keys?.e) return true;\n\n  const moveX = objDef.moveX || 0;\n  const moveY = objDef.moveY || 0;\n  if (moveX !== 0 || moveY !== 0) {\n    const hasGrid = Number.isFinite(playerGridX) && Number.isFinite(playerGridY) && Number.isFinite(objGridX) && Number.isFinite(objGridY);\n    if (hasGrid) {\n      if (moveX < 0 && !(playerGridX > objGridX)) return true;\n      if (moveX > 0 && !(playerGridX < objGridX)) return true;\n      if (moveY < 0) {\n        if (!keys?.w) return true;\n        if (!(playerGridY > objGridY)) return true;\n      }\n      if (moveY > 0) {\n        if (!keys?.s) return true;\n        if (!(playerGridY < objGridY)) return true;\n      }\n    } else {\n      const eps = 0.01;\n      if (moveX < 0 && playerCenterX !== undefined && objCenterX !== undefined) {\n        if (!(playerCenterX > objCenterX + eps)) return true;\n      }\n      if (moveX > 0 && playerCenterX !== undefined && objCenterX !== undefined) {\n        if (!(playerCenterX < objCenterX - eps)) return true;\n      }\n      if (moveY < 0 && playerCenterY !== undefined && objCenterY !== undefined) {\n        if (!keys?.w) return true;\n        if (!(playerCenterY > objCenterY + eps)) return true;\n      }\n      if (moveY > 0 && playerCenterY !== undefined && objCenterY !== undefined) {\n        if (!keys?.s) return true;\n        if (!(playerCenterY < objCenterY - eps)) return true;\n      }\n    }\n  }\n\n  if (!gameState.current.lastETime) gameState.current.lastETime = 0;\n  const now = Date.now();\n  if (now - gameState.current.lastETime < 1000) return true;\n  gameState.current.lastETime = now;\n\n  if (onStateUpdate) {\n    const dx = moveX;\n    const dy = moveY;\n    onStateUpdate('shiftTile', { index, dx, dy });\n\n    if (objDef.sfx) {\n      try { playShotSfx(objDef.sfx, objDef.sfxVolume || 0.5); } catch {}\n    }\n  }\n  return true;\n}\n\nexport function applyWolfSecretShift({\n  index,\n  dx,\n  dy,\n  mapWidth,\n  mapHeight,\n  getObjectId,\n  getObjectDef,\n  moveTile,\n  moveObject,\n  moveMetadata,\n  removeObject,\n  stepDelayMs = 250,\n  setTimeoutFn = setTimeout,\n  shouldCancel\n}) {\n  let currentIdx = index;\n  let remainingDx = dx;\n  let remainingDy = dy;\n  const originId = getObjectId(currentIdx);\n  if (!originId) return;\n\n  const moveStep = () => {\n    if (shouldCancel && shouldCancel()) return;\n    const currentId = getObjectId(currentIdx);\n    if (!currentId || currentId !== originId) return;\n    if (remainingDx === 0 && remainingDy === 0) {\n      if (removeObject) removeObject(currentIdx);\n      return;\n    }\n\n    const stepX = remainingDx > 0 ? 1 : (remainingDx < 0 ? -1 : 0);\n    const stepY = remainingDy > 0 ? 1 : (remainingDy < 0 ? -1 : 0);\n\n    const tx = (currentIdx % mapWidth) + stepX;\n    const ty = Math.floor(currentIdx / mapWidth) + stepY;\n\n    if (tx >= 0 && tx < mapWidth && ty >= 0 && ty < mapHeight) {\n      const targetIndex = ty * mapWidth + tx;\n\n      const isLastStepOfBatch = (Math.abs(remainingDx) === 1 && remainingDy === 0) ||\n        (Math.abs(remainingDy) === 1 && remainingDx === 0);\n      if (isLastStepOfBatch) {\n        const targetObjId = getObjectId(targetIndex);\n        const targetDef = getObjectDef(targetObjId);\n        if (targetDef && targetDef.type === 'wolf_secret') {\n          const extraX = Math.abs(targetDef.moveX || 3);\n          const extraY = Math.abs(targetDef.moveY || 3);\n          if (remainingDx !== 0) remainingDx += (remainingDx > 0 ? extraX : -extraX);\n          if (remainingDy !== 0) remainingDy += (remainingDy > 0 ? extraY : -extraY);\n        }\n      }\n\n      if (moveTile) moveTile(currentIdx, targetIndex);\n      if (moveObject) moveObject(currentIdx, targetIndex);\n      if (moveMetadata) moveMetadata(currentIdx, targetIndex);\n\n      currentIdx = targetIndex;\n      remainingDx -= stepX;\n      remainingDy -= stepY;\n\n      if (remainingDx !== 0 || remainingDy !== 0) {\n        setTimeoutFn(moveStep, stepDelayMs);\n      } else {\n        if (removeObject) removeObject(currentIdx);\n      }\n    } else {\n      if (removeObject) removeObject(currentIdx);\n    }\n  };\n\n  moveStep();\n}\n\nexport default { triggerWolfSecret, applyWolfSecretShift };\n","// Helpers for crack_block secret behavior\n\nexport function shouldRemoveCrackBlock(def, newHealth) {\n  if (!def || def.type !== 'crack_block') return false;\n  const threshold = def.passableHealthThreshold || 0;\n  return newHealth <= threshold;\n}\n\nexport default { shouldRemoveCrackBlock };\n","import { resolveInteractableContext } from './context';\nimport { handleDoorInteraction } from './doors';\nimport { handleTeleportInteraction } from './teleport';\nimport { applyInteractableEffects } from './effects';\nimport { handleWeatherTrigger, handleMessageTrigger, triggerWolfSecret } from '../secrets';\n\nconst getDefById = (registryItems, id) => {\n  if (!id) return null;\n  const map = registryItems && registryItems.__byId;\n  if (map && typeof map.get === 'function') return map.get(id) || null;\n  return Array.isArray(registryItems) ? registryItems.find(r => r.id === id) : null;\n};\n\nexport function checkInteractables(ctx, currentX, currentY, mapWidth, mapHeight, objectLayerData) {\n  const {\n    registryItems,\n    TILE_SIZE,\n    MAX_HEALTH,\n    playShotSfx,\n    onStateUpdate,\n    gameState,\n    mapData,\n    activeRoomIds: activeRoomIdsProp,\n    objectMetadata: mainObjectMetadata,\n    secretMapData\n  } = ctx;\n  if (!objectLayerData) return;\n\n  const keys = ctx.input?.current || {};\n\n  const centerX = currentX + gameState.current.width / 2;\n  const centerY = currentY + gameState.current.height / 2;\n\n  const {\n    activeTargetMap,\n    activeObjectData,\n    activeMetadata,\n    activeMapWidth,\n    activeMapHeight,\n    offsetX,\n    offsetY,\n    currentMapId,\n    projectMaps\n  } = resolveInteractableContext({\n    mapData,\n    mapWidth,\n    mapHeight,\n    objectLayerData,\n    mainObjectMetadata,\n    secretMapData,\n    activeRoomIds: activeRoomIdsProp,\n    centerX,\n    centerY,\n    TILE_SIZE\n  });\n\n  const localX = centerX - offsetX;\n  const localY = centerY - offsetY;\n\n  const gridX = Math.floor(localX / TILE_SIZE);\n  const gridY = Math.floor(localY / TILE_SIZE);\n  let index = gridY * activeMapWidth + gridX;\n\n  if (keys.e) {\n    let targetIndex = null;\n\n    if (keys.w) {\n        const upIndex = (gridY - 1) * activeMapWidth + gridX;\n        if (gridY - 1 >= 0) {\n          const upObjId = activeObjectData?.[upIndex];\n          const upDef = getDefById(registryItems, upObjId);\n          if (upDef && upDef.type === 'wolf_secret') {\n            targetIndex = upIndex;\n          }\n        }\n      }\n\n    if (targetIndex === null && keys.s) {\n      const downIndex = (gridY + 1) * activeMapWidth + gridX;\n      const limitHeight = activeMapHeight || mapHeight || 0;\n      if (gridY + 1 < limitHeight) {\n        const downObjId = activeObjectData?.[downIndex];\n        const downDef = getDefById(registryItems, downObjId);\n        if (downDef && downDef.type === 'wolf_secret') {\n          targetIndex = downIndex;\n        }\n      }\n    }\n\n    if (targetIndex === null) {\n      const dir = keys.d ? 1 : (keys.a ? -1 : (gameState.current.direction || 1));\n      const frontX = localX + dir * (TILE_SIZE * 0.8);\n      const frontGridX = Math.floor(frontX / TILE_SIZE);\n      const frontIndex = gridY * activeMapWidth + frontGridX;\n\n      if (frontIndex >= 0 && frontIndex < (activeObjectData?.length || 0)) {\n        const frontObjId = activeObjectData[frontIndex];\n        if (frontObjId) {\n          const frontDef = getDefById(registryItems, frontObjId);\n          if (frontDef && (\n            frontDef.type === 'wolf_secret' ||\n            frontDef.subtype === 'door' ||\n            frontDef.name?.startsWith('interactable.') ||\n            (frontDef.type === 'message_trigger' && (frontDef.requiresActionKey || frontDef.interaction?.requiresKey))\n          )) {\n            targetIndex = frontIndex;\n          }\n        }\n      }\n    }\n\n    if (targetIndex !== null) {\n      index = targetIndex;\n    }\n  }\n\n  let foundIndex = -1;\n  const directObjId = activeObjectData ? activeObjectData[index] : null;\n  if (directObjId) {\n    foundIndex = index;\n  } else if (activeMetadata) {\n    for (const [idxStr, meta] of Object.entries(activeMetadata)) {\n      const idx = parseInt(idxStr, 10);\n      const w = meta.width || 1;\n      const h = meta.height || 1;\n      if (w > 1 || h > 1) {\n        const ox = idx % activeMapWidth;\n        const oy = Math.floor(idx / activeMapWidth);\n        if (gridX >= ox && gridX < ox + w && gridY >= oy && gridY < oy + h) {\n          if (activeObjectData && activeObjectData[idx]) {\n            foundIndex = idx;\n            break;\n          }\n        }\n      }\n    }\n  }\n\n  if (foundIndex === -1) return;\n  const actualIndex = foundIndex;\n\n  let currentMeta = activeMetadata?.[actualIndex];\n  if (!currentMeta && mapData) {\n    const fromMap = mapData?.maps?.[currentMapId]?.objectMetadata;\n    const fromMeta = mapData?.meta?.objectMetadata || mapData?.objectMetadata;\n    currentMeta = (fromMap && fromMap[actualIndex]) || (fromMeta && fromMeta[actualIndex]) || currentMeta;\n  }\n  const objId = activeObjectData[actualIndex];\n  if (!objId) return;\n\n  const objDef = getDefById(registryItems, objId);\n  if (!objDef) return;\n\n  if (!gameState.current.usedInteractables) {\n    gameState.current.usedInteractables = new Set();\n  }\n\n  if (handleWeatherTrigger({ objDef, currentMeta, index: actualIndex, gameState, onStateUpdate, playShotSfx })) return;\n  if (handleMessageTrigger({ objDef, currentMeta, index: actualIndex, gameState, onStateUpdate, playShotSfx, keys })) return;\n  if (triggerWolfSecret({\n    objDef,\n    index: actualIndex,\n    keys,\n    gameState,\n    onStateUpdate,\n    playShotSfx,\n    playerCenterX: localX,\n    playerCenterY: localY,\n    objCenterX: ((actualIndex % activeMapWidth) + 0.5) * TILE_SIZE,\n    objCenterY: (Math.floor(actualIndex / activeMapWidth) + 0.5) * TILE_SIZE,\n    playerGridX: gridX,\n    playerGridY: gridY,\n    objGridX: actualIndex % activeMapWidth,\n    objGridY: Math.floor(actualIndex / activeMapWidth)\n  })) return;\n\n  if (handleDoorInteraction({\n    objDef,\n    currentMeta,\n    actualIndex,\n    keys,\n    gameState,\n    onStateUpdate,\n    playShotSfx,\n    mapData,\n    mapWidth,\n    TILE_SIZE,\n    activeTargetMap,\n    projectMaps\n  })) return;\n\n  if (handleTeleportInteraction({\n    objId,\n    objDef,\n    currentMeta,\n    actualIndex,\n    activeObjectData,\n    activeMetadata,\n    activeMapWidth,\n    offsetX,\n    offsetY,\n    projectMaps,\n    onStateUpdate,\n    playShotSfx,\n    gameState,\n    TILE_SIZE\n  })) return;\n\n  if (objDef.subtype === 'end' && !gameState.current.isWinning) {\n    gameState.current.isWinning = true;\n    gameState.current.winCounter = 0;\n    gameState.current.winCountSpeed = objDef.winCountSpeed || 10;\n    return;\n  }\n\n  applyInteractableEffects({\n    objDef,\n    actualIndex,\n    currentMapId,\n    gameState,\n    onStateUpdate,\n    playShotSfx,\n    MAX_HEALTH\n  });\n}\n\nexport default { checkInteractables };\n","// Hazard damage calculation (migrated from GameEngine/checkHazardDamage.js)\n\nconst getDefById = (registryItems, id) => {\n  if (!id) return null;\n  const map = registryItems && registryItems.__byId;\n  if (map && typeof map.get === 'function') return map.get(id) || null;\n  return Array.isArray(registryItems) ? registryItems.find(r => r.id === id) : null;\n};\n\nexport function checkHazardDamage({\n  currentX,\n  currentY,\n  mapWidth,\n  objectLayerData,\n  deltaMs,\n  registryItems,\n  TILE_SIZE,\n  MOVE_SPEED,\n  JUMP_FORCE,\n  hazardDamageAccumulatorRef,\n  lastHazardIndexRef,\n  triggeredHazardsRef,\n  gameState\n}) {\n  if (!objectLayerData) {\n    hazardDamageAccumulatorRef.current = 0;\n    lastHazardIndexRef.current = null;\n    return;\n  }\n\n  const width = gameState.current.width;\n  const height = gameState.current.height;\n\n  // Player AABB in world pixels\n  const playerLeft = currentX;\n  const playerRight = currentX + width;\n  const playerTop = currentY;\n  const playerBottom = currentY + height;\n\n  // Overlapped tile rectangle (inclusive)\n  const minGX = Math.floor(playerLeft / TILE_SIZE);\n  const maxGX = Math.floor(playerRight / TILE_SIZE);\n  const minGY = Math.floor(playerTop / TILE_SIZE);\n  const maxGY = Math.floor(playerBottom / TILE_SIZE);\n\n  // Collect candidate hazards that match direction rules\n  const candidates = [];\n\n  const pushCandidate = (idx, def, touch) => {\n    const dirs = def.damageDirections || { top: true, bottom: true, left: true, right: true };\n    const ok = (touch.top && dirs.top) || (touch.bottom && dirs.bottom) || (touch.left && dirs.left) || (touch.right && dirs.right);\n    if (!ok) return;\n    candidates.push({ index: idx, def, touch });\n  };\n\n  for (let gy = minGY; gy <= maxGY; gy++) {\n    for (let gx = minGX; gx <= maxGX; gx++) {\n      const idx = gy * mapWidth + gx;\n      if (idx < 0 || idx >= objectLayerData.length) continue;\n      const objId = objectLayerData[idx];\n      if (!objId) continue;\n      const def = getDefById(registryItems, objId);\n      if (!def || def.type !== 'hazard') continue;\n\n      const tileLeft = gx * TILE_SIZE;\n      const tileRight = tileLeft + TILE_SIZE;\n      const tileTop = gy * TILE_SIZE;\n      const tileBottom = tileTop + TILE_SIZE;\n\n      const overlapsHorizontally = playerRight >= tileLeft && playerLeft <= tileRight;\n      const overlapsVertically = playerBottom >= tileTop && playerTop <= tileBottom;\n      if (!overlapsHorizontally || !overlapsVertically) continue;\n\n      // Allow per-hazard touch margin; default 4px\n      let m = Number(def.touchMargin);\n      if (!Number.isFinite(m)) m = 4;\n      m = Math.max(1, Math.min(8, m));\n\n      let touchingTop = playerBottom >= tileTop && playerBottom <= tileTop + m;\n      let touchingBottom = playerTop <= tileBottom && playerTop >= tileBottom - m;\n      let touchingLeft = playerRight >= tileRight - m && playerRight <= tileRight;\n      let touchingRight = playerLeft <= tileLeft + m && playerLeft >= tileLeft;\n\n      // Fallback: infer side by smallest penetration when inside tile\n      if (!touchingTop && !touchingBottom && !touchingLeft && !touchingRight) {\n        const overlapTop = playerBottom - tileTop;\n        const overlapBottom = tileBottom - playerTop;\n        const overlapLeft = playerRight - tileLeft;\n        const overlapRight = tileRight - playerLeft;\n        const min = Math.min(overlapTop, overlapBottom, overlapLeft, overlapRight);\n        touchingTop = (min === overlapTop);\n        touchingBottom = (!touchingTop && min === overlapBottom);\n        touchingLeft = (!touchingTop && !touchingBottom && min === overlapLeft);\n        touchingRight = (!touchingTop && !touchingBottom && !touchingLeft);\n      }\n\n      pushCandidate(idx, def, { top: touchingTop, bottom: touchingBottom, left: touchingLeft, right: touchingRight });\n    }\n  }\n\n  if (candidates.length === 0) {\n    hazardDamageAccumulatorRef.current = 0;\n    lastHazardIndexRef.current = null;\n    return;\n  }\n\n  // Choose deterministic candidate: prefer top > bottom > left > right\n  const sideScore = (t) => (t.top ? 4 : 0) + (t.bottom ? 3 : 0) + (t.left ? 2 : 0) + (t.right ? 1 : 0);\n  candidates.sort((a, b) => sideScore(b.touch) - sideScore(a.touch));\n  const chosen = candidates[0];\n  const index = chosen.index;\n  const objDef = chosen.def;\n  const touch = chosen.touch;\n\n  // Update active hazard index\n  const prevIndex = lastHazardIndexRef.current;\n  lastHazardIndexRef.current = index;\n\n  const damageOnce = !!objDef.damageOnce;\n  const baseDamage = objDef.damage ?? 0;\n  const dps = objDef.damagePerSecond ?? baseDamage;\n\n  if (damageOnce) {\n    if (!triggeredHazardsRef.current.has(index)) {\n      triggeredHazardsRef.current.add(index);\n      gameState.current.health = Math.max(0, gameState.current.health - baseDamage);\n      // Hit flash to trigger temporary target animation\n      const HIT_FLASH_MS = 500;\n      const prev = Number(gameState.current.hitTimerMs) || 0;\n      gameState.current.hitTimerMs = Math.max(prev, HIT_FLASH_MS);\n      if (touch.top) {\n        gameState.current.vy = -JUMP_FORCE * 0.4;\n      } else if (touch.left) {\n        gameState.current.vx = -MOVE_SPEED * 1.5;\n      } else if (touch.right) {\n        gameState.current.vx = MOVE_SPEED * 1.5;\n      }\n      return;\n    }\n  } else {\n    // Continuous DPS: reset accumulator if we switched tiles\n    const firstTouch = prevIndex !== index;\n    if (firstTouch) {\n      // Immediate damage on first contact, then start ticking\n      hazardDamageAccumulatorRef.current = 0;\n      const immediate = Number.isFinite(baseDamage) && baseDamage > 0 ? baseDamage : dps;\n      if (immediate > 0) {\n        gameState.current.health = Math.max(0, gameState.current.health - immediate);\n        // Hit flash on immediate hit\n        const HIT_FLASH_MS = 500;\n        const prev = Number(gameState.current.hitTimerMs) || 0;\n        gameState.current.hitTimerMs = Math.max(prev, HIT_FLASH_MS);\n      }\n      // Skip DPS accumulation this same frame to avoid double damage on long frames\n      return;\n    }\n\n    hazardDamageAccumulatorRef.current += deltaMs;\n    const TICK_MS = 1000;\n    while (hazardDamageAccumulatorRef.current >= TICK_MS) {\n      hazardDamageAccumulatorRef.current -= TICK_MS;\n      gameState.current.health = Math.max(0, gameState.current.health - dps);\n      // Refresh hit timer on each damage tick\n      const HIT_FLASH_MS = 500;\n      const prev = Number(gameState.current.hitTimerMs) || 0;\n      gameState.current.hitTimerMs = Math.max(prev, HIT_FLASH_MS);\n    }\n  }\n}\n\nexport default null;\n","import meteorBreakEffectsConfig from '../../assets/json/system/meteor_break_effects.json';\n\nconst normalizeColor = (c) => {\n  if (typeof c === 'number') return c;\n  if (typeof c === 'string') {\n    const raw = c.trim().replace('#', '');\n    const n = parseInt(raw, 16);\n    return Number.isFinite(n) ? n : 0xffffff;\n  }\n  return 0xffffff;\n};\n\nconst clamp01 = (v) => Math.max(0, Math.min(1, v));\n\nconst getConfig = () => {\n  if (!meteorBreakEffectsConfig || meteorBreakEffectsConfig.enabled === false) return null;\n  return meteorBreakEffectsConfig;\n};\n\nconst lerp = (a, b, t) => a + (b - a) * t;\n\nconst scaleFromRange = (range, fallback, t) => {\n  if (!Array.isArray(range) || range.length < 2) return fallback;\n  const a = Number(range[0]);\n  const b = Number(range[1]);\n  if (!Number.isFinite(a) || !Number.isFinite(b)) return fallback;\n  return lerp(a, b, t);\n};\n\nconst readNumber = (value, fallback) => {\n  const n = Number(value);\n  return Number.isFinite(n) ? n : fallback;\n};\n\nexport const getMeteorBreakEffectConfig = ({ size, surfaceType }) => {\n  const cfg = getConfig();\n  if (!cfg) return null;\n\n  const defaults = cfg.defaults || {};\n  const sizeScale = cfg.sizeScale || {};\n  const minSize = readNumber(sizeScale.min, 4);\n  const maxSize = readNumber(sizeScale.max, 12);\n  const denom = Math.max(1, maxSize - minSize);\n  const t = clamp01((readNumber(size, minSize) - minSize) / denom);\n\n  let count = scaleFromRange(sizeScale.count, defaults.count, t);\n  let speed = scaleFromRange(sizeScale.speed, defaults.speed, t);\n  let lifeMs = scaleFromRange(sizeScale.lifeMs, defaults.lifeMs, t);\n  let particleSize = scaleFromRange(sizeScale.size, defaults.size, t);\n  let gravity = readNumber(defaults.gravity, 0.02);\n  let shape = defaults.shape || 'square';\n  let angleRange = Array.isArray(defaults.angleRange) ? defaults.angleRange : null;\n\n  const surfaces = cfg.surfaces || {};\n  const surface = surfaceType && surfaces[surfaceType] ? surfaces[surfaceType] : surfaces.ground;\n  if (surface) {\n    count = readNumber(surface.count, count);\n    speed = readNumber(surface.speed, speed);\n    lifeMs = readNumber(surface.lifeMs, lifeMs);\n    particleSize = readNumber(surface.size, particleSize);\n    gravity = readNumber(surface.gravity, gravity);\n    shape = surface.shape || shape;\n    angleRange = Array.isArray(surface.angleRange) ? surface.angleRange : angleRange;\n  }\n\n  const colorsRaw = (surface && Array.isArray(surface.colors)) ? surface.colors : defaults.colors;\n  const colors = Array.isArray(colorsRaw) && colorsRaw.length ? colorsRaw.map(normalizeColor) : [0xffffff];\n\n  return {\n    count: readNumber(count, 12),\n    speed: readNumber(speed, 2.4),\n    lifeMs: readNumber(lifeMs, 700),\n    size: readNumber(particleSize, 3),\n    colors,\n    gravity,\n    shape,\n    angleRange\n  };\n};\n\nexport default {\n  getMeteorBreakEffectConfig\n};\n","import biologicalBreakEffectsConfig from '../../assets/json/system/biological_break_effects.json';\n\nconst normalizeColor = (c) => {\n  if (typeof c === 'number') return c;\n  if (typeof c === 'string') {\n    const raw = c.trim().replace('#', '');\n    const n = parseInt(raw, 16);\n    return Number.isFinite(n) ? n : 0xffffff;\n  }\n  return 0xffffff;\n};\n\nconst getConfig = () => {\n  if (!biologicalBreakEffectsConfig || biologicalBreakEffectsConfig.enabled === false) return null;\n  return biologicalBreakEffectsConfig;\n};\n\nexport const getBiologicalBreakEffectConfig = () => {\n  const cfg = getConfig();\n  if (!cfg) return null;\n  const base = cfg.default || {};\n  const chunks = cfg.chunks && typeof cfg.chunks === 'object' ? cfg.chunks : null;\n  const colors = Array.isArray(base.colors) && base.colors.length ? base.colors.map(normalizeColor) : [0xffffff];\n  return {\n    count: Number(base.count) || 18,\n    speed: Number(base.speed) || 2.4,\n    lifeMs: Number(base.lifeMs) || 700,\n    size: Number(base.size) || 2,\n    gravity: Number.isFinite(Number(base.gravity)) ? Number(base.gravity) : 0.02,\n    shape: base.shape || 'circle',\n    angleRange: Array.isArray(base.angleRange) ? base.angleRange : null,\n    colors,\n    chunks: chunks || null\n  };\n};\n\nexport default {\n  getBiologicalBreakEffectConfig\n};\n","// Audio utilities extracted from useGameEngine.js\n\n// Usage: playSfx({ soundEnabledRef, audioCtxRef, audioCtxUnlockedRef, isInsideRoom }, url, volume)\nexport function playSfx(ctx, url, volume) {\n  const { soundEnabledRef, audioCtxRef, isInsideRoom } = ctx || {};\n  try {\n    if (!soundEnabledRef?.current) return;\n    \n    let vol = Math.max(0, Math.min(1, volume ?? 1));\n    let muffled = !!isInsideRoom;\n\n    if (muffled) {\n        vol *= 0.5; // Reduce volume if inside\n    }\n\n    // 1) Try HTMLAudio first\n    if (url && typeof url === 'string' && url.length > 0) {\n      try {\n        const audio = new Audio(url);\n        audio.volume = vol;\n        \n        // If we wanted a filter for SFX, we'd need to set up Web Audio context for each sound,\n        // which might be heavy for many sounds. Let's stick to volume reduction for simplicity \n        // unless Web Audio context is already available and passed in.\n\n        audio.addEventListener?.('error', () => {\n          try { audio.pause(); } catch {}\n          beepFallback(ctx, vol);\n        }, { once: true });\n        const p = audio.play?.();\n        if (p && typeof p.catch === 'function') p.catch(() => beepFallback(ctx, vol));\n        return;\n      } catch {\n        // fallback below\n      }\n    }\n    // 2) Fallback beep via WebAudio\n    beepFallback(ctx, vol, muffled);\n  } catch {}\n}\n\nexport function beepFallback(ctx, vol, muffled = false) {\n  try {\n    const AC = window.AudioContext || window.webkitAudioContext;\n    if (!AC) return;\n    if (!ctx?.audioCtxRef) return;\n    if (!ctx.audioCtxRef.current) ctx.audioCtxRef.current = new AC();\n    const audioCtx = ctx.audioCtxRef.current;\n    if (!audioCtx) return;\n    if (audioCtx.state === 'suspended') audioCtx.resume?.();\n    const now = audioCtx.currentTime;\n    const osc = audioCtx.createOscillator();\n    const gain = audioCtx.createGain();\n    \n    // Lowpass filter if muffled\n    let lastNode = osc;\n    if (muffled) {\n        const filter = audioCtx.createBiquadFilter();\n        filter.type = 'lowpass';\n        filter.frequency.setValueAtTime(600, now);\n        osc.connect(filter);\n        lastNode = filter;\n    }\n\n    // short square click ~520Hz for ~90ms\n    osc.type = 'square';\n    osc.frequency.setValueAtTime(muffled ? 260 : 520, now);\n    gain.gain.setValueAtTime(0.0001, now);\n    gain.gain.exponentialRampToValueAtTime(Math.max(0.05, (vol ?? 0.2) * 0.2), now + 0.01);\n    gain.gain.exponentialRampToValueAtTime(0.0001, now + 0.08);\n    \n    lastNode.connect(gain);\n    gain.connect(audioCtx.destination);\n    osc.start(now);\n    osc.stop(now + 0.09);\n  } catch {}\n}\n","// Horizontal movement extracted from useGameEngine.js\n\n// Calculates horizontal velocity/direction and resolves horizontal collision with snap.\n// Args:\n// - keys: input state (expects boolean a/d)\n// - state: { x, width, direction }\n// - MOVE_SPEED, TILE_SIZE, mapWidth, mapHeight\n// - checkCollision: function(newX, newY, mapWidth, mapHeight)  boolean\n// Returns: { x, vx, direction }\nexport function moveHorizontal({\n  keys,\n  state,\n  MOVE_SPEED,\n  TILE_SIZE,\n  mapWidth,\n  mapHeight,\n  checkCollision,\n  friction = 0.8,\n  acceleration = 0.2,\n  deltaMs = 16.67\n}) {\n  let { x, vx, width, direction, y, height } = state;\n  \n  const timeScale = deltaMs / 16.67;\n  const targetVx = keys?.a ? -MOVE_SPEED : (keys?.d ? MOVE_SPEED : 0);\n  \n  if (targetVx !== 0) {\n    // Accelerate\n    vx += targetVx * acceleration * timeScale;\n    if (Math.abs(vx) > MOVE_SPEED) vx = Math.sign(vx) * MOVE_SPEED;\n    direction = Math.sign(targetVx);\n  } else {\n    // Apply friction (time-scaled)\n    const effectiveFriction = Math.pow(friction, timeScale);\n    vx *= effectiveFriction;\n    if (Math.abs(vx) < 0.1) vx = 0;\n  }\n\n  const proposedX = x + vx * timeScale;\n  const py = y ?? 0;\n  if (checkCollision(proposedX, py, mapWidth, mapHeight, width, height)) {\n    // Precza apstans pie ra\n    const step = 0.05;\n    const sign = Math.sign(vx);\n    let safeX = x;\n    const moveDist = Math.abs(vx * timeScale);\n    \n    for (let d = step; d <= moveDist; d += step) {\n      const nextX = x + d * sign;\n      if (!checkCollision(nextX, py, mapWidth, mapHeight, width, height)) {\n        safeX = nextX;\n      } else {\n        break;\n      }\n    }\n    x = safeX;\n    vx = 0;\n  } else {\n    x = proposedX;\n  }\n\n  // Sanitize coordinates to avoid sub-pixel noise jitter\n  // We use 3 decimal places for physics calculations to keep it smooth and stable\n  x = Math.round(x * 1000) / 1000;\n\n  return { x, vx, direction };\n}\n\nexport default null;\n","// Vertical physics (gravity, jump, vertical collisions)\n// Migrated from GameEngine/applyVerticalPhysics.js to make core the source of truth.\n\n// Args:\n// - keys, x, y, vy, isGrounded, animation\n// - GRAVITY, TERMINAL_VELOCITY, JUMP_FORCE, TILE_SIZE\n// - width, height, mapWidth, mapHeight\n// - checkCollision(newX, newY, mapWidth, mapHeight)\n// - isLiquidAt(wx, wy): optional helper to detect liquid type at a world pixel\n// - vx: horizontal velocity (for deciding run/idle when landing)\n// - prevInWater: whether player was in water on previous frame\n// Returns: { y, vy, isGrounded, animation, inWater, headUnderWater, atSurface }\nexport function applyVerticalPhysics({\n  keys,\n  x,\n  y,\n  vy,\n  isGrounded,\n  animation,\n  GRAVITY,\n  TERMINAL_VELOCITY,\n  JUMP_FORCE,\n  TILE_SIZE,\n  width,\n  height,\n  mapWidth,\n  mapHeight,\n  checkCollision,\n  vx,\n  isLiquidAt,\n  prevInWater,\n  deltaMs = 16.67\n}) {\n  const timeScale = deltaMs / 16.67;\n  \n  // Liquid defaults\n  let liqBuoyancy = 0.5; // reduces effective gravity by 50%\n  let liqDragY = 0.88;  // vertical damping per frame when in liquid\n  let liqTerminal = Math.max(2, Math.floor(TERMINAL_VELOCITY * 0.4));\n  let swimImpulseMult = 0.55;\n\n  // Water detection using centerline points\n  let inWater = false;\n  let headUnderWater = false;\n  let atSurface = false;\n  let activeLiquidType = null;\n\n  if (typeof isLiquidAt === 'function') {\n    const cx = x + (width || TILE_SIZE) * 0.5;\n    const headY = y + Math.min(4, (height || TILE_SIZE) * 0.125);\n    const feetY = y + (height || TILE_SIZE) - 2;\n    const chestY = y + (height || TILE_SIZE) * 0.45;\n    \n    const feetLiq = isLiquidAt(cx, feetY);\n    const chestLiq = isLiquidAt(cx, chestY);\n    const headLiq = isLiquidAt(cx, headY);\n    \n    activeLiquidType = feetLiq || chestLiq;\n    inWater = !!activeLiquidType;\n    headUnderWater = !!headLiq;\n    atSurface = inWater && !headUnderWater;\n\n    // Apply per-liquid physics overrides\n    if (activeLiquidType === 'quicksand') {\n      liqBuoyancy = -0.15; // Negative buoyancy makes player sink!\n      liqDragY = 0.85;     // Higher drag\n      liqTerminal = 1.2;   // Very slow terminal velocity for sinking\n      swimImpulseMult = 0.35; // Harder to jump/swim\n    } else if (activeLiquidType === 'lava') {\n      liqBuoyancy = 0.3;\n      liqDragY = 0.82;\n    } else if (activeLiquidType === 'waterfall') {\n      liqBuoyancy = -0.5; // Acts like extra gravity\n      liqDragY = 0.95;     // Very low resistance\n      liqTerminal = TERMINAL_VELOCITY * 1.5; // Allow falling faster than usual terminal velocity\n    } else if (activeLiquidType === 'lava_waterfall') {\n      liqBuoyancy = -0.4; // Slightly more viscous than water\n      liqDragY = 0.92;\n      liqTerminal = TERMINAL_VELOCITY * 1.3;\n    } else if (activeLiquidType === 'radioactive_waterfall') {\n      liqBuoyancy = -0.2; // Slower fall than normal waterfall\n      liqDragY = 0.94;\n      liqTerminal = TERMINAL_VELOCITY * 0.7; // Slower speed\n    } else if (activeLiquidType === 'radioactive_water') {\n      liqBuoyancy = 0.45; // Slightly less buoyant than water\n      liqDragY = 0.86;\n    }\n  }\n\n  // Jump\n  if (keys?.space || keys?.w) {\n    if (inWater) {\n      // Swim stroke (allow even when not grounded)\n      const swimImpulse = Math.max(2, Math.floor(JUMP_FORCE * swimImpulseMult));\n      vy = Math.min(vy, 0); // prevent extra downward boost\n      vy -= swimImpulse * 0.5 * timeScale; // smaller continuous impulse\n      animation = 'jump';\n    } else if (isGrounded) {\n      vy = -JUMP_FORCE;\n      isGrounded = false;\n      animation = 'jump';\n    }\n  }\n\n  // Gravity (reduced in liquid) + vertical drag\n  if (inWater) {\n    // Entrance damping to remove harsh fall shock\n    if (!prevInWater) {\n      vy *= 0.4;\n    }\n    vy += GRAVITY * (1 - liqBuoyancy) * timeScale;\n    vy *= Math.pow(liqDragY, timeScale);\n    if (vy > liqTerminal) vy = liqTerminal;\n  } else {\n    vy += GRAVITY * timeScale;\n    if (vy > TERMINAL_VELOCITY) vy = TERMINAL_VELOCITY;\n  }\n\n  // Check vertical collision at proposed Y\n  const proposedY = y + vy * timeScale;\n  if (checkCollision(x, proposedY, mapWidth, mapHeight, width, height)) {\n    if (vy > 0) {\n      // Landing on ground\n      isGrounded = true;\n      // Snapping to the pixel above the tile - use a small offset consistent with collision inset\n      y = Math.floor((proposedY + height - 0.1) / TILE_SIZE) * TILE_SIZE - height;\n      \n      if (Math.abs(vx || 0) > 0.1) {\n        animation = 'run';\n      } else {\n        animation = 'idle';\n      }\n    } else if (vy < 0) {\n      // Hitting ceiling\n      y = Math.ceil((proposedY + 0.1) / TILE_SIZE) * TILE_SIZE;\n    }\n    vy = 0;\n  } else {\n    // Free fall\n    isGrounded = false;\n    y = proposedY;\n    if (vy > 0) {\n      animation = 'fall';\n    }\n  }\n\n  // Sanitize coordinates to prevent floating point noise jitter\n  // We use 3 decimal places for physics calculations to keep it smooth and stable\n  y = Math.round(y * 1000) / 1000;\n\n  return { y, vy, isGrounded, animation, inWater, headUnderWater, atSurface };\n}\n\nexport default null;\n","import weatherDamageConfig from '../../assets/json/system/weather_damage.json';\n\nconst clampIntensity = (v) => {\n  const n = Number(v) || 0;\n  return Math.max(0, Math.min(100, n));\n};\n\nconst getWeatherConfig = (type) => {\n  return weatherDamageConfig?.weather?.[type] || null;\n};\n\nexport const getMapWeather = (mapData) => {\n  if (!mapData) return {};\n  let base = {};\n  if (mapData.weather) base = mapData.weather;\n  else {\n    const metaWeather = mapData.meta?.weather;\n    if (metaWeather && Object.keys(metaWeather).length > 0) {\n      base = metaWeather;\n    } else {\n      const activeId = mapData.meta?.activeMapId || mapData.meta?.activeMap;\n      if (activeId && mapData.maps && mapData.maps[activeId] && mapData.maps[activeId].weather) {\n        base = mapData.maps[activeId].weather;\n      } else {\n        base = mapData.meta?.weather || {};\n      }\n    }\n  }\n  let runtime = {};\n  try {\n    const rt = window.__GAME_RUNTIME_SETTINGS__ || {};\n    runtime = {\n      rain: rt.weatherRain,\n      snow: rt.weatherSnow,\n      clouds: rt.weatherClouds,\n      fog: rt.weatherFog,\n      thunder: rt.weatherThunder,\n      lavaRain: rt.weatherLavaRain,\n      radioactiveFog: rt.weatherRadioactiveFog,\n      meteorRain: rt.weatherMeteorRain\n    };\n  } catch {}\n  const merged = { ...base };\n  Object.keys(runtime).forEach(key => {\n    if (runtime[key] !== undefined && runtime[key] !== null) {\n      merged[key] = runtime[key];\n    }\n  });\n  return merged;\n};\n\nexport const getWeatherDps = (type, intensity) => {\n  const cfg = getWeatherConfig(type);\n  if (!cfg || cfg.enabled === false) return 0;\n  const pct = clampIntensity(intensity);\n  if (pct <= 0) return 0;\n  const maxDps = Number(cfg.maxDps) || 0;\n  const minDps = Number(cfg.minDps) || 0;\n  const dps = (pct / 100) * maxDps;\n  return Math.max(minDps, dps);\n};\n\nexport const getRadioactivityRates = () => {\n  const cfg = getWeatherConfig('radioactiveFog') || {};\n  const inc = Number(cfg.radioactivityPerSecond);\n  const dec = Number(cfg.radioactivityRegenPerSecond);\n  return {\n    increase: Number.isFinite(inc) ? inc : 0,\n    decay: Number.isFinite(dec) ? dec : 0\n  };\n};\n\nexport const weatherAffectsPlayer = (type) => {\n  const cfg = getWeatherConfig(type);\n  if (!cfg || cfg.enabled === false) return false;\n  return !!cfg.affects?.player;\n};\n\nexport const weatherAffectsEnemy = (type, enemyId, enemyName) => {\n  const cfg = getWeatherConfig(type);\n  if (!cfg || cfg.enabled === false) return false;\n  const enemies = cfg.affects?.enemies;\n  if (enemies === 'true') return true;\n  if (enemies === true || enemies === 'all') return true;\n  if (enemies && typeof enemies === 'object' && enemies.mode === 'all') {\n    const excluded = Array.isArray(enemies.exclude) ? enemies.exclude : [];\n    const isExcluded = (value) => value && excluded.some(ex => value === ex || value.includes(ex));\n    if (isExcluded(enemyId)) return false;\n    if (isExcluded(enemyName)) return false;\n    return true;\n  }\n  if (Array.isArray(enemies)) {\n    if (enemyId && enemies.some(ex => enemyId === ex || enemyId.includes(ex))) return true;\n    if (enemyName && enemies.some(ex => enemyName === ex || enemyName.includes(ex))) return true;\n    return false;\n  }\n  return false;\n};\n\nexport const weatherBlockedByCover = (type) => {\n  const cfg = getWeatherConfig(type);\n  if (!cfg) return false;\n  return !!cfg.blockedByCover;\n};\n","// Collision helpers (migrated from GameEngine/collision.js)\n\nconst getDefById = (registryItems, id) => {\n  if (!id) return null;\n  const map = registryItems && registryItems.__byId;\n  if (map && typeof map.get === 'function') return map.get(id) || null;\n  return Array.isArray(registryItems) ? registryItems.find(r => r.id === id) : null;\n};\n\n// Check whether a world pixel (wx, wy) is solid (collides with a tile or an object)\n// Params:\n// - wx, wy: world pixel coordinates\n// - mapWidthTiles, mapHeightTiles: map size in tiles\n// - TILE_SIZE: tile size in pixels\n// - tileData: tile layer array (ids)\n// - registryItems: registry to resolve definitions\n// - secretData: secret layer array (ids)\n// - objectData: object layer array (ids)\n// - objectMetadata: metadata for objects (e.g. health)\n// - entities: array of active entities (optional)\n// - ignoreEntityId: ID of the entity to ignore in check (optional)\n// - maps: all project maps (optional, for room overlays)\n// - activeRoomIds: IDs of currently active/open rooms (optional)\n// - isRoom: boolean, whether we are checking collision for a room sub-map\nexport function isSolidAtPixel(wx, wy, mapWidthTiles, mapHeightTiles, TILE_SIZE, tileData, registryItems, secretData, objectData, objectMetadata, entities, ignoreEntityId, maps, activeRoomIds, isRoom = false) {\n  try {\n    const gx = Math.floor(wx / TILE_SIZE);\n    const gy = Math.floor(wy / TILE_SIZE);\n\n    // Boundary check\n    if (gx < 0 || gy < 0 || gx >= mapWidthTiles || gy >= mapHeightTiles) {\n        // Rooms have strict boundaries. Main map allows falling off the bottom.\n        // checkCollision handles top/left/right boundaries for main map.\n        return isRoom; \n    }\n\n    // Allow movement above the map (already handled by gx,gy check usually, but just in case)\n    if (wy < 0) return false;\n\n    // 0. Check for active rooms (sub-maps) - Priority check\n    if (!isRoom && maps && activeRoomIds && activeRoomIds.length > 0 && objectMetadata && secretData) {\n      let insideAnyRoom = false;\n      \n      for (const [idxStr, meta] of Object.entries(objectMetadata)) {\n        const idx = parseInt(idxStr);\n        if (secretData[idx] === 'room_area' && meta.linkedMapId && activeRoomIds.includes(meta.linkedMapId)) {\n          const roomMap = maps[meta.linkedMapId];\n          if (!roomMap) continue;\n\n          const rx = (idx % mapWidthTiles) * TILE_SIZE;\n          const ry = Math.floor(idx / mapWidthTiles) * TILE_SIZE;\n          const rw = (meta.width || 1) * TILE_SIZE;\n          const rh = (meta.height || 1) * TILE_SIZE;\n\n          // Boundary check with pixel precision\n          // Pievienojam nelielu pielaidi (0.2px) apak, lai snapping loika vertical.js \n          // (kas izmanto y + height - 0.1) nepalaistu garm istabas grdu.\n          if (wx >= rx && wx < rx + rw && wy >= ry && wy < ry + rh + 0.2) {\n            insideAnyRoom = true;\n            \n            const localWx = wx - rx;\n            const localWy = wy - ry;\n            \n            const roomTileW = roomMap.mapWidth || roomMap.width;\n            const roomTileH = roomMap.mapHeight || roomMap.height;\n            \n            const roomTiles = roomMap.tileMapData || roomMap.layers?.find(l => l.name === 'background' || l.type === 'tile')?.data;\n            const roomObjects = roomMap.objectMapData || roomMap.layers?.find(l => l.name === 'entities' || l.type === 'object')?.data;\n            const roomSecrets = roomMap.secretMapData || roomMap.layers?.find(l => l.name === 'secrets' || l.type === 'secret')?.data;\n\n            const solidInRoom = isSolidAtPixel(\n              localWx, localWy, \n              roomTileW, roomTileH, TILE_SIZE, \n              roomTiles, \n              registryItems, \n              roomSecrets, \n              roomObjects, \n              roomMap.objectMetadata, \n              null, \n              ignoreEntityId,\n              null,\n              null,\n              true // WE ARE IN A ROOM\n            );\n\n            if (solidInRoom) return true;\n            \n            // If the room map has NO content at this spot, it's a window/open area.\n            // The recursive call with isRoom=true already blocked the boundaries of the room map.\n            return false;\n          }\n        }\n      }\n      \n      if (!insideAnyRoom) {\n        // Izmums: aujam atrasties uz durvm, kas ir atvrtas, pat ja ts ir rpus room_area.\n        // Tas ir nepiecieams, lai spltjs neiestrgtu teleportcijas brd, izejot no istabas.\n        const index = gy * mapWidthTiles + gx;\n        const objId = objectData && objectData[index];\n        if (objId) {\n        const objDef = getDefById(registryItems, objId);\n          if (objDef && objDef.subtype === 'door') {\n            const meta = (objectMetadata && objectMetadata[index]) || {};\n            let frame = meta.currentFrame;\n            if (frame === undefined) frame = 0;\n            \n            const closedFrame = objDef.interaction?.frames?.closed ?? 0;\n            if (frame !== closedFrame) {\n              return false; // Durvis ir atvrtas, aujam te atrasties\n            }\n          }\n        }\n        return true; \n      }\n    }\n\n    const index = gy * mapWidthTiles + gx;\n    \n    // 0. Check entities first (dynamic obstacles)\n    if (entities) {\n      for (const ent of entities) {\n        if (ent.id === ignoreEntityId) continue;\n        if (ent.health <= 0 || ent.isExploding) continue;\n        // Platforms are stand-on-able but not usually \"solid\" for other entities' horizontal physics\n        if (ent.subtype === 'platform') continue;\n\n        if (wx >= ent.x && wx < ent.x + ent.width && wy >= ent.y && wy < ent.y + ent.height) {\n          return true;\n        }\n      }\n    }\n\n    // Check if this tile has a secret - secrets make tiles passable\n    if (secretData && secretData[index]) {\n      return false;\n    }\n\n    // 1. Check objects layer first (like the wooden box)\n    if (objectData && objectData[index]) {\n      const objId = objectData[index];\n      const objDef = getDefById(registryItems, objId);\n      \n      const isEntity = objDef && (\n        objDef.type === 'entity' || \n        objDef.subtype === 'tank' || \n        objDef.subtype === 'platform' ||\n        objDef.subtype === 'pushable' ||\n        objDef.isPushable ||\n        (objDef.name && objDef.name.toLowerCase().includes('entities.'))\n      );\n\n      if (objDef && objDef.collision && !isEntity) {\n        // Durvju specil loika: atvrtas/lietotas durvis nav cietas\n        if (objDef.subtype === 'door') {\n          const meta = (objectMetadata && objectMetadata[index]) || {};\n          let frame = meta.currentFrame;\n          \n          if (frame === undefined) {\n              // Default frame for rooms is 'inside' (open)\n              if (isRoom) {\n                  frame = objDef.interaction?.frames?.inside ?? 0;\n              } else {\n                  frame = 0; // Default for main map is closed\n              }\n          }\n\n          const closedFrame = objDef.interaction?.frames?.closed ?? 0;\n          \n          // Ja durvis nav aizvrtas (ir atvrans fz vai atvrtas), ts nav cietas\n          if (frame !== closedFrame) {\n            return false;\n          }\n        }\n\n        // Special logic for destructible objects like the wooden box\n        if (objDef.isDestructible && objectMetadata && objectMetadata[index]) {\n          const health = objectMetadata[index].health !== undefined ? objectMetadata[index].health : objDef.maxHealth;\n          const threshold = objDef.passableHealthThreshold || 0;\n          if (health <= threshold) {\n            return false; // Box is broken, can pass through\n          }\n        }\n        return true;\n      }\n    }\n\n    // 2. Check tiles layer\n    const tileId = tileData[index];\n    if (!tileId) return false;\n    const tileDef = getDefById(registryItems, tileId);\n    if (!tileDef || !tileDef.collision) return false;\n    if (tileDef.collision === true) return true;\n    if (typeof tileDef.collision === 'object') {\n      return !!(\n        tileDef.collision.top ||\n        tileDef.collision.bottom ||\n        tileDef.collision.left ||\n        tileDef.collision.right\n      );\n    }\n    return false;\n  } catch (error) {\n    console.error('Error in isSolidAtPixel:', error);\n    return false;\n  }\n}\n\n// AABB collision check for player rectangle at (newX, newY)\nexport function checkCollision(newX, newY, mapWidthTiles, mapHeightTiles, TILE_SIZE, tileData, registryItems, width, height, secretData, objectData, objectMetadata, entities, ignoreEntityId, maps, activeRoomIds) {\n  // Insets and epsilon values to prevent \"sticking\" and ensure stable grounding.\n  // inset: distance from corners for edge-mid points to avoid catching perpendicular walls.\n  // eps: small offset from the actual edge to ensure we stay within the intended tile/boundary.\n  const inset = 1.0; \n  const eps = 0.1;\n  \n  const points = [\n    // Vertical checks (Top/Bottom)\n    { x: newX + inset, y: newY + eps }, \n    { x: newX + width - inset, y: newY + eps },\n    { x: newX + width / 2, y: newY + eps },\n    \n    { x: newX + inset, y: newY + height - eps },\n    { x: newX + width - inset, y: newY + height - eps },\n    { x: newX + width / 2, y: newY + height - eps },\n\n    // Horizontal checks (Left/Right)\n    { x: newX + eps, y: newY + inset },\n    { x: newX + eps, y: newY + height - inset },\n    { x: newX + eps, y: newY + height / 2 },\n\n    { x: newX + width - eps, y: newY + inset },\n    { x: newX + width - eps, y: newY + height - inset },\n    { x: newX + width - eps, y: newY + height / 2 }\n  ];\n\n  for (let p of points) {\n    const gx = Math.floor(p.x / TILE_SIZE);\n    const gy = Math.floor(p.y / TILE_SIZE);\n    \n    // Boundary checks: block left, right, and top edges of the world.\n    // Allow falling off the bottom (gy >= mapHeightTiles).\n    if (gx < 0 || gx >= mapWidthTiles || gy < 0) return true;\n\n    if (isSolidAtPixel(p.x, p.y, mapWidthTiles, mapHeightTiles, TILE_SIZE, tileData, registryItems, secretData, objectData, objectMetadata, entities, ignoreEntityId, maps, activeRoomIds)) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * Gets physical properties of the surface below the player (friction, acceleration)\n */\nexport function getSurfaceProperties(x, y, width, height, mapWidthTiles, mapHeightTiles, TILE_SIZE, tileData, registryItems, secretData, objectMetadata, maps, activeRoomIds) {\n  const cx = x + width / 2;\n  const feetY = y + height + 1; // 1 pixel below feet\n\n  // Check for active rooms (sub-maps) - Priority check\n  if (maps && activeRoomIds && activeRoomIds.length > 0 && objectMetadata && secretData) {\n    for (const [idxStr, meta] of Object.entries(objectMetadata)) {\n      const idx = parseInt(idxStr);\n      if (secretData[idx] === 'room_area' && meta.linkedMapId && activeRoomIds.includes(meta.linkedMapId)) {\n        const roomMap = maps[meta.linkedMapId];\n        if (!roomMap) continue;\n\n        const rx = (idx % mapWidthTiles) * TILE_SIZE;\n        const ry = Math.floor(idx / mapWidthTiles) * TILE_SIZE;\n        const rw = (meta.width || 1) * TILE_SIZE;\n        const rh = (meta.height || 1) * TILE_SIZE;\n\n        if (cx >= rx && cx < rx + rw && feetY >= ry && feetY < ry + rh + 2) {\n          // Point is inside an active room!\n          const localCx = cx - rx;\n          const localFeetY = feetY - ry;\n          \n          const roomTileW = roomMap.mapWidth || roomMap.width;\n          const roomTileH = roomMap.mapHeight || roomMap.height;\n          \n          return getSurfaceProperties(\n            localCx - width/2, localFeetY - height - 1, width, height,\n            roomTileW, roomTileH, TILE_SIZE,\n            roomMap.tileMapData || (roomMap.layers?.find(l => l.name === 'background')?.data),\n            registryItems,\n            roomMap.secretMapData,\n            roomMap.objectMetadata,\n            null,\n            null\n          );\n        }\n      }\n    }\n  }\n\n  const gx = Math.floor(cx / TILE_SIZE);\n  const gy = Math.floor(feetY / TILE_SIZE);\n  \n  if (gx < 0 || gy < 0 || gx >= mapWidthTiles || gy >= mapHeightTiles) {\n    return { friction: 0.8, acceleration: 0.2 };\n  }\n  \n  const index = gy * mapWidthTiles + gx;\n  const tileId = tileData ? tileData[index] : null;\n  if (!tileId) return { friction: 0.8, acceleration: 0.2 };\n  \n    const tileDef = getDefById(registryItems, tileId);\n  if (!tileDef) return { friction: 0.8, acceleration: 0.2 };\n  \n  // If block has slipperiness, use it. Default friction is 0.8.\n  const slipperiness = tileDef.slipperiness !== undefined ? tileDef.slipperiness : 0.8;\n  \n  return {\n    friction: slipperiness,\n    // When slippery, acceleration is lower (harder to start/change direction)\n    acceleration: tileDef.slipperiness !== undefined ? (1 - slipperiness) * 2 + 0.05 : 0.2\n  };\n}\n\nexport default {\n  isSolidAtPixel,\n  checkCollision,\n  getSurfaceProperties\n};\n","import { isSolidAtPixel } from '../physics/collision';\n\nconst isInsideActiveRoom = ({\n  x,\n  y,\n  mapWidth,\n  mapHeight,\n  TILE_SIZE,\n  secretData,\n  objectMetadata,\n  activeRoomIds\n}) => {\n  if (!activeRoomIds || !activeRoomIds.length) return false;\n  if (!secretData || !objectMetadata) return false;\n  const gx = Math.floor(x / TILE_SIZE);\n  const gy = Math.floor(y / TILE_SIZE);\n  if (gx < 0 || gy < 0 || gx >= mapWidth || gy >= mapHeight) return false;\n  for (const [idxStr, meta] of Object.entries(objectMetadata)) {\n    const idx = parseInt(idxStr, 10);\n    if (secretData[idx] !== 'room_area') continue;\n    if (!meta?.linkedMapId || !activeRoomIds.includes(meta.linkedMapId)) continue;\n    const rx = idx % mapWidth;\n    const ry = Math.floor(idx / mapWidth);\n    const rw = meta.width || 1;\n    const rh = meta.height || 1;\n    if (gx >= rx && gx < rx + rw && gy >= ry && gy < ry + rh) return true;\n  }\n  return false;\n};\n\nexport const isCoveredFromAbove = ({\n  x,\n  y,\n  mapWidth,\n  mapHeight,\n  TILE_SIZE,\n  tileData,\n  registryItems,\n  secretData,\n  objectData,\n  objectMetadata,\n  maps,\n  activeRoomIds\n}) => {\n  if (!Number.isFinite(x) || !Number.isFinite(y)) return false;\n  if (isInsideActiveRoom({ x, y, mapWidth, mapHeight, TILE_SIZE, secretData, objectMetadata, activeRoomIds })) {\n    return true;\n  }\n  const gridX = Math.floor(x / TILE_SIZE);\n  if (gridX < 0 || gridX >= mapWidth) return false;\n  let gridY = Math.floor(y / TILE_SIZE) - 1;\n  for (; gridY >= 0; gridY--) {\n    const wx = gridX * TILE_SIZE + TILE_SIZE / 2;\n    const wy = gridY * TILE_SIZE + TILE_SIZE / 2;\n    if (isSolidAtPixel(wx, wy, mapWidth, mapHeight, TILE_SIZE, tileData, registryItems, secretData, objectData, objectMetadata, null, null, maps, activeRoomIds)) {\n      return true;\n    }\n  }\n  return false;\n};\n","import { moveHorizontal } from '../physics/horizontal';\nimport { applyVerticalPhysics } from '../physics/vertical';\nimport { getWeatherDps, getMapWeather, weatherAffectsEnemy, weatherBlockedByCover } from './weatherDamage';\nimport { isCoveredFromAbove } from './weatherCover';\n\nconst getDefById = (registryItems, id) => {\n  if (!id) return null;\n  const map = registryItems && registryItems.__byId;\n  if (map && typeof map.get === 'function') return map.get(id) || null;\n  return Array.isArray(registryItems) ? registryItems.find(r => r.id === id) : null;\n};\n\nconst getTileLayerData = (mapData) => {\n  if (!mapData) return [];\n  if (Array.isArray(mapData.tileMapData)) return mapData.tileMapData;\n  const layer = mapData.layers?.find(l => l.name === 'background' || l.type === 'tile');\n  return layer?.data || [];\n};\n\nconst getSecretLayerData = (mapData) => {\n  if (!mapData) return [];\n  if (Array.isArray(mapData.secretMapData)) return mapData.secretMapData;\n  const layer = mapData.layers?.find(l => l.name === 'secrets' || l.type === 'secret');\n  return layer?.data || [];\n};\n\nconst liquidTypeToHabitat = (liquidType) => {\n  if (!liquidType) return 'none';\n  if (liquidType.includes('radioactive')) return 'radioactive';\n  if (liquidType.includes('lava')) return 'lava';\n  if (liquidType.includes('quicksand')) return 'quicksand';\n  if (liquidType.includes('water')) return 'water';\n  return 'none';\n};\n\nconst getFishTriggerAt = ({ x, y, mapWidth, mapHeight, TILE_SIZE, secretData, objectData, registryItems }) => {\n  if (!registryItems) return null;\n  const gx = Math.floor(x / TILE_SIZE);\n  const gy = Math.floor(y / TILE_SIZE);\n  if (gx < 0 || gy < 0 || gx >= mapWidth || gy >= mapHeight) return null;\n  const idx = gy * mapWidth + gx;\n  const secretId = secretData ? secretData[idx] : null;\n  const objectId = objectData ? objectData[idx] : null;\n  const def = getDefById(registryItems, secretId) || getDefById(registryItems, objectId);\n  if (!def) return null;\n  if (def.type === 'secret' && def.subtype === 'animal_trigger' && def.triggerType === 'fish') return def;\n  return null;\n};\n\nconst getWaterSurfaceY = ({ x, mapWidth, mapHeight, tileData, registryItems, TILE_SIZE }) => {\n  if (!tileData || mapWidth <= 0 || mapHeight <= 0) return null;\n  const gx = Math.floor(x / TILE_SIZE);\n  if (gx < 0 || gx >= mapWidth) return null;\n  for (let gy = 0; gy < mapHeight; gy++) {\n    const idx = gy * mapWidth + gx;\n    const id = tileData[idx];\n    if (!id) continue;\n    const def = getDefById(registryItems, id);\n    if (!def || !def.flags || !def.flags.liquid) continue;\n    if (def.flags.water || def.flags.waterfall) {\n      return gy * TILE_SIZE;\n    }\n  }\n  return null;\n};\n\n/**\n * Atjaunina visas aktvs enttijas (piemram, tankus).\n * @param {Object} ctx Konteksts ar nepiecieamajiem datiem un funkcijm\n * @param {number} deltaMs Laiks kop pdj kadra\n */\nexport function updateEntities(ctx, deltaMs) {\n  const {\n    entitiesRef,\n    gameState,\n    mapWidth,\n    mapHeight,\n    TILE_SIZE,\n    checkCollision,\n    isLiquidAt,\n    getLiquidSample,\n    spawnProjectile,\n    playSfx,\n    constants,\n    objectData,\n    mapData,\n    registryItems,\n    onStateUpdate,\n    activeRoomIds\n  } = ctx;\n\n  if (!entitiesRef.current || entitiesRef.current.length === 0) return;\n\n  const { GRAVITY, TERMINAL_VELOCITY } = constants;\n  const playerX = gameState.current.x;\n  const playerY = gameState.current.y;\n  const weatherNow = getMapWeather(mapData);\n  const lavaRainInt = Number(weatherNow.lavaRain || 0);\n  const radioFogInt = Number(weatherNow.radioactiveFog || 0);\n\n  // Ms modificjam enttijas pa tieo ref\n  const entities = entitiesRef.current;\n  for (let i = entities.length - 1; i >= 0; i--) {\n    const entity = entities[i];\n    const def = entity.def || {};\n    const isFish = def?.subtype === 'fish' || def?.ai?.type === 'fish' || !!def?.fish;\n    // 1. Ja enttija ir mirusi, apstrdjam sprdzienu vai noemanu\n    if (entity.health <= 0 && !isFish) {\n      if (!entity.isExploding) {\n        entity.isExploding = true;\n        entity.animation = 'explode';\n        entity.animFrame = 0;\n        entity.animTimer = 0;\n        entity.vx = 0; // Apstjamies sprdziena laik\n        entity.vy = 0;\n        entity.isGrounded = true; // Sprgst uz zemes\n      }\n      \n      const explodeAnim = def.spriteSheet?.animations?.explode || [];\n      const totalFrames = explodeAnim.length;\n      const frameDuration = 100; // ms uz kadru\n      \n      entity.animTimer += deltaMs;\n      if (entity.animTimer >= frameDuration) {\n        entity.animTimer = 0;\n        entity.animFrame++;\n        if (entity.animFrame >= totalFrames) {\n          entity.shouldRemove = true;\n        }\n      }\n      if (entity.shouldRemove) {\n        entities.splice(i, 1);\n      }\n      continue;\n    }\n\n    // 1.2. Liquid damage (e.g. lava, radioactive water)\n    const liquidSample = getLiquidSample ? getLiquidSample({\n      x: entity.x,\n      y: entity.y,\n      width: entity.width,\n      height: entity.height,\n      TILE_SIZE,\n      mapWidth,\n      mapHeight\n    }) : { inLiquid: false };\n\n    if (isFish) {\n      const cfg = def.fish || {};\n      const activeRadiusPx = (Number(cfg.activeRadius) || 18) * TILE_SIZE;\n      const ex = entity.x + entity.width / 2;\n      const ey = entity.y + entity.height / 2;\n      const dxView = (playerX + gameState.current.width / 2) - ex;\n      const dyView = (playerY + gameState.current.height / 2) - ey;\n      const distView = Math.sqrt(dxView * dxView + dyView * dyView);\n      const isActive = distView <= activeRadiusPx;\n\n      if (!isActive && entity.health > 0) {\n        entity.isDormant = true;\n        entity.vx = 0;\n        entity.vy = 0;\n        entity.animation = 'idle';\n        const idleAnim = def.spriteSheet?.animations?.idle || [0];\n        entity.currentSpriteIndex = idleAnim[0] || 0;\n        continue;\n      }\n      entity.isDormant = false;\n    }\n\n    if (liquidSample.inLiquid && liquidSample.params && liquidSample.params.dps > 0) {\n      entity.liquidDamageAcc = (entity.liquidDamageAcc || 0) + deltaMs;\n      while (entity.liquidDamageAcc >= 1000) {\n        entity.liquidDamageAcc -= 1000;\n        const dmg = liquidSample.params.dps;\n        entity.health = Math.max(0, entity.health - dmg);\n        if (onStateUpdate) {\n          onStateUpdate('entityDamage', {\n            x: entity.x + entity.width / 2,\n            y: entity.y,\n            amount: dmg\n          });\n        }\n      }\n    } else {\n      entity.liquidDamageAcc = 0;\n    }\n\n    // 1.3. Weather damage (Lava Rain, Radioactive Fog)\n    const enemyId = entity.defId || def?.id;\n    const enemyName = def?.name;\n    let lavaDps = weatherAffectsEnemy('lavaRain', enemyId, enemyName) ? getWeatherDps('lavaRain', lavaRainInt) : 0;\n    if (lavaDps > 0 && liquidSample.inLiquid && liquidSample.type && liquidSample.type.includes('water')) {\n      lavaDps = 0;\n    }\n    const radioDps = weatherAffectsEnemy('radioactiveFog', enemyId, enemyName) ? getWeatherDps('radioactiveFog', radioFogInt) : 0;\n    if (lavaDps > 0 && weatherBlockedByCover('lavaRain')) {\n      try {\n        const tileData = mapData.layers?.find(l => l.name === 'background' || l.type === 'tile')?.data || [];\n        const secretData = mapData.layers?.find(l => l.name === 'secrets' || l.type === 'secret')?.data || [];\n        const objectMetadata = mapData.meta?.objectMetadata || {};\n        const covered = isCoveredFromAbove({\n          x: entity.x + entity.width / 2,\n          y: entity.y,\n          mapWidth,\n          mapHeight,\n          TILE_SIZE,\n          tileData,\n          registryItems,\n          secretData,\n          objectData,\n          objectMetadata,\n          maps: mapData.maps,\n          activeRoomIds: activeRoomIds || mapData.meta?.activeRoomIds\n        });\n        if (covered) lavaDps = 0;\n      } catch {}\n    }\n    const totalWeatherDps = lavaDps + radioDps;\n\n    if (totalWeatherDps > 0) {\n      entity.weatherDamageAcc = (entity.weatherDamageAcc || 0) + deltaMs;\n      if (entity.weatherDamageAcc >= 1000) {\n        entity.weatherDamageAcc -= 1000;\n        entity.health = Math.max(0, entity.health - totalWeatherDps);\n        if (onStateUpdate) {\n          onStateUpdate('entityDamage', {\n            x: entity.x + entity.width / 2,\n            y: entity.y,\n            amount: totalWeatherDps\n          });\n        }\n      }\n    } else {\n      entity.weatherDamageAcc = 0;\n    }\n\n    if (isFish) {\n      const cfg = def.fish || {};\n      const habitat = cfg.habitat || {};\n      const now = Number(gameState.current.timeMs) || 0;\n      const dt = Math.max(0, Number(deltaMs) || 0) / 1000;\n      const liquidType = liquidSample?.type || null;\n      const habitatKey = liquidTypeToHabitat(liquidType);\n      const isAllowed = !!(liquidSample?.inLiquid && habitatKey && habitat[habitatKey] !== false);\n      const requireLiquid = cfg.requireLiquid !== false;\n\n      entity.fishState = entity.fishState || {};\n      const fs = entity.fishState;\n\n      if (!fs.initialized) {\n        fs.initialized = true;\n        entity.direction = Math.random() < 0.5 ? -1 : 1;\n        fs.nextTurnAt = now + (cfg.turnMinMs || 900) + Math.random() * ((cfg.turnMaxMs || 2600) - (cfg.turnMinMs || 900));\n        fs.nextVerticalAt = now + 500 + Math.random() * 1500;\n        fs.verticalDir = Math.random() < 0.5 ? -1 : 1;\n        fs.animFrame = 0;\n        fs.animTimer = 0;\n      }\n\n      if (entity.health <= 0) {\n        const player = gameState.current;\n        const hit = (\n          player.x < entity.x + entity.width &&\n          player.x + player.width > entity.x &&\n          player.y < entity.y + entity.height &&\n          player.y + player.height > entity.y\n        );\n        if (hit) {\n          gameState.current.fishCount = Math.max(0, (Number(gameState.current.fishCount) || 0) + 1);\n          entities.splice(i, 1);\n          continue;\n        }\n        if (entity.fishState?.removeOnNext) {\n          entities.splice(i, 1);\n          continue;\n        }\n        const tileData = getTileLayerData(mapData);\n        const surfaceY = getWaterSurfaceY({\n          x: entity.x + entity.width / 2,\n          mapWidth,\n          mapHeight,\n          tileData,\n          registryItems,\n          TILE_SIZE\n        });\n        const surfaceOffset = Number.isFinite(cfg.deathSurfaceOffset) ? cfg.deathSurfaceOffset : 0.5;\n        if (Number.isFinite(surfaceY)) {\n          const targetY = surfaceY - entity.height * surfaceOffset;\n          const floatSpeed = (Number(cfg.deathFloatSpeed) || 0.25) * TILE_SIZE;\n          if (entity.y > targetY) {\n            entity.y = Math.max(targetY, entity.y - floatSpeed * dt);\n          } else {\n            entity.y = targetY;\n          }\n        }\n        entity.vx = 0;\n        entity.vy = 0;\n        entity.isGrounded = false;\n        entity.flipY = true;\n        entity.animation = 'dead';\n        const deadAnim = def.spriteSheet?.animations?.dead || [];\n        entity.currentSpriteIndex = deadAnim.length ? deadAnim[0] : (cfg.meteorShockFrame || 2);\n        continue;\n      }\n\n      entity.flipY = false;\n      entity.alpha = 1;\n\n      if (requireLiquid && !isAllowed && !fs.isJumping) {\n        entities.splice(i, 1);\n        continue;\n      }\n\n      const panicRadiusPx = (Number(cfg.panicRadius) || 6) * TILE_SIZE;\n      const panicSpeed = (Number(cfg.panicSpeed) || 2.2) * TILE_SIZE;\n      const baseSpeed = (Number(cfg.swimSpeed) || 0.6) * TILE_SIZE;\n      const verticalDrift = (Number(cfg.verticalDrift) || 0.25) * TILE_SIZE;\n      const isWaterfall = !!(liquidType && liquidType.includes('waterfall'));\n      const waterfallDriftMultiplier = Number.isFinite(cfg.waterfallDriftMultiplier) ? cfg.waterfallDriftMultiplier : 0.4;\n      const waterfallSpeedMultiplier = Number.isFinite(cfg.waterfallSpeedMultiplier) ? cfg.waterfallSpeedMultiplier : 0.7;\n\n      const triggerDef = getFishTriggerAt({\n        x: entity.x + entity.width / 2,\n        y: entity.y + entity.height / 2,\n        mapWidth,\n        mapHeight,\n        TILE_SIZE,\n        secretData: getSecretLayerData(mapData),\n        objectData,\n        registryItems\n      });\n      const triggerCfg = triggerDef?.fishTrigger || {};\n      const fishJumpCfg = cfg.jump || {};\n      const mergedJumpCfg = { ...triggerCfg, ...fishJumpCfg };\n      const nowMs = Number(gameState.current.timeMs) || 0;\n      const nextJumpAt = Number(fs.nextJumpAt) || 0;\n      const canJump = !fs.isJumping && nowMs >= nextJumpAt && triggerDef && liquidSample?.inLiquid && liquidTypeToHabitat(liquidType) === 'water';\n\n      if (canJump) {\n        const chance = Math.max(0, Math.min(1, Number(mergedJumpCfg.chance ?? 1)));\n        if (Math.random() <= chance) {\n          const jumpDir = Math.random() < 0.5 ? -1 : 1;\n          entity.direction = jumpDir;\n          fs.isJumping = true;\n          fs.jumpVx = (Number(mergedJumpCfg.speedX) || 3.5) * TILE_SIZE * jumpDir;\n          fs.jumpVy = -(Number(mergedJumpCfg.speedY) || 6) * TILE_SIZE;\n          fs.jumpGravity = (Number(mergedJumpCfg.gravity) || 18) * TILE_SIZE;\n          fs.jumpBounce = Number.isFinite(mergedJumpCfg.bounce) ? Number(mergedJumpCfg.bounce) : 0.35;\n          fs.nextJumpAt = nowMs + (Number(mergedJumpCfg.cooldownMs) || 1400);\n        }\n      }\n\n      if (fs.isJumping) {\n        const dtSec = Math.max(0, Number(deltaMs) || 0) / 1000;\n        fs.jumpVy = (Number(fs.jumpVy) || 0) + (Number(fs.jumpGravity) || (GRAVITY * 60)) * dtSec;\n        let nextX = entity.x + (Number(fs.jumpVx) || 0) * dtSec;\n        let nextY = entity.y + (Number(fs.jumpVy) || 0) * dtSec;\n\n        if (checkCollision(nextX, entity.y, mapWidth, mapHeight, entity.width, entity.height, entity.id)) {\n          fs.jumpVx = -(Number(fs.jumpVx) || 0) * (Number(fs.jumpBounce) || 0.35);\n          nextX = entity.x + (Number(fs.jumpVx) || 0) * dtSec;\n        }\n\n        if (checkCollision(entity.x, nextY, mapWidth, mapHeight, entity.width, entity.height, entity.id)) {\n          if ((Number(fs.jumpVy) || 0) > 0) {\n            entity.health = 0;\n            fs.isJumping = false;\n            entity.vx = 0;\n            entity.vy = 0;\n            entity.isGrounded = true;\n            entity.x = nextX;\n            entity.y = Math.floor((nextY + entity.height - 0.1) / TILE_SIZE) * TILE_SIZE - entity.height;\n            continue;\n          }\n          fs.jumpVy = Math.abs(Number(fs.jumpVy) || 0) * (Number(fs.jumpBounce) || 0.35);\n          nextY = entity.y + (Number(fs.jumpVy) || 0) * dtSec;\n        }\n\n        const landingSample = getLiquidSample ? getLiquidSample({\n          x: nextX,\n          y: nextY,\n          width: entity.width,\n          height: entity.height,\n          TILE_SIZE,\n          mapWidth,\n          mapHeight\n        }) : { inLiquid: false };\n\n        if (landingSample?.inLiquid && liquidTypeToHabitat(landingSample?.type) === 'water' && (Number(fs.jumpVy) || 0) > 0) {\n          fs.isJumping = false;\n          entity.vx = 0;\n          entity.vy = 0;\n        } else {\n          entity.vx = Number(fs.jumpVx) || 0;\n          entity.vy = Number(fs.jumpVy) || 0;\n        }\n\n        entity.x = nextX;\n        entity.y = nextY;\n        entity.isGrounded = false;\n        continue;\n      }\n\n      const px = playerX + gameState.current.width / 2;\n      const py = playerY + gameState.current.height / 2;\n      const ex = entity.x + entity.width / 2;\n      const ey = entity.y + entity.height / 2;\n      const dx = px - ex;\n      const dy = py - ey;\n      const dist = Math.sqrt(dx * dx + dy * dy);\n\n      if (fs.shockUntil && fs.shockUntil > now) {\n        const shockFrame = Number(cfg.meteorShockFrame) || 2;\n        entity.animation = 'shock';\n        entity.currentSpriteIndex = shockFrame;\n      }\n\n      const lastWaterEnter = gameState.current.lastWaterEnter;\n      if (lastWaterEnter && Number(lastWaterEnter.time) && now - Number(lastWaterEnter.time) < 1200) {\n        const waveRadiusPx = (Number(cfg.playerWaveRadius) || 10) * TILE_SIZE;\n        if (dist <= waveRadiusPx) {\n          fs.waveImpulse = Number(cfg.playerWaveImpulse) || 0.35;\n          fs.waveUntil = now + 400;\n        }\n        if (dist <= panicRadiusPx) {\n          fs.panicUntil = now + (Number(cfg.panicDurationMs) || 1200);\n        }\n      }\n      if (gameState.current.inWater && dist <= panicRadiusPx) {\n        fs.panicUntil = now + (Number(cfg.panicDurationMs) || 1200);\n      }\n\n      const isPanicking = fs.panicUntil && fs.panicUntil > now;\n      let dir = entity.direction || 1;\n      if (isPanicking) {\n        dir = dx >= 0 ? -1 : 1;\n      } else if (now >= (fs.nextTurnAt || 0)) {\n        dir = Math.random() < 0.5 ? -1 : 1;\n        fs.nextTurnAt = now + (cfg.turnMinMs || 900) + Math.random() * ((cfg.turnMaxMs || 2600) - (cfg.turnMinMs || 900));\n      }\n      entity.direction = dir;\n\n      if (now >= (fs.nextVerticalAt || 0)) {\n        fs.verticalDir = Math.random() < 0.5 ? -1 : 1;\n        fs.nextVerticalAt = now + 500 + Math.random() * 1500;\n      }\n\n      let vx = dir * (isPanicking ? panicSpeed : baseSpeed);\n      let vy = (fs.verticalDir || 1) * verticalDrift;\n      if (isWaterfall) {\n        vx *= waterfallSpeedMultiplier;\n        vy *= waterfallDriftMultiplier;\n        const downSpeed = (Number(cfg.waterfallDownSpeed) || 2.4) * TILE_SIZE;\n        vy = Math.max(Math.abs(vy), downSpeed);\n        entity.alpha = Number.isFinite(cfg.waterfallAlpha) ? cfg.waterfallAlpha : 1;\n      }\n\n      if (fs.waveUntil && fs.waveUntil > now) {\n        const impulse = Math.max(0, Number(fs.waveImpulse) || 0.35) * TILE_SIZE;\n        vx += (Math.random() - 0.5) * impulse;\n        vy += (Math.random() - 0.5) * impulse * 0.5;\n      }\n\n      let nextX = entity.x + vx * dt;\n      let nextY = entity.y + vy * dt;\n\n      if (checkCollision(nextX, entity.y, mapWidth, mapHeight, entity.width, entity.height, entity.id)) {\n        dir *= -1;\n        entity.direction = dir;\n        vx = dir * (isPanicking ? panicSpeed : baseSpeed);\n        nextX = entity.x + vx * dt;\n      }\n\n      if (checkCollision(entity.x, nextY, mapWidth, mapHeight, entity.width, entity.height, entity.id)) {\n        fs.verticalDir *= -1;\n        vy = fs.verticalDir * verticalDrift;\n        nextY = entity.y + vy * dt;\n      }\n\n      if (typeof getLiquidSample === 'function') {\n        const sampleNext = getLiquidSample({\n          x: nextX,\n          y: nextY,\n          width: entity.width,\n          height: entity.height,\n          TILE_SIZE,\n          mapWidth,\n          mapHeight\n        });\n        const nextType = liquidTypeToHabitat(sampleNext?.type);\n        const nextAllowed = !!(sampleNext?.inLiquid && nextType && habitat[nextType] !== false);\n        if (!nextAllowed) {\n          fs.verticalDir *= -1;\n          dir *= -1;\n          entity.direction = dir;\n          vx = dir * (isPanicking ? panicSpeed : baseSpeed);\n          vy = fs.verticalDir * verticalDrift;\n          nextX = entity.x + vx * dt;\n          nextY = entity.y + vy * dt;\n        }\n      }\n\n      entity.x = nextX;\n      entity.y = nextY;\n      entity.vx = vx;\n      entity.vy = vy;\n      entity.isGrounded = false;\n\n      const anims = def.spriteSheet?.animations || {};\n      let animKey = 'swim';\n      if (isPanicking && anims.panic) animKey = 'panic';\n      if (Math.abs(vx) < 0.02 && anims.idle) animKey = 'idle';\n\n      if (!(fs.shockUntil && fs.shockUntil > now)) {\n        const currentAnim = anims[animKey] || anims.swim || anims.idle || [0];\n        fs.animTimer = (fs.animTimer || 0) + deltaMs;\n        const frameDur = 180;\n        if (fs.animTimer >= frameDur) {\n          fs.animTimer = 0;\n          fs.animFrame = (fs.animFrame || 0) + 1;\n          if (fs.animFrame >= currentAnim.length) fs.animFrame = 0;\n        }\n        entity.currentSpriteIndex = currentAnim[fs.animFrame % currentAnim.length];\n      }\n\n      continue;\n    }\n\n    // 1.5. Pushable objektu (Akmeu) fizika\n    if (entity.subtype === 'pushable' || def?.isPushable) {\n      const inLiquid = liquidSample.inLiquid;\n      const liquidType = liquidSample.type;\n\n      // Skaas, ja iekrt idrum\n      if (inLiquid && !entity.prevInLiquid) {\n        if (liquidType === 'water' && def.sounds?.water_splash) {\n          playSfx(def.sounds.water_splash, 0.4);\n        } else if (liquidType === 'lava' && def.sounds?.lava_splash) {\n          playSfx(def.sounds.lava_splash, 0.4);\n        }\n      }\n      entity.prevInLiquid = inLiquid;\n\n        // Horizontl kustba ar berzi\n        const mh = moveHorizontal({\n          keys: {}, \n          state: { x: entity.x, y: entity.y, vx: entity.vx || 0, width: entity.width, height: entity.height, direction: entity.direction },\n          MOVE_SPEED: 6.0, // Palielints max trums akmeiem (Supaplex stil)\n          TILE_SIZE,\n          mapWidth,\n          mapHeight,\n          checkCollision: (nx, ny, mw, mh, w, h) => {\n            // Prbaudm statisko pasauli un citas enttijas\n            if (checkCollision(nx, ny, mw, mh, w, h, entity.id)) return true;\n            \n            // Prbaudm kolziju ar spltju\n            const p = gameState.current;\n            const ew = w || entity.width;\n            const eh = h || entity.height;\n            return (nx < p.x + p.width && nx + ew > p.x && ny < p.y + p.height && ny + eh > p.y);\n          },\n          friction: inLiquid ? 0.7 : 0.85,\n          acceleration: 0.2\n        });\n        entity.x = mh.x;\n        entity.vx = mh.vx;\n        entity.direction = mh.direction;\n\n      // Vertikl fizika\n      if (inLiquid && liquidType === 'lava') {\n        // Lna slkana lav\n        const sinkingSpeed = def.sinkingSpeed || 0.2;\n        entity.vy = sinkingSpeed;\n        entity.y += entity.vy;\n        entity.isGrounded = false;\n        \n        // Prbaudm vai neesam izgjui cauri zemei lav\n        if (checkCollision(entity.x, entity.y, mapWidth, mapHeight, entity.width, entity.height, entity.id)) {\n           // Atstumjam atpaka, ja atduras pret dibenu\n           entity.y -= entity.vy;\n           entity.vy = 0;\n           entity.isGrounded = true;\n        }\n      } else {\n        // Fall distance tracking: if falling, accumulate distance\n        if (entity.isGrounded) {\n          entity.fallDistance = 0;\n        } else if ((entity.vy || 0) > 0) {\n          entity.fallDistance = (entity.fallDistance || 0) + (entity.vy || 0);\n        }\n\n        // Standarta gravitcija (den lnka)\n        const vp = applyVerticalPhysics({\n          keys: {}, \n          x: entity.x,\n          y: entity.y,\n          vy: entity.vy || 0,\n          isGrounded: entity.isGrounded,\n          animation: 'idle',\n          GRAVITY: inLiquid ? GRAVITY * 0.3 : GRAVITY,\n          TERMINAL_VELOCITY,\n          JUMP_FORCE: 0,\n          TILE_SIZE,\n          width: entity.width,\n          height: entity.height,\n          mapWidth,\n          mapHeight,\n          checkCollision: (nx, ny, mw, mh, w, h) => {\n            // 1. Prbaudm statisko pasauli un citas enttijas\n            if (checkCollision(nx, ny, mw, mh, w, h, entity.id)) {\n              // Ja ms kaut kam uzkrtam un esam kritui pietiekami ilgi\n              if ((entity.fallDistance || 0) >= TILE_SIZE * 0.8) {\n                // Atrodam kuru enttiju ms aizskrm (lai nogalintu ienaidniekus)\n                if (entitiesRef.current) {\n                  for (const other of entitiesRef.current) {\n                    if (other.id === entity.id || other.health <= 0 || other.subtype === 'platform' || other.subtype === 'pushable') continue;\n                    \n                    const hitOther = (\n                      nx < other.x + other.width &&\n                      nx + (w || entity.width) > other.x &&\n                      ny < other.y + other.height &&\n                      ny + (h || entity.height) > other.y\n                    );\n                    \n                    if (hitOther) {\n                      other.health = 0; // Nogalinm ienaidnieku\n                      // Vartu atskaot skau, ja tda definta\n                      if (def.sounds?.kill_enemy) {\n                        playSfx(def.sounds.kill_enemy, 0.5);\n                      }\n                    }\n                  }\n                }\n              }\n              return true;\n            }\n            \n            // 2. Prbaudm kolziju ar spltju\n            const p = gameState.current;\n            const ew = w || entity.width;\n            const eh = h || entity.height;\n            const hitPlayer = (nx < p.x + p.width && nx + ew > p.x && ny < p.y + p.height && ny + eh > p.y);\n            \n            if (hitPlayer) {\n              // Ja akmens uzkrt spltjam pc brva kritiena (vismaz 1 tuks bloks)\n              if ((entity.fallDistance || 0) >= TILE_SIZE * 0.8) {\n                gameState.current.health = 0; // Fatal impact\n              }\n              return true;\n            }\n            \n            return false;\n          },\n          isLiquidAt,\n          vx: entity.vx\n        });\n        entity.y = vp.y;\n        entity.vy = vp.vy;\n        entity.isGrounded = vp.isGrounded;\n\n        // --- ROLLING LOGIC (Supaplex style) ---\n        // Akmei ripo lej no citiem apaiem objektiem vai pakpieniem, ja ir brva vieta sn un pa diagonli\n        if (entity.isGrounded && Math.abs(entity.vx) < 0.1 && def.isRound) {\n          const checkEmpty = (tx, ty) => !checkCollision(tx, ty, mapWidth, mapHeight, entity.width, entity.height, entity.id);\n          \n          // Minm ripot pa KREISI\n          const leftX = entity.x - TILE_SIZE;\n          // canRollLeft: vai flze pa kreisi ir brva UN vai flze pa kreisi uz leju ir brva (tukums/pakpiens)\n          const canRollLeft = checkEmpty(leftX, entity.y) && checkEmpty(leftX, entity.y + TILE_SIZE);\n          \n          if (canRollLeft) {\n            // Ripojam pa kreisi. Palielints trums (6.0), lai \"veas\" trk\n            entity.vx = -6.0; \n          } else {\n            // Minm ripot pa LABI\n            const rightX = entity.x + TILE_SIZE;\n            const canRollRight = checkEmpty(rightX, entity.y) && checkEmpty(rightX, entity.y + TILE_SIZE);\n            if (canRollRight) {\n              entity.vx = 6.0;\n            }\n          }\n        }\n\n        // Atjaunojam rotciju, ja akmens veas (horizontal movement while grounded)\n        if (entity.isGrounded && Math.abs(entity.vx) > 0.1 && def.isRound) {\n          // Rotcija proporcionla trumam (0.07 rad/px * vx)\n          entity.rotation = (entity.rotation || 0) + (entity.vx * (deltaMs / 16.67) * 0.07);\n        } else if (!entity.isGrounded && def.isRound) {\n          // Ar krtot var nedaudz rott, ja ir bijis horizontls trums\n          entity.rotation = (entity.rotation || 0) + (entity.vx * (deltaMs / 16.67) * 0.03);\n        }\n      }\n\n      // Animcija akmenim parasti ir statiska\n      entity.animation = 'idle';\n      entity.currentSpriteIndex = def.spriteSheet?.animations?.idle?.[0] || 0;\n\n      continue;\n    }\n\n    // Platformu loika\n    if (entity.subtype === 'platform') {\n      const speed = def.speed || 1.5;\n      const mapW = mapWidth;\n      const mapH = mapHeight;\n      \n      // Mekljam bultias vairkos punktos (centr un mals), lai nepalaistu garm\n      const points = [\n        { x: entity.x + entity.width / 2, y: entity.y + entity.height / 2 }, // Centrs\n        { x: entity.x + 5, y: entity.y + entity.height / 2 },                // Kreis mala\n        { x: entity.x + entity.width - 5, y: entity.y + entity.height / 2 }  // Lab mala\n      ];\n      \n      let arrowId = null;\n      let foundArrowDef = null;\n\n      for (const p of points) {\n        const tx = Math.floor(p.x / TILE_SIZE);\n        const ty = Math.floor(p.y / TILE_SIZE);\n        \n        if (tx < 0 || tx >= mapW || ty < 0 || ty >= mapH) continue;\n        const idx = ty * mapW + tx;\n\n        // 1. Specilais arrows slnis\n        const arrowsLayer = ctx.mapData?.layers?.find(l => l.name === 'arrows' || l.name === 'Arrows')?.data;\n        let id = arrowsLayer ? arrowsLayer[idx] : null;\n        \n        // 2. Objektu slnis\n        if (!id && ctx.objectData) {\n          id = ctx.objectData[idx];\n        }\n\n        if (id) {\n          const aDef = getDefById(ctx.registryItems, id);\n          if (aDef && aDef.subtype === 'arrow') {\n            arrowId = id;\n            foundArrowDef = aDef;\n            break; \n          }\n        }\n      }\n      \n      if (foundArrowDef) {\n        // Mainm kustbas virzienu atbilstoi bultiai\n        if (foundArrowDef.direction === 'up') { entity.vx = 0; entity.vy = -speed; }\n        else if (foundArrowDef.direction === 'down') { entity.vx = 0; entity.vy = speed; }\n        else if (foundArrowDef.direction === 'left') { entity.vx = -speed; entity.vy = 0; }\n        else if (foundArrowDef.direction === 'right') { entity.vx = speed; entity.vy = 0; }\n      }\n\n      // Ja platforma vl nekustas, iedodam tai skuma impulsu\n      if (entity.vx === 0 && entity.vy === 0) {\n        entity.vx = speed;\n      }\n\n      // Kustba\n      let nextX = entity.x + entity.vx * (deltaMs / 16.6);\n      let nextY = entity.y + entity.vy * (deltaMs / 16.6);\n      \n      // Robeu prbaude (neaujam aizbraukt aiz kartes)\n      const worldW = mapWidth * TILE_SIZE;\n      const worldH = mapHeight * TILE_SIZE;\n      \n      if (nextX < 0) { \n        nextX = 0; \n        entity.vx = Math.abs(entity.vx); // Move Right\n      } else if (nextX + entity.width > worldW) { \n        nextX = worldW - entity.width; \n        entity.vx = -Math.abs(entity.vx); // Move Left\n      }\n      \n      if (nextY < 0) { \n        nextY = 0; \n        entity.vy = Math.abs(entity.vy); // Move Down\n      } else if (nextY + entity.height > worldH) { \n        nextY = worldH - entity.height; \n        entity.vy = -Math.abs(entity.vy); // Move Up\n      }\n      \n      entity.x = nextX;\n      entity.y = nextY;\n\n      // Spltja \"prveana\"\n      const player = gameState.current;\n      const onPlatform = (\n        player.x + player.width > entity.x &&\n        player.x < entity.x + entity.width &&\n        Math.abs((player.y + player.height) - entity.y) < 5 &&\n        player.vy >= 0\n      );\n\n      if (onPlatform) {\n        player.x += entity.vx * (deltaMs / 16.6);\n        player.y = entity.y - player.height;\n        player.vy = 0;\n        player.isGrounded = true;\n        \n        // Atjauninam animciju, lai nebtu \"fall\" uz platformas\n        if (Math.abs(player.vx) > 0.1) {\n          player.animation = 'run';\n        } else {\n          player.animation = 'idle';\n        }\n      }\n\n      continue;\n    }\n\n    const ai = def.ai || {};\n    const reactionDist = (ai.reactionDistance || 10) * TILE_SIZE;\n    const shootDist = (ai.shootDistance || 8) * TILE_SIZE;\n    const speed = def.speed || 1.2;\n\n    const dx = playerX - entity.x;\n    const dy = playerY - entity.y;\n    const dist = Math.sqrt(dx * dx + dy * dy);\n\n    let keys = { a: false, d: false, w: false };\n\n    // 2. AI Uzvedba\n    if (dist < reactionDist) {\n      // Sekojam spltjam\n      if (dx > TILE_SIZE * 0.5) {\n          keys.d = true;\n          entity.direction = 1;\n      } else if (dx < -TILE_SIZE * 0.5) {\n          keys.a = true;\n          entity.direction = -1;\n      }\n\n      // Lkana, ja AI to atbalsta un priek ir rslis\n      if (ai.canJump && entity.isGrounded) {\n          const nextX = entity.x + entity.direction * 10;\n          if (checkCollision(nextX, entity.y, mapWidth, mapHeight, entity.width, entity.height)) {\n              keys.w = true;\n          }\n      }\n\n      // auana\n      if (dist < shootDist) {\n        if (entity.shootCooldown <= 0) {\n           const facingPlayer = (dx > 0 && entity.direction > 0) || (dx < 0 && entity.direction < 0);\n           // Tanks auj, ja skats uz spltju vai ja tas ir pietiekami tuvu\n           if (facingPlayer || dist < TILE_SIZE * 2) {\n             entity.isShooting = true;\n             entity.shootCooldown = ai.shootCooldown || 2000;\n             \n             // Izsaucam via izveidi\n             if (typeof spawnProjectile === 'function') {\n                // Novietojam viu rpus tanka korpusa (atkarb no virziena)\n                const spawnX = entity.x + (entity.width / 2) + (entity.direction * (entity.width / 2 + 10));\n                const spawnY = entity.y + (entity.height * 0.4); // Nedaudz augstk par centru (stobrs)\n                \n                spawnProjectile(\n                  spawnX, \n                  spawnY, \n                  entity.direction,\n                  entity.id\n                );\n             }\n           }\n        }\n      }\n    } else if (ai.patrol) {\n      // Patruanas rems\n      if (entity.direction > 0) keys.d = true;\n      else keys.a = true;\n\n    // Sienas un ru prbaude, lai grieztos atpaka\n    const nextX = entity.x + entity.direction * 10;\n    let hitSomething = checkCollision(nextX, entity.y, mapWidth, mapHeight, entity.width, entity.height);\n\n    // Tanku specifisk kolzija (ar spltju un citiem tankiem)\n    if (!hitSomething && entity.subtype === 'tank') {\n      // 1. Prbaude ar spltju\n      const p = gameState.current;\n      if (nextX < p.x + p.width && nextX + entity.width > p.x && entity.y < p.y + p.height && entity.y + entity.height > p.y) {\n        hitSomething = true;\n      }\n\n      // 2. Prbaude ar citiem tankiem\n      if (!hitSomething) {\n        for (const other of entitiesRef.current) {\n          if (other === entity || other.health <= 0 || other.isExploding) continue;\n          if (other.subtype !== 'tank') continue;\n\n          if (nextX < other.x + other.width && nextX + entity.width > other.x && entity.y < other.y + other.height && entity.y + entity.height > other.y) {\n            hitSomething = true;\n            // Liekam ar otram tankam maint virzienu, ja tie brauc viens otram virs\n            if ((entity.direction > 0 && other.direction < 0) || (entity.direction < 0 && other.direction > 0)) {\n               other.direction *= -1;\n            }\n            break;\n          }\n        }\n      }\n    }\n\n    if (hitSomething) {\n      entity.direction *= -1;\n    }\n    \n    // Platformas malas prbaude\n      if (ai.stayOnPlatform && entity.isGrounded) {\n          const groundX = entity.x + (entity.direction > 0 ? entity.width : 0) + entity.direction * 5;\n          const groundY = entity.y + entity.height + 5;\n          if (!checkCollision(groundX, groundY, mapWidth, mapHeight, 2, 2)) {\n              entity.direction *= -1;\n          }\n      }\n    }\n\n    // Cooldown atjaunoana\n    if (entity.shootCooldown > 0) {\n      entity.shootCooldown -= deltaMs;\n      // Pc 300ms prtraucam auanas animciju\n      if (entity.shootCooldown < (ai.shootCooldown || 2000) - 300) {\n        entity.isShooting = false;\n      }\n    }\n\n    // 3. Fizika un kustba\n    const frameSpeed = speed * (deltaMs / 16.67);\n    \n    const checkEntityCollision = (nx, ny) => {\n        // Statisk pasaule\n        if (checkCollision(nx, ny, mapWidth, mapHeight, entity.width, entity.height)) return true;\n        \n        // Tankiem blojam ceu, ja priek ir spltjs vai cits tanks\n        if (entity.subtype === 'tank') {\n            const p = gameState.current;\n            if (nx < p.x + p.width && nx + entity.width > p.x && ny < p.y + p.height && ny + entity.height > p.y) return true;\n            \n            for (const other of entitiesRef.current) {\n                if (other === entity || other.health <= 0 || other.isExploding) continue;\n                if (other.subtype !== 'tank') continue;\n                if (nx < other.x + other.width && nx + entity.width > other.x && ny < other.y + other.height && ny + entity.height > other.y) return true;\n            }\n        }\n        return false;\n    };\n\n    const mh = moveHorizontal({\n      keys,\n      state: { \n        x: entity.x, \n        y: entity.y, \n        vx: entity.vx || 0,\n        width: entity.width, \n        direction: entity.direction \n      },\n      MOVE_SPEED: frameSpeed,\n      TILE_SIZE,\n      mapWidth,\n      mapHeight,\n      checkCollision: checkEntityCollision\n    });\n    entity.x = mh.x;\n    entity.vx = mh.vx;\n    entity.direction = mh.direction;\n\n    const vp = applyVerticalPhysics({\n      keys,\n      x: entity.x,\n      y: entity.y,\n      vy: entity.vy,\n      isGrounded: entity.isGrounded,\n      animation: entity.animation,\n      GRAVITY,\n      TERMINAL_VELOCITY,\n      JUMP_FORCE: ai.canJump ? 8 : 0,\n      TILE_SIZE,\n      width: entity.width,\n      height: entity.height,\n      mapWidth,\n      mapHeight,\n      checkCollision: checkEntityCollision,\n      isLiquidAt: ctx.isLiquidAt,\n      vx: entity.vx\n    });\n    entity.y = vp.y;\n    entity.vy = vp.vy;\n    entity.isGrounded = vp.isGrounded;\n\n    // 4. Animcijas stvoka noteikana\n    if (entity.isShooting) {\n      entity.animation = 'shoot';\n    } else if (entity.health <= (def.maxHealth || 100) * 0.5) {\n      entity.animation = 'move_damaged';\n    } else if (entity.vx === 0 && entity.isGrounded) {\n      entity.animation = 'idle';\n    } else {\n      entity.animation = 'move';\n    }\n\n    // Atjaunojam animcijas rmi, ja tas nav sprdziens\n    if (!entity.isExploding) {\n        const anims = def.spriteSheet?.animations || {};\n        let currentAnim = anims[entity.animation];\n        \n        // Rezerves varianti, ja specifisk animcija nav atrasta\n        if (!currentAnim || !Array.isArray(currentAnim) || currentAnim.length === 0) {\n            currentAnim = anims['move'] || anims['idle'] || [0];\n        }\n        \n        entity.animTimer = (entity.animTimer || 0) + deltaMs;\n        const frameDur = 100; // ms\n        if (entity.animTimer >= frameDur) {\n            entity.animTimer = 0;\n            entity.animFrame = (entity.animFrame || 0) + 1;\n            if (entity.animFrame >= currentAnim.length) {\n                entity.animFrame = 0;\n            }\n        }\n        entity.currentSpriteIndex = currentAnim[entity.animFrame % currentAnim.length];\n    } else {\n        const explodeAnim = def.spriteSheet?.animations?.explode || [39];\n        // Sprdziena animcija tiek vadta augstk (death sekcij)\n        entity.currentSpriteIndex = explodeAnim[Math.min(entity.animFrame, explodeAnim.length - 1)];\n    }\n\n    if (entity.shouldRemove) {\n      entities.splice(i, 1);\n    }\n  }\n}\n","// One-frame update orchestrator (migrated from GameEngine/updateFrame.js)\nimport { moveHorizontal } from '../physics/horizontal';\nimport { applyVerticalPhysics } from '../physics/vertical';\nimport { resolveInteractableContext } from '../gameplay/interactables/context';\nimport { tickLiquidDamage } from '../liquids/liquidUtils';\nimport { updateEntities } from '../gameplay/entities';\nimport { getWeatherDps, getMapWeather, getRadioactivityRates, weatherAffectsPlayer, weatherBlockedByCover } from '../gameplay/weatherDamage';\nimport { isCoveredFromAbove } from '../gameplay/weatherCover';\n\n// updateFrame(ctx, timestamp)  { continue: boolean }\n// ctx expects:\n// - mapData, objectData\n// - input\n// - refs: { gameState, isInitialized, lastTimeRef, projectilesRef, shootCooldownRef, liquidDamageAccumulatorRef, oxygenDepleteAccRef, lavaDepleteAccRef }\n// - constants: { TILE_SIZE, GRAVITY, TERMINAL_VELOCITY, MOVE_SPEED, JUMP_FORCE }\n// - helpers: { checkCollision, isLiquidAt, getLiquidSample }\n// - actions: {\n//     collectItem(x, y, mapWidth, objectData),\n//     checkHazardDamage(x, y, mapWidth, objectData, deltaMs),\n//     spawnProjectile(originX, originY, direction),\n//     updateProjectiles(deltaMs, mapWidth, mapHeight),\n//     setPlayer(nextState),\n//     onGameOver()\n//   }\nexport function updateFrame(ctx, timestamp) {\n  const {\n    mapData,\n    objectData,\n    input,\n    refs,\n    constants,\n    helpers,\n    actions,\n    registryItems\n  } = ctx;\n\n  const { gameState, isInitialized, lastTimeRef, projectilesRef, entitiesRef, shootCooldownRef, liquidDamageAccumulatorRef, oxygenDepleteAccRef, lavaDepleteAccRef, weatherDamageAccRef, activeRoomIdsRef } = refs;\n  const { TILE_SIZE, GRAVITY, TERMINAL_VELOCITY, MOVE_SPEED, JUMP_FORCE } = constants;\n  const { checkCollision, isLiquidAt, getLiquidSample } = helpers;\n  const { collectItem, checkInteractables, checkHazardDamage, checkSecrets, spawnProjectile, playSfx, updateProjectiles, setPlayer, onGameOver } = actions;\n\n  // Keep RAF alive even if init not finished yet\n  if (!isInitialized.current || !mapData) {\n    return { continue: true };\n  }\n\n  // Delta time ms\n  if (!lastTimeRef.current) {\n    lastTimeRef.current = timestamp;\n  }\n  const deltaMs = timestamp - lastTimeRef.current;\n  lastTimeRef.current = timestamp;\n\n  // Pause while terminal is open\n  try {\n    if (window.__GAME_TERMINAL_OPEN__) {\n      return { continue: true };\n    }\n  } catch {}\n\n  const mapWidth = mapData.meta?.width || mapData.width || 20;\n  const mapHeight = mapData.meta?.height || mapData.height || 15;\n  const keys = input.current;\n\n  let {\n    x,\n    y,\n    vx,\n    vy,\n    width,\n    height,\n    isGrounded,\n    direction,\n    animation,\n    ammo,\n    iceResist,\n    maxIceResist\n  } = gameState.current;\n\n  const dt = Math.max(0, deltaMs || 0);\n  const physicsDt = Math.min(dt, 100);\n\n  // 0.5) Resources update (before physics to affect them)\n  // Ice resistance depletion: drains while on slippery surface; regenerates otherwise\n  const layers = ctx.mapData.layers || [];\n  const backgroundLayer = layers.find(l => l.name === 'background')?.data || [];\n  const secretLayer = layers.find(l => l.name === 'secrets' || l.type === 'secret')?.data || [];\n  const objectMetadata = mapData.meta?.objectMetadata || {};\n  const surface = helpers.getSurfaceProperties ? helpers.getSurfaceProperties(x, y, width, height, mapWidth, mapHeight, TILE_SIZE, backgroundLayer, ctx.registryItems) : { friction: 0.8, acceleration: 0.2 };\n  \n  const isSlippery = surface.friction >= 0.9;\n  let currentIceRes = Number(iceResist);\n  const maxIce = Math.max(1, Number(maxIceResist || 100));\n  if (!Number.isFinite(currentIceRes)) currentIceRes = maxIce;\n\n  if (isSlippery) {\n    currentIceRes -= (20 * dt) / 1000;\n  } else {\n    currentIceRes += (35 * dt) / 1000;\n  }\n  currentIceRes = Math.max(0, Math.min(maxIce, currentIceRes));\n  gameState.current.iceResist = currentIceRes;\n\n  let effectiveFriction = surface.friction;\n  if (isSlippery && currentIceRes > 0) {\n      const ratio = currentIceRes / maxIce;\n      const targetFriction = 0.8;\n      effectiveFriction = surface.friction - (surface.friction - targetFriction) * ratio;\n  }\n\n  // 1) Horizontal movement\n  const checkCollisionExtended = (nx, ny, mw, mh, w, h) => {\n    return checkCollision(nx, ny, mw, mh, w, h);\n  };\n\n  const mh = moveHorizontal({\n    keys,\n    state: { x, y, vx, width, direction, height },\n    MOVE_SPEED,\n    TILE_SIZE,\n    mapWidth,\n    mapHeight,\n    checkCollision: checkCollisionExtended,\n    friction: effectiveFriction,\n    acceleration: isSlippery ? (currentIceRes > 0 ? 0.15 : surface.acceleration) : surface.acceleration,\n    deltaMs: physicsDt\n  });\n  x = mh.x; vx = mh.vx; direction = mh.direction;\n\n  // 1.1) Pushable objects logic (Stone pushing)\n  let isPushing = false;\n  let pushTarget = null;\n  \n  const currentStrength = gameState.current.strength || 30;\n  const isAlreadyAtMax = currentStrength >= 99;\n  const lastPushTime = gameState.current.lastPushTime || 0;\n  const gracePeriod = 300; // ms, kur strength nesamazins pat ja kontakts pazd uz brdi\n\n  if (entitiesRef.current) {\n    // Ja jau stumjam ar pilnu jaudu, esam pielaidgki pret attlumu (histerze), \n    // lai kompenstu nelielas fizikas dzinja nobdes.\n    const pushDist = isAlreadyAtMax ? 15 : 5;\n    const overlapDist = isAlreadyAtMax ? 12 : 5;\n\n    for (const ent of entitiesRef.current) {\n      if (ent.subtype === 'pushable' || ent.def?.isPushable) {\n        // Prbaudm vai spltjs ir blakus akmenim\n        const isNextToLeft = (x + width + pushDist > ent.x) && (x + width <= ent.x + overlapDist) && (y + height > ent.y + 2) && (y < ent.y + ent.height - 2);\n        const isNextToRight = (x - pushDist < ent.x + ent.width) && (x >= ent.x + ent.width - overlapDist) && (y + height > ent.y + 2) && (y < ent.y + ent.height - 2);\n\n        if ((isNextToLeft && keys.d) || (isNextToRight && keys.a)) {\n          isPushing = true;\n          pushTarget = ent;\n          break;\n        }\n      }\n    }\n  }\n\n  if (isPushing) {\n    gameState.current.strength = Math.min(100, currentStrength + (65 * dt) / 1000); // Aug par ~65% sekund\n    if (gameState.current.strength >= 100 && pushTarget) {\n      // Pastumjam akmeni\n      const pushForce = 2.0;\n      pushTarget.vx = (x < pushTarget.x ? 1 : -1) * pushForce;\n      gameState.current.lastPushTime = timestamp; \n      \n      // Atskaojam skau\n      if (pushTarget.def?.sounds?.push && (!pushTarget.lastPushSoundTime || timestamp - pushTarget.lastPushSoundTime > 450)) {\n        playSfx(pushTarget.def.sounds.push, 0.3);\n        pushTarget.lastPushSoundTime = timestamp;\n      }\n    }\n  } else {\n    // Prbaudm grace periodu pirms skam samazint spku\n    const timeSincePush = timestamp - lastPushTime;\n    if (timeSincePush > gracePeriod) {\n      if (currentStrength > 30) {\n        gameState.current.strength = Math.max(30, currentStrength - (35 * dt) / 1000);\n      } else {\n        gameState.current.strength = 30;\n      }\n    }\n  }\n\n  // 1.9) Ladder check (allow climbing when overlapping ladder objects)\n  const getDefById = (id) => {\n    if (!id) return null;\n    const map = registryItems && registryItems.__byId;\n    if (map && typeof map.get === 'function') return map.get(id) || null;\n    return Array.isArray(registryItems) ? registryItems.find(r => r.id === id) : null;\n  };\n\n  const findLadderAtPlayer = () => {\n    if (!objectData || !registryItems) return null;\n    const centerX = x + width / 2;\n    const centerY = y + height / 2;\n    const ctxResolved = resolveInteractableContext({\n      mapData,\n      mapWidth,\n      mapHeight,\n      objectLayerData: objectData,\n      mainObjectMetadata: objectMetadata,\n      secretMapData: secretLayer,\n      activeRoomIds: activeRoomIdsRef.current || mapData?.meta?.activeRoomIds,\n      centerX,\n      centerY,\n      TILE_SIZE\n    });\n    const { activeObjectData, activeMetadata, activeMapWidth, activeMapHeight, offsetX, offsetY } = ctxResolved;\n    if (!activeObjectData) return null;\n    const localX = centerX - offsetX;\n    const localY = centerY - offsetY;\n    const gridX = Math.floor(localX / TILE_SIZE);\n    const gridY = Math.floor(localY / TILE_SIZE);\n    if (gridX < 0 || gridY < 0 || gridX >= activeMapWidth || gridY >= activeMapHeight) return null;\n    let idx = gridY * activeMapWidth + gridX;\n    let objId = activeObjectData[idx];\n    if (!objId && activeMetadata) {\n      for (const [idxStr, meta] of Object.entries(activeMetadata)) {\n        const baseIdx = parseInt(idxStr, 10);\n        const w = meta.width || 1;\n        const h = meta.height || 1;\n        if (w <= 1 && h <= 1) continue;\n        const ox = baseIdx % activeMapWidth;\n        const oy = Math.floor(baseIdx / activeMapWidth);\n        if (gridX >= ox && gridX < ox + w && gridY >= oy && gridY < oy + h) {\n          objId = activeObjectData[baseIdx];\n          idx = baseIdx;\n          break;\n        }\n      }\n    }\n    if (!objId) return null;\n    const def = getDefById(objId);\n    if (!def) return null;\n    const isLadder = !!(def.flags?.ladder || def.subtype === 'ladder' || def.type === 'ladder');\n    if (!isLadder) return null;\n    return { def, index: idx };\n  };\n\n  const ladderInfo = findLadderAtPlayer();\n\n  // 2) Vertical physics\n  let vp = null;\n  let remaining = physicsDt;\n  let steps = 0;\n  let prevInWater = !!gameState.current.inWater;\n  if (ladderInfo && !keys?.space) {\n    const ladderSpeed = Math.max(40, Number(ladderInfo.def?.ladder?.speed) || 120);\n    const climbDir = (keys.w ? -1 : 0) + (keys.s ? 1 : 0);\n    if (climbDir !== 0) {\n      const proposedY = y + (climbDir * ladderSpeed) * (physicsDt / 1000);\n      if (!checkCollisionExtended(x, proposedY, mapWidth, mapHeight, width, height)) {\n        y = proposedY;\n      }\n      animation = 'climb';\n    }\n    vy = 0;\n    isGrounded = false;\n    vp = { y, vy, isGrounded, animation, inWater: false, headUnderWater: false, atSurface: false };\n  } else {\n    while (remaining > 0 && steps < 10) {\n      const stepMs = Math.min(16.67, remaining);\n      vp = applyVerticalPhysics({\n        keys,\n        x,\n        y,\n        vy,\n        isGrounded,\n        animation,\n        GRAVITY,\n        TERMINAL_VELOCITY,\n        JUMP_FORCE,\n        TILE_SIZE,\n        width,\n        height,\n        mapWidth,\n        mapHeight,\n        checkCollision: checkCollisionExtended,\n        vx,\n        isLiquidAt: (wx, wy) => {\n          try { return typeof isLiquidAt === 'function' ? isLiquidAt(wx, wy) : null; } catch { return null; }\n        },\n        prevInWater,\n        deltaMs: stepMs\n      });\n      y = vp.y; vy = vp.vy; isGrounded = vp.isGrounded; animation = vp.animation;\n      prevInWater = !!vp.inWater;\n      remaining -= stepMs;\n      steps++;\n    }\n  }\n  const inWater = !!(vp ? vp.inWater : gameState.current.inWater);\n  const headUnderWater = !!(vp ? vp.headUnderWater : gameState.current.headUnderWater);\n  const atSurface = !!(vp ? vp.atSurface : gameState.current.atSurface);\n\n  // 2.5) Generic liquid sampling (water, lava, etc.)\n  let liquidType = null;\n  let liquidParams = null;\n  if (typeof getLiquidSample === 'function') {\n    try {\n      const sample = getLiquidSample({ x, y, width, height, TILE_SIZE, mapWidth, mapHeight });\n      if (sample && sample.inLiquid) {\n        liquidType = sample.type || null;\n        liquidParams = sample.params || null;\n      }\n      // Reset DPS accumulator if we just left liquids\n      if (!sample || !sample.inLiquid) {\n        if (liquidDamageAccumulatorRef) liquidDamageAccumulatorRef.current = 0;\n      }\n    } catch {}\n  }\n\n  // Extra horizontal damping when in liquids\n  if (inWater || liquidType) {\n    if (liquidType === 'lava') {\n      vx *= 0.78;\n    } else if (liquidType === 'quicksand') {\n      vx *= 0.72; // Quicksand is very thick\n    } else {\n      vx *= 0.82;\n    }\n  }\n\n  // 2.6) Apply liquid damage-per-second if defined (e.g., lava)\n  // Will be gated later for lava by resistance depletion; water dps usually 0.\n\n    const resourceParams = liquidParams?.resources || {};\n    const parseNumber = (v) => (v === null || v === undefined || v === '') ? null : Number(v);\n\n  // 2.7) Resource bars logic (oxygen & lava resistance indicators)\n  try {\n    // Initialize defaults if missing\n    const maxOxy = Math.max(1, Number(gameState.current.maxOxygen || 100));\n    const maxLava = Math.max(1, Number(gameState.current.maxLavaResist || 100));\n    let oxy = Number(gameState.current.oxygen);\n    let lavaRes = Number(gameState.current.lavaResist);\n    if (!Number.isFinite(oxy)) oxy = maxOxy;\n    if (!Number.isFinite(lavaRes)) lavaRes = maxLava;\n    // Resolve per-liquid parameters (with safe defaults)\n    const oxyParams = resourceParams.oxygen || liquidParams?.oxygen || { drainPerSecond: 20, regenPerSecond: 35, damagePerSecondWhenDepleted: 10 };\n    const lavaParams = resourceParams.lavaResist || liquidParams?.resistance || { drainPerSecond: 25, regenPerSecond: 40, damagePerSecondWhenDepleted: 15 };\n    const iceParams = resourceParams.iceResist;\n    const strengthParams = resourceParams.strength;\n\n    // Oxygen: drains only while head is under water; otherwise regenerates to 100 even after leaving water\n    const oxygenApplies = !!(resourceParams.oxygen || liquidType === 'water' || liquidType === 'quicksand' || liquidType === 'radioactive_water' || liquidType === 'waterfall' || liquidType === 'radioactive_waterfall');\n    const oxygenEnabled = oxyParams?.enabled !== false;\n    const oxyDrain = parseNumber(oxyParams?.drainPerSecond);\n    const oxyRegen = parseNumber(oxyParams?.regenPerSecond);\n    if (oxygenEnabled && headUnderWater && oxygenApplies && Number.isFinite(oxyDrain)) {\n      oxy -= (Math.max(0, oxyDrain) * dt) / 1000;\n    } else if (oxygenEnabled) {\n      oxy += (Math.max(0, Number.isFinite(oxyRegen) ? oxyRegen : 0) * dt) / 1000;\n    }\n    // Clamp and write back\n    oxy = Math.max(0, Math.min(maxOxy, oxy));\n    gameState.current.oxygen = oxy;\n    gameState.current.maxOxygen = maxOxy;\n\n    // Lava resist depletion while in lava; regenerates outside\n    const lavaApplies = !!(resourceParams.lavaResist || liquidType === 'lava' || liquidType === 'lava_waterfall');\n    const lavaEnabled = lavaParams?.enabled !== false;\n    const lavaDrain = parseNumber(lavaParams?.drainPerSecond);\n    const lavaRegen = parseNumber(lavaParams?.regenPerSecond);\n    if (lavaEnabled && lavaApplies && liquidType && liquidType.includes('lava') && Number.isFinite(lavaDrain)) {\n      lavaRes -= (Math.max(0, lavaDrain) * dt) / 1000;\n    } else if (lavaEnabled) {\n      lavaRes += (Math.max(0, Number.isFinite(lavaRegen) ? lavaRegen : 0) * dt) / 1000;\n    }\n    lavaRes = Math.max(0, Math.min(maxLava, lavaRes));\n    gameState.current.lavaResist = lavaRes;\n    gameState.current.maxLavaResist = maxLava;\n\n    // Ice resist & strength can be optionally affected by liquids\n    const applyResource = (key, maxKey, params) => {\n      if (!params || params.enabled === false) return;\n      const drain = parseNumber(params.drainPerSecond);\n      const regen = parseNumber(params.regenPerSecond);\n      if (!Number.isFinite(drain) && !Number.isFinite(regen)) return;\n      const maxVal = Math.max(1, Number(gameState.current[maxKey] || 100));\n      let cur = Number(gameState.current[key]);\n      if (!Number.isFinite(cur)) cur = maxVal;\n      if (inWater || liquidType) {\n        if (Number.isFinite(drain)) cur -= (Math.max(0, drain) * dt) / 1000;\n      } else if (Number.isFinite(regen)) {\n        cur += (Math.max(0, regen) * dt) / 1000;\n      }\n      cur = Math.max(0, Math.min(maxVal, cur));\n      gameState.current[key] = cur;\n      gameState.current[maxKey] = maxVal;\n    };\n\n    applyResource('iceResist', 'maxIceResist', iceParams);\n    applyResource('strength', 'maxStrength', strengthParams);\n\n    // Radioactivity: fills up in radioactive liquid; slowly returns to 20% outside\n    const weatherNow = getMapWeather(mapData);\n    const radioFogInt = Number(weatherNow.radioactiveFog || 0);\n    const fogActive = weatherAffectsPlayer('radioactiveFog') && radioFogInt > 0;\n    const maxRadio = Math.max(1, Number(gameState.current.maxRadioactivity || 100));\n    let radio = Number(gameState.current.radioactivity);\n    if (!Number.isFinite(radio)) radio = maxRadio * 0.2;\n\n    const radioParams = resourceParams.radioactivity;\n    const radioEnabled = radioParams?.enabled !== false;\n    const radioBaseline = Number.isFinite(parseNumber(radioParams?.baselinePercent)) ? Math.max(0, Math.min(1, parseNumber(radioParams?.baselinePercent))) : 0.2;\n    const radioGain = Number.isFinite(parseNumber(radioParams?.gainPerSecond)) ? Math.max(0, parseNumber(radioParams?.gainPerSecond)) : (liquidType === 'radioactive_water' || liquidType === 'radioactive_waterfall' ? 15 : 0);\n    const radioDecay = Number.isFinite(parseNumber(radioParams?.decayPerSecond)) ? Math.max(0, parseNumber(radioParams?.decayPerSecond)) : 5;\n    const radioRecover = Number.isFinite(parseNumber(radioParams?.recoverPerSecond)) ? Math.max(0, parseNumber(radioParams?.recoverPerSecond)) : 2;\n    const radioApplies = !!(radioParams || liquidType === 'radioactive_water' || liquidType === 'radioactive_waterfall');\n\n    if (radioEnabled && radioApplies && (liquidType === 'radioactive_water' || liquidType === 'radioactive_waterfall')) {\n      radio += (radioGain * dt) / 1000; \n    } else if (radioEnabled && !fogActive) {\n      const baseline = maxRadio * radioBaseline;\n      if (radio > baseline) {\n        radio -= (radioDecay * dt) / 1000;\n      } else if (radio < baseline) {\n        radio += (radioRecover * dt) / 1000;\n      }\n    }\n\n    // Radioactivity resource changes from fog (deplete while fog is active)\n    if (weatherAffectsPlayer('radioactiveFog')) {\n      const rates = getRadioactivityRates();\n      if (radioFogInt > 0 && rates.increase > 0) {\n        const dec = (radioFogInt / 100) * rates.increase * (dt / 1000);\n        radio -= dec;\n      } else if (radioFogInt <= 0 && rates.decay > 0 && !fogActive) {\n        const inc = rates.decay * (dt / 1000);\n        radio += inc;\n      }\n    }\n\n    radio = Math.max(0, Math.min(maxRadio, radio));\n    gameState.current.radioactivity = radio;\n    gameState.current.maxRadioactivity = maxRadio;\n\n    // Apply depletion health damage when at zero and still in corresponding liquid\n    const tickDepleteDps = (accRef, dpsValue) => {\n      const v = Math.max(0, Number(dpsValue) || 0);\n      if (v <= 0) { accRef.current = 0; return; }\n      accRef.current += dt;\n      const T = 1000;\n      while (accRef.current >= T) {\n        accRef.current -= T;\n        gameState.current.health = Math.max(0, (Number(gameState.current.health) || 0) - v);\n        // Hit flash\n        const HIT_FLASH_MS = 500;\n        const prev = Number(gameState.current.hitTimerMs) || 0;\n        gameState.current.hitTimerMs = Math.max(prev, HIT_FLASH_MS);\n      }\n    };\n\n    // Oxygen depleted and still underwater  damage\n    if ((headUnderWater && oxygenApplies) && oxy <= 0) {\n      tickDepleteDps(oxygenDepleteAccRef, oxyParams.damagePerSecondWhenDepleted);\n    } else if (oxygenDepleteAccRef) {\n      oxygenDepleteAccRef.current = 0;\n    }\n\n    // Lava resist depleted and still in lava  health damage model is gated by base DPS below\n    if ((liquidType === 'lava' || liquidType === 'lava_waterfall') && lavaRes <= 0) {\n      if (lavaDepleteAccRef) lavaDepleteAccRef.current = 0;\n    } else if (lavaDepleteAccRef) {\n      lavaDepleteAccRef.current = 0;\n    }\n\n    // Weather damage (Lava Rain, Radioactive Fog)\n    const weather = weatherNow || getMapWeather(mapData);\n    const lavaRainInt = Number(weather.lavaRain || 0);\n\n    let lavaDps = weatherAffectsPlayer('lavaRain') ? getWeatherDps('lavaRain', lavaRainInt) : 0;\n    const radioDps = weatherAffectsPlayer('radioactiveFog') ? getWeatherDps('radioactiveFog', radioFogInt) : 0;\n    if (lavaDps > 0 && (inWater || (liquidType && liquidType.includes('water')))) {\n      lavaDps = 0;\n    }\n    if (lavaDps > 0 && weatherBlockedByCover('lavaRain')) {\n      try {\n        const tileData = backgroundLayer;\n        const secretData = secretLayer;\n        const covered = isCoveredFromAbove({\n          x: x + width / 2,\n          y,\n          mapWidth,\n          mapHeight,\n          TILE_SIZE,\n          tileData,\n          registryItems: ctx.registryItems,\n          secretData,\n          objectData,\n          objectMetadata,\n          maps: mapData.maps,\n          activeRoomIds: activeRoomIdsRef?.current || mapData.meta?.activeRoomIds\n        });\n        if (covered) lavaDps = 0;\n      } catch {}\n    }\n    const effectiveRadioDps = (radioDps > 0 && Number(radio) <= 0) ? radioDps : 0;\n    const totalWeatherDps = lavaDps + effectiveRadioDps;\n\n    if (totalWeatherDps > 0) {\n      weatherDamageAccRef.current += dt;\n      if (weatherDamageAccRef.current >= 1000) {\n        weatherDamageAccRef.current -= 1000;\n        gameState.current.health = Math.max(0, (Number(gameState.current.health) || 0) - totalWeatherDps);\n        const HIT_FLASH_MS = 500;\n        gameState.current.hitTimerMs = Math.max(Number(gameState.current.hitTimerMs) || 0, HIT_FLASH_MS);\n        if (actions.onStateUpdate) {\n          actions.onStateUpdate('playerDamage', {\n            damage: totalWeatherDps,\n            x: x + width / 2,\n            y\n          });\n        }\n      }\n    } else {\n      weatherDamageAccRef.current = 0;\n    }\n\n  } catch {}\n\n  // 2.8) Base liquid DPS (e.g., lava)  only after resource logic so we can gate by resistance\n  const healthEnabled = resourceParams?.health?.enabled !== false;\n  const healthDpsOverride = (healthEnabled && resourceParams?.health && resourceParams.health.damagePerSecond !== null && resourceParams.health.damagePerSecond !== undefined)\n    ? Number(resourceParams.health.damagePerSecond)\n    : null;\n  const effectiveDps = Number.isFinite(healthDpsOverride) ? Math.max(0, healthDpsOverride) : Number(liquidParams?.dps);\n  if (liquidType && liquidParams && Number(effectiveDps) > 0) {\n    try {\n      if (liquidType && liquidType.includes('lava')) {\n        const curRes = Math.max(0, Number(gameState.current.lavaResist));\n        if (curRes <= 0) {\n          tickLiquidDamage({ accRef: liquidDamageAccumulatorRef, gameState }, deltaMs, { dps: effectiveDps });\n        } else {\n          if (liquidDamageAccumulatorRef) liquidDamageAccumulatorRef.current = 0;\n        }\n      } else {\n        // Other liquids (if any in future) apply their DPS normally\n        tickLiquidDamage({ accRef: liquidDamageAccumulatorRef, gameState }, deltaMs, { dps: effectiveDps });\n      }\n    } catch {}\n  } else {\n    if (liquidDamageAccumulatorRef) liquidDamageAccumulatorRef.current = 0;\n  }\n\n  // 3) Item collection and triggers\n  // Sync moved state to Ref so triggers can see it and modify it (Teleport, Knockback, etc.)\n  gameState.current.x = x;\n  gameState.current.y = y;\n  gameState.current.vx = vx;\n  gameState.current.vy = vy;\n  gameState.current.isGrounded = isGrounded;\n  gameState.current.animation = animation;\n\n  collectItem(x, y, mapWidth, objectData);\n\n  // 3.5) Interactables check (berry bushes etc.)\n  try { checkInteractables(x, y, mapWidth, mapHeight, objectData); } catch {}\n\n  // 4) Hazard damage check (bushes etc.)\n  try { checkHazardDamage(x, y, mapWidth, objectData, deltaMs); } catch {}\n\n  // Sync back from Ref in case triggers changed something\n  x = gameState.current.x;\n  y = gameState.current.y;\n  vx = gameState.current.vx;\n  vy = gameState.current.vy;\n\n  // 4.5) Secrets detection and reveal\n  try { if (checkSecrets) checkSecrets(x, y, width, height, mapWidth, mapHeight); } catch {}\n\n  // 5) Shooting & projectiles\n  // Cooldown update\n  if (shootCooldownRef.current > 0) shootCooldownRef.current = Math.max(0, shootCooldownRef.current - deltaMs);\n  // Get fresh ammo value after item collection\n  const currentAmmo = Math.max(0, Number(gameState.current.ammo) || 0);\n  if (keys?.mouseLeft && shootCooldownRef.current <= 0 && currentAmmo > 0) {\n    const originX = x + (direction >= 0 ? width + 4 : -4);\n    const originY = y + height / 2;\n    spawnProjectile(originX, originY, direction >= 0 ? 1 : -1, 'player');\n    shootCooldownRef.current = 350; // ms cooldown\n    gameState.current.ammo = Math.max(0, currentAmmo - 1);\n  }\n  // Update existing projectiles\n  try { updateProjectiles(deltaMs, mapWidth, mapHeight); } catch {}\n\n  // 5.5) Update entities (tanks etc.)\n  try {\n    updateEntities({\n      entitiesRef,\n      gameState,\n      mapData,\n      objectData,\n      mapWidth,\n      mapHeight,\n      TILE_SIZE,\n      checkCollision,\n      isLiquidAt,\n      getLiquidSample,\n      spawnProjectile,\n      playSfx,\n      constants,\n      registryItems: ctx.registryItems,\n      onStateUpdate: actions.onStateUpdate,\n      activeRoomIds: activeRoomIdsRef?.current || mapData.meta?.activeRoomIds\n    }, Math.min(dt, 100)); // Ierobeojam deltaMs uz 100ms, lai izvairtos no milzgiem lcieniem\n    \n    // Sinhronizjam loklos maingos pc enttiju (platformu) ietekmes\n    x = gameState.current.x;\n    y = gameState.current.y;\n    vx = gameState.current.vx;\n    vy = gameState.current.vy;\n    isGrounded = gameState.current.isGrounded;\n    animation = gameState.current.animation;\n    \n    // Kontaktbojjumi no enttijm\n    const player = gameState.current;\n    if (entitiesRef.current && entitiesRef.current.length > 0) {\n      for (const ent of entitiesRef.current) {\n        if (ent.health <= 0 || ent.isExploding) continue;\n        \n        // AABB prbaude\n        const hit = (\n          player.x < ent.x + ent.width &&\n          player.x + player.width > ent.x &&\n          player.y < ent.y + ent.height &&\n          player.y + player.height > ent.y\n        );\n        \n        if (hit && Number(player.hitTimerMs) <= 0) {\n          // Pievienojam nelielu atgrdienu (knockback)\n          const knockbackDir = player.x + player.width / 2 < ent.x + ent.width / 2 ? -1 : 1;\n          gameState.current.vx = knockbackDir * 5;\n          gameState.current.vy = -3;\n          \n          // Iestatm bezsmertbas periodu un vizulo flash\n          gameState.current.hitTimerMs = 500;\n          \n          // Samazinm spltja veselbu\n          gameState.current.health = Math.max(0, (Number(gameState.current.health) || 0) - 10);\n          \n          if (actions.onStateUpdate) {\n            actions.onStateUpdate('playerDamage', { damage: 10, x: player.x + player.width / 2, y: player.y });\n          }\n        }\n      }\n    }\n  } catch (e) {\n    console.error(\"Entity update failed:\", e);\n  }\n\n  // 6) Clamp player to world bounds horizontally; allow falling below map to trigger game over\n  const maxX = mapWidth * TILE_SIZE - width;\n  x = Math.max(0, Math.min(maxX, x));\n\n  // 7) Win and Death check\n  if (gameState.current.isWinning) {\n    gameState.current.winCounter = (gameState.current.winCounter || 0) + (gameState.current.winCountSpeed || 10) * (deltaMs / 100);\n    if (gameState.current.winCounter >= 100) {\n      gameState.current.winCounter = 100;\n      // Trigger level win event if needed\n      if (actions.onStateUpdate) actions.onStateUpdate('levelWin');\n    }\n  }\n\n  if ((Number(gameState.current.health) || 0) <= 0 || y > mapHeight * TILE_SIZE + 300) {\n    try { onGameOver && onGameOver(); } catch {}\n  }\n\n  // 8) Decrement hit flash timer\n  try {\n    if (Number(gameState.current.hitTimerMs) > 0) {\n      gameState.current.hitTimerMs = Math.max(0, Number(gameState.current.hitTimerMs) - deltaMs);\n    }\n  } catch {}\n\n  if (!prevInWater && inWater) {\n    gameState.current.lastWaterEnter = {\n      x: x + width / 2,\n      y: y + height / 2,\n      time: Number(timestamp) || 0\n    };\n  }\n\n  // 9) Commit new state for renderer\n  gameState.current = {\n    ...gameState.current,\n    timeMs: Number(timestamp) || 0,\n    x,\n    y,\n    vx,\n    vy,\n    width,\n    height,\n    isGrounded,\n    direction,\n    animation,\n    inWater,\n    headUnderWater,\n    atSurface,\n    liquidType: liquidType || null,\n    liquidOverlay: liquidParams?.overlay || null,\n    onIce: isSlippery\n  };\n\n  // Floating text deltas for player resources\n  if (actions.onStateUpdate) {\n    const floatState = gameState.current.floatingText || { prev: {}, acc: {} };\n    const resources = [\n      { key: 'health', color: '#ff3b3b' },\n      { key: 'oxygen', color: '#2ecdf1' },\n      { key: 'lavaResist', color: '#ffcc00' },\n      { key: 'iceResist', color: '#a5f3fc' },\n      { key: 'strength', color: '#8b5a2b' },\n      { key: 'radioactivity', color: '#32cd32' }\n    ];\n    const baseX = x + width / 2;\n    const baseY = y - 6;\n\n    resources.forEach((res, idx) => {\n      const cur = Number(gameState.current[res.key]) || 0;\n      if (!Number.isFinite(floatState.prev[res.key])) {\n        floatState.prev[res.key] = cur;\n        floatState.acc[res.key] = 0;\n        return;\n      }\n      const diff = cur - floatState.prev[res.key];\n      if (diff !== 0) {\n        floatState.acc[res.key] = (floatState.acc[res.key] || 0) + diff;\n        if (Math.abs(floatState.acc[res.key]) >= 1) {\n          const amt = Math.round(floatState.acc[res.key]);\n          floatState.acc[res.key] -= amt;\n          const sign = amt > 0 ? '+' : '';\n          actions.onStateUpdate('floatingText', {\n            x: baseX + (idx - 2.5) * 6,\n            y: baseY,\n            text: `${sign}${amt}`,\n            color: res.color,\n            amount: amt\n          });\n        }\n      }\n      floatState.prev[res.key] = cur;\n    });\n\n    gameState.current.floatingText = floatState;\n  }\n\n  setPlayer({ ...gameState.current, projectiles: projectilesRef.current || [], entities: entitiesRef.current || [] });\n\n  return { continue: true };\n}\n\nexport default null;\n","/**\n * Game Constants\n * All game-wide constants centralized in one place\n */\n\n// Physics Constants\nexport const TILE_SIZE = 32;\nexport const GRAVITY = 0.6;\nexport const TERMINAL_VELOCITY = 12;\nexport const MOVE_SPEED = 4;\nexport const JUMP_FORCE = 10;\n\n// Player Stats Constants\nexport const MAX_HEALTH = 100;\nexport const MAX_OXYGEN = 100;\nexport const MAX_LAVA_RESIST = 100;\nexport const MAX_ICE_RESIST = 100;\nexport const MAX_RADIOACTIVITY = 100;\n\n// Combat Constants\nexport const SHOOT_COOLDOWN = 350; // milliseconds\nexport const HIT_FLASH_DURATION = 500; // milliseconds\n\n// Animation Constants\nexport const IDLE_ANIMATION = 'idle';\nexport const RUN_ANIMATION = 'run';\nexport const JUMP_ANIMATION = 'jump';\n\n// Liquid Constants\nexport const WATER_HORIZONTAL_DAMPING = 0.82;\nexport const LAVA_HORIZONTAL_DAMPING = 0.78;\n\n// Default Liquid Parameters\nexport const DEFAULT_OXYGEN_PARAMS = {\n  drainPerSecond: 20,\n  regenPerSecond: 35,\n  damagePerSecondWhenDepleted: 10,\n};\n\nexport const DEFAULT_LAVA_PARAMS = {\n  drainPerSecond: 25,\n  regenPerSecond: 40,\n  damagePerSecondWhenDepleted: 15,\n};\n\n// Timing Constants\nexport const HAZARD_DAMAGE_TICK_INTERVAL = 1000; // milliseconds\nexport const LIQUID_DAMAGE_TICK_INTERVAL = 1000; // milliseconds\n\n// Direction Constants\nexport const DIRECTION_RIGHT = 1;\nexport const DIRECTION_LEFT = -1;\n\n// Map Defaults\nexport const DEFAULT_MAP_WIDTH = 20;\nexport const DEFAULT_MAP_HEIGHT = 15;\n\n// Viewport Constants\nexport const VIEWPORT_DEAD_ZONE_LEFT = 0.3;\nexport const VIEWPORT_DEAD_ZONE_RIGHT = 0.7;\n\n// Sound Constants\nexport const DEFAULT_BACKGROUND_MUSIC_VOLUME = 0.6;\nexport const DEFAULT_SFX_VOLUME = 0.5;\n","/**\n * Centralized Error Handler\n * Provides unified error handling and logging across the application\n */\n\nclass ErrorHandler {\n  constructor() {\n    this.errorListeners = [];\n    this.logLevel = process.env.NODE_ENV === 'production' ? 'error' : 'debug';\n  }\n\n  /**\n   * Log levels: debug, info, warn, error\n   */\n  setLogLevel(level) {\n    this.logLevel = level;\n  }\n\n  /**\n   * Add error listener callback\n   * @param {Function} callback - Callback function to receive errors\n   */\n  addListener(callback) {\n    this.errorListeners.push(callback);\n  }\n\n  /**\n   * Remove error listener callback\n   * @param {Function} callback - Callback to remove\n   */\n  removeListener(callback) {\n    this.errorListeners = this.errorListeners.filter(cb => cb !== callback);\n  }\n\n  /**\n   * Notify all listeners of an error\n   * @param {Error} error - The error object\n   * @param {Object} context - Additional context information\n   */\n  notifyListeners(error, context = {}) {\n    this.errorListeners.forEach(callback => {\n      try {\n        callback(error, context);\n      } catch (err) {\n        console.error('Error in error listener:', err);\n      }\n    });\n  }\n\n  /**\n   * Handle and log an error\n   * @param {Error|string} error - The error to handle\n   * @param {Object} context - Additional context information\n   * @param {string} level - Log level (debug, info, warn, error)\n   */\n  handle(error, context = {}, level = 'error') {\n    const errorObj = error instanceof Error ? error : new Error(String(error));\n    const timestamp = new Date().toISOString();\n\n    const logData = {\n      timestamp,\n      level,\n      message: errorObj.message,\n      stack: errorObj.stack,\n      context,\n    };\n\n    // Console logging based on level\n    if (this.shouldLog(level)) {\n      const logMethod = console[level] || console.error;\n      logMethod(`[${timestamp}] [${level.toUpperCase()}]`, errorObj.message, context);\n\n      if (errorObj.stack && level === 'error') {\n        console.error(errorObj.stack);\n      }\n    }\n\n    // Notify listeners\n    if (level === 'error' || level === 'warn') {\n      this.notifyListeners(errorObj, context);\n    }\n\n    // In development, you could send to external logging service\n    if (process.env.NODE_ENV === 'production') {\n      this.sendToLoggingService(logData);\n    }\n\n    return errorObj;\n  }\n\n  /**\n   * Determine if a log level should be printed based on current log level setting\n   * @param {string} level - The log level to check\n   * @returns {boolean}\n   */\n  shouldLog(level) {\n    const levels = { debug: 0, info: 1, warn: 2, error: 3 };\n    const currentLevel = levels[this.logLevel] || 0;\n    const messageLevel = levels[level] || 0;\n    return messageLevel >= currentLevel;\n  }\n\n  /**\n   * Send error data to external logging service (stub for now)\n   * @param {Object} logData - The log data to send\n   */\n  sendToLoggingService(logData) {\n    // TODO: Implement integration with external logging service\n    // (e.g., Sentry, LogRocket, etc.)\n  }\n\n  /**\n   * Convenience methods for different log levels\n   */\n  debug(message, context = {}) {\n    return this.handle(message, context, 'debug');\n  }\n\n  info(message, context = {}) {\n    return this.handle(message, context, 'info');\n  }\n\n  warn(message, context = {}) {\n    return this.handle(message, context, 'warn');\n  }\n\n  error(message, context = {}) {\n    return this.handle(message, context, 'error');\n  }\n\n  /**\n   * Wrap an async function with error handling\n   * @param {Function} fn - The async function to wrap\n   * @param {Object} context - Additional context for errors\n   * @returns {Function} Wrapped function\n   */\n  wrapAsync(fn, context = {}) {\n    return async (...args) => {\n      try {\n        return await fn(...args);\n      } catch (error) {\n        this.handle(error, { ...context, args }, 'error');\n        throw error;\n      }\n    };\n  }\n\n  /**\n   * Wrap a sync function with error handling\n   * @param {Function} fn - The function to wrap\n   * @param {Object} context - Additional context for errors\n   * @returns {Function} Wrapped function\n   */\n  wrapSync(fn, context = {}) {\n    return (...args) => {\n      try {\n        return fn(...args);\n      } catch (error) {\n        this.handle(error, { ...context, args }, 'error');\n        throw error;\n      }\n    };\n  }\n}\n\n// Export singleton instance\nconst errorHandler = new ErrorHandler();\n\nexport default errorHandler;\nexport { ErrorHandler };\n","import { useState, useEffect, useRef } from 'react';\nimport { useInput } from './useInput';\nimport { findItemById } from '../engine/registry';\nimport { checkHazardDamage, spawnProjectile as spawnProjectileExternal, collectItem, checkInteractables, updateProjectiles, handleWeatherEffectHit } from '../engine/gameplay';\nimport { checkSecretDetection } from '../engine/gameplay/secrets';\nimport { playSfx } from '../engine/audio';\nimport { updateFrame } from '../engine/loop/updateFrame';\nimport { getLiquidAtPixel, isLiquidAtPixel as isLiquidAtPixelUtil, sampleLiquidForAABB } from '../engine/liquids/liquidUtils';\nimport { isSolidAtPixel as isSolidAtPixelExternal, checkCollision as checkCollisionExternal, getSurfaceProperties } from '../engine/physics';\nimport {\n    TILE_SIZE,\n    GRAVITY,\n    TERMINAL_VELOCITY,\n    MOVE_SPEED,\n    JUMP_FORCE,\n    MAX_HEALTH,\n    MAX_OXYGEN,\n    MAX_LAVA_RESIST,\n    MAX_ICE_RESIST,\n    MAX_RADIOACTIVITY\n} from '../constants/gameConstants';\nimport errorHandler from '../services/errorHandler';\n\n// Helper: accept boolean or string values like \"true\"/\"false\"\nconst parseBool = (v, def = false) => {\n    if (typeof v === 'boolean') return v;\n    if (typeof v === 'string') return v.trim().toLowerCase() === 'true';\n    return def;\n};\n\n// Modified arguments: added objectData, secretData, revealedSecrets, onRevealSecret, objectMetadata\nexport const useGameEngine = (mapData, tileData, objectData, secretData, revealedSecrets, registryItems, onGameOver, onStateUpdate, onRevealSecret, objectMetadata, activeRoomIds, mapWidth, mapHeight) => {\n    const input = useInput();\n\n    // Player state\n    const [player, setPlayer] = useState({\n        x: 0, // In pixels\n        y: 0, // In pixels\n        width: 32, // Default, will be overwritten from registry\n        height: 32,\n        vx: 0,\n        vy: 0,\n        isGrounded: false,\n        direction: 1, // 1 right, -1 left\n        animation: 'idle', // idle, run, jump\n        health: 90, // Initial health (for testing, to allow picking up hearts)\n        maxHealth: MAX_HEALTH,\n        ammo: 0, // Fireball ammunition\n        fishCount: 0,\n        // New resources for display\n        oxygen: MAX_OXYGEN,\n        maxOxygen: MAX_OXYGEN,\n        lavaResist: MAX_LAVA_RESIST,\n        maxLavaResist: MAX_LAVA_RESIST,\n        iceResist: MAX_ICE_RESIST,\n        maxIceResist: MAX_ICE_RESIST,\n        radioactivity: MAX_RADIOACTIVITY * 0.2, // 20% default\n        maxRadioactivity: MAX_RADIOACTIVITY,\n        strength: 30,\n        maxStrength: 100,\n        lastPushTime: 0,\n        isWinning: false,\n        winCounter: 0,\n        projectiles: [] // Active projectiles for rendering\n  });\n\n    // Ref objects for game logic\n    const gameState = useRef({ ...player });               // Player state for loop (avoids closure issues)\n    const requestRef = useRef();                           // requestAnimationFrame id\n    const isInitialized = useRef(false);                   // Whether game is initialized\n    const lastTimeRef = useRef(0);                         // Time between frames (t)\n    const hazardDamageAccumulatorRef = useRef(0);          // Accumulated time for hazard damage over time\n    const lastHazardIndexRef = useRef(null);               // Last hazard tile index cache (to associate damage with specific hazard)\n    const triggeredHazardsRef = useRef(new Set());         // Hazards with damageOnce: true that have already triggered\n    const projectilesRef = useRef([]);                     // Active projectiles\n    const shootCooldownRef = useRef(0);                    // Remaining cooldown time (ms)\n    const projectileIdRef = useRef(1);                     // Auto-incrementing ID\n    const soundEnabledRef = useRef(false);                 // Global sound toggle\n    const audioCtxRef = useRef(null);                      // WebAudio context (fallback)\n    const audioCtxUnlockedRef = useRef(false);             // Whether AudioContext is unlocked with user gesture\n    const liquidDamageAccumulatorRef = useRef(0);          // Accumulated time for liquid DPS ticking (e.g., lava)\n    const oxygenDepleteAccRef = useRef(0);                 // O2 depletion DPS accumulator\n    const lavaDepleteAccRef = useRef(0);                   // Lava resist depletion DPS accumulator\n    const weatherDamageAccRef = useRef(0);                // Weather damage DPS accumulator\n    const entitiesRef = useRef([]);                        // Active moving entities (tanks, etc.)\n\n    // Refs for props to avoid stale closures in the game loop\n    const onStateUpdateRef = useRef(onStateUpdate);\n    const onRevealSecretRef = useRef(onRevealSecret);\n    const onGameOverRef = useRef(onGameOver);\n    const objectMetadataRef = useRef(objectMetadata);\n    const revealedSecretsRef = useRef(revealedSecrets);\n    const activeRoomIdsRef = useRef(activeRoomIds);\n    const mapWidthRef = useRef(mapWidth);\n    const mapHeightRef = useRef(mapHeight);\n    const tileDataRef = useRef(tileData);\n    const objectDataRef = useRef(objectData);\n    const secretDataRef = useRef(secretData);\n\n    useEffect(() => { onStateUpdateRef.current = onStateUpdate; }, [onStateUpdate]);\n    useEffect(() => { onRevealSecretRef.current = onRevealSecret; }, [onRevealSecret]);\n    useEffect(() => { onGameOverRef.current = onGameOver; }, [onGameOver]);\n    useEffect(() => { objectMetadataRef.current = objectMetadata; }, [objectMetadata]);\n    useEffect(() => { revealedSecretsRef.current = revealedSecrets; }, [revealedSecrets]);\n    useEffect(() => { activeRoomIdsRef.current = activeRoomIds; }, [activeRoomIds]);\n    useEffect(() => { mapWidthRef.current = mapWidth; }, [mapWidth]);\n    useEffect(() => { mapHeightRef.current = mapHeight; }, [mapHeight]);\n    useEffect(() => { tileDataRef.current = tileData; }, [tileData]);\n    useEffect(() => { objectDataRef.current = objectData; }, [objectData]);\n    useEffect(() => { secretDataRef.current = secretData; }, [secretData]);\n\n    // Sync global sound toggle from localStorage and events\n    useEffect(() => {\n        try {\n            const v = localStorage.getItem('game_sound_enabled');\n            soundEnabledRef.current = (v === null ? false : v !== '0');\n        } catch { soundEnabledRef.current = false; }\n        const onToggle = (e) => {\n            try {\n                const enabled = !!(e?.detail?.enabled);\n                soundEnabledRef.current = enabled;\n            } catch {}\n        };\n        window.addEventListener('game-sound-toggle', onToggle);\n        // AudioContext unlocking with user gesture (click on HUD button, etc.)\n        const onUserGesture = () => {\n            try {\n                if (!audioCtxRef.current) {\n                    const AC = window.AudioContext || window.webkitAudioContext;\n                    if (AC) audioCtxRef.current = new AC();\n                }\n                if (audioCtxRef.current && audioCtxRef.current.state === 'suspended') {\n                    audioCtxRef.current.resume?.();\n                }\n                if (audioCtxRef.current && audioCtxRef.current.state === 'running') {\n                    audioCtxUnlockedRef.current = true;\n                }\n            } catch {}\n        };\n        window.addEventListener('game-sound-user-gesture', onUserGesture);\n\n        return () => {\n            window.removeEventListener('game-sound-toggle', onToggle);\n            window.removeEventListener('game-sound-user-gesture', onUserGesture);\n        };\n    }, []);\n\n    // Helper function: play SFX (delegated to GameEngine/audio)\n    const playShotSfx = (url, volume) => {\n        const isInsideRoom = activeRoomIdsRef.current && activeRoomIdsRef.current.length > 0;\n        return playSfx({ soundEnabledRef, audioCtxRef, audioCtxUnlockedRef, isInsideRoom }, url, volume);\n    };\n\n    // Adapter: correctly calls GameEngine/checkHazardDamage with options object\n    const checkHazardDamageWrapper = (currentX, currentY, mapWidth, objectLayerData, deltaMs) => {\n        try {\n            return checkHazardDamage({\n                currentX,\n                currentY,\n                mapWidth,\n                objectLayerData,\n                deltaMs,\n                registryItems,\n                TILE_SIZE,\n                MOVE_SPEED,\n                JUMP_FORCE,\n                hazardDamageAccumulatorRef,\n                lastHazardIndexRef,\n                triggeredHazardsRef,\n                gameState\n            });\n        } catch (error) {\n            errorHandler.error(error, {\n                component: 'useGameEngine',\n                function: 'checkHazardDamageWrapper',\n                playerPosition: { x: currentX, y: currentY },\n                mapWidth\n            });\n            return { damage: 0, damageType: null };\n        }\n    };\n\n    // Track revealed secrets locally to prevent duplicate reveals before state updates\n    const localRevealedRef = useRef(new Set());\n\n    // Weather effects impact handling (meteors, etc.)\n    const handleWeatherEffectHitWrapper = (type, data) => {\n        handleWeatherEffectHit(type, data, {\n            gameState,\n            entitiesRef,\n            TILE_SIZE,\n            onBreakEffect: (detail) => {\n                window.dispatchEvent(new CustomEvent('game-break-effect', { detail }));\n            }\n        });\n    };\n\n    // Listen for weather effect hits from the UI/Renderer\n    useEffect(() => {\n        const onHit = (e) => {\n            if (e && e.detail) {\n                handleWeatherEffectHitWrapper(e.detail.type, e.detail.data);\n            }\n        };\n        window.addEventListener('weather-effect-hit', onHit);\n        return () => window.removeEventListener('weather-effect-hit', onHit);\n    }, []);\n\n    // Secrets detection wrapper\n    const checkSecretsWrapper = (currentX, currentY, width, height, mapWidth, mapHeight) => {\n        try {\n            if (!secretData || !onRevealSecretRef.current) return;\n\n            // Merge prop revealedSecrets with local tracking\n            const mergedRevealed = [\n                ...(revealedSecretsRef.current || []),\n                ...Array.from(localRevealedRef.current)\n            ];\n\n            const indicesToReveal = checkSecretDetection({\n                currentX,\n                currentY,\n                width,\n                height,\n                secretMapData: secretData,\n                revealedSecrets: mergedRevealed,\n                mapWidth,\n                mapHeight,\n                registryItems,\n                TILE_SIZE\n            });\n\n            if (indicesToReveal && indicesToReveal.length > 0) {\n                // Add to local tracking immediately (before state updates)\n                indicesToReveal.forEach(idx => localRevealedRef.current.add(idx));\n                onRevealSecretRef.current(indicesToReveal);\n            }\n        } catch (error) {\n            errorHandler.error(error, {\n                component: 'useGameEngine',\n                function: 'checkSecretsWrapper',\n                playerPosition: { x: currentX, y: currentY }\n            });\n        }\n    };\n\n    const lastMapIdRef = useRef(null);\n\n    // Initialize player at starting position\n    useEffect(() => {\n        if (!mapData) {\n            isInitialized.current = false;\n            lastMapIdRef.current = null;\n            return;\n        }\n\n        // Unique identifier for the map session\n        // We include projectName and timestamps to distinguish between different projects \n        // that might use the same activeMapId (like \"main\")\n        const meta = mapData.meta || {};\n        const projectName = meta.projectName || '';\n        const mapId = meta.activeMapId || mapData.name || 'default';\n        const timestamp = meta.date_map_last_updated || meta.date_map_created_at || '';\n        \n        // Use a unique ID that changes on map load or restart\n        const currentMapId = `${projectName}|${mapId}|${timestamp}`;\n        const isNewMapLoad = currentMapId !== lastMapIdRef.current;\n\n        // Ja sple jau ir inicializta UN t ir t pati karte, nemainm spltja pozciju\n        // Tas novr \"reset\" uz skumu, kad spltjs pace itemu vai mains laikapstki\n        if (isInitialized.current && !isNewMapLoad) return;\n\n        lastMapIdRef.current = currentMapId;\n\n        // Reset state for new initialization\n        lastTimeRef.current = 0;\n        hazardDamageAccumulatorRef.current = 0;\n        lastHazardIndexRef.current = null;\n        triggeredHazardsRef.current = new Set();\n        projectilesRef.current = [];\n        entitiesRef.current = [];\n        shootCooldownRef.current = 0;\n        projectileIdRef.current = 1;\n\n        if (mapData && mapData.layers) {\n            const mapW = mapWidth || mapData.meta?.width || mapData.width || 20;\n            const mapH = mapHeight || mapData.meta?.height || mapData.height || 15;\n            \n            // Search for entities in objectData\n            const initialEntities = [];\n            if (objectData && Array.isArray(objectData)) {\n                objectData.forEach((id, idx) => {\n                    if (id && !id.includes('player')) {\n                        const def = findItemById(id) || registryItems.find(r => r.id === id);\n                        const isEntity = def && (\n                            def.type === 'entity' || \n                            def.subtype === 'tank' || \n                            def.subtype === 'platform' ||\n                            def.isPushable ||\n                            (def.name && def.name.toLowerCase().includes('entities.'))\n                        );\n\n                        if (isEntity) {\n                            initialEntities.push({\n                                id: `entity_${idx}_${Date.now()}_${idx}`,\n                                defId: id,\n                                def: def,\n                                x: (idx % mapW) * TILE_SIZE,\n                                y: Math.floor(idx / mapW) * TILE_SIZE,\n                                width: (Number(def.width) || 1) * TILE_SIZE,\n                                height: (Number(def.height) || 1) * TILE_SIZE,\n                                vx: 0,\n                                vy: 0,\n                                health: def.maxHealth || 100,\n                                direction: def.subtype === 'platform' ? 1 : (def.isPushable ? 1 : -1),\n                                animation: (def.subtype === 'platform' || def.isPushable) ? 'idle' : 'move',\n                                animFrame: 0,\n                                animTimer: 0,\n                                isGrounded: false,\n                                shootCooldown: 0,\n                                currentSpriteIndex: 0,\n                                subtype: def.subtype || (def.isPushable ? 'pushable' : null),\n                                rotation: def.isRound ? 0 : undefined\n                            });\n                        }\n                    }\n                });\n            }\n            entitiesRef.current = initialEntities;\n\n            const objLayer = mapData.layers.find(l => l.name === 'entities');\n            if (objLayer) {\n                // 1. Priority: spawnTriggerId hint (from inter-map teleport)\n                const spawnTriggerId = mapData.meta?.spawnTriggerId;\n                let startIndex = -1;\n\n                if (spawnTriggerId !== undefined && spawnTriggerId !== null) {\n                    startIndex = objLayer.data.findIndex((id, idx) => {\n                        if (!id || (!id.includes('target') && id !== 'portal_target')) return false;\n                        const meta = objectMetadataRef.current?.[idx] || mapData.meta?.objectMetadata?.[idx];\n                        return meta && meta.triggerId === spawnTriggerId;\n                    });\n                }\n\n                // 2. Fallback: Search for player (anything containing 'player')\n                if (startIndex === -1) {\n                    startIndex = objLayer.data.findIndex(id => id && id.includes('player'));\n                }\n\n                if (startIndex !== -1) {\n                    let startX = (startIndex % mapW) * TILE_SIZE;\n                    let startY = Math.floor(startIndex / mapW) * TILE_SIZE;\n\n                    // Get data from registry\n                    const playerId = objLayer.data[startIndex];\n                    const registryPlayer = findItemById(playerId) || findItemById(\"player\"); // Fallback to generic player\n                    const maxHealth = Math.max(1, Number(registryPlayer?.maxHealth) || MAX_HEALTH);\n\n                    const prevAmmo = Math.max(0, Number(gameState.current?.ammo) || 0);\n                    const prevFishCount = Math.max(0, Number(gameState.current?.fishCount) || 0);\n                    // Completely overwrite gameState with default values + new position\n                    gameState.current = {\n                        x: startX,\n                        y: startY,\n                        width: (registryPlayer?.width || 1) * TILE_SIZE * 0.8,\n                        height: (registryPlayer?.height || 1) * TILE_SIZE,\n                        vx: 0,\n                        vy: 0,\n                        isGrounded: false,\n                        direction: 1,\n                        animation: 'idle',\n                        health: Math.min(90, maxHealth), // Reset to 90 (not MAX) to allow testing items\n                        maxHealth,\n                        ammo: prevAmmo,\n                        fishCount: prevFishCount,\n                        // resources\n                        oxygen: MAX_OXYGEN,\n                        maxOxygen: MAX_OXYGEN,\n                        lavaResist: MAX_LAVA_RESIST,\n                        maxLavaResist: MAX_LAVA_RESIST,\n                        radioactivity: MAX_RADIOACTIVITY * 0.2,\n                        maxRadioactivity: MAX_RADIOACTIVITY,\n                        strength: Number(registryPlayer?.strength) || 30,\n                        maxStrength: Number(registryPlayer?.maxStrength) || 100,\n                        lastPushTime: 0,\n                        isWinning: false,\n                        winCounter: 0\n                    };\n\n                    // If start position sinks into block, move up to safe location\n                    let guard = 0;\n                    const pW = gameState.current.width || TILE_SIZE;\n                    const pH = gameState.current.height || TILE_SIZE;\n                    while (checkCollision(gameState.current.x, gameState.current.y, undefined, undefined, pW, pH) && guard < mapH) {\n                        gameState.current.y = Math.max(0, gameState.current.y - TILE_SIZE);\n                        guard++;\n                    }\n                    // Ensure we're not outside world boundaries horizontally\n                    const maxXAtStart = mapW * TILE_SIZE - gameState.current.width;\n                    gameState.current.x = Math.max(0, Math.min(gameState.current.x, maxXAtStart));\n\n                    setPlayer({ ...gameState.current, projectiles: [], entities: entitiesRef.current });\n                    isInitialized.current = true;\n                } else {\n                    // If player not found in map, place at 0,0 or some safe location\n                    gameState.current = {\n                        ...gameState.current,\n                        x: 0,\n                        y: 0,\n                        vx: 0,\n                        vy: 0,\n                        oxygen: MAX_OXYGEN,\n                        maxOxygen: MAX_OXYGEN,\n                        lavaResist: MAX_LAVA_RESIST,\n                        maxLavaResist: MAX_LAVA_RESIST,\n                        radioactivity: MAX_RADIOACTIVITY * 0.2,\n                        maxRadioactivity: MAX_RADIOACTIVITY,\n                        strength: 30,\n                        maxStrength: 100,\n                        lastPushTime: 0\n                    };\n                    setPlayer({ ...gameState.current, projectiles: [], entities: entitiesRef.current });\n                    isInitialized.current = true; // allow loop to work even without start position\n                }\n            } else {\n                // No entities layer  still start game at 0,0\n                gameState.current = {\n                    ...gameState.current,\n                    x: 0,\n                    y: 0,\n                    vx: 0,\n                    vy: 0,\n                    oxygen: MAX_OXYGEN,\n                    maxOxygen: MAX_OXYGEN,\n                    lavaResist: MAX_LAVA_RESIST,\n                    maxLavaResist: MAX_LAVA_RESIST,\n                    radioactivity: MAX_RADIOACTIVITY * 0.2,\n                    maxRadioactivity: MAX_RADIOACTIVITY,\n                    strength: 30,\n                    maxStrength: 100,\n                    lastPushTime: 0\n                };\n                setPlayer({ ...gameState.current, projectiles: [], entities: entitiesRef.current });\n                isInitialized.current = true;\n            }\n        }\n    }, [mapData]); // objectData removed - item collection shouldn't trigger re-initialization\n\n    // Helper function for collisions (AABB Collision) with blocks (tile layer)  delegates to GameEngine/collision\n    const checkCollision = (newX, newY, mw, mh, w, h, ignoreEntityId) => {\n        return checkCollisionExternal(\n            newX,\n            newY,\n            mw !== undefined ? mw : (mapWidthRef.current || 20),\n            mh !== undefined ? mh : (mapHeightRef.current || 15),\n            TILE_SIZE,\n            tileDataRef.current || tileData,\n            registryItems,\n            w !== undefined ? w : gameState.current.width,\n            h !== undefined ? h : gameState.current.height,\n            secretDataRef.current || secretData,\n            objectDataRef.current || objectData,\n            objectMetadataRef.current || mapData?.meta?.objectMetadata,\n            entitiesRef.current,\n            ignoreEntityId || null,\n            mapData?.maps,\n            activeRoomIdsRef.current || mapData?.meta?.activeRoomIds\n        );\n    };\n\n    // Simple point solidity check for projectiles  delegates to GameEngine/collision\n    const isSolidAtPixel = (wx, wy, mw, mh, TILE_SIZE_OVERRIDE, tileDataOverride, registryItemsOverride, secretDataOverride, objectDataOverride, objectMetadataOverride, ignoreId) => {\n        return isSolidAtPixelExternal(\n            wx,\n            wy,\n            mw !== undefined ? mw : (mapWidthRef.current || 20),\n            mh !== undefined ? mh : (mapHeightRef.current || 15),\n            TILE_SIZE_OVERRIDE || TILE_SIZE,\n            tileDataOverride || tileDataRef.current || tileData,\n            registryItemsOverride || registryItems,\n            secretDataOverride || secretDataRef.current || secretData,\n            objectDataOverride || objectDataRef.current || objectData,\n            objectMetadataOverride || objectMetadataRef.current || mapData?.meta?.objectMetadata,\n            entitiesRef.current,\n            ignoreId,\n            mapData?.maps,\n            activeRoomIdsRef.current || mapData?.meta?.activeRoomIds\n        );\n    };\n\n    // New: liquid type check at a world pixel\n    const getLiquidTypeAtPixel = (wx, wy, mapWidthTiles, mapHeightTiles) => {\n        const liq = getLiquidAtPixel(wx, wy, mapWidthRef.current || 20, mapHeightRef.current || 15, TILE_SIZE, tileData, registryItems);\n        return liq ? liq.type : null;\n    };\n\n    // Liquid sampling helper for update loop (AABB based)\n    const sampleLiquid = (aabb, mapWidthTiles, mapHeightTiles) => {\n        return sampleLiquidForAABB({\n            x: aabb.x,\n            y: aabb.y,\n            width: aabb.width,\n            height: aabb.height,\n            TILE_SIZE,\n            mapWidth: mapWidthRef.current || 20,\n            mapHeight: mapHeightRef.current || 15,\n            tileData,\n            registryItems\n        });\n    };\n\n    // Item collection  moved to GameEngine/collectItem\n\n    // Helper function: create new projectile  moved to separate module\n    const spawnProjectile = (originX, originY, direction, ownerId = 'player') => {\n        return spawnProjectileExternal({\n            findItemById,\n            TILE_SIZE,\n            parseBool,\n            projectilesRef,\n            projectileIdRef,\n            playShotSfx\n        }, originX, originY, direction, ownerId);\n    };\n\n    // Game Loop (delegated to GameEngine/updateFrame)\n    const update = (timestamp) => {\n        const ctx = {\n            mapData,\n            objectData: objectDataRef.current,\n            input,\n            refs: { gameState, isInitialized, lastTimeRef, projectilesRef, entitiesRef, shootCooldownRef, liquidDamageAccumulatorRef, oxygenDepleteAccRef, lavaDepleteAccRef, weatherDamageAccRef, activeRoomIdsRef },\n            constants: { TILE_SIZE, GRAVITY, TERMINAL_VELOCITY, MOVE_SPEED, JUMP_FORCE },\n            registryItems,\n            helpers: {\n                checkCollision,\n                getSurfaceProperties: (x, y, w, h) => getSurfaceProperties(x, y, w, h, mapWidthRef.current || 20, mapHeightRef.current || 15, TILE_SIZE, tileDataRef.current, registryItems, secretDataRef.current, objectMetadataRef.current || mapData?.meta?.objectMetadata, mapData?.maps, activeRoomIdsRef.current || mapData?.meta?.activeRoomIds),\n                isLiquidAt: (wx, wy) => getLiquidTypeAtPixel(wx, wy),\n                getLiquidSample: ({ x, y, width, height }) =>\n                    sampleLiquid({ x, y, width, height })\n            },\n            actions: {\n                collectItem: (x, y, mw, objectLayer) =>\n                collectItem({\n                    registryItems,\n                    TILE_SIZE,\n                    MAX_HEALTH,\n                    playShotSfx,\n                    onStateUpdate: onStateUpdateRef.current,\n                    gameState,\n                    maps: mapData?.maps,\n                    activeRoomIds: activeRoomIdsRef.current || mapData?.meta?.activeRoomIds,\n                    objectMetadata: objectMetadataRef.current || mapData?.meta?.objectMetadata,\n                    secretMapData: secretDataRef.current || secretData,\n                    activeMapId: mapData?.meta?.activeMapId || mapData?.meta?.activeMap || 'main'\n                }, x, y, mapWidthRef.current || 20, objectDataRef.current),\n                checkInteractables: (x, y, mw, mh, objectLayer) =>\n                    checkInteractables({ registryItems, TILE_SIZE, MAX_HEALTH, playShotSfx, onStateUpdate: onStateUpdateRef.current, gameState, mapData, input, activeRoomIds: activeRoomIdsRef.current, objectMetadata: objectMetadataRef.current, secretMapData: secretDataRef.current || secretData }, x, y, mapWidthRef.current || 20, mapHeightRef.current || 15, objectDataRef.current),\n                checkHazardDamage: (x, y, mw, objectLayer, deltaMs) =>\n                    checkHazardDamageWrapper(x, y, mapWidthRef.current || 20, objectDataRef.current, deltaMs),\n                checkSecrets: (x, y, width, height, mw, mh) =>\n                    checkSecretsWrapper(x, y, width, height, mapWidthRef.current || 20, mapHeightRef.current || 15),\n                spawnProjectile: (originX, originY, direction, ownerId) =>\n                    spawnProjectile(originX, originY, direction, ownerId),\n                playSfx: (url, volume) => playShotSfx(url, volume),\n                updateProjectiles: (deltaMs, mw, mh) =>\n                    updateProjectiles({ \n                        projectilesRef, \n                        entitiesRef,\n                        playerState: gameState.current,\n                        TILE_SIZE, \n                        isSolidAtPixel, \n                        findItemById, \n                        objectData: objectDataRef.current, \n                        objectMetadata: objectMetadataRef.current || mapData?.meta?.objectMetadata, \n                        tileData: tileDataRef.current || tileData,\n                        secretData: secretDataRef.current || secretData,\n                        registryItems,\n                        onStateUpdate: onStateUpdateRef.current\n                    }, deltaMs, mapWidthRef.current || 20, mapHeightRef.current || 15),\n                setPlayer: (next) => setPlayer(next),\n                onGameOver: onGameOverRef.current\n            }\n        };\n        const res = updateFrame(ctx, timestamp);\n        if (res?.continue !== false) {\n            requestRef.current = requestAnimationFrame(update);\n        }\n    };\n\n    // Loop initialization / restart\n    useEffect(() => {\n        if (!mapData) return;\n        requestRef.current = requestAnimationFrame(update);\n        return () => {\n            if (requestRef.current) cancelAnimationFrame(requestRef.current);\n        };\n    }, [mapData]); // Restart loop ONLY if map changes, not objects\n\n    return player;\n};\n","import { useEffect, useRef } from 'react';\n\nexport const useInput = () => {\n    const keys = useRef({\n        w: false,\n        a: false,\n        s: false,\n        d: false,\n        space: false,\n        mouseLeft: false,\n        e: false\n    });\n\n    useEffect(() => {\n        const isTerminalOpen = () => {\n            try { return !!window.__GAME_TERMINAL_OPEN__; } catch { return false; }\n        };\n\n        const clearKeys = () => {\n            keys.current.w = false;\n            keys.current.a = false;\n            keys.current.s = false;\n            keys.current.d = false;\n            keys.current.space = false;\n            keys.current.mouseLeft = false;\n            keys.current.e = false;\n        };\n\n        const handleKeyDown = (e) => {\n            // Do not toggle when typing into inputs/textareas/contenteditable\n            const tag = (e.target && e.target.tagName) ? e.target.tagName.toUpperCase() : '';\n            const typing = tag === 'INPUT' || tag === 'TEXTAREA' || (e.target && e.target.isContentEditable);\n\n            // Toggle in-game terminal with 'T'\n            if (!typing && e.code === 'KeyT' && !e.repeat) {\n                try { window.dispatchEvent(new CustomEvent('game-toggle-terminal')); } catch {}\n                clearKeys();\n                // prevent game movement while toggling\n                if (typeof e.preventDefault === 'function') e.preventDefault();\n                return;\n            }\n\n            // Prevent browser scrolling / focus hijack for game controls only when NOT typing and terminal is closed\n            if (!typing && !isTerminalOpen()) {\n                switch (e.code) {\n                    case 'KeyW':\n                    case 'ArrowUp':\n                    case 'KeyA':\n                    case 'ArrowLeft':\n                    case 'KeyS':\n                    case 'ArrowDown':\n                    case 'KeyD':\n                    case 'ArrowRight':\n                    case 'Space':\n                        if (typeof e.preventDefault === 'function') e.preventDefault();\n                        break;\n                    default:\n                        break;\n                }\n            }\n\n            // If terminal is open, ignore gameplay inputs so player doesn't move while typing\n            if (isTerminalOpen()) return;\n\n            switch (e.code) {\n                case 'KeyW':\n                case 'ArrowUp':\n                    keys.current.w = true; break;\n                case 'KeyA':\n                case 'ArrowLeft':\n                    keys.current.a = true; break;\n                case 'KeyS':\n                case 'ArrowDown':\n                    keys.current.s = true; break;\n                case 'KeyD':\n                case 'ArrowRight':\n                    keys.current.d = true; break;\n                case 'KeyE':\n                    keys.current.e = true; break;\n                case 'Space': keys.current.space = true; break;\n                default: break;\n            }\n        };\n\n        const handleMouseDown = (e) => {\n            // Left button only\n            if (e.button !== 0) return;\n            if (isTerminalOpen()) return;\n            keys.current.mouseLeft = true;\n        };\n\n        const handleMouseUp = (e) => {\n            if (e.button !== 0) return;\n            if (isTerminalOpen()) return;\n            keys.current.mouseLeft = false;\n        };\n\n        const handleKeyUp = (e) => {\n            // Allow closing terminal with Escape (terminal component also handles it)\n            if (e.code === 'Escape') return;\n\n            if (isTerminalOpen()) {\n                // When terminal is open, we do not change gameplay key states here\n                return;\n            }\n\n            switch (e.code) {\n                case 'KeyW':\n                case 'ArrowUp':\n                    keys.current.w = false; break;\n                case 'KeyA':\n                case 'ArrowLeft':\n                    keys.current.a = false; break;\n                case 'KeyS':\n                case 'ArrowDown':\n                    keys.current.s = false; break;\n                case 'KeyD':\n                case 'ArrowRight':\n                    keys.current.d = false; break;\n                case 'KeyE':\n                    keys.current.e = false; break;\n                case 'Space': keys.current.space = false; break;\n                default: break;\n            }\n        };\n\n        const onToggleTerminal = () => clearKeys();\n\n        // non-passive to allow preventDefault on Space/Arrow keys\n        window.addEventListener('keydown', handleKeyDown, { passive: false });\n        window.addEventListener('keyup', handleKeyUp, { passive: false });\n        window.addEventListener('game-toggle-terminal', onToggleTerminal);\n        window.addEventListener('mousedown', handleMouseDown, { passive: true });\n        window.addEventListener('mouseup', handleMouseUp, { passive: true });\n\n        return () => {\n            window.removeEventListener('keydown', handleKeyDown, { passive: false });\n            window.removeEventListener('keyup', handleKeyUp, { passive: false });\n            window.removeEventListener('game-toggle-terminal', onToggleTerminal);\n            window.removeEventListener('mousedown', handleMouseDown, { passive: true });\n            window.removeEventListener('mouseup', handleMouseUp, { passive: true });\n        };\n    }, []);\n\n    return keys;\n};","import { getMeteorBreakEffectConfig } from './meteorBreakEffects';\nimport { getBiologicalBreakEffectConfig } from './biologicalBreakEffects';\n\n/**\n * Handles weather effect impacts like meteor strikes, lightning, etc.\n * This logic is decoupled from useGameEngine to allow for easier expansion.\n */\nexport const handleWeatherEffectHit = (type, data, context) => {\n    if (!type || !data || !context) return;\n    const { gameState, entitiesRef, onBreakEffect } = context;\n\n    if (type === 'meteor') {\n        const { x, y, size, isLarge, surfaceType } = data;\n        const damage = isLarge ? 40 : 20;\n        const radius = size * 1.5;\n\n        // 1. Check player impact\n        if (gameState && gameState.current) {\n            const p = gameState.current;\n            const dx = (p.x + p.width / 2) - x;\n            const dy = (p.y + p.height / 2) - y;\n            const dist = Math.sqrt(dx * dx + dy * dy);\n\n            if (dist < radius + p.width / 2) {\n                gameState.current.health = Math.max(0, (Number(gameState.current.health) || 0) - damage);\n                gameState.current.hitTimerMs = 500;\n                // Add knockback\n                if (dist > 0) {\n                    gameState.current.vx += (dx / dist) * 10;\n                    gameState.current.vy -= 5;\n                } else {\n                    gameState.current.vy -= 10; // direct hit\n                }\n            }\n        }\n\n        // 2. Check entities impact\n        if (entitiesRef && entitiesRef.current) {\n            entitiesRef.current.forEach(ent => {\n                const isFish = ent.def?.subtype === 'fish' || ent.def?.ai?.type === 'fish' || ent.def?.fish;\n                const edx = (ent.x + ent.width / 2) - x;\n                const edy = (ent.y + ent.height / 2) - y;\n                const edist = Math.sqrt(edx * edx + edy * edy);\n\n                const prevHealth = Number(ent.health) || 0;\n                const inDamageRadius = edist < radius + ent.width / 2;\n                if (inDamageRadius) {\n                    ent.health = Math.max(0, prevHealth - damage);\n                    // Platforms don't take knockback, but others might\n                    if (ent.subtype !== 'platform') {\n                        if (edist > 0) {\n                            ent.vx += (edx / edist) * 8;\n                            ent.vy -= 3;\n                        } else {\n                            ent.vy -= 6;\n                        }\n                    }\n                }\n\n                if (isFish) {\n                    const cfg = ent.def?.fish || {};\n                    const shockRadius = (Number(cfg.meteorShockRadius) || 0) * (context?.TILE_SIZE || 32);\n                    if (shockRadius > 0 && edist <= shockRadius) {\n                        ent.fishState = ent.fishState || {};\n                        ent.fishState.shockUntil = (Number(gameState?.current?.timeMs) || 0) + (Number(cfg.meteorShockDurationMs) || 1800);\n                    }\n                    const wasDead = prevHealth <= 0;\n                    if (wasDead && ent.health <= 0 && inDamageRadius) {\n                        const now = Number(gameState?.current?.timeMs) || 0;\n                        ent.fishState = ent.fishState || {};\n                        const lastFx = Number(ent.fishState.lastBioFxAt) || 0;\n                        const alreadyQueued = !!ent.fishState.removeOnNext;\n                        if (!alreadyQueued && now - lastFx > 200) {\n                            const bioConfig = getBiologicalBreakEffectConfig();\n                            if (bioConfig && typeof onBreakEffect === 'function') {\n                                onBreakEffect({ x: ent.x + ent.width / 2, y: ent.y + ent.height / 2, config: bioConfig });\n                            }\n                            ent.fishState.lastBioFxAt = now;\n                            ent.fishState.removeOnNext = true;\n                        }\n                    }\n                }\n            });\n        }\n\n        const breakConfig = getMeteorBreakEffectConfig({ size, surfaceType });\n        if (breakConfig && typeof onBreakEffect === 'function') {\n            onBreakEffect({ x, y, config: breakConfig });\n        }\n    }\n\n    // Future weather types can be added here\n    // e.g., if (type === 'lightning') { ... }\n};\n","// Projectile spawning extracted from useGameEngine.js\n\nexport function spawnProjectile(ctx, originX, originY, direction, ownerId = 'player') {\n  const { findItemById, TILE_SIZE, parseBool, projectilesRef, projectileIdRef, playShotSfx } = ctx;\n\n  const pDef = findItemById('fireball_basic');\n  const id = projectileIdRef.current++;\n  const w = Math.max(2, ((pDef?.width || 0.25) * TILE_SIZE));\n  const h = Math.max(2, ((pDef?.height || 0.25) * TILE_SIZE));\n  const speedPxPerSec = (pDef?.speed ? pDef.speed * 60 : 14 * 60);\n  const vx = (direction >= 0 ? 1 : -1) * speedPxPerSec;\n  const vy = 0;\n  const life = Math.max(200, pDef?.lifespan || 600);\n  const ricochetFlag = (typeof pDef?.ricochetOnTiles !== 'undefined')\n    ? !!pDef.ricochetOnTiles\n    : parseBool(pDef?.collisionWithPenetration, true);\n\n  const proj = {\n    id,\n    ownerId, // Tagad ms zinm, kur izva\n    x: originX,\n    y: originY,\n    vx,\n    vy,\n    w,\n    h,\n    life,\n    defId: pDef?.id || 'fireball_basic',\n    dir: direction >= 0 ? 1 : -1,\n    cwt: !!(pDef && pDef.collisionWithTiles),\n    hbs: Math.max(0.1, Math.min(1.0, (pDef?.hitboxScale ?? 1))),\n    ric: ricochetFlag,\n    dmg: pDef?.damage || 10\n  };\n  projectilesRef.current.push(proj);\n\n  try {\n    const vol = Math.max(0, Math.min(1, pDef?.sfxVolume ?? 1));\n    playShotSfx(pDef?.sfx, vol);\n  } catch {}\n}\n","// Projectile update and ricochet simulation extracted from useGameEngine.js\n\n// ctx: { projectilesRef, entitiesRef, playerState, TILE_SIZE, isSolidAtPixel, findItemById, objectData, objectMetadata, tileData, secretData, registryItems, onStateUpdate }\n// updateProjectiles(ctx, deltaMs, mapWidth, mapHeight)\nexport function updateProjectiles(ctx, deltaMs, mapWidth, mapHeight) {\n  const { projectilesRef, entitiesRef, playerState, TILE_SIZE, isSolidAtPixel, findItemById, objectData, objectMetadata, tileData, secretData, registryItems, onStateUpdate } = ctx;\n  const dtProj = deltaMs / 1000;\n  const worldW = mapWidth * TILE_SIZE;\n  const worldH = mapHeight * TILE_SIZE;\n\n  const isSolidRect = (cx, cy, hw, hh) => {\n    const pts = [\n      { x: cx - hw, y: cy - hh },\n      { x: cx + hw, y: cy - hh },\n      { x: cx - hw, y: cy + hh },\n      { x: cx + hw, y: cy + hh },\n    ];\n    for (let k = 0; k < pts.length; k++) {\n      const pt = pts[k];\n      // Updated isSolidAtPixel call with all necessary layers\n      if (isSolidAtPixel(pt.x, pt.y, mapWidth, mapHeight, TILE_SIZE, tileData, registryItems, secretData, objectData, objectMetadata)) return true;\n    }\n    return false;\n  };\n\n  const checkObjectHit = (cx, cy, hw, hh) => {\n    if (!objectData) return null;\n    const pts = [\n        { x: cx - hw, y: cy - hh },\n        { x: cx + hw, y: cy - hh },\n        { x: cx - hw, y: cy + hh },\n        { x: cx + hw, y: cy + hh },\n        { x: cx, y: cy }\n    ];\n    for (const pt of pts) {\n        const gx = Math.floor(pt.x / TILE_SIZE);\n        const gy = Math.floor(pt.y / TILE_SIZE);\n        if (gx < 0 || gy < 0 || gx >= mapWidth || gy >= mapHeight) continue;\n        const index = gy * mapWidth + gx;\n        const objId = objectData[index];\n        if (objId) {\n            const def = findItemById(objId);\n            if (def && def.isDestructible) {\n                // Check if already passable\n                const currentMeta = objectMetadata?.[index] || {};\n                const health = currentMeta.health !== undefined ? currentMeta.health : def.maxHealth;\n                if (health > (def.passableHealthThreshold || 0)) {\n                    return index;\n                }\n            }\n        }\n    }\n    return null;\n  };\n\n  const checkEntityHit = (cx, cy, hw, hh, p) => {\n    if (!entitiesRef?.current) return null;\n    for (const ent of entitiesRef.current) {\n        if (ent.health <= 0 || ent.isExploding) continue;\n        if (ent.id === p.ownerId) continue; // Ignorjam izvju\n\n        const ex = ent.x;\n        const ey = ent.y;\n        const ew = ent.width;\n        const eh = ent.height;\n        if (cx + hw > ex && cx - hw < ex + ew &&\n            cy + hh > ey && cy - hh < ey + eh) {\n            return ent;\n        }\n    }\n    return null;\n  };\n\n  const checkPlayerHit = (cx, cy, hw, hh, p) => {\n    if (!playerState || p.ownerId === 'player') return false; // Ignorjam, ja izva spltjs\n    \n    const ex = playerState.x;\n    const ey = playerState.y;\n    const ew = playerState.width || TILE_SIZE;\n    const eh = playerState.height || TILE_SIZE;\n    if (cx + hw > ex && cx - hw < ex + ew &&\n        cy + hh > ey && cy - hh < ey + eh) {\n        return true;\n    }\n    return false;\n  };\n\n  if (!projectilesRef.current.length) return;\n\n  for (let i = projectilesRef.current.length - 1; i >= 0; i--) {\n    const p = projectilesRef.current[i];\n\n    if (p.bounces == null) p.bounces = 0;\n    const maxBounces = Number.isFinite(p.maxBounces)\n      ? p.maxBounces\n      : (findItemById(p.defId)?.maxBounces ?? 3);\n    const bounceDamp = Number.isFinite(p.bounceDamping)\n      ? p.bounceDamping\n      : (findItemById(p.defId)?.bounceDamping ?? 0.6);\n    const ricRand = Number.isFinite(p.ricochetRandom)\n      ? p.ricochetRandom\n      : (findItemById(p.defId)?.ricochetRandom ?? 0.15);\n\n    const maxDelta = Math.max(Math.abs(p.vx * dtProj), Math.abs(p.vy * dtProj));\n    let steps = Math.ceil(maxDelta / 4);\n    if (!Number.isFinite(steps) || steps < 1) steps = 1;\n    steps = Math.min(steps, 20);\n    const stepTime = dtProj / steps;\n\n    let cx = p.x;\n    let cy = p.y;\n    const hw = (p.w * (p.hbs || 1)) * 0.5;\n    const hh = (p.h * (p.hbs || 1)) * 0.5;\n\n    let removed = false;\n\n    for (let s = 0; s < steps; s++) {\n      // 1) X axis\n      let nextX = cx + p.vx * stepTime;\n      \n      const hitPlayerX = checkPlayerHit(nextX, cy, hw, hh, p);\n      if (hitPlayerX) {\n        if (playerState) {\n          playerState.health = Math.max(0, (Number(playerState.health) || 0) - (p.dmg || 10));\n        }\n        if (onStateUpdate && playerState) {\n          onStateUpdate('playerDamage', {\n            damage: p.dmg || 10,\n            x: playerState.x + (playerState.width || TILE_SIZE) / 2,\n            y: playerState.y\n          });\n        }\n        removed = true;\n        break;\n      }\n\n      const hitEntX = checkEntityHit(nextX, cy, hw, hh, p);\n      if (hitEntX) {\n        hitEntX.health -= p.dmg || 10;\n        if (onStateUpdate) {\n          onStateUpdate('entityDamage', {\n            x: hitEntX.x + hitEntX.width / 2,\n            y: hitEntX.y,\n            amount: p.dmg || 10\n          });\n        }\n        removed = true;\n        break;\n      }\n\n      const hitIdxX = checkObjectHit(nextX, cy, hw, hh);\n      if (hitIdxX !== null) {\n        if (onStateUpdate) onStateUpdate('objectDamage', { index: hitIdxX, damage: p.dmg || 10 });\n        removed = true;\n        break;\n      }\n\n      if (p.cwt && isSolidRect(nextX, cy, hw, hh)) {\n        if (p.ric) {\n          p.vx = -p.vx * bounceDamp;\n          const sp = Math.max(40, Math.hypot(p.vx, p.vy));\n          const jitter = (Math.random() * 2 - 1) * sp * ricRand;\n          p.vy += jitter * 0.15;\n          p.bounces += 1;\n          p.life = Math.max(0, p.life - 80);\n        } else {\n          removed = true;\n          break;\n        }\n      } else {\n        cx = nextX;\n      }\n\n      // 2) Y axis\n      let nextY = cy + p.vy * stepTime;\n      \n      const hitPlayerY = checkPlayerHit(cx, nextY, hw, hh, p);\n      if (hitPlayerY) {\n        if (playerState) {\n          playerState.health = Math.max(0, (Number(playerState.health) || 0) - (p.dmg || 10));\n        }\n        if (onStateUpdate && playerState) {\n          onStateUpdate('playerDamage', {\n            damage: p.dmg || 10,\n            x: playerState.x + (playerState.width || TILE_SIZE) / 2,\n            y: playerState.y\n          });\n        }\n        removed = true;\n        break;\n      }\n\n      const hitEntY = checkEntityHit(cx, nextY, hw, hh, p);\n      if (hitEntY) {\n        hitEntY.health -= p.dmg || 10;\n        if (onStateUpdate) {\n          onStateUpdate('entityDamage', {\n            x: hitEntY.x + hitEntY.width / 2,\n            y: hitEntY.y,\n            amount: p.dmg || 10\n          });\n        }\n        removed = true;\n        break;\n      }\n\n      const hitIdxY = checkObjectHit(cx, nextY, hw, hh);\n      if (hitIdxY !== null) {\n        if (onStateUpdate) onStateUpdate('objectDamage', { index: hitIdxY, damage: p.dmg || 10 });\n        removed = true;\n        break;\n      }\n\n      if (p.cwt && isSolidRect(cx, nextY, hw, hh)) {\n        if (p.ric) {\n          p.vy = -p.vy * bounceDamp;\n          const sp = Math.max(40, Math.hypot(p.vx, p.vy));\n          const jitter = (Math.random() * 2 - 1) * sp * ricRand;\n          p.vx += jitter * 0.15;\n          p.bounces += 1;\n          p.life = Math.max(0, p.life - 80);\n        } else {\n          removed = true;\n          break;\n        }\n      } else {\n        cy = nextY;\n      }\n\n      // 3) Corner stuck safeguard\n      if (p.cwt && isSolidRect(cx, cy, hw, hh)) {\n        if (p.ric) {\n          p.vx = -p.vx * bounceDamp;\n          p.vy = -p.vy * bounceDamp;\n          p.bounces += 1;\n          cx -= Math.sign(p.vx || 1) * 0.5;\n          cy -= Math.sign(p.vy || 1) * 0.5;\n        } else {\n          removed = true;\n          break;\n        }\n      }\n    }\n\n    p.x = cx;\n    p.y = cy;\n\n    p.life -= deltaMs;\n    if (\n      p.life <= 0 ||\n      p.x < -32 ||\n      p.y < -32 ||\n      p.x > worldW + 32 ||\n      p.y > worldH + 32 ||\n      removed ||\n      (p.bounces || 0) > (maxBounces || 0)\n    ) {\n      projectilesRef.current.splice(i, 1);\n      continue;\n    }\n  }\n}\n","import React, { useState, useEffect } from 'react';\n\nconst AnimatedItem = ({ textures, texture, speed, style, alt, className, spriteSheet, frameIndex }) => {\n    const [index, setIndex] = useState(0);\n\n    useEffect(() => {\n        // Ja ir vairkas tekstras, skam animciju\n        if (textures && textures.length > 1) {\n            const interval = setInterval(() => {\n                setIndex((prevIndex) => (prevIndex + 1) % textures.length);\n            }, speed || 500); // Noklusjuma trums 500ms\n\n            return () => clearInterval(interval);\n        }\n    }, [textures, speed]);\n\n    // Izvlamies ko rendert: animcijas kadru, viengo tekstru vai statisko bildi\n    let imgSrc = null;\n    if (textures && textures.length > 0) {\n        imgSrc = textures[index % textures.length];\n    } else if (texture) {\n        imgSrc = texture;\n    }\n\n    if (!imgSrc) return null;\n\n    // Ja ir spraitts, rdm tikai pirmo kadru (vai citu, ja nordts)\n    if (spriteSheet && spriteSheet.enabled) {\n        const columns = spriteSheet.columns || 1;\n        const total = spriteSheet.totalSprites || 1;\n        const rows = Math.ceil(total / columns);\n        \n        // Editor parasti rdm pirmo kadru (index 0) vai nordto kadru\n        const fallbackFrame = spriteSheet && Number.isFinite(Number(spriteSheet.frameIndex)) ? Number(spriteSheet.frameIndex) : 0;\n        const currentFrame = frameIndex !== undefined ? frameIndex : fallbackFrame;\n        const col = currentFrame % columns;\n        const row = Math.floor(currentFrame / columns);\n\n        return (\n            <div className={className} style={{\n                ...style,\n                overflow: 'hidden',\n                display: 'inline-block',\n                width: style?.width || '32px',\n                height: style?.height || '32px',\n                position: 'relative'\n            }}>\n                <img\n                    src={imgSrc}\n                    alt={alt || ''}\n                    style={{\n                        position: 'absolute',\n                        width: `${columns * 100}%`,\n                        height: `${rows * 100}%`,\n                        left: `-${col * 100}%`,\n                        top: `-${row * 100}%`,\n                        maxWidth: 'none',\n                        maxHeight: 'none',\n                        display: 'block'\n                    }}\n                    draggable={false}\n                />\n            </div>\n        );\n    }\n\n    return (\n        <img\n            src={imgSrc}\n            alt={alt || ''}\n            style={style}\n            className={className}\n            draggable={false}\n        />\n    );\n};\n\nexport default AnimatedItem;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport styled from 'styled-components';\nimport AnimatedItem from '../../../utilities/AnimatedItem';\nimport fireballA from '../../../assets/images/items/fireball_basic_A.png';\nimport fireballB from '../../../assets/images/items/fireball_basic_B.png';\nimport fireballC from '../../../assets/images/items/fireball_basic_C.png';\nimport fireballD from '../../../assets/images/items/fireball_basic_D.png';\nimport fishSprite from '../../../assets/images/entities/animals/fish_01.png';\n\nconst HeaderContainer = styled.div`\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: auto;\n    background-color: rgba(0, 0, 0, 0.3);\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 0 20px;\n    box-sizing: border-box;\n    z-index: 1000;\n    pointer-events: none;\n`;\n\nconst AmmoDisplay = styled.div`\n    font-size: 28px;\n    font-weight: bold;\n    color: rgba(255, 200, 50, 0.95);\n    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);\n    font-family: monospace;\n    pointer-events: none;\n    display: inline-flex;\n    align-items: center;\n    gap: 6px;\n`;\n\nconst FishDisplay = styled(AmmoDisplay)`\n    color: rgba(140, 230, 255, 0.95);\n`;\n\nconst AmmoIcon = styled.span`\n    width: 22px;\n    height: 22px;\n    display: inline-flex;\n    align-items: center;\n    justify-content: center;\n    image-rendering: pixelated;\n`;\n\nconst RightSection = styled.div`\n    display: flex;\n    flex-direction: column;\n    align-items: flex-end;\n    //gap: 8px;\n`;\n\nconst BarsContainer = styled.div`\n    display: flex;\n    flex-direction: column;\n    //gap: 1px;\n    width: 250px;\n    padding-top: 5px;\n    padding-bottom: 5px;\n   // border: solid 1px red;\n`;\n\nconst BarRow = styled.div`\n    display: flex;\n    align-items: center;\n    gap: 6px;\n    width: 100%;\n`;\n\nconst BarWrapper = styled.div`\n    flex: 1;\n    height: 6px;\n    background-color: rgba(0, 0, 0, 0.5);\n    border: 1px solid rgba(255, 255, 255, 0.4);\n    position: relative;\n    box-shadow: inset 0 0 0 1px rgba(0,0,0,0.1);\n`;\n\nconst BarFill = styled.div.attrs(props => ({\n    style: {\n        width: `${props.$percent}%`,\n        backgroundColor: props.$color,\n    },\n}))`\n    height: 100%;\n    transition: width 0.3s ease;\n`;\n\nconst BarLabel = styled.div`\n    width: 60px;\n    font-size: 8px;\n    color: white;\n    font-weight: bold;\n    text-shadow: 1px 1px 2px black;\n    pointer-events: none;\n    white-space: nowrap;\n    text-transform: uppercase;\n    text-align: right;\n`;\n\nconst GameHeader = ({ \n    health, \n    maxHealth = 100, \n    ammo = 0, \n    fishCount = 0,\n    oxygen = 100, \n    maxOxygen = 100, \n    lavaResist = 100, \n    maxLavaResist = 100,\n    iceResist = 100,\n    maxIceResist = 100,\n    strength = 30,\n    maxStrength = 100,\n    radioactivity = 20,\n    maxRadioactivity = 100,\n    inWater = false,\n    liquidType = null,\n    onIce = false\n}) => {\n    const hpPercent = Math.max(0, Math.min(100, (health / maxHealth) * 100));\n    const oxyPercent = Math.max(0, Math.min(100, (oxygen / maxOxygen) * 100));\n    const lavaPercent = Math.max(0, Math.min(100, (lavaResist / maxLavaResist) * 100));\n    const icePercent = Math.max(0, Math.min(100, (iceResist / maxIceResist) * 100));\n    const strengthPercent = Math.max(0, Math.min(100, (strength / maxStrength) * 100));\n    const radioPercent = Math.max(0, Math.min(100, (radioactivity / maxRadioactivity) * 100));\n    const fireballFrames = [fireballA, fireballB, fireballC, fireballD, fireballC, fireballB];\n\n    return (\n        <HeaderContainer>\n            <div style={{ display: 'flex', gap: '14px', alignItems: 'center' }}>\n                <AmmoDisplay>\n                    <AmmoIcon>\n                        <AnimatedItem\n                            textures={fireballFrames}\n                            speed={300}\n                            alt=\"Fireball ammo\"\n                            style={{ width: '22px', height: '22px', imageRendering: 'pixelated' }}\n                        />\n                    </AmmoIcon>\n                    {ammo || 0}\n                </AmmoDisplay>\n                <FishDisplay>\n                    <AmmoIcon>\n                        <AnimatedItem\n                            texture={fishSprite}\n                            spriteSheet={{ enabled: true, columns: 2, totalSprites: 3, frameIndex: 0 }}\n                            alt=\"Fish\"\n                            style={{ width: '22px', height: '22px', imageRendering: 'pixelated' }}\n                        />\n                    </AmmoIcon>\n                    {fishCount || 0}\n                </FishDisplay>\n            </div>\n\n            <RightSection>\n                <BarsContainer>\n                    {/* HP Bar */}\n                    <BarRow>\n                        <BarLabel>HP</BarLabel>\n                        <BarWrapper>\n                            <BarFill $percent={hpPercent} $color=\"#ff3232\" />\n                        </BarWrapper>\n                    </BarRow>\n\n                    {/* Oxygen Bar */}\n                    <BarRow>\n                        <BarLabel>OZ</BarLabel>\n                        <BarWrapper>\n                            <BarFill $percent={oxyPercent} $color=\"#2ecdf1\" />\n                        </BarWrapper>\n                    </BarRow>\n\n                    {/* Lava Bar */}\n                    <BarRow>\n                        <BarLabel>LAVA</BarLabel>\n                        <BarWrapper>\n                            <BarFill $percent={lavaPercent} $color=\"#ffcc00\" />\n                        </BarWrapper>\n                    </BarRow>\n\n                    {/* Ice Bar */}\n                    <BarRow>\n                        <BarLabel>ICE</BarLabel>\n                        <BarWrapper>\n                            <BarFill $percent={icePercent} $color=\"#a5f3fc\" />\n                        </BarWrapper>\n                    </BarRow>\n\n                    {/* Strength Bar */}\n                    <BarRow>\n                        <BarLabel>STRNGTH</BarLabel>\n                        <BarWrapper>\n                            <BarFill $percent={strengthPercent} $color=\"#8b5a2b\" />\n                        </BarWrapper>\n                    </BarRow>\n\n                    {/* Radioactivity Bar */}\n                    <BarRow>\n                        <BarLabel>RADIO</BarLabel>\n                        <BarWrapper>\n                            <BarFill $percent={radioPercent} $color=\"#32cd32\" />\n                        </BarWrapper>\n                    </BarRow>\n                </BarsContainer>\n            </RightSection>\n        </HeaderContainer>\n    );\n};\n\nGameHeader.propTypes = {\n    health: PropTypes.number.isRequired,\n    maxHealth: PropTypes.number,\n    ammo: PropTypes.number,\n    fishCount: PropTypes.number,\n    oxygen: PropTypes.number,\n    maxOxygen: PropTypes.number,\n    lavaResist: PropTypes.number,\n    maxLavaResist: PropTypes.number,\n    iceResist: PropTypes.number,\n    maxIceResist: PropTypes.number,\n    strength: PropTypes.number,\n    maxStrength: PropTypes.number,\n    radioactivity: PropTypes.number,\n    maxRadioactivity: PropTypes.number,\n    inWater: PropTypes.bool,\n    liquidType: PropTypes.string,\n    onIce: PropTypes.bool\n};\n\nexport default GameHeader;\n","// Simple command registry for in-game terminal\n// Each command: { name, description, handler(input, ctx) => string | void }\n\nconst commands = [];\n\nconst register = (cmd) => {\n  if (!cmd || !cmd.name) return;\n  commands.push(cmd);\n};\n\nexport const listCommands = () => commands.map(c => ({ name: c.name, description: c.description }));\n\nexport const executeCommand = (input, context = {}) => {\n  const raw = String(input || '').trim();\n  if (!raw) return '';\n  const [name, ...args] = raw.split(/\\s+/);\n  const cmd = commands.find(c => c.name.toLowerCase() === name.toLowerCase());\n  if (!cmd) {\n    return `Unknown command: ${name}. Type 'help' to list commands.`;\n  }\n  try {\n    const res = cmd.handler({ args, raw, context });\n    return typeof res === 'string' ? res : '';\n  } catch (e) {\n    return `Error executing '${name}': ${e?.message || e}`;\n  }\n};\n\n// Built-in: help\nregister({\n  name: 'help',\n  description: 'Show available commands',\n  handler() {\n    const list = listCommands()\n      .map(c => `- ${c.name}${c.description ? `: ${c.description}` : ''}`)\n      .join('\\n');\n    return list || 'No commands available.';\n  }\n});\n\n// Built-in: clear\nregister({\n  name: 'clear',\n  description: 'Clear terminal output',\n  handler() {\n    // Signal to UI to clear output; UI can interpret special token\n    try { window.dispatchEvent(new CustomEvent('game-terminal-clear')); } catch {}\n    return '';\n  }\n});\n\n// First requested command: settings\nregister({\n  name: 'settings',\n  description: \"Open the draggable game settings window\",\n  handler() {\n    try { \n      window.dispatchEvent(new CustomEvent('game-open-settings'));\n      // Also close terminal automatically when opening settings\n      window.dispatchEvent(new CustomEvent('game-close-terminal'));\n    } catch {}\n    return 'Opening settings...';\n  }\n});\n\n// Built-in: debug overlay toggle\nregister({\n  name: 'debug',\n  description: \"Toggle debug overlay: debug [on|off|toggle]\",\n  handler({ args }) {\n    const mode = (args && args[0]) ? String(args[0]).toLowerCase() : 'toggle';\n    const current = !!(window.__GAME_RUNTIME_SETTINGS__ && window.__GAME_RUNTIME_SETTINGS__.debugOverlayEnabled);\n    const next = (mode === 'on') ? true : (mode === 'off' ? false : !current);\n    try {\n      window.__GAME_RUNTIME_SETTINGS__ = {\n        ...(window.__GAME_RUNTIME_SETTINGS__ || {}),\n        debugOverlayEnabled: next\n      };\n      try { localStorage.setItem('game_debug_overlay', next ? '1' : '0'); } catch {}\n      window.dispatchEvent(new CustomEvent('game-settings-update', { detail: { debugOverlayEnabled: next } }));\n    } catch {}\n    return `Debug overlay ${next ? 'enabled' : 'disabled'}.`;\n  }\n});\n\nexport default {\n  register,\n  listCommands,\n  executeCommand,\n};\n","import React, { useEffect, useRef, useState } from 'react';\nimport { executeCommand } from '../../../commands/gameCommands';\n\nconst panelStyleBase = {\n  position: 'fixed',\n  left: 0,\n  right: 0,\n  bottom: 0,\n  height: '220px',\n  backgroundColor: 'rgba(10, 10, 10, 0.95)',\n  color: '#d6d6d6',\n  fontFamily: 'ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, \"Liberation Mono\", \"Courier New\", monospace',\n  fontSize: '12px',\n  borderTop: '1px solid #333',\n  boxShadow: '0 -6px 16px rgba(0,0,0,0.5)',\n  display: 'flex',\n  flexDirection: 'column',\n  zIndex: 3000,\n  transition: 'transform 160ms ease',\n};\n\nexport default function GameTerminal() {\n  const [open, setOpen] = useState(false);\n  const [lines, setLines] = useState([\"Type 'help' to list commands. Press ESC to close.\"]);\n  const [input, setInput] = useState('');\n  const scrollRef = useRef(null);\n  const inputRef = useRef(null);\n  const suppressUntilRef = useRef(0);\n  const suppressActiveRef = useRef(false);\n\n  // Toggle handler from global events\n  useEffect(() => {\n    const onToggle = () => setOpen(prev => !prev);\n    const onClear = () => setLines([]);\n    const onClose = () => setOpen(false);\n    window.addEventListener('game-toggle-terminal', onToggle);\n    window.addEventListener('game-terminal-clear', onClear);\n    window.addEventListener('game-close-terminal', onClose);\n    return () => {\n      window.removeEventListener('game-toggle-terminal', onToggle);\n      window.removeEventListener('game-terminal-clear', onClear);\n      window.removeEventListener('game-close-terminal', onClose);\n    };\n  }, []);\n\n  // Track open state globally so input hook can disable movement\n  useEffect(() => {\n    try { window.__GAME_TERMINAL_OPEN__ = open; } catch {}\n    if (open) {\n      // Clear any previous text and suppress initial keystrokes that were held during gameplay\n      setInput('');\n      try { suppressUntilRef.current = (typeof performance !== 'undefined' ? performance.now() : Date.now()) + 220; } catch { suppressUntilRef.current = Date.now() + 220; }\n      setTimeout(() => inputRef.current && inputRef.current.focus(), 0);\n    }\n  }, [open]);\n\n  // Close with ESC when focused\n  useEffect(() => {\n    const onKey = (e) => {\n      if (!open) return;\n      if (e.key === 'Escape') {\n        setOpen(false);\n      }\n    };\n    window.addEventListener('keydown', onKey);\n    return () => window.removeEventListener('keydown', onKey);\n  }, [open]);\n\n  // Auto-scroll to bottom when lines change\n  useEffect(() => {\n    if (!scrollRef.current) return;\n    scrollRef.current.scrollTop = scrollRef.current.scrollHeight;\n  }, [lines, open]);\n\n  const onSubmit = (e) => {\n    e.preventDefault();\n    const value = input.trim();\n    if (!value) return;\n    setLines(prev => [...prev, `> ${value}`]);\n    const res = executeCommand(value, {});\n    if (res) setLines(prev => [...prev, res]);\n    setInput('');\n  };\n\n  const style = {\n    ...panelStyleBase,\n    transform: open ? 'translateY(0)' : 'translateY(100%)',\n  };\n\n  return (\n    <div style={style} aria-hidden={!open}>\n      <div style={{ padding: '6px 8px', borderBottom: '1px solid #333', color: '#9cdcfe' }}>\n        In-Game Terminal  press T to toggle\n      </div>\n      <div ref={scrollRef} style={{ flex: 1, overflowY: 'auto', padding: '8px 10px', whiteSpace: 'pre-wrap', lineHeight: 1.4 }}>\n        {lines.map((l, i) => (\n          <div key={i} style={{ color: l.startsWith('>') ? '#dcdcaa' : '#d6d6d6' }}>{l}</div>\n        ))}\n      </div>\n      <form onSubmit={onSubmit} style={{ display: 'flex', gap: '6px', padding: '8px', borderTop: '1px solid #333' }}>\n        <span style={{ color: '#6a9955' }}>$</span>\n        <input\n          ref={inputRef}\n          value={input}\n          onKeyDown={(e) => {\n            const now = (typeof performance !== 'undefined' ? performance.now() : Date.now());\n            if (now < (suppressUntilRef.current || 0) && e.key !== 'Escape') {\n              if (typeof e.preventDefault === 'function') e.preventDefault();\n              if (typeof e.stopPropagation === 'function') e.stopPropagation();\n              return;\n            }\n          }}\n          onChange={(e) => setInput(e.target.value)}\n          placeholder=\"Enter command...\"\n          style={{ flex: 1, background: '#111', color: '#fff', border: '1px solid #333', padding: '6px 8px', borderRadius: '3px', outline: 'none' }}\n        />\n        <button type=\"submit\" style={{ background: '#0e639c', color: '#fff', border: '1px solid #0b5c8a', padding: '6px 10px', borderRadius: '3px', cursor: 'pointer' }}>\n          Run\n        </button>\n      </form>\n    </div>\n  );\n}\n","import React, { useEffect, useRef, useState } from 'react';\n\n// Simple draggable, minimizable settings window.\n// Opens when the custom event 'game-open-settings' is dispatched (from terminal command `settings`).\n// Renders above the game canvas but below the in-game terminal.\nexport default function GameSettings() {\n  // Runtime-linked settings (live updates)\n  const [activeTab, setActiveTab] = useState(() => {\n    try {\n      return localStorage.getItem('game_settings_tab') || 'Audio';\n    } catch {}\n    return 'Audio';\n  });\n  const [parallax, setParallax] = useState(() => {\n    try {\n      const g = window.__GAME_RUNTIME_SETTINGS__;\n      if (g && typeof g.backgroundParallaxFactor === 'number') return g.backgroundParallaxFactor;\n    } catch {}\n    return 0.3;\n  });\n  const [rain, setRain] = useState(() => {\n    try {\n      const ls = localStorage.getItem('game_weather_rain');\n      if (ls !== null) return Math.max(0, Math.min(100, parseInt(ls, 10) || 0));\n      const g = window.__GAME_RUNTIME_SETTINGS__;\n      if (g && typeof g.weatherRain === 'number') return Math.max(0, Math.min(100, g.weatherRain));\n    } catch {}\n    return 0;\n  });\n  const [snow, setSnow] = useState(() => {\n    try {\n      const ls = localStorage.getItem('game_weather_snow');\n      if (ls !== null) return Math.max(0, Math.min(100, parseInt(ls, 10) || 0));\n      const g = window.__GAME_RUNTIME_SETTINGS__;\n      if (g && typeof g.weatherSnow === 'number') return Math.max(0, Math.min(100, g.weatherSnow));\n    } catch {}\n    return 0;\n  });\n  const [clouds, setClouds] = useState(() => {\n    try {\n      // New key first\n      const lsNew = localStorage.getItem('game_weather_clouds');\n      if (lsNew !== null) return Math.max(0, Math.min(100, parseInt(lsNew, 10) || 0));\n      // Backward compatibility: read old fog key if exists\n      const lsOld = localStorage.getItem('game_weather_fog');\n      if (lsOld !== null) return Math.max(0, Math.min(100, parseInt(lsOld, 10) || 0));\n      const g = window.__GAME_RUNTIME_SETTINGS__;\n      // Prefer clouds but also accept legacy fog\n      if (g && typeof g.weatherClouds === 'number') return Math.max(0, Math.min(100, g.weatherClouds));\n      if (g && typeof g.weatherFog === 'number') return Math.max(0, Math.min(100, g.weatherFog));\n    } catch {}\n    return 0;\n  });\n  // New: Thunder (Lightning) intensity 0..100\n  const [thunder, setThunder] = useState(() => {\n    try {\n      const ls = localStorage.getItem('game_weather_thunder');\n      if (ls !== null) return Math.max(0, Math.min(100, parseInt(ls, 10) || 0));\n      const g = window.__GAME_RUNTIME_SETTINGS__;\n      if (g && typeof g.weatherThunder === 'number') return Math.max(0, Math.min(100, g.weatherThunder));\n    } catch {}\n    return 0;\n  });\n  // New: dedicated Fog density (0..100)\n  const [fog, setFog] = useState(() => {\n    try {\n      const ls = localStorage.getItem('game_weather_fog');\n      if (ls !== null) return Math.max(0, Math.min(100, parseInt(ls, 10) || 0));\n      const g = window.__GAME_RUNTIME_SETTINGS__;\n      if (g && typeof g.weatherFog === 'number') return Math.max(0, Math.min(100, g.weatherFog));\n    } catch {}\n    return 0;\n  });\n  // New: Lava Rain (0..100)\n  const [lavaRain, setLavaRain] = useState(() => {\n    try {\n      const ls = localStorage.getItem('game_weather_lavarain');\n      if (ls !== null) return Math.max(0, Math.min(100, parseInt(ls, 10) || 0));\n      const g = window.__GAME_RUNTIME_SETTINGS__;\n      if (g && typeof g.weatherLavaRain === 'number') return Math.max(0, Math.min(100, g.weatherLavaRain));\n    } catch {}\n    return 0;\n  });\n  // New: Radioactive Fog (0..100)\n  const [radioactiveFog, setRadioactiveFog] = useState(() => {\n    try {\n      const ls = localStorage.getItem('game_weather_radioactivefog');\n      if (ls !== null) return Math.max(0, Math.min(100, parseInt(ls, 10) || 0));\n      const g = window.__GAME_RUNTIME_SETTINGS__;\n      if (g && typeof g.weatherRadioactiveFog === 'number') return Math.max(0, Math.min(100, g.weatherRadioactiveFog));\n    } catch {}\n    return 0;\n  });\n  // New: Meteor Rain (0..100)\n  const [meteorRain, setMeteorRain] = useState(() => {\n    try {\n      const ls = localStorage.getItem('game_weather_meteorrain');\n      if (ls !== null) return Math.max(0, Math.min(100, parseInt(ls, 10) || 0));\n      const g = window.__GAME_RUNTIME_SETTINGS__;\n      if (g && typeof g.weatherMeteorRain === 'number') return Math.max(0, Math.min(100, g.weatherMeteorRain));\n    } catch {}\n    return 0;\n  });\n  // UI: Health bar visibility\n  const [healthBarEnabled, setHealthBarEnabled] = useState(() => {\n    try {\n      const ls = localStorage.getItem('game_ui_healthbar');\n      if (ls !== null) return ls !== '0';\n      const g = window.__GAME_RUNTIME_SETTINGS__;\n      if (g && typeof g.healthBarEnabled === 'boolean') return g.healthBarEnabled;\n    } catch {}\n    return true;\n  });\n  // UI: Oxygen/Lava bars visibility\n  const [oxygenBarEnabled, setOxygenBarEnabled] = useState(() => {\n    try {\n      const ls = localStorage.getItem('game_ui_oxygenbar');\n      if (ls !== null) return ls !== '0';\n      const g = window.__GAME_RUNTIME_SETTINGS__;\n      if (g && typeof g.oxygenBarEnabled === 'boolean') return g.oxygenBarEnabled;\n    } catch {}\n    return true;\n  });\n  const [lavaBarEnabled, setLavaBarEnabled] = useState(() => {\n    try {\n      const ls = localStorage.getItem('game_ui_lavabar');\n      if (ls !== null) return ls !== '0';\n      const g = window.__GAME_RUNTIME_SETTINGS__;\n      if (g && typeof g.lavaBarEnabled === 'boolean') return g.lavaBarEnabled;\n    } catch {}\n    return true;\n  });\n  const [debugOverlayEnabled, setDebugOverlayEnabled] = useState(() => {\n    try {\n      const ls = localStorage.getItem('game_debug_overlay');\n      if (ls !== null) return ls !== '0';\n      const g = window.__GAME_RUNTIME_SETTINGS__;\n      if (g && typeof g.debugOverlayEnabled === 'boolean') return g.debugOverlayEnabled;\n    } catch {}\n    return false;\n  });\n  // FX toggles\n  const [waterSplashesEnabled, setWaterSplashesEnabled] = useState(() => {\n    try {\n      const ls = localStorage.getItem('game_fx_water_splashes');\n      if (ls !== null) return ls !== '0';\n      const g = window.__GAME_RUNTIME_SETTINGS__;\n      if (g && typeof g.waterSplashesEnabled === 'boolean') return g.waterSplashesEnabled;\n    } catch {}\n    return true;\n  });\n  const [lavaEmbersEnabled, setLavaEmbersEnabled] = useState(() => {\n    try {\n      const ls = localStorage.getItem('game_fx_lava_embers');\n      if (ls !== null) return ls !== '0';\n      const g = window.__GAME_RUNTIME_SETTINGS__;\n      if (g && typeof g.lavaEmbersEnabled === 'boolean') return g.lavaEmbersEnabled;\n    } catch {}\n    return true;\n  });\n  const [roomBlurEnabled, setRoomBlurEnabled] = useState(() => {\n    try {\n      const ls = localStorage.getItem('game_graphics_room_blur');\n      if (ls !== null) return ls !== '0';\n      const g = window.__GAME_RUNTIME_SETTINGS__;\n      if (g && typeof g.roomBlurEnabled === 'boolean') return g.roomBlurEnabled;\n    } catch {}\n    return true;\n  });\n  const [showCoordinates, setShowCoordinates] = useState(() => {\n    try {\n      const ls = localStorage.getItem('game_ui_show_coords');\n      return ls === '1';\n    } catch {}\n    return false;\n  });\n\n  const [open, setOpen] = useState(false);\n  const [minimized, setMinimized] = useState(false);\n  const [pos, setPos] = useState(() => {\n    // Restore last position from localStorage if available\n    try {\n      const raw = localStorage.getItem('game_settings_pos');\n      if (raw) return JSON.parse(raw);\n    } catch {}\n    return { left: 12, top: 64 };\n  });\n\n  const [size, setSize] = useState(() => {\n    try {\n      const raw = localStorage.getItem('game_settings_size');\n      if (raw) return JSON.parse(raw);\n    } catch {}\n    return { width: 300, height: 220 };\n  });\n\n  const draggingRef = useRef({ active: false, offsetX: 0, offsetY: 0 });\n\n  // Helper: clamp position so the window stays within viewport (with small margin)\n  const clampPos = (p, sz, isMin) => {\n    const margin = 12;\n    const vw = (typeof window !== 'undefined' ? window.innerWidth : 0) || 0;\n    const vh = (typeof window !== 'undefined' ? window.innerHeight : 0) || 0;\n    const maxL = Math.max(0, vw - (sz?.width || 300) - margin);\n    const maxT = Math.max(0, vh - (isMin ? 36 : (sz?.height || 220)) - margin);\n    let left = Number(p?.left);\n    let top = Number(p?.top);\n    if (!Number.isFinite(left)) left = margin;\n    if (!Number.isFinite(top)) top = margin;\n    left = Math.max(0, Math.min(maxL, left));\n    top = Math.max(0, Math.min(maxT, top));\n    return { left, top };\n  };\n\n  // Restore minimized state\n  useEffect(() => {\n    try {\n      const raw = localStorage.getItem('game_settings_min');\n      if (raw) setMinimized(raw === '1');\n    } catch {}\n  }, []);\n\n  // Listen for runtime settings updates from game engine or other sources\n  useEffect(() => {\n    const onSettingsUpdate = (e) => {\n      const patch = (e && e.detail) || {};\n      if (patch.weatherRain !== undefined) setRain(patch.weatherRain);\n      if (patch.weatherSnow !== undefined) setSnow(patch.weatherSnow);\n      if (patch.weatherClouds !== undefined) setClouds(patch.weatherClouds);\n      if (patch.weatherFog !== undefined) setFog(patch.weatherFog);\n      if (patch.weatherThunder !== undefined) setThunder(patch.weatherThunder);\n      if (patch.weatherLavaRain !== undefined) setLavaRain(patch.weatherLavaRain);\n      if (patch.weatherRadioactiveFog !== undefined) setRadioactiveFog(patch.weatherRadioactiveFog);\n      if (patch.weatherMeteorRain !== undefined) setMeteorRain(patch.weatherMeteorRain);\n      if (patch.backgroundParallaxFactor !== undefined) setParallax(patch.backgroundParallaxFactor);\n      if (patch.roomBlurEnabled !== undefined) setRoomBlurEnabled(!!patch.roomBlurEnabled);\n      if (patch.healthBarEnabled !== undefined) setHealthBarEnabled(!!patch.healthBarEnabled);\n      if (patch.oxygenBarEnabled !== undefined) setOxygenBarEnabled(!!patch.oxygenBarEnabled);\n      if (patch.lavaBarEnabled !== undefined) setLavaBarEnabled(!!patch.lavaBarEnabled);\n      if (patch.waterSplashesEnabled !== undefined) setWaterSplashesEnabled(!!patch.waterSplashesEnabled);\n      if (patch.lavaEmbersEnabled !== undefined) setLavaEmbersEnabled(!!patch.lavaEmbersEnabled);\n      if (patch.debugOverlayEnabled !== undefined) setDebugOverlayEnabled(!!patch.debugOverlayEnabled);\n    };\n    window.addEventListener('game-settings-update', onSettingsUpdate);\n    return () => window.removeEventListener('game-settings-update', onSettingsUpdate);\n  }, []);\n\n  // Open handler from global event\n  useEffect(() => {\n    const onOpen = () => {\n      // Ensure the window will be visible even if saved pos was off-screen\n      setPos((p) => clampPos(p, size, false));\n      setOpen(true);\n      setMinimized(false);\n      // Sync current values from global when opening\n      try {\n        const g = window.__GAME_RUNTIME_SETTINGS__ || {};\n        if (typeof g.backgroundParallaxFactor === 'number') {\n          setParallax(g.backgroundParallaxFactor);\n        }\n        if (typeof g.roomBlurEnabled === 'boolean') {\n          setRoomBlurEnabled(g.roomBlurEnabled);\n        }\n        if (typeof g.weatherRain === 'number') setRain(Math.max(0, Math.min(100, g.weatherRain)));\n        if (typeof g.weatherSnow === 'number') setSnow(Math.max(0, Math.min(100, g.weatherSnow)));\n        if (typeof g.weatherClouds === 'number') setClouds(Math.max(0, Math.min(100, g.weatherClouds)));\n        if (typeof g.weatherFog === 'number') setFog(Math.max(0, Math.min(100, g.weatherFog)));\n        if (typeof g.weatherThunder === 'number') setThunder(Math.max(0, Math.min(100, g.weatherThunder)));\n        if (typeof g.weatherLavaRain === 'number') setLavaRain(Math.max(0, Math.min(100, g.weatherLavaRain)));\n        if (typeof g.weatherRadioactiveFog === 'number') setRadioactiveFog(Math.max(0, Math.min(100, g.weatherRadioactiveFog)));\n        if (typeof g.weatherMeteorRain === 'number') setMeteorRain(Math.max(0, Math.min(100, g.weatherMeteorRain)));\n        if (typeof g.healthBarEnabled === 'boolean') setHealthBarEnabled(!!g.healthBarEnabled);\n        if (typeof g.oxygenBarEnabled === 'boolean') setOxygenBarEnabled(!!g.oxygenBarEnabled);\n        if (typeof g.lavaBarEnabled === 'boolean') setLavaBarEnabled(!!g.lavaBarEnabled);\n        if (typeof g.waterSplashesEnabled === 'boolean') setWaterSplashesEnabled(!!g.waterSplashesEnabled);\n        if (typeof g.lavaEmbersEnabled === 'boolean') setLavaEmbersEnabled(!!g.lavaEmbersEnabled);\n        if (typeof g.debugOverlayEnabled === 'boolean') setDebugOverlayEnabled(!!g.debugOverlayEnabled);\n      } catch {}\n      // Auto-close the in-game terminal when settings opens\n      try { window.dispatchEvent(new CustomEvent('game-close-terminal')); } catch {}\n    };\n    window.addEventListener('game-open-settings', onOpen);\n    return () => window.removeEventListener('game-open-settings', onOpen);\n  }, []);\n\n  // Persist position and size/minimized\n  useEffect(() => {\n    try { localStorage.setItem('game_settings_pos', JSON.stringify(pos)); } catch {}\n  }, [pos]);\n  useEffect(() => {\n    try { localStorage.setItem('game_settings_size', JSON.stringify(size)); } catch {}\n  }, [size]);\n  useEffect(() => {\n    try { localStorage.setItem('game_settings_min', minimized ? '1' : '0'); } catch {}\n  }, [minimized]);\n  useEffect(() => {\n    try { localStorage.setItem('game_settings_tab', String(activeTab)); } catch {}\n  }, [activeTab]);\n\n  useEffect(() => {\n    try { localStorage.setItem('game_ui_show_coords', showCoordinates ? '1' : '0'); } catch {}\n  }, [showCoordinates]);\n\n  // Drag logic\n  useEffect(() => {\n    const onMove = (e) => {\n      if (!draggingRef.current.active) return;\n      e.preventDefault();\n      const nx = e.clientX - draggingRef.current.offsetX;\n      const ny = e.clientY - draggingRef.current.offsetY;\n      const maxL = Math.max(0, (window.innerWidth || 0) - size.width - 6);\n      const maxT = Math.max(0, (window.innerHeight || 0) - (minimized ? 36 : size.height) - 6);\n      setPos({\n        left: Math.max(0, Math.min(maxL, nx)),\n        top: Math.max(0, Math.min(maxT, ny)),\n      });\n    };\n    const onUp = () => { draggingRef.current.active = false; };\n    window.addEventListener('mousemove', onMove);\n    window.addEventListener('mouseup', onUp);\n    return () => {\n      window.removeEventListener('mousemove', onMove);\n      window.removeEventListener('mouseup', onUp);\n    };\n  }, [size.width, size.height, minimized]);\n\n  // Re-clamp into viewport when window resizes while settings are open\n  useEffect(() => {\n    if (!open) return;\n    const onResize = () => setPos((p) => clampPos(p, size, minimized));\n    window.addEventListener('resize', onResize);\n    // Run once immediately to correct if needed\n    onResize();\n    return () => window.removeEventListener('resize', onResize);\n  }, [open, size.width, size.height, minimized]);\n\n  const onHeaderMouseDown = (e) => {\n    draggingRef.current.active = true;\n    draggingRef.current.offsetX = e.clientX - pos.left;\n    draggingRef.current.offsetY = e.clientY - pos.top;\n  };\n\n  const onClose = () => setOpen(false);\n  const onMinToggle = () => setMinimized((m) => !m);\n\n  const emitUpdate = (patch) => {\n    try {\n      window.dispatchEvent(new CustomEvent('game-settings-update', { detail: patch }));\n      // Mirror into a global bag for components that want to read without listeners\n      window.__GAME_RUNTIME_SETTINGS__ = {\n        ...(window.__GAME_RUNTIME_SETTINGS__ || {}),\n        ...patch,\n      };\n    } catch {}\n  };\n\n  const onResizeMouseDown = (e) => {\n    // Simple bottom-right resize drag\n    e.preventDefault();\n    const startX = e.clientX;\n    const startY = e.clientY;\n    const startW = size.width;\n    const startH = size.height;\n\n    const move = (ev) => {\n      const dw = ev.clientX - startX;\n      const dh = ev.clientY - startY;\n      const nw = Math.max(220, startW + dw);\n      const nh = Math.max(140, startH + dh);\n      setSize({ width: nw, height: nh });\n    };\n    const up = () => {\n      window.removeEventListener('mousemove', move);\n      window.removeEventListener('mouseup', up);\n    };\n    window.addEventListener('mousemove', move);\n    window.addEventListener('mouseup', up);\n  };\n\n  if (!open) return null;\n\n  const panelStyle = {\n    position: 'fixed',\n    left: pos.left,\n    top: pos.top,\n    width: size.width,\n    height: minimized ? 36 : size.height,\n    background: 'rgba(20,20,20,0.96)',\n    color: '#eaeaea',\n    border: '1px solid #2a2a2a',\n    borderRadius: 6,\n    boxShadow: '0 8px 24px rgba(0,0,0,0.6)',\n    zIndex: 2600, // below terminal (3000), above canvas/HUD\n    display: 'flex',\n    flexDirection: 'column',\n    userSelect: draggingRef.current.active ? 'none' : 'auto',\n    overflow: 'hidden',\n  };\n\n  const headerStyle = {\n    cursor: 'move',\n    background: 'linear-gradient(180deg, #2a2a2a, #1c1c1c)',\n    padding: '6px 8px',\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    borderBottom: '1px solid #333',\n    fontSize: 12,\n  };\n\n  const contentStyle = {\n    flex: 1,\n    display: minimized ? 'none' : 'block',\n    padding: 10,\n    overflow: 'auto',\n    background: 'rgba(10,10,10,0.4)'\n  };\n\n  const buttonStyle = {\n    background: '#0e639c',\n    color: '#fff',\n    border: '1px solid #0b5c8a',\n    padding: '4px 8px',\n    borderRadius: 4,\n    fontSize: 11,\n    cursor: 'pointer',\n    marginLeft: 6,\n  };\n\n  const tabsBarStyle = {\n    display: minimized ? 'none' : 'flex',\n    alignItems: 'center',\n    gap: 6,\n    padding: '6px 8px',\n    borderBottom: '1px solid #2a2a2a',\n    background: 'rgba(0,0,0,0.25)',\n    whiteSpace: 'nowrap',\n    overflowX: 'auto'\n  };\n  const tabBtnStyle = (tab) => ({\n    background: activeTab === tab ? '#1e1e1e' : 'transparent',\n    color: activeTab === tab ? '#9cdcfe' : '#ddd',\n    border: activeTab === tab ? '1px solid #3a3a3a' : '1px solid transparent',\n    padding: '4px 10px',\n    borderRadius: 4,\n    fontSize: 12,\n    cursor: 'pointer',\n  });\n\n  const renderAudio = () => (\n    <section style={{ marginBottom: 10 }}>\n      <div style={{ fontSize: 12, marginBottom: 6, color: '#d6d6d6' }}>Audio</div>\n      <div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>\n        <label style={{ fontSize: 12, width: 120 }}>Master Volume</label>\n        <input type=\"range\" min=\"0\" max=\"1\" step=\"0.01\" defaultValue={0.7} />\n      </div>\n    </section>\n  );\n\n  const renderGraphics = () => (\n    <>\n      <section style={{ marginBottom: 10 }}>\n        <div style={{ fontSize: 12, marginBottom: 6, color: '#d6d6d6' }}>Graphics</div>\n        <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginBottom: 6 }}>\n          <label style={{ fontSize: 12, width: 120 }}>Parallax Factor</label>\n          <input\n            type=\"range\"\n            min=\"0\"\n            max=\"1\"\n            step=\"0.05\"\n            value={Number.isFinite(parallax) ? parallax : 0.3}\n            onChange={(e) => {\n              const v = parseFloat(e.target.value);\n              setParallax(v);\n              emitUpdate({ backgroundParallaxFactor: v });\n            }}\n          />\n          <span style={{ fontSize: 12, width: 40, textAlign: 'right' }}>{(Number.isFinite(parallax) ? parallax : 0.3).toFixed(2)}</span>\n        </div>\n        <div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>\n          <label style={{ fontSize: 12, width: 120 }}>VSync</label>\n          <input type=\"checkbox\" defaultChecked />\n        </div>\n      </section>\n      {/* Keep existing Gameplay controls inside Graphics tab for now */}\n      <section>\n        <div style={{ fontSize: 12, marginBottom: 6, color: '#d6d6d6' }}>Gameplay</div>\n        <div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>\n          <label style={{ fontSize: 12, width: 120 }}>Invert Jump (W)</label>\n          <input type=\"checkbox\" />\n        </div>\n        <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginTop: 6 }}>\n          <label style={{ fontSize: 12, width: 120 }}>Show Health Bar</label>\n          <input\n            type=\"checkbox\"\n            checked={!!healthBarEnabled}\n            onChange={(e) => {\n              const v = !!e.target.checked;\n              setHealthBarEnabled(v);\n              try { localStorage.setItem('game_ui_healthbar', v ? '1' : '0'); } catch {}\n              emitUpdate({ healthBarEnabled: v });\n            }}\n          />\n        </div>\n        <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginTop: 6 }}>\n          <label style={{ fontSize: 12, width: 120 }}>Show Oxygen Bar</label>\n          <input\n            type=\"checkbox\"\n            checked={!!oxygenBarEnabled}\n            onChange={(e) => {\n              const v = !!e.target.checked;\n              setOxygenBarEnabled(v);\n              try { localStorage.setItem('game_ui_oxygenbar', v ? '1' : '0'); } catch {}\n              emitUpdate({ oxygenBarEnabled: v });\n            }}\n          />\n        </div>\n        <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginTop: 6 }}>\n          <label style={{ fontSize: 12, width: 120 }}>Show Lava Bar</label>\n          <input\n            type=\"checkbox\"\n            checked={!!lavaBarEnabled}\n            onChange={(e) => {\n              const v = !!e.target.checked;\n              setLavaBarEnabled(v);\n              try { localStorage.setItem('game_ui_lavabar', v ? '1' : '0'); } catch {}\n              emitUpdate({ lavaBarEnabled: v });\n            }}\n          />\n        </div>\n        <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginTop: 6 }}>\n          <label style={{ fontSize: 12, width: 120 }}>Water Splashes</label>\n          <input\n            type=\"checkbox\"\n            checked={!!waterSplashesEnabled}\n            onChange={(e) => {\n              const v = !!e.target.checked;\n              setWaterSplashesEnabled(v);\n              try { localStorage.setItem('game_fx_water_splashes', v ? '1' : '0'); } catch {}\n              emitUpdate({ waterSplashesEnabled: v });\n            }}\n          />\n        </div>\n        <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginTop: 6 }}>\n          <label style={{ fontSize: 12, width: 120 }}>Blur in Room</label>\n          <input\n            type=\"checkbox\"\n            checked={!!roomBlurEnabled}\n            onChange={(e) => {\n              const v = !!e.target.checked;\n              setRoomBlurEnabled(v);\n              try { localStorage.setItem('game_graphics_room_blur', v ? '1' : '0'); } catch {}\n              emitUpdate({ roomBlurEnabled: v });\n            }}\n          />\n        </div>\n        <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginTop: 6 }}>\n          <label style={{ fontSize: 12, width: 120 }}>Show Coordinates</label>\n          <input\n            type=\"checkbox\"\n            checked={!!showCoordinates}\n            onChange={(e) => {\n              const v = !!e.target.checked;\n              setShowCoordinates(v);\n              emitUpdate({ showCoordinates: v });\n            }}\n          />\n        </div>\n        {showCoordinates && (\n          <div style={{ marginTop: 8, padding: '4px 8px', background: 'rgba(0,0,0,0.3)', borderRadius: 4, fontSize: 11, fontFamily: 'monospace', color: '#4ec9b0' }}>\n            Pos: X={Math.round(window.__PLAYER_POS__?.x || 0)}, Y={Math.round(window.__PLAYER_POS__?.y || 0)}\n          </div>\n        )}\n      </section>\n    </>\n  );\n\n  const renderWeather = () => (\n    <section style={{ marginBottom: 10 }}>\n      <div style={{ fontSize: 12, marginBottom: 6, color: '#d6d6d6' }}>Weather</div>\n      <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginBottom: 6 }}>\n        <label style={{ fontSize: 12, width: 120 }}>Lietus (Rain)</label>\n        <input\n          type=\"range\"\n          min=\"0\"\n          max=\"100\"\n          step=\"1\"\n          value={Number.isFinite(rain) ? rain : 0}\n          onChange={(e) => {\n            const v = Math.max(0, Math.min(100, parseInt(e.target.value, 10) || 0));\n            setRain(v);\n            try { localStorage.setItem('game_weather_rain', String(v)); } catch {}\n            emitUpdate({ weatherRain: v });\n          }}\n        />\n        <span style={{ fontSize: 12, width: 34, textAlign: 'right' }}>{Number.isFinite(rain) ? rain : 0}</span>\n      </div>\n      <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginBottom: 6 }}>\n        <label style={{ fontSize: 12, width: 120 }}>Sniegs (Snow)</label>\n        <input\n          type=\"range\"\n          min=\"0\"\n          max=\"100\"\n          step=\"1\"\n          value={Number.isFinite(snow) ? snow : 0}\n          onChange={(e) => {\n            const v = Math.max(0, Math.min(100, parseInt(e.target.value, 10) || 0));\n            setSnow(v);\n            try { localStorage.setItem('game_weather_snow', String(v)); } catch {}\n            emitUpdate({ weatherSnow: v });\n          }}\n        />\n        <span style={{ fontSize: 12, width: 34, textAlign: 'right' }}>{Number.isFinite(snow) ? snow : 0}</span>\n      </div>\n      <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginBottom: 6 }}>\n        <label style={{ fontSize: 12, width: 120 }}>Migla (Fog)</label>\n        <input\n          type=\"range\"\n          min=\"0\"\n          max=\"100\"\n          step=\"1\"\n          value={Number.isFinite(fog) ? fog : 0}\n          onChange={(e) => {\n            const v = Math.max(0, Math.min(100, parseInt(e.target.value, 10) || 0));\n            setFog(v);\n            try { localStorage.setItem('game_weather_fog', String(v)); } catch {}\n            emitUpdate({ weatherFog: v });\n          }}\n        />\n        <span style={{ fontSize: 12, width: 34, textAlign: 'right' }}>{Number.isFinite(fog) ? fog : 0}</span>\n      </div>\n      <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginBottom: 6 }}>\n        <label style={{ fontSize: 12, width: 120 }}>Zibens (Thunder)</label>\n        <input\n          type=\"range\"\n          min=\"0\"\n          max=\"100\"\n          step=\"1\"\n          value={Number.isFinite(thunder) ? thunder : 0}\n          onChange={(e) => {\n            const v = Math.max(0, Math.min(100, parseInt(e.target.value, 10) || 0));\n            setThunder(v);\n            try { localStorage.setItem('game_weather_thunder', String(v)); } catch {}\n            emitUpdate({ weatherThunder: v });\n          }}\n        />\n        <span style={{ fontSize: 12, width: 34, textAlign: 'right' }}>{Number.isFinite(thunder) ? thunder : 0}</span>\n      </div>\n      <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginBottom: 6 }}>\n        <label style={{ fontSize: 12, width: 120 }}>Mkoi (Clouds)</label>\n        <input\n          type=\"range\"\n          min=\"0\"\n          max=\"100\"\n          step=\"1\"\n          value={Number.isFinite(clouds) ? clouds : 0}\n          onChange={(e) => {\n            const v = Math.max(0, Math.min(100, parseInt(e.target.value, 10) || 0));\n            setClouds(v);\n            try { localStorage.setItem('game_weather_clouds', String(v)); } catch {}\n            emitUpdate({ weatherClouds: v });\n          }}\n        />\n        <span style={{ fontSize: 12, width: 34, textAlign: 'right' }}>{Number.isFinite(clouds) ? clouds : 0}</span>\n      </div>\n      <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginBottom: 6 }}>\n        <label style={{ fontSize: 12, width: 120 }}>Lavas lietus</label>\n        <input\n          type=\"range\"\n          min=\"0\"\n          max=\"100\"\n          step=\"1\"\n          value={Number.isFinite(lavaRain) ? lavaRain : 0}\n          onChange={(e) => {\n            const v = Math.max(0, Math.min(100, parseInt(e.target.value, 10) || 0));\n            setLavaRain(v);\n            try { localStorage.setItem('game_weather_lavarain', String(v)); } catch {}\n            emitUpdate({ weatherLavaRain: v });\n          }}\n        />\n        <span style={{ fontSize: 12, width: 34, textAlign: 'right' }}>{Number.isFinite(lavaRain) ? lavaRain : 0}</span>\n      </div>\n      <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginBottom: 6 }}>\n        <label style={{ fontSize: 12, width: 120 }}>Radioakt. migla</label>\n        <input\n          type=\"range\"\n          min=\"0\"\n          max=\"100\"\n          step=\"1\"\n          value={Number.isFinite(radioactiveFog) ? radioactiveFog : 0}\n          onChange={(e) => {\n            const v = Math.max(0, Math.min(100, parseInt(e.target.value, 10) || 0));\n            setRadioactiveFog(v);\n            try { localStorage.setItem('game_weather_radioactivefog', String(v)); } catch {}\n            emitUpdate({ weatherRadioactiveFog: v });\n          }}\n        />\n        <span style={{ fontSize: 12, width: 34, textAlign: 'right' }}>{Number.isFinite(radioactiveFog) ? radioactiveFog : 0}</span>\n      </div>\n      <div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>\n        <label style={{ fontSize: 12, width: 120 }}>Meteortu lietus</label>\n        <input\n          type=\"range\"\n          min=\"0\"\n          max=\"100\"\n          step=\"1\"\n          value={Number.isFinite(meteorRain) ? meteorRain : 0}\n          onChange={(e) => {\n            const v = Math.max(0, Math.min(100, parseInt(e.target.value, 10) || 0));\n            setMeteorRain(v);\n            try { localStorage.setItem('game_weather_meteorrain', String(v)); } catch {}\n            emitUpdate({ weatherMeteorRain: v });\n          }}\n        />\n        <span style={{ fontSize: 12, width: 34, textAlign: 'right' }}>{Number.isFinite(meteorRain) ? meteorRain : 0}</span>\n      </div>\n    </section>\n  );\n\n  const renderDebug = () => (\n    <section style={{ marginBottom: 10 }}>\n      <div style={{ fontSize: 12, marginBottom: 6, color: '#d6d6d6' }}>Debug</div>\n      <div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>\n        <label style={{ fontSize: 12, width: 160 }}>Show Debug Overlay</label>\n        <input\n          type=\"checkbox\"\n          checked={!!debugOverlayEnabled}\n          onChange={(e) => {\n            const v = !!e.target.checked;\n            setDebugOverlayEnabled(v);\n            try { localStorage.setItem('game_debug_overlay', v ? '1' : '0'); } catch {}\n            emitUpdate({ debugOverlayEnabled: v });\n          }}\n        />\n      </div>\n    </section>\n  );\n\n  return (\n    <div style={panelStyle}>\n      <div style={headerStyle} onMouseDown={onHeaderMouseDown}>\n        <div style={{ fontWeight: 600, color: '#9cdcfe' }}>Game Settings</div>\n        <div style={{ display: 'flex', alignItems: 'center' }}>\n          <button onClick={onMinToggle} title={minimized ? 'Expand' : 'Minimize'} style={buttonStyle}>\n            {minimized ? '' : ''}\n          </button>\n          <button onClick={onClose} title=\"Close\" style={{ ...buttonStyle, background: '#a33', borderColor: '#822' }}></button>\n        </div>\n      </div>\n\n      {/* Tabs bar: one-line menu */}\n      <div style={tabsBarStyle}>\n        {['Audio','Graphics','Weather','Debug'].map((t) => (\n          <button key={t} style={tabBtnStyle(t)} onClick={() => setActiveTab(t)}>{t}</button>\n        ))}\n      </div>\n\n      <div style={contentStyle}>\n        {activeTab === 'Audio' && renderAudio()}\n        {activeTab === 'Graphics' && renderGraphics()}\n        {activeTab === 'Weather' && renderWeather()}\n        {activeTab === 'Debug' && renderDebug()}\n      </div>\n\n      {/* Resize handle */}\n      {!minimized && (\n        <div\n          onMouseDown={onResizeMouseDown}\n          title=\"Resize\"\n          style={{ position: 'absolute', right: 0, bottom: 0, width: 16, height: 16, cursor: 'nwse-resize',\n                   background: 'linear-gradient(135deg, transparent 0, transparent 50%, #666 50%, #666 100%)' }}\n        />\n      )}\n    </div>\n  );\n}\n","import breakEffectsConfig from '../../assets/json/system/object_break_effects.json';\n\nconst normalizeColor = (c) => {\n  if (typeof c === 'number') return c;\n  if (typeof c === 'string') {\n    const raw = c.trim().replace('#', '');\n    const n = parseInt(raw, 16);\n    return Number.isFinite(n) ? n : 0xffffff;\n  }\n  return 0xffffff;\n};\n\nconst getConfig = () => {\n  if (!breakEffectsConfig || breakEffectsConfig.enabled === false) return null;\n  return breakEffectsConfig;\n};\n\nexport const getBreakEffectParams = (def) => {\n  if (!def) return null;\n  const cfg = getConfig();\n  if (!cfg) return null;\n  const id = def.id;\n  const type = def.type;\n  const subtype = def.subtype;\n  const name = def.name;\n  const ids = Array.isArray(cfg.objectIds) ? cfg.objectIds : [];\n  const types = Array.isArray(cfg.objectTypes) ? cfg.objectTypes : [];\n  const matchesValue = (value, list) => {\n    if (!value) return false;\n    return list.some(item => item === value || value.includes(item));\n  };\n  const matched = matchesValue(id, ids) || matchesValue(name, ids) || matchesValue(type, types) || matchesValue(subtype, types);\n  if (!matched) return null;\n  const base = cfg.default || {};\n  const colors = Array.isArray(base.colors) ? base.colors.map(normalizeColor) : [0xffffff];\n  return {\n    count: Number(base.count) || 12,\n    speed: Number(base.speed) || 2,\n    lifeMs: Number(base.lifeMs) || 600,\n    size: Number(base.size) || 2,\n    colors\n  };\n};\n\nexport const shouldTriggerBreakEffect = (def, newHealth) => {\n  if (!def) return false;\n  const params = getBreakEffectParams(def);\n  if (!params) return false;\n  const threshold = Number(def.passableHealthThreshold ?? 0);\n  const hp = Number(newHealth);\n  if (!Number.isFinite(hp)) return false;\n  return hp <= threshold;\n};\n\nexport default {\n  getBreakEffectParams,\n  shouldTriggerBreakEffect\n};\n","import React, { useEffect, useRef } from 'react';\n\n// Lightweight background music player that resolves a meta path like\n// \"/sound/background/track.ogg\" to a build URL via require.context and\n// plays/pauses a looping HTMLAudioElement.\n// Props:\n// - metaPath: string | null  stored in map meta (e.g., \"/sound/background/foo.ogg\")\n// - enabled: boolean  global sound toggle\n// - volume: number (0..1)\n// - isInsideRoom: boolean  apply muffled effect\nexport default function BackgroundMusicPlayer({ metaPath, enabled = false, volume = 0.6, isInsideRoom = false }) {\n  const audioRef = useRef(null);\n  const currentSrcRef = useRef(null);\n  const audioCtxRef = useRef(null);\n  const sourceNodeRef = useRef(null);\n  const filterNodeRef = useRef(null);\n  const gainNodeRef = useRef(null);\n\n  // Resolve ogg assets from src/assets/sound/background\n  let musicContext = null;\n  try {\n    // utilities -> ../assets/sound/background\n    musicContext = require.context('../assets/sound/background', false, /\\.(ogg|mp3|wav|m4a)$/i);\n  } catch (e) {\n    musicContext = null;\n  }\n\n  const resolveUrl = (path) => {\n    if (!path) return null;\n    const name = path.split('/').pop();\n    if (!name) return null;\n    if (musicContext) {\n      try {\n        const mod = musicContext(`./${name}`);\n        return mod.default || mod;\n      } catch (e) {\n        console.warn(`Background music not found: ${name}`);\n      }\n    }\n    return null;\n  };\n\n  const cleanup = () => {\n    try {\n      if (audioRef.current) {\n        audioRef.current.pause();\n        audioRef.current.src = '';\n        audioRef.current = null;\n        currentSrcRef.current = null;\n      }\n      if (audioCtxRef.current) {\n        audioCtxRef.current.close().catch(() => {});\n        audioCtxRef.current = null;\n        sourceNodeRef.current = null;\n        filterNodeRef.current = null;\n        gainNodeRef.current = null;\n      }\n    } catch {}\n  };\n\n  const setupWebAudio = (audio) => {\n    try {\n      const AudioContext = window.AudioContext || window.webkitAudioContext;\n      if (!AudioContext) return;\n\n      const ctx = new AudioContext();\n      const source = ctx.createMediaElementSource(audio);\n      const filter = ctx.createBiquadFilter();\n      const gain = ctx.createGain();\n\n      filter.type = 'lowpass';\n      filter.frequency.value = isInsideRoom ? 800 : 22000;\n      gain.gain.value = isInsideRoom ? 0.5 : 1.0;\n\n      source.connect(filter);\n      filter.connect(gain);\n      gain.connect(ctx.destination);\n\n      audioCtxRef.current = ctx;\n      sourceNodeRef.current = source;\n      filterNodeRef.current = filter;\n      gainNodeRef.current = gain;\n    } catch (e) {\n      console.warn('Web Audio setup failed:', e);\n    }\n  };\n\n  // Build/rebuild audio element when metaPath changes\n  useEffect(() => {\n    const url = resolveUrl(metaPath);\n\n    // If unchanged, just update enabled/volume in next effect\n    if (url && currentSrcRef.current === url && audioRef.current) {\n      return () => {};\n    }\n\n    // Rebuild\n    cleanup();\n    if (!url) return () => {};\n\n    const audio = new Audio(url);\n    audio.loop = true;\n    audio.volume = Math.max(0, Math.min(1, Number(volume) || 0));\n    audioRef.current = audio;\n    currentSrcRef.current = url;\n\n    // Web Audio setup for filters\n    setupWebAudio(audio);\n\n    // Try to pre-play if enabled (may be blocked by autoplay policy)\n    if (enabled) {\n      audio.play().catch(() => {\n        // Will try again on explicit user gesture via custom event\n      });\n    }\n\n    return () => cleanup();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [metaPath]);\n\n  // React to enabled/volume/room changes\n  useEffect(() => {\n    const audio = audioRef.current;\n    if (!audio) return;\n    \n    // Direct audio volume (without Web Audio or as fallback)\n    audio.volume = Math.max(0, Math.min(1, Number(volume) || 0));\n    \n    // Web Audio updates\n    if (audioCtxRef.current) {\n      if (filterNodeRef.current) {\n        filterNodeRef.current.frequency.setTargetAtTime(isInsideRoom ? 800 : 22000, audioCtxRef.current.currentTime, 0.1);\n      }\n      if (gainNodeRef.current) {\n        gainNodeRef.current.gain.setTargetAtTime(isInsideRoom ? 0.4 : 1.0, audioCtxRef.current.currentTime, 0.1);\n      }\n      if (audioCtxRef.current.state === 'suspended' && enabled) {\n        audioCtxRef.current.resume().catch(() => {});\n      }\n    }\n\n    if (enabled) {\n      // Attempt to play; may require user gesture\n      audio.play().catch(() => {\n        // try again on gesture event\n      });\n    } else {\n      try { audio.pause(); } catch {}\n    }\n  }, [enabled, volume, isInsideRoom]);\n\n  // Listen for a gesture-driven event to force playback immediately in handler\n  useEffect(() => {\n    const onGesture = () => {\n      const audio = audioRef.current;\n      if (audio && enabled) {\n        audio.play().catch(() => {});\n      }\n    };\n    const onToggle = (e) => {\n      const val = !!(e && e.detail && e.detail.enabled);\n      const audio = audioRef.current;\n      if (!audio) return;\n      if (val) {\n        audio.play().catch(() => {});\n      } else {\n        try { audio.pause(); } catch {}\n      }\n    };\n    window.addEventListener('game-sound-user-gesture', onGesture);\n    window.addEventListener('game-sound-toggle', onToggle);\n    return () => {\n      window.removeEventListener('game-sound-user-gesture', onGesture);\n      window.removeEventListener('game-sound-toggle', onToggle);\n    };\n  }, [enabled]);\n\n  return null;\n}\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport styled from 'styled-components';\n\nconst Overlay = styled.div`\n    position: absolute;\n    top: 70px;\n    left: 10%;\n    transform: none;\n    width: 80%;\n    text-align: left;\n    pointer-events: none;\n    z-index: 1500;\n    \n    h2 {\n        font-size: 22px;\n        color: white;\n        text-shadow: 0 0 10px rgba(0,0,0,0.8), 0 0 20px rgba(0,0,0,0.5);\n        margin: 0;\n        padding: 12px 14px;\n        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n        font-weight: 800;\n        letter-spacing: 0.5px;\n        white-space: pre-line;\n        line-height: 1;\n        background: rgba(0, 0, 0, 0.45);\n        border: 1px solid rgba(255, 255, 255, 0.2);\n        border-radius: 6px;\n        opacity: ${props => props.$isVisible ? 1 : 0};\n        transition: opacity 2s ease-in-out;\n    }\n`;\n\nexport const MessageOverlay = ({ text, isVisible }) => {\n    if (!text) return null;\n    return (\n        <Overlay $isVisible={isVisible}>\n            <h2>{text}</h2>\n        </Overlay>\n    );\n};\n\nMessageOverlay.propTypes = {\n    text: PropTypes.string,\n    isVisible: PropTypes.bool\n};\n\nMessageOverlay.defaultProps = {\n    text: '',\n    isVisible: false\n};\n\nexport default MessageOverlay;\n","import map1 from '../assets/maps/template.json';\nimport map2 from '../assets/maps/exampel_liquids.json';\nimport map3 from '../assets/maps/exampel_sectors_01.json';\nimport map4 from '../assets/maps/exampel_sectors_02.json';\nimport map5 from '../assets/maps/exampel_m2room.json';\nimport map6 from '../assets/maps/exampel_weather_01.json';\nimport map7 from '../assets/maps/Ports.json';\n\n\nexport const BUILT_IN_MAPS = [\n    map1,\n    map2,\n    map3,\n    map4,\n    map5,\n    map6,\n    map7\n];\n","import React, { useState, useEffect, useMemo, useRef, useCallback } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { useTranslation } from 'react-i18next';\nimport { getRegistry, findItemById } from '../../../engine/registry';\nimport PixiStage from './PixiStage';\nimport { useGameEngine } from '../../../utilities/useGameEngine';\nimport GameHeader from './GameHeader';\nimport GameTerminal from './GameTerminal';\nimport GameSettings from './GameSettings';\nimport { findSpawnPosition } from '../../../engine/gameplay/interactables';\nimport { applyWolfSecretShift, shouldRemoveCrackBlock } from '../../../engine/gameplay/secrets';\nimport { shouldTriggerBreakEffect, getBreakEffectParams } from '../../../engine/gameplay/breakEffects';\nimport BackgroundMusicPlayer from '../../../utilities/BackgroundMusicPlayer';\nimport { setActiveMap, removeObjectAtIndex, removeTileAtIndex, moveTileInMap, moveObjectInMap, updateObjectAtIndex, updateObjectMetadata, setObjectTextureIndex, revealSecretZone, resetGame, setGameOver, toggleRoom, clearRooms } from '../../../store/slices/gameSlice';\nimport { setMapModalOpen, setCameraScrollX, setShouldCenterMap } from '../../../store/slices/uiSlice';\nimport errorHandler from '../../../services/errorHandler';\nimport styled from 'styled-components';\nimport MessageOverlay from '../shared/MessageOverlay';\n\nimport { BUILT_IN_MAPS } from '../../../constants/builtInMaps';\nimport { TILE_SIZE } from '../../../constants/gameConstants';\n\n// Styled Components\nconst GameContainer = styled.div`\n    position: relative;\n    height: 100%;\n    overflow: hidden;\n    background-color: #333;\n`;\n\nconst ModalOverlay = styled.div`\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background-color: rgba(0, 0, 0, 0.6);\n    z-index: 3000;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    backdrop-filter: blur(2px);\n`;\n\nconst ModalContent = styled.div`\n    background-color: #fff;\n    padding: 20px;\n    border-radius: 8px;\n    width: 900px;\n    max-width: 95%;\n    max-height: 85%;\n    overflow-y: auto;\n    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);\n    display: flex;\n    flex-direction: column;\n    gap: 15px;\n`;\n\nconst ModalTitle = styled.h2`\n    margin: 0;\n    border-bottom: 2px solid #eee;\n    padding-bottom: 10px;\n`;\n\nconst MapList = styled.div`\n    display: grid;\n    grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));\n    gap: 15px;\n    padding: 5px;\n`;\n\nconst MapCard = styled.div`\n    border: 1px solid #ddd;\n    border-radius: 8px;\n    padding: 15px;\n    cursor: pointer;\n    background-color: #f9f9f9;\n    display: flex;\n    flex-direction: column;\n    gap: 10px;\n    transition: all 0.2s ease;\n\n    &:hover {\n        background-color: #f0f7ff;\n        border-color: #2196f3;\n        transform: translateY(-3px);\n        box-shadow: 0 5px 15px rgba(0,0,0,0.1);\n    }\n`;\n\nconst MapTitle = styled.div`\n    font-weight: bold;\n    font-size: 16px;\n    color: #333;\n`;\n\nconst MapAuthor = styled.div`\n    font-size: 12px;\n    color: #666;\n`;\n\nconst MapDescription = styled.div`\n    font-size: 11px;\n    color: #777;\n    font-style: italic;\n    line-height: 1.4;\n    display: -webkit-box;\n    -webkit-line-clamp: 3;\n    -webkit-box-orient: vertical;\n    overflow: hidden;\n    min-height: 45px;\n`;\n\nconst MapInfo = styled.div`\n    margin-top: auto;\n    padding-top: 8px;\n    border-top: 1px solid #eee;\n    font-size: 11px;\n    color: #555;\n    display: flex;\n    justify-content: space-between;\n`;\n\nconst WinCounterOverlay = styled.div`\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    font-size: 120px;\n    font-weight: bold;\n    color: #fff;\n    text-shadow: 0 0 20px rgba(0,0,0,0.8), 0 0 40px rgba(255,255,255,0.5);\n    z-index: 2000;\n    pointer-events: none;\n    font-family: 'Courier New', Courier, monospace;\n`;\n\nconst GameOverOverlay = styled.div`\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background-color: rgba(0, 0, 0, 0.8);\n    z-index: 2500;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    color: white;\n    backdrop-filter: blur(4px);\n    animation: fadeIn 0.5s ease-out;\n\n    @keyframes fadeIn {\n        from { opacity: 0; }\n        to { opacity: 1; }\n    }\n`;\n\nconst GameOverTitle = styled.h1`\n    font-size: 72px;\n    margin: 0 0 30px 0;\n    text-transform: uppercase;\n    letter-spacing: 5px;\n    color: #ff4444;\n    text-shadow: 0 0 20px rgba(255, 0, 0, 0.5), 0 5px 15px rgba(0,0,0,0.8);\n    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n    font-weight: 900;\n`;\n\nconst ReplayButton = styled.button`\n    padding: 18px 50px;\n    font-size: 28px;\n    background: linear-gradient(180deg, #4CAF50, #2E7D32);\n    color: white;\n    border: 2px solid #fff;\n    border-radius: 50px;\n    cursor: pointer;\n    font-weight: bold;\n    box-shadow: 0 5px 15px rgba(0,0,0,0.3);\n    transition: all 0.2s ease;\n    outline: none;\n\n    &:hover {\n        background: linear-gradient(180deg, #66BB6A, #388E3C);\n        transform: scale(1.05) translateY(-2px);\n        box-shadow: 0 8px 20px rgba(0,0,0,0.4);\n    }\n\n    &:active {\n        transform: scale(0.98) translateY(0);\n    }\n`;\n\nconst ModalDivider = styled.div`\n    border-top: 2px solid #eee;\n    padding-top: 15px;\n    margin-top: 10px;\n`;\n\nconst FileUploadLabel = styled.label`\n    padding: 8px 16px;\n    background-color: #2196F3;\n    color: white;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n    font-weight: bold;\n    text-align: center;\n    display: inline-block;\n    width: 100%;\n    box-sizing: border-box;\n\n    &:hover {\n        background-color: #1976D2;\n    }\n`;\n\nconst HiddenFileInput = styled.input`\n    display: none;\n`;\n\nconst Viewport = styled.div`\n    height: 100%;\n    overflow: hidden;\n    filter: ${props => props.$blurred ? 'blur(5px)' : 'none'};\n    pointer-events: ${props => props.$blurred ? 'none' : 'auto'};\n    transition: filter 0.3s ease;\n`;\n\nconst GameCanvas = styled.div`\n    position: relative;\n    width: 100%;\n    height: 100%;\n    background-color: #111;\n`;\n\nconst PlaceholderMessage = styled.div`\n    color: #777;\n    font-size: 24px;\n`;\n\nexport default function Game() {\n    const { t } = useTranslation('game');\n    const dispatch = useDispatch();\n    const viewportRef = useRef(null);\n\n    // Redux state\n    const gameState = useSelector(state => state.game) || {};\n    const uiState = useSelector(state => state.ui) || {};\n    const {\n        activeMapData = null,\n        tileMapData = [],\n        objectMapData = [],\n        secretMapData = [],\n        objectMetadata = {},\n        revealedSecrets = [],\n        objectTextureIndices = {},\n        mapWidth = 20,\n        mapHeight = 15,\n        isGameOver = false,\n        activeRoomIds = [],\n        projectMaps = {}\n    } = gameState;\n    const {\n        isMapModalOpen = true,\n        cameraScrollX = 0,\n        shouldCenterMap = false\n    } = uiState;\n    const [soundEnabled, setSoundEnabled] = useState(() => {\n        try {\n            const v = localStorage.getItem('game_sound_enabled');\n            if (v === null) return false;\n            return v !== '0';\n        } catch {\n            return false;\n        }\n    });\n\n    // Runtime settings that can be changed from GameSettings on the fly\n    const [runtimeSettings, setRuntimeSettings] = useState({});\n\n    // In-game messages\n    const [gameMessage, setGameMessage] = useState({ text: '', isVisible: false });\n    const messageTimerRef = useRef(null);\n\n    useEffect(() => {\n        const onToggle = (e) => {\n            const enabled = !!(e?.detail?.enabled);\n            setSoundEnabled(enabled);\n            try { localStorage.setItem('game_sound_enabled', enabled ? '1' : '0'); } catch {}\n        };\n        window.addEventListener('game-sound-toggle', onToggle);\n        return () => window.removeEventListener('game-sound-toggle', onToggle);\n    }, []);\n\n    useEffect(() => {\n        if (messageTimerRef.current) {\n            clearTimeout(messageTimerRef.current);\n            messageTimerRef.current = null;\n        }\n        setGameMessage({ text: '', isVisible: false });\n    }, [activeMapData]);\n\n    // Registry\n    const registryItems = getRegistry() || [];\n\n    const handleGameOver = () => {\n        dispatch(setGameOver(true));\n    };\n\n    const handleReplay = () => {\n        if (activeMapData) {\n            console.log(\"Replaying map...\");\n            const mapToLoad = {\n                ...activeMapData,\n                meta: {\n                    ...activeMapData.meta,\n                    date_map_last_updated: new Date().toISOString()\n                }\n            };\n            loadMapData(mapToLoad);\n            dispatch(setGameOver(false));\n        }\n    };\n\n    const playerStateRef = useRef(null);\n    const activeMapIdRef = useRef(null);\n    const isGameOverRef = useRef(false);\n\n    useEffect(() => {\n        const id = activeMapData?.meta?.activeMapId || activeMapData?.meta?.activeMap || 'main';\n        activeMapIdRef.current = id;\n    }, [activeMapData]);\n\n    useEffect(() => {\n        isGameOverRef.current = !!isGameOver;\n    }, [isGameOver]);\n\n    const handleStateUpdate = useCallback((action, payload) => {\n        if (action === 'collectItem') {\n            const { index, mapId } = typeof payload === 'object' ? payload : { index: payload, mapId: null };\n            dispatch(removeObjectAtIndex({ index, mapId }));\n        } else if (action === 'interactable') {\n            const { index, mapId } = typeof payload === 'object' ? payload : { index: payload, mapId: null };\n            \n            const targetObjectData = (!mapId || mapId === 'main') ? objectMapData : (activeMapData?.maps?.[mapId]?.objectMapData || []);\n            const currentId = targetObjectData[index];\n            \n            if (currentId) {\n                dispatch(updateObjectAtIndex({ index, newId: currentId + '_used', mapId }));\n            }\n        } else if (action === 'setObjectFrame') {\n            const { index, frame, mapId } = payload;\n            dispatch(updateObjectMetadata({ index, metadata: { currentFrame: frame }, mapId }));\n        } else if (action === 'switchMap') {\n            const { targetMapId, triggerId } = payload;\n            const projectMapsResolved = Object.keys(projectMaps || {}).length\n                ? projectMaps\n                : (activeMapData?.maps || activeMapData?.projectMaps || {});\n            const targetMap = projectMapsResolved[targetMapId];\n            \n            if (targetMap && targetMap.type === 'room') {\n                if (!activeRoomIds.includes(targetMapId)) {\n                    dispatch(toggleRoom(targetMapId));\n                }\n                return;\n            } else if (targetMapId === 'main' && activeRoomIds.length > 0) {\n                dispatch(clearRooms());\n                \n                // Open the door at the exit target position to prevent getting stuck\n                const spawn = findSpawnPosition(activeMapData, triggerId, 32);\n                if (spawn) {\n                    const spawnIdx = (Math.floor(spawn.y / 32) * mapWidth) + Math.floor(spawn.x / 32);\n                    const spawnObjId = objectMapData[spawnIdx];\n                    const spawnDef = registryItems.find(r => r.id === spawnObjId);\n                    if (spawnDef && spawnDef.subtype === 'door') {\n                        dispatch(updateObjectMetadata({ \n                            index: spawnIdx, \n                            metadata: { currentFrame: spawnDef.interaction?.frames?.opening || 1 } \n                        }));\n                    }\n                }\n                return;\n            }\n            \n            if (targetMap) {\n                console.log(`Switching to map: ${targetMapId}, looking for trigger: ${triggerId}`);\n                \n                // Ms varam vienkri nodot visu projektu un pielikt spawnTriggerId\n                const projectToLoad = {\n                    ...activeMapData,\n                    maps: projectMapsResolved,\n                    meta: {\n                        ...activeMapData.meta,\n                        activeMapId: targetMapId,\n                        spawnTriggerId: triggerId\n                    }\n                };\n                \n                loadMapData(projectToLoad);\n            }\n        } else if (action === 'objectDamage') {\n            const { index, damage } = payload;\n            const objId = objectMapData[index];\n            if (objId) {\n                const def = registryItems.find(r => r.id === objId);\n                if (def && def.isDestructible) {\n                    const currentMeta = objectMetadata[index] || {};\n                    const maxH = def.maxHealth || 100;\n                    const newHealth = Math.max(0, (currentMeta.health !== undefined ? currentMeta.health : maxH) - damage);\n                    const metaPatch = { health: newHealth };\n                    if (shouldTriggerBreakEffect(def, newHealth) && !currentMeta.breakFxPlayed) {\n                        metaPatch.breakFxPlayed = true;\n                        const cfg = getBreakEffectParams(def);\n                        if (cfg) {\n                            const x = (index % mapWidth) * TILE_SIZE + TILE_SIZE / 2;\n                            const y = Math.floor(index / mapWidth) * TILE_SIZE + TILE_SIZE / 2;\n                            window.dispatchEvent(new CustomEvent('game-break-effect', {\n                                detail: { x, y, config: cfg }\n                            }));\n                        }\n                    }\n                    dispatch(updateObjectMetadata({ index, metadata: metaPatch }));\n\n                    if (shouldRemoveCrackBlock(def, newHealth)) {\n                        dispatch(removeTileAtIndex(index));\n                    }\n\n                    const x = (index % mapWidth) * TILE_SIZE + TILE_SIZE / 2;\n                    const y = Math.floor(index / mapWidth) * TILE_SIZE;\n                    window.dispatchEvent(new CustomEvent('game-floating-text', {\n                        detail: { x, y, text: `-${damage}`, color: '#ff3b3b', amount: damage }\n                    }));\n                }\n            }\n        } else if (action === 'entityDamage' && payload) {\n            const { x, y, amount } = payload;\n            if (Number.isFinite(x) && Number.isFinite(y) && Number.isFinite(amount)) {\n                window.dispatchEvent(new CustomEvent('game-floating-text', {\n                    detail: { x, y, text: `-${Math.round(amount)}`, color: '#ff3b3b', amount }\n                }));\n            }\n        } else if (action === 'shiftTile' && payload) {\n            const { index, dx, dy } = payload;\n            const mapIdAtStart = activeMapIdRef.current;\n            applyWolfSecretShift({\n                index,\n                dx,\n                dy,\n                mapWidth,\n                mapHeight,\n                getObjectId: idx => objectMapData[idx],\n                getObjectDef: objId => registryItems.find(r => r.id === objId),\n                moveTile: (from, to) => dispatch(moveTileInMap({ fromIndex: from, toIndex: to })),\n                moveObject: (from, to) => dispatch(moveObjectInMap({ fromIndex: from, toIndex: to })),\n                removeObject: idx => dispatch(removeObjectAtIndex(idx)),\n                shouldCancel: () => isGameOverRef.current || activeMapIdRef.current !== mapIdAtStart\n            });\n        } else if (action === 'playerDamage' && payload !== undefined) {\n            const { damage, x, y } = payload || {};\n            const ps = playerStateRef.current;\n            const px = Number.isFinite(x) ? x : (ps?.x || 0) + (ps?.width || TILE_SIZE) / 2;\n            const py = Number.isFinite(y) ? y : (ps?.y || 0);\n            if (Number.isFinite(px) && Number.isFinite(py) && Number.isFinite(damage)) {\n                window.dispatchEvent(new CustomEvent('game-floating-text', {\n                    detail: { x: px, y: py, text: `-${Math.round(damage)}`, color: '#ff3b3b', amount: damage }\n                }));\n            }\n        } else if (action === 'floatingText' && payload) {\n            const { x, y, text, color, amount } = payload;\n            if (Number.isFinite(x) && Number.isFinite(y) && text) {\n                window.dispatchEvent(new CustomEvent('game-floating-text', {\n                    detail: { x, y, text, color, amount }\n                }));\n            }\n        } else if (action === 'levelWin') {\n            console.log(\"Level Win! Returning to map selection.\");\n            setTimeout(() => {\n                alert(\"Level Complete!\");\n                dispatch(setMapModalOpen(true));\n            }, 500);\n        } else if (action === 'updateWeather' && payload) {\n            const { type, value } = payload;\n            const settingKey = 'weather' + type.charAt(0).toUpperCase() + type.slice(1); // e.g., weatherRain\n            setRuntimeSettings(prev => ({ ...prev, [settingKey]: value }));\n            \n            // Dispatch event so UI components like GameSettings can update their state\n            window.dispatchEvent(new CustomEvent('game-settings-update', { \n                detail: { [settingKey]: value } \n            }));\n        } else if (action === 'weatherEffectHit' && payload) {\n            const { type, data } = payload;\n            // o darbbu ms izmantosim, lai nodotu informciju dzinjam caur ref vai eventu\n            // Bet labk ir tiei izsaukt dzinja funkciju, ja tda ir.\n            // T k useGameEngine ir hook, ms nevaram viegli izsaukt t iekjo funkciju.\n            // Tomr ms varam izmantot window eventu vai ref.\n            window.dispatchEvent(new CustomEvent('weather-effect-hit', { detail: { type, data } }));\n        } else if (action === 'showMessage' && payload) {\n            const { text, duration } = payload;\n            \n            if (messageTimerRef.current) {\n                clearTimeout(messageTimerRef.current);\n            }\n            \n            setGameMessage({ text, isVisible: true });\n            \n            messageTimerRef.current = setTimeout(() => {\n                setGameMessage(prev => ({ ...prev, isVisible: false }));\n                messageTimerRef.current = null;\n            }, duration || 8000);\n        }\n    }, [dispatch, objectMapData, objectMetadata, registryItems]);\n\n    // We no longer need 'engineMapData' with layers, as we pass objectMapData separately.\n    // So we pass the original 'activeMapData' as first argument (for initialization to work correctly and not reset),\n    // and 'objectMapData' as third argument for item checking.\n\n    // Callback for revealing secret zones\n    const handleRevealSecret = (indices) => {\n        dispatch(revealSecretZone(indices));\n    };\n\n    // --- START ENGINE ---\n    // Engine returns player coordinates and state\n    // objectMapData contains dynamic data (removed items)\n    const playerState = useGameEngine(\n        activeMapData,\n        tileMapData,\n        objectMapData,\n        secretMapData,\n        revealedSecrets,\n        registryItems,\n        handleGameOver,\n        handleStateUpdate,\n        handleRevealSecret,\n        objectMetadata,\n        activeRoomIds,\n        mapWidth,\n        mapHeight\n    );\n    useEffect(() => {\n        playerStateRef.current = playerState;\n    }, [playerState]);\n\n    // Iegstam spltja vizulo izskatu (Texture)\n    const playerVisuals = useMemo(() => {\n        // eit vartu bt loika, kas maina tekstru atkarb no playerState.direction vai playerState.vx\n        // Pagaidm paemam noklusto\n        return findItemById(\"player_default_100\") || findItemById(\"player\");\n    }, []);\n    // --- END ENGINE ---\n\n    // Listen for runtime settings updates from GameSettings (live apply)\n    useEffect(() => {\n        const onSettingsUpdate = (e) => {\n            const patch = (e && e.detail) || {};\n            setRuntimeSettings(prev => ({ ...prev, ...patch }));\n        };\n        window.addEventListener('game-settings-update', onSettingsUpdate);\n        return () => window.removeEventListener('game-settings-update', onSettingsUpdate);\n    }, []);\n\n    // Listen for navigation buttons\n    useEffect(() => {\n        const handleOpenModalEvent = () => {\n            dispatch(setMapModalOpen(true));\n            dispatch(setGameOver(false)); // Reset game over when opening new game modal\n        };\n        window.addEventListener('open-new-game-modal', handleOpenModalEvent);\n        return () => window.removeEventListener('open-new-game-modal', handleOpenModalEvent);\n    }, [dispatch]);\n\n    // Mirror current effective runtime settings for other components to read (like GameSettings)\n    useEffect(() => {\n        try {\n            const clouds = (runtimeSettings.weatherClouds ?? 0);\n            const fog = (runtimeSettings.weatherFog ?? 0);\n            const thunder = (runtimeSettings.weatherThunder ?? 0);\n            window.__GAME_RUNTIME_SETTINGS__ = {\n                ...(window.__GAME_RUNTIME_SETTINGS__ || {}),\n                backgroundParallaxFactor: (runtimeSettings.backgroundParallaxFactor ?? activeMapData?.meta?.backgroundParallaxFactor ?? 0.3),\n                weatherRain: (runtimeSettings.weatherRain ?? 0),\n                weatherSnow: (runtimeSettings.weatherSnow ?? 0),\n                weatherLavaRain: (runtimeSettings.weatherLavaRain ?? 0),\n                weatherRadioactiveFog: (runtimeSettings.weatherRadioactiveFog ?? 0),\n                weatherMeteorRain: (runtimeSettings.weatherMeteorRain ?? 0),\n                weatherClouds: clouds,\n                weatherFog: fog,\n                weatherThunder: thunder,\n                healthBarEnabled: (runtimeSettings.healthBarEnabled ?? true),\n                oxygenBarEnabled: (runtimeSettings.oxygenBarEnabled ?? true),\n                lavaBarEnabled: (runtimeSettings.lavaBarEnabled ?? true),\n                waterSplashesEnabled: (runtimeSettings.waterSplashesEnabled ?? true),\n                lavaEmbersEnabled: (runtimeSettings.lavaEmbersEnabled ?? true),\n                roomBlurEnabled: (runtimeSettings.roomBlurEnabled ?? true),\n                debugOverlayEnabled: (runtimeSettings.debugOverlayEnabled ?? false),\n                // legacy mirror for compatibility (e.g., older UI)\n                weatherFogLegacy: fog,\n            };\n        } catch {}\n    }, [runtimeSettings, activeMapData]);\n\n    const cloneMapData = (data) => {\n        if (!data) return data;\n        try {\n            if (typeof structuredClone === 'function') {\n                return structuredClone(data);\n            }\n        } catch {}\n        try {\n            return JSON.parse(JSON.stringify(data));\n        } catch {\n            return data;\n        }\n    };\n\n    const loadMapData = (mapData) => {\n        try {\n            if (!mapData) {\n                errorHandler.warn('loadMapData called with empty mapData', { component: 'Game' });\n                return;\n            }\n\n            const sourceMapData = cloneMapData(mapData);\n            let effectiveMapData = sourceMapData;\n            \n            // Atbalsts Version 2.0 (Multi-map project)\n            if (sourceMapData.meta?.version === \"2.0\" && sourceMapData.maps) {\n                const activeId = sourceMapData.meta.activeMapId || Object.keys(sourceMapData.maps)[0];\n                const activeMap = sourceMapData.maps[activeId];\n                \n                if (activeMap) {\n                    const activeLayers = activeMap.layers || [];\n                    const bgLayer = activeLayers.find(l => l.name === 'background' || l.type === 'tile');\n                    const objLayer = activeLayers.find(l => l.name === 'entities' || l.type === 'object');\n                    const secretLayer = activeLayers.find(l => l.name === 'secrets' || l.type === 'secret');\n                    const mapTileData = activeMap.tileMapData || bgLayer?.data;\n                    const mapObjectData = activeMap.objectMapData || objLayer?.data;\n                    const mapSecretData = activeMap.secretMapData || secretLayer?.data;\n\n                    // Konvertjam uz formtu, ko saprot dzinjs un setActiveMap\n                    effectiveMapData = {\n                        ...sourceMapData, // Saglabjam visu projektu\n                        meta: {\n                            ...sourceMapData.meta,\n                            width: activeMap.width,\n                            height: activeMap.height,\n                            name: activeMap.name,\n                            backgroundImage: activeMap.backgroundImage,\n                            backgroundColor: activeMap.backgroundColor,\n                            backgroundMusic: activeMap.backgroundMusic,\n                            backgroundParallaxFactor: activeMap.backgroundParallaxFactor,\n                            weather: activeMap.weather,\n                            objectMetadata: activeMap.objectMetadata || {},\n                            playerPosition: activeMap.playerPosition\n                        },\n                        layers: [\n                            { name: 'background', data: mapTileData || Array((activeMap.width || 0) * (activeMap.height || 0)).fill(null) },\n                            { name: 'entities', data: mapObjectData || Array((activeMap.width || 0) * (activeMap.height || 0)).fill(null) },\n                            { name: 'secrets', data: mapSecretData || Array((activeMap.width || 0) * (activeMap.height || 0)).fill(null) }\n                        ]\n                    };\n                }\n            }\n\n            const nowIso = new Date().toISOString();\n            if (!effectiveMapData.meta) effectiveMapData.meta = {};\n            effectiveMapData.meta.date_map_last_updated = nowIso;\n\n            const w = effectiveMapData.meta?.width || effectiveMapData.width || 20;\n            const h = effectiveMapData.meta?.height || effectiveMapData.height || 15;\n\n            let tileData = [];\n            let objData = [];\n            let secretData = [];\n\n            if (effectiveMapData.layers) {\n                const bgLayer = effectiveMapData.layers.find(l => l.name === 'background' || l.type === 'tile');\n                tileData = bgLayer ? bgLayer.data : Array(w * h).fill(null);\n\n                const objLayer = effectiveMapData.layers.find(l => l.name === 'entities' || l.type === 'object');\n                objData = objLayer ? objLayer.data : Array(w * h).fill(null);\n\n                const secretLayer = effectiveMapData.layers.find(l => l.name === 'secrets' || l.type === 'secret');\n                secretData = secretLayer ? secretLayer.data : Array(w * h).fill(null);\n            } else {\n                tileData = effectiveMapData.tiles || Array(w * h).fill(null);\n                objData = Array(w * h).fill(null);\n                secretData = Array(w * h).fill(null);\n            }\n\n            // Update Redux store\n            dispatch(setActiveMap({\n                mapData: effectiveMapData,\n                tileMapData: tileData,\n                objectMapData: objData,\n                secretMapData: secretData,\n                mapWidth: w,\n                mapHeight: h\n            }));\n            dispatch(setCameraScrollX(0));\n            dispatch(setMapModalOpen(false));\n            dispatch(setGameOver(false)); // Ensure game over is reset on map load\n\n            errorHandler.info('Map loaded successfully', {\n                component: 'Game',\n                mapName: effectiveMapData.meta?.name || 'Unknown',\n                dimensions: `${w}x${h}`\n            });\n        } catch (error) {\n            errorHandler.error(error, {\n                component: 'Game',\n                function: 'loadMapData',\n                mapData\n            });\n            alert('Error loading map. Check console for details.');\n        }\n    };\n\n    const handleCustomMapUpload = (event) => {\n        try {\n            const file = event.target.files[0];\n            if (!file) return;\n\n            const fileReader = new FileReader();\n            fileReader.readAsText(file, \"UTF-8\");\n            fileReader.onload = (e) => {\n                try {\n                    const loaded = JSON.parse(e.target.result);\n                    loadMapData(loaded);\n                } catch (error) {\n                    errorHandler.error(error, {\n                        component: 'Game',\n                        function: 'handleCustomMapUpload',\n                        fileName: file.name\n                    });\n                    alert(\"Invalid map file! Check console for details.\");\n                }\n            };\n            fileReader.onerror = (error) => {\n                errorHandler.error(error, {\n                    component: 'Game',\n                    function: 'handleCustomMapUpload',\n                    fileName: file.name,\n                    phase: 'fileReader'\n                });\n                alert(\"Error reading file!\");\n            };\n        } catch (error) {\n            errorHandler.error(error, {\n                component: 'Game',\n                function: 'handleCustomMapUpload'\n            });\n        }\n    };\n\n    const debugOverlayEnabled = !!(runtimeSettings.debugOverlayEnabled);\n    const debugMapId = activeMapData?.meta?.activeMapId || activeMapData?.meta?.activeMap || 'main';\n\n    return (\n        <GameContainer onClick={() => {\n            window.dispatchEvent(new CustomEvent('game-sound-user-gesture'));\n        }}>\n        \n            {/* Game Header */}\n            {/* UI Overlays */}\n            {playerState?.isWinning && (\n                <WinCounterOverlay>\n                    {Math.floor(playerState.winCounter || 0)}\n                </WinCounterOverlay>\n            )}\n\n            <MessageOverlay text={gameMessage.text} isVisible={gameMessage.isVisible} />\n\n            <GameHeader \n                health={playerState.health} \n                maxHealth={playerState.maxHealth}\n                ammo={playerState.ammo || 0} \n                fishCount={playerState.fishCount || 0}\n                oxygen={playerState.oxygen}\n                maxOxygen={playerState.maxOxygen}\n                lavaResist={playerState.lavaResist}\n                maxLavaResist={playerState.maxLavaResist}\n                iceResist={playerState.iceResist}\n                maxIceResist={playerState.maxIceResist}\n                strength={playerState.strength}\n                maxStrength={playerState.maxStrength}\n                radioactivity={playerState.radioactivity}\n                maxRadioactivity={playerState.maxRadioactivity}\n                inWater={playerState.inWater}\n                liquidType={playerState.liquidType}\n                onIce={playerState.onIce}\n            />\n\n            {debugOverlayEnabled && (\n                <div style={{\n                    position: 'absolute',\n                    top: 70,\n                    left: 70,\n                    background: 'rgba(0,0,0,0.6)',\n                    color: '#eaeaea',\n                    padding: '8px 10px',\n                    fontSize: 11,\n                    lineHeight: 1.4,\n                    borderRadius: 4,\n                    zIndex: 2100,\n                    pointerEvents: 'none',\n                    fontFamily: 'ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, \"Liberation Mono\", \"Courier New\", monospace'\n                }}>\n                    <div>Map: {debugMapId}</div>\n                    <div>Pos: {Math.round(playerState.x || 0)}, {Math.round(playerState.y || 0)}</div>\n                    <div>Room: {Array.isArray(activeRoomIds) && activeRoomIds.length ? activeRoomIds.join(', ') : 'none'}</div>\n                    <div>Weather: rain {runtimeSettings.weatherRain ?? 0} | snow {runtimeSettings.weatherSnow ?? 0} | fog {runtimeSettings.weatherFog ?? 0}</div>\n                    <div>Weather: lava {runtimeSettings.weatherLavaRain ?? 0} | radio {runtimeSettings.weatherRadioactiveFog ?? 0}</div>\n                    <div>HP {Math.round(playerState.health || 0)} / {Math.round(playerState.maxHealth || 0)}</div>\n                    <div>O2 {Math.round(playerState.oxygen || 0)} | Lava {Math.round(playerState.lavaResist || 0)} | Rad {Math.round(playerState.radioactivity || 0)}</div>\n                </div>\n            )}\n\n\n            {isGameOver && (\n                <GameOverOverlay>\n                    <GameOverTitle>Game Over</GameOverTitle>\n                    <ReplayButton onClick={handleReplay}>\n                        REPLAY \n                    </ReplayButton>\n                </GameOverOverlay>\n            )}\n\n            {isMapModalOpen && (\n                <ModalOverlay>\n                    <ModalContent>\n                        <ModalTitle>{t('GAME_MAP_SELECT_TITLE')}</ModalTitle>\n                        <MapList>\n                            {BUILT_IN_MAPS.map((map, index) => {\n                                const isV2 = map.meta?.version === \"2.0\";\n                                const projectName = map.meta?.projectName || map.meta?.name || \"Unnamed Map\";\n                                const author = map.meta?.author || \"Unknown\";\n                                \n                                let sizeInfo = \"\";\n                                let subMapInfo = \"\";\n\n                                if (isV2 && map.maps) {\n                                    const mainMap = map.maps[map.meta?.activeMapId || 'main'] || Object.values(map.maps)[0];\n                                    if (mainMap) {\n                                        sizeInfo = `${mainMap.width}x${mainMap.height}`;\n                                    }\n                                    \n                                    const mapValues = Object.values(map.maps);\n                                    const overworldCount = mapValues.filter(m => m.type === 'overworld').length;\n                                    const underworldCount = mapValues.filter(m => m.type === 'underworld').length;\n                                    \n                                    subMapInfo = ` (O:${overworldCount}, U:${underworldCount})`;\n                                } else {\n                                    sizeInfo = `${map.meta?.width || map.width || 0}x${map.meta?.height || map.height || 0}`;\n                                }\n\n                                return (\n                                    <MapCard key={index} onClick={() => loadMapData(map)}>\n                                        <div>\n                                            <MapTitle>{projectName}</MapTitle>\n                                            <MapAuthor>{t('GAME_MAP_BY', { author })}</MapAuthor>\n                                        </div>\n                                        {map.meta?.description && (\n                                            <MapDescription title={map.meta.description}>\n                                                {map.meta.description}\n                                            </MapDescription>\n                                        )}\n                                        <MapInfo>\n                                            <div>{t('GAME_MAP_SIZE', { size: `${sizeInfo}${subMapInfo}` })}</div>\n                                        </MapInfo>\n                                    </MapCard>\n                                );\n                            })}\n                        </MapList>\n                        <ModalDivider>\n                            <FileUploadLabel>\n                                 {t('GAME_MAP_LOAD_CUSTOM')}\n                                <HiddenFileInput type=\"file\" accept=\".json\" onChange={handleCustomMapUpload} />\n                            </FileUploadLabel>\n                        </ModalDivider>\n                    </ModalContent>\n                </ModalOverlay>\n            )}\n\n            <Viewport\n                ref={viewportRef}\n                $blurred={isMapModalOpen}\n            >\n                {activeMapData ? (\n                    <GameCanvas>\n                    \n                        {/* PIXI RENDERER */}\n                        <PixiStage\n                            mapWidth={mapWidth}\n                            mapHeight={mapHeight}\n                            tileSize={32}\n                            tileMapData={tileMapData}\n                            objectMapData={objectMapData}\n                            secretMapData={secretMapData}\n                            revealedSecrets={revealedSecrets}\n                            objectTextureIndices={objectTextureIndices}\n                            registryItems={registryItems}\n                            playerState={playerState}\n                            playerVisuals={playerVisuals}\n                            projectiles={playerState.projectiles || []}\n                            objectMetadata={objectMetadata}\n                            backgroundImage={activeMapData?.meta?.backgroundImage}\n                            backgroundColor={activeMapData?.meta?.backgroundColor}\n                            backgroundParallaxFactor={(runtimeSettings.backgroundParallaxFactor ?? activeMapData?.meta?.backgroundParallaxFactor)}\n                            cameraScrollX={cameraScrollX}\n                            weatherRain={runtimeSettings.weatherRain ?? 0}\n                            weatherLavaRain={runtimeSettings.weatherLavaRain ?? 0}\n                            weatherSnow={runtimeSettings.weatherSnow ?? 0}\n                            weatherMeteorRain={runtimeSettings.weatherMeteorRain ?? 0}\n                            weatherClouds={runtimeSettings.weatherClouds ?? 0}\n                            weatherFog={runtimeSettings.weatherFog ?? 0}\n                            weatherRadioactiveFog={runtimeSettings.weatherRadioactiveFog ?? 0}\n                            weatherThunder={runtimeSettings.weatherThunder ?? 0}\n                            onWeatherEffectHit={(type, data) => handleStateUpdate('weatherEffectHit', { type, data })}\n                            healthBarEnabled={runtimeSettings.healthBarEnabled ?? true}\n                            oxygenBarEnabled={runtimeSettings.oxygenBarEnabled ?? true}\n                            lavaBarEnabled={runtimeSettings.lavaBarEnabled ?? true}\n                            waterSplashesEnabled={runtimeSettings.waterSplashesEnabled ?? true}\n                            lavaEmbersEnabled={runtimeSettings.lavaEmbersEnabled ?? true}\n                            roomBlurEnabled={runtimeSettings.roomBlurEnabled ?? true}\n                            debugOverlayEnabled={runtimeSettings.debugOverlayEnabled ?? false}\n                            isEditor={false}\n                            mapType={activeMapData?.type || 'overworld'}\n                            activeRoomIds={activeRoomIds}\n                            maps={projectMaps}\n                        />\n\n                    </GameCanvas>\n                ) : (\n                    <PlaceholderMessage>Select a map to start playing</PlaceholderMessage>\n                )}\n            </Viewport>\n\n            {/* Background music runtime player */}\n            <BackgroundMusicPlayer \n                metaPath={activeMapData?.meta?.backgroundMusic} \n                enabled={soundEnabled} \n                volume={0.6} \n                isInsideRoom={activeRoomIds.length > 0}\n            />\n\n            {/* Overlays at root level so they sit above the canvas and slide from the footer area */}\n            <GameSettings />\n            <GameTerminal />\n        </GameContainer>\n    );\n}\n","// Progressive save utility for web: prefers File System Access API (Chromium)\n// Fallbacks to classic Blob download when not available or when permission denied.\n\n/**\n * Save a file, letting the user choose directory/filename when supported.\n * @param {string|Blob|Uint8Array} contents - Data to write\n * @param {string} suggestedName - Suggested filename, e.g., \"my_map.json\"\n * @param {string} mimeType - MIME type, e.g., \"application/json\"\n * @returns {Promise<boolean>} true if saved, false if cancelled or failed\n */\nexport async function saveFile(contents, suggestedName = 'file.txt', mimeType = 'application/octet-stream') {\n  try {\n    // Prefer native file picker if available (Chromium: Edge/Chrome/Opera/Brave)\n    const hasPicker = typeof window !== 'undefined' && typeof window.showSaveFilePicker === 'function';\n    if (hasPicker) {\n      const opts = {\n        suggestedName,\n        types: [\n          {\n            description: 'File',\n            accept: { [mimeType || 'application/octet-stream']: [`.${(suggestedName.split('.').pop() || 'dat')}`] }\n          }\n        ]\n      };\n      let handle;\n      try {\n        handle = await window.showSaveFilePicker(opts);\n      } catch (e) {\n        // User cancelled the dialog\n        if (e && (e.name === 'AbortError' || e.name === 'NotAllowedError')) return false;\n        throw e;\n      }\n\n      const writable = await handle.createWritable();\n      const blob = contents instanceof Blob ? contents : new Blob([contents], { type: mimeType });\n      await writable.write(blob);\n      await writable.close();\n      return true;\n    }\n  } catch (e) {\n    // fall through to fallback\n    try { console.warn('Native save picker failed, using download fallback:', e); } catch {}\n  }\n\n  // Fallback: trigger a download to the browser default location\n  try {\n    const blob = contents instanceof Blob ? contents : new Blob([contents], { type: mimeType });\n    const link = document.createElement('a');\n    link.href = URL.createObjectURL(blob);\n    link.download = suggestedName || 'file.dat';\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n    setTimeout(() => URL.revokeObjectURL(link.href), 0);\n    return true;\n  } catch (e) {\n    try { console.error('Download fallback failed:', e); } catch {}\n    return false;\n  }\n}\n\nexport default saveFile;\n","import saveFile from '../../../../utilities/saveFile';\nimport errorHandler from '../../../../services/errorHandler';\n\nexport const saveMap = async ({\n    maps,\n    activeMapId,\n    mapName,\n    creatorName,\n    mapDescription,\n    createdAt,\n    registryItems,\n    setCreatedAt\n}) => {\n    const currentDate = new Date().toISOString();\n    const createdDate = createdAt || currentDate;\n\n    const projectData = {\n        meta: {\n            version: \"2.0\",\n            projectName: mapName,\n            author: creatorName,\n            description: mapDescription,\n            date_created: createdDate,\n            date_last_updated: currentDate,\n            activeMapId: activeMapId\n        },\n        maps: {}\n    };\n\n    // Serialize all maps\n    Object.values(maps).forEach(map => {\n        const filledBlocks = map.tileMapData.filter(t => t !== null).length;\n        const objectsCount = map.objectMapData.filter(o => o !== null).length;\n        \n        projectData.maps[map.id] = {\n            id: map.id,\n            name: map.name,\n            description: map.description || '',\n            type: map.type,\n            width: map.mapWidth,\n            height: map.mapHeight,\n            backgroundImage: map.selectedBackgroundImage || null,\n            backgroundColor: map.selectedBackgroundColor || null,\n            backgroundParallaxFactor: map.backgroundParallaxFactor || 0.3,\n            backgroundMusic: map.selectedBackgroundMusic || null,\n            weather: map.weather || { rain: 0, snow: 0, clouds: 0, fog: 0, thunder: 0 },\n            objectMetadata: map.objectMetadata || {},\n            playerPosition: map.playerPosition || null,\n            worldX: map.worldX || 0,\n            worldY: map.worldY || 0,\n            statistics: {\n                total_tiles: map.mapWidth * map.mapHeight,\n                filled_tiles: filledBlocks,\n                total_objects: objectsCount\n            },\n            layers: [\n                { type: \"tile\", name: \"background\", data: map.tileMapData },\n                { type: \"object\", name: \"entities\", data: map.objectMapData },\n                { type: \"secret\", name: \"secrets\", data: map.secretMapData || Array(map.mapWidth * map.mapHeight).fill(null) }\n            ]\n        };\n    });\n\n    const fileName = `${mapName.replace(/\\s+/g, '_')}.json`;\n    const json = JSON.stringify(projectData, null, 2);\n\n    try {\n        const saved = await saveFile(json, fileName, 'application/json');\n        if (saved) {\n            if (!createdAt) setCreatedAt(currentDate);\n            errorHandler.info('Project saved successfully', {\n                component: 'Editor',\n                projectName: mapName,\n                fileName,\n                mapsCount: Object.keys(maps).length\n            });\n        }\n    } catch (error) {\n        errorHandler.error(error, {\n            component: 'Editor',\n            function: 'saveMap',\n            mapName,\n            fileName\n        });\n        alert('Failed to save project. Check console for details.');\n    }\n};\n\nexport const applyMapData = (loaded, {\n    setMapWidth,\n    setMapHeight,\n    setMapName,\n    setCreatorName,\n    setMapDescription,\n    setCreatedAt,\n    setSelectedBackgroundImage,\n    setSelectedBackgroundColor,\n    setBackgroundParallaxFactor,\n    setSelectedBackgroundMusic,\n    setPlayerPosition,\n    setTileMapData,\n    setObjectMapData,\n    setSecretMapData,\n    setObjectMetadata,\n    setWeatherRain,\n    setWeatherSnow,\n    setWeatherClouds,\n    setWeatherFog,\n    setWeatherThunder,\n    setWeatherLavaRain,\n    setWeatherRadioactiveFog,\n    setWeatherMeteorRain,\n    // Multi-map setters\n    setMaps,\n    setActiveMapId\n}) => {\n    try {\n        // Check for multi-map format (version 2.0)\n        if (loaded.meta && loaded.meta.version === \"2.0\" && loaded.maps) {\n            const projectMaps = {};\n            \n            Object.keys(loaded.maps).forEach(mapId => {\n                const m = loaded.maps[mapId];\n                const bgLayer = m.layers.find(l => l.type === 'tile');\n                const objLayer = m.layers.find(l => l.type === 'object');\n                const secretLayer = m.layers.find(l => l.type === 'secret');\n                \n                projectMaps[mapId] = {\n                    id: mapId,\n                    name: m.name,\n                    description: m.description || '',\n                    type: m.type || 'overworld',\n                    mapWidth: m.width,\n                    mapHeight: m.height,\n                    tileMapData: bgLayer ? bgLayer.data : Array(m.width * m.height).fill(null),\n                    objectMapData: objLayer ? objLayer.data : Array(m.width * m.height).fill(null),\n                    secretMapData: secretLayer ? secretLayer.data : Array(m.width * m.height).fill(null),\n                    objectMetadata: m.objectMetadata || {},\n                    selectedBackgroundImage: m.backgroundImage,\n                    selectedBackgroundColor: m.backgroundColor,\n                    backgroundParallaxFactor: m.backgroundParallaxFactor || 0.3,\n                    selectedBackgroundMusic: m.backgroundMusic,\n                    weather: m.weather || { rain: 0, snow: 0, clouds: 0, fog: 0, thunder: 0 },\n                    playerPosition: m.playerPosition || null,\n                    worldX: m.worldX || 0,\n                    worldY: m.worldY || 0\n                };\n            });\n            \n            setMaps(projectMaps);\n            setMapName(loaded.meta.projectName || \"Loaded Project\");\n            setCreatorName(loaded.meta.author || \"Anonymous\");\n            setMapDescription(loaded.meta.description || \"\");\n            setCreatedAt(loaded.meta.date_created || new Date().toISOString());\n            \n            const activeId = loaded.meta.activeMapId || Object.keys(projectMaps)[0];\n            setActiveMapId(activeId);\n            \n            const activeMap = projectMaps[activeId];\n            if (activeMap) {\n                setMapWidth(activeMap.mapWidth);\n                setMapHeight(activeMap.mapHeight);\n                setTileMapData(activeMap.tileMapData);\n                setObjectMapData(activeMap.objectMapData);\n                setSecretMapData(activeMap.secretMapData);\n                setObjectMetadata(activeMap.objectMetadata);\n                setSelectedBackgroundImage(activeMap.selectedBackgroundImage);\n                setSelectedBackgroundColor(activeMap.selectedBackgroundColor);\n                setBackgroundParallaxFactor(activeMap.backgroundParallaxFactor);\n                setSelectedBackgroundMusic(activeMap.selectedBackgroundMusic);\n                \n                setWeatherRain(activeMap.weather.rain);\n                setWeatherSnow(activeMap.weather.snow);\n                setWeatherClouds(activeMap.weather.clouds);\n                setWeatherFog(activeMap.weather.fog);\n                setWeatherThunder(activeMap.weather.thunder);\n                setWeatherLavaRain(activeMap.weather.lavaRain || 0);\n                setWeatherRadioactiveFog(activeMap.weather.radioactiveFog || 0);\n                setWeatherMeteorRain(activeMap.weather.meteorRain || 0);\n\n                if (activeMap.playerPosition) setPlayerPosition(activeMap.playerPosition);\n            }\n            \n            errorHandler.info('Project loaded successfully', {\n                component: 'Editor',\n                projectName: loaded.meta.projectName\n            });\n        } else if (loaded.meta) {\n            // Legacy 1.0 format\n            setMapWidth(loaded.meta.width);\n            setMapHeight(loaded.meta.height);\n\n            if (loaded.meta.name) setMapName(loaded.meta.name);\n            if (loaded.meta.author) setCreatorName(loaded.meta.author);\n            if (loaded.meta.date_map_created_at) setCreatedAt(loaded.meta.date_map_created_at);\n\n            const bgLayer = loaded.layers.find(l => l.name === 'background');\n            const objLayer = loaded.layers.find(l => l.name === 'entities');\n            const secretLayer = loaded.layers.find(l => l.name === 'secrets');\n            \n            const singleMap = {\n                id: 'main',\n                name: loaded.meta.name || \"Main Map\",\n                type: 'overworld',\n                mapWidth: loaded.meta.width,\n                mapHeight: loaded.meta.height,\n                tileMapData: bgLayer ? bgLayer.data : Array(loaded.meta.width * loaded.meta.height).fill(null),\n                objectMapData: objLayer ? objLayer.data : Array(loaded.meta.width * loaded.meta.height).fill(null),\n                secretMapData: secretLayer ? secretLayer.data : Array(loaded.meta.width * loaded.meta.height).fill(null),\n                objectMetadata: loaded.meta.objectMetadata || {},\n                selectedBackgroundImage: loaded.meta.backgroundImage,\n                selectedBackgroundColor: loaded.meta.backgroundColor,\n                backgroundParallaxFactor: loaded.meta.backgroundParallaxFactor || 0.3,\n                selectedBackgroundMusic: loaded.meta.backgroundMusic,\n                weather: loaded.meta.weather || { rain: 0, snow: 0, clouds: 0, fog: 0, thunder: 0 },\n                playerPosition: null\n            };\n\n            setMaps({ 'main': singleMap });\n            setActiveMapId('main');\n\n            if (bgLayer) setTileMapData(bgLayer.data);\n            if (objLayer) setObjectMapData(objLayer.data);\n            if (secretLayer) setSecretMapData(secretLayer.data);\n            \n            // Set other states\n            if (loaded.meta.backgroundImage) setSelectedBackgroundImage(loaded.meta.backgroundImage);\n            if (loaded.meta.backgroundColor) setSelectedBackgroundColor(loaded.meta.backgroundColor);\n            if (loaded.meta.backgroundParallaxFactor !== undefined) setBackgroundParallaxFactor(loaded.meta.backgroundParallaxFactor);\n            if (loaded.meta.backgroundMusic) setSelectedBackgroundMusic(loaded.meta.backgroundMusic);\n            if (loaded.meta.objectMetadata) setObjectMetadata(loaded.meta.objectMetadata);\n            if (loaded.meta.weather) {\n                setWeatherRain(loaded.meta.weather.rain || 0);\n                setWeatherSnow(loaded.meta.weather.snow || 0);\n                setWeatherClouds(loaded.meta.weather.clouds || 0);\n                setWeatherFog(loaded.meta.weather.fog || 0);\n                setWeatherThunder(loaded.meta.weather.thunder || 0);\n                setWeatherLavaRain(loaded.meta.weather.lavaRain || 0);\n                setWeatherRadioactiveFog(loaded.meta.weather.radioactiveFog || 0);\n                setWeatherMeteorRain(loaded.meta.weather.meteorRain || 0);\n            }\n            if (loaded.meta.playerPosition) setPlayerPosition(loaded.meta.playerPosition);\n\n            errorHandler.info('Map loaded successfully (Converted to Project)', {\n                component: 'Editor',\n                mapName: loaded.meta.name\n            });\n        } else {\n            // Oldest format\n            if (loaded.width) setMapWidth(loaded.width);\n            if (loaded.height) setMapHeight(loaded.height);\n            if (loaded.tiles) setTileMapData(loaded.tiles);\n            setObjectMapData(Array(loaded.width * loaded.height).fill(null));\n\n            errorHandler.warn('Loaded map in legacy format', {\n                component: 'Editor'\n            });\n        }\n    } catch (error) {\n        errorHandler.error(error, {\n            component: 'Editor',\n            function: 'applyMapData'\n        });\n        alert('Error applying map data. Check console for details.');\n    }\n};\n\nexport const loadMap = ({\n    event,\n    ...setters\n}) => {\n    const fileReader = new FileReader();\n    const file = event.target.files[0];\n    if (file) {\n        fileReader.readAsText(file, \"UTF-8\");\n        fileReader.onload = (e) => {\n            try {\n                const loaded = JSON.parse(e.target.result);\n                applyMapData(loaded, setters);\n            } catch (error) {\n                errorHandler.error(error, {\n                    component: 'Editor',\n                    function: 'loadMap',\n                    fileName: file.name\n                });\n                alert('Error loading map. Check console for details.');\n            }\n        };\n        fileReader.onerror = (error) => {\n            errorHandler.error(error, {\n                component: 'Editor',\n                function: 'loadMap',\n                fileName: file.name,\n                phase: 'fileReader'\n            });\n            alert('Error reading file!');\n        };\n    }\n};\n\nexport const loadBuiltInMap = ({\n    mapData,\n    ...setters\n}) => {\n    try {\n        applyMapData(mapData, setters);\n    } catch (error) {\n        errorHandler.error(error, {\n            component: 'Editor',\n            function: 'loadBuiltInMap'\n        });\n        alert('Error loading built-in map.');\n    }\n};\n\nexport const clearMap = ({ mapWidth, mapHeight, setTileMapData, setObjectMapData, setSecretMapData, setObjectMetadata }) => {\n    if (window.confirm(\"Are you sure you want to clear the map?\")) {\n        const size = mapWidth * mapHeight;\n        setTileMapData(Array(size).fill(null));\n        setObjectMapData(Array(size).fill(null));\n        setSecretMapData(Array(size).fill(null));\n        setObjectMetadata({});\n    }\n};\n\nexport const resizeMapData = ({ newWidth, newHeight, stateRef, setMapWidth, setMapHeight, setTileMapData, setObjectMapData, setSecretMapData, setObjectMetadata }) => {\n    const { mapWidth: oldW, mapHeight: oldH, tileMapData: oldTiles, objectMapData: oldObjs, secretMapData: oldSecrets, objectMetadata: oldMeta } = stateRef.current;\n    if (newWidth < 1 || newHeight < 1) return;\n    if (newWidth === oldW && newHeight === oldH) return;\n\n    const resizeArray = (oldArr) => {\n        const newArr = Array(newWidth * newHeight).fill(null);\n        if (!oldArr) return newArr;\n        for (let y = 0; y < Math.min(oldH, newHeight); y++) {\n            for (let x = 0; x < Math.min(oldW, newWidth); x++) {\n                newArr[y * newWidth + x] = oldArr[y * oldW + x];\n            }\n        }\n        return newArr;\n    };\n\n    const resizeMetadata = (oldM) => {\n        const newM = {};\n        if (!oldM) return newM;\n        for (let y = 0; y < Math.min(oldH, newHeight); y++) {\n            for (let x = 0; x < Math.min(oldW, newWidth); x++) {\n                const oldIdx = y * oldW + x;\n                const newIdx = y * newWidth + x;\n                if (oldM[oldIdx]) {\n                    newM[newIdx] = oldM[oldIdx];\n                }\n            }\n        }\n        return newM;\n    };\n\n    setMapWidth(newWidth);\n    setMapHeight(newHeight);\n    setTileMapData(resizeArray(oldTiles));\n    setObjectMapData(resizeArray(oldObjs));\n    setSecretMapData(resizeArray(oldSecrets));\n    setObjectMetadata(resizeMetadata(oldMeta));\n};\n","import React from 'react';\n\nexport const ObjectLinks = React.memo(({ mapWidth, mapHeight, objectMapData, objectMetadata }) => {\n    const links = [];\n    const portals = [];\n    const targets = [];\n\n    // Collect all portals and targets with Trigger IDs\n    objectMapData.forEach((id, index) => {\n        if (!id) return;\n        const metadata = objectMetadata?.[index];\n        if (!metadata || metadata.triggerId === undefined || metadata.triggerId === null) return;\n\n        const x = (index % mapWidth) * 32 + 16;\n        const y = Math.floor(index / mapWidth) * 32 + 16;\n\n        if (id.includes('portal') && !id.includes('target')) {\n            portals.push({ x, y, id: metadata.triggerId });\n        } else if (id.includes('target') || id === 'portal_target') {\n            targets.push({ x, y, id: metadata.triggerId });\n        }\n    });\n\n    // Draw lines between matching IDs\n    portals.forEach(p => {\n        targets.forEach(t => {\n            if (p.id === t.id) {\n                links.push(\n                    <line\n                        key={`link-${p.x}-${p.y}-${t.x}-${t.y}`}\n                        x1={p.x} y1={p.y}\n                        x2={t.x} y2={t.y}\n                        stroke=\"#fff\"\n                        strokeWidth=\"2\"\n                        strokeDasharray=\"5,5\"\n                    />\n                );\n            }\n        });\n    });\n\n    return (\n        <svg style={{\n            position: 'absolute',\n            top: 0,\n            left: 0,\n            width: mapWidth * 32,\n            height: mapHeight * 32, // Note: mapHeight must be available\n            zIndex: 10,\n            pointerEvents: 'none',\n            opacity: 0.6\n        }}>\n            {links}\n        </svg>\n    );\n});\n","import React from 'react';\nimport AnimatedItem from '../../../../utilities/AnimatedItem';\nimport { getTutorialText } from '../../../../i18n/tutorialMessages';\n\nexport const EditorTile = React.memo(({\n    index,\n    x, y,\n    activeTool,\n    tileObj,\n    objObj,\n    secretObj,\n    objectMetadata,\n    isHighlighted,\n    parentRegionIndex,\n    borderStyle,\n    bgStyle,\n    handleGridMouseDown,\n    handleGridMouseEnter,\n    handleResizeStart,\n    handleMoveStart,\n    filter,\n    mapType,\n    isRoomAreaVisible,\n    showRoomMapContent,\n    showMessages\n}) => {\n    const isLiquidTile = !!(tileObj && tileObj.flags && tileObj.flags.liquid);\n    const isWaterTile = !!(tileObj && tileObj.flags && tileObj.flags.water);\n    const isLavaTile = !!(tileObj && tileObj.flags && tileObj.flags.lava);\n    const isQuicksandTile = !!(tileObj && tileObj.flags && tileObj.flags.quicksand);\n    const isWaterfallTile = !!(tileObj && tileObj.flags && tileObj.flags.waterfall);\n    const isLavaWaterfallTile = !!(tileObj && tileObj.flags && tileObj.flags.lava_waterfall);\n    const isRadioactiveWaterTile = !!(tileObj && tileObj.flags && tileObj.flags.radioactive_water);\n    const isRadioactiveWaterfallTile = !!(tileObj && tileObj.flags && tileObj.flags.radioactive_waterfall);\n\n    const actualIndex = parentRegionIndex !== null ? parentRegionIndex : index;\n    const triggerId = objectMetadata?.[actualIndex]?.triggerId;\n    const intensity = objectMetadata?.[actualIndex]?.intensity;\n    const messageText = objectMetadata?.[actualIndex]?.message;\n    const i18nChapter = objectMetadata?.[actualIndex]?.i18nChapter;\n    const i18nId = objectMetadata?.[actualIndex]?.i18nId;\n    const i18nText = objObj?.type === 'message_trigger' ? getTutorialText(i18nChapter, i18nId) : '';\n    const resolvedMessageText = messageText || i18nText;\n    \n    // Dimensijas emam no tie indeksa, lai izvairtos no citu objektu (piem. Room Area) \n    // ietekmes uz 1x1 objektiem, kas atrodas to robes.\n    const width = objectMetadata?.[index]?.width || 1;\n    const height = objectMetadata?.[index]?.height || 1;\n\n    const handleMouseDown = (e) => {\n        // If we're clicking a tile that's part of a region, we should interact with the anchor\n        const targetIndex = parentRegionIndex !== null ? parentRegionIndex : index;\n        \n        if (activeTool === 'move') {\n            const hasMovable = objectMetadata[targetIndex] || objObj || secretObj;\n            if (hasMovable) {\n                e.stopPropagation();\n                handleMoveStart(targetIndex);\n                return;\n            }\n        }\n        handleGridMouseDown(index, e);\n    };\n\n    const isResizable = React.useMemo(() => {\n        if (!objObj && !secretObj) return false;\n        \n        // Room areas (windows) on room maps are NOT resizable\n        if (secretObj && secretObj.subtype === 'room' && mapType === 'room') return false;\n\n        // Specifically requested to disable for these types, except Room Areas which MUST be resizable\n        if (secretObj && secretObj.type === 'secret' && secretObj.subtype !== 'room') return false;\n        if (objObj && (objObj.type === 'crack_block' || objObj.type === 'wolf_secret')) return false;\n        return true;\n    }, [objObj, secretObj, mapType]);\n\n    const hasObjectOrSecret = objObj || secretObj || (parentRegionIndex !== null);\n\n    return (\n        <div\n            onMouseDown={handleMouseDown}\n            onMouseEnter={() => handleGridMouseEnter(index)}\n            style={{\n                width: '32px',\n                height: '32px',\n                border: borderStyle,\n                backgroundColor: bgStyle,\n                position: 'relative',\n                boxSizing: 'border-box',\n                display: 'flex',\n                alignItems: 'center',\n                justifyContent: 'center',\n                overflow: 'visible',\n                cursor: (activeTool === 'move' && hasObjectOrSecret) ? 'grab' : 'default'\n            }}>\n            \n            {isHighlighted && parentRegionIndex === null && isResizable && (\n                <>\n                    {/* Resize Handles */}\n                    {/* Right */}\n                    <div \n                        onMouseDown={(e) => { e.stopPropagation(); handleResizeStart(index, 'right'); }}\n                        style={{ position: 'absolute', right: `${-(width-1)*32 - 6}px`, top: '50%', transform: 'translateY(-50%)', width: '10px', height: '20px', backgroundColor: 'gold', border: '1px solid #000', borderRadius: '2px', zIndex: 100, cursor: 'ew-resize' }} \n                    />\n                    {/* Left */}\n                    <div \n                        onMouseDown={(e) => { e.stopPropagation(); handleResizeStart(index, 'left'); }}\n                        style={{ position: 'absolute', left: '-6px', top: '50%', transform: 'translateY(-50%)', width: '10px', height: '20px', backgroundColor: 'gold', border: '1px solid #000', borderRadius: '2px', zIndex: 100, cursor: 'ew-resize' }} \n                    />\n                    {/* Bottom */}\n                    <div \n                        onMouseDown={(e) => { e.stopPropagation(); handleResizeStart(index, 'bottom'); }}\n                        style={{ position: 'absolute', bottom: `${-(height-1)*32 - 6}px`, left: '50%', transform: 'translateX(-50%)', width: '20px', height: '10px', backgroundColor: 'gold', border: '1px solid #000', borderRadius: '2px', zIndex: 100, cursor: 'ns-resize' }} \n                    />\n                    {/* Top */}\n                    <div \n                        onMouseDown={(e) => { e.stopPropagation(); handleResizeStart(index, 'top'); }}\n                        style={{ position: 'absolute', top: '-6px', left: '50%', transform: 'translateX(-50%)', width: '20px', height: '10px', backgroundColor: 'gold', border: '1px solid #000', borderRadius: '2px', zIndex: 100, cursor: 'ns-resize' }} \n                    />\n                </>\n            )}\n\n            {/* Tile Layer */}\n            {tileObj && (\n                <div style={{ filter: filter ? filter('tile') : 'none', transition: 'filter 0.3s ease' }}>\n                    {isLiquidTile ? (\n                        <div style={{\n                            width: '32px', height: '32px',\n                            background: isLavaWaterfallTile ? 'rgba(255, 204, 0, 0.7)' : (isLavaTile ? 'rgba(255, 204, 0, 0.7)' : (isWaterTile || isWaterfallTile ? 'rgba(58, 127, 184, 0.7)' : (isQuicksandTile ? 'rgba(218, 165, 32, 0.7)' : (isRadioactiveWaterTile || isRadioactiveWaterfallTile ? 'rgba(50, 205, 50, 0.7)' : 'rgba(0, 255, 255, 0.3)')))),\n                            display: 'flex', alignItems: 'center', justifyContent: 'center', color: '#fff', fontSize: '8px'\n                        }}>\n                            {isLavaWaterfallTile ? 'L.FALL' : (isLavaTile ? 'LAVA' : (isRadioactiveWaterfallTile ? 'RADFALL' : (isRadioactiveWaterTile ? 'RAD' : (isWaterTile ? 'WATER' : (isWaterfallTile ? 'FALL' : (isQuicksandTile ? 'QUICK' : 'LIQ'))))))}\n                        </div>\n                    ) : (\n                        <AnimatedItem\n                            textures={tileObj.textures}\n                            texture={tileObj.texture}\n                            speed={tileObj.animationSpeed}\n                            spriteSheet={tileObj.spriteSheet}\n                            style={{ width: '32px', height: '32px', objectFit: 'cover' }}\n                        />\n                    )}\n                </div>\n            )}\n\n            {/* Secret Layer */}\n            {secretObj && (secretObj.subtype !== 'room' || isRoomAreaVisible || showRoomMapContent || activeTool === 'area' || mapType === 'room') && (\n                <div style={{\n                    position: 'absolute', \n                    top: '0', left: '0',\n                    width: `${width * 32}px`,\n                    height: `${height * 32}px`,\n                    backgroundColor: secretObj.filterColorInEditor || secretObj.filterColor || 'rgba(128, 0, 128, 0.4)',\n                    display: 'flex', alignItems: 'center', justifyContent: 'center',\n                    color: '#fff', fontSize: '10px', fontWeight: 'bold', zIndex: 2,\n                    filter: filter ? filter('secret') : 'none', transition: 'filter 0.3s ease',\n                    border: '1px dashed rgba(255,255,255,0.5)',\n                    boxSizing: 'border-box',\n                    pointerEvents: 'none'\n                }}>\n                    {mapType !== 'room' && (secretObj.editorIcon || 'SECRET')}\n                </div>\n            )}\n\n            {/* Object Layer */}\n            {objObj && (() => {\n                const renderOffsetX = Number(objObj?.render?.offsetX) || 0;\n                const renderOffsetY = Number(objObj?.render?.offsetY) || 0;\n                const overlapX = Number(objObj?.render?.overlapX) || 0;\n                const overlapY = Number(objObj?.render?.overlapY) || 0;\n                const baseTop = objObj.type === 'decoration' ? 0 : 2;\n                const baseLeft = objObj.type === 'decoration' ? 0 : 2;\n                const baseWidth = objObj.type === 'decoration' ? (width * 32) : (width * 32 - 4);\n                const baseHeight = objObj.type === 'decoration' ? (height * 32) : (height * 32 - 4);\n                return (\n                <div style={{\n                    position: 'absolute', \n                    top: `${baseTop + renderOffsetY - overlapY / 2}px`,\n                    left: `${baseLeft + renderOffsetX - overlapX / 2}px`,\n                    width: `${baseWidth + overlapX}px`,\n                    height: `${baseHeight + overlapY}px`,\n                    zIndex: 3,\n                    display: 'flex', alignItems: 'center', justifyContent: 'center',\n                    filter: filter ? filter('object') : 'none', transition: 'filter 0.3s ease',\n                    pointerEvents: 'none' // Let clicks pass through to the tile for resizing handles\n                }}>\n                    {objObj.editorIcon ? (\n                        <span style={{\n                            fontSize: objObj.editorIcon === 'i18n' ? '12px' : '20px',\n                            width: '100%',\n                            height: '100%',\n                            display: 'flex',\n                            alignItems: 'center',\n                            justifyContent: 'center',\n                            backgroundColor: 'rgba(255,255,255,0.1)',\n                            border: '1px dashed rgba(255,255,255,0.3)',\n                            color: '#222',\n                            fontWeight: 700\n                        }}>{objObj.editorIcon}</span>\n                    ) : (\n                        <AnimatedItem\n                            textures={objObj.textures}\n                            texture={objObj.texture}\n                            speed={objObj.animationSpeed}\n                            spriteSheet={objObj.spriteSheet}\n                            frameIndex={objectMetadata?.[actualIndex]?.currentFrame !== undefined ? objectMetadata[actualIndex].currentFrame : (objObj.subtype === 'door' && mapType === 'room' ? (objObj.interaction?.frames?.inside || 2) : 0)}\n                            style={{ \n                                width: '100%', \n                                height: '100%', \n                                objectFit: objObj.type === 'decoration' ? 'cover' : 'contain', \n                                backgroundColor: objObj.type === 'decoration' ? 'transparent' : 'rgba(255,255,255,0.1)', \n                                border: objObj.type === 'decoration' ? 'none' : '1px dashed rgba(255,255,255,0.3)' \n                            }}\n                        />\n                    )}\n\n                    {objObj.type === 'message_trigger' && (\n                        <div style={{\n                            position: 'absolute',\n                            inset: '2px',\n                            display: 'flex',\n                            alignItems: 'center',\n                            justifyContent: 'center',\n                            background: '#fff9c4',\n                            border: '1px solid #fbc02d',\n                            color: '#333',\n                            fontWeight: 700,\n                            fontSize: (objObj.editorIcon === 'i18n' || objObj.i18nMessage) ? '12px' : '18px'\n                        }}>\n                            {objObj.editorIcon || (objObj.i18nMessage ? 'i18n' : '')}\n                        </div>\n                    )}\n\n                    {/* Trigger ID */}\n                    {triggerId !== undefined && triggerId !== null && (\n                        <div style={{\n                            position: 'absolute', top: '-15px', left: '0',\n                            backgroundColor: 'rgba(0,0,0,0.7)', color: '#fff', padding: '1px 4px',\n                            borderRadius: '3px', fontSize: '10px', whiteSpace: 'nowrap', zIndex: 10, border: '1px solid #fff'\n                        }}>\n                            ID: {triggerId}\n                        </div>\n                    )}\n\n                    {/* Intensity */}\n                    {intensity !== undefined && intensity !== null && objObj && (objObj.type === 'weather_trigger' || objObj.hasIntensity) && (\n                        <div style={{\n                            position: 'absolute', top: '-15px', right: '0',\n                            backgroundColor: 'rgba(0,100,200,0.8)', color: '#fff', padding: '1px 4px',\n                            borderRadius: '3px', fontSize: '10px', whiteSpace: 'nowrap', zIndex: 11, border: '1px solid #fff'\n                        }}>\n                            {intensity}%\n                        </div>\n                    )}\n\n                    {/* Message Bubble */}\n                    {showMessages && objObj && objObj.type === 'message_trigger' && resolvedMessageText && (\n                        <div style={{\n                            position: 'absolute',\n                            left: '50%',\n                            bottom: '100%',\n                            transform: 'translateX(-50%)',\n                            marginBottom: '8px',\n                            maxWidth: '140px',\n                            backgroundColor: 'rgba(255, 255, 255, 0.95)',\n                            color: '#222',\n                            border: '1px solid rgba(0,0,0,0.6)',\n                            borderRadius: '8px',\n                            padding: '4px 6px',\n                            fontSize: '10px',\n                            lineHeight: 1.2,\n                            textAlign: 'center',\n                            zIndex: 12,\n                            pointerEvents: 'none'\n                        }}>\n                            {resolvedMessageText}\n                            <div style={{\n                                position: 'absolute',\n                                left: '50%',\n                                bottom: '-6px',\n                                transform: 'translateX(-50%)',\n                                width: 0,\n                                height: 0,\n                                borderLeft: '6px solid transparent',\n                                borderRight: '6px solid transparent',\n                                borderTop: '6px solid rgba(255, 255, 255, 0.95)'\n                            }} />\n                            <div style={{\n                                position: 'absolute',\n                                left: '50%',\n                                bottom: '-7px',\n                                transform: 'translateX(-50%)',\n                                width: 0,\n                                height: 0,\n                                borderLeft: '7px solid transparent',\n                                borderRight: '7px solid transparent',\n                                borderTop: '7px solid rgba(0,0,0,0.6)',\n                                zIndex: -1\n                            }} />\n                        </div>\n                    )}\n                </div>\n                );\n            })()}\n\n            {/* Room Area Visibility Overlay */}\n            {(isRoomAreaVisible || showRoomMapContent || activeTool === 'area') && secretObj && secretObj.subtype === 'room' && mapType !== 'room' && (\n                <div style={{\n                    position: 'absolute',\n                    top: 0, left: 0,\n                    width: `${width * 32}px`,\n                    height: `${height * 32}px`,\n                    backgroundColor: 'rgba(255, 255, 0, 0.2)',\n                    border: '2px solid gold',\n                    boxSizing: 'border-box',\n                    zIndex: 4,\n                    pointerEvents: 'none',\n                    display: 'flex',\n                    flexDirection: 'column',\n                    alignItems: 'center',\n                    justifyContent: 'center',\n                    color: '#000',\n                    fontSize: '10px',\n                    fontWeight: 'bold',\n                    textShadow: '0 0 2px #fff'\n                }}>\n                    <span style={{ fontSize: '14px' }}></span>\n                    <span style={{ whiteSpace: 'nowrap' }}>{objectMetadata?.[actualIndex]?.roomName || 'Unnamed'}</span>\n                    <span style={{ fontSize: '9px' }}>{width}x{height}m</span>\n                </div>\n            )}\n        </div>\n    );\n});\n","import React, { useCallback } from 'react';\nimport { ObjectLinks } from './viewport/ObjectLinks';\nimport { EditorTile } from './viewport/EditorTile';\nimport PixiStage from '../game/PixiStage';\n\nexport const Viewport = ({\n    mapWidth,\n    mapHeight,\n    selectedBackgroundUrl,\n    selectedBackgroundColor,\n    selectedBackgroundImage,\n    showBackgroundImage,\n    showGrid,\n    activeLayer,\n    activeTool,\n    tileMapData,\n    objectMapData,\n    secretMapData,\n    objectMetadata,\n    registryItems,\n    hoverIndex,\n    highlightedIndex,\n    brushSize,\n    bucketPreviewIndices,\n    selection,\n    previewPosition,\n    dragStart,\n    isDragging,\n    handleGridMouseDown,\n    handleGridMouseEnter,\n    handleGridMouseUp,\n    handleGridMouseLeave,\n    handleResizeStart,\n    handleMoveStart,\n    setIsDragging,\n    selectedTile,\n    weatherRain,\n    weatherSnow,\n    weatherClouds,\n    weatherFog,\n    weatherThunder,\n    weatherLavaRain,\n    weatherRadioactiveFog,\n    weatherMeteorRain,\n    mapType,\n    isRoomAreaVisible,\n    showRoomMapContent,\n    showMessages,\n    maps\n}) => {\n    const isEraserActive = activeTool === 'brush' && selectedTile === null;\n    const isBrushActive = activeTool === 'brush';\n    const isBucketActive = activeTool === 'bucket';\n\n    const regions = React.useMemo(() => {\n        const res = [];\n        if (!objectMetadata) return res;\n        for (const [idxStr, meta] of Object.entries(objectMetadata)) {\n            if (meta.width > 1 || meta.height > 1) {\n                const idx = parseInt(idxStr);\n                res.push({ \n                    idx, \n                    x: idx % mapWidth, \n                    y: Math.floor(idx / mapWidth), \n                    w: meta.width || 1, \n                    h: meta.height || 1 \n                });\n            }\n        }\n        return res;\n    }, [objectMetadata, mapWidth]);\n\n    const roomAreas = React.useMemo(() => {\n        const res = [];\n        if (!secretMapData || !objectMetadata || !showRoomMapContent) return res;\n        for (const [idxStr, meta] of Object.entries(objectMetadata)) {\n            const idx = parseInt(idxStr);\n            if (secretMapData[idx] === 'room_area' && meta.linkedMapId && maps[meta.linkedMapId]) {\n                res.push({\n                    id: meta.linkedMapId,\n                    x: idx % mapWidth,\n                    y: Math.floor(idx / mapWidth),\n                    width: meta.width || 1,\n                    height: meta.height || 1,\n                    mapData: maps[meta.linkedMapId]\n                });\n            }\n        }\n        return res;\n    }, [secretMapData, objectMetadata, showRoomMapContent, maps, mapWidth]);\n\n    const getLayerColor = (layer, alpha = 0.5) => {\n        if (layer === 'tile') return `rgba(24, 144, 255, ${alpha})`;\n        if (layer === 'object') return `rgba(245, 34, 45, ${alpha})`;\n        if (layer === 'secret') return `rgba(114, 46, 209, ${alpha})`;\n        return `rgba(255, 255, 255, ${alpha})`;\n    };\n\n    const getGridStyles = () => {\n        let color = 'rgba(255, 255, 255, 0.15)';\n        let visible = showGrid;\n\n        if (isEraserActive) {\n            color = getLayerColor(activeLayer, 0.4);\n            visible = true;\n        } else if (isBrushActive || isBucketActive) {\n            color = getLayerColor(activeLayer, 0.25);\n            visible = true; // Auto-show grid when using drawing tools\n        }\n\n        return {\n            backgroundImage: visible ? `\n                linear-gradient(to right, ${color} 1px, transparent 1px),\n                linear-gradient(to bottom, ${color} 1px, transparent 1px)\n            ` : 'none',\n            backgroundSize: '32px 32px'\n        };\n    };\n\n    const getLayerFilter = useCallback((layer) => {\n        if (!isEraserActive) return 'none';\n        return activeLayer === layer ? 'none' : 'grayscale(100%) opacity(0.2) blur(2px)';\n    }, [isEraserActive, activeLayer]);\n\n    const getOverlayColor = () => {\n        if (!isEraserActive) return 'transparent';\n        if (activeLayer === 'tile') return 'rgba(24, 144, 255, 0.25)'; // Blueish for blocks\n        if (activeLayer === 'object') return 'rgba(245, 34, 45, 0.25)'; // Reddish for objects\n        if (activeLayer === 'secret') return 'rgba(114, 46, 209, 0.25)'; // Purplish for secrets\n        return 'transparent';\n    };\n    return (\n        <div className=\"viewport\"\n            style={{\n                flex: 1, padding: '40px', backgroundColor: '#555',\n                overflow: 'auto', position: 'relative', userSelect: 'none'\n            }}\n            onMouseUp={() => handleGridMouseUp(hoverIndex)}>\n            <div style={{ position: 'relative', width: 'fit-content' }} onMouseLeave={handleGridMouseLeave}>\n                \n                <ObjectLinks \n                    mapWidth={mapWidth} \n                    mapHeight={mapHeight} \n                    objectMapData={objectMapData} \n                    objectMetadata={objectMetadata} \n                />\n\n                {/* Room Map Content Overlay */}\n                {showRoomMapContent && roomAreas.map(room => (\n                    <div\n                        key={room.id}\n                        style={{\n                            position: 'absolute',\n                            left: room.x * 32,\n                            top: room.y * 32,\n                            width: room.width * 32,\n                            height: room.height * 32,\n                            zIndex: 6,\n                            pointerEvents: 'none',\n                            overflow: 'hidden',\n                            boxShadow: '0 0 15px rgba(0,0,0,0.5)',\n                            border: '2px solid #f39c12'\n                        }}\n                    >\n                        <PixiStage \n                            mapWidth={room.mapData.mapWidth}\n                            mapHeight={room.mapData.mapHeight}\n                            tileSize={32}\n                            tileMapData={room.mapData.tileMapData || []}\n                            objectMapData={room.mapData.objectMapData || []}\n                            secretMapData={room.mapData.secretMapData || []}\n                            objectMetadata={room.mapData.objectMetadata || {}}\n                            registryItems={registryItems}\n                            backgroundColor={room.mapData.selectedBackgroundColor}\n                            backgroundImage={room.mapData.selectedBackgroundImage}\n                            backgroundParallaxFactor={room.mapData.backgroundParallaxFactor}\n                            isEditor={true}\n                            mapType={room.mapData.type || 'room'}\n                        />\n                    </div>\n                ))}\n\n                <div\n                    style={{\n                        position: 'absolute', top: 0, left: 0,\n                        width: mapWidth * 32, height: mapHeight * 32,\n                        backgroundImage: (selectedBackgroundUrl && showBackgroundImage && !isEraserActive) ? `url(${selectedBackgroundUrl})` : 'none',\n                        backgroundColor: (isEraserActive || !showBackgroundImage || !selectedBackgroundUrl) ? selectedBackgroundColor : 'transparent',\n                        backgroundRepeat: 'repeat-x', backgroundSize: 'auto 100%',\n                        zIndex: 0, pointerEvents: 'none'\n                    }}\n                />\n\n                <div\n                    style={{\n                        position: 'absolute', top: 0, left: 0,\n                        width: mapWidth * 32, height: mapHeight * 32,\n                        backgroundColor: getOverlayColor(),\n                        zIndex: 5, pointerEvents: 'none',\n                        transition: 'background-color 0.3s ease'\n                    }}\n                />\n\n                {/* Top Grid Overlay */}\n                <div\n                    style={{\n                        position: 'absolute', top: 0, left: 0,\n                        width: mapWidth * 32, height: mapHeight * 32,\n                        zIndex: 10, pointerEvents: 'none',\n                        ...getGridStyles()\n                    }}\n                />\n\n                {/* Weather Effects Overlay */}\n                {(weatherRain > 0 || weatherSnow > 0 || weatherClouds > 0 || weatherFog > 0 || weatherThunder > 0 || weatherLavaRain > 0 || weatherRadioactiveFog > 0 || weatherMeteorRain > 0) && (\n                    <div\n                        style={{\n                            position: 'absolute', top: 0, left: 0,\n                            width: mapWidth * 32, height: mapHeight * 32,\n                            zIndex: 15, pointerEvents: 'none',\n                        }}\n                    >\n                        <PixiStage \n                            mapWidth={mapWidth}\n                            mapHeight={mapHeight}\n                            tileSize={32}\n                            tileMapData={[]}\n                            objectMapData={[]}\n                            registryItems={registryItems}\n                            weatherRain={weatherRain}\n                            weatherSnow={weatherSnow}\n                            weatherClouds={weatherClouds}\n                            weatherFog={weatherFog}\n                            weatherThunder={weatherThunder}\n                            weatherLavaRain={weatherLavaRain}\n                            weatherRadioactiveFog={weatherRadioactiveFog}\n                            weatherMeteorRain={weatherMeteorRain}\n                            renderLayers={['weather']}\n                            pointerEvents=\"none\"\n                        />\n                    </div>\n                )}\n\n                <div className=\"grid\"\n                    style={{\n                        display: 'grid',\n                        gridTemplateColumns: `repeat(${mapWidth}, 32px)`,\n                        gridTemplateRows: `repeat(${mapHeight}, 32px)`,\n                        gap: '0px', border: '1px solid #444', backgroundColor: 'transparent',\n                        position: 'relative', cursor: activeTool === 'bucket' ? 'cell' : 'default',\n                        zIndex: 1\n                    }}>\n                    {Array(mapWidth * mapHeight).fill(0).map((_, index) => {\n                        const x = index % mapWidth;\n                        const y = Math.floor(index / mapWidth);\n\n                        let dTileId = tileMapData[index];\n                        let dObjId = objectMapData[index];\n                        let dSecId = secretMapData?.[index];\n\n                        if (selection && previewPosition) {\n                            const { w, h } = selection;\n                            const px = previewPosition.x;\n                            const py = previewPosition.y;\n                            if (x >= px && x < px + w && y >= py && y < py + h) {\n                                const idx = (y - py) * w + (x - px);\n                                dTileId = selection.tileData[idx];\n                                dObjId = selection.objectData[idx];\n                                dSecId = selection.secretData?.[idx];\n                            }\n                        }\n\n                        const tileObj = dTileId ? registryItems.find(r => r.id === dTileId) : null;\n                        const objObj = dObjId ? registryItems.find(r => r.id === dObjId) : null;\n                        const secretObj = dSecId ? registryItems.find(r => r.id === dSecId) : null;\n\n                        let borderStyle = 'none';\n                        let bgStyle = 'transparent';\n\n                        const layerColor = getLayerColor(activeLayer, 1);\n\n                        if (activeTool === 'brush' && hoverIndex !== null) {\n                            const hx = hoverIndex % mapWidth;\n                            const hy = Math.floor(hoverIndex / mapWidth);\n                            if (x >= hx && x < hx + brushSize && y >= hy && y < hy + brushSize) {\n                                borderStyle = `1px dashed ${layerColor}`;\n                                if (isEraserActive) bgStyle = 'rgba(255, 0, 0, 0.1)';\n                            }\n                        } else if (activeTool === 'bucket') {\n                            if (bucketPreviewIndices.has(index)) { borderStyle = '1px dashed orange'; bgStyle = 'rgb(168,187,220)'; }\n                            else if (hoverIndex === index) borderStyle = '2px solid orange';\n                        } else if (activeTool === 'move') {\n                            if (isDragging && dragStart && hoverIndex !== null) {\n                                const hx = hoverIndex % mapWidth;\n                                const hy = Math.floor(hoverIndex / mapWidth);\n                                const minX = Math.min(dragStart.x, hx);\n                                const minY = Math.min(dragStart.y, hy);\n                                const maxX = Math.max(dragStart.x, hx);\n                                const maxY = Math.max(dragStart.y, hy);\n                                if (x >= minX && x <= maxX && y >= minY && y <= maxY) { borderStyle = '1px dashed blue'; bgStyle = 'rgba(0, 0, 255, 0.1)'; }\n                            } else if (!isDragging && hoverIndex === index) borderStyle = '2px solid blue';\n                        } else if (activeTool === 'area') {\n                            if (isDragging && dragStart && hoverIndex !== null) {\n                                const hx = hoverIndex % mapWidth;\n                                const hy = Math.floor(hoverIndex / mapWidth);\n                                const minX = Math.min(dragStart.x, hx);\n                                const minY = Math.min(dragStart.y, hy);\n                                const maxX = Math.max(dragStart.x, hx);\n                                const maxY = Math.max(dragStart.y, hy);\n                                if (x >= minX && x <= maxX && y >= minY && y <= maxY) { \n                                    borderStyle = '1px dashed gold'; \n                                    bgStyle = 'rgba(255, 255, 0, 0.2)'; \n                                }\n                            } else if (!isDragging && hoverIndex === index) borderStyle = '2px solid gold';\n                        }\n\n                        if (highlightedIndex === index) { borderStyle = '3px solid gold'; bgStyle = 'rgba(255, 215, 0, 0.4)'; }\n                        \n                        const selX = previewPosition ? previewPosition.x : (selection ? selection.x : 0);\n                        const selY = previewPosition ? previewPosition.y : (selection ? selection.y : 0);\n                        if (selection && x >= selX && x < selX + selection.w && y >= selY && y < selY + selection.h) {\n                            if (previewPosition && (previewPosition.x !== selection.originalX || previewPosition.y !== selection.originalY)) {\n                                borderStyle = '2px solid cyan'; bgStyle = 'rgba(0, 255, 255, 0.2)';\n                            } else {\n                                borderStyle = '1px dashed red'; bgStyle = 'rgba(255, 255, 0, 0.3)';\n                            }\n                        }\n\n                        const parentRegion = regions.find(r => x >= r.x && x < r.x + r.w && y >= r.y && y < r.y + r.h);\n\n                        return (\n                            <EditorTile \n                                key={index}\n                                index={index}\n                                x={x} y={y}\n                                activeTool={activeTool}\n                                tileObj={tileObj}\n                                objObj={objObj}\n                                secretObj={secretObj}\n                                objectMetadata={objectMetadata}\n                                isHighlighted={highlightedIndex === index || (parentRegion && highlightedIndex === parentRegion.idx)}\n                                parentRegionIndex={parentRegion ? parentRegion.idx : null}\n                                borderStyle={borderStyle}\n                                bgStyle={bgStyle}\n                                handleGridMouseDown={handleGridMouseDown}\n                                handleGridMouseEnter={handleGridMouseEnter}\n                                handleResizeStart={handleResizeStart}\n                                handleMoveStart={handleMoveStart}\n                                filter={getLayerFilter}\n                                mapType={mapType}\n                                isRoomAreaVisible={isRoomAreaVisible}\n                                showRoomMapContent={showRoomMapContent}\n                                showMessages={showMessages}\n                            />\n                        );\n                    })}\n                </div>\n            </div>\n        </div>\n    );\n};\n","import styled from 'styled-components';\n\nexport const EditorToolsContainer = styled.div`\n    display: contents;\n`;\n\nexport const HeaderBar = styled.div`\n    padding: 0 15px;\n    background-color: #222;\n    border-bottom: none;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    font-weight: bold;\n    font-size: 12px;\n    height: 60px;\n    box-sizing: border-box;\n    color: #fff;\n    z-index: 1105;\n    position: relative;\n\n    &::after {\n        content: \"\";\n        position: absolute;\n        left: 60px;\n        right: 0;\n        bottom: 0;\n        height: 1px;\n        background-color: #000;\n        pointer-events: none;\n    }\n`;\n\nexport const ToolsSection = styled.div`\n    display: flex;\n    gap: 15px;\n    align-items: center;\n`;\n\nexport const ToolsGroup = styled.div`\n    display: flex;\n    gap: 10px;\n    align-items: center;\n`;\n\nexport const ToolsInnerGroup = styled.div`\n    display: flex;\n    gap: 10px;\n`;\n\nexport const ToolsRow = styled.div`\n    display: flex;\n    gap: 10px;\n`;\n\nexport const ToolsEditorButton = styled.button`\n    min-width: 40px;\n    height: 40px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    gap: 8px;\n    cursor: pointer;\n    background-color: ${props => props.$active ? '#e3de0a' : (props.$variant === 'play' ? '#4CAF50' : (props.$variant === 'pause' ? '#FF9800' : (props.$variant === 'danger' ? '#dc3545' : (props.$variant === 'secondary' ? '#f0f0f0' : '#333'))))};\n    color: ${props => props.$variant === 'secondary' ? '#333' : '#fff'};\n    border: 1px solid ${props => props.$active ? '#1E88E5' : (props.$variant === 'play' ? '#388E3C' : (props.$variant === 'pause' ? '#F57C00' : (props.$variant === 'danger' ? '#c82333' : (props.$variant === 'secondary' ? '#ccc' : '#fff'))))};\n    border-radius: 4px;\n    font-size: ${props => props.$small ? '14px' : '20px'};\n    font-weight: ${props => props.$variant === 'play' || props.$variant === 'pause' ? 'bold' : 'normal'};\n    line-height: 1;\n    transition: all 0.2s ease;\n    box-shadow: 0 2px 4px rgba(0,0,0,0.2);\n    transform: ${props => props.$active ? 'scale(1.05)' : 'none'};\n    padding: ${props => props.$square ? '0' : '0 15px'};\n    width: ${props => props.$square ? '40px' : 'auto'};\n    outline: none;\n    user-select: none;\n    opacity: ${props => props.$disabled ? 0.4 : 1};\n    cursor: ${props => props.$disabled ? 'not-allowed' : 'pointer'};\n    position: relative;\n\n    &:hover {\n        background-color: ${props => props.$active ? '#fdfa9b' : (props.$variant === 'play' ? '#45a049' : (props.$variant === 'pause' ? '#fb8c00' : (props.$variant === 'danger' ? '#bd2130' : (props.$variant === 'secondary' ? '#e0e0e0' : '#444'))))};\n        transform: scale(1.05);\n    }\n\n    &:active {\n        transform: scale(0.95);\n        border: solid 1px #fff;\n    }\n\n    span {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n    }\n`;\n\nexport const StrikeThrough = styled.div`\n    position: absolute;\n    width: 100%;\n    height: 2px;\n    background-color: #f5222d;\n    transform: rotate(-45deg);\n    top: 50%;\n    left: 0;\n    z-index: 2;\n    pointer-events: none;\n`;\n\nexport const LayerIndicator = styled.div`\n    padding: 0 12px;\n    height: 40px;\n    border-radius: 4px;\n    display: flex;\n    align-items: center;\n    font-size: 11px;\n    font-weight: 800;\n    text-transform: uppercase;\n    margin-right: 15px;\n    margin-left: 15px;\n    white-space: nowrap;\n    border: 1px solid;\n    box-sizing: border-box;\n    background-color: ${props => props.$bgColor || '#e6f7ff'};\n    border-color: ${props => props.$borderColor || '#91d5ff'};\n    color: ${props => props.$textColor || '#1890ff'};\n`;\n\nexport const BgColorContainer = styled.div`\n    display: flex;\n    align-items: center;\n    gap: 10px;\n`;\n\nexport const BgColorInputWrapper = styled.div`\n    position: relative;\n    display: flex;\n    align-items: center;\n`;\n\nexport const BgColorInput = styled.input`\n    width: 40px;\n    height: 40px;\n    border: 1px solid #fff;\n    padding: 4px;\n    cursor: pointer;\n    background-color: #333;\n    border-radius: 4px;\n    box-sizing: border-box;\n    box-shadow: 0 2px 4px rgba(0,0,0,0.2);\n    opacity: ${props => props.disabled ? 0.4 : 1};\n    cursor: ${props => props.disabled ? 'not-allowed' : 'pointer'};\n`;\n\nexport const BgTransparentButton = styled.div`\n    width: 40px;\n    height: 40px;\n    border: 1px solid ${props => props.$active ? '#e3de0a' : '#fff'};\n    padding: 4px;\n    background-color: #333;\n    border-radius: 4px;\n    box-sizing: border-box;\n    box-shadow: 0 2px 4px rgba(0,0,0,0.2);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    transition: all 0.2s ease;\n    cursor: pointer;\n    position: relative;\n    overflow: hidden;\n\n    &:hover {\n        transform: scale(1.05);\n        background-color: #444;\n    }\n\n    &::after {\n        content: \"\";\n        width: 100%;\n        height: 100%;\n        background-image: \n            linear-gradient(45deg, #ccc 25%, transparent 25%), \n            linear-gradient(-45deg, #ccc 25%, transparent 25%), \n            linear-gradient(45deg, transparent 75%, #ccc 75%), \n            linear-gradient(-45deg, transparent 75%, #ccc 75%);\n        background-size: 8px 8px;\n        background-position: 0 0, 0 4px, 4px 4px, 4px 0;\n        background-color: #fff;\n        opacity: 0.8;\n        border-radius: 2px;\n    }\n`;\n\nexport const PlayButtonContainer = styled.div`\n    width: 40px;\n    height: 40px;\n    border: 1px solid #fff;\n    padding: 4px;\n    cursor: pointer;\n    background-color: #333;\n    border-radius: 4px;\n    box-sizing: border-box;\n    box-shadow: 0 2px 4px rgba(0,0,0,0.2);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    transition: all 0.2s ease;\n\n    &:hover {\n        transform: scale(1.05);\n        background-color: #444;\n    }\n\n    &:active {\n        transform: scale(0.95);\n    }\n`;\n\nexport const PlayButtonInner = styled.div`\n    width: 100%;\n    height: 100%;\n    border-radius: 2px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background-color: ${props => props.$variant === 'play' ? '#4CAF50' : (props.$variant === 'pause' ? '#FF9800' : '#333')};\n    color: #fff;\n    font-size: 18px;\n    box-sizing: border-box;\n`;\n\nexport const InfoContainer = styled.div`\n    display: flex;\n    flex-direction: column;\n    gap: 2px;\n    align-items: flex-start;\n    color: #bbb;\n    margin-left: auto;\n`;\n\nexport const InfoItem = styled.div`\n    display: flex;\n    align-items: center;\n    gap: 6px;\n`;\n\nexport const InfoLabel = styled.span`\n    font-size: 11px;\n    text-transform: uppercase;\n    opacity: 0.8;\n`;\n\nexport const InfoValue = styled.span`\n    color: #fff;\n    font-size: 12px;\n`;\n\nexport const EraserButtonContainer = styled.div`\n    width: 40px;\n    height: 40px;\n    border: 1px solid ${props => props.$active ? '#e3de0a' : '#fff'};\n    padding: 4px;\n    //cursor: pointer;\n    background-color: #333;\n    border-radius: 4px;\n    box-sizing: border-box;\n    box-shadow: 0 2px 4px rgba(0,0,0,0.2);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    transition: all 0.2s ease;\n    opacity: ${props => props.$disabled ? 0.4 : 1};\n    cursor: ${props => props.$disabled ? 'not-allowed' : 'pointer'};\n    position: relative;\n\n    &:hover {\n        transform: scale(1.05);\n        background-color: #444;\n    }\n\n    &:active {\n        transform: scale(0.95);\n    }\n`;\n\nexport const EraserButtonInner = styled.div`\n    width: 100%;\n    height: 100%;\n    border-radius: 2px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background-color: ${props => props.$active ? (props.$textColor || '#1890ff') : (props.$bgColor || '#f0f0f0')};\n    color: ${props => props.$active ? '#fff' : (props.$textColor || '#000')};\n    font-size: 11px;\n    font-weight: bold;\n    border: ${props => props.$active ? '1px solid #fff' : 'none'};\n    box-sizing: border-box;\n`;\n\nexport const SelectionActions = styled.div`\n    display: flex;\n    gap: 5px;\n    margin-left: 5px;\n    border-left: 1px solid #ccc;\n    padding-left: 5px;\n`;\n\nexport const ConfirmButton = styled(ToolsEditorButton)`\n    background-color: #e6f7ff;\n    color: #1890ff;\n    \n    &:hover {\n        background-color: #bae7ff;\n    }\n`;\n\nexport const CancelButton = styled(ToolsEditorButton)`\n    background-color: #fff1f0;\n    color: #f5222d;\n\n    &:hover {\n        background-color: #ffccc7;\n    }\n`;\n\nexport const GridIcon = styled.span`\n    width: 100%;\n    height: 100%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n`;\n","import styled from 'styled-components';\n\n/*\n* Container*/\nexport const SidebarContainer = styled.div`\n    width: 60px;\n    height: 100%;\n    background-color: #222;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    padding-top: 10px;\n    z-index: 1100;\n    border-right: 1px solid #000;\n    flex-shrink: 0;\n    overflow-y: auto;\n\n    &::-webkit-scrollbar {\n        width: 0px;\n        background: transparent;\n    }\n    \n    -ms-overflow-style: none;\n    scrollbar-width: none;\n`;\n\nexport const ElementEditorButton = styled.button`\n    width: 40px;\n    height: 40px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    cursor: pointer;\n    background-color: ${props => props.$active ? '#e3de0a' : '#333'};\n    color: #fff;\n    border: 1px solid ${props => props.$active ? '#1E88E5' : '#fff'};\n    border-radius: 4px;\n    margin-bottom: 10px;\n    font-size: 20px;\n    transition: all 0.2s ease;\n    box-shadow: 0 2px 4px rgba(0,0,0,0.2);\n    transform: ${props => props.$active ? 'scale(1.05)' : 'none'};\n    padding: 0;\n    outline: none;\n\n    &:hover {\n        background-color: ${props => props.$active ? '#fdfa9b' : '#444'};\n        transform: scale(1.05);\n    }\n\n    &:active {\n        transform: scale(0.95);\n        border: solid 1px #fff;\n    }\n`;\n\nexport const PanelContainer = styled.div`\n    position: absolute;\n    left: 60px;\n    top: 60px;\n    width: 320px;\n    height: calc(100% - 60px);\n    background-color: #fff;\n    border-right: 1px solid #ddd;\n    display: flex;\n    flex-direction: column;\n    z-index: 1090;\n    box-shadow: 4px 0 10px rgba(0,0,0,0.2);\n    \n    /* Animation settings */\n    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s ease;\n    transform: ${props => props.$isOpen ? 'translateX(0)' : 'translateX(-110%)'};\n    opacity: ${props => props.$isOpen ? '1' : '0'};\n    pointer-events: ${props => props.$isOpen ? 'all' : 'none'};\n`;\n\nexport const PanelHeader = styled.div`\n    padding: 8px 15px;\n    background-color: #f0f0f0;\n    border-bottom: 1px solid #ddd;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    font-weight: bold;\n    font-size: 12px;\n    height: 32px;\n    box-sizing: border-box;\n    color: #333;\n\n    span {\n        text-transform: uppercase;\n        letter-spacing: 0.5px;\n    }\n`;\n\nexport const PanelBody = styled.div`\n    flex: 1;\n    overflow-y: auto;\n    padding: 15px;\n`;\n\nexport const CloseButton = styled.button`\n    border: none;\n    background: none;\n    cursor: pointer;\n    font-size: 16px;\n    padding: 0 5px;\n    color: #666;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    outline: none;\n\n    &:hover {\n        color: #333;\n    }\n`;\n\nexport const OperationButton = styled.button`\n    display: inline-flex;\n    align-items: center;\n    justify-content: center;\n    cursor: pointer;\n    border: 1px solid #333;\n    padding: 0 10px;\n    height: 40px;\n    width: 100%;\n    background-color: #f0f0f0;\n    font-size: 13px;\n    color: ${props => props.$danger ? '#d32f2f' : '#000'};\n    border-radius: 3px;\n    user-select: none;\n    box-sizing: border-box;\n    transition: all 0.2s ease;\n    gap: 8px;\n    outline: none;\n\n    &:hover {\n        background-color: #e0e0e0;\n        border-color: #000;\n    }\n\n    &:active {\n        transform: scale(0.98);\n    }\n`;\n\n// Also exporting as a label for file input usage in OperationsPanel\nexport const OperationLabel = styled.label`\n    display: inline-flex;\n    align-items: center;\n    justify-content: center;\n    cursor: pointer;\n    border: 1px solid #333;\n    padding: 0 10px;\n    height: 40px;\n    width: 100%;\n    background-color: #f0f0f0;\n    font-size: 13px;\n    color: #000;\n    border-radius: 3px;\n    user-select: none;\n    box-sizing: border-box;\n    transition: all 0.2s ease;\n    gap: 8px;\n\n    &:hover {\n        background-color: #e0e0e0;\n        border-color: #000;\n    }\n\n    &:active {\n        transform: scale(0.98);\n    }\n`;\n","import React from 'react';\nimport { ToolsEditorButton } from '../styles/EditorToolsButton';\nimport { CloseButton } from '../styles/EditorElementsButtonStyle';\n\nexport const NewMapModal = ({\n    isOpen,\n    tempMapName,\n    setTempMapName,\n    tempCreatorName,\n    setTempCreatorName,\n    tempMapDescription,\n    setTempMapDescription,\n    confirmNewMap,\n    onClose\n}) => {\n    if (!isOpen) return null;\n\n    return (\n        <div style={{\n            position: 'absolute', top: 0, left: 0, width: '100%', height: '100%',\n            backgroundColor: 'rgba(0, 0, 0, 0.5)', zIndex: 1000,\n            display: 'flex', alignItems: 'center', justifyContent: 'center'\n        }}>\n            <div style={{\n                backgroundColor: '#fff', borderRadius: '8px',\n                boxShadow: '0 8px 24px rgba(0,0,0,0.2)', width: '320px',\n                display: 'flex', flexDirection: 'column', overflow: 'hidden'\n            }}>\n                <div style={{\n                    padding: '12px 15px',\n                    borderBottom: '2px solid #eee',\n                    display: 'flex',\n                    justifyContent: 'space-between',\n                    alignItems: 'center'\n                }}>\n                    <h3 style={{ margin: 0, fontSize: '18px', fontWeight: 'bold', color: '#333' }}>Create New Map</h3>\n                    <CloseButton onClick={onClose}></CloseButton>\n                </div>\n\n                <div style={{ padding: '20px', display: 'flex', flexDirection: 'column', gap: '15px' }}>\n                    <div>\n                        <label style={{ display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px', color: '#666' }}>Map Name:</label>\n                        <input\n                            type=\"text\"\n                            value={tempMapName}\n                            onChange={(e) => setTempMapName(e.target.value)}\n                            style={{ width: '100%', padding: '8px', borderRadius: '4px', border: '1px solid #ccc', boxSizing: 'border-box' }}\n                        />\n                    </div>\n\n                    <div>\n                        <label style={{ display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px', color: '#666' }}>Creator Nickname:</label>\n                        <input\n                            type=\"text\"\n                            value={tempCreatorName}\n                            onChange={(e) => setTempCreatorName(e.target.value)}\n                            style={{ width: '100%', padding: '8px', borderRadius: '4px', border: '1px solid #ccc', boxSizing: 'border-box' }}\n                        />\n                    </div>\n\n                    <div>\n                        <label style={{ display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px', color: '#666' }}>Description:</label>\n                        <textarea\n                            value={tempMapDescription}\n                            onChange={(e) => setTempMapDescription(e.target.value)}\n                            style={{ width: '100%', padding: '8px', borderRadius: '4px', border: '1px solid #ccc', boxSizing: 'border-box', minHeight: '60px', resize: 'vertical' }}\n                        />\n                    </div>\n\n                    <div style={{ display: 'flex', justifyContent: 'flex-end', gap: '10px', marginTop: '10px' }}>\n                        <ToolsEditorButton onClick={onClose} $variant=\"secondary\" $small>\n                            Cancel\n                        </ToolsEditorButton>\n                        <ToolsEditorButton onClick={() => confirmNewMap(tempMapName, tempCreatorName, tempMapDescription)} $variant=\"play\" $small>\n                            Create\n                        </ToolsEditorButton>\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n};\n","import React from 'react';\nimport styled from 'styled-components';\nimport { BUILT_IN_MAPS } from '../../../../constants/builtInMaps';\nimport { CloseButton } from '../styles/EditorElementsButtonStyle';\n\nconst ModalOverlay = styled.div`\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background-color: rgba(0, 0, 0, 0.6);\n    z-index: 3000;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    backdrop-filter: blur(2px);\n`;\n\nconst ModalContent = styled.div`\n    background-color: #fff;\n    padding: 20px;\n    border-radius: 8px;\n    width: 900px;\n    max-width: 95%;\n    max-height: 85%;\n    overflow-y: auto;\n    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);\n    display: flex;\n    flex-direction: column;\n    gap: 15px;\n`;\n\nconst ModalHeader = styled.div`\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    border-bottom: 2px solid #eee;\n    padding-bottom: 10px;\n`;\n\nconst ModalTitle = styled.h2`\n    margin: 0;\n    font-size: 24px;\n    color: #333;\n`;\n\nconst MapList = styled.div`\n    display: grid;\n    grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));\n    gap: 15px;\n    padding: 5px;\n`;\n\nconst MapCard = styled.div`\n    border: 1px solid #ddd;\n    border-radius: 8px;\n    padding: 15px;\n    cursor: pointer;\n    background-color: #f9f9f9;\n    display: flex;\n    flex-direction: column;\n    gap: 10px;\n    transition: all 0.2s ease;\n\n    &:hover {\n        background-color: #f0f7ff;\n        border-color: #2196f3;\n        transform: translateY(-3px);\n        box-shadow: 0 5px 15px rgba(0,0,0,0.1);\n    }\n`;\n\nconst MapTitle = styled.div`\n    font-weight: bold;\n    font-size: 16px;\n    color: #333;\n`;\n\nconst MapAuthor = styled.div`\n    font-size: 12px;\n    color: #666;\n`;\n\nconst MapDescription = styled.div`\n    font-size: 11px;\n    color: #777;\n    font-style: italic;\n    line-height: 1.4;\n    display: -webkit-box;\n    -webkit-line-clamp: 3;\n    -webkit-box-orient: vertical;\n    overflow: hidden;\n    min-height: 45px;\n`;\n\nconst MapInfo = styled.div`\n    margin-top: auto;\n    padding-top: 8px;\n    border-top: 1px solid #eee;\n    font-size: 11px;\n    color: #555;\n    display: flex;\n    justify-content: space-between;\n`;\n\nexport const BuiltInMapsModal = ({ isOpen, onClose, onSelect }) => {\n    if (!isOpen) return null;\n\n    return (\n        <ModalOverlay onClick={onClose}>\n            <ModalContent onClick={e => e.stopPropagation()}>\n                <ModalHeader>\n                    <ModalTitle>Select a Built-in Map to Edit</ModalTitle>\n                    <CloseButton onClick={onClose}></CloseButton>\n                </ModalHeader>\n                \n                <MapList>\n                    {BUILT_IN_MAPS.map((map, index) => {\n                        const isV2 = map.meta?.version === \"2.0\";\n                        const projectName = map.meta?.projectName || map.meta?.name || \"Unnamed Map\";\n                        const author = map.meta?.author || \"Unknown\";\n                        const description = map.meta?.description || \"\";\n                        \n                        let sizeInfo = \"\";\n                        let subMapInfo = \"\";\n\n                        if (isV2 && map.maps) {\n                            const mainMap = map.maps[map.meta?.activeMapId || 'main'] || Object.values(map.maps)[0];\n                            if (mainMap) {\n                                sizeInfo = `${mainMap.width}x${mainMap.height}`;\n                            }\n                            \n                            const mapValues = Object.values(map.maps);\n                            const overworldCount = mapValues.filter(m => m.type === 'overworld').length;\n                            const underworldCount = mapValues.filter(m => m.type === 'underworld').length;\n                            \n                            subMapInfo = ` (O:${overworldCount}, U:${underworldCount})`;\n                        } else {\n                            sizeInfo = `${map.meta?.width || map.width || 0}x${map.meta?.height || map.height || 0}`;\n                        }\n\n                        return (\n                            <MapCard key={index} onClick={() => {\n                                onSelect(map);\n                                onClose();\n                            }}>\n                                <div>\n                                    <MapTitle>{projectName}</MapTitle>\n                                    <MapAuthor>By: {author}</MapAuthor>\n                                </div>\n                                {description && (\n                                    <MapDescription title={description}>\n                                        {description}\n                                    </MapDescription>\n                                )}\n                                <MapInfo>\n                                    <div>Size: {sizeInfo}{subMapInfo}</div>\n                                </MapInfo>\n                            </MapCard>\n                        );\n                    })}\n                </MapList>\n            </ModalContent>\n        </ModalOverlay>\n    );\n};\n","import React, { useState, useRef, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\n\nlet topZIndex = 1002;\n\nexport const DraggableWindow = ({\n    title,\n    children,\n    defaultPosition = { x: 20, y: 20 },\n    defaultWidth = 280,\n    isOpenDefault = true,\n    onHeightChange\n}) => {\n    const { t } = useTranslation('editor_scene');\n    const [position] = useState(defaultPosition);\n    const [zIndex, setZIndex] = useState(() => {\n        topZIndex += 1;\n        return topZIndex;\n    });\n    const [isDragging, setIsDragging] = useState(false);\n    const [dragOffset, setDragOffset] = useState({ x: 0, y: 0 });\n    const [currentPosition, setCurrentPosition] = useState(defaultPosition);\n    const [isMinimized, setIsMinimized] = useState(!isOpenDefault);\n    const [isClosed, setIsClosed] = useState(false);\n    const [hasBeenDragged, setHasBeenDragged] = useState(false);\n    const windowRef = useRef(null);\n\n    // Update position from parent when not dragged\n    useEffect(() => {\n        if (!hasBeenDragged) {\n            setCurrentPosition(defaultPosition);\n        }\n    }, [defaultPosition, hasBeenDragged]);\n\n    const lastHeightRef = useRef(0);\n\n    // Notify parent about height changes\n    useEffect(() => {\n        if (windowRef.current && onHeightChange) {\n            const height = windowRef.current.offsetHeight;\n            if (height !== lastHeightRef.current) {\n                lastHeightRef.current = height;\n                onHeightChange(height);\n            }\n        }\n    });\n\n    useEffect(() => {\n        if (isDragging) {\n            const handleMouseMove = (e) => {\n                setCurrentPosition({\n                    x: e.clientX - dragOffset.x,\n                    y: e.clientY - dragOffset.y\n                });\n            };\n\n            const handleMouseUp = () => {\n                setIsDragging(false);\n            };\n\n            document.addEventListener('mousemove', handleMouseMove);\n            document.addEventListener('mouseup', handleMouseUp);\n\n            return () => {\n                document.removeEventListener('mousemove', handleMouseMove);\n                document.removeEventListener('mouseup', handleMouseUp);\n            };\n        }\n    }, [isDragging, dragOffset]);\n\n    const handleMouseDown = (e) => {\n        if (windowRef.current) {\n            topZIndex += 1;\n            setZIndex(topZIndex);\n            const rect = windowRef.current.getBoundingClientRect();\n            setDragOffset({\n                x: e.clientX - rect.left,\n                y: e.clientY - rect.top\n            });\n            setIsDragging(true);\n            setHasBeenDragged(true);\n        }\n    };\n\n    if (isClosed) return null;\n\n    return (\n        <div\n            ref={windowRef}\n            style={{\n                position: 'fixed',\n                left: currentPosition.x,\n                top: currentPosition.y,\n                width: defaultWidth,\n                backgroundColor: '#fff',\n                border: '1px solid #ddd',\n                borderRadius: '8px',\n                boxShadow: '0 4px 12px rgba(0,0,0,0.15)',\n                zIndex: zIndex,\n                display: 'flex',\n                flexDirection: 'column',\n                maxHeight: '80vh',\n                overflow: 'hidden'\n            }}\n        >\n            {/* Window Header */}\n            <div\n                onMouseDown={handleMouseDown}\n                style={{\n                    padding: '12px 15px',\n                    backgroundColor: '#fff',\n                    cursor: isDragging ? 'grabbing' : 'grab',\n                    fontWeight: 'bold',\n                    fontSize: '18px',\n                    display: 'flex',\n                    justifyContent: 'space-between',\n                    alignItems: 'center',\n                    userSelect: 'none',\n                    borderBottom: '2px solid #eee',\n                    color: '#333'\n                }}\n            >\n                <span>{title}</span>\n                <div style={{ display: 'flex', gap: '8px', alignItems: 'center' }}>\n                    <button\n                        onClick={(e) => {\n                            e.stopPropagation();\n                            setIsMinimized(!isMinimized);\n                        }}\n                        style={{\n                            background: '#f0f0f0',\n                            border: '1px solid #ccc',\n                            borderRadius: '4px',\n                            width: '24px',\n                            height: '24px',\n                            cursor: 'pointer',\n                            fontSize: '14px',\n                            display: 'flex',\n                            alignItems: 'center',\n                            justifyContent: 'center',\n                            padding: 0,\n                            color: '#333'\n                        }}\n                        title={isMinimized ? t('EDITOR_SCENE_WINDOW_MAXIMIZE') : t('EDITOR_SCENE_WINDOW_MINIMIZE')}\n                    >\n                        {isMinimized ? '' : ''}\n                    </button>\n                    <button\n                        onClick={(e) => {\n                            e.stopPropagation();\n                            setIsClosed(true);\n                        }}\n                        style={{\n                            background: '#f0f0f0',\n                            border: '1px solid #ccc',\n                            borderRadius: '4px',\n                            width: '24px',\n                            height: '24px',\n                            cursor: 'pointer',\n                            color: '#333',\n                            fontSize: '14px',\n                            display: 'flex',\n                            alignItems: 'center',\n                            justifyContent: 'center',\n                            padding: 0\n                        }}\n                        title={t('EDITOR_SCENE_WINDOW_CLOSE')}\n                    >\n                        \n                    </button>\n                </div>\n            </div>\n\n            {/* Window Content */}\n            {!isMinimized && (\n                <div\n                    style={{\n                        padding: '15px',\n                        overflowY: 'auto',\n                        flex: 1\n                    }}\n                >\n                    {children}\n                </div>\n            )}\n        </div>\n    );\n};\n","import React, { useState, useRef, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\n\nexport const EditorMapResizer = ({\n    mapWidth,\n    mapHeight,\n    onResize\n}) => {\n    const { t } = useTranslation('editor_scene');\n    const containerRef = useRef(null);\n    const [isDragging, setIsDragging] = useState(false);\n    const [startSize, setStartSize] = useState({ width: mapWidth, height: mapHeight });\n    const [startMousePos, setStartMousePos] = useState({ x: 0, y: 0 });\n\n    // Calculate display size (each block is represented by 10px)\n    const displayWidth = mapWidth * 10;\n    const displayHeight = mapHeight * 10;\n\n    const handleCornerMouseDown = (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        setIsDragging(true);\n        setStartSize({ width: mapWidth, height: mapHeight });\n        setStartMousePos({ x: e.clientX, y: e.clientY });\n    };\n\n    useEffect(() => {\n        if (!isDragging) return;\n\n        const handleMouseMove = (e) => {\n            const dx = e.clientX - startMousePos.x;\n            const dy = e.clientY - startMousePos.y;\n\n            // Each 10px of drag = 1 block\n            const blocksX = Math.round(dx / 10);\n            const blocksY = Math.round(dy / 10);\n\n            const newWidth = Math.max(5, Math.min(100, startSize.width + blocksX));\n            const newHeight = Math.max(5, Math.min(100, startSize.height + blocksY));\n\n            if (newWidth !== mapWidth || newHeight !== mapHeight) {\n                onResize(newWidth, newHeight);\n            }\n        };\n\n        const handleMouseUp = () => {\n            setIsDragging(false);\n        };\n\n        document.addEventListener('mousemove', handleMouseMove);\n        document.addEventListener('mouseup', handleMouseUp);\n\n        return () => {\n            document.removeEventListener('mousemove', handleMouseMove);\n            document.removeEventListener('mouseup', handleMouseUp);\n        };\n    }, [isDragging, startMousePos, startSize, mapWidth, mapHeight, onResize]);\n\n    return (\n        <div style={{ display: 'flex', flexDirection: 'column', gap: '10px' }}>\n            <div style={{ fontSize: '14px', fontWeight: 'bold', textAlign: 'center' }}>\n                {t('EDITOR_SCENE_RESIZER_LABEL')}{' '}\n                <span style={{ color: '#4CAF50' }}>{mapWidth} x {mapHeight}</span>{' '}\n                {t('EDITOR_SCENE_RESIZER_BLOCKS')}\n            </div>\n\n            <div\n                ref={containerRef}\n                style={{\n                    position: 'relative',\n                    width: displayWidth + 'px',\n                    height: displayHeight + 'px',\n                    border: '2px solid #4CAF50',\n                    backgroundColor: '#e8f5e9',\n                    borderRadius: '4px',\n                    display: 'flex',\n                    alignItems: 'center',\n                    justifyContent: 'center',\n                    fontSize: '12px',\n                    color: '#2e7d32',\n                    fontWeight: 'bold',\n                    userSelect: 'none',\n                    minWidth: '50px',\n                    minHeight: '50px'\n                }}\n            >\n                {mapWidth}  {mapHeight}\n\n                {/* Resize handle - bottom right corner */}\n                <div\n                    onMouseDown={handleCornerMouseDown}\n                    style={{\n                        position: 'absolute',\n                        bottom: -5,\n                        right: -5,\n                        width: '15px',\n                        height: '15px',\n                        backgroundColor: '#4CAF50',\n                        cursor: 'nwse-resize',\n                        borderRadius: '50%',\n                        border: '2px solid #fff',\n                        boxShadow: '0 2px 4px rgba(0,0,0,0.2)',\n                        zIndex: 10\n                    }}\n                />\n            </div>\n\n            <div style={{ fontSize: '11px', color: '#666', textAlign: 'center' }}>\n                 {t('EDITOR_SCENE_RESIZER_HINT_LINE1')}<br/>\n                {t('EDITOR_SCENE_RESIZER_HINT_LINE2')}\n            </div>\n        </div>\n    );\n};\n","import React, { useRef, useEffect } from 'react';\n\nexport const Minimap = ({\n    mapWidth,\n    mapHeight,\n    tileMapData,\n    objectMapData,\n    objectMetadata,\n    registryItems,\n    backgroundColor\n}) => {\n    const canvasRef = useRef(null);\n    const minimapWidth = 250;\n    const minimapHeight = 200;\n\n    useEffect(() => {\n        const canvas = canvasRef.current;\n        if (!canvas) return;\n\n        const ctx = canvas.getContext('2d');\n        const tileWidth = minimapWidth / mapWidth;\n        const tileHeight = minimapHeight / mapHeight;\n\n        // Clear canvas\n        ctx.fillStyle = backgroundColor || '#87CEEB';\n        ctx.fillRect(0, 0, minimapWidth, minimapHeight);\n\n        // Draw tiles\n        for (let y = 0; y < mapHeight; y++) {\n            for (let x = 0; x < mapWidth; x++) {\n                const index = y * mapWidth + x;\n                const tileId = tileMapData[index];\n                const objectId = objectMapData[index];\n\n                const px = x * tileWidth;\n                const py = y * tileHeight;\n\n                // Draw tile\n                if (tileId !== null) {\n                    const tile = registryItems.find(item => item.id === tileId);\n                    if (tile) {\n                        if (tile.flags?.liquid) {\n                            if (tile.flags.lava_waterfall) {\n                                ctx.fillStyle = '#ffcc00';\n                            } else if (tile.flags.radioactive_waterfall) {\n                                ctx.fillStyle = '#32cd32';\n                            } else if (tile.flags.waterfall) {\n                                ctx.fillStyle = '#3a7fb8';\n                            } else if (tile.flags.water) {\n                                ctx.fillStyle = '#3a7fb8';\n                            } else if (tile.flags.lava) {\n                                ctx.fillStyle = '#ffcc00';\n                            } else if (tile.flags.quicksand) {\n                                ctx.fillStyle = '#a6915b';\n                            } else if (tile.flags.radioactive_water) {\n                                ctx.fillStyle = '#32cd32';\n                            } else {\n                                ctx.fillStyle = '#888';\n                            }\n                        } else {\n                            // Solid block - darker color\n                            ctx.fillStyle = '#654321';\n                        }\n                        ctx.fillRect(px, py, Math.ceil(tileWidth), Math.ceil(tileHeight));\n                    }\n                }\n\n                // Draw object on top\n                if (objectId !== null) {\n                    const obj = registryItems.find(item => item.id === objectId);\n                    if (obj) {\n                        // Objects in bright colors\n                        if (obj.name?.startsWith('entities.')) {\n                            ctx.fillStyle = '#ff0000'; // Red for entities\n                        } else if (obj.name?.startsWith('item.')) {\n                            ctx.fillStyle = '#00ff00'; // Green for items\n                        } else if (obj.name?.startsWith('interactable.')) {\n                            ctx.fillStyle = '#ff00ff'; // Magenta for interactables\n                        } else if (obj.type === 'hazard') {\n                            ctx.fillStyle = '#ff8800'; // Orange for hazards\n                        } else {\n                            ctx.fillStyle = '#ffff00'; // Yellow for others\n                        }\n                        ctx.fillRect(px, py, Math.ceil(tileWidth), Math.ceil(tileHeight));\n                    }\n                }\n            }\n        }\n\n        // Draw grid\n        ctx.strokeStyle = 'rgba(255, 255, 255, 0.2)';\n        ctx.lineWidth = 0.5;\n        for (let x = 0; x <= mapWidth; x++) {\n            ctx.beginPath();\n            ctx.moveTo(x * tileWidth, 0);\n            ctx.lineTo(x * tileWidth, minimapHeight);\n            ctx.stroke();\n        }\n        for (let y = 0; y <= mapHeight; y++) {\n            ctx.beginPath();\n            ctx.moveTo(0, y * tileHeight);\n            ctx.lineTo(minimapWidth, y * tileHeight);\n            ctx.stroke();\n        }\n\n        // Draw connections between portals and targets\n        if (objectMetadata) {\n            const portals = [];\n            const targets = [];\n\n            for (let i = 0; i < mapWidth * mapHeight; i++) {\n                const id = objectMapData[i];\n                if (!id) continue;\n                const metadata = objectMetadata[i];\n                if (!metadata || metadata.triggerId === null || metadata.triggerId === undefined) continue;\n\n                const pos = {\n                    x: (i % mapWidth) * tileWidth + tileWidth / 2,\n                    y: Math.floor(i / mapWidth) * tileHeight + tileHeight / 2\n                };\n\n                if (id.includes('portal') && !id.includes('target')) {\n                    portals.push({ triggerId: metadata.triggerId, pos });\n                } else if (id.includes('target') || id === 'portal_target') {\n                    targets.push({ triggerId: metadata.triggerId, pos });\n                }\n            }\n\n            portals.forEach(portal => {\n                const target = targets.find(t => t.triggerId === portal.triggerId);\n                if (target) {\n                    ctx.beginPath();\n                    ctx.setLineDash([5, 3]);\n                    ctx.strokeStyle = '#fff';\n                    ctx.lineWidth = 2;\n                    ctx.moveTo(portal.pos.x, portal.pos.y);\n                    ctx.lineTo(target.pos.x, target.pos.y);\n                    ctx.stroke();\n                    ctx.setLineDash([]);\n                }\n            });\n        }\n\n    }, [mapWidth, mapHeight, tileMapData, objectMapData, objectMetadata, registryItems]);\n\n    return (\n        <canvas\n            ref={canvasRef}\n            width={minimapWidth}\n            height={minimapHeight}\n            style={{\n                width: '100%',\n                height: 'auto',\n                border: '1px solid #ccc',\n                borderRadius: '4px',\n                backgroundColor: '#87CEEB',\n                imageRendering: 'pixelated'\n            }}\n        />\n    );\n};\n","import React, { useRef, useEffect, useMemo, useCallback } from 'react';\nimport { useTranslation } from 'react-i18next';\n\nexport const WorldView = ({\n    maps,\n    activeMapId,\n    switchMap,\n    registryItems,\n    currentMapData,\n    createMap,\n    deleteMap,\n    updateMapData,\n    onAddRoomArea,\n    showRoomMapContent\n}) => {\n    const { t } = useTranslation('editor_scene');\n    const canvasRef = useRef(null);\n    const containerRef = useRef(null);\n    const mapLayoutsRef = useRef({});\n    const dragRef = useRef(null); // { id, startX, startY, mapStartX, mapStartY }\n\n    // Prepare all maps data, using live data for the active map\n    const allMaps = useMemo(() => {\n        const result = { ...maps };\n        if (currentMapData && currentMapData.id && result[currentMapData.id]) {\n            result[currentMapData.id] = {\n                ...result[currentMapData.id],\n                mapWidth: currentMapData.mapWidth,\n                mapHeight: currentMapData.mapHeight,\n                tileMapData: currentMapData.tileMapData,\n                objectMapData: currentMapData.objectMapData,\n                objectMetadata: currentMapData.objectMetadata,\n                selectedBackgroundColor: currentMapData.selectedBackgroundColor\n            };\n        }\n        return Object.values(result);\n    }, [maps, currentMapData]);\n\n    // Draw function\n    const draw = useCallback(() => {\n        const canvas = canvasRef.current;\n        if (!canvas) return;\n\n        const ctx = canvas.getContext('2d');\n        \n        // Settings\n        const baseTileSize = 4; // Each tile in world view\n        \n        // Sync mapLayoutsRef with allMaps, but preserve positions for maps being dragged\n        const layouts = mapLayoutsRef.current;\n        \n        // Remove layouts for deleted maps\n        const currentIds = new Set(allMaps.map(m => m.id));\n        Object.keys(layouts).forEach(id => {\n            if (!currentIds.has(id)) {\n                delete layouts[id];\n            }\n        });\n\n        allMaps.forEach(map => {\n            const isDragging = dragRef.current && dragRef.current.id === map.id;\n            const w = map.mapWidth * baseTileSize;\n            const h = map.mapHeight * baseTileSize;\n\n            if (!layouts[map.id]) {\n                layouts[map.id] = { x: map.worldX || 0, y: map.worldY || 0, w, h, map };\n            } else {\n                layouts[map.id].w = w;\n                layouts[map.id].h = h;\n                layouts[map.id].map = map;\n                // Update position from props ONLY if not currently dragging this map\n                if (!isDragging) {\n                    layouts[map.id].x = map.worldX || 0;\n                    layouts[map.id].y = map.worldY || 0;\n                }\n            }\n        });\n\n        // Clear\n        ctx.fillStyle = '#222';\n        ctx.fillRect(0, 0, canvas.width, canvas.height);\n\n        // Grid (optional but helpful)\n        ctx.strokeStyle = '#333';\n        ctx.lineWidth = 1;\n        for (let x = 0; x < canvas.width; x += 50) {\n            ctx.beginPath(); ctx.moveTo(x, 0); ctx.lineTo(x, canvas.height); ctx.stroke();\n        }\n        for (let y = 0; y < canvas.height; y += 50) {\n            ctx.beginPath(); ctx.moveTo(0, y); ctx.lineTo(canvas.width, y); ctx.stroke();\n        }\n\n        // 1. Draw Maps\n        Object.values(layouts).forEach(layout => {\n            const { x, y, w, h, map } = layout;\n            const tileW = w / map.mapWidth;\n            const tileH = h / map.mapHeight;\n\n            // Background\n            ctx.fillStyle = map.selectedBackgroundColor || '#87CEEB';\n            ctx.fillRect(x, y, w, h);\n\n            // Active indicator\n            if (map.id === activeMapId) {\n                ctx.strokeStyle = '#e3de0a';\n                ctx.lineWidth = 3;\n                ctx.strokeRect(x - 4, y - 4, w + 8, h + 8);\n            } else {\n                ctx.strokeStyle = '#555';\n                ctx.lineWidth = 1;\n                ctx.strokeRect(x, y, w, h);\n            }\n\n            // Name\n            ctx.fillStyle = '#fff';\n            ctx.font = 'bold 12px Arial';\n            ctx.fillText(map.name, x, y - 10);\n            ctx.font = '10px Arial';\n            ctx.fillStyle = '#aaa';\n            ctx.fillText(map.type, x, y + h + 12);\n\n            // Delete button (X)\n            if (map.id !== 'main') {\n                ctx.fillStyle = '#ff4d4f';\n                ctx.fillRect(x + w - 15, y - 25, 15, 15);\n                ctx.fillStyle = '#fff';\n                ctx.font = 'bold 12px Arial';\n                ctx.fillText('', x + w - 11, y - 13);\n            }\n\n            // Draw Tiles & Objects (simplified)\n            for (let i = 0; i < map.mapWidth * map.mapHeight; i++) {\n                const tx = (i % map.mapWidth) * tileW + x;\n                const ty = Math.floor(i / map.mapWidth) * tileH + y;\n\n                const tileId = map.tileMapData[i];\n                const objId = map.objectMapData[i];\n                const secretId = map.secretMapData ? map.secretMapData[i] : null;\n                const meta = map.objectMetadata ? map.objectMetadata[i] : null;\n\n                // If it's a room area and we want to show content\n                if (showRoomMapContent && secretId === 'room_area' && meta?.linkedMapId && layouts[meta.linkedMapId]) {\n                    const roomMap = layouts[meta.linkedMapId].map;\n                    const rW = meta.width || 1;\n                    const rH = meta.height || 1;\n                    const rAreaW = rW * tileW;\n                    const rAreaH = rH * tileH;\n                    const rTileW = rAreaW / roomMap.mapWidth;\n                    const rTileH = rAreaH / roomMap.mapHeight;\n\n                    // Room Background\n                    ctx.fillStyle = roomMap.selectedBackgroundColor || '#1a1a1a';\n                    ctx.fillRect(tx, ty, rAreaW, rAreaH);\n                    \n                    // Room Tiles (very simplified)\n                    ctx.fillStyle = 'rgba(255, 255, 255, 0.1)';\n                    for (let ri = 0; ri < roomMap.mapWidth * roomMap.mapHeight; ri++) {\n                        if (roomMap.tileMapData[ri]) {\n                            ctx.fillRect(\n                                tx + (ri % roomMap.mapWidth) * rTileW,\n                                ty + Math.floor(ri / roomMap.mapWidth) * rTileH,\n                                Math.ceil(rTileW), Math.ceil(rTileH)\n                            );\n                        }\n                    }\n                    \n                    // Room Border\n                    ctx.strokeStyle = '#f39c12';\n                    ctx.lineWidth = 0.5;\n                    ctx.strokeRect(tx, ty, rAreaW, rAreaH);\n                } else {\n                    if (tileId) {\n                        ctx.fillStyle = '#654321';\n                        ctx.fillRect(tx, ty, Math.ceil(tileW), Math.ceil(tileH));\n                    }\n                    if (objId) {\n                        if (objId.includes('portal') && !objId.includes('target')) {\n                            ctx.fillStyle = '#007bff';\n                        } else if (objId.includes('target') || objId === 'portal_target') {\n                            ctx.fillStyle = '#ffc107';\n                        } else {\n                            ctx.fillStyle = '#dc3545';\n                        }\n                        ctx.fillRect(tx, ty, Math.ceil(tileW), Math.ceil(tileH));\n                    }\n                    if (secretId === 'room_area') {\n                        ctx.fillStyle = 'rgba(255, 255, 0, 0.3)';\n                        ctx.fillRect(tx, ty, Math.ceil(tileW * (meta?.width || 1)), Math.ceil(tileH * (meta?.height || 1)));\n                        ctx.strokeStyle = 'gold';\n                        ctx.lineWidth = 1;\n                        ctx.strokeRect(tx, ty, Math.ceil(tileW * (meta?.width || 1)), Math.ceil(tileH * (meta?.height || 1)));\n                    }\n                }\n            }\n        });\n\n        // 2. Draw Connections\n        ctx.setLineDash([5, 5]);\n        ctx.lineWidth = 2;\n\n        Object.values(layouts).forEach(sourceLayout => {\n            const { map: sourceMap, x: sx, y: sy, w: sw, h: sh } = sourceLayout;\n            const tileW = sw / sourceMap.mapWidth;\n            const tileH = sh / sourceMap.mapHeight;\n\n            const metadata = sourceMap.objectMetadata || {};\n            \n            for (let i = 0; i < sourceMap.mapWidth * sourceMap.mapHeight; i++) {\n                const objId = sourceMap.objectMapData[i];\n                if (!objId) continue;\n                \n                const meta = metadata[i];\n                if (!meta) continue;\n\n                // Identify if this is a connection source\n                const isPortalSource = objId.includes('portal') && !objId.includes('target');\n                const objDef = registryItems.find(r => r.id === objId);\n                const isDoorSource = objDef && objDef.subtype === 'door';\n\n                if (!isPortalSource && !isDoorSource) continue;\n\n                // For portals we match by triggerId, for doors by spawnTriggerId\n                const linkId = isPortalSource ? meta.triggerId : meta.spawnTriggerId;\n                if (linkId === null || linkId === undefined) continue;\n\n                const targetMapId = meta.targetMapId || sourceMap.id;\n                const targetLayout = layouts[targetMapId];\n\n                if (targetLayout) {\n                    const { map: targetMap, x: tx, y: ty, w: tw, h: th } = targetLayout;\n                    const tTileW = tw / targetMap.mapWidth;\n                    const tTileH = th / targetMap.mapHeight;\n\n                    // Find target object in target map\n                    for (let j = 0; j < targetMap.mapWidth * targetMap.mapHeight; j++) {\n                        const tObjId = targetMap.objectMapData[j];\n                        if (!tObjId) continue;\n\n                        const tObjDef = registryItems.find(r => r.id === tObjId);\n                        const isTarget = tObjId.includes('target') || tObjId === 'portal_target';\n                        const isDoorTarget = tObjDef && tObjDef.subtype === 'door';\n\n                        if (!isTarget && !isDoorTarget) continue;\n\n                        const tMeta = targetMap.objectMetadata?.[j];\n                        if (tMeta && tMeta.triggerId === linkId) {\n                            // Link found!\n                            const startX = sx + (i % sourceMap.mapWidth) * tileW + tileW / 2;\n                            const startY = sy + Math.floor(i / sourceMap.mapWidth) * tileH + tileH / 2;\n                            const endX = tx + (j % targetMap.mapWidth) * tTileW + tTileW / 2;\n                            const endY = ty + Math.floor(j / targetMap.mapWidth) * tTileH + tTileH / 2;\n\n                            // Draw line\n                            ctx.beginPath();\n                            ctx.strokeStyle = (sourceMap.id === targetMap.id) ? '#fff' : '#00ff00';\n                            ctx.moveTo(startX, startY);\n                            \n                            if (sourceMap.id !== targetMap.id) {\n                                // Calculate mid points for a nicer curve\n                                const cp1X = startX + (endX - startX) * 0.25;\n                                const cp1Y = Math.min(startY, endY) - 100;\n                                const cp2X = startX + (endX - startX) * 0.75;\n                                const cp2Y = Math.min(startY, endY) - 100;\n                                ctx.bezierCurveTo(cp1X, cp1Y, cp2X, cp2Y, endX, endY);\n                            } else {\n                                ctx.lineTo(endX, endY);\n                            }\n                            ctx.stroke();\n\n                            // Arrow head\n                            const angle = Math.atan2(endY - startY, endX - startX);\n                            ctx.save();\n                            ctx.setLineDash([]);\n                            ctx.translate(endX, endY);\n                            ctx.rotate(angle);\n                            ctx.beginPath();\n                            ctx.moveTo(0, 0);\n                            ctx.lineTo(-10, -5);\n                            ctx.lineTo(-10, 5);\n                            ctx.closePath();\n                            ctx.fillStyle = ctx.strokeStyle;\n                            ctx.fill();\n                            ctx.restore();\n                            \n                            break;\n                        }\n                    }\n                }\n            }\n        });\n    }, [allMaps, activeMapId, showRoomMapContent]);\n\n    useEffect(() => {\n        draw();\n    }, [allMaps, activeMapId, draw, showRoomMapContent]);\n\n    const handleMouseDown = (e) => {\n        const rect = canvasRef.current.getBoundingClientRect();\n        const x = e.clientX - rect.left;\n        const y = e.clientY - rect.top;\n\n        const layouts = Object.values(mapLayoutsRef.current || {});\n        \n        // Check for delete button first\n        for (const layout of layouts) {\n            if (layout.map.id !== 'main') {\n                const btnX = layout.x + layout.w - 15;\n                const btnY = layout.y - 25;\n                if (x >= btnX && x <= btnX + 15 && y >= btnY && y <= btnY + 15) {\n                    if (window.confirm(t('EDITOR_SCENE_WORLD_DELETE_CONFIRM', { name: layout.map.name }))) {\n                        deleteMap(layout.map.id);\n                    }\n                    return;\n                }\n            }\n        }\n\n        // Check for map drag/select\n        for (const layout of layouts) {\n            if (x >= layout.x && x <= layout.x + layout.w &&\n                y >= layout.y && y <= layout.y + layout.h) {\n                \n                if (e.detail === 2) { // Double click to switch\n                    switchMap(layout.map.id);\n                } else {\n                    dragRef.current = {\n                        id: layout.map.id,\n                        startX: x,\n                        startY: y,\n                        mapStartX: layout.x,\n                        mapStartY: layout.y\n                    };\n                }\n                return;\n            }\n        }\n    };\n\n    const handleMouseMove = (e) => {\n        if (!dragRef.current) return;\n\n        const rect = canvasRef.current.getBoundingClientRect();\n        const x = e.clientX - rect.left;\n        const y = e.clientY - rect.top;\n\n        const dx = x - dragRef.current.startX;\n        const dy = y - dragRef.current.startY;\n\n        const newX = Math.max(0, dragRef.current.mapStartX + dx);\n        const newY = Math.max(0, dragRef.current.mapStartY + dy);\n\n        // Update local layout for immediate visual feedback\n        if (mapLayoutsRef.current[dragRef.current.id]) {\n            mapLayoutsRef.current[dragRef.current.id].x = newX;\n            mapLayoutsRef.current[dragRef.current.id].y = newY;\n            draw();\n        }\n    };\n\n    const handleMouseUp = (e) => {\n        if (!dragRef.current) return;\n\n        const layout = mapLayoutsRef.current[dragRef.current.id];\n        if (layout) {\n            updateMapData(dragRef.current.id, {\n                worldX: layout.x,\n                worldY: layout.y\n            });\n        }\n        \n        dragRef.current = null;\n    };\n\n    return (\n        <div style={{ display: 'flex', flexDirection: 'column', gap: '10px', padding: '10px' }}>\n            <div style={{ display: 'flex', gap: '10px', alignItems: 'center' }}>\n                <button\n                    onClick={() => switchMap('main')}\n                    style={{ padding: '8px 15px', cursor: 'pointer', backgroundColor: '#1e88e5', color: 'white', border: 'none', borderRadius: '4px', fontSize: '12px', fontWeight: 'bold' }}\n                >\n                    {t('EDITOR_SCENE_WORLD_MAIN')}\n                </button>\n                <button \n                    onClick={() => createMap('overworld')}\n                    style={{ padding: '8px 15px', cursor: 'pointer', backgroundColor: '#4CAF50', color: 'white', border: 'none', borderRadius: '4px', fontSize: '12px', fontWeight: 'bold' }}\n                >\n                    {t('EDITOR_SCENE_WORLD_ADD_OVERWORLD')}\n                </button>\n                <button \n                    onClick={() => createMap('underworld')}\n                    style={{ padding: '8px 15px', cursor: 'pointer', backgroundColor: '#5D4037', color: 'white', border: 'none', borderRadius: '4px', fontSize: '12px', fontWeight: 'bold' }}\n                >\n                    {t('EDITOR_SCENE_WORLD_ADD_UNDERWORLD')}\n                </button>\n                <button \n                    onClick={onAddRoomArea}\n                    title={t('EDITOR_SCENE_WORLD_ADD_ROOM_TITLE')}\n                    style={{ padding: '8px 15px', cursor: 'pointer', backgroundColor: '#f39c12', color: 'white', border: 'none', borderRadius: '4px', fontSize: '12px', fontWeight: 'bold' }}\n                >\n                    + m<sup>2</sup>\n                </button>\n                <div style={{ marginLeft: 'auto', color: '#ccc', fontSize: '11px' }}>\n                    {t('EDITOR_SCENE_WORLD_HELP')}\n                </div>\n            </div>\n\n            <div ref={containerRef} style={{ width: '100%', height: '500px', backgroundColor: '#333', overflow: 'auto', borderRadius: '4px', position: 'relative', border: '1px solid #555' }}>\n                <canvas\n                    ref={canvasRef}\n                    width={2000}\n                    height={2000}\n                    style={{ display: 'block', cursor: dragRef.current ? 'grabbing' : 'grab' }}\n                    onMouseDown={handleMouseDown}\n                    onMouseMove={handleMouseMove}\n                    onMouseUp={handleMouseUp}\n                    onMouseLeave={handleMouseUp}\n                />\n                <div style={{ position: 'absolute', bottom: '10px', right: '10px', backgroundColor: 'rgba(0,0,0,0.7)', color: '#fff', padding: '5px 10px', borderRadius: '4px', fontSize: '11px', pointerEvents: 'none' }}>\n                    <div style={{ display: 'flex', alignItems: 'center', gap: '5px' }}><div style={{ width: 10, height: 10, backgroundColor: '#fff', border: '1px dashed #fff' }}></div> {t('EDITOR_SCENE_WORLD_LEGEND_INTRA')}</div>\n                    <div style={{ display: 'flex', alignItems: 'center', gap: '5px' }}><div style={{ width: 10, height: 10, backgroundColor: '#00ff00', border: '1px dashed #00ff00' }}></div> {t('EDITOR_SCENE_WORLD_LEGEND_INTER')}</div>\n                </div>\n            </div>\n        </div>\n    );\n};\n","import React from 'react';\nimport { useTranslation } from 'react-i18next';\n\nexport const BackgroundPanel = ({ \n    backgroundOptions, \n    selectedBackgroundImage, \n    setSelectedBackgroundImage, \n    selectedBackgroundColor, \n    backgroundParallaxFactor, \n    setBackgroundParallaxFactor \n}) => {\n    const { t } = useTranslation('editor_scene');\n    return (\n        <div style={{ display: 'flex', flexDirection: 'column', gap: '20px' }}>\n            <section>\n                <span style={{ fontSize: '13px', fontWeight: 'bold', display: 'block', marginBottom: '12px' }}>{t('EDITOR_SCENE_BACKGROUND_IMAGE')}</span>\n                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '10px' }}>\n                    <div onClick={() => setSelectedBackgroundImage(null)}\n                        style={{\n                            border: selectedBackgroundImage ? '1px solid #ccc' : '2px solid #2196F3',\n                            borderRadius: '6px', padding: '4px', cursor: 'pointer', background: '#fff',\n                            boxShadow: !selectedBackgroundImage ? '0 0 8px rgba(33, 150, 243, 0.3)' : 'none'\n                        }}\n                        title={t('EDITOR_SCENE_BACKGROUND_SOLID')}>\n                        <div style={{ width: '100%', height: '60px', background: selectedBackgroundColor, display: 'block', borderRadius: '4px' }} />\n                        <div style={{ fontSize: '11px', textAlign: 'center', paddingTop: '5px', fontWeight: !selectedBackgroundImage ? 'bold' : 'normal' }}>{t('EDITOR_SCENE_BACKGROUND_SOLID')}</div>\n                    </div>\n                    {backgroundOptions.map((bg) => (\n                        <div key={bg.name} onClick={() => setSelectedBackgroundImage(bg.metaPath)}\n                            style={{\n                                border: selectedBackgroundImage === bg.metaPath ? '2px solid #2196F3' : '1px solid #ccc',\n                                borderRadius: '6px', padding: '4px', cursor: 'pointer', background: '#fff',\n                                boxShadow: selectedBackgroundImage === bg.metaPath ? '0 0 8px rgba(33, 150, 243, 0.3)' : 'none'\n                            }}\n                            title={bg.name}>\n                            <img src={bg.src} alt={bg.name} style={{ width: '100%', height: '60px', objectFit: 'cover', display: 'block', borderRadius: '4px' }} />\n                            <div style={{ fontSize: '11px', textAlign: 'center', paddingTop: '5px', fontWeight: selectedBackgroundImage === bg.metaPath ? 'bold' : 'normal' }}>{bg.name}</div>\n                        </div>\n                    ))}\n                </div>\n            </section>\n\n            <section style={{ backgroundColor: '#f9f9f9', padding: '15px', borderRadius: '8px', border: '1px solid #ddd' }}>\n                <div style={{ marginBottom: '0px' }}>\n                    <label style={{ fontSize: '13px', fontWeight: 'bold', display: 'block', marginBottom: '8px' }}>{t('EDITOR_SCENE_BACKGROUND_PARALLAX')}</label>\n                    <div style={{ display: 'flex', alignItems: 'center', gap: '10px' }}>\n                        <input type=\"range\" min=\"0\" max=\"1\" step=\"0.05\" value={backgroundParallaxFactor}\n                            onChange={(e) => setBackgroundParallaxFactor(parseFloat(e.target.value))}\n                            style={{ flex: 1 }} />\n                        <span style={{ fontSize: '13px', fontWeight: 'bold', minWidth: '35px' }}>{backgroundParallaxFactor.toFixed(2)}</span>\n                    </div>\n                </div>\n            </section>\n        </div>\n    );\n};\n","import React from 'react';\nimport { useTranslation } from 'react-i18next';\nexport const MusicPanel = ({ \n    musicOptions, \n    selectedBackgroundMusic, \n    setSelectedBackgroundMusic \n}) => {\n    const { t } = useTranslation('editor_scene');\n    return (\n        <div style={{ display: 'flex', flexDirection: 'column', gap: '20px' }}>\n            <section>\n                <span style={{ fontSize: '13px', fontWeight: 'bold', display: 'block', marginBottom: '10px' }}>{t('EDITOR_SCENE_MUSIC_TITLE')}</span>\n                <select\n                    value={selectedBackgroundMusic || ''}\n                    onChange={(e) => setSelectedBackgroundMusic(e.target.value || null)}\n                    style={{ width: '100%', padding: '10px', borderRadius: '6px', border: '1px solid #ccc', fontSize: '13px', marginBottom: '10px' }}>\n                    <option value=\"\">{t('EDITOR_SCENE_MUSIC_NONE')}</option>\n                    {musicOptions.map(m => (\n                        <option key={m.name} value={m.metaPath}>{m.name}</option>\n                    ))}\n                </select>\n                <div style={{ fontSize: '12px', color: '#666', fontStyle: 'italic' }}>\n                    {t('EDITOR_SCENE_MUSIC_STATUS', {\n                        status: selectedBackgroundMusic ? t('EDITOR_SCENE_MUSIC_STATUS_SELECTED') : t('EDITOR_SCENE_MUSIC_STATUS_SILENCE')\n                    })}\n                </div>\n            </section>\n        </div>\n    );\n};\n","import React from 'react';\nimport { useTranslation } from 'react-i18next';\n\nexport const WeatherPanel = ({\n    weatherRain,\n    setWeatherRain,\n    weatherSnow,\n    setWeatherSnow,\n    weatherClouds,\n    setWeatherClouds,\n    weatherFog,\n    setWeatherFog,\n    weatherThunder,\n    setWeatherThunder,\n    weatherLavaRain,\n    setWeatherLavaRain,\n    weatherRadioactiveFog,\n    setWeatherRadioactiveFog,\n    weatherMeteorRain,\n    setWeatherMeteorRain\n}) => {\n    const { t } = useTranslation('editor_scene');\n    const weatherItems = [\n        { label: t('EDITOR_SCENE_WEATHER_RAIN'), value: weatherRain, setter: setWeatherRain, icon: '' },\n        { label: t('EDITOR_SCENE_WEATHER_LAVA_RAIN'), value: weatherLavaRain, setter: setWeatherLavaRain, icon: '' },\n        { label: t('EDITOR_SCENE_WEATHER_SNOW'), value: weatherSnow, setter: setWeatherSnow, icon: '' },\n        { label: t('EDITOR_SCENE_WEATHER_METEOR_RAIN'), value: weatherMeteorRain, setter: setWeatherMeteorRain, icon: '' },\n        { label: t('EDITOR_SCENE_WEATHER_CLOUDS'), value: weatherClouds, setter: setWeatherClouds, icon: '' },\n        { label: t('EDITOR_SCENE_WEATHER_FOG'), value: weatherFog, setter: setWeatherFog, icon: '' },\n        { label: t('EDITOR_SCENE_WEATHER_RADIO_FOG'), value: weatherRadioactiveFog, setter: setWeatherRadioactiveFog, icon: '' },\n        { label: t('EDITOR_SCENE_WEATHER_THUNDER'), value: weatherThunder, setter: setWeatherThunder, icon: '' },\n    ];\n\n    return (\n        <div style={{ display: 'flex', flexDirection: 'column', gap: '15px', padding: '5px' }}>\n            {weatherItems.map((item) => (\n                <div key={item.label} style={{ \n                    backgroundColor: '#f9f9f9', \n                    padding: '12px', \n                    borderRadius: '8px', \n                    border: '1px solid #ddd' \n                }}>\n                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '8px' }}>\n                        <span style={{ fontSize: '13px', fontWeight: 'bold' }}>\n                            {item.icon} {item.label}\n                        </span>\n                        <span style={{ fontSize: '12px', fontWeight: 'bold', color: '#2196F3' }}>\n                            {item.value}%\n                        </span>\n                    </div>\n                    <div style={{ display: 'flex', alignItems: 'center', gap: '10px' }}>\n                        <input \n                            type=\"range\" \n                            min=\"0\" \n                            max=\"100\" \n                            step=\"1\" \n                            value={item.value}\n                            onChange={(e) => item.setter(parseInt(e.target.value))}\n                            style={{ flex: 1, cursor: 'pointer' }} \n                        />\n                    </div>\n                </div>\n            ))}\n            <div style={{ fontSize: '11px', color: '#888', fontStyle: 'italic', textAlign: 'center', marginTop: '5px' }}>\n                {t('EDITOR_SCENE_WEATHER_HINT')}\n            </div>\n        </div>\n    );\n};\n","import styled from 'styled-components';\n\nexport const SceneEditorButton = styled.button`\n    width: 40px;\n    height: 40px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    cursor: pointer;\n    background-color: ${props => props.$active ? '#e3de0a' : '#333'};\n    color: #fff;\n    border: 1px solid ${props => props.$active ? '#1E88E5' : '#fff'};\n    border-radius: 4px;\n    margin-bottom: 10px;\n    font-size: 20px;\n    transition: all 0.2s ease;\n    box-shadow: 0 2px 4px rgba(0,0,0,0.2);\n    transform: ${props => props.$active ? 'scale(1.05)' : 'none'};\n    padding: 0;\n    outline: none;\n\n    &:hover {\n        background-color: ${props => props.$active ? '#fdfa9b' : '#444'};\n        transform: scale(1.05);\n    }\n\n    &:active {\n        transform: scale(0.95);\n        border: solid 1px #fff;\n    }\n`;\n\nexport const RightSidebarContainer = styled.div`\n    position: absolute;\n    top: 10px;\n    right: 20px;\n    display: flex;\n    flex-direction: column;\n    gap: 10px;\n    z-index: 1100;\n`;\n","import React, { useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { DraggableWindow } from './editorScene/DraggableWindow';\nimport { EditorMapResizer } from './editorScene/EditorMapResizer';\nimport { Minimap } from './editorScene/Minimap';\nimport { WorldView } from './editorScene/WorldView';\nimport { BackgroundPanel } from './editorScene/BackgroundPanel';\nimport { MusicPanel } from './editorScene/MusicPanel';\nimport { WeatherPanel } from './editorScene/WeatherPanel';\nimport { SceneEditorButton, RightSidebarContainer } from './styles/EditorSceneButtonStyle';\nimport BackgroundMusicPlayer from '../../../utilities/BackgroundMusicPlayer';\n\nexport const EditorScene = ({\n    handleMapResize,\n    isResizeWindowOpen,\n    setIsResizeWindowOpen,\n    mapWidth,\n    mapHeight,\n    tileMapData,\n    objectMapData,\n    objectMetadata,\n    registryItems,\n    backgroundOptions,\n    selectedBackgroundImage,\n    setSelectedBackgroundImage,\n    selectedBackgroundColor,\n    setSelectedBackgroundColor,\n    backgroundParallaxFactor,\n    setBackgroundParallaxFactor,\n    musicOptions,\n    selectedBackgroundMusic,\n    setSelectedBackgroundMusic,\n    weatherRain,\n    setWeatherRain,\n    weatherSnow,\n    setWeatherSnow,\n    weatherClouds,\n    setWeatherClouds,\n    weatherFog,\n    setWeatherFog,\n    weatherThunder,\n    setWeatherThunder,\n    weatherLavaRain,\n    setWeatherLavaRain,\n    weatherRadioactiveFog,\n    setWeatherRadioactiveFog,\n    weatherMeteorRain,\n    setWeatherMeteorRain,\n    // New props for multi-map\n    maps,\n    activeMapId,\n    switchMap,\n    createMap,\n    deleteMap,\n    updateMapData,\n    isWorldViewOpen,\n    setIsWorldViewOpen,\n    onAddRoomArea,\n    showRoomMapContent,\n    activeRoomIds\n}) => {\n    const { t } = useTranslation('editor_scene');\n    const [isMinimapOpen, setIsMinimapOpen] = useState(false);\n    const [isSettingsOpen, setIsSettingsOpen] = useState(false);\n    const [isBackgroundOpen, setIsBackgroundOpen] = useState(false);\n    const [isMusicOpen, setIsMusicOpen] = useState(false);\n\n    return (\n        <div style={{ display: 'contents' }}>\n            <BackgroundMusicPlayer \n                metaPath={selectedBackgroundMusic} \n                enabled={true} \n                volume={0.4} \n                isInsideRoom={activeRoomIds?.length > 0}\n            />\n            {/* Right side buttons */}\n            <RightSidebarContainer>\n                <SceneEditorButton onClick={() => setIsMinimapOpen(!isMinimapOpen)} $active={isMinimapOpen} title={t('EDITOR_SCENE_BUTTON_MAPS_MINIMAP')}></SceneEditorButton>\n                <SceneEditorButton onClick={() => setIsWorldViewOpen(!isWorldViewOpen)} $active={isWorldViewOpen} title={t('EDITOR_SCENE_BUTTON_WORLD_VIEW')}></SceneEditorButton>\n                <SceneEditorButton onClick={() => setIsBackgroundOpen(!isBackgroundOpen)} $active={isBackgroundOpen} title={t('EDITOR_SCENE_BUTTON_BACKGROUND')}></SceneEditorButton>\n                <SceneEditorButton onClick={() => setIsMusicOpen(!isMusicOpen)} $active={isMusicOpen} title={t('EDITOR_SCENE_BUTTON_MUSIC')}>\n                    <span style={{ color: '#fff' }}></span>\n                </SceneEditorButton>\n                <SceneEditorButton onClick={() => setIsSettingsOpen(!isSettingsOpen)} $active={isSettingsOpen} title={t('EDITOR_SCENE_BUTTON_SETTINGS')}></SceneEditorButton>\n                <SceneEditorButton onClick={() => setIsResizeWindowOpen(!isResizeWindowOpen)} $active={isResizeWindowOpen} title={t('EDITOR_SCENE_BUTTON_RESIZE')}></SceneEditorButton>\n            </RightSidebarContainer>\n\n            {/* Floating Windows */}\n            {isMinimapOpen && (\n                <DraggableWindow\n                    title={t('EDITOR_SCENE_WINDOW_MINIMAP')}\n                    defaultPosition={{ x: window.innerWidth - 340, y: 80 }}\n                    defaultWidth={300}\n                    isOpenDefault={true}\n                    onClose={() => setIsMinimapOpen(false)}\n                >\n                    <div style={{ display: 'flex', flexDirection: 'column', gap: '10px', padding: '5px' }}>\n                        <Minimap\n                            mapWidth={mapWidth}\n                            mapHeight={mapHeight}\n                            tileMapData={tileMapData}\n                            objectMapData={objectMapData}\n                            objectMetadata={objectMetadata}\n                            registryItems={registryItems}\n                            backgroundColor={selectedBackgroundColor}\n                        />\n                        <div style={{ fontSize: '12px', color: '#ccc', textAlign: 'center' }}>\n                            {maps[activeMapId]?.name || t('EDITOR_SCENE_MINIMAP_CURRENT_MAP')}\n                        </div>\n                    </div>\n                </DraggableWindow>\n            )}\n\n            {isWorldViewOpen && (\n                <DraggableWindow\n                    title={t('EDITOR_SCENE_WINDOW_WORLD_VIEW')}\n                    defaultPosition={{ x: 100, y: 100 }}\n                    defaultWidth={800}\n                    isOpenDefault={true}\n                    onClose={() => setIsWorldViewOpen(false)}\n                >\n                    <WorldView \n                        maps={maps}\n                        activeMapId={activeMapId}\n                        switchMap={switchMap}\n                        registryItems={registryItems}\n                        createMap={createMap}\n                        deleteMap={deleteMap}\n                        updateMapData={updateMapData}\n                        onAddRoomArea={onAddRoomArea}\n                        showRoomMapContent={showRoomMapContent}\n                        // Current map live data\n                        currentMapData={{\n                            id: activeMapId,\n                            mapWidth,\n                            mapHeight,\n                            tileMapData,\n                            objectMapData,\n                            objectMetadata,\n                            selectedBackgroundColor\n                        }}\n                    />\n                </DraggableWindow>\n            )}\n\n            {isBackgroundOpen && (\n                <DraggableWindow\n                    title={t('EDITOR_SCENE_WINDOW_BACKGROUND')}\n                    defaultPosition={{ x: window.innerWidth - 340, y: 80 }}\n                    defaultWidth={320}\n                    isOpenDefault={true}\n                    onClose={() => setIsBackgroundOpen(false)}\n                >\n                    <BackgroundPanel \n                        backgroundOptions={backgroundOptions}\n                        selectedBackgroundImage={selectedBackgroundImage}\n                        setSelectedBackgroundImage={setSelectedBackgroundImage}\n                        selectedBackgroundColor={selectedBackgroundColor}\n                        backgroundParallaxFactor={backgroundParallaxFactor}\n                        setBackgroundParallaxFactor={setBackgroundParallaxFactor}\n                    />\n                </DraggableWindow>\n            )}\n\n            {isMusicOpen && (\n                <DraggableWindow\n                    title={t('EDITOR_SCENE_WINDOW_MUSIC')}\n                    defaultPosition={{ x: window.innerWidth - 340, y: 300 }}\n                    defaultWidth={320}\n                    isOpenDefault={true}\n                    onClose={() => setIsMusicOpen(false)}\n                >\n                    <MusicPanel \n                        musicOptions={musicOptions}\n                        selectedBackgroundMusic={selectedBackgroundMusic}\n                        setSelectedBackgroundMusic={setSelectedBackgroundMusic}\n                    />\n                </DraggableWindow>\n            )}\n\n            {isSettingsOpen && (\n                <DraggableWindow\n                    title={t('EDITOR_SCENE_WINDOW_SETTINGS')}\n                    defaultPosition={{ x: window.innerWidth - 340, y: 400 }}\n                    defaultWidth={300}\n                    isOpenDefault={true}\n                    onClose={() => setIsSettingsOpen(false)}\n                >\n                    <WeatherPanel \n                        weatherRain={weatherRain}\n                        setWeatherRain={setWeatherRain}\n                        weatherSnow={weatherSnow}\n                        setWeatherSnow={setWeatherSnow}\n                        weatherClouds={weatherClouds}\n                        setWeatherClouds={setWeatherClouds}\n                        weatherFog={weatherFog}\n                        setWeatherFog={setWeatherFog}\n                        weatherThunder={weatherThunder}\n                        setWeatherThunder={setWeatherThunder}\n                        weatherLavaRain={weatherLavaRain}\n                        setWeatherLavaRain={setWeatherLavaRain}\n                        weatherRadioactiveFog={weatherRadioactiveFog}\n                        setWeatherRadioactiveFog={setWeatherRadioactiveFog}\n                        weatherMeteorRain={weatherMeteorRain}\n                        setWeatherMeteorRain={setWeatherMeteorRain}\n                    />\n                </DraggableWindow>\n            )}\n\n            {isResizeWindowOpen && (\n                <DraggableWindow\n                    title={t('EDITOR_SCENE_WINDOW_RESIZE')}\n                    defaultPosition={{ x: 400, y: 100 }}\n                    defaultWidth={300}\n                    isOpenDefault={true}\n                    onClose={() => setIsResizeWindowOpen(false)}\n                >\n                    <EditorMapResizer\n                        mapWidth={mapWidth}\n                        mapHeight={mapHeight}\n                        onResize={handleMapResize}\n                    />\n                </DraggableWindow>\n            )}\n        </div>\n    );\n};\n","import React from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { OperationButton, OperationLabel } from '../styles/EditorElementsButtonStyle';\n\nexport const OperationsPanel = ({ \n    openNewMapModal, \n    saveMap, \n    loadMap, \n    openBuiltInModal,\n    clearMap, \n    mapName, \n    creatorName,\n    mapDescription,\n    setMapName,\n    setCreatorName,\n    setMapDescription\n}) => {\n    const { t } = useTranslation('editor_elements');\n    const inputStyle = {\n        width: '100%',\n        border: '1px solid transparent',\n        background: 'transparent',\n        padding: '4px 6px',\n        fontSize: '13px',\n        fontWeight: 'bold',\n        outline: 'none',\n        borderRadius: '4px',\n        boxSizing: 'border-box',\n        transition: 'all 0.2s ease',\n        cursor: 'pointer'\n    };\n\n    const handleFocus = (e) => {\n        e.target.style.borderColor = '#2196F3';\n        e.target.style.backgroundColor = '#fff';\n        e.target.style.cursor = 'text';\n    };\n\n    const handleBlur = (e) => {\n        e.target.style.borderColor = 'transparent';\n        e.target.style.backgroundColor = 'transparent';\n        e.target.style.cursor = 'pointer';\n    };\n\n    return (\n        <div style={{ display: 'flex', flexDirection: 'column', gap: '15px' }}>\n            <div style={{ \n                padding: '15px', \n                backgroundColor: '#f9f9f9', \n                borderRadius: '8px', \n                border: '1px solid #ddd', \n                display: 'flex', \n                flexDirection: 'column', \n                gap: '10px' \n            }}>\n                <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '8px' }}>\n                    <OperationButton onClick={openNewMapModal} title={t('EDITOR_ELEMENTS_OP_NEW_MAP_TITLE')}>\n                        <span style={{ fontSize: '18px' }}></span>\n                        <span>{t('EDITOR_ELEMENTS_OP_NEW')}</span>\n                    </OperationButton>\n                    <OperationButton onClick={saveMap} title={t('EDITOR_ELEMENTS_OP_SAVE_MAP_TITLE')}>\n                        <span style={{ fontSize: '18px' }}></span>\n                        <span>{t('EDITOR_ELEMENTS_OP_SAVE')}</span>\n                    </OperationButton>\n                    <OperationLabel title={t('EDITOR_ELEMENTS_OP_LOAD_MAP_TITLE')}>\n                        <span style={{ fontSize: '18px' }}></span>\n                        <span>{t('EDITOR_ELEMENTS_OP_LOAD')}</span>\n                        <input type=\"file\" accept=\".json,.txt\" onChange={loadMap} style={{ display: 'none' }} />\n                    </OperationLabel>\n                    <OperationButton onClick={openBuiltInModal} title={t('EDITOR_ELEMENTS_OP_BUILT_IN_MAPS_TITLE')}>\n                        <span style={{ fontSize: '18px' }}></span>\n                        <span>{t('EDITOR_ELEMENTS_OP_BUILT_IN')}</span>\n                    </OperationButton>\n                    <OperationButton onClick={clearMap} $danger title={t('EDITOR_ELEMENTS_OP_CLEAR_MAP_TITLE')}>\n                        <span style={{ fontSize: '18px' }}></span>\n                        <span>{t('EDITOR_ELEMENTS_OP_CLEAR')}</span>\n                    </OperationButton>\n                </div>\n            </div>\n\n            <div style={{ padding: '12px', backgroundColor: '#f9f9f9', borderRadius: '8px', border: '1px solid #ddd', display: 'flex', flexDirection: 'column', gap: '10px' }}>\n                <div>\n                    <label style={{ fontSize: '10px', color: '#888', fontWeight: 'bold', marginLeft: '6px', marginBottom: '2px', display: 'block' }}>{t('EDITOR_ELEMENTS_OP_MAP_NAME_LABEL')}</label>\n                    <input \n                        value={mapName} \n                        onChange={(e) => setMapName(e.target.value)}\n                        style={inputStyle}\n                        onFocus={handleFocus}\n                        onBlur={handleBlur}\n                        title={t('EDITOR_ELEMENTS_OP_EDIT_MAP_NAME_TITLE')}\n                    />\n                </div>\n                \n                <div>\n                    <label style={{ fontSize: '10px', color: '#888', fontWeight: 'bold', marginLeft: '6px', marginBottom: '2px', display: 'block' }}>{t('EDITOR_ELEMENTS_OP_AUTHOR_LABEL')}</label>\n                    <input \n                        value={creatorName} \n                        onChange={(e) => setCreatorName(e.target.value)}\n                        style={inputStyle}\n                        onFocus={handleFocus}\n                        onBlur={handleBlur}\n                        title={t('EDITOR_ELEMENTS_OP_EDIT_AUTHOR_TITLE')}\n                    />\n                </div>\n\n                <div>\n                    <label style={{ fontSize: '10px', color: '#888', fontWeight: 'bold', marginLeft: '6px', marginBottom: '2px', display: 'block' }}>{t('EDITOR_ELEMENTS_OP_DESCRIPTION_LABEL')}</label>\n                    <textarea \n                        value={mapDescription} \n                        onChange={(e) => setMapDescription(e.target.value)}\n                        style={{ ...inputStyle, fontWeight: 'normal', minHeight: '60px', resize: 'vertical' }}\n                        onFocus={handleFocus}\n                        onBlur={handleBlur}\n                        title={t('EDITOR_ELEMENTS_OP_EDIT_DESCRIPTION_TITLE')}\n                    />\n                </div>\n            </div>\n        </div>\n    );\n};\n","import React, { useState } from 'react';\n\nexport const CollapsiblePanel = ({ title, children, isOpenDefault = false }) => {\n    const [isOpen, setIsOpen] = useState(isOpenDefault);\n    return (\n        <div style={{ marginBottom: '5px', border: '1px solid #ddd', borderRadius: '4px', backgroundColor: '#fff' }}>\n            <div onClick={() => setIsOpen(!isOpen)} style={{ padding: '4px 6px', cursor: 'pointer', backgroundColor: '#f0f0f0', fontWeight: 'bold', fontSize: '10px', display: 'flex', justifyContent: 'space-between', alignItems: 'center', userSelect: 'none', lineHeight: 1.1, minHeight: '20px' }}>\n                <span>{title}</span><span>{isOpen ? '' : ''}</span>\n            </div>\n            {isOpen && <div style={{ padding: '8px', maxHeight: '200px', overflowY: 'auto' }}>{children}</div>}\n        </div>\n    );\n};\n","import React, { useEffect, useMemo, useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { CollapsiblePanel } from './CollapsiblePanel';\nimport AnimatedItem from '../../../../utilities/AnimatedItem';\nimport i18n from '../../../../i18n/i18n';\nimport { getTutorialChapters, getTutorialItems } from '../../../../i18n/tutorialMessages';\n\nexport const PalettePanel = ({ \n    isPlayMode, \n    category,\n    blocks, \n    liquids, \n    entities, \n    decorations, \n    items, \n    interactables, \n    hazards, \n    secrets, \n    weather,\n    messages,\n    crackableWalls,\n    pushableWalls,\n    obstacles,\n    objectMetadata,\n    setObjectMetadata,\n    objectMapData,\n    highlightedIndex,\n    setHighlightedIndex,\n    registryItems,\n    handlePaletteSelect, \n    selectedTile \n}) => {\n    const { t } = useTranslation('editor_elements');\n    const [selectedChapter, setSelectedChapter] = useState('');\n\n    const currentLang = i18n?.language || 'en';\n    const tutorialChapters = useMemo(() => getTutorialChapters(currentLang), [currentLang]);\n    const tutorialItems = useMemo(\n        () => (selectedChapter ? getTutorialItems(selectedChapter, currentLang) : []),\n        [selectedChapter, currentLang]\n    );\n\n    useEffect(() => {\n        if (!selectedChapter && tutorialChapters.length > 0) {\n            setSelectedChapter(tutorialChapters[0]);\n        } else if (selectedChapter && !tutorialChapters.includes(selectedChapter)) {\n            setSelectedChapter(tutorialChapters[0] || '');\n        }\n    }, [tutorialChapters, selectedChapter]);\n\n    const getLiquidLabel = ({\n        isLavaWaterfall,\n        isLava,\n        isRadioactiveWaterfall,\n        isRadioactive,\n        isWater,\n        isWaterfall,\n        isQuicksand\n    }) => {\n        if (isLavaWaterfall) return t('EDITOR_ELEMENTS_LIQUID_LABEL_LFALL');\n        if (isLava) return t('EDITOR_ELEMENTS_LIQUID_LABEL_LAVA');\n        if (isRadioactiveWaterfall) return t('EDITOR_ELEMENTS_LIQUID_LABEL_RADFALL');\n        if (isRadioactive) return t('EDITOR_ELEMENTS_LIQUID_LABEL_RAD');\n        if (isWater) return t('EDITOR_ELEMENTS_LIQUID_LABEL_WATER');\n        if (isWaterfall) return t('EDITOR_ELEMENTS_LIQUID_LABEL_FALL');\n        if (isQuicksand) return t('EDITOR_ELEMENTS_LIQUID_LABEL_QUICK');\n        return t('EDITOR_ELEMENTS_LIQUID_LABEL_LIQ');\n    };\n\n    const renderPaletteItem = (item, color, layer) => {\n        const hasImage = !!(item.texture || (Array.isArray(item.textures) && item.textures.length > 0));\n        const editorIcon = item.editorIcon;\n        const isLiquid = !!(item.flags && item.flags.liquid);\n        const isWater = !!(item.flags && item.flags.water);\n        const isLava = !!(item.flags && item.flags.lava);\n        const isQuicksand = !!(item.flags && item.flags.quicksand);\n        const isWaterfall = !!(item.flags && item.flags.waterfall);\n        const isLavaWaterfall = !!(item.flags && item.flags.lava_waterfall);\n        const isRadioactive = !!(item.flags && item.flags.radioactive);\n        const isRadioactiveWaterfall = !!(item.flags && item.flags.radioactive_waterfall);\n        const isSecret = item.type === 'secret';\n        const isWeatherTrigger = item.type === 'weather_trigger';\n        const isMessageTrigger = item.type === 'message_trigger';\n        \n        const swatchStyle = isLavaWaterfall\n            ? { background: 'linear-gradient(180deg,#ffcc00,#ffff00)' }\n            : (isLava ? { background: 'linear-gradient(180deg,#ffcc00,#ffff00)' }\n            : (isWater || isWaterfall ? { background: 'linear-gradient(180deg,#3a7fb8,#5ba3d9)' }\n            : (isQuicksand ? { background: 'linear-gradient(180deg,#a6915b,#7d6d42)' }\n            : (isRadioactive || isRadioactiveWaterfall ? { background: 'linear-gradient(180deg,#1a5c1a,#32cd32)' }\n            : { background: '#eee' }))));\n\n        return (\n            <div\n                key={item.id}\n                onClick={() => handlePaletteSelect(item, layer)}\n                title={item.displayName || item.name}\n                style={{\n                    border: selectedTile?.id === item.id ? `2px solid ${color}` : '1px solid #ccc',\n                    cursor: 'pointer', padding: '2px', width: '36px', height: '36px',\n                    display: 'flex', alignItems: 'center', justifyContent: 'center', backgroundColor: '#fff',\n                    position: 'relative'\n                }}\n            >\n                {isSecret ? (\n                    <div style={{\n                        width: '100%', height: '100%', borderRadius: 2,\n                        display: 'flex', alignItems: 'center', justifyContent: 'center',\n                        background: item.filterColorInEditor || item.filterColor || 'rgba(0, 0, 0, 0.5)',\n                        color: '#fff', fontSize: 8, textAlign: 'center', lineHeight: 1.1, fontWeight: 'bold'\n                    }}>\n                        {item.editorIcon || (item.subtype === 'above' ? t('EDITOR_ELEMENTS_SECRET_ABOVE') : t('EDITOR_ELEMENTS_SECRET_BELOW'))}\n                    </div>\n                ) : (isWeatherTrigger || isMessageTrigger) ? (\n                    hasImage ? (\n                        <AnimatedItem\n                            textures={item.textures}\n                            texture={item.texture}\n                            speed={item.animationSpeed}\n                            spriteSheet={item.spriteSheet}\n                            style={{ maxWidth: '100%', maxHeight: '100%', objectFit: 'contain' }}\n                            alt={item.name}\n                        />\n                    ) : (\n                        (() => {\n                            const iconText = item.editorIcon || (item.i18nMessage ? 'i18n' : '');\n                            return (\n                        <div style={{\n                            width: '100%', height: '100%', borderRadius: 2,\n                            display: 'flex', alignItems: 'center', justifyContent: 'center',\n                            background: isMessageTrigger ? '#fff9c4' : '#f0f4f8', \n                            border: isMessageTrigger ? '1px solid #fbc02d' : '1px solid #d1d9e6',\n                            color: '#333', fontSize: (iconText === 'i18n' ? '12px' : '18px'), fontWeight: 700\n                        }}>\n                            {iconText}\n                        </div>\n                            );\n                        })()\n                    )\n                ) : editorIcon ? (\n                    <div style={{ fontSize: '24px', fontWeight: 'bold', color: '#333' }}>\n                        {editorIcon}\n                    </div>\n                ) : hasImage ? (\n                    <AnimatedItem\n                        textures={item.textures}\n                        texture={item.texture}\n                        speed={item.animationSpeed}\n                        spriteSheet={item.spriteSheet}\n                        style={{ maxWidth: '100%', maxHeight: '100%', objectFit: 'contain' }}\n                        alt={item.name}\n                    />\n                ) : (\n                    <div style={{\n                        width: '100%', height: '100%', borderRadius: 2,\n                        display: 'flex', alignItems: 'center', justifyContent: 'center', color: '#fff',\n                        fontSize: 10, textAlign: 'center', lineHeight: 1.1,\n                        ...swatchStyle\n                    }}>\n                        {isLiquid\n                            ? getLiquidLabel({\n                                isLavaWaterfall,\n                                isLava,\n                                isRadioactiveWaterfall,\n                                isRadioactive,\n                                isWater,\n                                isWaterfall,\n                                isQuicksand\n                            })\n                            : (item.name || '')}\n                    </div>\n                )}\n            </div>\n        );\n    };\n\n    if (isPlayMode) {\n        return (\n            <div style={{ padding: '20px', fontSize: '14px', color: '#666', textAlign: 'center', backgroundColor: '#f9f9f9', borderRadius: '8px' }}>\n                {t('EDITOR_ELEMENTS_PALETTE_DISABLED')}\n            </div>\n        );\n    }\n\n    return (\n        <div style={{ display: 'flex', flexDirection: 'column', gap: '10px' }}>\n            {category === 'blocks' && (() => {\n                const getBlockGroup = (b) => {\n                    if (b.editor?.group) return b.editor.group;\n                    const name = (b.id || b.name || '').toLowerCase();\n                    if (name.includes('brick')) return 'bricks';\n                    if (name.includes('diorite') || name.includes('stone')) return 'stone';\n                    if (name.includes('metal')) return 'metal';\n                    if (name.includes('wood')) return 'wood';\n                    return 'ground';\n                };\n\n                const groupOrder = [\n                    { key: 'ground', title: t('EDITOR_ELEMENTS_BLOCK_GROUP_GROUND'), color: 'blue', open: true },\n                    { key: 'bricks', title: t('EDITOR_ELEMENTS_BLOCK_GROUP_BRICKS'), color: 'blue', open: true },\n                    { key: 'stone', title: t('EDITOR_ELEMENTS_BLOCK_GROUP_STONE'), color: 'blue', open: true },\n                    { key: 'metal', title: t('EDITOR_ELEMENTS_BLOCK_GROUP_METAL'), color: 'blue', open: true },\n                    { key: 'wood', title: t('EDITOR_ELEMENTS_BLOCK_GROUP_WOOD'), color: 'blue', open: true }\n                ];\n\n                const withGroups = blocks.map(b => ({\n                    item: b,\n                    group: getBlockGroup(b)\n                }));\n\n                const sortBlocks = (a, b) => {\n                    const ao = a.item.editor?.order ?? 0;\n                    const bo = b.item.editor?.order ?? 0;\n                    if (ao !== bo) return ao - bo;\n                    return (a.item.displayName || a.item.name || '').localeCompare(b.item.displayName || b.item.name || '');\n                };\n\n                const groupPanels = groupOrder.map(group => {\n                    const items = withGroups.filter(b => b.group === group.key).sort(sortBlocks);\n                    if (items.length === 0) return null;\n                    return (\n                        <CollapsiblePanel key={group.key} title={group.title} isOpenDefault={group.open}>\n                            <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                                {items.map(b => renderPaletteItem(b.item, group.color, 'tile'))}\n                            </div>\n                        </CollapsiblePanel>\n                    );\n                }).filter(Boolean);\n\n                const otherItems = withGroups.filter(b => !groupOrder.some(g => g.key === b.group)).sort(sortBlocks);\n\n                return (\n                    <div style={{ display: 'flex', flexDirection: 'column', gap: '10px' }}>\n                        {groupPanels}\n                        {otherItems.length > 0 && (\n                            <CollapsiblePanel title={t('EDITOR_ELEMENTS_GROUP_OTHER')} isOpenDefault={false}>\n                                <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                                    {otherItems.map(b => renderPaletteItem(b.item, 'gray', 'tile'))}\n                                </div>\n                            </CollapsiblePanel>\n                        )}\n                    </div>\n                );\n            })()}\n\n            {category === 'liquids' && (() => {\n                const getLiquidGroup = (li) => {\n                    if (li.editor?.group) return li.editor.group;\n                    if (li.flags?.quicksand) return 'quicksand';\n                    if (li.flags?.lava || li.flags?.lava_waterfall) return 'lava';\n                    if (li.flags?.radioactive || li.flags?.radioactive_waterfall) return 'radiation';\n                    if (li.flags?.water || li.flags?.waterfall) return 'water';\n                    return 'other';\n                };\n\n                const groupOrder = [\n                    { key: 'quicksand', title: t('EDITOR_ELEMENTS_LIQUID_GROUP_QUICKSAND'), color: 'goldenrod', open: true },\n                    { key: 'water', title: t('EDITOR_ELEMENTS_LIQUID_GROUP_WATER'), color: 'blue', open: true },\n                    { key: 'lava', title: t('EDITOR_ELEMENTS_LIQUID_GROUP_LAVA'), color: 'orange', open: true },\n                    { key: 'radiation', title: t('EDITOR_ELEMENTS_LIQUID_GROUP_RADIATION'), color: 'green', open: true }\n                ];\n\n                const withGroups = liquids.map(li => ({\n                    item: li,\n                    group: getLiquidGroup(li)\n                }));\n\n                const sortLiquids = (a, b) => {\n                    const ao = a.item.editor?.order ?? 0;\n                    const bo = b.item.editor?.order ?? 0;\n                    if (ao !== bo) return ao - bo;\n                    return (a.item.displayName || a.item.name || '').localeCompare(b.item.displayName || b.item.name || '');\n                };\n\n                const groupPanels = groupOrder.map(group => {\n                    const items = withGroups.filter(li => li.group === group.key).sort(sortLiquids);\n                    if (items.length === 0) return null;\n                    return (\n                        <CollapsiblePanel key={group.key} title={group.title} isOpenDefault={group.open}>\n                            <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                                {items.map(li => renderPaletteItem(li.item, group.color, 'tile'))}\n                            </div>\n                        </CollapsiblePanel>\n                    );\n                }).filter(Boolean);\n\n                const otherItems = withGroups.filter(li => !groupOrder.some(g => g.key === li.group)).sort(sortLiquids);\n\n                return (\n                    <div style={{ display: 'flex', flexDirection: 'column', gap: '10px' }}>\n                        <div\n                            title={t('EDITOR_ELEMENTS_LIQUIDS_INFO_TITLE')}\n                            style={{ fontSize: '11px', color: '#666', cursor: 'help' }}\n                        >\n                             {t('EDITOR_ELEMENTS_LIQUIDS_INFO_LABEL')}\n                        </div>\n                        {groupPanels}\n                        {otherItems.length > 0 && (\n                            <CollapsiblePanel title={t('EDITOR_ELEMENTS_GROUP_OTHER')} isOpenDefault={false}>\n                                <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                                    {otherItems.map(li => renderPaletteItem(li.item, 'gray', 'tile'))}\n                                </div>\n                            </CollapsiblePanel>\n                        )}\n                    </div>\n                );\n            })()}\n\n            {category === 'decorations' && (\n                <CollapsiblePanel title={t('EDITOR_ELEMENTS_DECORATIONS_TITLE')} isOpenDefault={true}>\n                    <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                        {decorations && decorations.map(d => renderPaletteItem(d, 'purple', 'object'))}\n                    </div>\n                </CollapsiblePanel>\n            )}\n\n            {category === 'entities' && (() => {\n                const getEntityGroup = (e) => {\n                    if (e.editor?.group) return e.editor.group;\n                    const name = (e.id || e.name || '').toLowerCase();\n                    if (name.includes('player')) return 'player';\n                    if (name.includes('fish') || name.includes('animal')) return 'animals';\n                    return 'enemies';\n                };\n\n                const groupOrder = [\n                    { key: 'player', title: t('EDITOR_ELEMENTS_ENTITIES_GROUP_PLAYER'), color: 'red', open: true },\n                    { key: 'animals', title: t('EDITOR_ELEMENTS_ENTITIES_GROUP_ANIMALS'), color: 'red', open: true },\n                    { key: 'enemies', title: t('EDITOR_ELEMENTS_ENTITIES_GROUP_ENEMIES'), color: 'red', open: true }\n                ];\n\n                const withGroups = entities.map(e => ({\n                    item: e,\n                    group: getEntityGroup(e)\n                }));\n\n                const sortEntities = (a, b) => {\n                    const ao = a.item.editor?.order ?? 0;\n                    const bo = b.item.editor?.order ?? 0;\n                    if (ao !== bo) return ao - bo;\n                    return (a.item.displayName || a.item.name || '').localeCompare(b.item.displayName || b.item.name || '');\n                };\n\n                const groupPanels = groupOrder.map(group => {\n                    const groupItems = withGroups.filter(e => e.group === group.key).sort(sortEntities);\n                    if (groupItems.length === 0) return null;\n                    return (\n                        <CollapsiblePanel key={group.key} title={group.title} isOpenDefault={group.open}>\n                            <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                                {groupItems.map(e => renderPaletteItem(e.item, group.color, 'object'))}\n                            </div>\n                        </CollapsiblePanel>\n                    );\n                }).filter(Boolean);\n\n                const otherItems = withGroups.filter(e => !groupOrder.some(g => g.key === e.group)).sort(sortEntities);\n\n                return (\n                    <div style={{ display: 'flex', flexDirection: 'column', gap: '10px' }}>\n                        <div\n                            title={t('EDITOR_ELEMENTS_ENTITIES_INFO_TITLE')}\n                            style={{ fontSize: '11px', color: '#666', cursor: 'help' }}\n                        >\n                             {t('EDITOR_ELEMENTS_ENTITIES_INFO_LABEL')}\n                        </div>\n                        {groupPanels}\n                        {otherItems.length > 0 && (\n                            <CollapsiblePanel title={t('EDITOR_ELEMENTS_GROUP_OTHER')} isOpenDefault={false}>\n                                <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                                    {otherItems.map(e => renderPaletteItem(e.item, 'gray', 'object'))}\n                                </div>\n                            </CollapsiblePanel>\n                        )}\n                    </div>\n                );\n            })()}\n\n            {category === 'items' && (() => {\n                const getItemGroup = (i) => {\n                    if (i.editor?.group) return i.editor.group;\n                    if (i.effect?.health) return 'health';\n                    if (i.effect?.fireball) return 'ammunition';\n                    return 'other';\n                };\n\n                const groupOrder = [\n                    { key: 'health', title: t('EDITOR_ELEMENTS_ITEMS_GROUP_HEALTH'), color: 'green', open: true },\n                    { key: 'ammunition', title: t('EDITOR_ELEMENTS_ITEMS_GROUP_AMMUNITION'), color: 'green', open: true }\n                ];\n\n                const withGroups = items.map(i => ({\n                    item: i,\n                    group: getItemGroup(i)\n                }));\n\n                const sortItems = (a, b) => {\n                    const ao = a.item.editor?.order ?? 0;\n                    const bo = b.item.editor?.order ?? 0;\n                    if (ao !== bo) return ao - bo;\n                    return (a.item.displayName || a.item.name || '').localeCompare(b.item.displayName || b.item.name || '');\n                };\n\n                const groupPanels = groupOrder.map(group => {\n                    const groupItems = withGroups.filter(i => i.group === group.key).sort(sortItems);\n                    if (groupItems.length === 0) return null;\n                    return (\n                        <CollapsiblePanel key={group.key} title={group.title} isOpenDefault={group.open}>\n                            <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                                {groupItems.map(i => renderPaletteItem(i.item, group.color, 'object'))}\n                            </div>\n                        </CollapsiblePanel>\n                    );\n                }).filter(Boolean);\n\n                const otherItems = withGroups.filter(i => !groupOrder.some(g => g.key === i.group)).sort(sortItems);\n\n                return (\n                    <div style={{ display: 'flex', flexDirection: 'column', gap: '10px' }}>\n                        <div\n                            title={t('EDITOR_ELEMENTS_ITEMS_INFO_TITLE')}\n                            style={{ fontSize: '11px', color: '#666', cursor: 'help' }}\n                        >\n                             {t('EDITOR_ELEMENTS_ITEMS_INFO_LABEL')}\n                        </div>\n                        {groupPanels}\n                        {otherItems.length > 0 && (\n                            <CollapsiblePanel title={t('EDITOR_ELEMENTS_GROUP_OTHER')} isOpenDefault={false}>\n                                <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                                    {otherItems.map(i => renderPaletteItem(i.item, 'gray', 'object'))}\n                                </div>\n                            </CollapsiblePanel>\n                        )}\n                    </div>\n                );\n            })()}\n\n            {category === 'interactables' && (() => {\n                const getInteractableGroup = (i) => {\n                    if (i.editor?.group) return i.editor.group;\n                    if (i.subtype === 'door') return 'entrances';\n                    if (i.subtype === 'ladder') return 'ledders';\n                    if (i.subtype === 'platform' || i.subtype === 'arrow') return 'platforms';\n                    if ((i.id || '').includes('portal') || (i.name || '').includes('portal')) return 'ports';\n                    if (i.subtype === 'end') return 'ends';\n                    const name = (i.id || i.name || '').toLowerCase();\n                    if (name.includes('berry')) return 'harvestables';\n                    if (name.includes('stone') || name.includes('wooden_box')) return 'physics';\n                    if (name.includes('ice')) return 'blocks';\n                    return 'other';\n                };\n\n                const groupOrder = [\n                    { key: 'harvestables', title: t('EDITOR_ELEMENTS_INTERACTABLES_GROUP_HARVESTABLES'), color: 'purple', open: true },\n                    { key: 'physics', title: t('EDITOR_ELEMENTS_INTERACTABLES_GROUP_PHYSIC'), color: 'purple', open: true },\n                    { key: 'entrances', title: t('EDITOR_ELEMENTS_INTERACTABLES_GROUP_ENTRANCES'), color: 'purple', open: true },\n                    { key: 'platforms', title: t('EDITOR_ELEMENTS_INTERACTABLES_GROUP_PLATFORMS'), color: 'purple', open: true },\n                    { key: 'ledders', title: t('EDITOR_ELEMENTS_INTERACTABLES_GROUP_LEDDERS'), color: 'purple', open: true },\n                    { key: 'ports', title: t('EDITOR_ELEMENTS_INTERACTABLES_GROUP_PORTS'), color: 'purple', open: true },\n                    { key: 'blocks', title: t('EDITOR_ELEMENTS_INTERACTABLES_GROUP_BLOCKS'), color: 'purple', open: true },\n                    { key: 'ends', title: t('EDITOR_ELEMENTS_INTERACTABLES_GROUP_ENDS'), color: 'purple', open: true }\n                ];\n\n                const withGroups = interactables.map(i => ({\n                    item: i,\n                    group: getInteractableGroup(i)\n                }));\n\n                const sortInteractables = (a, b) => {\n                    const ao = a.item.editor?.order ?? 0;\n                    const bo = b.item.editor?.order ?? 0;\n                    if (ao !== bo) return ao - bo;\n                    return (a.item.displayName || a.item.name || '').localeCompare(b.item.displayName || b.item.name || '');\n                };\n\n                const groupPanels = groupOrder.map(group => {\n                    const items = withGroups.filter(i => i.group === group.key).sort(sortInteractables);\n                    if (items.length === 0) return null;\n                    return (\n                        <CollapsiblePanel key={group.key} title={group.title} isOpenDefault={group.open}>\n                            <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                                {items.map(i => renderPaletteItem(i.item, group.color, 'object'))}\n                            </div>\n                        </CollapsiblePanel>\n                    );\n                }).filter(Boolean);\n\n                const otherItems = withGroups.filter(i => !groupOrder.some(g => g.key === i.group)).sort(sortInteractables);\n\n                return (\n                    <div style={{ display: 'flex', flexDirection: 'column', gap: '10px' }}>\n                        {groupPanels}\n                        {otherItems.length > 0 && (\n                            <CollapsiblePanel title={t('EDITOR_ELEMENTS_GROUP_OTHER')} isOpenDefault={false}>\n                                <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                                    {otherItems.map(i => renderPaletteItem(i.item, 'gray', 'object'))}\n                                </div>\n                            </CollapsiblePanel>\n                        )}\n                    </div>\n                );\n            })()}\n\n            {category === 'hazards' && (() => {\n                const getHazardGroup = (h) => {\n                    if (h.editor?.group) return h.editor.group;\n                    if (h.collision) return 'blocks';\n                    return 'obstacles';\n                };\n\n                const groupOrder = [\n                    { key: 'blocks', title: t('EDITOR_ELEMENTS_HAZARDS_GROUP_BLOCKS'), color: 'orange', open: true },\n                    { key: 'obstacles', title: t('EDITOR_ELEMENTS_HAZARDS_GROUP_OBSTACLES'), color: 'brown', open: true }\n                ];\n\n                const withGroups = hazards.map(h => ({\n                    item: h,\n                    group: getHazardGroup(h)\n                }));\n\n                const sortHazards = (a, b) => {\n                    const ao = a.item.editor?.order ?? 0;\n                    const bo = b.item.editor?.order ?? 0;\n                    if (ao !== bo) return ao - bo;\n                    return (a.item.displayName || a.item.name || '').localeCompare(b.item.displayName || b.item.name || '');\n                };\n\n                const groupPanels = groupOrder.map(group => {\n                    const items = withGroups.filter(h => h.group === group.key).sort(sortHazards);\n                    if (items.length === 0) return null;\n                    return (\n                        <CollapsiblePanel key={group.key} title={group.title} isOpenDefault={group.open}>\n                            <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                                {items.map(h => renderPaletteItem(h.item, group.color, 'object'))}\n                            </div>\n                        </CollapsiblePanel>\n                    );\n                }).filter(Boolean);\n\n                const otherItems = withGroups.filter(h => !groupOrder.some(g => g.key === h.group)).sort(sortHazards);\n\n                return (\n                    <div style={{ display: 'flex', flexDirection: 'column', gap: '10px' }}>\n                        {groupPanels}\n                        {otherItems.length > 0 && (\n                            <CollapsiblePanel title={t('EDITOR_ELEMENTS_HAZARDS_OTHER')} isOpenDefault={false}>\n                                <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                                    {otherItems.map(h => renderPaletteItem(h.item, 'gray', 'object'))}\n                                </div>\n                            </CollapsiblePanel>\n                        )}\n                    </div>\n                );\n            })()}\n\n            {category === 'secrets' && (\n                <div style={{ display: 'flex', flexDirection: 'column', gap: '10px' }}>\n                    <CollapsiblePanel title={t('EDITOR_ELEMENTS_SECRETS_OPEN_AREA')} isOpenDefault={true}>\n                        <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                            {secrets && secrets.filter(s => s.subtype === 'open').map(s => renderPaletteItem(s, 'purple', 'secret'))}\n                        </div>\n                    </CollapsiblePanel>\n                    \n                    <CollapsiblePanel title={t('EDITOR_ELEMENTS_SECRETS_SECRET_AREA')} isOpenDefault={true}>\n                        <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                            {secrets && secrets.filter(s => s.subtype !== 'open' && s.subtype !== 'room' && s.subtype !== 'animal_trigger').map(s => renderPaletteItem(s, 'purple', 'secret'))}\n                        </div>\n                    </CollapsiblePanel>\n\n                    <CollapsiblePanel title={t('EDITOR_ELEMENTS_SECRETS_CRACKABLE_WALL')} isOpenDefault={false}>\n                        <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                            {crackableWalls && crackableWalls.map(s => renderPaletteItem(s, 'purple', 'object'))}\n                        </div>\n                    </CollapsiblePanel>\n\n                    <CollapsiblePanel title={t('EDITOR_ELEMENTS_SECRETS_PUSHABLE_WALL')} isOpenDefault={false}>\n                        <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                            {pushableWalls && pushableWalls.map(s => renderPaletteItem(s, 'purple', 'object'))}\n                        </div>\n                    </CollapsiblePanel>\n\n                    <CollapsiblePanel title={t('EDITOR_ELEMENTS_SECRETS_ANIMAL_TRIGGERS')} isOpenDefault={false}>\n                        <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                            {secrets && secrets.filter(s => s.subtype === 'animal_trigger').map(s => renderPaletteItem(s, 'purple', 'object'))}\n                        </div>\n                    </CollapsiblePanel>\n                </div>\n            )}\n\n            {category === 'weather' && (\n                <div style={{ display: 'flex', flexDirection: 'column', gap: '10px' }}>\n                    <CollapsiblePanel title={t('EDITOR_ELEMENTS_WEATHER_RAIN')} isOpenDefault={false}>\n                        <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                            {weather && weather.filter(w => w.weatherType === 'rain').map(w => renderPaletteItem(w, 'blue', 'object'))}\n                        </div>\n                    </CollapsiblePanel>\n\n                    <CollapsiblePanel title={t('EDITOR_ELEMENTS_WEATHER_SNOW')} isOpenDefault={false}>\n                        <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                            {weather && weather.filter(w => w.weatherType === 'snow').map(w => renderPaletteItem(w, 'blue', 'object'))}\n                        </div>\n                    </CollapsiblePanel>\n\n                    <CollapsiblePanel title={t('EDITOR_ELEMENTS_WEATHER_CLOUDS')} isOpenDefault={false}>\n                        <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                            {weather && weather.filter(w => w.weatherType === 'clouds').map(w => renderPaletteItem(w, 'blue', 'object'))}\n                        </div>\n                    </CollapsiblePanel>\n\n                    <CollapsiblePanel title={t('EDITOR_ELEMENTS_WEATHER_FOG')} isOpenDefault={false}>\n                        <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                            {weather && weather.filter(w => w.weatherType === 'fog').map(w => renderPaletteItem(w, 'blue', 'object'))}\n                        </div>\n                    </CollapsiblePanel>\n\n                    <CollapsiblePanel title={t('EDITOR_ELEMENTS_WEATHER_THUNDER')} isOpenDefault={false}>\n                        <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                            {weather && weather.filter(w => w.weatherType === 'thunder').map(w => renderPaletteItem(w, 'blue', 'object'))}\n                        </div>\n                    </CollapsiblePanel>\n\n                    <CollapsiblePanel title={t('EDITOR_ELEMENTS_WEATHER_LAVA_RAIN')} isOpenDefault={false}>\n                        <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                            {weather && weather.filter(w => w.weatherType === 'lavaRain').map(w => renderPaletteItem(w, 'red', 'object'))}\n                        </div>\n                    </CollapsiblePanel>\n\n                    <CollapsiblePanel title={t('EDITOR_ELEMENTS_WEATHER_RADIO_FOG')} isOpenDefault={false}>\n                        <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                            {weather && weather.filter(w => w.weatherType === 'radioactiveFog').map(w => renderPaletteItem(w, 'green', 'object'))}\n                        </div>\n                    </CollapsiblePanel>\n\n                    <CollapsiblePanel title={t('EDITOR_ELEMENTS_WEATHER_METEOR_RAIN')} isOpenDefault={false}>\n                        <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                            {weather && weather.filter(w => w.weatherType === 'meteorRain').map(w => renderPaletteItem(w, 'orange', 'object'))}\n                        </div>\n                    </CollapsiblePanel>\n                </div>\n            )}\n\n            {category === 'messages' && (\n                <div style={{ display: 'flex', flexDirection: 'column', gap: '10px' }}>\n                    <CollapsiblePanel title={t('EDITOR_ELEMENTS_MESSAGES_TITLE')} isOpenDefault={true}>\n                        <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                            {messages && messages.map(m => renderPaletteItem(m, 'gold', 'object'))}\n                        </div>\n                    </CollapsiblePanel>\n                    {selectedTile && (selectedTile.i18nMessage || selectedTile.type === 'message_trigger') && (\n                        <CollapsiblePanel title={t('EDITOR_ELEMENTS_I18N_TITLE')} isOpenDefault={true}>\n                            <div style={{ display: 'flex', flexDirection: 'column', gap: '8px' }}>\n                                <div style={{ display: 'flex', gap: '6px', flexWrap: 'wrap' }}>\n                                    {tutorialChapters.map(ch => (\n                                        <button\n                                            key={ch}\n                                            onClick={() => setSelectedChapter(ch)}\n                                            style={{\n                                                padding: '4px 8px',\n                                                fontSize: '11px',\n                                                borderRadius: '4px',\n                                                border: '1px solid #ccc',\n                                                background: ch === selectedChapter ? '#f4c542' : '#f0f0f0',\n                                                cursor: 'pointer'\n                                            }}\n                                        >\n                                            {ch}\n                                        </button>\n                                    ))}\n                                </div>\n                                <div style={{ display: 'flex', flexDirection: 'column', gap: '6px', maxHeight: '200px', overflowY: 'auto' }}>\n                                    {tutorialItems.map(item => (\n                                        <button\n                                            key={`${selectedChapter}_${item.id}`}\n                                            onClick={() => {\n                                                let targetIndex = highlightedIndex;\n                                                if ((targetIndex === null || targetIndex === undefined) && selectedTile?.id && objectMapData) {\n                                                    const idx = objectMapData.findIndex(id => id === selectedTile.id);\n                                                    if (idx >= 0) {\n                                                        targetIndex = idx;\n                                                        if (setHighlightedIndex) setHighlightedIndex(idx);\n                                                    }\n                                                }\n                                                if (targetIndex === null || targetIndex === undefined) return;\n                                                const objId = objectMapData?.[targetIndex];\n                                                const objDef = registryItems?.find(r => r.id === objId);\n                                                if (!objDef || objDef.type !== 'message_trigger') return;\n                                                setObjectMetadata(prev => ({\n                                                    ...prev,\n                                                    [targetIndex]: {\n                                                        ...prev[targetIndex],\n                                                        i18nChapter: selectedChapter,\n                                                        i18nId: item.id,\n                                                        message: ''\n                                                    }\n                                                }));\n                                            }}\n                                            style={{\n                                                display: 'flex',\n                                                alignItems: 'center',\n                                                justifyContent: 'space-between',\n                                                gap: '8px',\n                                                padding: '6px 8px',\n                                                borderRadius: '4px',\n                                                border: '1px solid #ddd',\n                                                background: '#fff',\n                                                cursor: 'pointer',\n                                                textAlign: 'left'\n                                            }}\n                                        >\n                                            <span style={{ fontSize: '11px', color: '#555' }}>{t('EDITOR_ELEMENTS_I18N_ID', { id: item.id })}</span>\n                                            <span style={{ fontSize: '11px', color: '#222', flex: 1 }}>{item.text}</span>\n                                        </button>\n                                    ))}\n                                </div>\n                                {(highlightedIndex === null || highlightedIndex === undefined) && (\n                                    <div style={{ fontSize: '11px', color: '#888' }}>\n                                        {t('EDITOR_ELEMENTS_I18N_SELECT_HINT')}\n                                    </div>\n                                )}\n                            </div>\n                        </CollapsiblePanel>\n                    )}\n                </div>\n            )}\n\n            {category === 'obstacles' && (\n                <CollapsiblePanel title={t('EDITOR_ELEMENTS_OBSTACLES_TITLE')} isOpenDefault={true}>\n                    <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>\n                        {obstacles && obstacles.length > 0 ? (\n                            obstacles.map(o => renderPaletteItem(o, 'brown', 'object'))\n                        ) : (\n                            <div style={{ padding: '10px', fontSize: '12px', color: '#999', fontStyle: 'italic' }}>\n                                {t('EDITOR_ELEMENTS_OBSTACLES_EMPTY')}\n                            </div>\n                        )}\n                    </div>\n                </CollapsiblePanel>\n            )}\n        </div>\n    );\n};\n","import React from 'react';\nimport { useTranslation, Trans } from 'react-i18next';\n\nexport const StatisticsPanel = ({ \n    totalTiles, \n    mapWidth, \n    mapHeight, \n    filledBlocks, \n    objectsCount, \n    emptyBlocks,\n    objectMapData,\n    registryItems,\n    maps\n}) => {\n    const { t } = useTranslation('editor_elements');\n    const registryMap = registryItems && registryItems.__byId;\n    const getDef = (id) => {\n        if (!id) return null;\n        if (registryMap && typeof registryMap.get === 'function') return registryMap.get(id) || null;\n        return Array.isArray(registryItems) ? registryItems.find(r => r.id === id) : null;\n    };\n\n    let itemsCount = 0;\n    let entitiesCount = 0;\n\n    if (Array.isArray(objectMapData)) {\n        objectMapData.forEach((id) => {\n            if (!id) return;\n            const def = getDef(id);\n            if (!def) return;\n            const name = (def.name || '').toLowerCase();\n            if (name.startsWith('item.')) itemsCount += 1;\n            if (def.type === 'entity' || def.subtype === 'tank' || def.subtype === 'platform' || name.includes('entities.')) {\n                entitiesCount += 1;\n            }\n        });\n    }\n\n    const mapList = maps ? Object.values(maps) : [];\n    const mapsTotal = mapList.length;\n    const mapsOverworld = mapList.filter(m => m.type === 'overworld').length;\n    const mapsUnderworld = mapList.filter(m => m.type === 'underworld').length;\n    const mapsRooms = mapList.filter(m => m.type === 'room').length;\n    return (\n        <div style={{ display: 'flex', flexDirection: 'column', gap: '12px' }}>\n            <div style={{ padding: '15px', backgroundColor: '#e6f7ff', borderRadius: '8px', border: '1px solid #91d5ff' }}>\n                <div style={{ fontSize: '14px', marginBottom: '8px' }}>\n                    <Trans i18nKey=\"EDITOR_ELEMENTS_STATS_TOTAL_AREA\" t={t} values={{ count: totalTiles }} components={[<strong key=\"count\" />]} />\n                </div>\n                <div style={{ fontSize: '13px', color: '#0050b3' }}>{t('EDITOR_ELEMENTS_STATS_DIMENSIONS', { width: mapWidth, height: mapHeight })}</div>\n            </div>\n            <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '10px' }}>\n                <div style={{ padding: '12px', backgroundColor: '#f6ffed', borderRadius: '8px', border: '1px solid #b7eb8f', textAlign: 'center' }}>\n                    <div style={{ fontSize: '20px', fontWeight: 'bold', color: '#389e0d' }}>{filledBlocks}</div>\n                    <div style={{ fontSize: '11px', color: '#555' }}>{t('EDITOR_ELEMENTS_STATS_FILLED_BLOCKS')}</div>\n                </div>\n                <div style={{ padding: '12px', backgroundColor: '#fff7e6', borderRadius: '8px', border: '1px solid #ffd591', textAlign: 'center' }}>\n                    <div style={{ fontSize: '20px', fontWeight: 'bold', color: '#d46b08' }}>{objectsCount}</div>\n                    <div style={{ fontSize: '11px', color: '#555' }}>{t('EDITOR_ELEMENTS_STATS_OBJECTS')}</div>\n                </div>\n            </div>\n            <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '10px' }}>\n                <div style={{ padding: '12px', backgroundColor: '#eef7ff', borderRadius: '8px', border: '1px solid #b3d8ff', textAlign: 'center' }}>\n                    <div style={{ fontSize: '20px', fontWeight: 'bold', color: '#1565c0' }}>{itemsCount}</div>\n                    <div style={{ fontSize: '11px', color: '#555' }}>{t('EDITOR_ELEMENTS_STATS_ITEMS')}</div>\n                </div>\n                <div style={{ padding: '12px', backgroundColor: '#f3e8ff', borderRadius: '8px', border: '1px solid #d1c4e9', textAlign: 'center' }}>\n                    <div style={{ fontSize: '20px', fontWeight: 'bold', color: '#5e35b1' }}>{entitiesCount}</div>\n                    <div style={{ fontSize: '11px', color: '#555' }}>{t('EDITOR_ELEMENTS_STATS_ENTITIES')}</div>\n                </div>\n            </div>\n            <div style={{ padding: '12px', backgroundColor: '#f9f9f9', borderRadius: '8px', border: '1px solid #ddd', textAlign: 'center' }}>\n                    <div style={{ fontSize: '20px', fontWeight: 'bold', color: '#666' }}>{emptyBlocks}</div>\n                    <div style={{ fontSize: '11px', color: '#555' }}>{t('EDITOR_ELEMENTS_STATS_EMPTY_SPACE')}</div>\n            </div>\n            {mapsTotal > 0 && (\n                <div style={{ padding: '12px', backgroundColor: '#fff', borderRadius: '8px', border: '1px solid #ddd' }}>\n                    <div style={{ fontSize: '12px', fontWeight: 'bold', color: '#444', marginBottom: '6px' }}>\n                        {t('EDITOR_ELEMENTS_STATS_MAPS_TOTAL', { count: mapsTotal })}\n                    </div>\n                    <div style={{ display: 'flex', justifyContent: 'space-between', fontSize: '11px', color: '#666' }}>\n                        <span>{t('EDITOR_ELEMENTS_STATS_MAPS_OVERWORLD', { count: mapsOverworld })}</span>\n                        <span>{t('EDITOR_ELEMENTS_STATS_MAPS_UNDERWORLD', { count: mapsUnderworld })}</span>\n                        <span>{t('EDITOR_ELEMENTS_STATS_MAPS_ROOMS', { count: mapsRooms })}</span>\n                    </div>\n                </div>\n            )}\n        </div>\n    );\n};\n","import React from 'react';\nimport { useTranslation, Trans } from 'react-i18next';\nimport { getTutorialText } from '../../../../i18n/tutorialMessages';\n\nexport const ObjectPropsPanel = ({ \n    objectMapData, \n    secretMapData,\n    registryItems, \n    mapWidth, \n    objectMetadata, \n    highlightedIndex, \n    setHighlightedIndex, \n    setObjectMetadata,\n    maps,\n    activeMapId,\n    createMap\n}) => {\n    const { t } = useTranslation('editor_elements');\n    const mapType = maps[activeMapId]?.type || 'overworld';\n    const mapList = Object.values(maps || {});\n    const listRef = React.useRef(null);\n\n    // Auto-scroll to highlighted item\n    React.useEffect(() => {\n        if (highlightedIndex !== null && listRef.current) {\n            const highlightedElement = listRef.current.querySelector(`[data-index=\"${highlightedIndex}\"]`);\n            if (highlightedElement) {\n                highlightedElement.scrollIntoView({ behavior: 'smooth', block: 'center' });\n            }\n        }\n    }, [highlightedIndex]);\n\n    return (\n        <div style={{ padding: '0' }}>\n            <p style={{ fontSize: '12px', color: '#666', lineHeight: '1.4' }}>\n                {t('EDITOR_ELEMENTS_PROPS_INTRO_LINE1')}\n                <br />\n                <strong>1.</strong>{' '}\n                <Trans\n                    i18nKey=\"EDITOR_ELEMENTS_PROPS_INTRO_LINE2\"\n                    t={t}\n                    components={[<strong key=\"portal\" />, <strong key=\"target\" />, <strong key=\"weather\" />, <strong key=\"message\" />]}\n                />\n                <br />\n                <strong>2.</strong>{' '}\n                <Trans\n                    i18nKey=\"EDITOR_ELEMENTS_PROPS_INTRO_LINE3\"\n                    t={t}\n                    components={[<strong key=\"trigger\" />, <strong key=\"intensity\" />, <strong key=\"messageText\" />]}\n                />\n            </p>\n            <div ref={listRef} style={{ maxHeight: 'calc(100vh - 200px)', overflowY: 'auto' }}>\n                {Array.from({ length: objectMapData.length }).map((_, index) => {\n                    const objId = objectMapData[index];\n                    const secretId = secretMapData ? secretMapData[index] : null;\n                    \n                    if (!objId && !secretId) return null;\n\n                    const objDef = objId ? registryItems.find(r => r.id === objId) : null;\n                    const secretDef = secretId ? registryItems.find(r => r.id === secretId) : null;\n                    \n                    const isWeather = objDef && objDef.type === 'weather_trigger';\n                    const isMessage = objDef && objDef.type === 'message_trigger';\n                    const isPortalOrTarget = objId && (objId.includes('portal') || objId.includes('target') || objId === 'portal_target');\n                    const isDoor = objDef && objDef.subtype === 'door';\n                    const isRoomArea = secretDef && secretDef.subtype === 'room' && mapType !== 'room';\n\n                    if (!isPortalOrTarget && !isWeather && !isMessage && !isRoomArea && !isDoor) return null;\n\n                    const def = objDef || secretDef;\n                    const id = objId || secretId;\n\n                    const x = index % mapWidth;\n                    const y = Math.floor(index / mapWidth);\n                    const metadata = objectMetadata[index] || {};\n                    const i18nPreview = metadata.i18nChapter && metadata.i18nId\n                        ? getTutorialText(metadata.i18nChapter, metadata.i18nId)\n                        : '';\n                    const isHighlighted = highlightedIndex === index;\n\n                    return (\n                        <div key={index} \n                            data-index={index}\n                            onMouseEnter={() => setHighlightedIndex(index)}\n                            onMouseLeave={() => setHighlightedIndex(null)}\n                            style={{\n                                padding: '10px',\n                                border: isHighlighted ? '1px solid gold' : '1px solid #eee',\n                                display: 'flex',\n                                flexDirection: 'column',\n                                gap: '5px',\n                                backgroundColor: isHighlighted ? '#fffde7' : '#f9f9f9',\n                                marginBottom: '5px',\n                                borderRadius: '4px',\n                                transition: 'all 0.2s ease'\n                            }}\n                        >\n                            <div style={{ fontWeight: 'bold', fontSize: '13px', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\n                                <span style={{ display: 'flex', alignItems: 'center', gap: '5px' }}>\n                                    {isRoomArea ? '' : ((isWeather || isMessage) ? def.editorIcon : (id.includes('portal') && !id.includes('target') ? '' : ''))} {def.displayName || def.name}\n                                </span>\n                                <div style={{ display: 'flex', gap: '5px', alignItems: 'center' }}>\n                                    <span style={{ color: '#666', fontSize: '11px' }}>({x}, {y})</span>\n                                    <button \n                                        onClick={() => {\n                                            const el = document.querySelector(`.viewport`);\n                                            if (el) {\n                                                const scrollX = x * 32 - el.clientWidth / 2 + 16;\n                                                const scrollY = y * 32 - el.clientHeight / 2 + 16;\n                                                el.scrollTo({ left: scrollX, top: scrollY, behavior: 'smooth' });\n                                            }\n                                        }}\n                                        style={{ \n                                            padding: '2px 6px', fontSize: '10px', cursor: 'pointer',\n                                            backgroundColor: '#eee', border: '1px solid #ccc', borderRadius: '3px'\n                                        }}\n                                        title={t('EDITOR_ELEMENTS_PROPS_LOCATE_TITLE')}\n                                    >\n                                        {t('EDITOR_ELEMENTS_PROPS_LOCATE_LABEL')}\n                                    </button>\n                                </div>\n                            </div>\n\n                            {isRoomArea && (\n                                <div style={{ display: 'flex', flexDirection: 'column', gap: '8px' }}>\n                                    <div style={{ display: 'flex', alignItems: 'center', gap: '10px' }}>\n                                        <label style={{ fontSize: '12px', fontWeight: 'bold' }}>{t('EDITOR_ELEMENTS_PROPS_ROOM_NAME')}</label>\n                                        <input\n                                            type=\"text\"\n                                            value={metadata.roomName || ''}\n                                            placeholder={t('EDITOR_ELEMENTS_PROPS_ROOM_NAME_PLACEHOLDER')}\n                                            onChange={(e) => {\n                                                setObjectMetadata(prev => ({\n                                                    ...prev,\n                                                    [index]: { ...prev[index], roomName: e.target.value }\n                                                }));\n                                            }}\n                                            style={{\n                                                flex: 1,\n                                                padding: '4px 8px',\n                                                border: '1px solid #ccc',\n                                                borderRadius: '4px',\n                                                fontSize: '13px',\n                                            }}\n                                        />\n                                    </div>\n                                    <div style={{ display: 'flex', alignItems: 'center', gap: '10px' }}>\n                                        <label style={{ fontSize: '12px', fontWeight: 'bold' }}>{t('EDITOR_ELEMENTS_PROPS_SIZE')}</label>\n                                        <div style={{ display: 'flex', gap: '5px', alignItems: 'center' }}>\n                                            <input\n                                                type=\"number\"\n                                                value={metadata.width || 1}\n                                                min=\"1\"\n                                                onChange={(e) => {\n                                                    const val = parseInt(e.target.value);\n                                                    setObjectMetadata(prev => ({\n                                                        ...prev,\n                                                        [index]: { ...prev[index], width: isNaN(val) ? 1 : val }\n                                                    }));\n                                                }}\n                                                style={{ width: '50px', padding: '2px 5px' }}\n                                            />\n                                            <span>x</span>\n                                            <input\n                                                type=\"number\"\n                                                value={metadata.height || 1}\n                                                min=\"1\"\n                                                onChange={(e) => {\n                                                    const val = parseInt(e.target.value);\n                                                    setObjectMetadata(prev => ({\n                                                        ...prev,\n                                                        [index]: { ...prev[index], height: isNaN(val) ? 1 : val }\n                                                    }));\n                                                }}\n                                                style={{ width: '50px', padding: '2px 5px' }}\n                                            />\n                                        </div>\n                                    </div>\n                                    {metadata.linkedMapId ? (\n                                        <div style={{ fontSize: '11px', color: 'green' }}>\n                                            {t('EDITOR_ELEMENTS_PROPS_LINKED_MAP', { id: metadata.linkedMapId })}\n                                        </div>\n                                    ) : (\n                                        <button\n                                            onClick={() => {\n                                                if (createMap) {\n                                                    const mapId = createMap('room', metadata.roomName || 'Room Area', metadata.width || 1, metadata.height || 1);\n                                                    setObjectMetadata(prev => ({\n                                                        ...prev,\n                                                        [index]: { ...prev[index], linkedMapId: mapId }\n                                                    }));\n                                                }\n                                            }}\n                                            style={{\n                                                padding: '6px',\n                                                backgroundColor: '#4CAF50',\n                                                color: 'white',\n                                                border: 'none',\n                                                borderRadius: '4px',\n                                                cursor: 'pointer',\n                                                fontWeight: 'bold'\n                                            }}\n                                        >\n                                            {t('EDITOR_ELEMENTS_PROPS_CONFIRM')}\n                                        </button>\n                                    )}\n                                </div>\n                            )}\n\n                            {(!isWeather && !isMessage && !isRoomArea) && (\n                                <div style={{ display: 'flex', alignItems: 'center', gap: '10px' }}>\n                                    <label style={{ fontSize: '12px', fontWeight: 'bold' }}>{t('EDITOR_ELEMENTS_PROPS_TRIGGER_ID')}</label>\n                                    <input\n                                        type=\"number\"\n                                        value={metadata.triggerId || ''}\n                                        onChange={(e) => {\n                                            const val = parseInt(e.target.value);\n                                            setObjectMetadata(prev => ({\n                                                ...prev,\n                                                [index]: { ...prev[index], triggerId: isNaN(val) ? null : val }\n                                            }));\n                                        }}\n                                        style={{\n                                            flex: 1,\n                                            padding: '4px 8px',\n                                            border: '1px solid #ccc',\n                                            borderRadius: '4px',\n                                            fontSize: '13px',\n                                            backgroundColor: isHighlighted ? '#fff' : '#f0f0f0'\n                                        }}\n                                        placeholder={t('EDITOR_ELEMENTS_PROPS_TRIGGER_ID_PLACEHOLDER')}\n                                    />\n                                </div>\n                            )}\n\n                            {isWeather && def.hasIntensity && (\n                                <div style={{ display: 'flex', alignItems: 'center', gap: '10px' }}>\n                                    <label style={{ fontSize: '12px', fontWeight: 'bold' }}>{t('EDITOR_ELEMENTS_PROPS_INTENSITY')}</label>\n                                    <input\n                                        type=\"number\"\n                                        min=\"0\"\n                                        max=\"100\"\n                                        value={metadata.intensity !== undefined ? metadata.intensity : 50}\n                                        onChange={(e) => {\n                                            const val = parseInt(e.target.value);\n                                            setObjectMetadata(prev => ({\n                                                ...prev,\n                                                [index]: { ...prev[index], intensity: isNaN(val) ? 0 : Math.min(100, Math.max(0, val)) }\n                                            }));\n                                        }}\n                                        style={{\n                                            flex: 1,\n                                            padding: '4px 8px',\n                                            border: '1px solid #ccc',\n                                            borderRadius: '4px',\n                                            fontSize: '13px',\n                                            backgroundColor: isHighlighted ? '#fff' : '#f0f0f0'\n                                        }}\n                                    />\n                                </div>\n                            )}\n\n                            {isMessage && (\n                                <div style={{ display: 'flex', flexDirection: 'column', gap: '5px' }}>\n                                    {(metadata.i18nChapter || metadata.i18nId) && (\n                                        <div style={{ fontSize: '11px', color: '#666' }}>\n                                            {t('EDITOR_ELEMENTS_PROPS_I18N_LABEL', {\n                                                chapter: metadata.i18nChapter || t('EDITOR_ELEMENTS_PROPS_I18N_EMPTY'),\n                                                id: metadata.i18nId || t('EDITOR_ELEMENTS_PROPS_I18N_EMPTY')\n                                            })}\n                                            {i18nPreview && (\n                                                <div style={{ marginTop: '4px', color: '#333' }}>\n                                                    {i18nPreview}\n                                                </div>\n                                            )}\n                                        </div>\n                                    )}\n                                    <label style={{ fontSize: '12px', fontWeight: 'bold' }}>{t('EDITOR_ELEMENTS_PROPS_MESSAGE_TEXT')}</label>\n                                    <textarea\n                                        value={metadata.message || ''}\n                                        onChange={(e) => {\n                                            const val = e.target.value;\n                                            setObjectMetadata(prev => ({\n                                                ...prev,\n                                                [index]: { ...prev[index], message: val }\n                                            }));\n                                        }}\n                                        rows={3}\n                                        style={{\n                                            width: '100%',\n                                            padding: '6px 8px',\n                                            border: '1px solid #ccc',\n                                            borderRadius: '4px',\n                                            fontSize: '13px',\n                                            backgroundColor: isHighlighted ? '#fff' : '#f0f0f0',\n                                            resize: 'vertical',\n                                            fontFamily: 'inherit'\n                                        }}\n                                        placeholder={i18nPreview || t('EDITOR_ELEMENTS_PROPS_MESSAGE_PLACEHOLDER')}\n                                    />\n                                </div>\n                            )}\n\n                            {( (id.includes('portal') && !id.includes('target')) || isDoor ) && (\n                                <div style={{ display: 'flex', flexDirection: 'column', gap: '5px', marginTop: '5px' }}>\n                                    <div style={{ display: 'flex', alignItems: 'center', gap: '10px' }}>\n                                        <label style={{ fontSize: '12px', fontWeight: 'bold' }}>{t('EDITOR_ELEMENTS_PROPS_TARGET_MAP')}</label>\n                                        <select\n                                            value={metadata.targetMapId || ''}\n                                            onChange={(e) => {\n                                                const val = e.target.value;\n                                                setObjectMetadata(prev => ({\n                                                    ...prev,\n                                                    [index]: { ...prev[index], targetMapId: val === '' ? null : val }\n                                                }));\n                                            }}\n                                            style={{\n                                                flex: 1,\n                                                padding: '4px 8px',\n                                                border: '1px solid #ccc',\n                                                borderRadius: '4px',\n                                                fontSize: '13px',\n                                                backgroundColor: isHighlighted ? '#fff' : '#f0f0f0'\n                                            }}\n                                        >\n                                            <option value=\"\">{t('EDITOR_ELEMENTS_PROPS_CURRENT_MAP_OPTION')}</option>\n                                            {mapList.map(m => (\n                                                <option key={m.id} value={m.id}>{m.name}</option>\n                                            ))}\n                                        </select>\n                                    </div>\n                                    <div style={{ display: 'flex', alignItems: 'center', gap: '10px' }}>\n                                        <label style={{ fontSize: '12px', fontWeight: 'bold' }}>{t('EDITOR_ELEMENTS_PROPS_SPAWN_ID')}</label>\n                                        <input\n                                            type=\"number\"\n                                            value={metadata.spawnTriggerId !== undefined ? metadata.spawnTriggerId : ''}\n                                            onChange={(e) => {\n                                                const val = parseInt(e.target.value);\n                                                setObjectMetadata(prev => ({\n                                                    ...prev,\n                                                    [index]: { ...prev[index], spawnTriggerId: isNaN(val) ? null : val }\n                                                }));\n                                            }}\n                                            placeholder={t('EDITOR_ELEMENTS_PROPS_SPAWN_ID_PLACEHOLDER')}\n                                            style={{\n                                                flex: 1,\n                                                padding: '4px 8px',\n                                                border: '1px solid #ccc',\n                                                borderRadius: '4px',\n                                                fontSize: '13px',\n                                                backgroundColor: isHighlighted ? '#fff' : '#f0f0f0'\n                                            }}\n                                        />\n                                    </div>\n                                    {isDoor && (\n                                        <div style={{ display: 'flex', alignItems: 'center', gap: '10px' }}>\n                                            <label style={{ fontSize: '12px', fontWeight: 'bold' }}>{t('EDITOR_ELEMENTS_PROPS_DELAY')}</label>\n                                            <input\n                                                type=\"number\"\n                                                step=\"0.1\"\n                                                value={metadata.delaySeconds !== undefined ? metadata.delaySeconds : (objDef.interaction?.delaySeconds || 0.5)}\n                                                onChange={(e) => {\n                                                    const val = parseFloat(e.target.value);\n                                                    setObjectMetadata(prev => ({\n                                                        ...prev,\n                                                        [index]: { ...prev[index], delaySeconds: isNaN(val) ? 0.5 : val }\n                                                    }));\n                                                }}\n                                                style={{\n                                                    flex: 1,\n                                                    padding: '4px 8px',\n                                                    border: '1px solid #ccc',\n                                                    borderRadius: '4px',\n                                                    fontSize: '13px',\n                                                    backgroundColor: isHighlighted ? '#fff' : '#f0f0f0'\n                                                }}\n                                            />\n                                        </div>\n                                    )}\n                                </div>\n                            )}\n\n                            {/* Size Configuration */}\n                            <div style={{ display: 'flex', alignItems: 'center', gap: '10px', marginTop: '5px', paddingTop: '5px', borderTop: '1px solid #eee' }}>\n                                <div style={{ display: 'flex', alignItems: 'center', gap: '5px' }}>\n                                    <label style={{ fontSize: '11px', color: '#666' }}>{t('EDITOR_ELEMENTS_PROPS_SIZE_W')}</label>\n                                    <input\n                                        type=\"number\"\n                                        min=\"1\"\n                                        max=\"50\"\n                                        value={metadata.width || 1}\n                                        onChange={(e) => {\n                                            const val = parseInt(e.target.value);\n                                            setObjectMetadata(prev => ({\n                                                ...prev,\n                                                [index]: { ...prev[index], width: isNaN(val) ? 1 : Math.max(1, val) }\n                                            }));\n                                        }}\n                                        style={{ width: '40px', padding: '2px 4px', fontSize: '12px', border: '1px solid #ccc', borderRadius: '3px' }}\n                                    />\n                                </div>\n                                <div style={{ display: 'flex', alignItems: 'center', gap: '5px' }}>\n                                    <label style={{ fontSize: '11px', color: '#666' }}>{t('EDITOR_ELEMENTS_PROPS_SIZE_H')}</label>\n                                    <input\n                                        type=\"number\"\n                                        min=\"1\"\n                                        max=\"50\"\n                                        value={metadata.height || 1}\n                                        onChange={(e) => {\n                                            const val = parseInt(e.target.value);\n                                            setObjectMetadata(prev => ({\n                                                ...prev,\n                                                [index]: { ...prev[index], height: isNaN(val) ? 1 : Math.max(1, val) }\n                                            }));\n                                        }}\n                                        style={{ width: '40px', padding: '2px 4px', fontSize: '12px', border: '1px solid #ccc', borderRadius: '3px' }}\n                                    />\n                                </div>\n                                <span style={{ fontSize: '10px', color: '#999' }}>{t('EDITOR_ELEMENTS_PROPS_RESIZE_HINT')}</span>\n                            </div>\n                        </div>\n                    );\n                })}\n                {objectMapData.filter(id => {\n                    if (!id) return false;\n                    const def = registryItems.find(r => r.id === id);\n                    const isWeather = def && def.type === 'weather_trigger';\n                    const isMessage = def && def.type === 'message_trigger';\n                    const isPortalOrTarget = id.includes('portal') || id.includes('target') || id === 'portal_target';\n                    return isPortalOrTarget || isWeather || isMessage;\n                }).length === 0 && (\n                    <p style={{ textAlign: 'center', color: '#999', marginTop: '20px', fontSize: '14px' }}>\n                        {t('EDITOR_ELEMENTS_PROPS_NO_CONFIGURABLE')}\n                    </p>\n                )}\n            </div>\n        </div>\n    );\n};\n","import React from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { \n    SidebarContainer,\n    ElementEditorButton,\n    PanelContainer,\n    PanelHeader,\n    PanelBody,\n    CloseButton\n} from './styles/EditorElementsButtonStyle';\n\n// Panels\nimport { OperationsPanel } from './editorElements/OperationsPanel';\nimport { PalettePanel } from './editorElements/PalettePanel';\nimport { StatisticsPanel } from './editorElements/StatisticsPanel';\nimport { ObjectPropsPanel } from './editorElements/ObjectPropsPanel';\n\nexport const EditorElements = ({\n    mapName,\n    creatorName,\n    mapDescription,\n    setMapName,\n    setCreatorName,\n    setMapDescription,\n    openNewMapModal,\n    openBuiltInModal,\n    saveMap,\n    loadMap,\n    clearMap,\n    isPlayMode,\n    handlePaletteSelect,\n    selectedTile,\n    blocks,\n    liquids,\n    entities,\n    items,\n    decorations,\n    interactables,\n    hazards,\n    secrets,\n    weather,\n    messages,\n    crackableWalls,\n    pushableWalls,\n    obstacles,\n    totalTiles,\n    filledBlocks,\n    emptyBlocks,\n    objectsCount,\n    mapWidth,\n    mapHeight,\n    objectMapData,\n    secretMapData,\n    objectMetadata,\n    setObjectMetadata,\n    registryItems,\n    highlightedIndex,\n    setHighlightedIndex,\n    activePanel,\n    setActivePanel,\n    togglePanel,\n    maps,\n    activeMapId,\n    createMap\n}) => {\n    const { t } = useTranslation('editor_elements');\n    const [lastPanel, setLastPanel] = React.useState(null);\n    const [pinnedPanel, setPinnedPanel] = React.useState(null);\n    const hoverTimerRef = React.useRef(null);\n\n    React.useEffect(() => {\n        if (activePanel) {\n            setLastPanel(activePanel);\n        }\n    }, [activePanel]);\n\n    const displayPanel = activePanel || lastPanel;\n\n    const clearHoverTimer = () => {\n        if (hoverTimerRef.current) {\n            clearTimeout(hoverTimerRef.current);\n            hoverTimerRef.current = null;\n        }\n    };\n\n    const handleIconClick = (panel) => {\n        clearHoverTimer();\n        if (pinnedPanel === panel) {\n            setPinnedPanel(null);\n            setActivePanel(null);\n            return;\n        }\n        setPinnedPanel(panel);\n        setActivePanel(panel);\n    };\n\n    const handleIconMouseEnter = (panel) => {\n        if (pinnedPanel) return;\n        clearHoverTimer();\n        setActivePanel(panel);\n    };\n\n    const handleIconMouseLeave = () => {\n        if (pinnedPanel) return;\n        clearHoverTimer();\n        hoverTimerRef.current = setTimeout(() => {\n            setActivePanel(null);\n        }, 120);\n    };\n\n    const handlePanelMouseEnter = () => {\n        if (pinnedPanel) return;\n        clearHoverTimer();\n    };\n\n    const handlePanelMouseLeave = () => {\n        if (pinnedPanel) return;\n        clearHoverTimer();\n        setActivePanel(null);\n    };\n\n    const panelTitles = {\n        map: t('EDITOR_ELEMENTS_PANEL_OPERATIONS'),\n        blocks: t('EDITOR_ELEMENTS_PANEL_BLOCKS'),\n        liquids: t('EDITOR_ELEMENTS_PANEL_LIQUIDS'),\n        decorations: t('EDITOR_ELEMENTS_PANEL_DECORATIONS'),\n        entities: t('EDITOR_ELEMENTS_PANEL_ENTITIES'),\n        items: t('EDITOR_ELEMENTS_PANEL_ITEMS'),\n        interactables: t('EDITOR_ELEMENTS_PANEL_INTERACTABLES'),\n        hazards: t('EDITOR_ELEMENTS_PANEL_HAZARDS'),\n        secrets: t('EDITOR_ELEMENTS_PANEL_SECTORS'),\n        weather: t('EDITOR_ELEMENTS_PANEL_WEATHER'),\n        messages: t('EDITOR_ELEMENTS_PANEL_MESSAGES'),\n        obstacles: t('EDITOR_ELEMENTS_PANEL_OBSTACLES'),\n        stats: t('EDITOR_ELEMENTS_PANEL_STATISTICS'),\n        props: t('EDITOR_ELEMENTS_PANEL_PROPERTIES')\n    };\n\n    return (\n        <div style={{ display: 'flex', height: '100%', position: 'relative', zIndex: 1001 }}>\n            {/* Sidebar Left Icons */}\n            <SidebarContainer>\n                <ElementEditorButton onClick={() => handleIconClick('map')} onMouseEnter={() => handleIconMouseEnter('map')} onMouseLeave={handleIconMouseLeave} $active={activePanel === 'map'} title={t('EDITOR_ELEMENTS_ICON_MAP_CONTROLS')}></ElementEditorButton>\n                <ElementEditorButton onClick={() => handleIconClick('blocks')} onMouseEnter={() => handleIconMouseEnter('blocks')} onMouseLeave={handleIconMouseLeave} $active={activePanel === 'blocks'} title={t('EDITOR_ELEMENTS_ICON_BLOCKS')}></ElementEditorButton>\n                <ElementEditorButton onClick={() => handleIconClick('liquids')} onMouseEnter={() => handleIconMouseEnter('liquids')} onMouseLeave={handleIconMouseLeave} $active={activePanel === 'liquids'} title={t('EDITOR_ELEMENTS_ICON_LIQUIDS')}></ElementEditorButton>\n                <ElementEditorButton onClick={() => handleIconClick('decorations')} onMouseEnter={() => handleIconMouseEnter('decorations')} onMouseLeave={handleIconMouseLeave} $active={activePanel === 'decorations'} title={t('EDITOR_ELEMENTS_ICON_DECORATIONS')}></ElementEditorButton>\n                <ElementEditorButton onClick={() => handleIconClick('obstacles')} onMouseEnter={() => handleIconMouseEnter('obstacles')} onMouseLeave={handleIconMouseLeave} $active={activePanel === 'obstacles'} title={t('EDITOR_ELEMENTS_ICON_OBSTACLES')}></ElementEditorButton>\n                <ElementEditorButton onClick={() => handleIconClick('items')} onMouseEnter={() => handleIconMouseEnter('items')} onMouseLeave={handleIconMouseLeave} $active={activePanel === 'items'} title={t('EDITOR_ELEMENTS_ICON_ITEMS')}></ElementEditorButton>\n                <ElementEditorButton onClick={() => handleIconClick('entities')} onMouseEnter={() => handleIconMouseEnter('entities')} onMouseLeave={handleIconMouseLeave} $active={activePanel === 'entities'} title={t('EDITOR_ELEMENTS_ICON_ENTITIES')}></ElementEditorButton>\n                <ElementEditorButton onClick={() => handleIconClick('interactables')} onMouseEnter={() => handleIconMouseEnter('interactables')} onMouseLeave={handleIconMouseLeave} $active={activePanel === 'interactables'} title={t('EDITOR_ELEMENTS_ICON_INTERACTABLES')}></ElementEditorButton>\n                <ElementEditorButton onClick={() => handleIconClick('hazards')} onMouseEnter={() => handleIconMouseEnter('hazards')} onMouseLeave={handleIconMouseLeave} $active={activePanel === 'hazards'} title={t('EDITOR_ELEMENTS_ICON_HAZARDS')}></ElementEditorButton>\n                <ElementEditorButton onClick={() => handleIconClick('secrets')} onMouseEnter={() => handleIconMouseEnter('secrets')} onMouseLeave={handleIconMouseLeave} $active={activePanel === 'secrets'} title={t('EDITOR_ELEMENTS_ICON_SECTORS')}>2</ElementEditorButton>\n                <ElementEditorButton onClick={() => handleIconClick('weather')} onMouseEnter={() => handleIconMouseEnter('weather')} onMouseLeave={handleIconMouseLeave} $active={activePanel === 'weather'} title={t('EDITOR_ELEMENTS_ICON_WEATHER')}></ElementEditorButton>\n                <ElementEditorButton onClick={() => handleIconClick('messages')} onMouseEnter={() => handleIconMouseEnter('messages')} onMouseLeave={handleIconMouseLeave} $active={activePanel === 'messages'} title={t('EDITOR_ELEMENTS_ICON_MESSAGES')}></ElementEditorButton>\n                <ElementEditorButton onClick={() => handleIconClick('stats')} onMouseEnter={() => handleIconMouseEnter('stats')} onMouseLeave={handleIconMouseLeave} $active={activePanel === 'stats'} title={t('EDITOR_ELEMENTS_ICON_STATISTICS')}></ElementEditorButton>\n                <ElementEditorButton onClick={() => handleIconClick('props')} onMouseEnter={() => handleIconMouseEnter('props')} onMouseLeave={handleIconMouseLeave} $active={activePanel === 'props'} title={t('EDITOR_ELEMENTS_ICON_PROPERTIES')}></ElementEditorButton>\n            </SidebarContainer>\n\n            {/* Sidebar Fixed Panel Content */}\n            <PanelContainer $isOpen={!!activePanel} onMouseEnter={handlePanelMouseEnter} onMouseLeave={handlePanelMouseLeave}>\n                {displayPanel && (\n                    <>\n                        {/* Panel Header */}\n                        <PanelHeader>\n                            <span>{panelTitles[displayPanel]}</span>\n                            <CloseButton onClick={() => { setPinnedPanel(null); setActivePanel(null); }}></CloseButton>\n                        </PanelHeader>\n\n                        {/* Panel Body */}\n                        <PanelBody>\n                            {displayPanel === 'map' && (\n                                <OperationsPanel \n                                    openNewMapModal={openNewMapModal}\n                                    openBuiltInModal={openBuiltInModal}\n                                    saveMap={saveMap}\n                                    loadMap={loadMap}\n                                    clearMap={clearMap}\n                                    mapName={mapName}\n                                    creatorName={creatorName}\n                                    mapDescription={mapDescription}\n                                    setMapName={setMapName}\n                                    setCreatorName={setCreatorName}\n                                    setMapDescription={setMapDescription}\n                                />\n                            )}\n\n                            {(displayPanel === 'blocks' || \n                              displayPanel === 'liquids' || \n                              displayPanel === 'decorations' || \n                              displayPanel === 'entities' || \n                              displayPanel === 'items' || \n                              displayPanel === 'interactables' || \n                              displayPanel === 'hazards' || \n                              displayPanel === 'secrets' ||\n                              displayPanel === 'weather' ||\n                              displayPanel === 'messages' ||\n                              displayPanel === 'obstacles') && (\n                                <PalettePanel \n                                    isPlayMode={isPlayMode}\n                                    category={displayPanel}\n                                    blocks={blocks}\n                                    liquids={liquids}\n                                    entities={entities}\n                                    decorations={decorations}\n                                    items={items}\n                                    interactables={interactables}\n                                    hazards={hazards}\n                                    secrets={secrets}\n                                    weather={weather}\n                                    messages={messages}\n                                    crackableWalls={crackableWalls}\n                                    pushableWalls={pushableWalls}\n                                    obstacles={obstacles}\n                                    handlePaletteSelect={handlePaletteSelect}\n                                    selectedTile={selectedTile}\n                                    objectMetadata={objectMetadata}\n                                    setObjectMetadata={setObjectMetadata}\n                                    objectMapData={objectMapData}\n                                    highlightedIndex={highlightedIndex}\n                                    setHighlightedIndex={setHighlightedIndex}\n                                    registryItems={registryItems}\n                                />\n                            )}\n\n\n                            {displayPanel === 'stats' && (\n                                <StatisticsPanel \n                                    totalTiles={totalTiles}\n                                    mapWidth={mapWidth}\n                                    mapHeight={mapHeight}\n                                    filledBlocks={filledBlocks}\n                                    objectsCount={objectsCount}\n                                    emptyBlocks={emptyBlocks}\n                                    objectMapData={objectMapData}\n                                    registryItems={registryItems}\n                                    maps={maps}\n                                />\n                            )}\n\n                            {displayPanel === 'props' && (\n                                <ObjectPropsPanel \n                                    objectMapData={objectMapData}\n                                    secretMapData={secretMapData}\n                                    registryItems={registryItems}\n                                    mapWidth={mapWidth}\n                                    objectMetadata={objectMetadata}\n                                    highlightedIndex={highlightedIndex}\n                                    setHighlightedIndex={setHighlightedIndex}\n                                    setObjectMetadata={setObjectMetadata}\n                                    maps={maps}\n                                    activeMapId={activeMapId}\n                                    createMap={createMap}\n                                />\n                            )}\n                        </PanelBody>\n                    </>\n                )}\n            </PanelContainer>\n        </div>\n    );\n};\n","import React from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { \n    EditorToolsContainer,\n    HeaderBar,\n    ToolsSection,\n    ToolsGroup,\n    ToolsInnerGroup,\n    ToolsRow,\n    ToolsEditorButton,\n    StrikeThrough,\n    LayerIndicator,\n    BgColorContainer,\n    BgColorInputWrapper,\n    BgColorInput,\n    BgTransparentButton,\n    PlayButtonContainer,\n    PlayButtonInner,\n    InfoContainer,\n    InfoItem,\n    InfoLabel,\n    InfoValue,\n    EraserButtonContainer,\n    EraserButtonInner,\n    SelectionActions,\n    ConfirmButton,\n    CancelButton,\n    GridIcon\n} from './styles/EditorToolsButton';\n\nexport const EditorTools = (props) => {\n    const { t } = useTranslation('editor_tools');\n    const {\n        mapName, \n        creatorName, \n        activePanel, \n        togglePanel,\n        showGrid, \n        setShowGrid,\n        isPlayMode,\n        handlePlay,\n        handlePause,\n        handleReset,\n        activeTool,\n        setActiveTool,\n        brushSize,\n        setBrushSize,\n        activeLayer,\n        selection,\n        moveSelection,\n        selectionMode,\n        setSelectionMode,\n        commitSelection,\n        cancelSelection,\n        selectedTile,\n        handlePaletteSelect,\n        selectedBackgroundColor,\n        setSelectedBackgroundColor,\n        showBackgroundImage,\n        setShowBackgroundImage,\n        showMessages,\n        setShowMessages,\n        isRoomAreaVisible,\n        setIsRoomAreaVisible,\n        showRoomMapContent,\n        setShowRoomMapContent\n    } = props;\n    const getEraserData = (layer) => {\n        const isActive = selectedTile === null && activeLayer === layer;\n        const colors = {\n            tile: { bg: '#e6f7ff', text: '#1890ff' },\n            object: { bg: '#fff1f0', text: '#f5222d' },\n            secret: { bg: '#f9f0ff', text: '#722ed1' },\n            props: { bg: '#fffbe6', text: '#faad14' }\n        };\n        const active = colors[layer] || colors.tile;\n        return {\n            isActive,\n            bgColor: active.bg,\n            textColor: active.text\n        };\n    };\n\n    const getLayerIndicatorData = () => {\n        const colors = {\n            tile: { bg: '#e6f7ff', border: '#91d5ff', text: '#1890ff' },\n            object: { bg: '#fff1f0', border: '#ffa39e', text: '#f5222d' },\n            secret: { bg: '#f9f0ff', border: '#d3adf7', text: '#722ed1' },\n            props: { bg: '#fffbe6', border: '#ffe58f', text: '#faad14' }\n        };\n        const active = colors[activeLayer] || colors.tile;\n        return {\n            $bgColor: active.bg,\n            $borderColor: active.border,\n            $textColor: active.text\n        };\n    };\n\n    return (\n        <EditorToolsContainer>\n            {/* Main Header Bar */}\n            <HeaderBar>\n                <ToolsSection>\n                    <ToolsGroup>\n\n                        {/* Brush - Bucket - Move - Area */}\n                        <ToolsRow>\n                            {[\n                                { id: 'brush', icon: '', title: t('EDITOR_TOOLS_BRUSH_TITLE') },\n                                { id: 'bucket', icon: '', title: t('EDITOR_TOOLS_BUCKET_TITLE') },\n                                { id: 'move', icon: '', title: t('EDITOR_TOOLS_MOVE_TITLE') },\n                            ].map(tool => (\n                                <ToolsEditorButton\n                                    key={tool.id}\n                                    onClick={() => !isPlayMode && setActiveTool(tool.id)}\n                                    $active={activeTool === tool.id && !isPlayMode}\n                                    $square\n                                    $disabled={isPlayMode}\n                                    title={isPlayMode ? t('EDITOR_TOOLS_DISABLED_PLAY_MODE') : tool.title}\n                                >\n                                    {tool.icon}\n                                    {isPlayMode && <StrikeThrough />}\n                                </ToolsEditorButton>\n                            ))}\n                        </ToolsRow>\n\n                        {/* Cut - Copy - Paste */}\n                        <ToolsInnerGroup>\n                            {['cut', 'copy'].map(mode => {\n                                const isDisabled = isPlayMode || activeTool !== 'move';\n                                return (\n                                    <ToolsEditorButton\n                                        key={mode}\n                                        onClick={() => !isDisabled && setSelectionMode(mode)}\n                                        $active={selectionMode === mode && !isDisabled}\n                                        $square\n                                        $disabled={isDisabled}\n                                        title={isPlayMode ? t('EDITOR_TOOLS_DISABLED_PLAY_MODE') : (isDisabled ? (mode === 'cut' ? t('EDITOR_TOOLS_CUT_ONLY_MOVE') : t('EDITOR_TOOLS_COPY_ONLY_MOVE')) : (mode === 'cut' ? t('EDITOR_TOOLS_CUT_SELECTION') : t('EDITOR_TOOLS_COPY_SELECTION')))}\n                                    >\n                                        {mode === 'cut' ? '' : ''}\n                                        {isDisabled && <StrikeThrough />}\n                                    </ToolsEditorButton>\n                                );\n                            })}\n                            <ToolsEditorButton\n                                onClick={() => !isPlayMode && activeTool === 'move' && commitSelection()}\n                                $square\n                                $disabled={isPlayMode || activeTool !== 'move'}\n                                title={isPlayMode ? t('EDITOR_TOOLS_DISABLED_PLAY_MODE') : (activeTool !== 'move' ? t('EDITOR_TOOLS_PASTE_ONLY_MOVE') : t('EDITOR_TOOLS_PASTE_SELECTION'))}\n                            >\n                                \n                                {(isPlayMode || activeTool !== 'move') && <StrikeThrough />}\n                            </ToolsEditorButton>\n                            {selection && !isPlayMode && (\n                                <SelectionActions>\n                                    <ConfirmButton onClick={commitSelection} $square title={t('EDITOR_TOOLS_CONFIRM_SELECTION')}></ConfirmButton>\n                                    <CancelButton onClick={cancelSelection} $square title={t('EDITOR_TOOLS_CANCEL_SELECTION')}></CancelButton>\n                                </SelectionActions>\n                            )}\n                        </ToolsInnerGroup>\n\n                        {/* Size */}\n                        <ToolsInnerGroup>\n                            {['I', 'II', 'III', 'IV', 'V'].map((roman, idx) => {\n                                const size = idx + 1;\n                                const isDisabled = isPlayMode || activeTool !== 'brush';\n                                return (\n                                    <ToolsEditorButton \n                                        key={size} \n                                    onClick={() => !isDisabled && setBrushSize(size)} \n                                    $active={brushSize === size && !isDisabled} \n                                    $square \n                                    $disabled={isDisabled}\n                                    title={isPlayMode ? t('EDITOR_TOOLS_DISABLED_PLAY_MODE') : (isDisabled ? t('EDITOR_TOOLS_BRUSH_SIZE_ONLY') : t('EDITOR_TOOLS_BRUSH_SIZE', { size }))}\n                                >\n                                    {roman}\n                                    {isDisabled && <StrikeThrough />}\n                                </ToolsEditorButton>\n                                );\n                            })}\n                        </ToolsInnerGroup>\n\n                        {/* Background Immage */}\n                        <ToolsRow>\n                            <ToolsEditorButton\n                                onClick={() => !isPlayMode && setShowBackgroundImage(!showBackgroundImage)}\n                                $active={showBackgroundImage && !isPlayMode}\n                                $square\n                                $disabled={isPlayMode}\n                                title={isPlayMode ? t('EDITOR_TOOLS_DISABLED_PLAY_MODE') : (showBackgroundImage ? t('EDITOR_TOOLS_BACKGROUND_IMAGE_HIDE') : t('EDITOR_TOOLS_BACKGROUND_IMAGE_SHOW'))}\n                            >\n                                \n                                {isPlayMode && <StrikeThrough />}\n                            </ToolsEditorButton>\n\n                            {/* Grid */}\n                            <ToolsEditorButton\n                                onClick={() => setShowGrid(!showGrid)}\n                                $active={showGrid}\n                                $square\n                                title={showGrid ? t('EDITOR_TOOLS_GRID_HIDE') : t('EDITOR_TOOLS_GRID_SHOW')}\n                            >\n                                <GridIcon>\n                                    {showGrid ? '' : ''}\n                                </GridIcon>\n                            </ToolsEditorButton>\n\n                            {/* Messages Visibility */}\n                            <ToolsEditorButton\n                                onClick={() => setShowMessages(!showMessages)}\n                                $active={showMessages}\n                                $square\n                                title={showMessages ? t('EDITOR_TOOLS_MESSAGES_HIDE') : t('EDITOR_TOOLS_MESSAGES_SHOW')}\n                            >\n                                \n                            </ToolsEditorButton>\n\n                            {/* Room Area Visibility */}\n                            <ToolsEditorButton\n                                onClick={() => setIsRoomAreaVisible(!isRoomAreaVisible)}\n                                $active={isRoomAreaVisible}\n                                $square\n                                title={isRoomAreaVisible ? t('EDITOR_TOOLS_ROOM_AREA_HIDE') : t('EDITOR_TOOLS_ROOM_AREA_SHOW')}\n                            >\n                                <span style={{ fontSize: '14px' }}></span>\n                            </ToolsEditorButton>\n\n                            {/* Room Map Content Visibility */}\n                            <ToolsEditorButton\n                                onClick={() => setShowRoomMapContent(!showRoomMapContent)}\n                                $active={showRoomMapContent}\n                                $square\n                                title={showRoomMapContent ? t('EDITOR_TOOLS_ROOM_CONTENT_HIDE') : t('EDITOR_TOOLS_ROOM_CONTENT_SHOW')}\n                            >\n                                <span style={{ fontSize: '14px' }}></span>\n                            </ToolsEditorButton>\n\n                            {/* Background Color Picker */}\n                            <BgColorContainer>\n                                <BgColorInputWrapper>\n                                    <BgColorInput\n                                        type=\"color\"\n                                        value={selectedBackgroundColor && selectedBackgroundColor !== 'transparent' ? selectedBackgroundColor : '#000000'}\n                                        onChange={(e) => !isPlayMode && setSelectedBackgroundColor(e.target.value)}\n                                        title={isPlayMode ? t('EDITOR_TOOLS_DISABLED_PLAY_MODE') : t('EDITOR_TOOLS_BG_COLOR')}\n                                        disabled={isPlayMode}\n                                    />\n                                    {isPlayMode && <StrikeThrough />}\n                                </BgColorInputWrapper>\n                                <BgTransparentButton \n                                    $active={selectedBackgroundColor === 'transparent'}\n                                    onClick={() => !isPlayMode && setSelectedBackgroundColor('transparent')}\n                                    title={isPlayMode ? t('EDITOR_TOOLS_DISABLED_PLAY_MODE') : t('EDITOR_TOOLS_BG_TRANSPARENT')}\n                                />\n                            </BgColorContainer>\n                        </ToolsRow>\n\n\n\n                        {/* Active Layer Indicator */}\n                        <ToolsInnerGroup>\n                            <LayerIndicator {...getLayerIndicatorData()}>\n                                {t('EDITOR_TOOLS_LAYER_LABEL', {\n                                    layer: activeLayer === 'tile'\n                                        ? t('EDITOR_TOOLS_LAYER_BLOCKS')\n                                        : (activeLayer === 'object'\n                                            ? t('EDITOR_TOOLS_LAYER_OBJECTS')\n                                            : (activeLayer === 'secret'\n                                                ? t('EDITOR_TOOLS_LAYER_SECTORS')\n                                                : t('EDITOR_TOOLS_LAYER_PROPERTIES')))\n                                })}\n                            </LayerIndicator>\n                        </ToolsInnerGroup>\n\n                        {/* Layers: Block - Object - Sector - Props */}\n                        <ToolsInnerGroup>\n                            {['tile', 'object', 'secret', 'props'].map(layer => {\n                                const { isActive, bgColor, textColor } = getEraserData(layer);\n                                const isDisabled = isPlayMode;\n                                return (\n                                    <EraserButtonContainer\n                                        key={layer}\n                                        onClick={() => !isDisabled && handlePaletteSelect(null, layer)}\n                                        $active={isActive && !isDisabled}\n                                        $disabled={isDisabled}\n                                        title={isDisabled ? t('EDITOR_TOOLS_DISABLED_PLAY_MODE') : t('EDITOR_TOOLS_ERASE_LABEL', {\n                                            layer: layer === 'tile'\n                                                ? t('EDITOR_TOOLS_LAYER_BLOCKS')\n                                                : (layer === 'object'\n                                                    ? t('EDITOR_TOOLS_LAYER_OBJECTS')\n                                                    : (layer === 'secret'\n                                                        ? t('EDITOR_TOOLS_LAYER_SECTORS')\n                                                        : t('EDITOR_TOOLS_LAYER_PROPERTIES')))\n                                        })}\n                                    >\n                                        <EraserButtonInner $bgColor={bgColor} $textColor={textColor} $active={isActive && !isDisabled}>\n                                            {layer === 'tile' ? 'B' : (layer === 'object' ? 'O' : (layer === 'secret' ? 'S' : 'P'))}\n                                        </EraserButtonInner>\n                                        {isDisabled && <StrikeThrough />}\n                                    </EraserButtonContainer>\n                                );\n                            })}\n                        </ToolsInnerGroup>\n\n                        <ToolsInnerGroup>\n                            <ToolsRow>\n                                <PlayButtonContainer onClick={isPlayMode ? handlePause : handlePlay} title={isPlayMode ? t('EDITOR_TOOLS_PAUSE_TITLE') : t('EDITOR_TOOLS_PLAY_TITLE')}>\n                                    <PlayButtonInner $variant={isPlayMode ? 'pause' : 'play'}>\n                                        <span>{isPlayMode ? '' : ''}</span>\n                                    </PlayButtonInner>\n                                </PlayButtonContainer>\n\n                                <PlayButtonContainer onClick={handleReset} title={t('EDITOR_TOOLS_RESET_TITLE')}>\n                                    <PlayButtonInner>\n                                        <span></span>\n                                    </PlayButtonInner>\n                                </PlayButtonContainer>\n                            </ToolsRow>\n                        </ToolsInnerGroup>\n                    </ToolsGroup>\n                </ToolsSection>\n\n\n                <ToolsSection>\n                    <InfoContainer>\n                        <InfoItem>\n                            <InfoLabel>{t('EDITOR_TOOLS_INFO_MAP')}</InfoLabel>\n                            <InfoValue>{mapName}</InfoValue>\n                        </InfoItem>\n                        <InfoItem>\n                            <InfoLabel>{t('EDITOR_TOOLS_INFO_BY')}</InfoLabel>\n                            <InfoValue>{creatorName}</InfoValue>\n                        </InfoItem>\n                    </InfoContainer>\n                </ToolsSection>\n            </HeaderBar>\n        </EditorToolsContainer>\n    );\n};\n","import { useState, useCallback, useMemo, useEffect, useRef } from 'react';\nimport { TILE_SIZE } from '../../../../constants/gameConstants';\nimport { useGameEngine } from '../../../../utilities/useGameEngine';\nimport { applyWolfSecretShift, shouldRemoveCrackBlock } from '../../../../engine/gameplay/secrets';\nimport { shouldTriggerBreakEffect, getBreakEffectParams } from '../../../../engine/gameplay/breakEffects';\n\nconst EMPTY_ARRAY = [];\n\nexport const useEditorPlayMode = (\n    mapWidth, mapHeight, tileMapData, objectMapData, secretMapData, objectMetadata, \n    selectedBackgroundImage, selectedBackgroundColor, backgroundParallaxFactor, \n    registryItems, playerPosition, setPlayerPosition, setObjectMetadata,\n    weatherRain, weatherSnow, weatherClouds, weatherFog, weatherThunder,\n    weatherLavaRain, weatherRadioactiveFog, weatherMeteorRain,\n    maps, activeMapId, switchMap, spawnTriggerId,\n    setTileMapData, updateMapData\n) => {\n    const [isPlayMode, setIsPlayMode] = useState(false);\n    const [isGameOver, setIsGameOver] = useState(false);\n    const [restartCounter, setRestartCounter] = useState(0);\n    const [editorSnapshot, setEditorSnapshot] = useState(null);\n    const [revealedSecrets, setRevealedSecrets] = useState([]);\n    const [activeRoomIds, setActiveRoomIds] = useState(new Set());\n    const [playModeObjectData, setPlayModeObjectData] = useState([]);\n    const [playModeSecretData, setPlayModeSecretData] = useState([]);\n    const [playModeWeather, setPlayModeWeather] = useState({\n        rain: 0, snow: 0, clouds: 0, fog: 0, thunder: 0,\n        lavaRain: 0, radioactiveFog: 0, meteorRain: 0\n    });\n    const [playModeMapsVersion, setPlayModeMapsVersion] = useState(0);\n    const [gameMessage, setGameMessage] = useState({ text: '', isVisible: false });\n    const messageTimerRef = useRef(null);\n    const lastSyncedMapIdRef = useRef(null);\n    const isPlayModeRef = useRef(isPlayMode);\n    const playModeMapsRef = useRef({});\n\n    useEffect(() => {\n        isPlayModeRef.current = isPlayMode;\n    }, [isPlayMode]);\n\n    // Stability for engine initialization - only changes when map changes or play mode is toggled\n    const engineInitId = useMemo(() => {\n        return isPlayMode ? `${activeMapId}_${restartCounter}_${Date.now()}` : null;\n    }, [isPlayMode, activeMapId, restartCounter]);\n\n    // Derived data to ensure useGameEngine gets fresh data even before useEffect syncs state.\n    // This prevents the engine from using old map data during initialization.\n    const currentPlayObjectData = useMemo(() => {\n        if (!isPlayMode) return EMPTY_ARRAY;\n        if (lastSyncedMapIdRef.current !== activeMapId) {\n            const playData = [...objectMapData];\n            let spawnIndex = playData.findIndex(id => id && id.includes('player'));\n            if (spawnIndex === -1 && (spawnTriggerId === null || spawnTriggerId === undefined)) {\n                const spawnX = Math.min(3, mapWidth - 1);\n                const spawnY = Math.min(3, mapHeight - 1);\n                spawnIndex = spawnY * mapWidth + spawnX;\n                playData[spawnIndex] = 'player';\n            }\n            return playData;\n        }\n        return playModeObjectData;\n    }, [isPlayMode, activeMapId, playModeObjectData, objectMapData, spawnTriggerId, mapWidth, mapHeight]);\n\n    const currentPlaySecretData = useMemo(() => {\n        if (!isPlayMode) return EMPTY_ARRAY;\n        if (lastSyncedMapIdRef.current !== activeMapId) return [...secretMapData];\n        return playModeSecretData;\n    }, [isPlayMode, activeMapId, playModeSecretData, secretMapData]);\n\n    const playModeMaps = useMemo(() => {\n        if (!isPlayMode) return maps;\n        const overrides = playModeMapsRef.current || {};\n        const merged = { ...maps };\n        Object.keys(overrides).forEach(id => {\n            if (!merged[id]) return;\n            merged[id] = {\n                ...merged[id],\n                objectMapData: overrides[id].objectMapData || merged[id].objectMapData,\n                secretMapData: overrides[id].secretMapData || merged[id].secretMapData,\n                objectMetadata: overrides[id].objectMetadata || merged[id].objectMetadata\n            };\n        });\n        return merged;\n    }, [isPlayMode, maps, playModeMapsVersion]);\n\n    const mapDataForGame = useMemo(() => ({\n        meta: {\n            width: mapWidth,\n            height: mapHeight,\n            tileSize: TILE_SIZE,\n            activeMapId: activeMapId,\n            spawnTriggerId: spawnTriggerId,\n            backgroundImage: selectedBackgroundImage,\n            backgroundColor: selectedBackgroundColor,\n            backgroundParallaxFactor: backgroundParallaxFactor,\n            objectMetadata: objectMetadata,\n            activeRoomIds: Array.from(activeRoomIds),\n            date_map_last_updated: engineInitId, \n            weather: {\n                rain: isPlayMode ? playModeWeather.rain : weatherRain,\n                lavaRain: isPlayMode ? playModeWeather.lavaRain : weatherLavaRain,\n                snow: isPlayMode ? playModeWeather.snow : weatherSnow,\n                meteorRain: isPlayMode ? playModeWeather.meteorRain : weatherMeteorRain,\n                clouds: isPlayMode ? playModeWeather.clouds : weatherClouds,\n                fog: isPlayMode ? playModeWeather.fog : weatherFog,\n                radioactiveFog: isPlayMode ? playModeWeather.radioactiveFog : weatherRadioactiveFog,\n                thunder: isPlayMode ? playModeWeather.thunder : weatherThunder\n            }\n        },\n        maps: playModeMaps, // Project maps for inter-map teleports\n        layers: [\n            { type: \"tile\", name: \"background\", data: tileMapData },\n            { type: \"object\", name: \"entities\", data: currentPlayObjectData },\n            { type: \"secret\", name: \"secrets\", data: currentPlaySecretData }\n        ]\n    }), [\n        mapWidth, mapHeight, activeMapId, spawnTriggerId, selectedBackgroundImage, selectedBackgroundColor, \n        backgroundParallaxFactor, tileMapData, currentPlayObjectData, objectMetadata, activeRoomIds,\n        weatherRain, weatherSnow, weatherClouds, weatherFog, weatherThunder,\n        weatherLavaRain, weatherRadioactiveFog, weatherMeteorRain,\n        playModeWeather,\n        isPlayMode, playModeMaps, engineInitId\n    ]);\n\n    // Synchronize play mode state when map changes (e.g., during inter-map teleport)\n    useEffect(() => {\n        if (isPlayMode && lastSyncedMapIdRef.current !== activeMapId) {\n            const saved = playModeMapsRef.current?.[activeMapId];\n            if (saved) {\n                setPlayModeObjectData([...saved.objectMapData]);\n                setPlayModeSecretData([...(saved.secretMapData || [])]);\n                if (saved.objectMetadata) {\n                    setObjectMetadata({ ...saved.objectMetadata });\n                }\n                setRevealedSecrets([]);\n                if (messageTimerRef.current) {\n                    clearTimeout(messageTimerRef.current);\n                    messageTimerRef.current = null;\n                }\n                setGameMessage({ text: '', isVisible: false });\n                lastSyncedMapIdRef.current = activeMapId;\n                return;\n            }\n            const playData = [...objectMapData];\n            \n            let spawnIndex = playData.findIndex(id => id && id.includes('player'));\n            if (spawnIndex === -1 && (spawnTriggerId === null || spawnTriggerId === undefined)) {\n                const spawnX = Math.min(3, mapWidth - 1);\n                const spawnY = Math.min(3, mapHeight - 1);\n                spawnIndex = spawnY * mapWidth + spawnX;\n                playData[spawnIndex] = 'player';\n            }\n\n            setPlayModeObjectData(playData);\n            setPlayModeSecretData([...secretMapData]);\n            setRevealedSecrets([]);\n            if (messageTimerRef.current) {\n                clearTimeout(messageTimerRef.current);\n                messageTimerRef.current = null;\n            }\n            setGameMessage({ text: '', isVisible: false });\n            lastSyncedMapIdRef.current = activeMapId;\n        }\n    }, [activeMapId, isPlayMode, objectMapData, secretMapData, mapWidth, mapHeight, spawnTriggerId]);\n\n    const handleGameOver = useCallback(() => {\n        setIsGameOver(true);\n    }, []);\n\n    const handleReplay = useCallback(() => {\n        setIsGameOver(false);\n        setRestartCounter(prev => prev + 1);\n        setRevealedSecrets([]);\n        if (editorSnapshot) {\n            setPlayModeObjectData([...editorSnapshot.objectMapData]);\n            setPlayModeSecretData([...editorSnapshot.secretMapData]);\n            setObjectMetadata({ ...editorSnapshot.objectMetadata });\n        }\n    }, [editorSnapshot, setObjectMetadata]);\n\n    const handleStateUpdate = useCallback((newState, payload) => {\n        if (newState && typeof newState === 'object' && newState.x !== undefined && newState.y !== undefined) {\n            setPlayerPosition({ x: newState.x, y: newState.y });\n        } else if (newState === 'collectItem' && payload !== undefined) {\n            const { index, mapId } = typeof payload === 'object' ? payload : { index: payload, mapId: null };\n            if (!mapId || mapId === activeMapId) {\n                setPlayModeObjectData(prev => {\n                    const newData = [...prev];\n                    newData[index] = null;\n                    playModeMapsRef.current[activeMapId] = {\n                        ...(playModeMapsRef.current[activeMapId] || {}),\n                        objectMapData: newData\n                    };\n                    setPlayModeMapsVersion(v => v + 1);\n                    return newData;\n                });\n            } else if (updateMapData && maps[mapId]) {\n                const newData = [...(playModeMapsRef.current?.[mapId]?.objectMapData || maps[mapId].objectMapData || [])];\n                newData[index] = null;\n                playModeMapsRef.current[mapId] = {\n                    ...(playModeMapsRef.current[mapId] || {}),\n                    objectMapData: newData\n                };\n                setPlayModeMapsVersion(v => v + 1);\n            }\n        } else if (newState === 'interactable' && payload !== undefined) {\n            const { index, mapId } = typeof payload === 'object' ? payload : { index: payload, mapId: null };\n            if (!mapId || mapId === activeMapId) {\n                setPlayModeObjectData(prev => {\n                    const currentId = prev[index];\n                    if (!currentId) return prev;\n                    const newData = [...prev];\n                    newData[index] = currentId + '_used';\n                    playModeMapsRef.current[activeMapId] = {\n                        ...(playModeMapsRef.current[activeMapId] || {}),\n                        objectMapData: newData\n                    };\n                    setPlayModeMapsVersion(v => v + 1);\n                    return newData;\n                });\n            } else if (updateMapData && maps[mapId]) {\n                const mapObj = playModeMapsRef.current?.[mapId]?.objectMapData || maps[mapId].objectMapData || [];\n                const currentId = mapObj[index];\n                if (currentId) {\n                    const newData = [...mapObj];\n                    newData[index] = currentId + '_used';\n                    playModeMapsRef.current[mapId] = {\n                        ...(playModeMapsRef.current[mapId] || {}),\n                        objectMapData: newData\n                    };\n                    setPlayModeMapsVersion(v => v + 1);\n                }\n            }\n        } else if (newState === 'setObjectFrame' && payload !== undefined) {\n            const { index, frame, mapId } = payload;\n            if (!mapId || mapId === activeMapId) {\n                setObjectMetadata(prev => {\n                    const next = {\n                        ...prev,\n                        [index]: { ...prev[index], currentFrame: frame }\n                    };\n                    playModeMapsRef.current[activeMapId] = {\n                        ...(playModeMapsRef.current[activeMapId] || {}),\n                        objectMetadata: next\n                    };\n                    setPlayModeMapsVersion(v => v + 1);\n                    return next;\n                });\n            } else if (updateMapData && maps[mapId]) {\n                const newMeta = { ...((playModeMapsRef.current?.[mapId]?.objectMetadata) || maps[mapId].objectMetadata || {}) };\n                newMeta[index] = { ...(newMeta[index] || {}), currentFrame: frame };\n                playModeMapsRef.current[mapId] = {\n                    ...(playModeMapsRef.current[mapId] || {}),\n                    objectMetadata: newMeta\n                };\n                setPlayModeMapsVersion(v => v + 1);\n            }\n        } else if (newState === 'switchMap' && payload !== undefined) {\n            const { targetMapId, triggerId } = payload;\n            \n            // Check if target is a room\n            const targetMap = maps[targetMapId];\n            if (targetMap && targetMap.type === 'room') {\n                setActiveRoomIds(prev => {\n                    const next = new Set(prev);\n                    if (next.has(targetMapId)) next.delete(targetMapId);\n                    else next.add(targetMapId);\n                    return next;\n                });\n            } else if (targetMapId === 'main' && activeRoomIds.size > 0) {\n                setActiveRoomIds(new Set());\n            } else if (switchMap && targetMapId) {\n                playModeMapsRef.current[activeMapId] = {\n                    objectMapData: [...playModeObjectData],\n                    secretMapData: [...playModeSecretData],\n                    objectMetadata: { ...objectMetadata }\n                };\n                setPlayModeMapsVersion(v => v + 1);\n                // We keep play mode active when switching maps via teleport\n                switchMap(targetMapId, triggerId);\n            }\n        } else if (newState === 'objectDamage' && payload !== undefined) {\n            const { index, damage } = payload;\n            const objId = playModeObjectData[index];\n            const def = registryItems.find(r => r.id === objId);\n            if (!def) return;\n\n            setObjectMetadata(prev => {\n                const current = prev[index] || {};\n                const maxH = def.maxHealth || 100;\n                const newHealth = Math.max(0, (current.health !== undefined ? current.health : maxH) - damage);\n                \n                if (shouldRemoveCrackBlock(def, newHealth)) {\n                    if (setTileMapData) {\n                        setTileMapData(prevTiles => {\n                            const newTiles = [...prevTiles];\n                            newTiles[index] = null;\n                            return newTiles;\n                        });\n                    }\n                }\n\n                if (shouldTriggerBreakEffect(def, newHealth) && !current.breakFxPlayed) {\n                    const cfg = getBreakEffectParams(def);\n                    if (cfg) {\n                        const x = (index % mapWidth) * TILE_SIZE + TILE_SIZE / 2;\n                        const y = Math.floor(index / mapWidth) * TILE_SIZE + TILE_SIZE / 2;\n                        window.dispatchEvent(new CustomEvent('game-break-effect', {\n                            detail: { x, y, config: cfg }\n                        }));\n                    }\n                }\n\n                return {\n                    ...prev,\n                    [index]: { ...current, health: newHealth, breakFxPlayed: current.breakFxPlayed || shouldTriggerBreakEffect(def, newHealth) }\n                };\n            });\n            const nextMeta = {\n                ...(objectMetadata || {}),\n                [index]: {\n                    ...(objectMetadata?.[index] || {}),\n                    health: Math.max(0, ((objectMetadata?.[index]?.health ?? (def.maxHealth || 100)) - damage))\n                }\n            };\n            playModeMapsRef.current[activeMapId] = {\n                ...(playModeMapsRef.current[activeMapId] || {}),\n                objectMetadata: nextMeta\n            };\n            setPlayModeMapsVersion(v => v + 1);\n\n            const x = (index % mapWidth) * TILE_SIZE + TILE_SIZE / 2;\n            const y = Math.floor(index / mapWidth) * TILE_SIZE;\n            window.dispatchEvent(new CustomEvent('game-floating-text', {\n                detail: { x, y, text: `-${damage}`, color: '#ff3b3b', amount: damage }\n            }));\n        } else if (newState === 'entityDamage' && payload) {\n            const { x, y, amount } = payload;\n            if (Number.isFinite(x) && Number.isFinite(y) && Number.isFinite(amount)) {\n                window.dispatchEvent(new CustomEvent('game-floating-text', {\n                    detail: { x, y, text: `-${Math.round(amount)}`, color: '#ff3b3b', amount }\n                }));\n            }\n        } else if (newState === 'shiftTile' && payload !== undefined) {\n            const { index, dx, dy } = payload;\n            const mapIdAtStart = activeMapId;\n            \n            applyWolfSecretShift({\n                index,\n                dx,\n                dy,\n                mapWidth,\n                mapHeight,\n                getObjectId: idx => playModeObjectData[idx],\n                getObjectDef: objId => registryItems.find(r => r.id === objId),\n                moveTile: (from, to) => {\n                    if (setTileMapData) {\n                        setTileMapData(prevTiles => {\n                            const newTiles = [...prevTiles];\n                            newTiles[to] = newTiles[from];\n                            newTiles[from] = null;\n                            return newTiles;\n                        });\n                    }\n                },\n                moveObject: (from, to) => {\n                    setPlayModeObjectData(prevObjs => {\n                        const newObjs = [...prevObjs];\n                        newObjs[to] = newObjs[from];\n                        newObjs[from] = null;\n                        playModeMapsRef.current[activeMapId] = {\n                            ...(playModeMapsRef.current[activeMapId] || {}),\n                            objectMapData: newObjs\n                        };\n                        setPlayModeMapsVersion(v => v + 1);\n                        return newObjs;\n                    });\n                },\n                moveMetadata: (from, to) => {\n                    setObjectMetadata(prevMeta => {\n                        const newMeta = { ...prevMeta };\n                        if (newMeta[from]) {\n                            newMeta[to] = newMeta[from];\n                            delete newMeta[from];\n                        }\n                        playModeMapsRef.current[activeMapId] = {\n                            ...(playModeMapsRef.current[activeMapId] || {}),\n                            objectMetadata: newMeta\n                        };\n                        setPlayModeMapsVersion(v => v + 1);\n                        return newMeta;\n                    });\n                },\n                removeObject: idx => {\n                    setPlayModeObjectData(prevObjs => {\n                        const newObjs = [...prevObjs];\n                        newObjs[idx] = null;\n                        playModeMapsRef.current[activeMapId] = {\n                            ...(playModeMapsRef.current[activeMapId] || {}),\n                            objectMapData: newObjs\n                        };\n                        setPlayModeMapsVersion(v => v + 1);\n                        return newObjs;\n                    });\n                },\n                shouldCancel: () => !isPlayModeRef.current || activeMapId !== mapIdAtStart\n            });\n        } else if (newState === 'updateWeather' && payload) {\n            const { type, value } = payload;\n            setPlayModeWeather(prev => ({\n                ...prev,\n                [type]: value\n            }));\n            \n            // Dispatch event for any UI components that might be listening\n            const settingKey = 'weather' + type.charAt(0).toUpperCase() + type.slice(1);\n            window.dispatchEvent(new CustomEvent('game-settings-update', { \n                detail: { [settingKey]: value } \n            }));\n        } else if (newState === 'showMessage' && payload) {\n            const { text, duration } = payload;\n            \n            if (messageTimerRef.current) {\n                clearTimeout(messageTimerRef.current);\n            }\n            \n            setGameMessage({ text, isVisible: true });\n            \n            messageTimerRef.current = setTimeout(() => {\n                setGameMessage(prev => ({ ...prev, isVisible: false }));\n                messageTimerRef.current = null;\n            }, duration || 8000);\n        } else if (newState === 'weatherEffectHit' && payload) {\n            const { type, data } = payload;\n            window.dispatchEvent(new CustomEvent('weather-effect-hit', { detail: { type, data } }));\n        } else if (newState === 'floatingText' && payload) {\n            const { x, y, text, color, amount } = payload;\n            if (Number.isFinite(x) && Number.isFinite(y) && text) {\n                window.dispatchEvent(new CustomEvent('game-floating-text', {\n                    detail: { x, y, text, color, amount }\n                }));\n            }\n        } else if (newState === 'playerDamage' && payload !== undefined) {\n            const { damage, x, y } = payload || {};\n            if (Number.isFinite(x) && Number.isFinite(y) && Number.isFinite(damage)) {\n                window.dispatchEvent(new CustomEvent('game-floating-text', {\n                    detail: { x, y, text: `-${Math.round(damage)}`, color: '#ff3b3b', amount: damage }\n                }));\n            }\n        }\n    }, [activeMapId, maps, updateMapData, activeRoomIds, playModeObjectData, registryItems, setPlayerPosition, setObjectMetadata, switchMap, playModeSecretData, objectMetadata, mapWidth, mapHeight]);\n\n    const handleRevealSecret = useCallback((secretIndices) => {\n        const next = Array.isArray(secretIndices) ? secretIndices : [secretIndices];\n        if (next.length === 0) return;\n        setRevealedSecrets(prev => [...prev, ...next]);\n    }, []);\n\n    const gameEngineState = useGameEngine(\n        isPlayMode ? mapDataForGame : null,\n        isPlayMode ? tileMapData : EMPTY_ARRAY,\n        isPlayMode ? currentPlayObjectData : EMPTY_ARRAY,\n        isPlayMode ? currentPlaySecretData : EMPTY_ARRAY,\n        revealedSecrets,\n        registryItems,\n        handleGameOver,\n        handleStateUpdate,\n        handleRevealSecret,\n        objectMetadata,\n        Array.from(activeRoomIds),\n        mapWidth,\n        mapHeight\n    );\n\n    const handlePlay = () => {\n        setEditorSnapshot({\n            tileMapData: [...tileMapData],\n            objectMapData: [...objectMapData],\n            secretMapData: [...secretMapData],\n            objectMetadata: { ...objectMetadata },\n            playerPosition: { ...playerPosition }\n        });\n\n        const playData = [...objectMapData];\n        let spawnIndex = playData.findIndex(id => id && id.includes('player'));\n        if (spawnIndex === -1) {\n            const spawnX = Math.min(3, mapWidth - 1);\n            const spawnY = Math.min(3, mapHeight - 1);\n            spawnIndex = spawnY * mapWidth + spawnX;\n            playData[spawnIndex] = 'player';\n        }\n\n        setPlayModeObjectData(playData);\n        setPlayModeSecretData([...secretMapData]);\n        playModeMapsRef.current = {\n            [activeMapId]: {\n                objectMapData: playData,\n                secretMapData: [...secretMapData],\n                objectMetadata: { ...objectMetadata }\n            }\n        };\n        setPlayModeMapsVersion(v => v + 1);\n        setPlayModeWeather({\n            rain: weatherRain,\n            snow: weatherSnow,\n            clouds: weatherClouds,\n            fog: weatherFog,\n            thunder: weatherThunder,\n            lavaRain: weatherLavaRain,\n            radioactiveFog: weatherRadioactiveFog,\n            meteorRain: weatherMeteorRain\n        });\n        setRevealedSecrets([]);\n        lastSyncedMapIdRef.current = activeMapId;\n        setIsPlayMode(true);\n        setIsGameOver(false); // Reset game over when starting play mode\n    };\n\n    const handlePause = () => {\n        setIsPlayMode(false);\n        setIsGameOver(false); // Reset game over when exiting play mode\n        playModeMapsRef.current = {};\n        setPlayModeMapsVersion(v => v + 1);\n    };\n\n    const handleReset = () => {\n        if (editorSnapshot) {\n            if (setTileMapData) {\n                setTileMapData([...editorSnapshot.tileMapData]);\n            }\n\n            const resetData = [...editorSnapshot.objectMapData];\n            let spawnIndex = resetData.findIndex(id => id && id.includes('player'));\n            if (spawnIndex === -1) {\n                const spawnX = Math.min(3, mapWidth - 1);\n                const spawnY = Math.min(3, mapHeight - 1);\n                spawnIndex = spawnY * mapWidth + spawnX;\n                resetData[spawnIndex] = 'player';\n            }\n\n            setPlayModeObjectData(resetData);\n            setPlayModeSecretData([...editorSnapshot.secretMapData]);\n            setObjectMetadata({ ...editorSnapshot.objectMetadata });\n            setRevealedSecrets([]);\n            playModeMapsRef.current = {\n                [activeMapId]: {\n                    objectMapData: resetData,\n                    secretMapData: [...editorSnapshot.secretMapData],\n                    objectMetadata: { ...editorSnapshot.objectMetadata }\n                }\n            };\n            setPlayModeMapsVersion(v => v + 1);\n            lastSyncedMapIdRef.current = activeMapId;\n        }\n    };\n\n    const handleForceStop = () => {\n        setIsPlayMode(false);\n        setIsGameOver(false);\n        setEditorSnapshot(null);\n        setPlayModeObjectData([]);\n        setPlayModeSecretData([]);\n        setRevealedSecrets([]);\n        playModeMapsRef.current = {};\n        lastSyncedMapIdRef.current = null;\n        setPlayModeMapsVersion(v => v + 1);\n    };\n\n    return {\n        isPlayMode,\n        setIsPlayMode,\n        isGameOver,\n        handlePlay,\n        handlePause,\n        handleReset,\n        handleForceStop,\n        handleReplay,\n        handleStateUpdate,\n        playModeObjectData: currentPlayObjectData,\n        playModeSecretData: currentPlaySecretData,\n        playModeWeather,\n        playModeMaps,\n        gameMessage,\n        revealedSecrets,\n        activeRoomIds: Array.from(activeRoomIds),\n        gameEngineState\n    };\n};\n","import { useCallback } from 'react';\nimport { saveMap, loadMap, loadBuiltInMap, clearMap } from '../editorTools/mapOperations';\n\nexport const useEditorOperations = (\n    mapWidth, mapHeight, tileMapData, objectMapData, secretMapData, objectMetadata,\n    mapName, creatorName, mapDescription, createdAt,\n    selectedBackgroundImage, selectedBackgroundColor,\n    backgroundParallaxFactor, selectedBackgroundMusic, playerPosition,\n    registryItems, setCreatedAt,\n    setMapWidth, setMapHeight, setMapName, setCreatorName, setMapDescription,\n    setSelectedBackgroundImage, setSelectedBackgroundColor,\n    setBackgroundParallaxFactor, setSelectedBackgroundMusic, setPlayerPosition,\n    setTileMapData, setObjectMapData, setSecretMapData, setObjectMetadata,\n    setIsNewMapModalOpen, setTempMapName, setTempCreatorName, setTempMapDescription,\n    weatherRain, weatherSnow, weatherClouds, weatherFog, weatherThunder,\n    weatherLavaRain, weatherRadioactiveFog, weatherMeteorRain,\n    setWeatherRain, setWeatherSnow, setWeatherClouds, setWeatherFog, setWeatherThunder,\n    setWeatherLavaRain, setWeatherRadioactiveFog, setWeatherMeteorRain,\n    // Multi-map props\n    maps, setMaps, activeMapId, setActiveMapId\n) => {\n    const handleSaveMap = useCallback(() => {\n        // Construct the updated maps object with current active map data\n        // to ensure latest changes are saved even if debounce hasn't run\n        const currentMapData = {\n            ...maps[activeMapId],\n            mapWidth, mapHeight, tileMapData, objectMapData, secretMapData, objectMetadata,\n            selectedBackgroundImage, selectedBackgroundColor,\n            backgroundParallaxFactor, selectedBackgroundMusic,\n            weather: {\n                rain: weatherRain,\n                snow: weatherSnow,\n                clouds: weatherClouds,\n                fog: weatherFog,\n                thunder: weatherThunder,\n                lavaRain: weatherLavaRain,\n                radioactiveFog: weatherRadioactiveFog,\n                meteorRain: weatherMeteorRain\n            },\n            playerPosition\n        };\n\n        const updatedMaps = {\n            ...maps,\n            [activeMapId]: currentMapData\n        };\n\n        saveMap({\n            maps: updatedMaps, \n            activeMapId,\n            mapName, creatorName, mapDescription, createdAt,\n            registryItems, setCreatedAt\n        });\n    }, [\n        maps, activeMapId, mapWidth, mapHeight, tileMapData, objectMapData, secretMapData, objectMetadata,\n        mapName, creatorName, mapDescription, createdAt, selectedBackgroundImage, selectedBackgroundColor,\n        backgroundParallaxFactor, selectedBackgroundMusic, playerPosition, registryItems, setCreatedAt,\n        weatherRain, weatherSnow, weatherClouds, weatherFog, weatherThunder,\n        weatherLavaRain, weatherRadioactiveFog, weatherMeteorRain\n    ]);\n\n    const handleLoadMap = useCallback((event) => {\n        loadMap({\n            event, setMapWidth, setMapHeight, setMapName, setCreatorName, setMapDescription,\n            setCreatedAt, setSelectedBackgroundImage, setSelectedBackgroundColor,\n            setBackgroundParallaxFactor, setSelectedBackgroundMusic, setPlayerPosition,\n            setTileMapData, setObjectMapData, setSecretMapData, setObjectMetadata,\n            setWeatherRain, setWeatherSnow, setWeatherClouds, setWeatherFog, setWeatherThunder,\n            setWeatherLavaRain, setWeatherRadioactiveFog, setWeatherMeteorRain,\n            setMaps, setActiveMapId\n        });\n    }, [\n        setMapWidth, setMapHeight, setMapName, setCreatorName, setMapDescription,\n        setCreatedAt, setSelectedBackgroundImage, setSelectedBackgroundColor,\n        setBackgroundParallaxFactor, setSelectedBackgroundMusic, setPlayerPosition,\n        setTileMapData, setObjectMapData, setSecretMapData, setObjectMetadata,\n        setWeatherRain, setWeatherSnow, setWeatherClouds, setWeatherFog, setWeatherThunder,\n        setWeatherLavaRain, setWeatherRadioactiveFog, setWeatherMeteorRain,\n        setMaps, setActiveMapId\n    ]);\n\n    const handleLoadBuiltInMap = useCallback((mapData) => {\n        loadBuiltInMap({\n            mapData, setMapWidth, setMapHeight, setMapName, setCreatorName, setMapDescription,\n            setCreatedAt, setSelectedBackgroundImage, setSelectedBackgroundColor,\n            setBackgroundParallaxFactor, setSelectedBackgroundMusic, setPlayerPosition,\n            setTileMapData, setObjectMapData, setSecretMapData, setObjectMetadata,\n            setWeatherRain, setWeatherSnow, setWeatherClouds, setWeatherFog, setWeatherThunder,\n            setWeatherLavaRain, setWeatherRadioactiveFog, setWeatherMeteorRain,\n            setMaps, setActiveMapId\n        });\n    }, [\n        setMapWidth, setMapHeight, setMapName, setCreatorName, setMapDescription,\n        setCreatedAt, setSelectedBackgroundImage, setSelectedBackgroundColor,\n        setBackgroundParallaxFactor, setSelectedBackgroundMusic, setPlayerPosition,\n        setTileMapData, setObjectMapData, setSecretMapData, setObjectMetadata,\n        setWeatherRain, setWeatherSnow, setWeatherClouds, setWeatherFog, setWeatherThunder,\n        setWeatherLavaRain, setWeatherRadioactiveFog, setWeatherMeteorRain,\n        setMaps, setActiveMapId\n    ]);\n\n    const handleClearMap = useCallback(() => {\n        clearMap({ \n            mapWidth, mapHeight, setTileMapData, setObjectMapData, setSecretMapData, setObjectMetadata \n        });\n    }, [mapWidth, mapHeight, setTileMapData, setObjectMapData, setSecretMapData, setObjectMetadata]);\n\n    const openNewMapModal = () => {\n        setTempMapName(mapName);\n        setTempCreatorName(creatorName);\n        setTempMapDescription(mapDescription);\n        setIsNewMapModalOpen(true);\n    };\n\n    const confirmNewMap = (tempMapName, tempCreatorName, tempMapDescription) => {\n        setMapName(tempMapName || \"New Map\");\n        setCreatorName(tempCreatorName || \"Anonymous\");\n        setMapDescription(tempMapDescription || \"\");\n        setCreatedAt(new Date().toISOString());\n        \n        const size = mapWidth * mapHeight;\n        setTileMapData(Array(size).fill(null));\n        setObjectMapData(Array(size).fill(null));\n        setSecretMapData(Array(size).fill(null));\n        setObjectMetadata({});\n        \n        setIsNewMapModalOpen(false);\n    };\n\n    return {\n        handleSaveMap,\n        handleLoadMap,\n        handleLoadBuiltInMap,\n        handleClearMap,\n        openNewMapModal,\n        confirmNewMap\n    };\n};\n","export const getFloodFillIndices = (startIndex, currentData, mapWidth, mapHeight) => {\n    const startId = currentData[startIndex];\n    const width = mapWidth;\n    const height = mapHeight;\n    const stack = [startIndex];\n    const visited = new Set();\n    const matchingIndices = new Set();\n\n    while (stack.length > 0) {\n        const idx = stack.pop();\n        if (visited.has(idx)) continue;\n        visited.add(idx);\n        if (idx < 0 || idx >= currentData.length) continue;\n        if (currentData[idx] !== startId) continue;\n        matchingIndices.add(idx);\n\n        const x = idx % width;\n        const y = Math.floor(idx / width);\n        if (x > 0) stack.push(idx - 1);\n        if (x < width - 1) stack.push(idx + 1);\n        if (y > 0) stack.push(idx - width);\n        if (y < height - 1) stack.push(idx + width);\n    }\n    return matchingIndices;\n};\n\nexport const floodFill = (startIndex, targetId, currentData, mapWidth, mapHeight) => {\n    const startId = currentData[startIndex];\n    if (startId === targetId) return currentData;\n\n    const indices = getFloodFillIndices(startIndex, currentData, mapWidth, mapHeight);\n    const newData = [...currentData];\n    indices.forEach(idx => newData[idx] = targetId);\n    return newData;\n};\n\nexport const paintTile = ({\n    index, brushSize, activeLayer, selectedTile,\n    mapWidth, mapHeight, tileMapData, objectMapData, secretMapData, objectMetadata,\n    setTileMapData, setObjectMapData, setSecretMapData, setObjectMetadata,\n    isRoomAreaVisible, activeTool\n}) => {\n    const isPropsLayer = activeLayer === 'props';\n    const targetLayer = isPropsLayer ? 'object' : activeLayer;\n\n    const targetData = targetLayer === 'tile' ? tileMapData : (targetLayer === 'object' ? objectMapData : secretMapData);\n    const setTargetData = targetLayer === 'tile' ? setTileMapData : (targetLayer === 'object' ? setObjectMapData : setSecretMapData);\n    \n    const newData = [...targetData];\n    let newMetadata = objectMetadata ? { ...objectMetadata } : null;\n    let metadataChanged = false;\n\n    const x = index % mapWidth;\n    const y = Math.floor(index / mapWidth);\n\n    for (let dy = 0; dy < brushSize; dy++) {\n        for (let dx = 0; dx < brushSize; dx++) {\n            const targetX = x + dx;\n            const targetY = y + dy;\n            if (targetX < mapWidth && targetY < mapHeight) {\n                const targetIndex = targetY * mapWidth + targetX;\n                \n                // Protection for Room Areas\n                if (targetLayer === 'secret' && secretMapData[targetIndex] === 'room_area') {\n                    const isRoomAreaTool = activeTool === 'area' || selectedTile?.id === 'room_area';\n                    const isEraser = selectedTile === null;\n                    if (!isRoomAreaVisible && !isRoomAreaTool && !isEraser) {\n                        continue; // Skip overwriting room_area if not visible and not using room tool\n                    }\n                }\n\n                if (isPropsLayer) {\n                    // In props layer, we erase metadata and the object itself\n                    newData[targetIndex] = null;\n                    if (newMetadata && newMetadata[targetIndex]) {\n                        delete newMetadata[targetIndex];\n                        metadataChanged = true;\n                    }\n                } else {\n                    newData[targetIndex] = selectedTile ? selectedTile.id : null;\n                    // If we are painting/erasing in object layer, we should also handle metadata\n                    if (targetLayer === 'object' && selectedTile === null) {\n                        if (newMetadata && newMetadata[targetIndex]) {\n                            delete newMetadata[targetIndex];\n                            metadataChanged = true;\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    setTargetData(newData);\n    if (metadataChanged && setObjectMetadata) {\n        setObjectMetadata(newMetadata);\n    }\n};\n","import { useState, useRef, useEffect, useCallback } from 'react';\nimport { getFloodFillIndices, floodFill, paintTile as paintTileUtil } from '../editorTools/paintingTools';\n\nexport const useEditorPainting = (\n    mapWidth, mapHeight, tileMapData, objectMapData, secretMapData, \n    setTileMapData, setObjectMapData, setSecretMapData,\n    activeTool, brushSize, activeLayer, selectedTile, selection, \n    setSelection, setPreviewPosition, setOriginalMapData, dragStart, setDragStart, isDragging, setIsDragging,\n    setActivePanel, setHighlightedIndex, highlightedIndex, registryItems,\n    objectMetadata, setObjectMetadata,\n    maps, activeMapId, showRoomMapContent, isRoomAreaVisible, updateMapData\n) => {\n    const [hoverIndex, setHoverIndex] = useState(null);\n    const [bucketPreviewIndices, setBucketPreviewIndices] = useState(new Set());\n    const [resizeState, setResizeState] = useState(null); // { index, edge, startX, startY, startW, startH }\n    const [moveState, setMoveState] = useState(null); // { index, startX, startY, objId, secretId, meta }\n    const bucketTimerRef = useRef(null);\n\n    const getLinkedRoomAt = useCallback((index) => {\n        if (!showRoomMapContent || !secretMapData || !objectMetadata) return null;\n        \n        const x = index % mapWidth;\n        const y = Math.floor(index / mapWidth);\n\n        // Scan for room areas\n        for (const [idxStr, meta] of Object.entries(objectMetadata)) {\n            const idx = parseInt(idxStr);\n            if (secretMapData[idx] === 'room_area' && meta.linkedMapId && maps[meta.linkedMapId]) {\n                const rx = idx % mapWidth;\n                const ry = Math.floor(idx / mapWidth);\n                const rw = meta.width || 1;\n                const rh = meta.height || 1;\n\n                if (x >= rx && x < rx + rw && y >= ry && y < ry + rh) {\n                    return {\n                        mapId: meta.linkedMapId,\n                        roomX: rx,\n                        roomY: ry,\n                        roomWidth: rw,\n                        roomHeight: rh,\n                        localX: x - rx,\n                        localY: y - ry,\n                        map: maps[meta.linkedMapId]\n                    };\n                }\n            }\n        }\n        return null;\n    }, [showRoomMapContent, secretMapData, objectMetadata, maps, mapWidth]);\n\n    const paintTile = useCallback((index) => {\n        const linkedRoom = getLinkedRoomAt(index);\n        \n        if (linkedRoom && showRoomMapContent) {\n            const { mapId, localX, localY, map } = linkedRoom;\n            const rWidth = map.mapWidth;\n            const rHeight = map.mapHeight;\n            const roomIndex = localY * rWidth + localX;\n\n            const setRoomData = (layer, newData) => {\n                updateMapData(mapId, { [layer]: newData });\n            };\n\n            const setRoomMetadata = (newMeta) => {\n                updateMapData(mapId, { objectMetadata: newMeta });\n            };\n\n            paintTileUtil({\n                index: roomIndex,\n                activeTool,\n                brushSize,\n                activeLayer,\n                selectedTile,\n                mapWidth: rWidth,\n                mapHeight: rHeight,\n                tileMapData: map.tileMapData || [],\n                objectMapData: map.objectMapData || [],\n                secretMapData: map.secretMapData || [],\n                objectMetadata: map.objectMetadata || {},\n                setTileMapData: (data) => setRoomData('tileMapData', data),\n                setObjectMapData: (data) => setRoomData('objectMapData', data),\n                setSecretMapData: (data) => setRoomData('secretMapData', data),\n                setObjectMetadata: setRoomMetadata,\n                isRoomAreaVisible\n            });\n            return;\n        }\n\n        paintTileUtil({\n            index,\n            activeTool,\n            brushSize,\n            activeLayer,\n            selectedTile,\n            mapWidth,\n            mapHeight,\n            tileMapData,\n            objectMapData,\n            secretMapData,\n            objectMetadata,\n            setTileMapData,\n            setObjectMapData,\n            setSecretMapData,\n            setObjectMetadata,\n            isRoomAreaVisible\n        });\n    }, [getLinkedRoomAt, showRoomMapContent, updateMapData, activeTool, brushSize, activeLayer, selectedTile, mapWidth, mapHeight, tileMapData, objectMapData, secretMapData, objectMetadata, setTileMapData, setObjectMapData, setSecretMapData, setObjectMetadata, isRoomAreaVisible]);\n\n    const handleResizeStart = useCallback((index, edge) => {\n        const meta = objectMetadata[index] || {};\n        const x = index % mapWidth;\n        const y = Math.floor(index / mapWidth);\n        setResizeState({\n            index,\n            edge,\n            startX: x,\n            startY: y,\n            startW: meta.width || 1,\n            startH: meta.height || 1\n        });\n        setIsDragging(true);\n    }, [objectMetadata, mapWidth, setIsDragging]);\n\n    const handleMoveStart = useCallback((index) => {\n        const x = index % mapWidth;\n        const y = Math.floor(index / mapWidth);\n        setMoveState({\n            index,\n            startX: x,\n            startY: y,\n            objId: objectMapData[index],\n            secretId: secretMapData[index],\n            meta: objectMetadata[index] ? { ...objectMetadata[index] } : null\n        });\n        setIsDragging(true);\n        setHighlightedIndex(index);\n    }, [objectMapData, secretMapData, objectMetadata, mapWidth, setIsDragging, setHighlightedIndex]);\n\n    const handleGridMouseDown = useCallback((index, e) => {\n        const linkedRoom = getLinkedRoomAt(index);\n        const useLinked = linkedRoom && showRoomMapContent;\n\n        const mWidth = useLinked ? linkedRoom.map.mapWidth : mapWidth;\n        const mHeight = useLinked ? linkedRoom.map.mapHeight : mapHeight;\n        const mIndex = useLinked ? (linkedRoom.localY * mWidth + linkedRoom.localX) : index;\n        \n        const mTileMapData = useLinked ? linkedRoom.map.tileMapData : tileMapData;\n        const mObjectMapData = useLinked ? linkedRoom.map.objectMapData : objectMapData;\n        const mSecretMapData = useLinked ? linkedRoom.map.secretMapData : secretMapData;\n        const mObjectMetadata = useLinked ? linkedRoom.map.objectMetadata : objectMetadata;\n\n        const mSetTileMapData = useLinked ? (data) => updateMapData(linkedRoom.mapId, { tileMapData: data }) : setTileMapData;\n        const mSetObjectMapData = useLinked ? (data) => updateMapData(linkedRoom.mapId, { objectMapData: data }) : setObjectMapData;\n        const mSetSecretMapData = useLinked ? (data) => updateMapData(linkedRoom.mapId, { secretMapData: data }) : setSecretMapData;\n        const mSetObjectMetadata = useLinked ? (data) => updateMapData(linkedRoom.mapId, { objectMetadata: data }) : setObjectMetadata;\n\n        // Quick select for configurable objects\n        const existingObjId = mObjectMapData[mIndex];\n        const existingSecretId = mSecretMapData[mIndex];\n        const isEraser = selectedTile === null && activeTool === 'brush';\n        const isRoomMap = maps[activeMapId]?.type === 'room';\n\n        if (!isEraser && (existingObjId || existingSecretId) && setActivePanel && setHighlightedIndex) {\n            const objDef = existingObjId ? registryItems?.find(r => r.id === existingObjId) : null;\n            const secretDef = existingSecretId ? registryItems?.find(r => r.id === existingSecretId) : null;\n\n            const isWeather = objDef && objDef.type === 'weather_trigger';\n            const isMessage = objDef && objDef.type === 'message_trigger';\n            const isPortalOrTarget = existingObjId && (existingObjId.includes('portal') || existingObjId.includes('target') || existingObjId === 'portal_target');\n            const isDoor = objDef && objDef.subtype === 'door';\n            const isRoomArea = secretDef && secretDef.subtype === 'room' && !isRoomMap;\n\n            if (isWeather || isMessage || isPortalOrTarget || isDoor || isRoomArea) {\n                setActivePanel('props');\n                setHighlightedIndex(useLinked ? index : mIndex);\n            }\n        }\n\n        if (activeTool === 'brush') {\n            setIsDragging(true);\n            paintTile(index);\n        } else if (activeTool === 'area') {\n            setIsDragging(true);\n            setDragStart({ x: index % mapWidth, y: Math.floor(index / mapWidth) });\n        } else if (activeTool === 'bucket') {\n            const isPropsLayer = activeLayer === 'props';\n            const targetLayer = isPropsLayer ? 'object' : activeLayer;\n            const targetData = targetLayer === 'tile' ? mTileMapData : (targetLayer === 'object' ? mObjectMapData : mSecretMapData);\n            const targetValue = targetData[mIndex];\n            const newValue = selectedTile ? selectedTile.id : null;\n            if (targetValue === newValue) return;\n\n            const newData = floodFill(mIndex, newValue, targetData, mWidth, mHeight);\n            \n            if (targetLayer === 'tile') mSetTileMapData(newData);\n            else if (targetLayer === 'object') {\n                mSetObjectMapData(newData);\n                // Clean up metadata for all affected indices if erasing\n                if (newValue === null && mObjectMetadata && mSetObjectMetadata) {\n                    const affectedIndices = getFloodFillIndices(mIndex, targetData, mWidth, mHeight);\n                    let metaChanged = false;\n                    const newMeta = { ...mObjectMetadata };\n                    affectedIndices.forEach(idx => {\n                        if (newMeta[idx]) {\n                            delete newMeta[idx];\n                            metaChanged = true;\n                        }\n                    });\n                    if (metaChanged) mSetObjectMetadata(newMeta);\n                }\n            }\n            else mSetSecretMapData(newData);\n        } else if (activeTool === 'move') {\n            if (selection) return;\n\n            // If we clicked on an object/secret, start moving it\n            if (existingObjId || existingSecretId) {\n                handleMoveStart(mIndex); // Note: move/resize on linked rooms might still be buggy\n            } else {\n                const x = index % mapWidth;\n                const y = Math.floor(index / mapWidth);\n                setDragStart({ x, y });\n                setIsDragging(true);\n            }\n        }\n    }, [mapWidth, mapHeight, tileMapData, objectMapData, secretMapData, objectMetadata, setTileMapData, setObjectMapData, setSecretMapData, setObjectMetadata, setActivePanel, setHighlightedIndex, registryItems, activeTool, setIsDragging, paintTile, activeLayer, selectedTile, selection, handleMoveStart, setDragStart, getLinkedRoomAt, showRoomMapContent, updateMapData]);\n\n    const handleGridMouseMove = useCallback((index) => {\n        setHoverIndex(index);\n        const curX = index % mapWidth;\n        const curY = Math.floor(index / mapWidth);\n\n        const linkedRoom = getLinkedRoomAt(index);\n        const useLinked = linkedRoom && showRoomMapContent;\n\n        if (resizeState) {\n            // Resize logic - keep on active map for now as it's complex\n            const dx = curX - resizeState.startX;\n            const dy = curY - resizeState.startY;\n            let newW = resizeState.startW;\n            let newH = resizeState.startH;\n            let newIndex = resizeState.index;\n\n            if (resizeState.edge === 'right') newW = Math.max(1, resizeState.startW + dx);\n            if (resizeState.edge === 'bottom') newH = Math.max(1, resizeState.startH + dy);\n            \n            if (resizeState.edge === 'left') {\n                const shift = Math.min(resizeState.startW - 1, dx);\n                newW = resizeState.startW - shift;\n                newIndex = resizeState.startY * mapWidth + (resizeState.startX + shift);\n            }\n            if (resizeState.edge === 'top') {\n                const shift = Math.min(resizeState.startH - 1, dy);\n                newH = resizeState.startH - shift;\n                newIndex = (resizeState.startY + shift) * mapWidth + resizeState.startX;\n            }\n\n            if (newW !== (objectMetadata[resizeState.index]?.width || 1) || \n                newH !== (objectMetadata[resizeState.index]?.height || 1) ||\n                newIndex !== resizeState.index) {\n                \n                const meta = { ...objectMetadata[resizeState.index] };\n                meta.width = newW;\n                meta.height = newH;\n                \n                setObjectMetadata(prev => {\n                    const next = { ...prev };\n                    delete next[resizeState.index];\n                    next[newIndex] = meta;\n                    return next;\n                });\n\n                if (newIndex !== resizeState.index) {\n                    const objId = objectMapData[resizeState.index];\n                    const secretId = secretMapData[resizeState.index];\n                    setObjectMapData(prev => {\n                        const next = [...prev];\n                        next[resizeState.index] = null;\n                        next[newIndex] = objId;\n                        return next;\n                    });\n                    setSecretMapData(prev => {\n                        const next = [...prev];\n                        next[resizeState.index] = null;\n                        next[newIndex] = secretId;\n                        return next;\n                    });\n                    setResizeState(prev => ({ ...prev, index: newIndex, startX: newIndex % mapWidth, startY: Math.floor(newIndex / mapWidth), startW: newW, startH: newH }));\n                    setHighlightedIndex(newIndex);\n                }\n            }\n        } else if (moveState) {\n            if (index === moveState.index) return;\n            \n            // Perform move\n            setObjectMapData(prev => {\n                const next = [...prev];\n                next[moveState.index] = null;\n                next[index] = moveState.objId;\n                return next;\n            });\n            setSecretMapData(prev => {\n                const next = [...prev];\n                next[moveState.index] = null;\n                next[index] = moveState.secretId;\n                return next;\n            });\n            setObjectMetadata(prev => {\n                const next = { ...prev };\n                delete next[moveState.index];\n                if (moveState.meta) next[index] = moveState.meta;\n                return next;\n            });\n            setMoveState(prev => ({ ...prev, index, startX: curX, startY: curY }));\n            setHighlightedIndex(index);\n\n        } else if (activeTool === 'brush' && isDragging) {\n            paintTile(index);\n        } else if (activeTool === 'bucket') {\n            if (bucketTimerRef.current) clearTimeout(bucketTimerRef.current);\n            bucketTimerRef.current = setTimeout(() => {\n                const targetLayer = activeLayer === 'props' ? 'object' : activeLayer;\n                \n                const mWidth = useLinked ? linkedRoom.map.mapWidth : mapWidth;\n                const mHeight = useLinked ? linkedRoom.map.mapHeight : mapHeight;\n                const mIndex = useLinked ? (linkedRoom.localY * mWidth + linkedRoom.localX) : index;\n                const mData = useLinked ? linkedRoom.map : { tileMapData, objectMapData, secretMapData };\n                \n                const targetData = targetLayer === 'tile' ? mData.tileMapData : (targetLayer === 'object' ? mData.objectMapData : mData.secretMapData);\n                const indices = getFloodFillIndices(mIndex, targetData, mWidth, mHeight);\n                \n                if (useLinked) {\n                    // We need to convert linked room indices back to main map indices for preview?\n                    // Or just skip preview for linked rooms for now to keep it simple.\n                    setBucketPreviewIndices(new Set()); \n                } else {\n                    setBucketPreviewIndices(indices);\n                }\n            }, 10);\n        }\n    }, [setHoverIndex, activeTool, isDragging, paintTile, activeLayer, tileMapData, objectMapData, secretMapData, mapWidth, mapHeight, setBucketPreviewIndices, resizeState, moveState, objectMetadata, setObjectMetadata, setObjectMapData, setSecretMapData, setHighlightedIndex, getLinkedRoomAt, showRoomMapContent]);\n\n    const handleGridMouseUp = useCallback((index) => {\n        if (activeTool === 'area' && isDragging && dragStart && index !== null) {\n            const hx = index % mapWidth;\n            const hy = Math.floor(index / mapWidth);\n            const x1 = Math.min(dragStart.x, hx);\n            const y1 = Math.min(dragStart.y, hy);\n            const x2 = Math.max(dragStart.x, hx);\n            const y2 = Math.max(dragStart.y, hy);\n            const w = x2 - x1 + 1;\n            const h = y2 - y1 + 1;\n            const baseIndex = y1 * mapWidth + x1;\n\n            setSecretMapData(prev => {\n                const next = [...prev];\n                next[baseIndex] = 'room_area';\n                return next;\n            });\n            setObjectMetadata(prev => ({\n                ...prev,\n                [baseIndex]: { ...prev[baseIndex], width: w, height: h, roomName: 'New Room' }\n            }));\n            setHighlightedIndex(baseIndex);\n            if (setActivePanel) setActivePanel('props');\n            setIsDragging(false);\n            setDragStart(null);\n            return;\n        }\n\n        if (activeTool === 'move' && isDragging && !resizeState && !moveState && dragStart && index !== null) {\n            const hx = index % mapWidth;\n            const hy = Math.floor(index / mapWidth);\n            const x1 = Math.min(dragStart.x, hx);\n            const y1 = Math.min(dragStart.y, hy);\n            const x2 = Math.max(dragStart.x, hx);\n            const y2 = Math.max(dragStart.y, hy);\n            const w = x2 - x1 + 1;\n            const h = y2 - y1 + 1;\n\n            const tileData = [];\n            const objectData = [];\n            const secretData = [];\n            const selectionMetadata = {};\n\n            for (let y = y1; y <= y2; y++) {\n                for (let x = x1; x <= x2; x++) {\n                    const idx = y * mapWidth + x;\n                    tileData.push(tileMapData[idx]);\n                    objectData.push(objectMapData[idx]);\n                    secretData.push(secretMapData[idx]);\n                    if (objectMetadata[idx]) {\n                        selectionMetadata[`${x - x1},${y - y1}`] = { ...objectMetadata[idx] };\n                    }\n                }\n            }\n\n            setSelection({\n                x: x1, y: y1, w, h,\n                originalX: x1, originalY: y1,\n                tileData, objectData, secretData,\n                metadata: selectionMetadata\n            });\n            setPreviewPosition({ x: x1, y: y1 });\n            setOriginalMapData({\n                tileMap: [...tileMapData],\n                objectMap: [...objectMapData],\n                secretMap: [...secretMapData],\n                objectMetadata: { ...objectMetadata }\n            });\n            setDragStart(null);\n        }\n\n        setIsDragging(false);\n        setResizeState(null);\n        setMoveState(null);\n    }, [activeTool, isDragging, resizeState, moveState, dragStart, mapWidth, tileMapData, objectMapData, secretMapData, setSelection, setPreviewPosition, setOriginalMapData, setDragStart, setIsDragging]);\n\n    return {\n        hoverIndex,\n        setHoverIndex,\n        bucketPreviewIndices,\n        setBucketPreviewIndices,\n        handleGridMouseDown,\n        handleGridMouseMove,\n        handleGridMouseUp,\n        handleResizeStart,\n        handleMoveStart,\n        paintTile\n    };\n};\n","import React, { useState, useEffect, useRef, useMemo, useCallback } from 'react';\nimport { getRegistry } from '../../../engine/registry';\nimport { TILE_SIZE } from '../../../constants/gameConstants';\nimport { resizeMapData } from './editorTools/mapOperations';\nimport { loadBackgroundOptions, loadMusicOptions } from './assetLoaders';\nimport { Viewport } from './Viewport';\nimport { NewMapModal } from './editorTools/NewMapModal';\nimport { BuiltInMapsModal } from './editorTools/BuiltInMapsModal';\nimport { EditorScene } from './EditorScene';\nimport { EditorElements } from './EditorElements';\nimport { EditorTools } from './EditorTools';\nimport PixiStage from '../game/PixiStage';\nimport styled from 'styled-components';\nimport MessageOverlay from '../shared/MessageOverlay';\n\n// Custom Hooks\nimport { useEditorRegistry } from './hooks/useEditorRegistry';\nimport { useEditorSelection } from './hooks/useEditorSelection';\nimport { useEditorPlayMode } from './hooks/useEditorPlayMode';\nimport { useEditorOperations } from './hooks/useEditorOperations';\nimport { useEditorPainting } from './hooks/useEditorPainting';\nimport { useEditorMaps } from './hooks/useEditorMaps';\n\nconst EMPTY_ARRAY = [];\nconst EMPTY_OBJECT = {};\n\nconst GameOverOverlay = styled.div`\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background-color: rgba(0, 0, 0, 0.8);\n    z-index: 2500;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    color: white;\n    backdrop-filter: blur(4px);\n    animation: fadeIn 0.5s ease-out;\n\n    @keyframes fadeIn {\n        from { opacity: 0; }\n        to { opacity: 1; }\n    }\n`;\n\nconst GameOverTitle = styled.h1`\n    font-size: 72px;\n    margin: 0 0 30px 0;\n    text-transform: uppercase;\n    letter-spacing: 5px;\n    color: #ff4444;\n    text-shadow: 0 0 20px rgba(255, 0, 0, 0.5), 0 5px 15px rgba(0,0,0,0.8);\n    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n    font-weight: 900;\n`;\n\nconst ReplayButton = styled.button`\n    padding: 18px 50px;\n    font-size: 28px;\n    background: linear-gradient(180deg, #4CAF50, #2E7D32);\n    color: white;\n    border: 2px solid #fff;\n    border-radius: 50px;\n    cursor: pointer;\n    font-weight: bold;\n    box-shadow: 0 5px 15px rgba(0,0,0,0.3);\n    transition: all 0.2s ease;\n    outline: none;\n\n    &:hover {\n        background: linear-gradient(180deg, #66BB6A, #388E3C);\n        transform: scale(1.05) translateY(-2px);\n        box-shadow: 0 8px 20px rgba(0,0,0,0.4);\n    }\n\n    &:active {\n        transform: scale(0.98) translateY(0);\n    }\n`;\n\nexport const Editor = () => {\n    const registryItems = useMemo(() => getRegistry() || [], []);\n    const playerVisuals = useMemo(() => registryItems.find(item => item.id === 'player') || EMPTY_OBJECT, [registryItems]);\n\n    // Basic Map State\n    const [mapWidth, setMapWidth] = useState(20);\n    const [mapHeight, setMapHeight] = useState(15);\n    const [tileMapData, setTileMapData] = useState([]);\n    const [objectMapData, setObjectMapData] = useState([]);\n    const [secretMapData, setSecretMapData] = useState([]);\n    const [objectMetadata, setObjectMetadata] = useState({});\n    const [selectedTile, setSelectedTile] = useState(null);\n    const [showGrid, setShowGrid] = useState(true);\n    const [showBackgroundImage, setShowBackgroundImage] = useState(true);\n    const [showMessages, setShowMessages] = useState(() => {\n        try {\n            const v = localStorage.getItem('editor_show_messages');\n            if (v === null) return true;\n            return v !== '0';\n        } catch {\n            return true;\n        }\n    });\n\n    // Tools & Modes State\n    const [isDragging, setIsDragging] = useState(false);\n    const [brushSize, setBrushSize] = useState(1);\n    const [activeTool, setActiveTool] = useState('brush');\n    const [activeLayer, setActiveLayer] = useState('tile');\n    const [dragStart, setDragStart] = useState(null);\n    const [isRoomAreaVisible, setIsRoomAreaVisible] = useState(false);\n    const [showRoomMapContent, setShowRoomMapContent] = useState(false);\n    const [isWorldViewOpen, setIsWorldViewOpen] = useState(false);\n    const stateRef = useRef({ mapWidth, mapHeight, tileMapData, objectMapData, secretMapData, objectMetadata });\n\n    // Metadata State\n    const [mapName, setMapName] = useState(\"New Map\");\n    const [creatorName, setCreatorName] = useState(\"Anonymous\");\n    const [mapDescription, setMapDescription] = useState(\"\");\n    const [createdAt, setCreatedAt] = useState(null);\n    const [highlightedIndex, setHighlightedIndex] = useState(null);\n    const [isNewMapModalOpen, setIsNewMapModalOpen] = useState(false);\n    const [isBuiltInMapsModalOpen, setIsBuiltInMapsModalOpen] = useState(false);\n    const [isResizeWindowOpen, setIsResizeWindowOpen] = useState(false);\n    const [tempMapName, setTempMapName] = useState(\"\");\n    const [tempCreatorName, setTempCreatorName] = useState(\"\");\n    const [tempMapDescription, setTempMapDescription] = useState(\"\");\n    const [activePanel, setActivePanel] = useState(null);\n\n    // Asset Options\n    const backgroundOptions = useMemo(() => loadBackgroundOptions(), []);\n    const musicOptions = useMemo(() => loadMusicOptions(), []);\n\n    // Background State\n    const [selectedBackgroundImage, setSelectedBackgroundImage] = useState(null);\n    const [backgroundParallaxFactor, setBackgroundParallaxFactor] = useState(0.3);\n    const [selectedBackgroundColor, setSelectedBackgroundColor] = useState('#99C1F1');\n    const [selectedBackgroundMusic, setSelectedBackgroundMusic] = useState(null);\n\n    // Weather State\n    const [weatherRain, setWeatherRain] = useState(0);\n    const [weatherSnow, setWeatherSnow] = useState(0);\n    const [weatherClouds, setWeatherClouds] = useState(0);\n    const [weatherFog, setWeatherFog] = useState(0);\n    const [weatherThunder, setWeatherThunder] = useState(0);\n    const [weatherLavaRain, setWeatherLavaRain] = useState(0);\n    const [weatherRadioactiveFog, setWeatherRadioactiveFog] = useState(0);\n    const [weatherMeteorRain, setWeatherMeteorRain] = useState(0);\n\n    const [playerPosition, setPlayerPosition] = useState({ x: 100, y: 100 });\n\n    useEffect(() => {\n        try { localStorage.setItem('editor_show_messages', showMessages ? '1' : '0'); } catch {}\n    }, [showMessages]);\n\n    // Multi-map state\n    const { \n        maps, setMaps, activeMapId, setActiveMapId, createMap: createNewMap, updateMapData, deleteMap \n    } = useEditorMaps();\n\n    const lastActiveMapIdRef = useRef(activeMapId);\n\n    const switchMap = useCallback((newMapId, spawnTriggerId = null) => {\n        if (newMapId === activeMapId) return;\n\n        // 1. Save current map data to store\n        updateMapData(activeMapId, {\n            mapWidth, mapHeight, tileMapData, objectMapData, secretMapData, objectMetadata,\n            selectedBackgroundImage, selectedBackgroundColor,\n            backgroundParallaxFactor, selectedBackgroundMusic,\n            weatherRain, weatherSnow, weatherClouds, weatherFog, weatherThunder,\n            weatherLavaRain, weatherRadioactiveFog, weatherMeteorRain,\n            playerPosition\n        });\n\n        // 2. Load new map data\n        const nextMap = maps[newMapId];\n        if (nextMap) {\n            setMapWidth(nextMap.mapWidth);\n            setMapHeight(nextMap.mapHeight);\n            setTileMapData(nextMap.tileMapData);\n            setObjectMapData(nextMap.objectMapData);\n            setSecretMapData(nextMap.secretMapData);\n            setObjectMetadata(nextMap.objectMetadata || {});\n            setCreatedAt(nextMap.createdAt || new Date().toISOString());\n            setSelectedBackgroundImage(nextMap.selectedBackgroundImage);\n            setSelectedBackgroundColor(nextMap.selectedBackgroundColor);\n            setBackgroundParallaxFactor(nextMap.backgroundParallaxFactor || 0.3);\n            setSelectedBackgroundMusic(nextMap.selectedBackgroundMusic);\n            \n            if (nextMap.weather) {\n                setWeatherRain(nextMap.weather.rain || 0);\n                setWeatherSnow(nextMap.weather.snow || 0);\n                setWeatherClouds(nextMap.weather.clouds || 0);\n                setWeatherFog(nextMap.weather.fog || 0);\n                setWeatherThunder(nextMap.weather.thunder || 0);\n                setWeatherLavaRain(nextMap.weather.lavaRain || 0);\n                setWeatherRadioactiveFog(nextMap.weather.radioactiveFog || 0);\n                setWeatherMeteorRain(nextMap.weather.meteorRain || 0);\n            }\n            \n            if (nextMap.playerPosition) {\n                setPlayerPosition(nextMap.playerPosition);\n            }\n            \n            // If we have a spawnTriggerId, we might want to store it temporarily\n            // so useEditorPlayMode can include it in mapDataForGame.meta\n            // But actually, we can just update the map data in the store with this triggerId.\n            if (spawnTriggerId !== null) {\n                updateMapData(newMapId, { ...nextMap, spawnTriggerId });\n            }\n\n            setActiveMapId(newMapId);\n        }\n    }, [\n        activeMapId, maps, updateMapData, setActiveMapId,\n        mapWidth, mapHeight, tileMapData, objectMapData, secretMapData, objectMetadata,\n        selectedBackgroundImage, selectedBackgroundColor,\n        backgroundParallaxFactor, selectedBackgroundMusic,\n        weatherRain, weatherSnow, weatherClouds, weatherFog, weatherThunder,\n        weatherLavaRain, weatherRadioactiveFog, weatherMeteorRain,\n        playerPosition\n    ]);\n\n    const handleCreateMap = useCallback((type, name, width, height) => {\n        const finalName = name || prompt(`Enter ${type} map name:`, `New ${type.charAt(0).toUpperCase() + type.slice(1)}`);\n        if (finalName) {\n            const finalWidth = width || mapWidth;\n            const finalHeight = height || mapHeight;\n            const newId = createNewMap(type, finalName, finalWidth, finalHeight);\n            return newId;\n        }\n    }, [createNewMap, mapWidth, mapHeight]);\n\n    // Update store when current map data changes (for minimap preview)\n    useEffect(() => {\n        // Skip update if activeMapId just changed to prevent overwriting new map data with old map state\n        if (lastActiveMapIdRef.current !== activeMapId) {\n            lastActiveMapIdRef.current = activeMapId;\n            return;\n        }\n\n        const timeout = setTimeout(() => {\n            updateMapData(activeMapId, {\n                mapWidth, mapHeight, tileMapData, objectMapData, secretMapData, objectMetadata,\n                selectedBackgroundImage, selectedBackgroundColor,\n                selectedBackgroundMusic, backgroundParallaxFactor,\n                weather: {\n                    rain: weatherRain,\n                    snow: weatherSnow,\n                    clouds: weatherClouds,\n                    fog: weatherFog,\n                    thunder: weatherThunder,\n                    lavaRain: weatherLavaRain,\n                    radioactiveFog: weatherRadioactiveFog,\n                    meteorRain: weatherMeteorRain\n                },\n                playerPosition\n            });\n        }, 1000); // Debounce store updates\n        return () => clearTimeout(timeout);\n    }, [\n        activeMapId, updateMapData, mapWidth, mapHeight, tileMapData, objectMapData, secretMapData, objectMetadata, \n        selectedBackgroundImage, selectedBackgroundColor, selectedBackgroundMusic, backgroundParallaxFactor,\n        weatherRain, weatherSnow, weatherClouds, weatherFog, weatherThunder, weatherLavaRain, weatherRadioactiveFog, weatherMeteorRain,\n        playerPosition\n    ]);\n\n    const selectedBgOption = backgroundOptions.find((bg) => bg.metaPath === selectedBackgroundImage) || backgroundOptions[0];\n    const selectedBackgroundUrl = selectedBgOption && selectedBackgroundImage ? selectedBgOption.src : null;\n\n    // Use Custom Hooks\n    const { \n        blocks, liquids, entities, decorations, items, interactables, hazards, secrets, weather, messages, crackableWalls, pushableWalls, obstacles \n    } = useEditorRegistry(registryItems);\n\n    const { \n        selection, setSelection, selectionMode, setSelectionMode, previewPosition, setPreviewPosition,\n        originalMapData, setOriginalMapData, moveSelection, commitSelection, cancelSelection \n    } = useEditorSelection(mapWidth, mapHeight, tileMapData, objectMapData, secretMapData, objectMetadata, setTileMapData, setObjectMapData, setSecretMapData, setObjectMetadata);\n\n    const {\n        isPlayMode, handlePlay, handlePause, handleReset, handleReplay, handleStateUpdate, handleForceStop,\n        playModeObjectData, playModeSecretData, playModeWeather, playModeMaps, gameMessage, revealedSecrets, \n        activeRoomIds, gameEngineState, isGameOver\n    } = useEditorPlayMode(\n        mapWidth, mapHeight, tileMapData, objectMapData, secretMapData, objectMetadata, \n        selectedBackgroundImage, selectedBackgroundColor, backgroundParallaxFactor, \n        registryItems, playerPosition, setPlayerPosition, setObjectMetadata,\n        weatherRain, weatherSnow, weatherClouds, weatherFog, weatherThunder,\n        weatherLavaRain, weatherRadioactiveFog, weatherMeteorRain,\n        maps, activeMapId, switchMap, maps[activeMapId]?.spawnTriggerId,\n        setTileMapData, updateMapData\n    );\n\n    const {\n        handleSaveMap, handleLoadMap, handleLoadBuiltInMap, handleClearMap, openNewMapModal, confirmNewMap\n    } = useEditorOperations(\n        mapWidth, mapHeight, tileMapData, objectMapData, secretMapData, objectMetadata,\n        mapName, creatorName, mapDescription, createdAt, selectedBackgroundImage, selectedBackgroundColor,\n        backgroundParallaxFactor, selectedBackgroundMusic, playerPosition, registryItems, setCreatedAt,\n        setMapWidth, setMapHeight, setMapName, setCreatorName, setMapDescription,\n        setSelectedBackgroundImage, setSelectedBackgroundColor,\n        setBackgroundParallaxFactor, setSelectedBackgroundMusic, setPlayerPosition,\n        setTileMapData, setObjectMapData, setSecretMapData, setObjectMetadata,\n        setIsNewMapModalOpen, setTempMapName, setTempCreatorName, setTempMapDescription,\n        weatherRain, weatherSnow, weatherClouds, weatherFog, weatherThunder,\n        weatherLavaRain, weatherRadioactiveFog, weatherMeteorRain,\n        setWeatherRain, setWeatherSnow, setWeatherClouds, setWeatherFog, setWeatherThunder,\n        setWeatherLavaRain, setWeatherRadioactiveFog, setWeatherMeteorRain,\n        maps, setMaps, activeMapId, setActiveMapId\n    );\n\n    const handleLoadMapWrapped = useCallback((event) => {\n        if (isPlayMode) {\n            handleForceStop();\n        }\n        handleLoadMap(event);\n    }, [isPlayMode, handleForceStop, handleLoadMap]);\n\n    const handleLoadBuiltInMapWrapped = useCallback((mapData) => {\n        if (isPlayMode) {\n            handleForceStop();\n        }\n        handleLoadBuiltInMap(mapData);\n    }, [isPlayMode, handleForceStop, handleLoadBuiltInMap]);\n\n    const {\n        hoverIndex, setHoverIndex, bucketPreviewIndices, setBucketPreviewIndices,\n        handleGridMouseDown, handleGridMouseMove, handleGridMouseUp,\n        handleResizeStart, handleMoveStart, paintTile\n    } = useEditorPainting(\n        mapWidth, mapHeight, tileMapData, objectMapData, secretMapData, \n        setTileMapData, setObjectMapData, setSecretMapData,\n        activeTool, brushSize, activeLayer, selectedTile, selection, \n        setSelection, setPreviewPosition, setOriginalMapData, dragStart, setDragStart, isDragging, setIsDragging,\n        setActivePanel, setHighlightedIndex, highlightedIndex, registryItems,\n        objectMetadata, setObjectMetadata,\n        maps, activeMapId, showRoomMapContent, isRoomAreaVisible, updateMapData\n    );\n\n    // Side Effects\n    useEffect(() => {\n        stateRef.current = { mapWidth, mapHeight, tileMapData, objectMapData, secretMapData, objectMetadata };\n    }, [mapWidth, mapHeight, tileMapData, objectMapData, secretMapData, objectMetadata]);\n\n    useEffect(() => {\n        const size = 15 * 20;\n        setTileMapData(Array(size).fill(null));\n        setObjectMapData(Array(size).fill(null));\n        setSecretMapData(Array(size).fill(null));\n    }, []);\n\n    const togglePanel = (panel) => {\n        setActivePanel(prev => prev === panel ? null : panel);\n    };\n\n    const handleMapResize = (newWidth, newHeight) => {\n        if (newWidth === mapWidth && newHeight === mapHeight) return;\n        resizeMapData({\n            newWidth, newHeight, stateRef, setMapWidth, setMapHeight,\n            setTileMapData, setObjectMapData, setSecretMapData, setObjectMetadata\n        });\n    };\n\n    const handlePaletteSelect = useCallback((item, layer) => {\n        setSelectedTile(item);\n        setActiveLayer(layer);\n        setActiveTool('brush');\n        setSelection(null);\n    }, []);\n\n    // Grid Event Handlers\n    \n    const handleGridMouseLeave = useCallback(() => {\n        setHoverIndex(null);\n        setBucketPreviewIndices(new Set());\n    }, [setHoverIndex, setBucketPreviewIndices]);\n\n    const totalTiles = mapWidth * mapHeight;\n    const filledBlocks = tileMapData.filter(t => t !== null).length;\n    const emptyBlocks = totalTiles - filledBlocks;\n    const objectsCount = objectMapData.filter(o => o !== null).length;\n\n    const onAddRoomArea = useCallback(() => {\n        setIsWorldViewOpen(false);\n        setActiveTool('area');\n        setActiveLayer('secret');\n    }, []);\n\n    const handleDeleteMap = useCallback((id) => {\n        if (id === activeMapId) {\n            switchMap('main');\n        }\n        deleteMap(id);\n    }, [activeMapId, switchMap, deleteMap]);\n\n    return (\n        <div className=\"editor-wrapper\" style={{ position: 'relative', height: '100%', overflow: 'hidden', display: 'flex', flexDirection: 'column' }}>\n            <NewMapModal \n                isOpen={isNewMapModalOpen}\n                tempMapName={tempMapName}\n                setTempMapName={setTempMapName}\n                tempCreatorName={tempCreatorName}\n                setTempCreatorName={setTempCreatorName}\n                tempMapDescription={tempMapDescription}\n                setTempMapDescription={setTempMapDescription}\n                confirmNewMap={confirmNewMap}\n                onClose={() => setIsNewMapModalOpen(false)}\n            />\n\n            <BuiltInMapsModal \n                isOpen={isBuiltInMapsModalOpen}\n                onClose={() => setIsBuiltInMapsModalOpen(false)}\n                onSelect={handleLoadBuiltInMapWrapped}\n            />\n\n            <div className=\"editor-container\" style={{\n                display: 'flex', flex: 1, flexDirection: 'row',\n                filter: (isNewMapModalOpen || isBuiltInMapsModalOpen) ? 'blur(4px) brightness(0.7)' : 'none',\n                transition: 'filter 0.2s ease',\n                pointerEvents: (isNewMapModalOpen || isBuiltInMapsModalOpen) ? 'none' : 'auto',\n                overflow: 'hidden'\n            }}>\n                <EditorElements \n                    mapName={mapName}\n                    creatorName={creatorName}\n                    mapDescription={mapDescription}\n                    setMapName={setMapName}\n                    setCreatorName={setCreatorName}\n                    setMapDescription={setMapDescription}\n                    openNewMapModal={openNewMapModal}\n                    openBuiltInModal={() => setIsBuiltInMapsModalOpen(true)}\n                    saveMap={handleSaveMap}\n                    loadMap={handleLoadMapWrapped}\n                    clearMap={handleClearMap}\n                    isPlayMode={isPlayMode}\n                    handlePaletteSelect={handlePaletteSelect}\n                    selectedTile={selectedTile}\n                    blocks={blocks}\n                    liquids={liquids}\n                    entities={entities}\n                    items={items}\n                    decorations={decorations}\n                    interactables={interactables}\n                    hazards={hazards}\n                    secrets={secrets}\n                    weather={weather}\n                    messages={messages}\n                    crackableWalls={crackableWalls}\n                    pushableWalls={pushableWalls}\n                    obstacles={obstacles}\n                    totalTiles={totalTiles}\n                    filledBlocks={filledBlocks}\n                    emptyBlocks={emptyBlocks}\n                    objectsCount={objectsCount}\n                    mapWidth={mapWidth}\n                    mapHeight={mapHeight}\n                    objectMapData={objectMapData}\n                    secretMapData={secretMapData}\n                    objectMetadata={objectMetadata}\n                    setObjectMetadata={setObjectMetadata}\n                    registryItems={registryItems}\n                    highlightedIndex={highlightedIndex}\n                    setHighlightedIndex={setHighlightedIndex}\n                    activePanel={activePanel}\n                    setActivePanel={setActivePanel}\n                    togglePanel={togglePanel}\n                    maps={maps}\n                    activeMapId={activeMapId}\n                    createMap={handleCreateMap}\n                />\n\n                <div style={{ display: 'flex', flex: 1, flexDirection: 'column', overflow: 'hidden' }}>\n                    <EditorTools\n                        mapName={mapName}\n                        creatorName={creatorName}\n                        activePanel={activePanel}\n                        togglePanel={togglePanel}\n                        showGrid={showGrid}\n                        setShowGrid={setShowGrid}\n                        isPlayMode={isPlayMode}\n                        handlePlay={handlePlay}\n                        handlePause={handlePause}\n                        handleReset={handleReset}\n                        activeTool={activeTool}\n                        setActiveTool={setActiveTool}\n                        brushSize={brushSize}\n                        setBrushSize={setBrushSize}\n                        activeLayer={activeLayer}\n                        selection={selection}\n                        moveSelection={moveSelection}\n                        selectionMode={selectionMode}\n                        setSelectionMode={setSelectionMode}\n                        commitSelection={commitSelection}\n                        cancelSelection={cancelSelection}\n                        selectedTile={selectedTile}\n                        handlePaletteSelect={handlePaletteSelect}\n                        selectedBackgroundColor={selectedBackgroundColor}\n                        setSelectedBackgroundColor={setSelectedBackgroundColor}\n                        showBackgroundImage={showBackgroundImage}\n                        setShowBackgroundImage={setShowBackgroundImage}\n                        showMessages={showMessages}\n                        setShowMessages={setShowMessages}\n                        isRoomAreaVisible={isRoomAreaVisible}\n                        setIsRoomAreaVisible={setIsRoomAreaVisible}\n                        showRoomMapContent={showRoomMapContent}\n                        setShowRoomMapContent={setShowRoomMapContent}\n                    />\n                    \n                    <div style={{ display: 'flex', flex: 1, flexDirection: 'row', overflow: 'hidden', position: 'relative' }}>\n\n                    <EditorScene \n                        handleMapResize={handleMapResize}\n                        isResizeWindowOpen={isResizeWindowOpen}\n                        setIsResizeWindowOpen={setIsResizeWindowOpen}\n                        isWorldViewOpen={isWorldViewOpen}\n                        setIsWorldViewOpen={setIsWorldViewOpen}\n                        onAddRoomArea={onAddRoomArea}\n                        mapWidth={mapWidth}\n                        mapHeight={mapHeight}\n                        tileMapData={tileMapData}\n                        objectMapData={objectMapData}\n                        objectMetadata={objectMetadata}\n                        registryItems={registryItems}\n                        backgroundOptions={backgroundOptions}\n                        selectedBackgroundImage={selectedBackgroundImage}\n                        setSelectedBackgroundImage={setSelectedBackgroundImage}\n                        selectedBackgroundColor={selectedBackgroundColor}\n                        setSelectedBackgroundColor={setSelectedBackgroundColor}\n                        backgroundParallaxFactor={backgroundParallaxFactor}\n                        setBackgroundParallaxFactor={setBackgroundParallaxFactor}\n                        musicOptions={musicOptions}\n                        selectedBackgroundMusic={selectedBackgroundMusic}\n                        setSelectedBackgroundMusic={setSelectedBackgroundMusic}\n                        weatherRain={weatherRain}\n                        setWeatherRain={setWeatherRain}\n                        weatherSnow={weatherSnow}\n                        setWeatherSnow={setWeatherSnow}\n                        weatherClouds={weatherClouds}\n                        setWeatherClouds={setWeatherClouds}\n                        weatherFog={weatherFog}\n                        setWeatherFog={setWeatherFog}\n                        weatherThunder={weatherThunder}\n                        setWeatherThunder={setWeatherThunder}\n                        weatherLavaRain={weatherLavaRain}\n                        setWeatherLavaRain={setWeatherLavaRain}\n                        weatherRadioactiveFog={weatherRadioactiveFog}\n                        setWeatherRadioactiveFog={setWeatherRadioactiveFog}\n                        weatherMeteorRain={weatherMeteorRain}\n                        setWeatherMeteorRain={setWeatherMeteorRain}\n                        // Multi-map props\n                        maps={maps}\n                        activeMapId={activeMapId}\n                        switchMap={switchMap}\n                        createMap={handleCreateMap}\n                        deleteMap={handleDeleteMap}\n                        updateMapData={updateMapData}\n                        showRoomMapContent={showRoomMapContent}\n                        activeRoomIds={activeRoomIds}\n                    />\n\n                    {!isPlayMode ? (\n                        <Viewport\n                            mapWidth={mapWidth}\n                            mapHeight={mapHeight}\n                            selectedBackgroundUrl={selectedBackgroundUrl}\n                            selectedBackgroundColor={selectedBackgroundColor}\n                            selectedBackgroundImage={selectedBackgroundImage}\n                            showBackgroundImage={showBackgroundImage}\n                            showGrid={showGrid}\n                            activeLayer={activeLayer}\n                            activeTool={activeTool}\n                            tileMapData={tileMapData}\n                            objectMapData={objectMapData}\n                            secretMapData={secretMapData}\n                            objectMetadata={objectMetadata}\n                            registryItems={registryItems}\n                            hoverIndex={hoverIndex}\n                            highlightedIndex={highlightedIndex}\n                            brushSize={brushSize}\n                            bucketPreviewIndices={bucketPreviewIndices}\n                            selection={selection}\n                            previewPosition={previewPosition}\n                            dragStart={dragStart}\n                            isDragging={isDragging}\n                            handleGridMouseDown={handleGridMouseDown}\n                            handleGridMouseEnter={handleGridMouseMove}\n                            handleGridMouseUp={handleGridMouseUp}\n                            handleGridMouseLeave={handleGridMouseLeave}\n                            handleResizeStart={handleResizeStart}\n                            handleMoveStart={handleMoveStart}\n                            setIsDragging={setIsDragging}\n                            weatherRain={weatherRain}\n                            weatherSnow={weatherSnow}\n                            weatherClouds={weatherClouds}\n                            weatherFog={weatherFog}\n                            weatherThunder={weatherThunder}\n                            weatherLavaRain={weatherLavaRain}\n                            weatherRadioactiveFog={weatherRadioactiveFog}\n                            weatherMeteorRain={weatherMeteorRain}\n                            mapType={maps[activeMapId]?.type || 'overworld'}\n                            isRoomAreaVisible={isRoomAreaVisible}\n                            showRoomMapContent={showRoomMapContent}\n                            showMessages={showMessages}\n                            maps={maps}\n                        />\n                    ) : (\n                        <div style={{ flex: 1, position: 'relative', backgroundColor: '#000' }}>\n                            <PixiStage\n                                mapWidth={mapWidth}\n                                mapHeight={mapHeight}\n                                tileSize={TILE_SIZE}\n                                tileMapData={tileMapData}\n                                objectMapData={playModeObjectData}\n                                secretMapData={playModeSecretData}\n                                revealedSecrets={revealedSecrets || []}\n                                registryItems={registryItems}\n                                playerState={gameEngineState}\n                                playerVisuals={playerVisuals}\n                                projectiles={gameEngineState?.projectiles || []}\n                                objectMetadata={objectMetadata}\n                                backgroundImage={showBackgroundImage ? selectedBackgroundImage : null}\n                                backgroundColor={selectedBackgroundColor}\n                                backgroundParallaxFactor={backgroundParallaxFactor}\n                                weatherRain={playModeWeather.rain}\n                                weatherLavaRain={playModeWeather.lavaRain}\n                                weatherSnow={playModeWeather.snow}\n                                weatherMeteorRain={playModeWeather.meteorRain}\n                                weatherClouds={playModeWeather.clouds}\n                                weatherFog={playModeWeather.fog}\n                                weatherRadioactiveFog={playModeWeather.radioactiveFog}\n                                weatherThunder={playModeWeather.thunder}\n                                onWeatherEffectHit={(type, data) => handleStateUpdate('weatherEffectHit', { type, data })}\n                                isEditor={false}\n                                isEditorPlayMode={true}\n                                showGrid={showGrid}\n                            mapType={(playModeMaps?.[activeMapId]?.type || maps[activeMapId]?.type) || 'overworld'}\n                            activeRoomIds={activeRoomIds}\n                            maps={playModeMaps || maps}\n                        />\n                            {isGameOver && (\n                                <GameOverOverlay>\n                                    <GameOverTitle>Game Over</GameOverTitle>\n                                    <ReplayButton onClick={handleReplay}>\n                                        REPLAY \n                                    </ReplayButton>\n                                </GameOverOverlay>\n                            )}\n                            <MessageOverlay text={gameMessage.text} isVisible={gameMessage.isVisible} />\n                        </div>\n                    )}\n                </div>\n            </div>\n        </div>\n    </div>\n);\n};\n","export const loadBackgroundOptions = () => {\n    const bgContext = require.context('../../../assets/background', false, /\\.(png|jpe?g|svg|webp)$/i);\n    return bgContext.keys().map((key) => {\n        const mod = bgContext(key);\n        const url = mod.default || mod;\n        const name = key.replace('./', '');\n        return { key, name, src: url, metaPath: `/assets/background/${name}` };\n    });\n};\n\nexport const loadMusicOptions = () => {\n    const musicContext = require.context('../../../assets/sound/background', false, /\\.(ogg|mp3|wav|m4a)$/i);\n    return musicContext.keys().map((key) => {\n        const mod = musicContext(key);\n        const name = key.replace('./', '');\n        return { key, name, src: (mod.default || mod), metaPath: `/assets/sound/background/${name}` };\n    });\n};\n","import { useState, useCallback } from 'react';\n\nexport const useEditorMaps = () => {\n    const [maps, setMaps] = useState({\n        'main': {\n            id: 'main',\n            name: 'Main',\n            description: '',\n            type: 'overworld',\n            mapWidth: 20,\n            mapHeight: 15,\n            tileMapData: Array(20 * 15).fill(null),\n            objectMapData: Array(20 * 15).fill(null),\n            secretMapData: Array(20 * 15).fill(null),\n            objectMetadata: {},\n            selectedBackgroundImage: null,\n            selectedBackgroundColor: '#99C1F1',\n            backgroundParallaxFactor: 0.3,\n            selectedBackgroundMusic: null,\n            weather: {\n                rain: 0,\n                snow: 0,\n                clouds: 0,\n                fog: 0,\n                thunder: 0,\n                lavaRain: 0,\n                radioactiveFog: 0,\n                meteorRain: 0\n            },\n            playerPosition: { x: 100, y: 100 },\n            worldX: 50,\n            worldY: 50\n        }\n    });\n    const [activeMapId, setActiveMapId] = useState('main');\n\n    const createMap = useCallback((type, name, width = 20, height = 15) => {\n        const id = `map_${Date.now()}`;\n        \n        // Find a good spot for new map\n        const existingMaps = Object.values(maps);\n        const maxY = Math.max(...existingMaps.map(m => m.worldY || 0), 0);\n        \n        const newMap = {\n            id,\n            name: name || (type === 'overworld' ? 'New Overworld' : 'New Underworld'),\n            description: '',\n            type,\n            mapWidth: width,\n            mapHeight: height,\n            tileMapData: Array(width * height).fill(null),\n            objectMapData: Array(width * height).fill(null),\n            secretMapData: Array(width * height).fill(null),\n            objectMetadata: {},\n            selectedBackgroundImage: null,\n            selectedBackgroundColor: type === 'overworld' ? '#99C1F1' : '#1a1a1a',\n            backgroundParallaxFactor: 0.3,\n            selectedBackgroundMusic: null,\n            weather: {\n                rain: 0,\n                snow: 0,\n                clouds: 0,\n                fog: 0,\n                thunder: 0,\n                lavaRain: 0,\n                radioactiveFog: 0,\n                meteorRain: 0\n            },\n            playerPosition: null, // Only one map should have player eventually\n            worldX: 50,\n            worldY: maxY + 150\n        };\n\n        setMaps(prev => ({\n            ...prev,\n            [id]: newMap\n        }));\n        return id;\n    }, []);\n\n    const updateMapData = useCallback((id, data) => {\n        setMaps(prev => ({\n            ...prev,\n            [id]: {\n                ...prev[id],\n                ...data\n            }\n        }));\n    }, []);\n\n    const deleteMap = useCallback((id) => {\n        if (id === 'main') return; // Cannot delete main map\n        setMaps(prev => {\n            const newMaps = { ...prev };\n            delete newMaps[id];\n            return newMaps;\n        });\n        if (activeMapId === id) {\n            setActiveMapId('main');\n        }\n    }, [activeMapId]);\n\n    return {\n        maps,\n        setMaps,\n        activeMapId,\n        setActiveMapId,\n        createMap,\n        updateMapData,\n        deleteMap\n    };\n};\n","import { useMemo } from 'react';\n\nexport const useEditorRegistry = (registryItems) => {\n    const blocks = useMemo(() => \n        registryItems.filter(item => {\n            if (!item.name || !item.name.startsWith('block.')) return false;\n            if (item.flags && item.flags.liquid) return false;\n            if (item.editor && item.editor.panel && item.editor.panel !== 'blocks') return false;\n            return true;\n        }), \n    [registryItems]);\n\n    const liquids = useMemo(() => \n        registryItems.filter(item => item.flags && item.flags.liquid), \n    [registryItems]);\n\n    const entities = useMemo(() => {\n        const baseEntities = registryItems.filter(item => {\n            if (!item.name || !item.name.toLowerCase().includes('entities.')) return false;\n            if (item.isHiddenInEditor) return false;\n            return !item.type || item.type === 'default' || item.type === 'entity' || item.subtype === 'tank';\n        });\n\n        const itemsToMove = registryItems.filter(item => \n            item.name && \n            item.name.startsWith('item.') && \n            item.id !== 'hertz_item' && \n            item.id !== 'fireball_ammo'\n        );\n\n        return [...baseEntities, ...itemsToMove];\n    }, [registryItems]);\n\n    const decorations = useMemo(() => \n        registryItems.filter(item => {\n            if (item.type === 'decoration') return true;\n            if (item.name && item.name.toLowerCase().includes('decoration.')) return true;\n            if (item.id && item.id.includes('stone_pack')) return true;\n            return false;\n        }), \n    [registryItems]);\n\n    const items = useMemo(() => \n        registryItems.filter(item => \n            item.name && \n            item.name.startsWith('item.') && \n            (item.id === 'hertz_item' || item.id === 'fireball_ammo')\n        ), \n    [registryItems]);\n\n    const interactables = useMemo(() => \n        registryItems.filter(item => {\n            if (item.editor && item.editor.panel) return item.editor.panel === 'interactables';\n            return item.type === 'interactable' || (item.name && item.name.startsWith('interactable.'));\n        }), \n    [registryItems]);\n\n    const hazards = useMemo(() => \n        registryItems.filter(item => item.type === 'hazard' || (item.name && item.name.startsWith('hazard.'))), \n    [registryItems]);\n\n    const secrets = useMemo(() => \n        registryItems.filter(item => item.type === 'secret'), \n    [registryItems]);\n\n    const weather = useMemo(() => \n        registryItems.filter(item => item.type === 'weather_trigger'), \n    [registryItems]);\n\n    const messages = useMemo(() => \n        registryItems.filter(item => item.type === 'message_trigger'), \n    [registryItems]);\n\n    const crackableWalls = useMemo(() => \n        registryItems.filter(item => item.type === 'crack_block'),\n    [registryItems]);\n\n    const pushableWalls = useMemo(() => \n        registryItems.filter(item => item.type === 'wolf_secret'),\n    [registryItems]);\n\n    const obstacles = useMemo(() => \n        registryItems.filter(item => item.type === 'obstacle' || (item.name && item.name.startsWith('obstacle.'))), \n    [registryItems]);\n\n    return {\n        blocks,\n        liquids,\n        entities,\n        decorations,\n        items,\n        interactables,\n        hazards,\n        secrets,\n        weather,\n        messages,\n        crackableWalls,\n        pushableWalls,\n        obstacles\n    };\n};\n","import { useState, useEffect, useCallback } from 'react';\n\nexport const useEditorSelection = (mapWidth, mapHeight, tileMapData, objectMapData, secretMapData, objectMetadata, setTileMapData, setObjectMapData, setSecretMapData, setObjectMetadata) => {\n    const [selection, setSelection] = useState(null);\n    const [selectionMode, setSelectionMode] = useState('cut'); // 'cut' or 'copy'\n    const [previewPosition, setPreviewPosition] = useState(null);\n    const [originalMapData, setOriginalMapData] = useState(null);\n\n    const moveSelection = useCallback((dx, dy) => {\n        if (!selection || !previewPosition) return;\n        setPreviewPosition({ \n            x: previewPosition.x + dx, \n            y: previewPosition.y + dy \n        });\n    }, [selection, previewPosition]);\n\n    const cancelSelection = useCallback(() => {\n        setSelection(null);\n        setPreviewPosition(null);\n        setOriginalMapData(null);\n    }, []);\n\n    const commitSelection = useCallback(() => {\n        if (!selection || !previewPosition || !originalMapData) return;\n\n        const newTileMap = [...originalMapData.tileMap];\n        const newObjectMap = [...originalMapData.objectMap];\n        const newSecretMap = [...originalMapData.secretMap];\n        const newObjectMetadata = { ...originalMapData.objectMetadata };\n\n        // If cut mode, clear original position\n        if (selectionMode === 'cut') {\n            for (let py = 0; py < selection.h; py++) {\n                for (let px = 0; px < selection.w; px++) {\n                    const idx = (selection.originalY + py) * mapWidth + (selection.originalX + px);\n                    if (idx >= 0 && idx < newTileMap.length) {\n                        newTileMap[idx] = null;\n                        newObjectMap[idx] = null;\n                        newSecretMap[idx] = null;\n                        delete newObjectMetadata[idx];\n                    }\n                }\n            }\n        }\n\n        // Place selection at new position\n        for (let py = 0; py < selection.h; py++) {\n            for (let px = 0; px < selection.w; px++) {\n                const destX = previewPosition.x + px;\n                const destY = previewPosition.y + py;\n                if (destX >= 0 && destX < mapWidth && destY >= 0 && destY < mapHeight) {\n                    const destIdx = destY * mapWidth + destX;\n                    const srcDataIdx = py * selection.w + px;\n\n                    newTileMap[destIdx] = selection.tileData[srcDataIdx];\n                    newObjectMap[destIdx] = selection.objectData[srcDataIdx];\n                    newSecretMap[destIdx] = selection.secretData?.[srcDataIdx] || null;\n                    \n                    if (selection.metadata && selection.metadata[`${px},${py}`]) {\n                        newObjectMetadata[destIdx] = { ...selection.metadata[`${px},${py}`] };\n                    }\n                }\n            }\n        }\n\n        setTileMapData(newTileMap);\n        setObjectMapData(newObjectMap);\n        setSecretMapData(newSecretMap);\n        setObjectMetadata(newObjectMetadata);\n        setSelection(null);\n        setPreviewPosition(null);\n        setOriginalMapData(null);\n    }, [selection, previewPosition, originalMapData, selectionMode, mapWidth, mapHeight, setTileMapData, setObjectMapData, setSecretMapData, setObjectMetadata]);\n\n    // Keyboard handler for Enter (commit) and Escape (cancel)\n    useEffect(() => {\n        const handleKeyDown = (e) => {\n            if (selection) {\n                if (e.key === 'Enter') {\n                    e.preventDefault();\n                    commitSelection();\n                } else if (e.key === 'Escape') {\n                    e.preventDefault();\n                    cancelSelection();\n                }\n            }\n        };\n\n        window.addEventListener('keydown', handleKeyDown);\n        return () => window.removeEventListener('keydown', handleKeyDown);\n    }, [selection, previewPosition, originalMapData, selectionMode, commitSelection, cancelSelection]);\n\n    return {\n        selection,\n        setSelection,\n        selectionMode,\n        setSelectionMode,\n        previewPosition,\n        setPreviewPosition,\n        originalMapData,\n        setOriginalMapData,\n        moveSelection,\n        commitSelection,\n        cancelSelection\n    };\n};\n","\n\nexport default function Crystals() {\n\n    return (\n        <>\n            <p>Crystals</p>\n        </>\n    )\n}","import React, { useState, useEffect } from 'react';\nimport { getRegistry } from '../../engine/registry';\nimport AnimatedItem from '../../utilities/AnimatedItem';\n\nexport default function Repository() {\n    const registryItems = getRegistry();\n\n    // Container style for grid layout\n    const containerStyle = {\n        display: 'flex',\n        flexWrap: 'wrap',\n        gap: '20px',\n        padding: '20px'\n    };\n\n    // Style for each card\n    const cardStyle = {\n        border: '1px solid #ccc',\n        borderRadius: '8px',\n        padding: '10px',\n        width: '200px',\n        display: 'flex',\n        flexDirection: 'column',\n        alignItems: 'center',\n        backgroundColor: '#f9f9f9'\n    };\n\n    // Image style (64x64)\n    const imageStyle = {\n        width: '64px',\n        height: '64px',\n        objectFit: 'contain', // Prevent image stretching if proportions aren't perfect\n        imageRendering: 'pixelated', // Important for pixel graphics (2D games)\n        marginBottom: '10px',\n        border: '1px dashed #aaa'\n    };\n\n    const fieldsContainerStyle = {\n        width: '100%',\n        fontSize: '12px',\n        textAlign: 'left'\n    };\n\n    return (\n        <div style={containerStyle}>\n            {registryItems.map((item, index) => (\n                <div key={item.id || index} style={cardStyle}>\n                    \n                    {/* Choose: Animation or Static image */}\n                    {item.textures && item.textures.length > 0 ? (\n                        <AnimatedItem\n                            textures={item.textures}\n                            texture={item.texture}\n                            speed={item.animationSpeed}\n                            style={imageStyle}\n                            alt={item.name}\n                        />\n                    ) : (\n                        <img \n                            src={item.texture} \n                            alt={item.name} \n                            style={imageStyle}\n                            onError={(e) => { e.target.style.display = 'none'; }} \n                        />\n                    )}\n\n                    {/* Filter out 'texture', 'textures', and 'animationSpeed' from text list */}\n                    <div style={fieldsContainerStyle}>\n                        {Object.entries(item)\n                            .filter(([key]) => !['texture', 'textures', 'animationSpeed'].includes(key))\n                            .map(([key, value]) => (\n                                <div key={key} style={{ marginBottom: '4px', wordBreak: 'break-all' }}>\n                                    <strong>{key}:</strong> \n                                    <span style={{ marginLeft: '5px', color: '#555' }}>\n                                        {typeof value === 'object' ? JSON.stringify(value) : String(value)}\n                                    </span>\n                                </div>\n                        ))}\n                    </div>\n                </div>\n            ))}\n            \n            {registryItems.length === 0 && <p>No items found in registry.</p>}\n        </div>\n    );\n}","import React from 'react'\nimport ReactDOM from 'react-dom/client'\nimport { BrowserRouter, Routes, Route } from \"react-router-dom\"\nimport { Provider } from 'react-redux'\nimport { ThemeProvider } from 'styled-components'\nimport store from './store'\nimport theme from './styles/theme'\nimport GlobalStyles from './styles/GlobalStyles'\nimport './i18n/i18n'\nimport './index.css'\nimport App from './App'\nimport Home from \"./sections/chapters/home\"\nimport Game from \"./sections/chapters/game\"\nimport {Editor} from \"./sections/chapters/editor/Editor\"\nimport Crystals from \"./sections/chapters/crystals\"\nimport Repository from \"./sections/chapters/repository\"\n\nconst root = ReactDOM.createRoot(document.getElementById('root'))\nroot.render(\n    <Provider store={store}>\n        <ThemeProvider theme={theme}>\n            <GlobalStyles />\n            <BrowserRouter basename={process.env.PUBLIC_URL}>\n                <Routes>\n\n                <Route path=\"/\" element={<App />}>\n                    <Route index element={<Home />} />\n                    <Route path=\"game\" element={<Game />} />\n                    <Route path=\"editor\" element={<Editor />} />\n                    <Route path=\"crystals\" element={<Crystals />} />\n                    <Route path=\"repository\" element={<Repository />} />\n                </Route>\n\n                </Routes>\n            </BrowserRouter>\n        </ThemeProvider>\n    </Provider>\n)\n","var map = {\n\t\"./background/170515__rolandasb__forest_ambient_01_loop.ogg\": 344,\n\t\"./background/830253__nicktayloe__afternoon-woods-in-october-midwest-us-loop.ogg\": 3004,\n\t\"./sfx/zzox-fx_nite-hit-item.ogg\": 9750,\n\t\"./sfx/zzox-fx_sling-selector.ogg\": 7973\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 6431;","var map = {\n\t\"./blocks/brick_block_0001.json\": 544,\n\t\"./blocks/desert_block_0001.json\": 6918,\n\t\"./blocks/desert_block_0002.json\": 8359,\n\t\"./blocks/desert_block_0003.json\": 324,\n\t\"./blocks/desert_block_0004.json\": 2149,\n\t\"./blocks/desert_block_0005.json\": 5418,\n\t\"./blocks/desert_block_0006.json\": 5531,\n\t\"./blocks/desert_block_0007.json\": 4136,\n\t\"./blocks/desert_block_0008.json\": 329,\n\t\"./blocks/desert_block_0009.json\": 9518,\n\t\"./blocks/diorite_block.json\": 3929,\n\t\"./blocks/dirt_block_0001.json\": 3462,\n\t\"./blocks/dirt_block_0002.json\": 5655,\n\t\"./blocks/dirt_block_0003.json\": 4932,\n\t\"./blocks/dirt_block_0004.json\": 5653,\n\t\"./blocks/dirt_block_0005.json\": 8970,\n\t\"./blocks/dirt_block_0006.json\": 2251,\n\t\"./blocks/grass_block_0001.json\": 7865,\n\t\"./blocks/hazard/death_block_0001.json\": 698,\n\t\"./blocks/liquids/lava_block.json\": 9649,\n\t\"./blocks/liquids/lava_waterfall_block.json\": 9104,\n\t\"./blocks/liquids/quicksand_block.json\": 1924,\n\t\"./blocks/liquids/radioactive_water_block.json\": 1408,\n\t\"./blocks/liquids/radioactive_waterfall_block.json\": 8317,\n\t\"./blocks/liquids/water_block.json\": 8606,\n\t\"./blocks/liquids/waterfall_block.json\": 119,\n\t\"./blocks/sand_block_0001.json\": 7323,\n\t\"./blocks/sand_block_0002.json\": 7210,\n\t\"./decorations/stone_pack_01_001.json\": 5247,\n\t\"./decorations/stone_pack_01_002.json\": 5134,\n\t\"./decorations/stone_pack_01_003.json\": 9593,\n\t\"./decorations/stone_pack_01_004.json\": 9840,\n\t\"./decorations/stone_pack_01_005.json\": 2867,\n\t\"./decorations/stone_pack_01_006.json\": 7618,\n\t\"./decorations/stone_pack_01_007.json\": 9069,\n\t\"./decorations/stone_pack_01_008.json\": 9588,\n\t\"./decorations/stone_pack_01_009.json\": 3975,\n\t\"./entities/animals/fish_01.json\": 2174,\n\t\"./entities/player/player.json\": 6411,\n\t\"./entities/player/player_dead.json\": 5998,\n\t\"./entities/player/player_default.json\": 2333,\n\t\"./entities/player/player_target.json\": 6513,\n\t\"./entities/tank_0000.json\": 9381,\n\t\"./entities/tank_0001.json\": 8938,\n\t\"./entities/tank_0002.json\": 9179,\n\t\"./interactables/arrows/arrow_down.json\": 3741,\n\t\"./interactables/arrows/arrow_left.json\": 4636,\n\t\"./interactables/arrows/arrow_right.json\": 9821,\n\t\"./interactables/arrows/arrow_up.json\": 7852,\n\t\"./interactables/blocks/ice_block_0001.json\": 5742,\n\t\"./interactables/doors/door_0001.json\": 6332,\n\t\"./interactables/ends/end_0001.json\": 9318,\n\t\"./interactables/harvestables/berry_bush_01.json\": 7562,\n\t\"./interactables/harvestables/berry_bush_01_used.json\": 3614,\n\t\"./interactables/ledders/ledder_0001.json\": 8668,\n\t\"./interactables/ledders/ledder_0002.json\": 3097,\n\t\"./interactables/physics/stone_0001.json\": 9095,\n\t\"./interactables/physics/wooden_box_0001.json\": 1116,\n\t\"./interactables/platforms/platform_0001.json\": 2008,\n\t\"./interactables/portals/portal_001.json\": 2190,\n\t\"./interactables/portals/portal_target.json\": 5206,\n\t\"./items/ammunition/fireball_ammo.json\": 7289,\n\t\"./items/health/hertz_item.json\": 3321,\n\t\"./messages/message_i18n_0001.json\": 5217,\n\t\"./messages/sign_0001.json\": 7046,\n\t\"./obstacles/hazards/bushes_001.json\": 6447,\n\t\"./projectiles/firebal_basic.json\": 8097,\n\t\"./secrets/crack_block.json\": 6854,\n\t\"./secrets/fish_trigger.json\": 2475,\n\t\"./secrets/message_trigger.json\": 3746,\n\t\"./secrets/open_area.json\": 3106,\n\t\"./secrets/room_area.json\": 4547,\n\t\"./secrets/secret_area_a.json\": 1866,\n\t\"./secrets/secret_area_b.json\": 3227,\n\t\"./secrets/secret_area_c.json\": 3880,\n\t\"./secrets/wolf_secret_down.json\": 7716,\n\t\"./secrets/wolf_secret_left.json\": 7157,\n\t\"./secrets/wolf_secret_right.json\": 9950,\n\t\"./secrets/wolf_secret_up.json\": 8577,\n\t\"./system/biological_break_effects.json\": 2346,\n\t\"./system/floating_text.json\": 7794,\n\t\"./system/meteor_break_effects.json\": 6643,\n\t\"./system/object_break_effects.json\": 3764,\n\t\"./system/weather_damage.json\": 6234,\n\t\"./weather/weather_clouds_off.json\": 8264,\n\t\"./weather/weather_clouds_on.json\": 9138,\n\t\"./weather/weather_clouds_value.json\": 6592,\n\t\"./weather/weather_fog_off.json\": 4870,\n\t\"./weather/weather_fog_on.json\": 9560,\n\t\"./weather/weather_fog_value.json\": 1374,\n\t\"./weather/weather_lava_rain_off.json\": 4159,\n\t\"./weather/weather_lava_rain_on.json\": 7795,\n\t\"./weather/weather_meteor_rain_off.json\": 8421,\n\t\"./weather/weather_meteor_rain_on.json\": 2097,\n\t\"./weather/weather_radioactive_fog_off.json\": 8304,\n\t\"./weather/weather_radioactive_fog_on.json\": 6298,\n\t\"./weather/weather_rain_off.json\": 8312,\n\t\"./weather/weather_rain_on.json\": 914,\n\t\"./weather/weather_rain_value.json\": 7664,\n\t\"./weather/weather_snow_off.json\": 8445,\n\t\"./weather/weather_snow_on.json\": 969,\n\t\"./weather/weather_snow_value.json\": 5409,\n\t\"./weather/weather_thunder_off.json\": 628,\n\t\"./weather/weather_thunder_on.json\": 1006,\n\t\"./weather/weather_thunder_value.json\": 6756\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 6570;","var map = {\n\t\"./170515__rolandasb__forest_ambient_01_loop.ogg\": 344,\n\t\"./830253__nicktayloe__afternoon-woods-in-october-midwest-us-loop.ogg\": 3004\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 8815;"],"names":["map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","resolve","module","exports","initialState","activeMapData","tileMapData","objectMapData","secretMapData","objectMetadata","revealedSecrets","objectTextureIndices","mapWidth","mapHeight","projectMaps","isLoading","error","isPaused","isGameOver","activeRoomIds","gameSlice","createSlice","name","reducers","setActiveMap","state","action","mapData","payload","meta","maps","updateObjectMap","updateObjectMetadata","index","metadata","mapId","activeId","activeMapId","activeMap","targetId","removeObjectAtIndex","undefined","room","layerData","layers","find","l","type","data","length","removeTileAtIndex","moveTileInMap","fromIndex","toIndex","len","moveObjectInMap","updateObjectAtIndex","newId","setObjectTextureIndex","textureIndex","revealSecretZone","forEach","idx","includes","push","toggleRoom","roomId","filter","clearRooms","setLoading","setError","setPaused","setGameOver","resetGame","actions","isMapModalOpen","isSettingsOpen","isTerminalOpen","isPauseMenuOpen","notifications","cameraScrollX","shouldCenterMap","uiSlice","setMapModalOpen","setSettingsOpen","setTerminalOpen","window","__GAME_TERMINAL_OPEN__","setPauseMenuOpen","addNotification","Date","now","timestamp","toISOString","removeNotification","n","clearNotifications","setCameraScrollX","setShouldCenterMap","resetUI","configureStore","reducer","game","gameReducer","ui","uiReducer","middleware","getDefaultMiddleware","serializableCheck","ignoredActions","ignoredActionPaths","ignoredPaths","devTools","process","colors","primary","secondary","danger","warning","success","info","dark","darkGray","mediumGray","lightGray","background","surface","overlay","text","textLight","textDark","border","borderLight","spacing","xs","sm","md","lg","xl","xxl","borderRadius","round","shadows","fontSize","base","fontWeight","light","normal","medium","semibold","bold","transitions","fast","slow","zIndex","dropdown","modal","tooltip","notification","breakpoints","mobile","tablet","desktop","wide","createGlobalStyle","lv_navigation","lv_navigation_home","no_navigation","no_navigation_home","en_navigation","en_navigation_home","ru_navigation","ru_navigation_home","ja_navigation","ja_navigation_home","i18n","initReactI18next","init","lng","fallbackLng","supportedLngs","ns","defaultNS","interpolation","escapeValue","resources","lv","navigation","tutorial","lv_tutorial_messages","lv_game_map_selector","editor_elements","lv_editor_elements","editor_scene","lv_editor_scene","editor_tools","lv_editor_tools","no","no_tutorial_messages","no_game_map_selector","no_editor_elements","no_editor_scene","no_editor_tools","en","en_tutorial_messages","en_game_map_selector","en_editor_elements","en_editor_scene","en_editor_tools","ru","ru_tutorial_messages","ru_game_map_selector","ru_editor_elements","ru_editor_scene","ru_editor_tools","ja","ja_tutorial_messages","ja_game_map_selector","ja_editor_elements","ja_editor_scene","ja_editor_tools","NavLinkButton","styled","NavLink","withConfig","componentId","SectionHeaderNavigationChapters","t","useTranslation","chapter_home","chapter_game","chapter_editor","chapter_crystals","_jsxs","style","display","gap","children","_jsx","to","className","isActive","onClick","handleNewGameClick","dispatchEvent","Event","NavButton","button","SettingsButton","props","$soundOff","DropdownContainer","div","DropdownMenu","MenuItem","ToggleSwitch","$active","SectionHeaderNavigationLanguages","dropdownRef","useRef","isMenuOpen","setIsMenuOpen","useState","soundEnabled","setSoundEnabled","v","localStorage","getItem","currentLang","language","handleLanguageChange","newLang","changeLanguage","useEffect","handleClickOutside","event","current","contains","target","document","addEventListener","removeEventListener","ref","title","toggleSound","next","setItem","CustomEvent","detail","enabled","height","backgroundColor","margin","padding","color","StyledLogo","p","SectionHeaderNavigationLogo","tag","trim","toLowerCase","StyledSectionHeaderNavigation","StyledSectionContent","_registry","_registryMap","initRegistry","console","time","jsonContext","require","imageContext","soundContext","warn","resolvePath","rawPath","cleanPath","replace","relativePath","startsWith","imageModule","default","_warnedUnresolvedSound","resolveSound","rel","out","normalize","mod","key","item","resolvedTexture","texture","resolvedTextures","textures","Array","isArray","path","sfx","sfxResolved","defaultAnimation","animItem","r","animationSpeed","isHiddenInEditor","deadAnimation","deadItem","targetAnimation","targetItem","Map","set","__byId","log","timeEnd","getRegistry","findItemById","get","items","flexDirection","justifyContent","alignItems","width","overflow","flexShrink","SectionHeader","SectionContent","flexGrow","Outlet","apiUrl","env","REACT_APP_API_URL","logo","URL_LOGO_01","URL_LOGO_02","URL_LOGO_03","URL_LOGO_04","URL_LOGO_05","HomeContainer","Home","LOGO_01","config","LOGO_02","LOGO_03","LOGO_04","LOGO_05","src","alt","TextureCache","constructor","this","_map","url","m","has","tex","Texture","from","dispose","delete","clear","WeatherRain","container","api","getIntensity","tileSize","particles","intensity","maxParticles","resize","area","Math","max","floor","setIntensity","min","Number","spawnOne","g","Graphics","rect","fill","alpha","viewport","getViewport","x","y","random","speed","vx","vy","rotation","addChild","bounces","alive","update","dtMs","targetIntensity","abs","lerpFactor","exp","norm","scaled","pow","deficit","maxPerFrame","smooth","ceil","toSpawn","i","surplus","toCull","pop","parent","removeChild","destroy","dt","toRemove","nx","ny","getLiquidSurfaceY","syWater","isFinite","strength","onWaterImpact","syLava","onLavaImpact","isSolidAt","guard","vY","vH","j","splice","WeatherSnow","flakes","seeded","maxFlakes","options","circle","minY","maxY","drift","settled","life","phase","restMs","viewportH","viewportY","seedCount","f","sin","sYwater","sYlava","gAcc","WeatherClouds","bandHeight","patches","windDirection","filters","BlurFilter","quality","rebuild","isInitial","w","h","vX","vW","range","rx","ry","circles","baseR","k","PI","dist","cx","cos","cy","targetAlpha","currentAlpha","dying","targetCount","W","bandTop","bandBottom","activePatches","_spawnTimer","toKill","osc","leftBound","rightBound","WeatherFog","noiseTex","_createNoiseTexture","layer1","TilingSprite","layer2","tileScale","_recalcParams","_draw","_alphaFromIntensity","nv","_applyAlphas","baseAlpha","pulse","tilePosition","speed1","speed2","pulseFactor","noiseAlpha","lerp","a","b","u","canvas","createElement","ctx","getContext","img","createImageData","putImageData","WeatherThunder","nextStrikeMs","Infinity","flashAlpha","flashDecay","boltAlive","boltTime","boltDuration","flashG","boltG","_scheduleNextStrike","_redrawFlash","_clearBolt","H","_triggerFlash","_createBolt","decayPerMs","remain","initial","minDelay","_lerp","maxDelay","delay","_rand","topY","targetY","_findGroundY","endY","segments","jitterX","points","thickness","moveTo","lineTo","stroke","alignment","cap","join","branchCount","ang","bx","by","worldX","maxH","isSolid","WeatherLavaRain","waterY","WeatherRadioactiveFog","WeatherMeteorRain","size","isLarge","atan2","waterTouched","playerState","getPlayerState","hitEntity","px","py","pr","dx","dy","entities","ent","ex","ey","er","edx","edy","onMeteorHit","surfaceType","liquidType","getLiquidTypeAt","WaterSplashFX","node","Container","droplets","rings","maxDroplets","maxRings","trigger","upward","s","vr","count","spd","d","BubbleFX","bubbles","maxBubbles","rise","LavaEmbers","spawnAcc","embers","maxEmbers","surfaces","rebuildSurfaces","registryItems","getDef","isLava","def","flags","lava","TS","spans","gy","runStart","gx","aboveLava","_spawnOne","trail","cur","baseRate","mult","shift","emberAlpha","emberSize","p0","p1","LavaSteamFX","puffs","maxPuffs","radius","LiquidRegionSystem","opts","bgContainer","_regions","_waterTex","_lavaTex","_quicksandTex","_waterfallTex","_lavaWaterfallTex","_radioactiveWaterTex","_radioactiveWaterfallTex","_time","_noiseTex","_lavaDetailTex","_waterDetailTex","_quicksandDetailTex","_playerState","setPlayerState","_checkPlayerInRegion","region","pw","ph","pt","tileIndicesSet","getSurfaceY","X","topEdges","bgNode","_gradTextures","mw","mh","ts","changed","waterDrift","lavaDrift","quicksandDrift","waterfallDrift","lavaWaterfallDrift","radioactiveWaterDrift","radioactiveWaterfallDrift","sprite","alphaDiff","splashG","bottomEdges","F","splashHeight","splashColor","noise1","noise2","waves","lifeMsWater","lifeMsLava","startRadius","decay","ampNow","amp","capG","centerX","sigma","gauss","maxDisp","build","typeAt","liquid","lava_waterfall","radioactive_waterfall","waterfall","radioactive_water","quicksand","water","visited","Uint8Array","dirs","regionTiles","queue","_addRegion","tileIndices","mask","worldW","worldH","Set","bleed","_createLavaTexture","_createQuicksandTexture","_createWaterfallTexture","_createLavaWaterfallTexture","_createRadioactiveWaterfallTexture","_createRadioactiveWaterTexture","_createWaterTexture","source","addressMode","tiling","detailTex1","detailTex2","_createLavaDetailTexture","_createQuicksandDetailTexture","_createWaterDetailTexture","bgMask","bottomColor","_createGradientTexture","bgSprite","Sprite","_computeTopEdgeSpans","_computeBottomEdgeSpans","topColor","createLinearGradient","addColorStop","fillStyle","fillRect","globalAlpha","beginPath","arc","sw","sh","tilesByRow","above","rowList","cols","entries","sort","start","prev","below","addWave","HealthBar","super","offsetX","offsetY","thresholds","ok","trackColor","borderColor","borderAlpha","_w","_h","_pct","_color","_thresholds","_colors","_trackColor","_borderColor","_borderAlpha","_track","_fill","_redrawAll","visible","c","pct","_redrawFill","roundRect","innerW","freeze","parallax","tiles","tilesAnim","liquidBackground","objBehind","secretsBelow","player","projectiles","objFront","secretsAbove","weather","fog","liquids","liquidFx","textureCacheMap","getTexture","msToSpeed","ms","getRegItem","isWaterDef","isLavaDef","isWaterfallDef","isLavaWaterfallDef","isRadioactiveWaterDef","isRadioactiveWaterfallDef","ParallaxBackground","textureCache","cache","imgSprite","_worldW","_worldH","_lastCameraX","_currentUrl","worldWidth","worldHeight","factor","minWidth","minHeight","hex","parseInt","slice","solid","WHITE","tint","setupImage","baseTexture","wrapMode","WRAP_MODES","REPEAT","texH","scaleY","setScroll","Assets","valid","load","then","loadedTex","catch","err","cameraX","buildSpriteFromDef","spr","frames","Boolean","AnimatedSprite","play","spriteSheet","frameIndex","totalSprites","columns","rows","frameWidth","frameHeight","col","row","Rectangle","frame","editorIcon","Text","dropShadow","dropShadowColor","dropShadowBlur","dropShadowDistance","anchor","createPlayerContainer","playerVisuals","playerContainer","defaultDef","targetDef","defSprite","hitSprite","healthBar","sprites","hit","renderMapContent","refs","secretOverlays","targetBg","targetObjBehind","targetObjFront","isEditor","isEditorPlayMode","mapType","secretLayerRef","activeRoomIndices","roomWindowIndices","idxStr","linkedMapId","roomMap","rw","rh","rMapW","worldIdx","localIdx","roomTiles","roomObjs","add","bgColorStr","bgColorHex","substring","roomBg","objId","secretId","secretDef","secretSubtype","subtype","isInOpenArea","isInSecretArea","isSecretRevealed","filterColor","filterColorInGame","renderAbove","renderAbovePlayer","renderOnSecretLayer","backingSprite","backing","isPushable","maxHealth","health","visualElement","healthPercent","currentFrame","interaction","inside","renderOffsetX","render","renderOffsetY","overlapX","overlapY","objWidth","objHeight","isRoomContent","isWeatherTrigger","isMessageTrigger","isWolfSecret","shouldShowAnyway","isHiddenInGame","isDestructible","hb","renderSecretOverlays","overlays","drawOverlay","split","match","parseFloat","createBreakEffectLayer","layer","sortableChildren","createBreakEffectManager","lifeMs","gravity","shape","angleRange","chunks","angle","sp","maxLife","chunkCount","chunkSpeed","chunkLife","chunkSize","chunkGravity","chunkShape","chunkAngle","chunkColors","delta","getLiquidAtPixel","wx","wy","mapWidthTiles","mapHeightTiles","TILE_SIZE","tileData","getDefById","overlayColorRaw","overlayColor","tintBelowSurface","overlayAlphaRaw","overlayAlpha","params","buoyancy","dragX","drag","dragY","swimmable","dps","damagePerSecond","oxygen","drainPerSecond","regenPerSecond","damagePerSecondWhenDepleted","resistance","sampleLiquidForAABB","headY","chestY","feet","chest","head","candidate","inLiquid","headUnder","atSurface","defaultOverlay","rawOverlayColor","rawOverlayAlpha","tickLiquidDamage","deltaMs","accRef","gameState","HIT_FLASH_MS","hitTimerMs","setPreferences","skipCacheIdWarning","preferCreateImageBitmap","EMPTY_ARRAY","EMPTY_OBJECT","LIQUID_SURFACE_MAP","PixiStage","backgroundImage","backgroundParallaxFactor","weatherRain","weatherSnow","weatherClouds","weatherLavaRain","weatherRadioactiveFog","weatherMeteorRain","healthBarEnabled","weatherFog","weatherThunder","oxygenBarEnabled","lavaBarEnabled","waterSplashesEnabled","lavaEmbersEnabled","showGrid","renderLayers","pointerEvents","onWeatherEffectHit","roomBlurEnabled","debugOverlayEnabled","isPixiReady","setIsPixiReady","mountRef","appRef","parallaxRef","parallaxManagerRef","cameraScrollRef","parallaxFactorRef","cameraPosRef","bgRef","bgAnimRef","bgImageRef","bgColorRef","objBehindRef","objFrontRef","roomBgRef","roomObjBehindRef","roomObjFrontRef","playerRef","playerLayerRef","playerSpriteRefs","playerHealthBarRef","playerStateRef","weatherLayerRef","liquidLayerRef","liquidBgLayerRef","liquidSystemRef","fogLayerRef","weatherSystemsRef","rain","snow","clouds","thunder","lavaRain","radioactiveFog","meteorRain","weatherPropsRef","tileMapDataRef","registryItemsRef","projectilesLayerRef","projectileSpritesRef","entitiesLayerRef","entitySpritesRef","projectilesPropRef","pixiTextureCacheRef","hbEnabledRef","oxyEnabledRef","lavaEnabledRef","overlayLayerRef","underwaterRef","overlayHBRef","oxygenBarRef","lavaBarRef","waterFxRef","bubbleFxRef","fishBubbleStateRef","entityWaterStateRef","lavaEmbersRef","lavaSteamRef","splashesEnabledRef","embersEnabledRef","waterStateRef","inWater","gridRef","showGridRef","roomBlurEnabledRef","blurFilterRef","darkenFilterRef","ColorMatrixFilter","roomBrightnessFilterRef","vignetteRef","floatingLayerRef","debugLayerRef","debugEnabledRef","floatingManagerRef","breakFxLayerRef","breakFxManagerRef","resolveBackgroundUrl","useMemo","createBackgroundResolver","bgContext","metaPath","createSolidChecker","collision","top","bottom","left","right","rebuildParallax","useCallback","createParallaxManager","parallaxLayer","textureCacheRef","parallaxHelper","parallaxSprite","resolvedUrl","helper","bgUrl","bgColor","screen","destroyed","async","app","Application","resizeTo","backgroundAlpha","antialias","autoDensity","stage","renderer","bg","bgAnim","roomObjBehind","roomObjFront","secretBelowLayer","secretAboveLayer","playerLayer","entitiesLayer","weatherLayer","liquidBgLayer","liquidLayer","liquidFxLayer","fogLayer","projLayer","vignetteLayer","overlayLayer","floatingLayer","breakFxLayer","LAYERS","cfg","floatConfig","defaultCfg","critCfg","crit","ttlMs","amount","amountValue","critThreshold","threshold","isCrit","baseColor","finalColor","finalFontSize","finalTtl","riseSpeed","jitterY","finalText","prefix","suffix","label","String","fontFamily","strokeThickness","jitterXValue","jitterYValue","position","ttl","total","createFloatingTextManager","gridGraphics","debugGraphics","allLayersMap","objects","layerName","urlSet","addUrl","urls","playerComponents","innerHTML","appendChild","hbOverlay","oxyColors","oxyBar","lavaColors","lvBar","preventDefault","ticker","updatePlayerSprite","inLava","effectiveWidth","isHit","dir","direction","mag","scale","camX","camY","lastCam","rawX","rawY","smoothing","nextRawX","nextRawY","pivot","__PLAYER_POS__","deltaMS","systems","swNow","shNow","sNow","overlayL","headUnderWater","overlayCfg","liquidOverlay","showOverlay","maxTargetAlpha","pulseBase","fadeSpeed","lastLiquidType","fadeOutSpeed","nowInWater","nowLiquid","sy","s2","effW","effH","baseYOffset","baseX","baseY","hbO","show","nextBarY","maxOxy","maxOxygen","curOxy","maxLv","maxLavaResist","curLv","lavaResist","syncProjectiles","projectilesLayer","projectileSpritesMap","projectilesList","list","seen","defId","syncEntities","entitySpritesMap","entitiesList","_lastFrameIndex","isTextureReady","currentSpriteIndex","texWidth","texHeight","effectiveColumns","targetWidth","targetHeight","isNaN","flipY","absScaleX","absScaleY","ents","regs","liq","isFish","ai","fish","isAlive","isDormant","interval","bubbleIntervalMs","jitter","bubbleJitter","appToDestroy","values","cleanupProjectiles","cleanupEntities","handler","isInsideRoom","targetBlur","roomBrightness","reset","desaturate","brightness","grad","createRadialGradient","_vignetteSprite","tileCount","tileId","isLiquid","isRadio","radioactive","hasCollision","active","rebuildLayers","safeDestroy","removeChildren","child","roomAreaIndex","ox","oy","roomSecrets","roomOptions","selectedBackgroundColor","pLayer","tileDataString","JSON","stringify","prevTileDataString","_lastTileData","prepare","upload","runRebuild","tmd","entry","toSurfaceType","yy","getRainIntensity","getSnowIntensity","getCloudsIntensity","getThunderIntensity","getFogIntensity","getLavaRainIntensity","getRadioactiveFogIntensity","getMeteorRainIntensity","propTypes","PropTypes","isRequired","resolveInteractableContext","objectLayerData","mainObjectMetadata","activeRoomIdsProp","centerY","hasMainMetadata","activeTargetMap","activeObjectData","activeMetadata","activeMapWidth","activeMapHeight","currentMapId","mainMetadata","findSpawnPosition","triggerId","mapW","objLayer","objData","spawnIdx","triggerRequested","findIndex","handleDoorInteraction","objDef","currentMeta","actualIndex","onStateUpdate","playShotSfx","lastETime","sound","sfxVolume","opening","delayS","delaySeconds","targetMapId","setTimeout","targetMap","isRoom","newX","newY","roomAreaEntry","raIdx","spawn","spawnTriggerId","handleTeleportInteraction","vol","destId","destMeta","tx","ty","applyInteractableEffects","MAX_HEALTH","effect","interactableKey","usedInteractables","healthBonus","fireball","ammoBonus","ammo","floodFillSecretZone","startIndex","startSecretId","startDef","result","checkSecretDetection","currentX","currentY","revealedSet","playerLeft","playerRight","playerTop","playerBottom","minGX","maxGX","minGY","maxGY","revealOnEnter","connectedIndices","newIndices","triggerIndex","triggerSecretId","triggerSubtype","totalConnected","newToReveal","firstFiveNew","connectedSecretIds","MESSAGES","enMessages","lvMessages","noMessages","ruMessages","jaMessages","getLang","lang","raw","getTutorialChapters","fallback","getTutorialItems","chapter","chapterData","getTutorialText","handleWeatherTrigger","weatherType","weatherAction","value","lastWeatherTrigger","handleMessageTrigger","requiresActionKey","requiresKey","i18nChapter","i18nId","message","lastMessageTrigger","duration","triggerWolfSecret","playerCenterX","playerCenterY","objCenterX","objCenterY","playerGridX","playerGridY","objGridX","objGridY","moveX","moveY","eps","applyWolfSecretShift","getObjectId","getObjectDef","moveTile","moveObject","moveMetadata","removeObject","stepDelayMs","setTimeoutFn","shouldCancel","currentIdx","remainingDx","remainingDy","originId","moveStep","currentId","stepX","stepY","targetIndex","targetObjId","extraX","extraY","shouldRemoveCrackBlock","newHealth","passableHealthThreshold","checkInteractables","input","localX","localY","gridX","gridY","upIndex","upObjId","upDef","downIndex","downObjId","downDef","frontX","frontIndex","frontObjId","frontDef","foundIndex","fromMap","fromMeta","isWinning","winCounter","winCountSpeed","normalizeColor","scaleFromRange","readNumber","getMeteorBreakEffectConfig","meteorBreakEffectsConfig","defaults","sizeScale","minSize","maxSize","denom","particleSize","ground","colorsRaw","getBiologicalBreakEffectConfig","biologicalBreakEffectsConfig","beepFallback","muffled","AC","AudioContext","webkitAudioContext","audioCtxRef","audioCtx","resume","currentTime","createOscillator","gain","createGain","lastNode","createBiquadFilter","frequency","setValueAtTime","connect","exponentialRampToValueAtTime","destination","stop","moveHorizontal","MOVE_SPEED","checkCollision","friction","acceleration","timeScale","targetVx","sign","proposedX","step","safeX","moveDist","nextX","applyVerticalPhysics","isGrounded","animation","GRAVITY","TERMINAL_VELOCITY","JUMP_FORCE","isLiquidAt","prevInWater","liqBuoyancy","liqDragY","liqTerminal","swimImpulseMult","activeLiquidType","feetLiq","chestLiq","space","swimImpulse","proposedY","getWeatherConfig","weatherDamageConfig","getMapWeather","metaWeather","runtime","rt","__GAME_RUNTIME_SETTINGS__","merged","getWeatherDps","clampIntensity","maxDps","minDps","weatherAffectsPlayer","affects","weatherAffectsEnemy","enemyId","enemyName","enemies","mode","excluded","exclude","isExcluded","some","weatherBlockedByCover","blockedByCover","isSolidAtPixel","secretData","objectData","ignoreEntityId","insideAnyRoom","localWx","localWy","roomTileW","roomTileH","roomObjects","closed","isExploding","isEntity","tileDef","getSurfaceProperties","feetY","slipperiness","isCoveredFromAbove","isInsideActiveRoom","getTileLayerData","getSecretLayerData","liquidTypeToHabitat","getFishTriggerAt","objectId","triggerType","getWaterSurfaceY","updateFrame","constants","helpers","isInitialized","lastTimeRef","projectilesRef","entitiesRef","shootCooldownRef","liquidDamageAccumulatorRef","oxygenDepleteAccRef","lavaDepleteAccRef","weatherDamageAccRef","activeRoomIdsRef","getLiquidSample","collectItem","checkHazardDamage","checkSecrets","spawnProjectile","playSfx","updateProjectiles","setPlayer","onGameOver","continue","iceResist","maxIceResist","physicsDt","backgroundLayer","secretLayer","isSlippery","currentIceRes","maxIce","effectiveFriction","ratio","targetFriction","checkCollisionExtended","isPushing","pushTarget","currentStrength","isAlreadyAtMax","lastPushTime","pushDist","overlapDist","isNextToLeft","isNextToRight","pushForce","sounds","lastPushSoundTime","ladderInfo","findLadderAtPlayer","ctxResolved","baseIdx","ladder","vp","remaining","steps","ladderSpeed","climbDir","stepMs","liquidParams","sample","resourceParams","parseNumber","maxLava","oxy","lavaRes","oxyParams","lavaParams","iceParams","strengthParams","oxygenApplies","oxygenEnabled","oxyDrain","oxyRegen","lavaApplies","lavaEnabled","lavaDrain","lavaRegen","applyResource","maxKey","drain","regen","maxVal","weatherNow","radioFogInt","fogActive","maxRadio","maxRadioactivity","radio","radioactivity","radioParams","radioEnabled","radioBaseline","baselinePercent","radioGain","gainPerSecond","radioDecay","decayPerSecond","radioRecover","recoverPerSecond","baseline","rates","getRadioactivityRates","inc","radioactivityPerSecond","dec","radioactivityRegenPerSecond","increase","tickDepleteDps","dpsValue","lavaRainInt","lavaDps","radioDps","totalWeatherDps","damage","healthDpsOverride","effectiveDps","currentAmmo","mouseLeft","playerX","playerY","entity","animFrame","animTimer","totalFrames","animations","explode","frameDuration","shouldRemove","liquidSample","activeRadiusPx","activeRadius","dxView","dyView","sqrt","idleAnim","idle","liquidDamageAcc","dmg","weatherDamageAcc","habitat","timeMs","habitatKey","isAllowed","requireLiquid","fishState","fs","initialized","nextTurnAt","turnMinMs","turnMaxMs","nextVerticalAt","verticalDir","fishCount","removeOnNext","surfaceY","surfaceOffset","deathSurfaceOffset","floatSpeed","deathFloatSpeed","deadAnim","dead","meteorShockFrame","isJumping","panicRadiusPx","panicRadius","panicSpeed","baseSpeed","swimSpeed","verticalDrift","isWaterfall","waterfallDriftMultiplier","waterfallSpeedMultiplier","triggerDef","mergedJumpCfg","fishTrigger","jump","nowMs","nextJumpAt","chance","jumpDir","jumpVx","speedX","jumpVy","speedY","jumpGravity","jumpBounce","bounce","cooldownMs","dtSec","nextY","landingSample","shockUntil","shockFrame","lastWaterEnter","playerWaveRadius","waveImpulse","playerWaveImpulse","waveUntil","panicUntil","panicDurationMs","isPanicking","downSpeed","waterfallDownSpeed","waterfallAlpha","impulse","sampleNext","nextType","anims","animKey","panic","currentAnim","swim","frameDur","prevInLiquid","water_splash","lava_splash","ew","eh","sinkingSpeed","fallDistance","other","kill_enemy","isRound","checkEmpty","leftX","rightX","mapH","arrowId","foundArrowDef","arrowsLayer","aDef","reactionDist","reactionDistance","shootDist","shootDistance","canJump","shootCooldown","isShooting","patrol","hitSomething","stayOnPlatform","groundX","groundY","frameSpeed","checkEntityCollision","explodeAnim","updateEntities","knockbackDir","maxX","onIce","floatState","floatingText","acc","res","diff","amt","MAX_OXYGEN","MAX_LAVA_RESIST","MAX_RADIOACTIVITY","errorHandler","errorListeners","logLevel","setLogLevel","level","addListener","callback","removeListener","cb","notifyListeners","context","handle","errorObj","logData","stack","shouldLog","toUpperCase","sendToLoggingService","levels","debug","currentLevel","wrapAsync","fn","args","wrapSync","parseBool","useGameEngine","onRevealSecret","useInput","clearKeys","handleKeyDown","tagName","typing","isContentEditable","repeat","handleMouseDown","handleMouseUp","handleKeyUp","onToggleTerminal","passive","maxStrength","requestRef","hazardDamageAccumulatorRef","lastHazardIndexRef","triggeredHazardsRef","projectileIdRef","soundEnabledRef","audioCtxUnlockedRef","onStateUpdateRef","onRevealSecretRef","onGameOverRef","objectMetadataRef","revealedSecretsRef","mapWidthRef","mapHeightRef","tileDataRef","objectDataRef","secretDataRef","onToggle","onUserGesture","volume","audio","Audio","pause","once","checkHazardDamageWrapper","candidates","pushCandidate","touch","damageDirections","tileLeft","tileRight","tileTop","tileBottom","touchMargin","touchingTop","touchingBottom","touchingLeft","touchingRight","overlapTop","overlapBottom","overlapLeft","overlapRight","sideScore","chosen","prevIndex","damageOnce","baseDamage","immediate","TICK_MS","component","function","playerPosition","damageType","localRevealedRef","handleWeatherEffectHitWrapper","handleWeatherEffectHit","onBreakEffect","edist","prevHealth","inDamageRadius","shockRadius","meteorShockRadius","meteorShockDurationMs","lastFx","lastBioFxAt","bioConfig","breakConfig","onHit","lastMapIdRef","projectName","date_map_last_updated","date_map_created_at","isNewMapLoad","initialEntities","startX","startY","playerId","registryPlayer","prevAmmo","prevFishCount","pW","pH","maxXAtStart","checkCollisionExternal","TILE_SIZE_OVERRIDE","tileDataOverride","registryItemsOverride","secretDataOverride","objectDataOverride","objectMetadataOverride","ignoreId","isSolidAtPixelExternal","originX","originY","ownerId","pDef","lifespan","ricochetFlag","ricochetOnTiles","collisionWithPenetration","proj","cwt","collisionWithTiles","hbs","hitboxScale","ric","spawnProjectileExternal","getLiquidTypeAtPixel","sampleLiquid","aabb","objectLayer","collectedItems","rWidth","rgX","rIndex","itemKey","rObjectData","rItemId","rItemDef","pickup","pickedUp","mapKey","itemId","itemDef","checkSecretsWrapper","mergedRevealed","indicesToReveal","dtProj","isSolidRect","hw","hh","pts","checkObjectHit","checkEntityHit","checkPlayerHit","maxBounces","bounceDamp","bounceDamping","ricRand","ricochetRandom","maxDelta","stepTime","removed","hitEntX","hitIdxX","hypot","hitEntY","hitIdxY","requestAnimationFrame","cancelAnimationFrame","AnimatedItem","setIndex","setInterval","clearInterval","imgSrc","fallbackFrame","maxWidth","maxHeight","draggable","HeaderContainer","AmmoDisplay","FishDisplay","AmmoIcon","span","RightSection","BarsContainer","BarRow","BarWrapper","BarFill","attrs","$percent","$color","BarLabel","GameHeader","hpPercent","oxyPercent","lavaPercent","icePercent","strengthPercent","radioPercent","fireballFrames","fireballA","fireballB","fireballC","fireballD","imageRendering","fishSprite","commands","register","cmd","listCommands","description","executeCommand","panelStyleBase","borderTop","boxShadow","transition","GameTerminal","open","setOpen","lines","setLines","setInput","scrollRef","inputRef","suppressUntilRef","onClear","onClose","performance","focus","onKey","scrollTop","scrollHeight","transform","borderBottom","flex","overflowY","whiteSpace","lineHeight","onSubmit","onKeyDown","stopPropagation","onChange","placeholder","outline","cursor","GameSettings","activeTab","setActiveTab","setParallax","setRain","ls","setSnow","setClouds","lsNew","lsOld","setThunder","setFog","setLavaRain","setRadioactiveFog","setMeteorRain","setHealthBarEnabled","setOxygenBarEnabled","setLavaBarEnabled","setDebugOverlayEnabled","setWaterSplashesEnabled","setLavaEmbersEnabled","setRoomBlurEnabled","showCoordinates","setShowCoordinates","minimized","setMinimized","pos","setPos","parse","setSize","draggingRef","clampPos","sz","isMin","vw","innerWidth","vh","innerHeight","maxL","maxT","onSettingsUpdate","patch","onOpen","onMove","clientX","clientY","onUp","onResize","emitUpdate","panelStyle","userSelect","contentStyle","buttonStyle","marginLeft","tabsBarStyle","overflowX","onMouseDown","onMinToggle","tab","marginBottom","defaultValue","_Fragment","textAlign","toFixed","defaultChecked","marginTop","checked","startW","startH","move","ev","dw","dh","nw","nh","up","getBreakEffectParams","breakEffectsConfig","ids","objectIds","types","objectTypes","matchesValue","shouldTriggerBreakEffect","hp","BackgroundMusicPlayer","audioRef","currentSrcRef","sourceNodeRef","filterNodeRef","gainNodeRef","musicContext","cleanup","close","resolveUrl","loop","createMediaElementSource","setupWebAudio","setTargetAtTime","onGesture","val","Overlay","$isVisible","MessageOverlay","isVisible","defaultProps","BUILT_IN_MAPS","GameContainer","ModalOverlay","ModalContent","ModalTitle","h2","MapList","MapCard","MapTitle","MapAuthor","MapDescription","MapInfo","WinCounterOverlay","GameOverOverlay","GameOverTitle","h1","ReplayButton","ModalDivider","FileUploadLabel","HiddenFileInput","Viewport","$blurred","GameCanvas","PlaceholderMessage","Game","dispatch","useDispatch","viewportRef","useSelector","uiState","runtimeSettings","setRuntimeSettings","gameMessage","setGameMessage","messageTimerRef","clearTimeout","activeMapIdRef","isGameOverRef","handleStateUpdate","projectMapsResolved","spawnObjId","spawnDef","projectToLoad","loadMapData","metaPatch","breakFxPlayed","mapIdAtStart","ps","alert","settingKey","charAt","handleGameOver","indices","handleOpenModalEvent","weatherFogLegacy","sourceMapData","structuredClone","cloneMapData","effectiveMapData","version","activeLayers","bgLayer","mapTileData","mapObjectData","mapSecretData","backgroundMusic","nowIso","mapName","dimensions","debugMapId","handleReplay","mapToLoad","isV2","author","sizeInfo","subMapInfo","mainMap","mapValues","accept","file","files","fileReader","FileReader","readAsText","onload","loaded","fileName","onerror","contents","suggestedName","mimeType","showSaveFilePicker","writable","createWritable","blob","Blob","write","link","href","URL","createObjectURL","download","body","click","revokeObjectURL","applyMapData","setMapWidth","setMapHeight","setMapName","setCreatorName","setMapDescription","setCreatedAt","setSelectedBackgroundImage","setSelectedBackgroundColor","setBackgroundParallaxFactor","setSelectedBackgroundMusic","setPlayerPosition","setTileMapData","setObjectMapData","setSecretMapData","setObjectMetadata","setWeatherRain","setWeatherSnow","setWeatherClouds","setWeatherFog","setWeatherThunder","setWeatherLavaRain","setWeatherRadioactiveFog","setWeatherMeteorRain","setMaps","setActiveMapId","selectedBackgroundImage","selectedBackgroundMusic","worldY","date_created","ObjectLinks","React","links","portals","targets","x1","y1","x2","y2","strokeWidth","strokeDasharray","opacity","EditorTile","activeTool","tileObj","objObj","secretObj","isHighlighted","parentRegionIndex","borderStyle","bgStyle","handleGridMouseDown","handleGridMouseEnter","handleResizeStart","handleMoveStart","isRoomAreaVisible","showRoomMapContent","showMessages","isLiquidTile","isWaterTile","isLavaTile","isQuicksandTile","isWaterfallTile","isLavaWaterfallTile","isRadioactiveWaterTile","isRadioactiveWaterfallTile","messageText","i18nText","resolvedMessageText","isResizable","hasObjectOrSecret","onMouseEnter","boxSizing","objectFit","filterColorInEditor","baseTop","baseLeft","baseWidth","baseHeight","inset","i18nMessage","hasIntensity","borderLeft","borderRight","textShadow","roomName","selectedBackgroundUrl","showBackgroundImage","activeLayer","hoverIndex","highlightedIndex","brushSize","bucketPreviewIndices","selection","previewPosition","dragStart","isDragging","handleGridMouseUp","handleGridMouseLeave","setIsDragging","selectedTile","isEraserActive","isBrushActive","isBucketActive","regions","roomAreas","getLayerColor","getLayerFilter","onMouseUp","onMouseLeave","backgroundRepeat","backgroundSize","getGridStyles","gridTemplateColumns","gridTemplateRows","_","dTileId","dObjId","dSecId","layerColor","hx","hy","minX","selX","selY","originalX","originalY","parentRegion","EditorToolsContainer","HeaderBar","ToolsSection","ToolsGroup","ToolsInnerGroup","ToolsRow","ToolsEditorButton","$variant","$small","$square","$disabled","StrikeThrough","LayerIndicator","$bgColor","$borderColor","$textColor","BgColorContainer","BgColorInputWrapper","BgColorInput","disabled","BgTransparentButton","PlayButtonContainer","PlayButtonInner","InfoContainer","InfoItem","InfoLabel","InfoValue","EraserButtonContainer","EraserButtonInner","SelectionActions","ConfirmButton","CancelButton","GridIcon","SidebarContainer","ElementEditorButton","PanelContainer","$isOpen","PanelHeader","PanelBody","CloseButton","OperationButton","$danger","OperationLabel","NewMapModal","isOpen","tempMapName","setTempMapName","tempCreatorName","setTempCreatorName","tempMapDescription","setTempMapDescription","confirmNewMap","ModalHeader","BuiltInMapsModal","onSelect","topZIndex","DraggableWindow","defaultPosition","defaultWidth","isOpenDefault","onHeightChange","setZIndex","dragOffset","setDragOffset","currentPosition","setCurrentPosition","isMinimized","setIsMinimized","isClosed","setIsClosed","hasBeenDragged","setHasBeenDragged","windowRef","lastHeightRef","offsetHeight","handleMouseMove","getBoundingClientRect","EditorMapResizer","containerRef","startSize","setStartSize","startMousePos","setStartMousePos","displayWidth","displayHeight","blocksX","blocksY","newWidth","newHeight","Minimap","canvasRef","minimapWidth","minimapHeight","tileWidth","tileHeight","tile","obj","strokeStyle","lineWidth","portal","setLineDash","WorldView","switchMap","currentMapData","createMap","deleteMap","updateMapData","onAddRoomArea","mapLayoutsRef","dragRef","allMaps","draw","layouts","currentIds","layout","tileW","tileH","strokeRect","font","fillText","rAreaW","rAreaH","rTileW","rTileH","ri","sourceLayout","sourceMap","sx","isPortalSource","isDoorSource","linkId","targetLayout","tw","th","tTileW","tTileH","tObjId","tObjDef","isTarget","isDoorTarget","tMeta","endX","cp1X","cp1Y","cp2X","cp2Y","bezierCurveTo","save","translate","rotate","closePath","restore","btnX","btnY","confirm","mapStartX","mapStartY","onMouseMove","BackgroundPanel","backgroundOptions","paddingTop","MusicPanel","musicOptions","fontStyle","status","WeatherPanel","weatherItems","setter","icon","SceneEditorButton","RightSidebarContainer","EditorScene","handleMapResize","isResizeWindowOpen","setIsResizeWindowOpen","isWorldViewOpen","setIsWorldViewOpen","isMinimapOpen","setIsMinimapOpen","setIsSettingsOpen","isBackgroundOpen","setIsBackgroundOpen","isMusicOpen","setIsMusicOpen","OperationsPanel","openNewMapModal","saveMap","loadMap","openBuiltInModal","clearMap","creatorName","mapDescription","inputStyle","handleFocus","handleBlur","onFocus","onBlur","CollapsiblePanel","setIsOpen","PalettePanel","isPlayMode","category","blocks","decorations","interactables","hazards","secrets","messages","crackableWalls","pushableWalls","obstacles","setHighlightedIndex","handlePaletteSelect","selectedChapter","setSelectedChapter","tutorialChapters","tutorialItems","getLiquidLabel","isLavaWaterfall","isRadioactiveWaterfall","isRadioactive","isWater","isQuicksand","renderPaletteItem","hasImage","isSecret","swatchStyle","displayName","iconText","getBlockGroup","editor","group","groupOrder","withGroups","sortBlocks","ao","order","bo","localeCompare","groupPanels","flexWrap","otherItems","getLiquidGroup","li","sortLiquids","getEntityGroup","sortEntities","groupItems","getItemGroup","sortItems","getInteractableGroup","sortInteractables","getHazardGroup","sortHazards","ch","StatisticsPanel","totalTiles","filledBlocks","objectsCount","emptyBlocks","registryMap","itemsCount","entitiesCount","mapList","mapsTotal","mapsOverworld","mapsUnderworld","mapsRooms","Trans","i18nKey","components","ObjectPropsPanel","listRef","highlightedElement","querySelector","scrollIntoView","behavior","block","isWeather","isMessage","isPortalOrTarget","isDoor","isRoomArea","i18nPreview","el","scrollX","clientWidth","scrollY","clientHeight","scrollTo","EditorElements","activePanel","setActivePanel","togglePanel","lastPanel","setLastPanel","pinnedPanel","setPinnedPanel","hoverTimerRef","displayPanel","clearHoverTimer","handleIconClick","panel","handleIconMouseEnter","handleIconMouseLeave","panelTitles","stats","handlePanelMouseEnter","handlePanelMouseLeave","EditorTools","setShowGrid","handlePlay","handlePause","handleReset","setActiveTool","setBrushSize","moveSelection","selectionMode","setSelectionMode","commitSelection","cancelSelection","setShowBackgroundImage","setShowMessages","setIsRoomAreaVisible","setShowRoomMapContent","tool","isDisabled","roman","getLayerIndicatorData","object","secret","textColor","getEraserData","useEditorOperations","createdAt","setIsNewMapModalOpen","handleSaveMap","currentDate","projectData","date_last_updated","statistics","total_tiles","filled_tiles","total_objects","json","saveFile","mapsCount","handleLoadMap","setters","handleLoadBuiltInMap","loadBuiltInMap","handleClearMap","getFloodFillIndices","currentData","startId","matchingIndices","paintTile","isPropsLayer","targetLayer","setTargetData","newData","newMetadata","metadataChanged","targetX","useEditorPainting","setSelection","setPreviewPosition","setOriginalMapData","setDragStart","setHoverIndex","setBucketPreviewIndices","resizeState","setResizeState","moveState","setMoveState","bucketTimerRef","getLinkedRoomAt","roomX","roomY","roomWidth","roomHeight","linkedRoom","rHeight","setRoomData","setRoomMetadata","newMeta","paintTileUtil","edge","useLinked","mWidth","mHeight","mIndex","mTileMapData","mObjectMapData","mSecretMapData","mObjectMetadata","mSetTileMapData","mSetObjectMapData","mSetSecretMapData","mSetObjectMetadata","existingObjId","existingSecretId","isEraser","isRoomMap","targetData","targetValue","newValue","floodFill","affectedIndices","metaChanged","handleGridMouseMove","curX","curY","newW","newH","newIndex","mData","baseIndex","selectionMetadata","tileMap","objectMap","secretMap","Editor","setSelectedTile","setActiveLayer","stateRef","isNewMapModalOpen","isBuiltInMapsModalOpen","setIsBuiltInMapsModalOpen","loadBackgroundOptions","loadMusicOptions","createNewMap","useEditorMaps","existingMaps","newMap","newMaps","lastActiveMapIdRef","newMapId","nextMap","handleCreateMap","finalName","prompt","timeout","selectedBgOption","useEditorRegistry","originalMapData","useEditorSelection","newTileMap","newObjectMap","newSecretMap","newObjectMetadata","destX","destY","destIdx","srcDataIdx","handleForceStop","playModeObjectData","playModeSecretData","playModeWeather","playModeMaps","gameEngineState","useEditorPlayMode","setIsPlayMode","setIsGameOver","restartCounter","setRestartCounter","editorSnapshot","setEditorSnapshot","setRevealedSecrets","setActiveRoomIds","setPlayModeObjectData","setPlayModeSecretData","setPlayModeWeather","playModeMapsVersion","setPlayModeMapsVersion","lastSyncedMapIdRef","isPlayModeRef","playModeMapsRef","engineInitId","currentPlayObjectData","playData","spawnIndex","spawnX","currentPlaySecretData","overrides","mapDataForGame","saved","newState","mapObj","prevTiles","newTiles","nextMeta","prevObjs","newObjs","prevMeta","handleRevealSecret","secretIndices","resetData","handleLoadMapWrapped","handleLoadBuiltInMapWrapped","handleDeleteMap","resizeMapData","oldW","oldH","oldTiles","oldObjs","oldSecrets","oldMeta","resizeArray","oldArr","newArr","oldM","newM","oldIdx","newIdx","resizeMetadata","Crystals","Repository","cardStyle","imageStyle","fieldsContainerStyle","onError","wordBreak","ReactDOM","getElementById","Provider","store","ThemeProvider","theme","GlobalStyles","BrowserRouter","basename","Routes","Route","element","App"],"ignoreList":[],"sourceRoot":""}